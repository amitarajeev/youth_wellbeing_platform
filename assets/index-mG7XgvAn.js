var W$=Object.defineProperty;var q$=(t,e,n)=>e in t?W$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var bo=(t,e,n)=>q$(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))r(c);new MutationObserver(c=>{for(const u of c)if(u.type==="childList")for(const p of u.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&r(p)}).observe(document,{childList:!0,subtree:!0});function n(c){const u={};return c.integrity&&(u.integrity=c.integrity),c.referrerPolicy&&(u.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?u.credentials="include":c.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(c){if(c.ep)return;c.ep=!0;const u=n(c);fetch(c.href,u)}})();/**
* @vue/shared v3.5.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function $E(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const as={},z_=[],nh=()=>{},m4=()=>!1,lS=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),jE=t=>t.startsWith("onUpdate:"),Ba=Object.assign,UE=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},Z$=Object.prototype.hasOwnProperty,Fo=(t,e)=>Z$.call(t,e),Hi=Array.isArray,B_=t=>S0(t)==="[object Map]",cS=t=>S0(t)==="[object Set]",zM=t=>S0(t)==="[object Date]",_r=t=>typeof t=="function",Fs=t=>typeof t=="string",ld=t=>typeof t=="symbol",cs=t=>t!==null&&typeof t=="object",g4=t=>(cs(t)||_r(t))&&_r(t.then)&&_r(t.catch),_4=Object.prototype.toString,S0=t=>_4.call(t),K$=t=>S0(t).slice(8,-1),y4=t=>S0(t)==="[object Object]",HE=t=>Fs(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,eb=$E(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),uS=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},X$=/-(\w)/g,bu=uS(t=>t.replace(X$,(e,n)=>n?n.toUpperCase():"")),Y$=/\B([A-Z])/g,Hp=uS(t=>t.replace(Y$,"-$1").toLowerCase()),dS=uS(t=>t.charAt(0).toUpperCase()+t.slice(1)),Vx=uS(t=>t?`on${dS(t)}`:""),Rp=(t,e)=>!Object.is(t,e),$x=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},v4=(t,e,n,r=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:r,value:n})},dw=t=>{const e=parseFloat(t);return isNaN(e)?t:e},J$=t=>{const e=Fs(t)?Number(t):NaN;return isNaN(e)?t:e};let BM;const hS=()=>BM||(BM=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function C0(t){if(Hi(t)){const e={};for(let n=0;n<t.length;n++){const r=t[n],c=Fs(r)?nj(r):C0(r);if(c)for(const u in c)e[u]=c[u]}return e}else if(Fs(t)||cs(t))return t}const Q$=/;(?![^(]*\))/g,ej=/:([^]+)/,tj=/\/\*[^]*?\*\//g;function nj(t){const e={};return t.replace(tj,"").split(Q$).forEach(n=>{if(n){const r=n.split(ej);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function pr(t){let e="";if(Fs(t))e=t;else if(Hi(t))for(let n=0;n<t.length;n++){const r=pr(t[n]);r&&(e+=r+" ")}else if(cs(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}function fS(t){if(!t)return null;let{class:e,style:n}=t;return e&&!Fs(e)&&(t.class=pr(e)),n&&(t.style=C0(n)),t}const ij="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",rj=$E(ij);function b4(t){return!!t||t===""}function oj(t,e){if(t.length!==e.length)return!1;let n=!0;for(let r=0;n&&r<t.length;r++)n=pS(t[r],e[r]);return n}function pS(t,e){if(t===e)return!0;let n=zM(t),r=zM(e);if(n||r)return n&&r?t.getTime()===e.getTime():!1;if(n=ld(t),r=ld(e),n||r)return t===e;if(n=Hi(t),r=Hi(e),n||r)return n&&r?oj(t,e):!1;if(n=cs(t),r=cs(e),n||r){if(!n||!r)return!1;const c=Object.keys(t).length,u=Object.keys(e).length;if(c!==u)return!1;for(const p in t){const o=t.hasOwnProperty(p),w=e.hasOwnProperty(p);if(o&&!w||!o&&w||!pS(t[p],e[p]))return!1}}return String(t)===String(e)}function sj(t,e){return t.findIndex(n=>pS(n,e))}const x4=t=>!!(t&&t.__v_isRef===!0),wr=t=>Fs(t)?t:t==null?"":Hi(t)||cs(t)&&(t.toString===_4||!_r(t.toString))?x4(t)?wr(t.value):JSON.stringify(t,w4,2):String(t),w4=(t,e)=>x4(e)?w4(t,e.value):B_(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[r,c],u)=>(n[S2(r,u)+" =>"]=c,n),{})}:cS(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>S2(n))}:ld(e)?S2(e):cs(e)&&!Hi(e)&&!y4(e)?String(e):e,S2=(t,e="")=>{var n;return ld(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.5.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let cc;class aj{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=cc,!e&&cc&&(this.index=(cc.scopes||(cc.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=cc;try{return cc=this,e()}finally{cc=n}}}on(){++this._on===1&&(this.prevScope=cc,cc=this)}off(){this._on>0&&--this._on===0&&(cc=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(this.effects.length=0,n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const c=this.parent.scopes.pop();c&&c!==this&&(this.parent.scopes[this.index]=c,c.index=this.index)}this.parent=void 0}}}function lj(){return cc}let gs;const C2=new WeakSet;class S4{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,cc&&cc.active&&cc.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,C2.has(this)&&(C2.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||T4(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,FM(this),E4(this);const e=gs,n=sd;gs=this,sd=!0;try{return this.fn()}finally{I4(this),gs=e,sd=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)qE(e);this.deps=this.depsTail=void 0,FM(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?C2.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){kT(this)&&this.run()}get dirty(){return kT(this)}}let C4=0,tb,nb;function T4(t,e=!1){if(t.flags|=8,e){t.next=nb,nb=t;return}t.next=tb,tb=t}function GE(){C4++}function WE(){if(--C4>0)return;if(nb){let e=nb;for(nb=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;tb;){let e=tb;for(tb=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){t||(t=r)}e=n}}if(t)throw t}function E4(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function I4(t){let e,n=t.depsTail,r=n;for(;r;){const c=r.prevDep;r.version===-1?(r===n&&(n=c),qE(r),cj(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=c}t.deps=e,t.depsTail=n}function kT(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(A4(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function A4(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===wb)||(t.globalVersion=wb,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!kT(t))))return;t.flags|=2;const e=t.dep,n=gs,r=sd;gs=t,sd=!0;try{E4(t);const c=t.fn(t._value);(e.version===0||Rp(c,t._value))&&(t.flags|=128,t._value=c,e.version++)}catch(c){throw e.version++,c}finally{gs=n,sd=r,I4(t),t.flags&=-3}}function qE(t,e=!1){const{dep:n,prevSub:r,nextSub:c}=t;if(r&&(r.nextSub=c,t.prevSub=void 0),c&&(c.prevSub=r,t.nextSub=void 0),n.subs===t&&(n.subs=r,!r&&n.computed)){n.computed.flags&=-5;for(let u=n.computed.deps;u;u=u.nextDep)qE(u,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function cj(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let sd=!0;const k4=[];function rf(){k4.push(sd),sd=!1}function of(){const t=k4.pop();sd=t===void 0?!0:t}function FM(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=gs;gs=void 0;try{e()}finally{gs=n}}}let wb=0;class uj{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class ZE{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!gs||!sd||gs===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==gs)n=this.activeLink=new uj(gs,this),gs.deps?(n.prevDep=gs.depsTail,gs.depsTail.nextDep=n,gs.depsTail=n):gs.deps=gs.depsTail=n,R4(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const r=n.nextDep;r.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=r),n.prevDep=gs.depsTail,n.nextDep=void 0,gs.depsTail.nextDep=n,gs.depsTail=n,gs.deps===n&&(gs.deps=r)}return n}trigger(e){this.version++,wb++,this.notify(e)}notify(e){GE();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{WE()}}}function R4(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)R4(r)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const RT=new WeakMap,rg=Symbol(""),PT=Symbol(""),Sb=Symbol("");function ul(t,e,n){if(sd&&gs){let r=RT.get(t);r||RT.set(t,r=new Map);let c=r.get(n);c||(r.set(n,c=new ZE),c.map=r,c.key=n),c.track()}}function qh(t,e,n,r,c,u){const p=RT.get(t);if(!p){wb++;return}const o=w=>{w&&w.trigger()};if(GE(),e==="clear")p.forEach(o);else{const w=Hi(t),T=w&&HE(n);if(w&&n==="length"){const A=Number(r);p.forEach((D,B)=>{(B==="length"||B===Sb||!ld(B)&&B>=A)&&o(D)})}else switch((n!==void 0||p.has(void 0))&&o(p.get(n)),T&&o(p.get(Sb)),e){case"add":w?T&&o(p.get("length")):(o(p.get(rg)),B_(t)&&o(p.get(PT)));break;case"delete":w||(o(p.get(rg)),B_(t)&&o(p.get(PT)));break;case"set":B_(t)&&o(p.get(rg));break}}WE()}function C_(t){const e=Do(t);return e===t?e:(ul(e,"iterate",Sb),yu(t)?e:e.map(qa))}function mS(t){return ul(t=Do(t),"iterate",Sb),t}const dj={__proto__:null,[Symbol.iterator](){return T2(this,Symbol.iterator,qa)},concat(...t){return C_(this).concat(...t.map(e=>Hi(e)?C_(e):e))},entries(){return T2(this,"entries",t=>(t[1]=qa(t[1]),t))},every(t,e){return zh(this,"every",t,e,void 0,arguments)},filter(t,e){return zh(this,"filter",t,e,n=>n.map(qa),arguments)},find(t,e){return zh(this,"find",t,e,qa,arguments)},findIndex(t,e){return zh(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return zh(this,"findLast",t,e,qa,arguments)},findLastIndex(t,e){return zh(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return zh(this,"forEach",t,e,void 0,arguments)},includes(...t){return E2(this,"includes",t)},indexOf(...t){return E2(this,"indexOf",t)},join(t){return C_(this).join(t)},lastIndexOf(...t){return E2(this,"lastIndexOf",t)},map(t,e){return zh(this,"map",t,e,void 0,arguments)},pop(){return Dv(this,"pop")},push(...t){return Dv(this,"push",t)},reduce(t,...e){return NM(this,"reduce",t,e)},reduceRight(t,...e){return NM(this,"reduceRight",t,e)},shift(){return Dv(this,"shift")},some(t,e){return zh(this,"some",t,e,void 0,arguments)},splice(...t){return Dv(this,"splice",t)},toReversed(){return C_(this).toReversed()},toSorted(t){return C_(this).toSorted(t)},toSpliced(...t){return C_(this).toSpliced(...t)},unshift(...t){return Dv(this,"unshift",t)},values(){return T2(this,"values",qa)}};function T2(t,e,n){const r=mS(t),c=r[e]();return r!==t&&!yu(t)&&(c._next=c.next,c.next=()=>{const u=c._next();return u.value&&(u.value=n(u.value)),u}),c}const hj=Array.prototype;function zh(t,e,n,r,c,u){const p=mS(t),o=p!==t&&!yu(t),w=p[e];if(w!==hj[e]){const D=w.apply(t,u);return o?qa(D):D}let T=n;p!==t&&(o?T=function(D,B){return n.call(this,qa(D),B,t)}:n.length>2&&(T=function(D,B){return n.call(this,D,B,t)}));const A=w.call(p,T,r);return o&&c?c(A):A}function NM(t,e,n,r){const c=mS(t);let u=n;return c!==t&&(yu(t)?n.length>3&&(u=function(p,o,w){return n.call(this,p,o,w,t)}):u=function(p,o,w){return n.call(this,p,qa(o),w,t)}),c[e](u,...r)}function E2(t,e,n){const r=Do(t);ul(r,"iterate",Sb);const c=r[e](...n);return(c===-1||c===!1)&&JE(n[0])?(n[0]=Do(n[0]),r[e](...n)):c}function Dv(t,e,n=[]){rf(),GE();const r=Do(t)[e].apply(t,n);return WE(),of(),r}const fj=$E("__proto__,__v_isRef,__isVue"),P4=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(ld));function pj(t){ld(t)||(t=String(t));const e=Do(this);return ul(e,"has",t),e.hasOwnProperty(t)}class M4{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,r){if(n==="__v_skip")return e.__v_skip;const c=this._isReadonly,u=this._isShallow;if(n==="__v_isReactive")return!c;if(n==="__v_isReadonly")return c;if(n==="__v_isShallow")return u;if(n==="__v_raw")return r===(c?u?Cj:z4:u?L4:O4).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const p=Hi(e);if(!c){let w;if(p&&(w=dj[n]))return w;if(n==="hasOwnProperty")return pj}const o=Reflect.get(e,n,ml(e)?e:r);return(ld(n)?P4.has(n):fj(n))||(c||ul(e,"get",n),u)?o:ml(o)?p&&HE(n)?o:o.value:cs(o)?c?XE(o):T0(o):o}}class D4 extends M4{constructor(e=!1){super(!1,e)}set(e,n,r,c){let u=e[n];if(!this._isShallow){const w=Bp(u);if(!yu(r)&&!Bp(r)&&(u=Do(u),r=Do(r)),!Hi(e)&&ml(u)&&!ml(r))return w||(u.value=r),!0}const p=Hi(e)&&HE(n)?Number(n)<e.length:Fo(e,n),o=Reflect.set(e,n,r,ml(e)?e:c);return e===Do(c)&&(p?Rp(r,u)&&qh(e,"set",n,r):qh(e,"add",n,r)),o}deleteProperty(e,n){const r=Fo(e,n);e[n];const c=Reflect.deleteProperty(e,n);return c&&r&&qh(e,"delete",n,void 0),c}has(e,n){const r=Reflect.has(e,n);return(!ld(n)||!P4.has(n))&&ul(e,"has",n),r}ownKeys(e){return ul(e,"iterate",Hi(e)?"length":rg),Reflect.ownKeys(e)}}class mj extends M4{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const gj=new D4,_j=new mj,yj=new D4(!0);const MT=t=>t,ix=t=>Reflect.getPrototypeOf(t);function vj(t,e,n){return function(...r){const c=this.__v_raw,u=Do(c),p=B_(u),o=t==="entries"||t===Symbol.iterator&&p,w=t==="keys"&&p,T=c[t](...r),A=n?MT:e?hw:qa;return!e&&ul(u,"iterate",w?PT:rg),{next(){const{value:D,done:B}=T.next();return B?{value:D,done:B}:{value:o?[A(D[0]),A(D[1])]:A(D),done:B}},[Symbol.iterator](){return this}}}}function rx(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function bj(t,e){const n={get(c){const u=this.__v_raw,p=Do(u),o=Do(c);t||(Rp(c,o)&&ul(p,"get",c),ul(p,"get",o));const{has:w}=ix(p),T=e?MT:t?hw:qa;if(w.call(p,c))return T(u.get(c));if(w.call(p,o))return T(u.get(o));u!==p&&u.get(c)},get size(){const c=this.__v_raw;return!t&&ul(Do(c),"iterate",rg),c.size},has(c){const u=this.__v_raw,p=Do(u),o=Do(c);return t||(Rp(c,o)&&ul(p,"has",c),ul(p,"has",o)),c===o?u.has(c):u.has(c)||u.has(o)},forEach(c,u){const p=this,o=p.__v_raw,w=Do(o),T=e?MT:t?hw:qa;return!t&&ul(w,"iterate",rg),o.forEach((A,D)=>c.call(u,T(A),T(D),p))}};return Ba(n,t?{add:rx("add"),set:rx("set"),delete:rx("delete"),clear:rx("clear")}:{add(c){!e&&!yu(c)&&!Bp(c)&&(c=Do(c));const u=Do(this);return ix(u).has.call(u,c)||(u.add(c),qh(u,"add",c,c)),this},set(c,u){!e&&!yu(u)&&!Bp(u)&&(u=Do(u));const p=Do(this),{has:o,get:w}=ix(p);let T=o.call(p,c);T||(c=Do(c),T=o.call(p,c));const A=w.call(p,c);return p.set(c,u),T?Rp(u,A)&&qh(p,"set",c,u):qh(p,"add",c,u),this},delete(c){const u=Do(this),{has:p,get:o}=ix(u);let w=p.call(u,c);w||(c=Do(c),w=p.call(u,c)),o&&o.call(u,c);const T=u.delete(c);return w&&qh(u,"delete",c,void 0),T},clear(){const c=Do(this),u=c.size!==0,p=c.clear();return u&&qh(c,"clear",void 0,void 0),p}}),["keys","values","entries",Symbol.iterator].forEach(c=>{n[c]=vj(c,t,e)}),n}function KE(t,e){const n=bj(t,e);return(r,c,u)=>c==="__v_isReactive"?!t:c==="__v_isReadonly"?t:c==="__v_raw"?r:Reflect.get(Fo(n,c)&&c in r?n:r,c,u)}const xj={get:KE(!1,!1)},wj={get:KE(!1,!0)},Sj={get:KE(!0,!1)};const O4=new WeakMap,L4=new WeakMap,z4=new WeakMap,Cj=new WeakMap;function Tj(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Ej(t){return t.__v_skip||!Object.isExtensible(t)?0:Tj(K$(t))}function T0(t){return Bp(t)?t:YE(t,!1,gj,xj,O4)}function B4(t){return YE(t,!1,yj,wj,L4)}function XE(t){return YE(t,!0,_j,Sj,z4)}function YE(t,e,n,r,c){if(!cs(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const u=Ej(t);if(u===0)return t;const p=c.get(t);if(p)return p;const o=new Proxy(t,u===2?r:n);return c.set(t,o),o}function F_(t){return Bp(t)?F_(t.__v_raw):!!(t&&t.__v_isReactive)}function Bp(t){return!!(t&&t.__v_isReadonly)}function yu(t){return!!(t&&t.__v_isShallow)}function JE(t){return t?!!t.__v_raw:!1}function Do(t){const e=t&&t.__v_raw;return e?Do(e):t}function Ij(t){return!Fo(t,"__v_skip")&&Object.isExtensible(t)&&v4(t,"__v_skip",!0),t}const qa=t=>cs(t)?T0(t):t,hw=t=>cs(t)?XE(t):t;function ml(t){return t?t.__v_isRef===!0:!1}function Si(t){return F4(t,!1)}function Aj(t){return F4(t,!0)}function F4(t,e){return ml(t)?t:new kj(t,e)}class kj{constructor(e,n){this.dep=new ZE,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:Do(e),this._value=n?e:qa(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,r=this.__v_isShallow||yu(e)||Bp(e);e=r?e:Do(e),Rp(e,n)&&(this._rawValue=e,this._value=r?e:qa(e),this.dep.trigger())}}function ss(t){return ml(t)?t.value:t}const Rj={get:(t,e,n)=>e==="__v_raw"?t:ss(Reflect.get(t,e,n)),set:(t,e,n,r)=>{const c=t[e];return ml(c)&&!ml(n)?(c.value=n,!0):Reflect.set(t,e,n,r)}};function N4(t){return F_(t)?t:new Proxy(t,Rj)}class Pj{constructor(e,n,r){this.fn=e,this.setter=n,this._value=void 0,this.dep=new ZE(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=wb-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&gs!==this)return T4(this,!0),!0}get value(){const e=this.dep.track();return A4(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Mj(t,e,n=!1){let r,c;return _r(t)?r=t:(r=t.get,c=t.set),new Pj(r,c,n)}const ox={},fw=new WeakMap;let Um;function Dj(t,e=!1,n=Um){if(n){let r=fw.get(n);r||fw.set(n,r=[]),r.push(t)}}function Oj(t,e,n=as){const{immediate:r,deep:c,once:u,scheduler:p,augmentJob:o,call:w}=n,T=xe=>c?xe:yu(xe)||c===!1||c===0?Zh(xe,1):Zh(xe);let A,D,B,N,ee=!1,Q=!1;if(ml(t)?(D=()=>t.value,ee=yu(t)):F_(t)?(D=()=>T(t),ee=!0):Hi(t)?(Q=!0,ee=t.some(xe=>F_(xe)||yu(xe)),D=()=>t.map(xe=>{if(ml(xe))return xe.value;if(F_(xe))return T(xe);if(_r(xe))return w?w(xe,2):xe()})):_r(t)?e?D=w?()=>w(t,2):t:D=()=>{if(B){rf();try{B()}finally{of()}}const xe=Um;Um=A;try{return w?w(t,3,[N]):t(N)}finally{Um=xe}}:D=nh,e&&c){const xe=D,je=c===!0?1/0:c;D=()=>Zh(xe(),je)}const se=lj(),ce=()=>{A.stop(),se&&se.active&&UE(se.effects,A)};if(u&&e){const xe=e;e=(...je)=>{xe(...je),ce()}}let be=Q?new Array(t.length).fill(ox):ox;const ze=xe=>{if(!(!(A.flags&1)||!A.dirty&&!xe))if(e){const je=A.run();if(c||ee||(Q?je.some((qe,oe)=>Rp(qe,be[oe])):Rp(je,be))){B&&B();const qe=Um;Um=A;try{const oe=[je,be===ox?void 0:Q&&be[0]===ox?[]:be,N];be=je,w?w(e,3,oe):e(...oe)}finally{Um=qe}}}else A.run()};return o&&o(ze),A=new S4(D),A.scheduler=p?()=>p(ze,!1):ze,N=xe=>Dj(xe,!1,A),B=A.onStop=()=>{const xe=fw.get(A);if(xe){if(w)w(xe,4);else for(const je of xe)je();fw.delete(A)}},e?r?ze(!0):be=A.run():p?p(ze.bind(null,!0),!0):A.run(),ce.pause=A.pause.bind(A),ce.resume=A.resume.bind(A),ce.stop=ce,ce}function Zh(t,e=1/0,n){if(e<=0||!cs(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,ml(t))Zh(t.value,e,n);else if(Hi(t))for(let r=0;r<t.length;r++)Zh(t[r],e,n);else if(cS(t)||B_(t))t.forEach(r=>{Zh(r,e,n)});else if(y4(t)){for(const r in t)Zh(t[r],e,n);for(const r of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,r)&&Zh(t[r],e,n)}return t}/**
* @vue/runtime-core v3.5.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function E0(t,e,n,r){try{return r?t(...r):t()}catch(c){gS(c,e,n)}}function cd(t,e,n,r){if(_r(t)){const c=E0(t,e,n,r);return c&&g4(c)&&c.catch(u=>{gS(u,e,n)}),c}if(Hi(t)){const c=[];for(let u=0;u<t.length;u++)c.push(cd(t[u],e,n,r));return c}}function gS(t,e,n,r=!0){const c=e?e.vnode:null,{errorHandler:u,throwUnhandledErrorInProduction:p}=e&&e.appContext.config||as;if(e){let o=e.parent;const w=e.proxy,T=`https://vuejs.org/error-reference/#runtime-${n}`;for(;o;){const A=o.ec;if(A){for(let D=0;D<A.length;D++)if(A[D](t,w,T)===!1)return}o=o.parent}if(u){rf(),E0(u,null,10,[t,w,T]),of();return}}Lj(t,n,c,r,p)}function Lj(t,e,n,r=!0,c=!1){if(c)throw t;console.error(t)}const jl=[];let Wd=-1;const N_=[];let hp=null,E_=0;const V4=Promise.resolve();let pw=null;function hy(t){const e=pw||V4;return t?e.then(this?t.bind(this):t):e}function zj(t){let e=Wd+1,n=jl.length;for(;e<n;){const r=e+n>>>1,c=jl[r],u=Cb(c);u<t||u===t&&c.flags&2?e=r+1:n=r}return e}function QE(t){if(!(t.flags&1)){const e=Cb(t),n=jl[jl.length-1];!n||!(t.flags&2)&&e>=Cb(n)?jl.push(t):jl.splice(zj(e),0,t),t.flags|=1,$4()}}function $4(){pw||(pw=V4.then(U4))}function Bj(t){Hi(t)?N_.push(...t):hp&&t.id===-1?hp.splice(E_+1,0,t):t.flags&1||(N_.push(t),t.flags|=1),$4()}function VM(t,e,n=Wd+1){for(;n<jl.length;n++){const r=jl[n];if(r&&r.flags&2){if(t&&r.id!==t.uid)continue;jl.splice(n,1),n--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function j4(t){if(N_.length){const e=[...new Set(N_)].sort((n,r)=>Cb(n)-Cb(r));if(N_.length=0,hp){hp.push(...e);return}for(hp=e,E_=0;E_<hp.length;E_++){const n=hp[E_];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}hp=null,E_=0}}const Cb=t=>t.id==null?t.flags&2?-1:1/0:t.id;function U4(t){try{for(Wd=0;Wd<jl.length;Wd++){const e=jl[Wd];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),E0(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Wd<jl.length;Wd++){const e=jl[Wd];e&&(e.flags&=-2)}Wd=-1,jl.length=0,j4(),pw=null,(jl.length||N_.length)&&U4()}}let Za=null,H4=null;function mw(t){const e=Za;return Za=t,H4=t&&t.type.__scopeId||null,e}function si(t,e=Za,n){if(!e||t._n)return t;const r=(...c)=>{r._d&&eD(-1);const u=mw(e);let p;try{p=t(...c)}finally{mw(u),r._d&&eD(1)}return p};return r._n=!0,r._c=!0,r._d=!0,r}function Ki(t,e){if(Za===null)return t;const n=wS(Za),r=t.dirs||(t.dirs=[]);for(let c=0;c<e.length;c++){let[u,p,o,w=as]=e[c];u&&(_r(u)&&(u={mounted:u,updated:u}),u.deep&&Zh(p),r.push({dir:u,instance:n,value:p,oldValue:void 0,arg:o,modifiers:w}))}return t}function Om(t,e,n,r){const c=t.dirs,u=e&&e.dirs;for(let p=0;p<c.length;p++){const o=c[p];u&&(o.oldValue=u[p].value);let w=o.dir[r];w&&(rf(),cd(w,n,8,[t.el,o,t,e]),of())}}const G4=Symbol("_vte"),W4=t=>t.__isTeleport,ib=t=>t&&(t.disabled||t.disabled===""),$M=t=>t&&(t.defer||t.defer===""),jM=t=>typeof SVGElement<"u"&&t instanceof SVGElement,UM=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,DT=(t,e)=>{const n=t&&t.to;return Fs(n)?e?e(n):null:n},q4={name:"Teleport",__isTeleport:!0,process(t,e,n,r,c,u,p,o,w,T){const{mc:A,pc:D,pbc:B,o:{insert:N,querySelector:ee,createText:Q,createComment:se}}=T,ce=ib(e.props);let{shapeFlag:be,children:ze,dynamicChildren:xe}=e;if(t==null){const je=e.el=Q(""),qe=e.anchor=Q("");N(je,n,r),N(qe,n,r);const oe=(Ee,$e)=>{be&16&&(c&&c.isCE&&(c.ce._teleportTarget=Ee),A(ze,Ee,$e,c,u,p,o,w))},de=()=>{const Ee=e.target=DT(e.props,ee),$e=Z4(Ee,e,Q,N);Ee&&(p!=="svg"&&jM(Ee)?p="svg":p!=="mathml"&&UM(Ee)&&(p="mathml"),ce||(oe(Ee,$e),jx(e,!1)))};ce&&(oe(n,qe),jx(e,!0)),$M(e.props)?(e.el.__isMounted=!1,Fl(()=>{de(),delete e.el.__isMounted},u)):de()}else{if($M(e.props)&&t.el.__isMounted===!1){Fl(()=>{q4.process(t,e,n,r,c,u,p,o,w,T)},u);return}e.el=t.el,e.targetStart=t.targetStart;const je=e.anchor=t.anchor,qe=e.target=t.target,oe=e.targetAnchor=t.targetAnchor,de=ib(t.props),Ee=de?n:qe,$e=de?je:oe;if(p==="svg"||jM(qe)?p="svg":(p==="mathml"||UM(qe))&&(p="mathml"),xe?(B(t.dynamicChildren,xe,Ee,c,u,p,o),rI(t,e,!0)):w||D(t,e,Ee,$e,c,u,p,o,!1),ce)de?e.props&&t.props&&e.props.to!==t.props.to&&(e.props.to=t.props.to):sx(e,n,je,T,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const me=e.target=DT(e.props,ee);me&&sx(e,me,null,T,0)}else de&&sx(e,qe,oe,T,1);jx(e,ce)}},remove(t,e,n,{um:r,o:{remove:c}},u){const{shapeFlag:p,children:o,anchor:w,targetStart:T,targetAnchor:A,target:D,props:B}=t;if(D&&(c(T),c(A)),u&&c(w),p&16){const N=u||!ib(B);for(let ee=0;ee<o.length;ee++){const Q=o[ee];r(Q,e,n,N,!!Q.dynamicChildren)}}},move:sx,hydrate:Fj};function sx(t,e,n,{o:{insert:r},m:c},u=2){u===0&&r(t.targetAnchor,e,n);const{el:p,anchor:o,shapeFlag:w,children:T,props:A}=t,D=u===2;if(D&&r(p,e,n),(!D||ib(A))&&w&16)for(let B=0;B<T.length;B++)c(T[B],e,n,2);D&&r(o,e,n)}function Fj(t,e,n,r,c,u,{o:{nextSibling:p,parentNode:o,querySelector:w,insert:T,createText:A}},D){const B=e.target=DT(e.props,w);if(B){const N=ib(e.props),ee=B._lpa||B.firstChild;if(e.shapeFlag&16)if(N)e.anchor=D(p(t),e,o(t),n,r,c,u),e.targetStart=ee,e.targetAnchor=ee&&p(ee);else{e.anchor=p(t);let Q=ee;for(;Q;){if(Q&&Q.nodeType===8){if(Q.data==="teleport start anchor")e.targetStart=Q;else if(Q.data==="teleport anchor"){e.targetAnchor=Q,B._lpa=e.targetAnchor&&p(e.targetAnchor);break}}Q=p(Q)}e.targetAnchor||Z4(B,e,A,T),D(ee&&p(ee),e,B,n,r,c,u)}jx(e,N)}return e.anchor&&p(e.anchor)}const Nj=q4;function jx(t,e){const n=t.ctx;if(n&&n.ut){let r,c;for(e?(r=t.el,c=t.anchor):(r=t.targetStart,c=t.targetAnchor);r&&r!==c;)r.nodeType===1&&r.setAttribute("data-v-owner",n.uid),r=r.nextSibling;n.ut()}}function Z4(t,e,n,r){const c=e.targetStart=n(""),u=e.targetAnchor=n("");return c[G4]=u,t&&(r(c,t),r(u,t)),u}const Gh=Symbol("_leaveCb"),ax=Symbol("_enterCb");function Vj(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return lh(()=>{t.isMounted=!0}),vS(()=>{t.isUnmounting=!0}),t}const hu=[Function,Array],K4={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:hu,onEnter:hu,onAfterEnter:hu,onEnterCancelled:hu,onBeforeLeave:hu,onLeave:hu,onAfterLeave:hu,onLeaveCancelled:hu,onBeforeAppear:hu,onAppear:hu,onAfterAppear:hu,onAppearCancelled:hu},X4=t=>{const e=t.subTree;return e.component?X4(e.component):e},$j={name:"BaseTransition",props:K4,setup(t,{slots:e}){const n=kb(),r=Vj();return()=>{const c=e.default&&Q4(e.default(),!0);if(!c||!c.length)return;const u=Y4(c),p=Do(t),{mode:o}=p;if(r.isLeaving)return I2(u);const w=HM(u);if(!w)return I2(u);let T=OT(w,p,r,n,D=>T=D);w.type!==dl&&Tb(w,T);let A=n.subTree&&HM(n.subTree);if(A&&A.type!==dl&&!Km(w,A)&&X4(n).type!==dl){let D=OT(A,p,r,n);if(Tb(A,D),o==="out-in"&&w.type!==dl)return r.isLeaving=!0,D.afterLeave=()=>{r.isLeaving=!1,n.job.flags&8||n.update(),delete D.afterLeave,A=void 0},I2(u);o==="in-out"&&w.type!==dl?D.delayLeave=(B,N,ee)=>{const Q=J4(r,A);Q[String(A.key)]=A,B[Gh]=()=>{N(),B[Gh]=void 0,delete T.delayedLeave,A=void 0},T.delayedLeave=()=>{ee(),delete T.delayedLeave,A=void 0}}:A=void 0}else A&&(A=void 0);return u}}};function Y4(t){let e=t[0];if(t.length>1){for(const n of t)if(n.type!==dl){e=n;break}}return e}const jj=$j;function J4(t,e){const{leavingVNodes:n}=t;let r=n.get(e.type);return r||(r=Object.create(null),n.set(e.type,r)),r}function OT(t,e,n,r,c){const{appear:u,mode:p,persisted:o=!1,onBeforeEnter:w,onEnter:T,onAfterEnter:A,onEnterCancelled:D,onBeforeLeave:B,onLeave:N,onAfterLeave:ee,onLeaveCancelled:Q,onBeforeAppear:se,onAppear:ce,onAfterAppear:be,onAppearCancelled:ze}=e,xe=String(t.key),je=J4(n,t),qe=(Ee,$e)=>{Ee&&cd(Ee,r,9,$e)},oe=(Ee,$e)=>{const me=$e[1];qe(Ee,$e),Hi(Ee)?Ee.every(Te=>Te.length<=1)&&me():Ee.length<=1&&me()},de={mode:p,persisted:o,beforeEnter(Ee){let $e=w;if(!n.isMounted)if(u)$e=se||w;else return;Ee[Gh]&&Ee[Gh](!0);const me=je[xe];me&&Km(t,me)&&me.el[Gh]&&me.el[Gh](),qe($e,[Ee])},enter(Ee){let $e=T,me=A,Te=D;if(!n.isMounted)if(u)$e=ce||T,me=be||A,Te=ze||D;else return;let Re=!1;const tn=Ee[ax]=Zt=>{Re||(Re=!0,Zt?qe(Te,[Ee]):qe(me,[Ee]),de.delayedLeave&&de.delayedLeave(),Ee[ax]=void 0)};$e?oe($e,[Ee,tn]):tn()},leave(Ee,$e){const me=String(t.key);if(Ee[ax]&&Ee[ax](!0),n.isUnmounting)return $e();qe(B,[Ee]);let Te=!1;const Re=Ee[Gh]=tn=>{Te||(Te=!0,$e(),tn?qe(Q,[Ee]):qe(ee,[Ee]),Ee[Gh]=void 0,je[me]===t&&delete je[me])};je[me]=t,N?oe(N,[Ee,Re]):Re()},clone(Ee){const $e=OT(Ee,e,n,r,c);return c&&c($e),$e}};return de}function I2(t){if(_S(t))return t=Fp(t),t.children=null,t}function HM(t){if(!_S(t))return W4(t.type)&&t.children?Y4(t.children):t;if(t.component)return t.component.subTree;const{shapeFlag:e,children:n}=t;if(n){if(e&16)return n[0];if(e&32&&_r(n.default))return n.default()}}function Tb(t,e){t.shapeFlag&6&&t.component?(t.transition=e,Tb(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Q4(t,e=!1,n){let r=[],c=0;for(let u=0;u<t.length;u++){let p=t[u];const o=n==null?p.key:String(n)+String(p.key!=null?p.key:u);p.type===Mi?(p.patchFlag&128&&c++,r=r.concat(Q4(p.children,e,o))):(e||p.type!==dl)&&r.push(o!=null?Fp(p,{key:o}):p)}if(c>1)for(let u=0;u<r.length;u++)r[u].patchFlag=-2;return r}/*! #__NO_SIDE_EFFECTS__ */function ez(t,e){return _r(t)?Ba({name:t.name},e,{setup:t}):t}function Uj(){const t=kb();return t?(t.appContext.config.idPrefix||"v")+"-"+t.ids[0]+t.ids[1]++:""}function tz(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function rb(t,e,n,r,c=!1){if(Hi(t)){t.forEach((ee,Q)=>rb(ee,e&&(Hi(e)?e[Q]:e),n,r,c));return}if(V_(r)&&!c){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&rb(t,e,n,r.component.subTree);return}const u=r.shapeFlag&4?wS(r.component):r.el,p=c?null:u,{i:o,r:w}=t,T=e&&e.r,A=o.refs===as?o.refs={}:o.refs,D=o.setupState,B=Do(D),N=D===as?m4:ee=>Fo(B,ee);if(T!=null&&T!==w){if(Fs(T))A[T]=null,N(T)&&(D[T]=null);else if(ml(T)){T.value=null;const ee=e;ee.k&&(A[ee.k]=null)}}if(_r(w))E0(w,o,12,[p,A]);else{const ee=Fs(w),Q=ml(w);if(ee||Q){const se=()=>{if(t.f){const ce=ee?N(w)?D[w]:A[w]:w.value;if(c)Hi(ce)&&UE(ce,u);else if(Hi(ce))ce.includes(u)||ce.push(u);else if(ee)A[w]=[u],N(w)&&(D[w]=A[w]);else{const be=[u];w.value=be,t.k&&(A[t.k]=be)}}else ee?(A[w]=p,N(w)&&(D[w]=p)):Q&&(w.value=p,t.k&&(A[t.k]=p))};p?(se.id=-1,Fl(se,n)):se()}}}hS().requestIdleCallback;hS().cancelIdleCallback;const V_=t=>!!t.type.__asyncLoader,_S=t=>t.type.__isKeepAlive;function Hj(t,e){nz(t,"a",e)}function Gj(t,e){nz(t,"da",e)}function nz(t,e,n=hl){const r=t.__wdc||(t.__wdc=()=>{let c=n;for(;c;){if(c.isDeactivated)return;c=c.parent}return t()});if(yS(e,r,n),n){let c=n.parent;for(;c&&c.parent;)_S(c.parent.vnode)&&Wj(r,e,n,c),c=c.parent}}function Wj(t,e,n,r){const c=yS(e,t,r,!0);iz(()=>{UE(r[e],c)},n)}function yS(t,e,n=hl,r=!1){if(n){const c=n[t]||(n[t]=[]),u=e.__weh||(e.__weh=(...p)=>{rf();const o=I0(n),w=cd(e,n,t,p);return o(),of(),w});return r?c.unshift(u):c.push(u),u}}const cf=t=>(e,n=hl)=>{(!Rb||t==="sp")&&yS(t,(...r)=>e(...r),n)},qj=cf("bm"),lh=cf("m"),Zj=cf("bu"),Kj=cf("u"),vS=cf("bum"),iz=cf("um"),Xj=cf("sp"),Yj=cf("rtg"),Jj=cf("rtc");function Qj(t,e=hl){yS("ec",t,e)}const eI="components",eU="directives";function Ai(t,e){return tI(eI,t,!0,e)||t}const rz=Symbol.for("v-ndc");function lr(t){return Fs(t)?tI(eI,t,!1)||t:t||rz}function uf(t){return tI(eU,t)}function tI(t,e,n=!0,r=!1){const c=Za||hl;if(c){const u=c.type;if(t===eI){const o=NU(u,!1);if(o&&(o===e||o===bu(e)||o===dS(bu(e))))return u}const p=GM(c[t]||u[t],e)||GM(c.appContext[t],e);return!p&&r?u:p}}function GM(t,e){return t&&(t[e]||t[bu(e)]||t[dS(bu(e))])}function ea(t,e,n,r){let c;const u=n,p=Hi(t);if(p||Fs(t)){const o=p&&F_(t);let w=!1,T=!1;o&&(w=!yu(t),T=Bp(t),t=mS(t)),c=new Array(t.length);for(let A=0,D=t.length;A<D;A++)c[A]=e(w?T?hw(qa(t[A])):qa(t[A]):t[A],A,void 0,u)}else if(typeof t=="number"){c=new Array(t);for(let o=0;o<t;o++)c[o]=e(o+1,o,void 0,u)}else if(cs(t))if(t[Symbol.iterator])c=Array.from(t,(o,w)=>e(o,w,void 0,u));else{const o=Object.keys(t);c=new Array(o.length);for(let w=0,T=o.length;w<T;w++){const A=o[w];c[w]=e(t[A],A,w,u)}}else c=[];return c}function Eb(t,e){for(let n=0;n<e.length;n++){const r=e[n];if(Hi(r))for(let c=0;c<r.length;c++)t[r[c].name]=r[c].fn;else r&&(t[r.name]=r.key?(...c)=>{const u=r.fn(...c);return u&&(u.key=r.key),u}:r.fn)}return t}function Ti(t,e,n={},r,c){if(Za.ce||Za.parent&&V_(Za.parent)&&Za.parent.ce)return e!=="default"&&(n.name=e),We(),Sn(Mi,null,[hi("slot",n,r&&r())],64);let u=t[e];u&&u._c&&(u._d=!1),We();const p=u&&oz(u(n)),o=n.key||p&&p.key,w=Sn(Mi,{key:(o&&!ld(o)?o:`_${e}`)+(!p&&r?"_fb":"")},p||(r?r():[]),p&&t._===1?64:-2);return w.scopeId&&(w.slotScopeIds=[w.scopeId+"-s"]),u&&u._c&&(u._d=!0),w}function oz(t){return t.some(e=>Ab(e)?!(e.type===dl||e.type===Mi&&!oz(e.children)):!0)?t:null}function lx(t,e){const n={};for(const r in t)n[/[A-Z]/.test(r)?`on:${r}`:Vx(r)]=t[r];return n}const LT=t=>t?Cz(t)?wS(t):LT(t.parent):null,ob=Ba(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>LT(t.parent),$root:t=>LT(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>az(t),$forceUpdate:t=>t.f||(t.f=()=>{QE(t.update)}),$nextTick:t=>t.n||(t.n=hy.bind(t.proxy)),$watch:t=>xU.bind(t)}),A2=(t,e)=>t!==as&&!t.__isScriptSetup&&Fo(t,e),tU={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:r,data:c,props:u,accessCache:p,type:o,appContext:w}=t;let T;if(e[0]!=="$"){const N=p[e];if(N!==void 0)switch(N){case 1:return r[e];case 2:return c[e];case 4:return n[e];case 3:return u[e]}else{if(A2(r,e))return p[e]=1,r[e];if(c!==as&&Fo(c,e))return p[e]=2,c[e];if((T=t.propsOptions[0])&&Fo(T,e))return p[e]=3,u[e];if(n!==as&&Fo(n,e))return p[e]=4,n[e];zT&&(p[e]=0)}}const A=ob[e];let D,B;if(A)return e==="$attrs"&&ul(t.attrs,"get",""),A(t);if((D=o.__cssModules)&&(D=D[e]))return D;if(n!==as&&Fo(n,e))return p[e]=4,n[e];if(B=w.config.globalProperties,Fo(B,e))return B[e]},set({_:t},e,n){const{data:r,setupState:c,ctx:u}=t;return A2(c,e)?(c[e]=n,!0):r!==as&&Fo(r,e)?(r[e]=n,!0):Fo(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(u[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:c,propsOptions:u,type:p}},o){let w,T;return!!(n[o]||t!==as&&o[0]!=="$"&&Fo(t,o)||A2(e,o)||(w=u[0])&&Fo(w,o)||Fo(r,o)||Fo(ob,o)||Fo(c.config.globalProperties,o)||(T=p.__cssModules)&&T[o])},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Fo(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function WM(t){return Hi(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let zT=!0;function nU(t){const e=az(t),n=t.proxy,r=t.ctx;zT=!1,e.beforeCreate&&qM(e.beforeCreate,t,"bc");const{data:c,computed:u,methods:p,watch:o,provide:w,inject:T,created:A,beforeMount:D,mounted:B,beforeUpdate:N,updated:ee,activated:Q,deactivated:se,beforeDestroy:ce,beforeUnmount:be,destroyed:ze,unmounted:xe,render:je,renderTracked:qe,renderTriggered:oe,errorCaptured:de,serverPrefetch:Ee,expose:$e,inheritAttrs:me,components:Te,directives:Re,filters:tn}=e;if(T&&iU(T,r,null),p)for(const hn in p){const Hn=p[hn];_r(Hn)&&(r[hn]=Hn.bind(n))}if(c){const hn=c.call(n,n);cs(hn)&&(t.data=T0(hn))}if(zT=!0,u)for(const hn in u){const Hn=u[hn],Ri=_r(Hn)?Hn.bind(n,n):_r(Hn.get)?Hn.get.bind(n,n):nh,zi=!_r(Hn)&&_r(Hn.set)?Hn.set.bind(n):nh,Pt=Dc({get:Ri,set:zi});Object.defineProperty(r,hn,{enumerable:!0,configurable:!0,get:()=>Pt.value,set:Di=>Pt.value=Di})}if(o)for(const hn in o)sz(o[hn],r,n,hn);if(w){const hn=_r(w)?w.call(n):w;Reflect.ownKeys(hn).forEach(Hn=>{Ux(Hn,hn[Hn])})}A&&qM(A,t,"c");function on(hn,Hn){Hi(Hn)?Hn.forEach(Ri=>hn(Ri.bind(n))):Hn&&hn(Hn.bind(n))}if(on(qj,D),on(lh,B),on(Zj,N),on(Kj,ee),on(Hj,Q),on(Gj,se),on(Qj,de),on(Jj,qe),on(Yj,oe),on(vS,be),on(iz,xe),on(Xj,Ee),Hi($e))if($e.length){const hn=t.exposed||(t.exposed={});$e.forEach(Hn=>{Object.defineProperty(hn,Hn,{get:()=>n[Hn],set:Ri=>n[Hn]=Ri,enumerable:!0})})}else t.exposed||(t.exposed={});je&&t.render===nh&&(t.render=je),me!=null&&(t.inheritAttrs=me),Te&&(t.components=Te),Re&&(t.directives=Re),Ee&&tz(t)}function iU(t,e,n=nh){Hi(t)&&(t=BT(t));for(const r in t){const c=t[r];let u;cs(c)?"default"in c?u=ad(c.from||r,c.default,!0):u=ad(c.from||r):u=ad(c),ml(u)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>u.value,set:p=>u.value=p}):e[r]=u}}function qM(t,e,n){cd(Hi(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,n)}function sz(t,e,n,r){let c=r.includes(".")?vz(n,r):()=>n[r];if(Fs(t)){const u=e[t];_r(u)&&gu(c,u)}else if(_r(t))gu(c,t.bind(n));else if(cs(t))if(Hi(t))t.forEach(u=>sz(u,e,n,r));else{const u=_r(t.handler)?t.handler.bind(n):e[t.handler];_r(u)&&gu(c,u,t)}}function az(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:c,optionsCache:u,config:{optionMergeStrategies:p}}=t.appContext,o=u.get(e);let w;return o?w=o:!c.length&&!n&&!r?w=e:(w={},c.length&&c.forEach(T=>gw(w,T,p,!0)),gw(w,e,p)),cs(e)&&u.set(e,w),w}function gw(t,e,n,r=!1){const{mixins:c,extends:u}=e;u&&gw(t,u,n,!0),c&&c.forEach(p=>gw(t,p,n,!0));for(const p in e)if(!(r&&p==="expose")){const o=rU[p]||n&&n[p];t[p]=o?o(t[p],e[p]):e[p]}return t}const rU={data:ZM,props:KM,emits:KM,methods:Gv,computed:Gv,beforeCreate:Bl,created:Bl,beforeMount:Bl,mounted:Bl,beforeUpdate:Bl,updated:Bl,beforeDestroy:Bl,beforeUnmount:Bl,destroyed:Bl,unmounted:Bl,activated:Bl,deactivated:Bl,errorCaptured:Bl,serverPrefetch:Bl,components:Gv,directives:Gv,watch:sU,provide:ZM,inject:oU};function ZM(t,e){return e?t?function(){return Ba(_r(t)?t.call(this,this):t,_r(e)?e.call(this,this):e)}:e:t}function oU(t,e){return Gv(BT(t),BT(e))}function BT(t){if(Hi(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function Bl(t,e){return t?[...new Set([].concat(t,e))]:e}function Gv(t,e){return t?Ba(Object.create(null),t,e):e}function KM(t,e){return t?Hi(t)&&Hi(e)?[...new Set([...t,...e])]:Ba(Object.create(null),WM(t),WM(e??{})):e}function sU(t,e){if(!t)return e;if(!e)return t;const n=Ba(Object.create(null),t);for(const r in e)n[r]=Bl(t[r],e[r]);return n}function lz(){return{app:null,config:{isNativeTag:m4,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let aU=0;function lU(t,e){return function(r,c=null){_r(r)||(r=Ba({},r)),c!=null&&!cs(c)&&(c=null);const u=lz(),p=new WeakSet,o=[];let w=!1;const T=u.app={_uid:aU++,_component:r,_props:c,_container:null,_context:u,_instance:null,version:$U,get config(){return u.config},set config(A){},use(A,...D){return p.has(A)||(A&&_r(A.install)?(p.add(A),A.install(T,...D)):_r(A)&&(p.add(A),A(T,...D))),T},mixin(A){return u.mixins.includes(A)||u.mixins.push(A),T},component(A,D){return D?(u.components[A]=D,T):u.components[A]},directive(A,D){return D?(u.directives[A]=D,T):u.directives[A]},mount(A,D,B){if(!w){const N=T._ceVNode||hi(r,c);return N.appContext=u,B===!0?B="svg":B===!1&&(B=void 0),t(N,A,B),w=!0,T._container=A,A.__vue_app__=T,wS(N.component)}},onUnmount(A){o.push(A)},unmount(){w&&(cd(o,T._instance,16),t(null,T._container),delete T._container.__vue_app__)},provide(A,D){return u.provides[A]=D,T},runWithContext(A){const D=$_;$_=T;try{return A()}finally{$_=D}}};return T}}let $_=null;function Ux(t,e){if(hl){let n=hl.provides;const r=hl.parent&&hl.parent.provides;r===n&&(n=hl.provides=Object.create(r)),n[t]=e}}function ad(t,e,n=!1){const r=kb();if(r||$_){let c=$_?$_._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(c&&t in c)return c[t];if(arguments.length>1)return n&&_r(e)?e.call(r&&r.proxy):e}}const cz={},uz=()=>Object.create(cz),dz=t=>Object.getPrototypeOf(t)===cz;function cU(t,e,n,r=!1){const c={},u=uz();t.propsDefaults=Object.create(null),hz(t,e,c,u);for(const p in t.propsOptions[0])p in c||(c[p]=void 0);n?t.props=r?c:B4(c):t.type.props?t.props=c:t.props=u,t.attrs=u}function uU(t,e,n,r){const{props:c,attrs:u,vnode:{patchFlag:p}}=t,o=Do(c),[w]=t.propsOptions;let T=!1;if((r||p>0)&&!(p&16)){if(p&8){const A=t.vnode.dynamicProps;for(let D=0;D<A.length;D++){let B=A[D];if(bS(t.emitsOptions,B))continue;const N=e[B];if(w)if(Fo(u,B))N!==u[B]&&(u[B]=N,T=!0);else{const ee=bu(B);c[ee]=FT(w,o,ee,N,t,!1)}else N!==u[B]&&(u[B]=N,T=!0)}}}else{hz(t,e,c,u)&&(T=!0);let A;for(const D in o)(!e||!Fo(e,D)&&((A=Hp(D))===D||!Fo(e,A)))&&(w?n&&(n[D]!==void 0||n[A]!==void 0)&&(c[D]=FT(w,o,D,void 0,t,!0)):delete c[D]);if(u!==o)for(const D in u)(!e||!Fo(e,D))&&(delete u[D],T=!0)}T&&qh(t.attrs,"set","")}function hz(t,e,n,r){const[c,u]=t.propsOptions;let p=!1,o;if(e)for(let w in e){if(eb(w))continue;const T=e[w];let A;c&&Fo(c,A=bu(w))?!u||!u.includes(A)?n[A]=T:(o||(o={}))[A]=T:bS(t.emitsOptions,w)||(!(w in r)||T!==r[w])&&(r[w]=T,p=!0)}if(u){const w=Do(n),T=o||as;for(let A=0;A<u.length;A++){const D=u[A];n[D]=FT(c,w,D,T[D],t,!Fo(T,D))}}return p}function FT(t,e,n,r,c,u){const p=t[n];if(p!=null){const o=Fo(p,"default");if(o&&r===void 0){const w=p.default;if(p.type!==Function&&!p.skipFactory&&_r(w)){const{propsDefaults:T}=c;if(n in T)r=T[n];else{const A=I0(c);r=T[n]=w.call(null,e),A()}}else r=w;c.ce&&c.ce._setProp(n,r)}p[0]&&(u&&!o?r=!1:p[1]&&(r===""||r===Hp(n))&&(r=!0))}return r}const dU=new WeakMap;function fz(t,e,n=!1){const r=n?dU:e.propsCache,c=r.get(t);if(c)return c;const u=t.props,p={},o=[];let w=!1;if(!_r(t)){const A=D=>{w=!0;const[B,N]=fz(D,e,!0);Ba(p,B),N&&o.push(...N)};!n&&e.mixins.length&&e.mixins.forEach(A),t.extends&&A(t.extends),t.mixins&&t.mixins.forEach(A)}if(!u&&!w)return cs(t)&&r.set(t,z_),z_;if(Hi(u))for(let A=0;A<u.length;A++){const D=bu(u[A]);XM(D)&&(p[D]=as)}else if(u)for(const A in u){const D=bu(A);if(XM(D)){const B=u[A],N=p[D]=Hi(B)||_r(B)?{type:B}:Ba({},B),ee=N.type;let Q=!1,se=!0;if(Hi(ee))for(let ce=0;ce<ee.length;++ce){const be=ee[ce],ze=_r(be)&&be.name;if(ze==="Boolean"){Q=!0;break}else ze==="String"&&(se=!1)}else Q=_r(ee)&&ee.name==="Boolean";N[0]=Q,N[1]=se,(Q||Fo(N,"default"))&&o.push(D)}}const T=[p,o];return cs(t)&&r.set(t,T),T}function XM(t){return t[0]!=="$"&&!eb(t)}const nI=t=>t==="_"||t==="_ctx"||t==="$stable",iI=t=>Hi(t)?t.map(Kd):[Kd(t)],hU=(t,e,n)=>{if(e._n)return e;const r=si((...c)=>iI(e(...c)),n);return r._c=!1,r},pz=(t,e,n)=>{const r=t._ctx;for(const c in t){if(nI(c))continue;const u=t[c];if(_r(u))e[c]=hU(c,u,r);else if(u!=null){const p=iI(u);e[c]=()=>p}}},mz=(t,e)=>{const n=iI(e);t.slots.default=()=>n},gz=(t,e,n)=>{for(const r in e)(n||!nI(r))&&(t[r]=e[r])},fU=(t,e,n)=>{const r=t.slots=uz();if(t.vnode.shapeFlag&32){const c=e._;c?(gz(r,e,n),n&&v4(r,"_",c,!0)):pz(e,r)}else e&&mz(t,e)},pU=(t,e,n)=>{const{vnode:r,slots:c}=t;let u=!0,p=as;if(r.shapeFlag&32){const o=e._;o?n&&o===1?u=!1:gz(c,e,n):(u=!e.$stable,pz(e,c)),p=e}else e&&(mz(t,e),p={default:1});if(u)for(const o in c)!nI(o)&&p[o]==null&&delete c[o]},Fl=AU;function mU(t){return gU(t)}function gU(t,e){const n=hS();n.__VUE__=!0;const{insert:r,remove:c,patchProp:u,createElement:p,createText:o,createComment:w,setText:T,setElementText:A,parentNode:D,nextSibling:B,setScopeId:N=nh,insertStaticContent:ee}=t,Q=(Qe,at,vt,Gt=null,an=null,Qt=null,On=void 0,fn=null,mn=!!at.dynamicChildren)=>{if(Qe===at)return;Qe&&!Km(Qe,at)&&(Gt=Ft(Qe),Di(Qe,an,Qt,!0),Qe=null),at.patchFlag===-2&&(mn=!1,at.dynamicChildren=null);const{type:dn,ref:pi,shapeFlag:Ln}=at;switch(dn){case xS:se(Qe,at,vt,Gt);break;case dl:ce(Qe,at,vt,Gt);break;case R2:Qe==null&&be(at,vt,Gt,On);break;case Mi:Te(Qe,at,vt,Gt,an,Qt,On,fn,mn);break;default:Ln&1?je(Qe,at,vt,Gt,an,Qt,On,fn,mn):Ln&6?Re(Qe,at,vt,Gt,an,Qt,On,fn,mn):(Ln&64||Ln&128)&&dn.process(Qe,at,vt,Gt,an,Qt,On,fn,mn,kn)}pi!=null&&an?rb(pi,Qe&&Qe.ref,Qt,at||Qe,!at):pi==null&&Qe&&Qe.ref!=null&&rb(Qe.ref,null,Qt,Qe,!0)},se=(Qe,at,vt,Gt)=>{if(Qe==null)r(at.el=o(at.children),vt,Gt);else{const an=at.el=Qe.el;at.children!==Qe.children&&T(an,at.children)}},ce=(Qe,at,vt,Gt)=>{Qe==null?r(at.el=w(at.children||""),vt,Gt):at.el=Qe.el},be=(Qe,at,vt,Gt)=>{[Qe.el,Qe.anchor]=ee(Qe.children,at,vt,Gt,Qe.el,Qe.anchor)},ze=({el:Qe,anchor:at},vt,Gt)=>{let an;for(;Qe&&Qe!==at;)an=B(Qe),r(Qe,vt,Gt),Qe=an;r(at,vt,Gt)},xe=({el:Qe,anchor:at})=>{let vt;for(;Qe&&Qe!==at;)vt=B(Qe),c(Qe),Qe=vt;c(at)},je=(Qe,at,vt,Gt,an,Qt,On,fn,mn)=>{at.type==="svg"?On="svg":at.type==="math"&&(On="mathml"),Qe==null?qe(at,vt,Gt,an,Qt,On,fn,mn):Ee(Qe,at,an,Qt,On,fn,mn)},qe=(Qe,at,vt,Gt,an,Qt,On,fn)=>{let mn,dn;const{props:pi,shapeFlag:Ln,transition:mi,dirs:yi}=Qe;if(mn=Qe.el=p(Qe.type,Qt,pi&&pi.is,pi),Ln&8?A(mn,Qe.children):Ln&16&&de(Qe.children,mn,null,Gt,an,k2(Qe,Qt),On,fn),yi&&Om(Qe,null,Gt,"created"),oe(mn,Qe,Qe.scopeId,On,Gt),pi){for(const nr in pi)nr!=="value"&&!eb(nr)&&u(mn,nr,null,pi[nr],Qt,Gt);"value"in pi&&u(mn,"value",null,pi.value,Qt),(dn=pi.onVnodeBeforeMount)&&jd(dn,Gt,Qe)}yi&&Om(Qe,null,Gt,"beforeMount");const xi=_U(an,mi);xi&&mi.beforeEnter(mn),r(mn,at,vt),((dn=pi&&pi.onVnodeMounted)||xi||yi)&&Fl(()=>{dn&&jd(dn,Gt,Qe),xi&&mi.enter(mn),yi&&Om(Qe,null,Gt,"mounted")},an)},oe=(Qe,at,vt,Gt,an)=>{if(vt&&N(Qe,vt),Gt)for(let Qt=0;Qt<Gt.length;Qt++)N(Qe,Gt[Qt]);if(an){let Qt=an.subTree;if(at===Qt||xz(Qt.type)&&(Qt.ssContent===at||Qt.ssFallback===at)){const On=an.vnode;oe(Qe,On,On.scopeId,On.slotScopeIds,an.parent)}}},de=(Qe,at,vt,Gt,an,Qt,On,fn,mn=0)=>{for(let dn=mn;dn<Qe.length;dn++){const pi=Qe[dn]=fn?fp(Qe[dn]):Kd(Qe[dn]);Q(null,pi,at,vt,Gt,an,Qt,On,fn)}},Ee=(Qe,at,vt,Gt,an,Qt,On)=>{const fn=at.el=Qe.el;let{patchFlag:mn,dynamicChildren:dn,dirs:pi}=at;mn|=Qe.patchFlag&16;const Ln=Qe.props||as,mi=at.props||as;let yi;if(vt&&Lm(vt,!1),(yi=mi.onVnodeBeforeUpdate)&&jd(yi,vt,at,Qe),pi&&Om(at,Qe,vt,"beforeUpdate"),vt&&Lm(vt,!0),(Ln.innerHTML&&mi.innerHTML==null||Ln.textContent&&mi.textContent==null)&&A(fn,""),dn?$e(Qe.dynamicChildren,dn,fn,vt,Gt,k2(at,an),Qt):On||Hn(Qe,at,fn,null,vt,Gt,k2(at,an),Qt,!1),mn>0){if(mn&16)me(fn,Ln,mi,vt,an);else if(mn&2&&Ln.class!==mi.class&&u(fn,"class",null,mi.class,an),mn&4&&u(fn,"style",Ln.style,mi.style,an),mn&8){const xi=at.dynamicProps;for(let nr=0;nr<xi.length;nr++){const yr=xi[nr],zo=Ln[yr],Io=mi[yr];(Io!==zo||yr==="value")&&u(fn,yr,zo,Io,an,vt)}}mn&1&&Qe.children!==at.children&&A(fn,at.children)}else!On&&dn==null&&me(fn,Ln,mi,vt,an);((yi=mi.onVnodeUpdated)||pi)&&Fl(()=>{yi&&jd(yi,vt,at,Qe),pi&&Om(at,Qe,vt,"updated")},Gt)},$e=(Qe,at,vt,Gt,an,Qt,On)=>{for(let fn=0;fn<at.length;fn++){const mn=Qe[fn],dn=at[fn],pi=mn.el&&(mn.type===Mi||!Km(mn,dn)||mn.shapeFlag&198)?D(mn.el):vt;Q(mn,dn,pi,null,Gt,an,Qt,On,!0)}},me=(Qe,at,vt,Gt,an)=>{if(at!==vt){if(at!==as)for(const Qt in at)!eb(Qt)&&!(Qt in vt)&&u(Qe,Qt,at[Qt],null,an,Gt);for(const Qt in vt){if(eb(Qt))continue;const On=vt[Qt],fn=at[Qt];On!==fn&&Qt!=="value"&&u(Qe,Qt,fn,On,an,Gt)}"value"in vt&&u(Qe,"value",at.value,vt.value,an)}},Te=(Qe,at,vt,Gt,an,Qt,On,fn,mn)=>{const dn=at.el=Qe?Qe.el:o(""),pi=at.anchor=Qe?Qe.anchor:o("");let{patchFlag:Ln,dynamicChildren:mi,slotScopeIds:yi}=at;yi&&(fn=fn?fn.concat(yi):yi),Qe==null?(r(dn,vt,Gt),r(pi,vt,Gt),de(at.children||[],vt,pi,an,Qt,On,fn,mn)):Ln>0&&Ln&64&&mi&&Qe.dynamicChildren?($e(Qe.dynamicChildren,mi,vt,an,Qt,On,fn),(at.key!=null||an&&at===an.subTree)&&rI(Qe,at,!0)):Hn(Qe,at,vt,pi,an,Qt,On,fn,mn)},Re=(Qe,at,vt,Gt,an,Qt,On,fn,mn)=>{at.slotScopeIds=fn,Qe==null?at.shapeFlag&512?an.ctx.activate(at,vt,Gt,On,mn):tn(at,vt,Gt,an,Qt,On,mn):Zt(Qe,at,mn)},tn=(Qe,at,vt,Gt,an,Qt,On)=>{const fn=Qe.component=OU(Qe,Gt,an);if(_S(Qe)&&(fn.ctx.renderer=kn),LU(fn,!1,On),fn.asyncDep){if(an&&an.registerDep(fn,on,On),!Qe.el){const mn=fn.subTree=hi(dl);ce(null,mn,at,vt),Qe.placeholder=mn.el}}else on(fn,Qe,at,vt,an,Qt,On)},Zt=(Qe,at,vt)=>{const Gt=at.component=Qe.component;if(EU(Qe,at,vt))if(Gt.asyncDep&&!Gt.asyncResolved){hn(Gt,at,vt);return}else Gt.next=at,Gt.update();else at.el=Qe.el,Gt.vnode=at},on=(Qe,at,vt,Gt,an,Qt,On)=>{const fn=()=>{if(Qe.isMounted){let{next:Ln,bu:mi,u:yi,parent:xi,vnode:nr}=Qe;{const ho=_z(Qe);if(ho){Ln&&(Ln.el=nr.el,hn(Qe,Ln,On)),ho.asyncDep.then(()=>{Qe.isUnmounted||fn()});return}}let yr=Ln,zo;Lm(Qe,!1),Ln?(Ln.el=nr.el,hn(Qe,Ln,On)):Ln=nr,mi&&$x(mi),(zo=Ln.props&&Ln.props.onVnodeBeforeUpdate)&&jd(zo,xi,Ln,nr),Lm(Qe,!0);const Io=JM(Qe),Sr=Qe.subTree;Qe.subTree=Io,Q(Sr,Io,D(Sr.el),Ft(Sr),Qe,an,Qt),Ln.el=Io.el,yr===null&&IU(Qe,Io.el),yi&&Fl(yi,an),(zo=Ln.props&&Ln.props.onVnodeUpdated)&&Fl(()=>jd(zo,xi,Ln,nr),an)}else{let Ln;const{el:mi,props:yi}=at,{bm:xi,m:nr,parent:yr,root:zo,type:Io}=Qe,Sr=V_(at);Lm(Qe,!1),xi&&$x(xi),!Sr&&(Ln=yi&&yi.onVnodeBeforeMount)&&jd(Ln,yr,at),Lm(Qe,!0);{zo.ce&&zo.ce._def.shadowRoot!==!1&&zo.ce._injectChildStyle(Io);const ho=Qe.subTree=JM(Qe);Q(null,ho,vt,Gt,Qe,an,Qt),at.el=ho.el}if(nr&&Fl(nr,an),!Sr&&(Ln=yi&&yi.onVnodeMounted)){const ho=at;Fl(()=>jd(Ln,yr,ho),an)}(at.shapeFlag&256||yr&&V_(yr.vnode)&&yr.vnode.shapeFlag&256)&&Qe.a&&Fl(Qe.a,an),Qe.isMounted=!0,at=vt=Gt=null}};Qe.scope.on();const mn=Qe.effect=new S4(fn);Qe.scope.off();const dn=Qe.update=mn.run.bind(mn),pi=Qe.job=mn.runIfDirty.bind(mn);pi.i=Qe,pi.id=Qe.uid,mn.scheduler=()=>QE(pi),Lm(Qe,!0),dn()},hn=(Qe,at,vt)=>{at.component=Qe;const Gt=Qe.vnode.props;Qe.vnode=at,Qe.next=null,uU(Qe,at.props,Gt,vt),pU(Qe,at.children,vt),rf(),VM(Qe),of()},Hn=(Qe,at,vt,Gt,an,Qt,On,fn,mn=!1)=>{const dn=Qe&&Qe.children,pi=Qe?Qe.shapeFlag:0,Ln=at.children,{patchFlag:mi,shapeFlag:yi}=at;if(mi>0){if(mi&128){zi(dn,Ln,vt,Gt,an,Qt,On,fn,mn);return}else if(mi&256){Ri(dn,Ln,vt,Gt,an,Qt,On,fn,mn);return}}yi&8?(pi&16&&ai(dn,an,Qt),Ln!==dn&&A(vt,Ln)):pi&16?yi&16?zi(dn,Ln,vt,Gt,an,Qt,On,fn,mn):ai(dn,an,Qt,!0):(pi&8&&A(vt,""),yi&16&&de(Ln,vt,Gt,an,Qt,On,fn,mn))},Ri=(Qe,at,vt,Gt,an,Qt,On,fn,mn)=>{Qe=Qe||z_,at=at||z_;const dn=Qe.length,pi=at.length,Ln=Math.min(dn,pi);let mi;for(mi=0;mi<Ln;mi++){const yi=at[mi]=mn?fp(at[mi]):Kd(at[mi]);Q(Qe[mi],yi,vt,null,an,Qt,On,fn,mn)}dn>pi?ai(Qe,an,Qt,!0,!1,Ln):de(at,vt,Gt,an,Qt,On,fn,mn,Ln)},zi=(Qe,at,vt,Gt,an,Qt,On,fn,mn)=>{let dn=0;const pi=at.length;let Ln=Qe.length-1,mi=pi-1;for(;dn<=Ln&&dn<=mi;){const yi=Qe[dn],xi=at[dn]=mn?fp(at[dn]):Kd(at[dn]);if(Km(yi,xi))Q(yi,xi,vt,null,an,Qt,On,fn,mn);else break;dn++}for(;dn<=Ln&&dn<=mi;){const yi=Qe[Ln],xi=at[mi]=mn?fp(at[mi]):Kd(at[mi]);if(Km(yi,xi))Q(yi,xi,vt,null,an,Qt,On,fn,mn);else break;Ln--,mi--}if(dn>Ln){if(dn<=mi){const yi=mi+1,xi=yi<pi?at[yi].el:Gt;for(;dn<=mi;)Q(null,at[dn]=mn?fp(at[dn]):Kd(at[dn]),vt,xi,an,Qt,On,fn,mn),dn++}}else if(dn>mi)for(;dn<=Ln;)Di(Qe[dn],an,Qt,!0),dn++;else{const yi=dn,xi=dn,nr=new Map;for(dn=xi;dn<=mi;dn++){const ao=at[dn]=mn?fp(at[dn]):Kd(at[dn]);ao.key!=null&&nr.set(ao.key,dn)}let yr,zo=0;const Io=mi-xi+1;let Sr=!1,ho=0;const Cs=new Array(Io);for(dn=0;dn<Io;dn++)Cs[dn]=0;for(dn=yi;dn<=Ln;dn++){const ao=Qe[dn];if(zo>=Io){Di(ao,an,Qt,!0);continue}let Ao;if(ao.key!=null)Ao=nr.get(ao.key);else for(yr=xi;yr<=mi;yr++)if(Cs[yr-xi]===0&&Km(ao,at[yr])){Ao=yr;break}Ao===void 0?Di(ao,an,Qt,!0):(Cs[Ao-xi]=dn+1,Ao>=ho?ho=Ao:Sr=!0,Q(ao,at[Ao],vt,null,an,Qt,On,fn,mn),zo++)}const ha=Sr?yU(Cs):z_;for(yr=ha.length-1,dn=Io-1;dn>=0;dn--){const ao=xi+dn,Ao=at[ao],Fa=at[ao+1],vr=ao+1<pi?Fa.el||Fa.placeholder:Gt;Cs[dn]===0?Q(null,Ao,vt,vr,an,Qt,On,fn,mn):Sr&&(yr<0||dn!==ha[yr]?Pt(Ao,vt,vr,2):yr--)}}},Pt=(Qe,at,vt,Gt,an=null)=>{const{el:Qt,type:On,transition:fn,children:mn,shapeFlag:dn}=Qe;if(dn&6){Pt(Qe.component.subTree,at,vt,Gt);return}if(dn&128){Qe.suspense.move(at,vt,Gt);return}if(dn&64){On.move(Qe,at,vt,kn);return}if(On===Mi){r(Qt,at,vt);for(let Ln=0;Ln<mn.length;Ln++)Pt(mn[Ln],at,vt,Gt);r(Qe.anchor,at,vt);return}if(On===R2){ze(Qe,at,vt);return}if(Gt!==2&&dn&1&&fn)if(Gt===0)fn.beforeEnter(Qt),r(Qt,at,vt),Fl(()=>fn.enter(Qt),an);else{const{leave:Ln,delayLeave:mi,afterLeave:yi}=fn,xi=()=>{Qe.ctx.isUnmounted?c(Qt):r(Qt,at,vt)},nr=()=>{Qt._isLeaving&&Qt[Gh](!0),Ln(Qt,()=>{xi(),yi&&yi()})};mi?mi(Qt,xi,nr):nr()}else r(Qt,at,vt)},Di=(Qe,at,vt,Gt=!1,an=!1)=>{const{type:Qt,props:On,ref:fn,children:mn,dynamicChildren:dn,shapeFlag:pi,patchFlag:Ln,dirs:mi,cacheIndex:yi}=Qe;if(Ln===-2&&(an=!1),fn!=null&&(rf(),rb(fn,null,vt,Qe,!0),of()),yi!=null&&(at.renderCache[yi]=void 0),pi&256){at.ctx.deactivate(Qe);return}const xi=pi&1&&mi,nr=!V_(Qe);let yr;if(nr&&(yr=On&&On.onVnodeBeforeUnmount)&&jd(yr,at,Qe),pi&6)Br(Qe.component,vt,Gt);else{if(pi&128){Qe.suspense.unmount(vt,Gt);return}xi&&Om(Qe,null,at,"beforeUnmount"),pi&64?Qe.type.remove(Qe,at,vt,kn,Gt):dn&&!dn.hasOnce&&(Qt!==Mi||Ln>0&&Ln&64)?ai(dn,at,vt,!1,!0):(Qt===Mi&&Ln&384||!an&&pi&16)&&ai(mn,at,vt),Gt&&wo(Qe)}(nr&&(yr=On&&On.onVnodeUnmounted)||xi)&&Fl(()=>{yr&&jd(yr,at,Qe),xi&&Om(Qe,null,at,"unmounted")},vt)},wo=Qe=>{const{type:at,el:vt,anchor:Gt,transition:an}=Qe;if(at===Mi){Ur(vt,Gt);return}if(at===R2){xe(Qe);return}const Qt=()=>{c(vt),an&&!an.persisted&&an.afterLeave&&an.afterLeave()};if(Qe.shapeFlag&1&&an&&!an.persisted){const{leave:On,delayLeave:fn}=an,mn=()=>On(vt,Qt);fn?fn(Qe.el,Qt,mn):mn()}else Qt()},Ur=(Qe,at)=>{let vt;for(;Qe!==at;)vt=B(Qe),c(Qe),Qe=vt;c(at)},Br=(Qe,at,vt)=>{const{bum:Gt,scope:an,job:Qt,subTree:On,um:fn,m:mn,a:dn}=Qe;YM(mn),YM(dn),Gt&&$x(Gt),an.stop(),Qt&&(Qt.flags|=8,Di(On,Qe,at,vt)),fn&&Fl(fn,at),Fl(()=>{Qe.isUnmounted=!0},at)},ai=(Qe,at,vt,Gt=!1,an=!1,Qt=0)=>{for(let On=Qt;On<Qe.length;On++)Di(Qe[On],at,vt,Gt,an)},Ft=Qe=>{if(Qe.shapeFlag&6)return Ft(Qe.component.subTree);if(Qe.shapeFlag&128)return Qe.suspense.next();const at=B(Qe.anchor||Qe.el),vt=at&&at[G4];return vt?B(vt):at};let In=!1;const Wt=(Qe,at,vt)=>{Qe==null?at._vnode&&Di(at._vnode,null,null,!0):Q(at._vnode||null,Qe,at,null,null,null,vt),at._vnode=Qe,In||(In=!0,VM(),j4(),In=!1)},kn={p:Q,um:Di,m:Pt,r:wo,mt:tn,mc:de,pc:Hn,pbc:$e,n:Ft,o:t};return{render:Wt,hydrate:void 0,createApp:lU(Wt)}}function k2({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function Lm({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function _U(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function rI(t,e,n=!1){const r=t.children,c=e.children;if(Hi(r)&&Hi(c))for(let u=0;u<r.length;u++){const p=r[u];let o=c[u];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=c[u]=fp(c[u]),o.el=p.el),!n&&o.patchFlag!==-2&&rI(p,o)),o.type===xS&&o.patchFlag!==-1&&(o.el=p.el),o.type===dl&&!o.el&&(o.el=p.el)}}function yU(t){const e=t.slice(),n=[0];let r,c,u,p,o;const w=t.length;for(r=0;r<w;r++){const T=t[r];if(T!==0){if(c=n[n.length-1],t[c]<T){e[r]=c,n.push(r);continue}for(u=0,p=n.length-1;u<p;)o=u+p>>1,t[n[o]]<T?u=o+1:p=o;T<t[n[u]]&&(u>0&&(e[r]=n[u-1]),n[u]=r)}}for(u=n.length,p=n[u-1];u-- >0;)n[u]=p,p=e[p];return n}function _z(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:_z(e)}function YM(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const vU=Symbol.for("v-scx"),bU=()=>ad(vU);function gu(t,e,n){return yz(t,e,n)}function yz(t,e,n=as){const{immediate:r,deep:c,flush:u,once:p}=n,o=Ba({},n),w=e&&r||!e&&u!=="post";let T;if(Rb){if(u==="sync"){const N=bU();T=N.__watcherHandles||(N.__watcherHandles=[])}else if(!w){const N=()=>{};return N.stop=nh,N.resume=nh,N.pause=nh,N}}const A=hl;o.call=(N,ee,Q)=>cd(N,A,ee,Q);let D=!1;u==="post"?o.scheduler=N=>{Fl(N,A&&A.suspense)}:u!=="sync"&&(D=!0,o.scheduler=(N,ee)=>{ee?N():QE(N)}),o.augmentJob=N=>{e&&(N.flags|=4),D&&(N.flags|=2,A&&(N.id=A.uid,N.i=A))};const B=Oj(t,e,o);return Rb&&(T?T.push(B):w&&B()),B}function xU(t,e,n){const r=this.proxy,c=Fs(t)?t.includes(".")?vz(r,t):()=>r[t]:t.bind(r,r);let u;_r(e)?u=e:(u=e.handler,n=e);const p=I0(this),o=yz(c,u.bind(r),n);return p(),o}function vz(t,e){const n=e.split(".");return()=>{let r=t;for(let c=0;c<n.length&&r;c++)r=r[n[c]];return r}}const wU=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${bu(e)}Modifiers`]||t[`${Hp(e)}Modifiers`];function SU(t,e,...n){if(t.isUnmounted)return;const r=t.vnode.props||as;let c=n;const u=e.startsWith("update:"),p=u&&wU(r,e.slice(7));p&&(p.trim&&(c=n.map(A=>Fs(A)?A.trim():A)),p.number&&(c=n.map(dw)));let o,w=r[o=Vx(e)]||r[o=Vx(bu(e))];!w&&u&&(w=r[o=Vx(Hp(e))]),w&&cd(w,t,6,c);const T=r[o+"Once"];if(T){if(!t.emitted)t.emitted={};else if(t.emitted[o])return;t.emitted[o]=!0,cd(T,t,6,c)}}function bz(t,e,n=!1){const r=e.emitsCache,c=r.get(t);if(c!==void 0)return c;const u=t.emits;let p={},o=!1;if(!_r(t)){const w=T=>{const A=bz(T,e,!0);A&&(o=!0,Ba(p,A))};!n&&e.mixins.length&&e.mixins.forEach(w),t.extends&&w(t.extends),t.mixins&&t.mixins.forEach(w)}return!u&&!o?(cs(t)&&r.set(t,null),null):(Hi(u)?u.forEach(w=>p[w]=null):Ba(p,u),cs(t)&&r.set(t,p),p)}function bS(t,e){return!t||!lS(e)?!1:(e=e.slice(2).replace(/Once$/,""),Fo(t,e[0].toLowerCase()+e.slice(1))||Fo(t,Hp(e))||Fo(t,e))}function JM(t){const{type:e,vnode:n,proxy:r,withProxy:c,propsOptions:[u],slots:p,attrs:o,emit:w,render:T,renderCache:A,props:D,data:B,setupState:N,ctx:ee,inheritAttrs:Q}=t,se=mw(t);let ce,be;try{if(n.shapeFlag&4){const xe=c||r,je=xe;ce=Kd(T.call(je,xe,A,D,N,B,ee)),be=o}else{const xe=e;ce=Kd(xe.length>1?xe(D,{attrs:o,slots:p,emit:w}):xe(D,null)),be=e.props?o:CU(o)}}catch(xe){sb.length=0,gS(xe,t,1),ce=hi(dl)}let ze=ce;if(be&&Q!==!1){const xe=Object.keys(be),{shapeFlag:je}=ze;xe.length&&je&7&&(u&&xe.some(jE)&&(be=TU(be,u)),ze=Fp(ze,be,!1,!0))}return n.dirs&&(ze=Fp(ze,null,!1,!0),ze.dirs=ze.dirs?ze.dirs.concat(n.dirs):n.dirs),n.transition&&Tb(ze,n.transition),ce=ze,mw(se),ce}const CU=t=>{let e;for(const n in t)(n==="class"||n==="style"||lS(n))&&((e||(e={}))[n]=t[n]);return e},TU=(t,e)=>{const n={};for(const r in t)(!jE(r)||!(r.slice(9)in e))&&(n[r]=t[r]);return n};function EU(t,e,n){const{props:r,children:c,component:u}=t,{props:p,children:o,patchFlag:w}=e,T=u.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&w>=0){if(w&1024)return!0;if(w&16)return r?QM(r,p,T):!!p;if(w&8){const A=e.dynamicProps;for(let D=0;D<A.length;D++){const B=A[D];if(p[B]!==r[B]&&!bS(T,B))return!0}}}else return(c||o)&&(!o||!o.$stable)?!0:r===p?!1:r?p?QM(r,p,T):!0:!!p;return!1}function QM(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let c=0;c<r.length;c++){const u=r[c];if(e[u]!==t[u]&&!bS(n,u))return!0}return!1}function IU({vnode:t,parent:e},n){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===t&&(r.el=t.el),r===t)(t=e.vnode).el=n,e=e.parent;else break}}const xz=t=>t.__isSuspense;function AU(t,e){e&&e.pendingBranch?Hi(t)?e.effects.push(...t):e.effects.push(t):Bj(t)}const Mi=Symbol.for("v-fgt"),xS=Symbol.for("v-txt"),dl=Symbol.for("v-cmt"),R2=Symbol.for("v-stc"),sb=[];let Oc=null;function We(t=!1){sb.push(Oc=t?null:[])}function kU(){sb.pop(),Oc=sb[sb.length-1]||null}let Ib=1;function eD(t,e=!1){Ib+=t,t<0&&Oc&&e&&(Oc.hasOnce=!0)}function wz(t){return t.dynamicChildren=Ib>0?Oc||z_:null,kU(),Ib>0&&Oc&&Oc.push(t),t}function wt(t,e,n,r,c,u){return wz(Pe(t,e,n,r,c,u,!0))}function Sn(t,e,n,r,c){return wz(hi(t,e,n,r,c,!0))}function Ab(t){return t?t.__v_isVNode===!0:!1}function Km(t,e){return t.type===e.type&&t.key===e.key}const Sz=({key:t})=>t??null,Hx=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?Fs(t)||ml(t)||_r(t)?{i:Za,r:t,k:e,f:!!n}:t:null);function Pe(t,e=null,n=null,r=0,c=null,u=t===Mi?0:1,p=!1,o=!1){const w={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Sz(e),ref:e&&Hx(e),scopeId:H4,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:u,patchFlag:r,dynamicProps:c,dynamicChildren:null,appContext:null,ctx:Za};return o?(oI(w,n),u&128&&t.normalize(w)):n&&(w.shapeFlag|=Fs(n)?8:16),Ib>0&&!p&&Oc&&(w.patchFlag>0||u&6)&&w.patchFlag!==32&&Oc.push(w),w}const hi=RU;function RU(t,e=null,n=null,r=0,c=null,u=!1){if((!t||t===rz)&&(t=dl),Ab(t)){const o=Fp(t,e,!0);return n&&oI(o,n),Ib>0&&!u&&Oc&&(o.shapeFlag&6?Oc[Oc.indexOf(t)]=o:Oc.push(o)),o.patchFlag=-2,o}if(VU(t)&&(t=t.__vccOpts),e){e=PU(e);let{class:o,style:w}=e;o&&!Fs(o)&&(e.class=pr(o)),cs(w)&&(JE(w)&&!Hi(w)&&(w=Ba({},w)),e.style=C0(w))}const p=Fs(t)?1:xz(t)?128:W4(t)?64:cs(t)?4:_r(t)?2:0;return Pe(t,e,n,r,c,p,u,!0)}function PU(t){return t?JE(t)||dz(t)?Ba({},t):t:null}function Fp(t,e,n=!1,r=!1){const{props:c,ref:u,patchFlag:p,children:o,transition:w}=t,T=e?ft(c||{},e):c,A={__v_isVNode:!0,__v_skip:!0,type:t.type,props:T,key:T&&Sz(T),ref:e&&e.ref?n&&u?Hi(u)?u.concat(Hx(e)):[u,Hx(e)]:Hx(e):u,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Mi?p===-1?16:p|16:p,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:w,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Fp(t.ssContent),ssFallback:t.ssFallback&&Fp(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return w&&r&&Tb(A,w.clone(A)),A}function Ss(t=" ",e=0){return hi(xS,null,t,e)}function Zn(t="",e=!1){return e?(We(),Sn(dl,null,t)):hi(dl,null,t)}function Kd(t){return t==null||typeof t=="boolean"?hi(dl):Hi(t)?hi(Mi,null,t.slice()):Ab(t)?fp(t):hi(xS,null,String(t))}function fp(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Fp(t)}function oI(t,e){let n=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(Hi(e))n=16;else if(typeof e=="object")if(r&65){const c=e.default;c&&(c._c&&(c._d=!1),oI(t,c()),c._c&&(c._d=!0));return}else{n=32;const c=e._;!c&&!dz(e)?e._ctx=Za:c===3&&Za&&(Za.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else _r(e)?(e={default:e,_ctx:Za},n=32):(e=String(e),r&64?(n=16,e=[Ss(e)]):n=8);t.children=e,t.shapeFlag|=n}function ft(...t){const e={};for(let n=0;n<t.length;n++){const r=t[n];for(const c in r)if(c==="class")e.class!==r.class&&(e.class=pr([e.class,r.class]));else if(c==="style")e.style=C0([e.style,r.style]);else if(lS(c)){const u=e[c],p=r[c];p&&u!==p&&!(Hi(u)&&u.includes(p))&&(e[c]=u?[].concat(u,p):p)}else c!==""&&(e[c]=r[c])}return e}function jd(t,e,n,r=null){cd(t,e,7,[n,r])}const MU=lz();let DU=0;function OU(t,e,n){const r=t.type,c=(e?e.appContext:t.appContext)||MU,u={uid:DU++,vnode:t,type:r,parent:e,appContext:c,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new aj(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(c.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:fz(r,c),emitsOptions:bz(r,c),emit:null,emitted:null,propsDefaults:as,inheritAttrs:r.inheritAttrs,ctx:as,data:as,props:as,attrs:as,slots:as,refs:as,setupState:as,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return u.ctx={_:u},u.root=e?e.root:u,u.emit=SU.bind(null,u),t.ce&&t.ce(u),u}let hl=null;const kb=()=>hl||Za;let _w,NT;{const t=hS(),e=(n,r)=>{let c;return(c=t[n])||(c=t[n]=[]),c.push(r),u=>{c.length>1?c.forEach(p=>p(u)):c[0](u)}};_w=e("__VUE_INSTANCE_SETTERS__",n=>hl=n),NT=e("__VUE_SSR_SETTERS__",n=>Rb=n)}const I0=t=>{const e=hl;return _w(t),t.scope.on(),()=>{t.scope.off(),_w(e)}},tD=()=>{hl&&hl.scope.off(),_w(null)};function Cz(t){return t.vnode.shapeFlag&4}let Rb=!1;function LU(t,e=!1,n=!1){e&&NT(e);const{props:r,children:c}=t.vnode,u=Cz(t);cU(t,r,u,e),fU(t,c,n||e);const p=u?zU(t,e):void 0;return e&&NT(!1),p}function zU(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,tU);const{setup:r}=n;if(r){rf();const c=t.setupContext=r.length>1?FU(t):null,u=I0(t),p=E0(r,t,0,[t.props,c]),o=g4(p);if(of(),u(),(o||t.sp)&&!V_(t)&&tz(t),o){if(p.then(tD,tD),e)return p.then(w=>{nD(t,w)}).catch(w=>{gS(w,t,0)});t.asyncDep=p}else nD(t,p)}else Tz(t)}function nD(t,e,n){_r(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:cs(e)&&(t.setupState=N4(e)),Tz(t)}function Tz(t,e,n){const r=t.type;t.render||(t.render=r.render||nh);{const c=I0(t);rf();try{nU(t)}finally{of(),c()}}}const BU={get(t,e){return ul(t,"get",""),t[e]}};function FU(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,BU),slots:t.slots,emit:t.emit,expose:e}}function wS(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(N4(Ij(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in ob)return ob[n](t)},has(e,n){return n in e||n in ob}})):t.proxy}function NU(t,e=!0){return _r(t)?t.displayName||t.name:t.name||e&&t.__name}function VU(t){return _r(t)&&"__vccOpts"in t}const Dc=(t,e)=>Mj(t,e,Rb);function sI(t,e,n){const r=arguments.length;return r===2?cs(e)&&!Hi(e)?Ab(e)?hi(t,null,[e]):hi(t,e):hi(t,null,e):(r>3?n=Array.prototype.slice.call(arguments,2):r===3&&Ab(n)&&(n=[n]),hi(t,e,n))}const $U="3.5.20";/**
* @vue/runtime-dom v3.5.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let VT;const iD=typeof window<"u"&&window.trustedTypes;if(iD)try{VT=iD.createPolicy("vue",{createHTML:t=>t})}catch{}const Ez=VT?t=>VT.createHTML(t):t=>t,jU="http://www.w3.org/2000/svg",UU="http://www.w3.org/1998/Math/MathML",Hh=typeof document<"u"?document:null,rD=Hh&&Hh.createElement("template"),HU={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const c=e==="svg"?Hh.createElementNS(jU,t):e==="mathml"?Hh.createElementNS(UU,t):n?Hh.createElement(t,{is:n}):Hh.createElement(t);return t==="select"&&r&&r.multiple!=null&&c.setAttribute("multiple",r.multiple),c},createText:t=>Hh.createTextNode(t),createComment:t=>Hh.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Hh.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,r,c,u){const p=n?n.previousSibling:e.lastChild;if(c&&(c===u||c.nextSibling))for(;e.insertBefore(c.cloneNode(!0),n),!(c===u||!(c=c.nextSibling)););else{rD.innerHTML=Ez(r==="svg"?`<svg>${t}</svg>`:r==="mathml"?`<math>${t}</math>`:t);const o=rD.content;if(r==="svg"||r==="mathml"){const w=o.firstChild;for(;w.firstChild;)o.appendChild(w.firstChild);o.removeChild(w)}e.insertBefore(o,n)}return[p?p.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},ap="transition",Ov="animation",Pb=Symbol("_vtc"),Iz={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},GU=Ba({},K4,Iz),WU=t=>(t.displayName="Transition",t.props=GU,t),aI=WU((t,{slots:e})=>sI(jj,qU(t),e)),zm=(t,e=[])=>{Hi(t)?t.forEach(n=>n(...e)):t&&t(...e)},oD=t=>t?Hi(t)?t.some(e=>e.length>1):t.length>1:!1;function qU(t){const e={};for(const Te in t)Te in Iz||(e[Te]=t[Te]);if(t.css===!1)return e;const{name:n="v",type:r,duration:c,enterFromClass:u=`${n}-enter-from`,enterActiveClass:p=`${n}-enter-active`,enterToClass:o=`${n}-enter-to`,appearFromClass:w=u,appearActiveClass:T=p,appearToClass:A=o,leaveFromClass:D=`${n}-leave-from`,leaveActiveClass:B=`${n}-leave-active`,leaveToClass:N=`${n}-leave-to`}=t,ee=ZU(c),Q=ee&&ee[0],se=ee&&ee[1],{onBeforeEnter:ce,onEnter:be,onEnterCancelled:ze,onLeave:xe,onLeaveCancelled:je,onBeforeAppear:qe=ce,onAppear:oe=be,onAppearCancelled:de=ze}=e,Ee=(Te,Re,tn,Zt)=>{Te._enterCancelled=Zt,Bm(Te,Re?A:o),Bm(Te,Re?T:p),tn&&tn()},$e=(Te,Re)=>{Te._isLeaving=!1,Bm(Te,D),Bm(Te,N),Bm(Te,B),Re&&Re()},me=Te=>(Re,tn)=>{const Zt=Te?oe:be,on=()=>Ee(Re,Te,tn);zm(Zt,[Re,on]),sD(()=>{Bm(Re,Te?w:u),Bh(Re,Te?A:o),oD(Zt)||aD(Re,r,Q,on)})};return Ba(e,{onBeforeEnter(Te){zm(ce,[Te]),Bh(Te,u),Bh(Te,p)},onBeforeAppear(Te){zm(qe,[Te]),Bh(Te,w),Bh(Te,T)},onEnter:me(!1),onAppear:me(!0),onLeave(Te,Re){Te._isLeaving=!0;const tn=()=>$e(Te,Re);Bh(Te,D),Te._enterCancelled?(Bh(Te,B),uD()):(uD(),Bh(Te,B)),sD(()=>{Te._isLeaving&&(Bm(Te,D),Bh(Te,N),oD(xe)||aD(Te,r,se,tn))}),zm(xe,[Te,tn])},onEnterCancelled(Te){Ee(Te,!1,void 0,!0),zm(ze,[Te])},onAppearCancelled(Te){Ee(Te,!0,void 0,!0),zm(de,[Te])},onLeaveCancelled(Te){$e(Te),zm(je,[Te])}})}function ZU(t){if(t==null)return null;if(cs(t))return[P2(t.enter),P2(t.leave)];{const e=P2(t);return[e,e]}}function P2(t){return J$(t)}function Bh(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t[Pb]||(t[Pb]=new Set)).add(e)}function Bm(t,e){e.split(/\s+/).forEach(r=>r&&t.classList.remove(r));const n=t[Pb];n&&(n.delete(e),n.size||(t[Pb]=void 0))}function sD(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let KU=0;function aD(t,e,n,r){const c=t._endId=++KU,u=()=>{c===t._endId&&r()};if(n!=null)return setTimeout(u,n);const{type:p,timeout:o,propCount:w}=XU(t,e);if(!p)return r();const T=p+"end";let A=0;const D=()=>{t.removeEventListener(T,B),u()},B=N=>{N.target===t&&++A>=w&&D()};setTimeout(()=>{A<w&&D()},o+1),t.addEventListener(T,B)}function XU(t,e){const n=window.getComputedStyle(t),r=ee=>(n[ee]||"").split(", "),c=r(`${ap}Delay`),u=r(`${ap}Duration`),p=lD(c,u),o=r(`${Ov}Delay`),w=r(`${Ov}Duration`),T=lD(o,w);let A=null,D=0,B=0;e===ap?p>0&&(A=ap,D=p,B=u.length):e===Ov?T>0&&(A=Ov,D=T,B=w.length):(D=Math.max(p,T),A=D>0?p>T?ap:Ov:null,B=A?A===ap?u.length:w.length:0);const N=A===ap&&/\b(transform|all)(,|$)/.test(r(`${ap}Property`).toString());return{type:A,timeout:D,propCount:B,hasTransform:N}}function lD(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,r)=>cD(n)+cD(t[r])))}function cD(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function uD(){return document.body.offsetHeight}function YU(t,e,n){const r=t[Pb];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const dD=Symbol("_vod"),JU=Symbol("_vsh"),QU=Symbol(""),eH=/(^|;)\s*display\s*:/;function tH(t,e,n){const r=t.style,c=Fs(n);let u=!1;if(n&&!c){if(e)if(Fs(e))for(const p of e.split(";")){const o=p.slice(0,p.indexOf(":")).trim();n[o]==null&&Gx(r,o,"")}else for(const p in e)n[p]==null&&Gx(r,p,"");for(const p in n)p==="display"&&(u=!0),Gx(r,p,n[p])}else if(c){if(e!==n){const p=r[QU];p&&(n+=";"+p),r.cssText=n,u=eH.test(n)}}else e&&t.removeAttribute("style");dD in t&&(t[dD]=u?r.display:"",t[JU]&&(r.display="none"))}const hD=/\s*!important$/;function Gx(t,e,n){if(Hi(n))n.forEach(r=>Gx(t,e,r));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const r=nH(t,e);hD.test(n)?t.setProperty(Hp(r),n.replace(hD,""),"important"):t[r]=n}}const fD=["Webkit","Moz","ms"],M2={};function nH(t,e){const n=M2[e];if(n)return n;let r=bu(e);if(r!=="filter"&&r in t)return M2[e]=r;r=dS(r);for(let c=0;c<fD.length;c++){const u=fD[c]+r;if(u in t)return M2[e]=u}return e}const pD="http://www.w3.org/1999/xlink";function mD(t,e,n,r,c,u=rj(e)){r&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(pD,e.slice(6,e.length)):t.setAttributeNS(pD,e,n):n==null||u&&!b4(n)?t.removeAttribute(e):t.setAttribute(e,u?"":ld(n)?String(n):n)}function gD(t,e,n,r,c){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?Ez(n):n);return}const u=t.tagName;if(e==="value"&&u!=="PROGRESS"&&!u.includes("-")){const o=u==="OPTION"?t.getAttribute("value")||"":t.value,w=n==null?t.type==="checkbox"?"on":"":String(n);(o!==w||!("_value"in t))&&(t.value=w),n==null&&t.removeAttribute(e),t._value=n;return}let p=!1;if(n===""||n==null){const o=typeof t[e];o==="boolean"?n=b4(n):n==null&&o==="string"?(n="",p=!0):o==="number"&&(n=0,p=!0)}try{t[e]=n}catch{}p&&t.removeAttribute(c||e)}function Xm(t,e,n,r){t.addEventListener(e,n,r)}function iH(t,e,n,r){t.removeEventListener(e,n,r)}const _D=Symbol("_vei");function rH(t,e,n,r,c=null){const u=t[_D]||(t[_D]={}),p=u[e];if(r&&p)p.value=r;else{const[o,w]=oH(e);if(r){const T=u[e]=lH(r,c);Xm(t,o,T,w)}else p&&(iH(t,o,p,w),u[e]=void 0)}}const yD=/(?:Once|Passive|Capture)$/;function oH(t){let e;if(yD.test(t)){e={};let r;for(;r=t.match(yD);)t=t.slice(0,t.length-r[0].length),e[r[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Hp(t.slice(2)),e]}let D2=0;const sH=Promise.resolve(),aH=()=>D2||(sH.then(()=>D2=0),D2=Date.now());function lH(t,e){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;cd(cH(r,n.value),e,5,[r])};return n.value=t,n.attached=aH(),n}function cH(t,e){if(Hi(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(r=>c=>!c._stopped&&r&&r(c))}else return e}const vD=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,uH=(t,e,n,r,c,u)=>{const p=c==="svg";e==="class"?YU(t,r,p):e==="style"?tH(t,n,r):lS(e)?jE(e)||rH(t,e,n,r,u):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):dH(t,e,r,p))?(gD(t,e,r),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&mD(t,e,r,p,u,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Fs(r))?gD(t,bu(e),r,u,e):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),mD(t,e,r,p))};function dH(t,e,n,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in t&&vD(e)&&_r(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const c=t.tagName;if(c==="IMG"||c==="VIDEO"||c==="CANVAS"||c==="SOURCE")return!1}return vD(e)&&Fs(n)?!1:e in t}const yw=t=>{const e=t.props["onUpdate:modelValue"]||!1;return Hi(e)?n=>$x(e,n):e};function hH(t){t.target.composing=!0}function bD(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const j_=Symbol("_assign"),to={created(t,{modifiers:{lazy:e,trim:n,number:r}},c){t[j_]=yw(c);const u=r||c.props&&c.props.type==="number";Xm(t,e?"change":"input",p=>{if(p.target.composing)return;let o=t.value;n&&(o=o.trim()),u&&(o=dw(o)),t[j_](o)}),n&&Xm(t,"change",()=>{t.value=t.value.trim()}),e||(Xm(t,"compositionstart",hH),Xm(t,"compositionend",bD),Xm(t,"change",bD))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:n,modifiers:{lazy:r,trim:c,number:u}},p){if(t[j_]=yw(p),t.composing)return;const o=(u||t.type==="number")&&!/^0\d/.test(t.value)?dw(t.value):t.value,w=e??"";o!==w&&(document.activeElement===t&&t.type!=="range"&&(r&&e===n||c&&t.value.trim()===w)||(t.value=w))}},ey={deep:!0,created(t,{value:e,modifiers:{number:n}},r){const c=cS(e);Xm(t,"change",()=>{const u=Array.prototype.filter.call(t.options,p=>p.selected).map(p=>n?dw(vw(p)):vw(p));t[j_](t.multiple?c?new Set(u):u:u[0]),t._assigning=!0,hy(()=>{t._assigning=!1})}),t[j_]=yw(r)},mounted(t,{value:e}){xD(t,e)},beforeUpdate(t,e,n){t[j_]=yw(n)},updated(t,{value:e}){t._assigning||xD(t,e)}};function xD(t,e){const n=t.multiple,r=Hi(e);if(!(n&&!r&&!cS(e))){for(let c=0,u=t.options.length;c<u;c++){const p=t.options[c],o=vw(p);if(n)if(r){const w=typeof o;w==="string"||w==="number"?p.selected=e.some(T=>String(T)===String(o)):p.selected=sj(e,o)>-1}else p.selected=e.has(o);else if(pS(vw(p),e)){t.selectedIndex!==c&&(t.selectedIndex=c);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function vw(t){return"_value"in t?t._value:t.value}const fH=["ctrl","shift","alt","meta"],pH={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>fH.some(n=>t[`${n}Key`]&&!e.includes(n))},df=(t,e)=>{const n=t._withMods||(t._withMods={}),r=e.join(".");return n[r]||(n[r]=(c,...u)=>{for(let p=0;p<e.length;p++){const o=pH[e[p]];if(o&&o(c,e))return}return t(c,...u)})},mH={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},O2=(t,e)=>{const n=t._withKeys||(t._withKeys={}),r=e.join(".");return n[r]||(n[r]=c=>{if(!("key"in c))return;const u=Hp(c.key);if(e.some(p=>p===u||mH[p]===u))return t(c)})},gH=Ba({patchProp:uH},HU);let wD;function _H(){return wD||(wD=mU(gH))}const yH=(...t)=>{const e=_H().createApp(...t),{mount:n}=e;return e.mount=r=>{const c=bH(r);if(!c)return;const u=e._component;!_r(u)&&!u.render&&!u.template&&(u.template=c.innerHTML),c.nodeType===1&&(c.textContent="");const p=n(c,!1,vH(c));return c instanceof Element&&(c.removeAttribute("v-cloak"),c.setAttribute("data-v-app","")),p},e};function vH(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function bH(t){return Fs(t)?document.querySelector(t):t}const Cu=(t,e)=>{const n=t.__vccOpts||t;for(const[r,c]of e)n[r]=c;return n},xH={},wH={class:"navbar navbar-expand-lg navbar-dark classy-nav"},SH={class:"container-fluid"},CH={class:"collapse navbar-collapse",id:"mainNav"},TH={class:"navbar-nav ms-auto align-items-lg-center"},EH={class:"nav-item"},IH={class:"nav-item"},AH={class:"nav-item"},kH={class:"nav-item"},RH={class:"nav-item"},PH={class:"nav-item"},MH={class:"nav-item"},DH={class:"nav-item"},OH={class:"nav-item"};function LH(t,e){const n=Ai("router-link");return We(),wt("nav",wH,[Pe("div",SH,[hi(n,{to:"/",class:"navbar-brand"},{default:si(()=>[...e[0]||(e[0]=[Ss(" 🌱 Youth Wellbeing ",-1)])]),_:1}),e[10]||(e[10]=Pe("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#mainNav","aria-controls":"mainNav","aria-expanded":"false","aria-label":"Toggle navigation"},[Pe("span",{class:"navbar-toggler-icon"})],-1)),Pe("div",CH,[Pe("ul",TH,[Pe("li",EH,[hi(n,{to:"/",class:"nav-link","exact-active-class":"active"},{default:si(()=>[...e[1]||(e[1]=[Ss(" Home ",-1)])]),_:1})]),Pe("li",IH,[hi(n,{to:"/programs",class:"nav-link","exact-active-class":"active"},{default:si(()=>[...e[2]||(e[2]=[Ss(" Programs ",-1)])]),_:1})]),Pe("li",AH,[hi(n,{to:"/resources",class:"nav-link","exact-active-class":"active"},{default:si(()=>[...e[3]||(e[3]=[Ss(" Resources ",-1)])]),_:1})]),Pe("li",kH,[hi(n,{to:"/reviews",class:"nav-link","exact-active-class":"active"},{default:si(()=>[...e[4]||(e[4]=[Ss(" Reviews ",-1)])]),_:1})]),Pe("li",RH,[hi(n,{to:"/auth",class:"nav-link","exact-active-class":"active"},{default:si(()=>[...e[5]||(e[5]=[Ss(" Login ",-1)])]),_:1})]),Pe("li",PH,[hi(n,{to:"/email",class:"nav-link","exact-active-class":"active"},{default:si(()=>[...e[6]||(e[6]=[Ss(" Email ",-1)])]),_:1})]),Pe("li",MH,[hi(n,{to:"/map",class:"nav-link","exact-active-class":"active"},{default:si(()=>[...e[7]||(e[7]=[Ss(" Map ",-1)])]),_:1})]),Pe("li",DH,[hi(n,{to:"/dashboard",class:"nav-link","exact-active-class":"active"},{default:si(()=>[...e[8]||(e[8]=[Ss(" Dashboard ",-1)])]),_:1})]),Pe("li",OH,[hi(n,{to:"/calendar",class:"nav-link","exact-active-class":"active"},{default:si(()=>[...e[9]||(e[9]=[Ss(" Calendar ",-1)])]),_:1})])])])])])}const zH=Cu(xH,[["render",LH],["__scopeId","data-v-fa39c28f"]]),BH={},FH={class:"alert alert-danger text-center urgent-banner",role:"alert"};function NH(t,e){return We(),wt("div",FH,[...e[0]||(e[0]=[Pe("strong",null,"Need urgent help?",-1),Ss(" Call ",-1),Pe("b",null,"000",-1),Ss(" (Australia) or Lifeline ",-1),Pe("b",null,"13 11 14",-1),Ss(". ",-1)])])}const VH=Cu(BH,[["render",NH],["__scopeId","data-v-114aa80f"]]),$H={},jH={class:"bg-light text-center py-3 mt-5"};function UH(t,e){return We(),wt("footer",jH,[...e[0]||(e[0]=[Pe("small",null,[Ss(" © 2025 Youth Wellbeing Platform | For urgent help call "),Pe("strong",null,"000"),Ss(" or Lifeline "),Pe("strong",null,"13 11 14")],-1)])])}const HH=Cu($H,[["render",UH],["__scopeId","data-v-af924801"]]),GH={id:"app"},WH={id:"main",class:"container py-4",tabindex:"-1"},qH={__name:"App",setup(t){return(e,n)=>{const r=Ai("RouterView");return We(),wt("div",GH,[n[0]||(n[0]=Pe("a",{href:"#main",class:"skip-link btn-custom"},"Skip to main content",-1)),hi(zH),Pe("main",WH,[hi(r,null,{default:si(({Component:c})=>[hi(aI,{name:"fade",mode:"out-in"},{default:si(()=>[(We(),Sn(lr(c)))]),_:2},1024)]),_:1})]),hi(HH),hi(VH)])}}};var Az=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ZH(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var KH={exports:{}};/*!
  * Bootstrap v5.3.8 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */(function(t,e){(function(n,r){t.exports=r()})(Az,function(){const n=new Map,r={set(_e,V,te){n.has(_e)||n.set(_e,new Map);const Be=n.get(_e);Be.has(V)||Be.size===0?Be.set(V,te):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(Be.keys())[0]}.`)},get:(_e,V)=>n.has(_e)&&n.get(_e).get(V)||null,remove(_e,V){if(!n.has(_e))return;const te=n.get(_e);te.delete(V),te.size===0&&n.delete(_e)}},c="transitionend",u=_e=>(_e&&window.CSS&&window.CSS.escape&&(_e=_e.replace(/#([^\s"#']+)/g,(V,te)=>`#${CSS.escape(te)}`)),_e),p=_e=>_e==null?`${_e}`:Object.prototype.toString.call(_e).match(/\s([a-z]+)/i)[1].toLowerCase(),o=_e=>{_e.dispatchEvent(new Event(c))},w=_e=>!(!_e||typeof _e!="object")&&(_e.jquery!==void 0&&(_e=_e[0]),_e.nodeType!==void 0),T=_e=>w(_e)?_e.jquery?_e[0]:_e:typeof _e=="string"&&_e.length>0?document.querySelector(u(_e)):null,A=_e=>{if(!w(_e)||_e.getClientRects().length===0)return!1;const V=getComputedStyle(_e).getPropertyValue("visibility")==="visible",te=_e.closest("details:not([open])");if(!te)return V;if(te!==_e){const Be=_e.closest("summary");if(Be&&Be.parentNode!==te||Be===null)return!1}return V},D=_e=>!_e||_e.nodeType!==Node.ELEMENT_NODE||!!_e.classList.contains("disabled")||(_e.disabled!==void 0?_e.disabled:_e.hasAttribute("disabled")&&_e.getAttribute("disabled")!=="false"),B=_e=>{if(!document.documentElement.attachShadow)return null;if(typeof _e.getRootNode=="function"){const V=_e.getRootNode();return V instanceof ShadowRoot?V:null}return _e instanceof ShadowRoot?_e:_e.parentNode?B(_e.parentNode):null},N=()=>{},ee=_e=>{_e.offsetHeight},Q=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,se=[],ce=()=>document.documentElement.dir==="rtl",be=_e=>{var V;V=()=>{const te=Q();if(te){const Be=_e.NAME,yt=te.fn[Be];te.fn[Be]=_e.jQueryInterface,te.fn[Be].Constructor=_e,te.fn[Be].noConflict=()=>(te.fn[Be]=yt,_e.jQueryInterface)}},document.readyState==="loading"?(se.length||document.addEventListener("DOMContentLoaded",()=>{for(const te of se)te()}),se.push(V)):V()},ze=(_e,V=[],te=_e)=>typeof _e=="function"?_e.call(...V):te,xe=(_e,V,te=!0)=>{if(!te)return void ze(_e);const Be=(Yt=>{if(!Yt)return 0;let{transitionDuration:_n,transitionDelay:Bn}=window.getComputedStyle(Yt);const ni=Number.parseFloat(_n),Jn=Number.parseFloat(Bn);return ni||Jn?(_n=_n.split(",")[0],Bn=Bn.split(",")[0],1e3*(Number.parseFloat(_n)+Number.parseFloat(Bn))):0})(V)+5;let yt=!1;const xt=({target:Yt})=>{Yt===V&&(yt=!0,V.removeEventListener(c,xt),ze(_e))};V.addEventListener(c,xt),setTimeout(()=>{yt||o(V)},Be)},je=(_e,V,te,Be)=>{const yt=_e.length;let xt=_e.indexOf(V);return xt===-1?!te&&Be?_e[yt-1]:_e[0]:(xt+=te?1:-1,Be&&(xt=(xt+yt)%yt),_e[Math.max(0,Math.min(xt,yt-1))])},qe=/[^.]*(?=\..*)\.|.*/,oe=/\..*/,de=/::\d+$/,Ee={};let $e=1;const me={mouseenter:"mouseover",mouseleave:"mouseout"},Te=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Re(_e,V){return V&&`${V}::${$e++}`||_e.uidEvent||$e++}function tn(_e){const V=Re(_e);return _e.uidEvent=V,Ee[V]=Ee[V]||{},Ee[V]}function Zt(_e,V,te=null){return Object.values(_e).find(Be=>Be.callable===V&&Be.delegationSelector===te)}function on(_e,V,te){const Be=typeof V=="string",yt=Be?te:V||te;let xt=zi(_e);return Te.has(xt)||(xt=_e),[Be,yt,xt]}function hn(_e,V,te,Be,yt){if(typeof V!="string"||!_e)return;let[xt,Yt,_n]=on(V,te,Be);V in me&&(Yt=(Wi=>function($i){if(!$i.relatedTarget||$i.relatedTarget!==$i.delegateTarget&&!$i.delegateTarget.contains($i.relatedTarget))return Wi.call(this,$i)})(Yt));const Bn=tn(_e),ni=Bn[_n]||(Bn[_n]={}),Jn=Zt(ni,Yt,xt?te:null);if(Jn)return void(Jn.oneOff=Jn.oneOff&&yt);const Gn=Re(Yt,V.replace(qe,"")),Vi=xt?function(Li,Wi,$i){return function Yi(io){const po=Li.querySelectorAll(Wi);for(let{target:mr}=io;mr&&mr!==this;mr=mr.parentNode)for(const Nr of po)if(Nr===mr)return Di(io,{delegateTarget:mr}),Yi.oneOff&&Pt.off(Li,io.type,Wi,$i),$i.apply(mr,[io])}}(_e,te,Yt):function(Li,Wi){return function $i(Yi){return Di(Yi,{delegateTarget:Li}),$i.oneOff&&Pt.off(Li,Yi.type,Wi),Wi.apply(Li,[Yi])}}(_e,Yt);Vi.delegationSelector=xt?te:null,Vi.callable=Yt,Vi.oneOff=yt,Vi.uidEvent=Gn,ni[Gn]=Vi,_e.addEventListener(_n,Vi,xt)}function Hn(_e,V,te,Be,yt){const xt=Zt(V[te],Be,yt);xt&&(_e.removeEventListener(te,xt,!!yt),delete V[te][xt.uidEvent])}function Ri(_e,V,te,Be){const yt=V[te]||{};for(const[xt,Yt]of Object.entries(yt))xt.includes(Be)&&Hn(_e,V,te,Yt.callable,Yt.delegationSelector)}function zi(_e){return _e=_e.replace(oe,""),me[_e]||_e}const Pt={on(_e,V,te,Be){hn(_e,V,te,Be,!1)},one(_e,V,te,Be){hn(_e,V,te,Be,!0)},off(_e,V,te,Be){if(typeof V!="string"||!_e)return;const[yt,xt,Yt]=on(V,te,Be),_n=Yt!==V,Bn=tn(_e),ni=Bn[Yt]||{},Jn=V.startsWith(".");if(xt===void 0){if(Jn)for(const Gn of Object.keys(Bn))Ri(_e,Bn,Gn,V.slice(1));for(const[Gn,Vi]of Object.entries(ni)){const Li=Gn.replace(de,"");_n&&!V.includes(Li)||Hn(_e,Bn,Yt,Vi.callable,Vi.delegationSelector)}}else{if(!Object.keys(ni).length)return;Hn(_e,Bn,Yt,xt,yt?te:null)}},trigger(_e,V,te){if(typeof V!="string"||!_e)return null;const Be=Q();let yt=null,xt=!0,Yt=!0,_n=!1;V!==zi(V)&&Be&&(yt=Be.Event(V,te),Be(_e).trigger(yt),xt=!yt.isPropagationStopped(),Yt=!yt.isImmediatePropagationStopped(),_n=yt.isDefaultPrevented());const Bn=Di(new Event(V,{bubbles:xt,cancelable:!0}),te);return _n&&Bn.preventDefault(),Yt&&_e.dispatchEvent(Bn),Bn.defaultPrevented&&yt&&yt.preventDefault(),Bn}};function Di(_e,V={}){for(const[te,Be]of Object.entries(V))try{_e[te]=Be}catch{Object.defineProperty(_e,te,{configurable:!0,get:()=>Be})}return _e}function wo(_e){if(_e==="true")return!0;if(_e==="false")return!1;if(_e===Number(_e).toString())return Number(_e);if(_e===""||_e==="null")return null;if(typeof _e!="string")return _e;try{return JSON.parse(decodeURIComponent(_e))}catch{return _e}}function Ur(_e){return _e.replace(/[A-Z]/g,V=>`-${V.toLowerCase()}`)}const Br={setDataAttribute(_e,V,te){_e.setAttribute(`data-bs-${Ur(V)}`,te)},removeDataAttribute(_e,V){_e.removeAttribute(`data-bs-${Ur(V)}`)},getDataAttributes(_e){if(!_e)return{};const V={},te=Object.keys(_e.dataset).filter(Be=>Be.startsWith("bs")&&!Be.startsWith("bsConfig"));for(const Be of te){let yt=Be.replace(/^bs/,"");yt=yt.charAt(0).toLowerCase()+yt.slice(1),V[yt]=wo(_e.dataset[Be])}return V},getDataAttribute:(_e,V)=>wo(_e.getAttribute(`data-bs-${Ur(V)}`))};class ai{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(V){return V=this._mergeConfigObj(V),V=this._configAfterMerge(V),this._typeCheckConfig(V),V}_configAfterMerge(V){return V}_mergeConfigObj(V,te){const Be=w(te)?Br.getDataAttribute(te,"config"):{};return{...this.constructor.Default,...typeof Be=="object"?Be:{},...w(te)?Br.getDataAttributes(te):{},...typeof V=="object"?V:{}}}_typeCheckConfig(V,te=this.constructor.DefaultType){for(const[Be,yt]of Object.entries(te)){const xt=V[Be],Yt=w(xt)?"element":p(xt);if(!new RegExp(yt).test(Yt))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${Be}" provided type "${Yt}" but expected type "${yt}".`)}}}class Ft extends ai{constructor(V,te){super(),(V=T(V))&&(this._element=V,this._config=this._getConfig(te),r.set(this._element,this.constructor.DATA_KEY,this))}dispose(){r.remove(this._element,this.constructor.DATA_KEY),Pt.off(this._element,this.constructor.EVENT_KEY);for(const V of Object.getOwnPropertyNames(this))this[V]=null}_queueCallback(V,te,Be=!0){xe(V,te,Be)}_getConfig(V){return V=this._mergeConfigObj(V,this._element),V=this._configAfterMerge(V),this._typeCheckConfig(V),V}static getInstance(V){return r.get(T(V),this.DATA_KEY)}static getOrCreateInstance(V,te={}){return this.getInstance(V)||new this(V,typeof te=="object"?te:null)}static get VERSION(){return"5.3.8"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(V){return`${V}${this.EVENT_KEY}`}}const In=_e=>{let V=_e.getAttribute("data-bs-target");if(!V||V==="#"){let te=_e.getAttribute("href");if(!te||!te.includes("#")&&!te.startsWith("."))return null;te.includes("#")&&!te.startsWith("#")&&(te=`#${te.split("#")[1]}`),V=te&&te!=="#"?te.trim():null}return V?V.split(",").map(te=>u(te)).join(","):null},Wt={find:(_e,V=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(V,_e)),findOne:(_e,V=document.documentElement)=>Element.prototype.querySelector.call(V,_e),children:(_e,V)=>[].concat(..._e.children).filter(te=>te.matches(V)),parents(_e,V){const te=[];let Be=_e.parentNode.closest(V);for(;Be;)te.push(Be),Be=Be.parentNode.closest(V);return te},prev(_e,V){let te=_e.previousElementSibling;for(;te;){if(te.matches(V))return[te];te=te.previousElementSibling}return[]},next(_e,V){let te=_e.nextElementSibling;for(;te;){if(te.matches(V))return[te];te=te.nextElementSibling}return[]},focusableChildren(_e){const V=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(te=>`${te}:not([tabindex^="-"])`).join(",");return this.find(V,_e).filter(te=>!D(te)&&A(te))},getSelectorFromElement(_e){const V=In(_e);return V&&Wt.findOne(V)?V:null},getElementFromSelector(_e){const V=In(_e);return V?Wt.findOne(V):null},getMultipleElementsFromSelector(_e){const V=In(_e);return V?Wt.find(V):[]}},kn=(_e,V="hide")=>{const te=`click.dismiss${_e.EVENT_KEY}`,Be=_e.NAME;Pt.on(document,te,`[data-bs-dismiss="${Be}"]`,function(yt){if(["A","AREA"].includes(this.tagName)&&yt.preventDefault(),D(this))return;const xt=Wt.getElementFromSelector(this)||this.closest(`.${Be}`);_e.getOrCreateInstance(xt)[V]()})},dr=".bs.alert",Qe=`close${dr}`,at=`closed${dr}`;class vt extends Ft{static get NAME(){return"alert"}close(){if(Pt.trigger(this._element,Qe).defaultPrevented)return;this._element.classList.remove("show");const V=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,V)}_destroyElement(){this._element.remove(),Pt.trigger(this._element,at),this.dispose()}static jQueryInterface(V){return this.each(function(){const te=vt.getOrCreateInstance(this);if(typeof V=="string"){if(te[V]===void 0||V.startsWith("_")||V==="constructor")throw new TypeError(`No method named "${V}"`);te[V](this)}})}}kn(vt,"close"),be(vt);const Gt='[data-bs-toggle="button"]';class an extends Ft{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(V){return this.each(function(){const te=an.getOrCreateInstance(this);V==="toggle"&&te[V]()})}}Pt.on(document,"click.bs.button.data-api",Gt,_e=>{_e.preventDefault();const V=_e.target.closest(Gt);an.getOrCreateInstance(V).toggle()}),be(an);const Qt=".bs.swipe",On=`touchstart${Qt}`,fn=`touchmove${Qt}`,mn=`touchend${Qt}`,dn=`pointerdown${Qt}`,pi=`pointerup${Qt}`,Ln={endCallback:null,leftCallback:null,rightCallback:null},mi={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class yi extends ai{constructor(V,te){super(),this._element=V,V&&yi.isSupported()&&(this._config=this._getConfig(te),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Ln}static get DefaultType(){return mi}static get NAME(){return"swipe"}dispose(){Pt.off(this._element,Qt)}_start(V){this._supportPointerEvents?this._eventIsPointerPenTouch(V)&&(this._deltaX=V.clientX):this._deltaX=V.touches[0].clientX}_end(V){this._eventIsPointerPenTouch(V)&&(this._deltaX=V.clientX-this._deltaX),this._handleSwipe(),ze(this._config.endCallback)}_move(V){this._deltaX=V.touches&&V.touches.length>1?0:V.touches[0].clientX-this._deltaX}_handleSwipe(){const V=Math.abs(this._deltaX);if(V<=40)return;const te=V/this._deltaX;this._deltaX=0,te&&ze(te>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(Pt.on(this._element,dn,V=>this._start(V)),Pt.on(this._element,pi,V=>this._end(V)),this._element.classList.add("pointer-event")):(Pt.on(this._element,On,V=>this._start(V)),Pt.on(this._element,fn,V=>this._move(V)),Pt.on(this._element,mn,V=>this._end(V)))}_eventIsPointerPenTouch(V){return this._supportPointerEvents&&(V.pointerType==="pen"||V.pointerType==="touch")}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const xi=".bs.carousel",nr=".data-api",yr="ArrowLeft",zo="ArrowRight",Io="next",Sr="prev",ho="left",Cs="right",ha=`slide${xi}`,ao=`slid${xi}`,Ao=`keydown${xi}`,Fa=`mouseenter${xi}`,vr=`mouseleave${xi}`,ns=`dragstart${xi}`,_l=`load${xi}${nr}`,Wl=`click${xi}${nr}`,So="carousel",yl="active",Xa=".active",vl=".carousel-item",Dt=Xa+vl,bl={[yr]:Cs,[zo]:ho},ql={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},$c={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Xe extends Ft{constructor(V,te){super(V,te),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=Wt.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===So&&this.cycle()}static get Default(){return ql}static get DefaultType(){return $c}static get NAME(){return"carousel"}next(){this._slide(Io)}nextWhenVisible(){!document.hidden&&A(this._element)&&this.next()}prev(){this._slide(Sr)}pause(){this._isSliding&&o(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?Pt.one(this._element,ao,()=>this.cycle()):this.cycle())}to(V){const te=this._getItems();if(V>te.length-1||V<0)return;if(this._isSliding)return void Pt.one(this._element,ao,()=>this.to(V));const Be=this._getItemIndex(this._getActive());if(Be===V)return;const yt=V>Be?Io:Sr;this._slide(yt,te[V])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(V){return V.defaultInterval=V.interval,V}_addEventListeners(){this._config.keyboard&&Pt.on(this._element,Ao,V=>this._keydown(V)),this._config.pause==="hover"&&(Pt.on(this._element,Fa,()=>this.pause()),Pt.on(this._element,vr,()=>this._maybeEnableCycle())),this._config.touch&&yi.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const te of Wt.find(".carousel-item img",this._element))Pt.on(te,ns,Be=>Be.preventDefault());const V={leftCallback:()=>this._slide(this._directionToOrder(ho)),rightCallback:()=>this._slide(this._directionToOrder(Cs)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}};this._swipeHelper=new yi(this._element,V)}_keydown(V){if(/input|textarea/i.test(V.target.tagName))return;const te=bl[V.key];te&&(V.preventDefault(),this._slide(this._directionToOrder(te)))}_getItemIndex(V){return this._getItems().indexOf(V)}_setActiveIndicatorElement(V){if(!this._indicatorsElement)return;const te=Wt.findOne(Xa,this._indicatorsElement);te.classList.remove(yl),te.removeAttribute("aria-current");const Be=Wt.findOne(`[data-bs-slide-to="${V}"]`,this._indicatorsElement);Be&&(Be.classList.add(yl),Be.setAttribute("aria-current","true"))}_updateInterval(){const V=this._activeElement||this._getActive();if(!V)return;const te=Number.parseInt(V.getAttribute("data-bs-interval"),10);this._config.interval=te||this._config.defaultInterval}_slide(V,te=null){if(this._isSliding)return;const Be=this._getActive(),yt=V===Io,xt=te||je(this._getItems(),Be,yt,this._config.wrap);if(xt===Be)return;const Yt=this._getItemIndex(xt),_n=Gn=>Pt.trigger(this._element,Gn,{relatedTarget:xt,direction:this._orderToDirection(V),from:this._getItemIndex(Be),to:Yt});if(_n(ha).defaultPrevented||!Be||!xt)return;const Bn=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(Yt),this._activeElement=xt;const ni=yt?"carousel-item-start":"carousel-item-end",Jn=yt?"carousel-item-next":"carousel-item-prev";xt.classList.add(Jn),ee(xt),Be.classList.add(ni),xt.classList.add(ni),this._queueCallback(()=>{xt.classList.remove(ni,Jn),xt.classList.add(yl),Be.classList.remove(yl,Jn,ni),this._isSliding=!1,_n(ao)},Be,this._isAnimated()),Bn&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return Wt.findOne(Dt,this._element)}_getItems(){return Wt.find(vl,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(V){return ce()?V===ho?Sr:Io:V===ho?Io:Sr}_orderToDirection(V){return ce()?V===Sr?ho:Cs:V===Sr?Cs:ho}static jQueryInterface(V){return this.each(function(){const te=Xe.getOrCreateInstance(this,V);if(typeof V!="number"){if(typeof V=="string"){if(te[V]===void 0||V.startsWith("_")||V==="constructor")throw new TypeError(`No method named "${V}"`);te[V]()}}else te.to(V)})}}Pt.on(document,Wl,"[data-bs-slide], [data-bs-slide-to]",function(_e){const V=Wt.getElementFromSelector(this);if(!V||!V.classList.contains(So))return;_e.preventDefault();const te=Xe.getOrCreateInstance(V),Be=this.getAttribute("data-bs-slide-to");return Be?(te.to(Be),void te._maybeEnableCycle()):Br.getDataAttribute(this,"slide")==="next"?(te.next(),void te._maybeEnableCycle()):(te.prev(),void te._maybeEnableCycle())}),Pt.on(window,_l,()=>{const _e=Wt.find('[data-bs-ride="carousel"]');for(const V of _e)Xe.getOrCreateInstance(V)}),be(Xe);const Y=".bs.collapse",ie=`show${Y}`,ve=`shown${Y}`,Fe=`hide${Y}`,Oe=`hidden${Y}`,Le=`click${Y}.data-api`,it="show",Ge="collapse",st="collapsing",Nt=`:scope .${Ge} .${Ge}`,St='[data-bs-toggle="collapse"]',xn={parent:null,toggle:!0},Mn={parent:"(null|element)",toggle:"boolean"};class zn extends Ft{constructor(V,te){super(V,te),this._isTransitioning=!1,this._triggerArray=[];const Be=Wt.find(St);for(const yt of Be){const xt=Wt.getSelectorFromElement(yt),Yt=Wt.find(xt).filter(_n=>_n===this._element);xt!==null&&Yt.length&&this._triggerArray.push(yt)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return xn}static get DefaultType(){return Mn}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let V=[];if(this._config.parent&&(V=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(yt=>yt!==this._element).map(yt=>zn.getOrCreateInstance(yt,{toggle:!1}))),V.length&&V[0]._isTransitioning||Pt.trigger(this._element,ie).defaultPrevented)return;for(const yt of V)yt.hide();const te=this._getDimension();this._element.classList.remove(Ge),this._element.classList.add(st),this._element.style[te]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const Be=`scroll${te[0].toUpperCase()+te.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(st),this._element.classList.add(Ge,it),this._element.style[te]="",Pt.trigger(this._element,ve)},this._element,!0),this._element.style[te]=`${this._element[Be]}px`}hide(){if(this._isTransitioning||!this._isShown()||Pt.trigger(this._element,Fe).defaultPrevented)return;const V=this._getDimension();this._element.style[V]=`${this._element.getBoundingClientRect()[V]}px`,ee(this._element),this._element.classList.add(st),this._element.classList.remove(Ge,it);for(const te of this._triggerArray){const Be=Wt.getElementFromSelector(te);Be&&!this._isShown(Be)&&this._addAriaAndCollapsedClass([te],!1)}this._isTransitioning=!0,this._element.style[V]="",this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(st),this._element.classList.add(Ge),Pt.trigger(this._element,Oe)},this._element,!0)}_isShown(V=this._element){return V.classList.contains(it)}_configAfterMerge(V){return V.toggle=!!V.toggle,V.parent=T(V.parent),V}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const V=this._getFirstLevelChildren(St);for(const te of V){const Be=Wt.getElementFromSelector(te);Be&&this._addAriaAndCollapsedClass([te],this._isShown(Be))}}_getFirstLevelChildren(V){const te=Wt.find(Nt,this._config.parent);return Wt.find(V,this._config.parent).filter(Be=>!te.includes(Be))}_addAriaAndCollapsedClass(V,te){if(V.length)for(const Be of V)Be.classList.toggle("collapsed",!te),Be.setAttribute("aria-expanded",te)}static jQueryInterface(V){const te={};return typeof V=="string"&&/show|hide/.test(V)&&(te.toggle=!1),this.each(function(){const Be=zn.getOrCreateInstance(this,te);if(typeof V=="string"){if(Be[V]===void 0)throw new TypeError(`No method named "${V}"`);Be[V]()}})}}Pt.on(document,Le,St,function(_e){(_e.target.tagName==="A"||_e.delegateTarget&&_e.delegateTarget.tagName==="A")&&_e.preventDefault();for(const V of Wt.getMultipleElementsFromSelector(this))zn.getOrCreateInstance(V,{toggle:!1}).toggle()}),be(zn);var Kn="top",Un="bottom",ei="right",Ei="left",li="auto",cr=[Kn,Un,ei,Ei],Fr="start",no="end",ir="clippingParents",Oi="viewport",Cr="popper",Pr="reference",ur=cr.reduce(function(_e,V){return _e.concat([V+"-"+Fr,V+"-"+no])},[]),Zo=[].concat(cr,[li]).reduce(function(_e,V){return _e.concat([V,V+"-"+Fr,V+"-"+no])},[]),Ts="beforeRead",ta="read",Ya="afterRead",ko="beforeMain",Zs="main",pc="afterMain",fa="beforeWrite",xl="write",Xr="afterWrite",wl=[Ts,ta,Ya,ko,Zs,pc,fa,xl,Xr];function is(_e){return _e?(_e.nodeName||"").toLowerCase():null}function rs(_e){if(_e==null)return window;if(_e.toString()!=="[object Window]"){var V=_e.ownerDocument;return V&&V.defaultView||window}return _e}function Sl(_e){return _e instanceof rs(_e).Element||_e instanceof Element}function Ko(_e){return _e instanceof rs(_e).HTMLElement||_e instanceof HTMLElement}function Tu(_e){return typeof ShadowRoot<"u"&&(_e instanceof rs(_e).ShadowRoot||_e instanceof ShadowRoot)}const jc={name:"applyStyles",enabled:!0,phase:"write",fn:function(_e){var V=_e.state;Object.keys(V.elements).forEach(function(te){var Be=V.styles[te]||{},yt=V.attributes[te]||{},xt=V.elements[te];Ko(xt)&&is(xt)&&(Object.assign(xt.style,Be),Object.keys(yt).forEach(function(Yt){var _n=yt[Yt];_n===!1?xt.removeAttribute(Yt):xt.setAttribute(Yt,_n===!0?"":_n)}))})},effect:function(_e){var V=_e.state,te={popper:{position:V.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(V.elements.popper.style,te.popper),V.styles=te,V.elements.arrow&&Object.assign(V.elements.arrow.style,te.arrow),function(){Object.keys(V.elements).forEach(function(Be){var yt=V.elements[Be],xt=V.attributes[Be]||{},Yt=Object.keys(V.styles.hasOwnProperty(Be)?V.styles[Be]:te[Be]).reduce(function(_n,Bn){return _n[Bn]="",_n},{});Ko(yt)&&is(yt)&&(Object.assign(yt.style,Yt),Object.keys(xt).forEach(function(_n){yt.removeAttribute(_n)}))})}},requires:["computeStyles"]};function Xo(_e){return _e.split("-")[0]}var Ns=Math.max,Ks=Math.min,Yo=Math.round;function vs(){var _e=navigator.userAgentData;return _e!=null&&_e.brands&&Array.isArray(_e.brands)?_e.brands.map(function(V){return V.brand+"/"+V.version}).join(" "):navigator.userAgent}function Cl(){return!/^((?!chrome|android).)*safari/i.test(vs())}function Tl(_e,V,te){V===void 0&&(V=!1),te===void 0&&(te=!1);var Be=_e.getBoundingClientRect(),yt=1,xt=1;V&&Ko(_e)&&(yt=_e.offsetWidth>0&&Yo(Be.width)/_e.offsetWidth||1,xt=_e.offsetHeight>0&&Yo(Be.height)/_e.offsetHeight||1);var Yt=(Sl(_e)?rs(_e):window).visualViewport,_n=!Cl()&&te,Bn=(Be.left+(_n&&Yt?Yt.offsetLeft:0))/yt,ni=(Be.top+(_n&&Yt?Yt.offsetTop:0))/xt,Jn=Be.width/yt,Gn=Be.height/xt;return{width:Jn,height:Gn,top:ni,right:Bn+Jn,bottom:ni+Gn,left:Bn,x:Bn,y:ni}}function Zl(_e){var V=Tl(_e),te=_e.offsetWidth,Be=_e.offsetHeight;return Math.abs(V.width-te)<=1&&(te=V.width),Math.abs(V.height-Be)<=1&&(Be=V.height),{x:_e.offsetLeft,y:_e.offsetTop,width:te,height:Be}}function Ja(_e,V){var te=V.getRootNode&&V.getRootNode();if(_e.contains(V))return!0;if(te&&Tu(te)){var Be=V;do{if(Be&&_e.isSameNode(Be))return!0;Be=Be.parentNode||Be.host}while(Be)}return!1}function Es(_e){return rs(_e).getComputedStyle(_e)}function Eu(_e){return["table","td","th"].indexOf(is(_e))>=0}function pa(_e){return((Sl(_e)?_e.ownerDocument:_e.document)||window.document).documentElement}function Xs(_e){return is(_e)==="html"?_e:_e.assignedSlot||_e.parentNode||(Tu(_e)?_e.host:null)||pa(_e)}function Na(_e){return Ko(_e)&&Es(_e).position!=="fixed"?_e.offsetParent:null}function Kl(_e){for(var V=rs(_e),te=Na(_e);te&&Eu(te)&&Es(te).position==="static";)te=Na(te);return te&&(is(te)==="html"||is(te)==="body"&&Es(te).position==="static")?V:te||function(Be){var yt=/firefox/i.test(vs());if(/Trident/i.test(vs())&&Ko(Be)&&Es(Be).position==="fixed")return null;var xt=Xs(Be);for(Tu(xt)&&(xt=xt.host);Ko(xt)&&["html","body"].indexOf(is(xt))<0;){var Yt=Es(xt);if(Yt.transform!=="none"||Yt.perspective!=="none"||Yt.contain==="paint"||["transform","perspective"].indexOf(Yt.willChange)!==-1||yt&&Yt.willChange==="filter"||yt&&Yt.filter&&Yt.filter!=="none")return xt;xt=xt.parentNode}return null}(_e)||V}function Qa(_e){return["top","bottom"].indexOf(_e)>=0?"x":"y"}function Va(_e,V,te){return Ns(_e,Ks(V,te))}function Iu(_e){return Object.assign({},{top:0,right:0,bottom:0,left:0},_e)}function El(_e,V){return V.reduce(function(te,Be){return te[Be]=_e,te},{})}const Ci={name:"arrow",enabled:!0,phase:"main",fn:function(_e){var V,te=_e.state,Be=_e.name,yt=_e.options,xt=te.elements.arrow,Yt=te.modifiersData.popperOffsets,_n=Xo(te.placement),Bn=Qa(_n),ni=[Ei,ei].indexOf(_n)>=0?"height":"width";if(xt&&Yt){var Jn=function(mo,go){return Iu(typeof(mo=typeof mo=="function"?mo(Object.assign({},go.rects,{placement:go.placement})):mo)!="number"?mo:El(mo,cr))}(yt.padding,te),Gn=Zl(xt),Vi=Bn==="y"?Kn:Ei,Li=Bn==="y"?Un:ei,Wi=te.rects.reference[ni]+te.rects.reference[Bn]-Yt[Bn]-te.rects.popper[ni],$i=Yt[Bn]-te.rects.reference[Bn],Yi=Kl(xt),io=Yi?Bn==="y"?Yi.clientHeight||0:Yi.clientWidth||0:0,po=Wi/2-$i/2,mr=Jn[Vi],Nr=io-Gn[ni]-Jn[Li],Qi=io/2-Gn[ni]/2+po,Dr=Va(mr,Qi,Nr),Ar=Bn;te.modifiersData[Be]=((V={})[Ar]=Dr,V.centerOffset=Dr-Qi,V)}},effect:function(_e){var V=_e.state,te=_e.options.element,Be=te===void 0?"[data-popper-arrow]":te;Be!=null&&(typeof Be!="string"||(Be=V.elements.popper.querySelector(Be)))&&Ja(V.elements.popper,Be)&&(V.elements.arrow=Be)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Sa(_e){return _e.split("-")[1]}var md={top:"auto",right:"auto",bottom:"auto",left:"auto"};function $o(_e){var V,te=_e.popper,Be=_e.popperRect,yt=_e.placement,xt=_e.variation,Yt=_e.offsets,_n=_e.position,Bn=_e.gpuAcceleration,ni=_e.adaptive,Jn=_e.roundOffsets,Gn=_e.isFixed,Vi=Yt.x,Li=Vi===void 0?0:Vi,Wi=Yt.y,$i=Wi===void 0?0:Wi,Yi=typeof Jn=="function"?Jn({x:Li,y:$i}):{x:Li,y:$i};Li=Yi.x,$i=Yi.y;var io=Yt.hasOwnProperty("x"),po=Yt.hasOwnProperty("y"),mr=Ei,Nr=Kn,Qi=window;if(ni){var Dr=Kl(te),Ar="clientHeight",mo="clientWidth";Dr===rs(te)&&Es(Dr=pa(te)).position!=="static"&&_n==="absolute"&&(Ar="scrollHeight",mo="scrollWidth"),(yt===Kn||(yt===Ei||yt===ei)&&xt===no)&&(Nr=Un,$i-=(Gn&&Dr===Qi&&Qi.visualViewport?Qi.visualViewport.height:Dr[Ar])-Be.height,$i*=Bn?1:-1),yt!==Ei&&(yt!==Kn&&yt!==Un||xt!==no)||(mr=ei,Li-=(Gn&&Dr===Qi&&Qi.visualViewport?Qi.visualViewport.width:Dr[mo])-Be.width,Li*=Bn?1:-1)}var go,Qo=Object.assign({position:_n},ni&&md),va=Jn===!0?function(Ps,js){var Us=Ps.x,Aa=Ps.y,Uo=js.devicePixelRatio||1;return{x:Yo(Us*Uo)/Uo||0,y:Yo(Aa*Uo)/Uo||0}}({x:Li,y:$i},rs(te)):{x:Li,y:$i};return Li=va.x,$i=va.y,Bn?Object.assign({},Qo,((go={})[Nr]=po?"0":"",go[mr]=io?"0":"",go.transform=(Qi.devicePixelRatio||1)<=1?"translate("+Li+"px, "+$i+"px)":"translate3d("+Li+"px, "+$i+"px, 0)",go)):Object.assign({},Qo,((V={})[Nr]=po?$i+"px":"",V[mr]=io?Li+"px":"",V.transform="",V))}const Uc={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(_e){var V=_e.state,te=_e.options,Be=te.gpuAcceleration,yt=Be===void 0||Be,xt=te.adaptive,Yt=xt===void 0||xt,_n=te.roundOffsets,Bn=_n===void 0||_n,ni={placement:Xo(V.placement),variation:Sa(V.placement),popper:V.elements.popper,popperRect:V.rects.popper,gpuAcceleration:yt,isFixed:V.options.strategy==="fixed"};V.modifiersData.popperOffsets!=null&&(V.styles.popper=Object.assign({},V.styles.popper,$o(Object.assign({},ni,{offsets:V.modifiersData.popperOffsets,position:V.options.strategy,adaptive:Yt,roundOffsets:Bn})))),V.modifiersData.arrow!=null&&(V.styles.arrow=Object.assign({},V.styles.arrow,$o(Object.assign({},ni,{offsets:V.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:Bn})))),V.attributes.popper=Object.assign({},V.attributes.popper,{"data-popper-placement":V.placement})},data:{}};var $a={passive:!0};const Il={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(_e){var V=_e.state,te=_e.instance,Be=_e.options,yt=Be.scroll,xt=yt===void 0||yt,Yt=Be.resize,_n=Yt===void 0||Yt,Bn=rs(V.elements.popper),ni=[].concat(V.scrollParents.reference,V.scrollParents.popper);return xt&&ni.forEach(function(Jn){Jn.addEventListener("scroll",te.update,$a)}),_n&&Bn.addEventListener("resize",te.update,$a),function(){xt&&ni.forEach(function(Jn){Jn.removeEventListener("scroll",te.update,$a)}),_n&&Bn.removeEventListener("resize",te.update,$a)}},data:{}};var Hc={left:"right",right:"left",bottom:"top",top:"bottom"};function Xl(_e){return _e.replace(/left|right|bottom|top/g,function(V){return Hc[V]})}var Au={start:"end",end:"start"};function na(_e){return _e.replace(/start|end/g,function(V){return Au[V]})}function ku(_e){var V=rs(_e);return{scrollLeft:V.pageXOffset,scrollTop:V.pageYOffset}}function Ru(_e){return Tl(pa(_e)).left+ku(_e).scrollLeft}function Ca(_e){var V=Es(_e),te=V.overflow,Be=V.overflowX,yt=V.overflowY;return/auto|scroll|overlay|hidden/.test(te+yt+Be)}function Gc(_e){return["html","body","#document"].indexOf(is(_e))>=0?_e.ownerDocument.body:Ko(_e)&&Ca(_e)?_e:Gc(Xs(_e))}function Vs(_e,V){var te;V===void 0&&(V=[]);var Be=Gc(_e),yt=Be===((te=_e.ownerDocument)==null?void 0:te.body),xt=rs(Be),Yt=yt?[xt].concat(xt.visualViewport||[],Ca(Be)?Be:[]):Be,_n=V.concat(Yt);return yt?_n:_n.concat(Vs(Xs(Yt)))}function el(_e){return Object.assign({},_e,{left:_e.x,top:_e.y,right:_e.x+_e.width,bottom:_e.y+_e.height})}function Wc(_e,V,te){return V===Oi?el(function(Be,yt){var xt=rs(Be),Yt=pa(Be),_n=xt.visualViewport,Bn=Yt.clientWidth,ni=Yt.clientHeight,Jn=0,Gn=0;if(_n){Bn=_n.width,ni=_n.height;var Vi=Cl();(Vi||!Vi&&yt==="fixed")&&(Jn=_n.offsetLeft,Gn=_n.offsetTop)}return{width:Bn,height:ni,x:Jn+Ru(Be),y:Gn}}(_e,te)):Sl(V)?function(Be,yt){var xt=Tl(Be,!1,yt==="fixed");return xt.top=xt.top+Be.clientTop,xt.left=xt.left+Be.clientLeft,xt.bottom=xt.top+Be.clientHeight,xt.right=xt.left+Be.clientWidth,xt.width=Be.clientWidth,xt.height=Be.clientHeight,xt.x=xt.left,xt.y=xt.top,xt}(V,te):el(function(Be){var yt,xt=pa(Be),Yt=ku(Be),_n=(yt=Be.ownerDocument)==null?void 0:yt.body,Bn=Ns(xt.scrollWidth,xt.clientWidth,_n?_n.scrollWidth:0,_n?_n.clientWidth:0),ni=Ns(xt.scrollHeight,xt.clientHeight,_n?_n.scrollHeight:0,_n?_n.clientHeight:0),Jn=-Yt.scrollLeft+Ru(Be),Gn=-Yt.scrollTop;return Es(_n||xt).direction==="rtl"&&(Jn+=Ns(xt.clientWidth,_n?_n.clientWidth:0)-Bn),{width:Bn,height:ni,x:Jn,y:Gn}}(pa(_e)))}function $s(_e){var V,te=_e.reference,Be=_e.element,yt=_e.placement,xt=yt?Xo(yt):null,Yt=yt?Sa(yt):null,_n=te.x+te.width/2-Be.width/2,Bn=te.y+te.height/2-Be.height/2;switch(xt){case Kn:V={x:_n,y:te.y-Be.height};break;case Un:V={x:_n,y:te.y+te.height};break;case ei:V={x:te.x+te.width,y:Bn};break;case Ei:V={x:te.x-Be.width,y:Bn};break;default:V={x:te.x,y:te.y}}var ni=xt?Qa(xt):null;if(ni!=null){var Jn=ni==="y"?"height":"width";switch(Yt){case Fr:V[ni]=V[ni]-(te[Jn]/2-Be[Jn]/2);break;case no:V[ni]=V[ni]+(te[Jn]/2-Be[Jn]/2)}}return V}function Ta(_e,V){V===void 0&&(V={});var te=V,Be=te.placement,yt=Be===void 0?_e.placement:Be,xt=te.strategy,Yt=xt===void 0?_e.strategy:xt,_n=te.boundary,Bn=_n===void 0?ir:_n,ni=te.rootBoundary,Jn=ni===void 0?Oi:ni,Gn=te.elementContext,Vi=Gn===void 0?Cr:Gn,Li=te.altBoundary,Wi=Li!==void 0&&Li,$i=te.padding,Yi=$i===void 0?0:$i,io=Iu(typeof Yi!="number"?Yi:El(Yi,cr)),po=Vi===Cr?Pr:Cr,mr=_e.rects.popper,Nr=_e.elements[Wi?po:Vi],Qi=function(js,Us,Aa,Uo){var Ha=Us==="clippingParents"?function(Gr){var Ms=Vs(Xs(Gr)),en=["absolute","fixed"].indexOf(Es(Gr).position)>=0&&Ko(Gr)?Kl(Gr):Gr;return Sl(en)?Ms.filter(function(oc){return Sl(oc)&&Ja(oc,en)&&is(oc)!=="body"}):[]}(js):[].concat(Us),ka=[].concat(Ha,[Aa]),bc=ka[0],Hs=ka.reduce(function(Gr,Ms){var en=Wc(js,Ms,Uo);return Gr.top=Ns(en.top,Gr.top),Gr.right=Ks(en.right,Gr.right),Gr.bottom=Ks(en.bottom,Gr.bottom),Gr.left=Ns(en.left,Gr.left),Gr},Wc(js,bc,Uo));return Hs.width=Hs.right-Hs.left,Hs.height=Hs.bottom-Hs.top,Hs.x=Hs.left,Hs.y=Hs.top,Hs}(Sl(Nr)?Nr:Nr.contextElement||pa(_e.elements.popper),Bn,Jn,Yt),Dr=Tl(_e.elements.reference),Ar=$s({reference:Dr,element:mr,placement:yt}),mo=el(Object.assign({},mr,Ar)),go=Vi===Cr?mo:Dr,Qo={top:Qi.top-go.top+io.top,bottom:go.bottom-Qi.bottom+io.bottom,left:Qi.left-go.left+io.left,right:go.right-Qi.right+io.right},va=_e.modifiersData.offset;if(Vi===Cr&&va){var Ps=va[yt];Object.keys(Qo).forEach(function(js){var Us=[ei,Un].indexOf(js)>=0?1:-1,Aa=[Kn,Un].indexOf(js)>=0?"y":"x";Qo[js]+=Ps[Aa]*Us})}return Qo}function sa(_e,V){V===void 0&&(V={});var te=V,Be=te.placement,yt=te.boundary,xt=te.rootBoundary,Yt=te.padding,_n=te.flipVariations,Bn=te.allowedAutoPlacements,ni=Bn===void 0?Zo:Bn,Jn=Sa(Be),Gn=Jn?_n?ur:ur.filter(function(Wi){return Sa(Wi)===Jn}):cr,Vi=Gn.filter(function(Wi){return ni.indexOf(Wi)>=0});Vi.length===0&&(Vi=Gn);var Li=Vi.reduce(function(Wi,$i){return Wi[$i]=Ta(_e,{placement:$i,boundary:yt,rootBoundary:xt,padding:Yt})[Xo($i)],Wi},{});return Object.keys(Li).sort(function(Wi,$i){return Li[Wi]-Li[$i]})}const Yl={name:"flip",enabled:!0,phase:"main",fn:function(_e){var V=_e.state,te=_e.options,Be=_e.name;if(!V.modifiersData[Be]._skip){for(var yt=te.mainAxis,xt=yt===void 0||yt,Yt=te.altAxis,_n=Yt===void 0||Yt,Bn=te.fallbackPlacements,ni=te.padding,Jn=te.boundary,Gn=te.rootBoundary,Vi=te.altBoundary,Li=te.flipVariations,Wi=Li===void 0||Li,$i=te.allowedAutoPlacements,Yi=V.options.placement,io=Xo(Yi),po=Bn||(io!==Yi&&Wi?function(Gr){if(Xo(Gr)===li)return[];var Ms=Xl(Gr);return[na(Gr),Ms,na(Ms)]}(Yi):[Xl(Yi)]),mr=[Yi].concat(po).reduce(function(Gr,Ms){return Gr.concat(Xo(Ms)===li?sa(V,{placement:Ms,boundary:Jn,rootBoundary:Gn,padding:ni,flipVariations:Wi,allowedAutoPlacements:$i}):Ms)},[]),Nr=V.rects.reference,Qi=V.rects.popper,Dr=new Map,Ar=!0,mo=mr[0],go=0;go<mr.length;go++){var Qo=mr[go],va=Xo(Qo),Ps=Sa(Qo)===Fr,js=[Kn,Un].indexOf(va)>=0,Us=js?"width":"height",Aa=Ta(V,{placement:Qo,boundary:Jn,rootBoundary:Gn,altBoundary:Vi,padding:ni}),Uo=js?Ps?ei:Ei:Ps?Un:Kn;Nr[Us]>Qi[Us]&&(Uo=Xl(Uo));var Ha=Xl(Uo),ka=[];if(xt&&ka.push(Aa[va]<=0),_n&&ka.push(Aa[Uo]<=0,Aa[Ha]<=0),ka.every(function(Gr){return Gr})){mo=Qo,Ar=!1;break}Dr.set(Qo,ka)}if(Ar)for(var bc=function(Gr){var Ms=mr.find(function(en){var oc=Dr.get(en);if(oc)return oc.slice(0,Gr).every(function(rl){return rl})});if(Ms)return mo=Ms,"break"},Hs=Wi?3:1;Hs>0&&bc(Hs)!=="break";Hs--);V.placement!==mo&&(V.modifiersData[Be]._skip=!0,V.placement=mo,V.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function qc(_e,V,te){return te===void 0&&(te={x:0,y:0}),{top:_e.top-V.height-te.y,right:_e.right-V.width+te.x,bottom:_e.bottom-V.height+te.y,left:_e.left-V.width-te.x}}function Pu(_e){return[Kn,ei,Un,Ei].some(function(V){return _e[V]>=0})}const Bi={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(_e){var V=_e.state,te=_e.name,Be=V.rects.reference,yt=V.rects.popper,xt=V.modifiersData.preventOverflow,Yt=Ta(V,{elementContext:"reference"}),_n=Ta(V,{altBoundary:!0}),Bn=qc(Yt,Be),ni=qc(_n,yt,xt),Jn=Pu(Bn),Gn=Pu(ni);V.modifiersData[te]={referenceClippingOffsets:Bn,popperEscapeOffsets:ni,isReferenceHidden:Jn,hasPopperEscaped:Gn},V.attributes.popper=Object.assign({},V.attributes.popper,{"data-popper-reference-hidden":Jn,"data-popper-escaped":Gn})}},Zc={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(_e){var V=_e.state,te=_e.options,Be=_e.name,yt=te.offset,xt=yt===void 0?[0,0]:yt,Yt=Zo.reduce(function(Jn,Gn){return Jn[Gn]=function(Vi,Li,Wi){var $i=Xo(Vi),Yi=[Ei,Kn].indexOf($i)>=0?-1:1,io=typeof Wi=="function"?Wi(Object.assign({},Li,{placement:Vi})):Wi,po=io[0],mr=io[1];return po=po||0,mr=(mr||0)*Yi,[Ei,ei].indexOf($i)>=0?{x:mr,y:po}:{x:po,y:mr}}(Gn,V.rects,xt),Jn},{}),_n=Yt[V.placement],Bn=_n.x,ni=_n.y;V.modifiersData.popperOffsets!=null&&(V.modifiersData.popperOffsets.x+=Bn,V.modifiersData.popperOffsets.y+=ni),V.modifiersData[Be]=Yt}},Mu={name:"popperOffsets",enabled:!0,phase:"read",fn:function(_e){var V=_e.state,te=_e.name;V.modifiersData[te]=$s({reference:V.rects.reference,element:V.rects.popper,placement:V.placement})},data:{}},Jl={name:"preventOverflow",enabled:!0,phase:"main",fn:function(_e){var V=_e.state,te=_e.options,Be=_e.name,yt=te.mainAxis,xt=yt===void 0||yt,Yt=te.altAxis,_n=Yt!==void 0&&Yt,Bn=te.boundary,ni=te.rootBoundary,Jn=te.altBoundary,Gn=te.padding,Vi=te.tether,Li=Vi===void 0||Vi,Wi=te.tetherOffset,$i=Wi===void 0?0:Wi,Yi=Ta(V,{boundary:Bn,rootBoundary:ni,padding:Gn,altBoundary:Jn}),io=Xo(V.placement),po=Sa(V.placement),mr=!po,Nr=Qa(io),Qi=Nr==="x"?"y":"x",Dr=V.modifiersData.popperOffsets,Ar=V.rects.reference,mo=V.rects.popper,go=typeof $i=="function"?$i(Object.assign({},V.rects,{placement:V.placement})):$i,Qo=typeof go=="number"?{mainAxis:go,altAxis:go}:Object.assign({mainAxis:0,altAxis:0},go),va=V.modifiersData.offset?V.modifiersData.offset[V.placement]:null,Ps={x:0,y:0};if(Dr){if(xt){var js,Us=Nr==="y"?Kn:Ei,Aa=Nr==="y"?Un:ei,Uo=Nr==="y"?"height":"width",Ha=Dr[Nr],ka=Ha+Yi[Us],bc=Ha-Yi[Aa],Hs=Li?-mo[Uo]/2:0,Gr=po===Fr?Ar[Uo]:mo[Uo],Ms=po===Fr?-mo[Uo]:-Ar[Uo],en=V.elements.arrow,oc=Li&&en?Zl(en):{width:0,height:0},rl=V.modifiersData["arrow#persistent"]?V.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},xc=rl[Us],wc=rl[Aa],Rn=Va(0,Ar[Uo],oc[Uo]),um=mr?Ar[Uo]/2-Hs-Rn-xc-Qo.mainAxis:Gr-Rn-xc-Qo.mainAxis,jg=mr?-Ar[Uo]/2+Hs+Rn+wc+Qo.mainAxis:Ms+Rn+wc+Qo.mainAxis,Rd=V.elements.arrow&&Kl(V.elements.arrow),Nf=Rd?Nr==="y"?Rd.clientTop||0:Rd.clientLeft||0:0,bh=(js=va==null?void 0:va[Nr])!=null?js:0,Py=Ha+jg-bh,dm=Va(Li?Ks(ka,Ha+um-bh-Nf):ka,Ha,Li?Ns(bc,Py):bc);Dr[Nr]=dm,Ps[Nr]=dm-Ha}if(_n){var Ug,My=Nr==="x"?Kn:Ei,Ra=Nr==="x"?Un:ei,Sc=Dr[Qi],Gs=Qi==="y"?"height":"width",Cc=Sc+Yi[My],hm=Sc-Yi[Ra],xh=[Kn,Ei].indexOf(io)!==-1,Vf=(Ug=va==null?void 0:va[Qi])!=null?Ug:0,wh=xh?Cc:Sc-Ar[Gs]-mo[Gs]-Vf+Qo.altAxis,ou=xh?Sc+Ar[Gs]+mo[Gs]-Vf-Qo.altAxis:hm,Pl=Li&&xh?function(Tr,$u,Sh){var fm=Va(Tr,$u,Sh);return fm>Sh?Sh:fm}(wh,Sc,ou):Va(Li?wh:Cc,Sc,Li?ou:hm);Dr[Qi]=Pl,Ps[Qi]=Pl-Sc}V.modifiersData[Be]=Ps}},requiresIfExists:["offset"]};function Pn(_e,V,te){te===void 0&&(te=!1);var Be,yt,xt=Ko(V),Yt=Ko(V)&&function(Gn){var Vi=Gn.getBoundingClientRect(),Li=Yo(Vi.width)/Gn.offsetWidth||1,Wi=Yo(Vi.height)/Gn.offsetHeight||1;return Li!==1||Wi!==1}(V),_n=pa(V),Bn=Tl(_e,Yt,te),ni={scrollLeft:0,scrollTop:0},Jn={x:0,y:0};return(xt||!xt&&!te)&&((is(V)!=="body"||Ca(_n))&&(ni=(Be=V)!==rs(Be)&&Ko(Be)?{scrollLeft:(yt=Be).scrollLeft,scrollTop:yt.scrollTop}:ku(Be)),Ko(V)?((Jn=Tl(V,!0)).x+=V.clientLeft,Jn.y+=V.clientTop):_n&&(Jn.x=Ru(_n))),{x:Bn.left+ni.scrollLeft-Jn.x,y:Bn.top+ni.scrollTop-Jn.y,width:Bn.width,height:Bn.height}}function gd(_e){var V=new Map,te=new Set,Be=[];function yt(xt){te.add(xt.name),[].concat(xt.requires||[],xt.requiresIfExists||[]).forEach(function(Yt){if(!te.has(Yt)){var _n=V.get(Yt);_n&&yt(_n)}}),Be.push(xt)}return _e.forEach(function(xt){V.set(xt.name,xt)}),_e.forEach(function(xt){te.has(xt.name)||yt(xt)}),Be}var us={placement:"bottom",modifiers:[],strategy:"absolute"};function ma(){for(var _e=arguments.length,V=new Array(_e),te=0;te<_e;te++)V[te]=arguments[te];return!V.some(function(Be){return!(Be&&typeof Be.getBoundingClientRect=="function")})}function Ql(_e){_e===void 0&&(_e={});var V=_e,te=V.defaultModifiers,Be=te===void 0?[]:te,yt=V.defaultOptions,xt=yt===void 0?us:yt;return function(Yt,_n,Bn){Bn===void 0&&(Bn=xt);var ni,Jn,Gn={placement:"bottom",orderedModifiers:[],options:Object.assign({},us,xt),modifiersData:{},elements:{reference:Yt,popper:_n},attributes:{},styles:{}},Vi=[],Li=!1,Wi={state:Gn,setOptions:function(Yi){var io=typeof Yi=="function"?Yi(Gn.options):Yi;$i(),Gn.options=Object.assign({},xt,Gn.options,io),Gn.scrollParents={reference:Sl(Yt)?Vs(Yt):Yt.contextElement?Vs(Yt.contextElement):[],popper:Vs(_n)};var po,mr,Nr=function(Qi){var Dr=gd(Qi);return wl.reduce(function(Ar,mo){return Ar.concat(Dr.filter(function(go){return go.phase===mo}))},[])}((po=[].concat(Be,Gn.options.modifiers),mr=po.reduce(function(Qi,Dr){var Ar=Qi[Dr.name];return Qi[Dr.name]=Ar?Object.assign({},Ar,Dr,{options:Object.assign({},Ar.options,Dr.options),data:Object.assign({},Ar.data,Dr.data)}):Dr,Qi},{}),Object.keys(mr).map(function(Qi){return mr[Qi]})));return Gn.orderedModifiers=Nr.filter(function(Qi){return Qi.enabled}),Gn.orderedModifiers.forEach(function(Qi){var Dr=Qi.name,Ar=Qi.options,mo=Ar===void 0?{}:Ar,go=Qi.effect;if(typeof go=="function"){var Qo=go({state:Gn,name:Dr,instance:Wi,options:mo});Vi.push(Qo||function(){})}}),Wi.update()},forceUpdate:function(){if(!Li){var Yi=Gn.elements,io=Yi.reference,po=Yi.popper;if(ma(io,po)){Gn.rects={reference:Pn(io,Kl(po),Gn.options.strategy==="fixed"),popper:Zl(po)},Gn.reset=!1,Gn.placement=Gn.options.placement,Gn.orderedModifiers.forEach(function(go){return Gn.modifiersData[go.name]=Object.assign({},go.data)});for(var mr=0;mr<Gn.orderedModifiers.length;mr++)if(Gn.reset!==!0){var Nr=Gn.orderedModifiers[mr],Qi=Nr.fn,Dr=Nr.options,Ar=Dr===void 0?{}:Dr,mo=Nr.name;typeof Qi=="function"&&(Gn=Qi({state:Gn,options:Ar,name:mo,instance:Wi})||Gn)}else Gn.reset=!1,mr=-1}}},update:(ni=function(){return new Promise(function(Yi){Wi.forceUpdate(),Yi(Gn)})},function(){return Jn||(Jn=new Promise(function(Yi){Promise.resolve().then(function(){Jn=void 0,Yi(ni())})})),Jn}),destroy:function(){$i(),Li=!0}};if(!ma(Yt,_n))return Wi;function $i(){Vi.forEach(function(Yi){return Yi()}),Vi=[]}return Wi.setOptions(Bn).then(function(Yi){!Li&&Bn.onFirstUpdate&&Bn.onFirstUpdate(Yi)}),Wi}}var ja=Ql(),bn=Ql({defaultModifiers:[Il,Mu,Uc,jc]}),wi=Ql({defaultModifiers:[Il,Mu,Uc,jc,Zc,Yl,Jl,Ci,Bi]});const Ni=Object.freeze(Object.defineProperty({__proto__:null,afterMain:pc,afterRead:Ya,afterWrite:Xr,applyStyles:jc,arrow:Ci,auto:li,basePlacements:cr,beforeMain:ko,beforeRead:Ts,beforeWrite:fa,bottom:Un,clippingParents:ir,computeStyles:Uc,createPopper:wi,createPopperBase:ja,createPopperLite:bn,detectOverflow:Ta,end:no,eventListeners:Il,flip:Yl,hide:Bi,left:Ei,main:Zs,modifierPhases:wl,offset:Zc,placements:Zo,popper:Cr,popperGenerator:Ql,popperOffsets:Mu,preventOverflow:Jl,read:ta,reference:Pr,right:ei,start:Fr,top:Kn,variationPlacements:ur,viewport:Oi,write:xl},Symbol.toStringTag,{value:"Module"})),Ys="dropdown",Is=".bs.dropdown",M=".data-api",J="ArrowUp",le="ArrowDown",Ne=`hide${Is}`,Ct=`hidden${Is}`,kt=`show${Is}`,Nn=`shown${Is}`,Gi=`click${Is}${M}`,Jo=`keydown${Is}${M}`,Hr=`keyup${Is}${M}`,fo="show",jo='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',tl=`${jo}.${fo}`,Co=".dropdown-menu",As=ce()?"top-end":"top-start",ks=ce()?"top-start":"top-end",_d=ce()?"bottom-end":"bottom-start",yd=ce()?"bottom-start":"bottom-end",ds=ce()?"left-start":"right-start",ga=ce()?"right-start":"left-start",ti={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},sn={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class _a extends Ft{constructor(V,te){super(V,te),this._popper=null,this._parent=this._element.parentNode,this._menu=Wt.next(this._element,Co)[0]||Wt.prev(this._element,Co)[0]||Wt.findOne(Co,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return ti}static get DefaultType(){return sn}static get NAME(){return Ys}toggle(){return this._isShown()?this.hide():this.show()}show(){if(D(this._element)||this._isShown())return;const V={relatedTarget:this._element};if(!Pt.trigger(this._element,kt,V).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const te of[].concat(...document.body.children))Pt.on(te,"mouseover",N);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(fo),this._element.classList.add(fo),Pt.trigger(this._element,Nn,V)}}hide(){if(D(this._element)||!this._isShown())return;const V={relatedTarget:this._element};this._completeHide(V)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(V){if(!Pt.trigger(this._element,Ne,V).defaultPrevented){if("ontouchstart"in document.documentElement)for(const te of[].concat(...document.body.children))Pt.off(te,"mouseover",N);this._popper&&this._popper.destroy(),this._menu.classList.remove(fo),this._element.classList.remove(fo),this._element.setAttribute("aria-expanded","false"),Br.removeDataAttribute(this._menu,"popper"),Pt.trigger(this._element,Ct,V)}}_getConfig(V){if(typeof(V=super._getConfig(V)).reference=="object"&&!w(V.reference)&&typeof V.reference.getBoundingClientRect!="function")throw new TypeError(`${Ys.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return V}_createPopper(){if(Ni===void 0)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let V=this._element;this._config.reference==="parent"?V=this._parent:w(this._config.reference)?V=T(this._config.reference):typeof this._config.reference=="object"&&(V=this._config.reference);const te=this._getPopperConfig();this._popper=wi(V,this._menu,te)}_isShown(){return this._menu.classList.contains(fo)}_getPlacement(){const V=this._parent;if(V.classList.contains("dropend"))return ds;if(V.classList.contains("dropstart"))return ga;if(V.classList.contains("dropup-center"))return"top";if(V.classList.contains("dropdown-center"))return"bottom";const te=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return V.classList.contains("dropup")?te?ks:As:te?yd:_d}_detectNavbar(){return this._element.closest(".navbar")!==null}_getOffset(){const{offset:V}=this._config;return typeof V=="string"?V.split(",").map(te=>Number.parseInt(te,10)):typeof V=="function"?te=>V(te,this._element):V}_getPopperConfig(){const V={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Br.setDataAttribute(this._menu,"popper","static"),V.modifiers=[{name:"applyStyles",enabled:!1}]),{...V,...ze(this._config.popperConfig,[void 0,V])}}_selectMenuItem({key:V,target:te}){const Be=Wt.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(yt=>A(yt));Be.length&&je(Be,te,V===le,!Be.includes(te)).focus()}static jQueryInterface(V){return this.each(function(){const te=_a.getOrCreateInstance(this,V);if(typeof V=="string"){if(te[V]===void 0)throw new TypeError(`No method named "${V}"`);te[V]()}})}static clearMenus(V){if(V.button===2||V.type==="keyup"&&V.key!=="Tab")return;const te=Wt.find(tl);for(const Be of te){const yt=_a.getInstance(Be);if(!yt||yt._config.autoClose===!1)continue;const xt=V.composedPath(),Yt=xt.includes(yt._menu);if(xt.includes(yt._element)||yt._config.autoClose==="inside"&&!Yt||yt._config.autoClose==="outside"&&Yt||yt._menu.contains(V.target)&&(V.type==="keyup"&&V.key==="Tab"||/input|select|option|textarea|form/i.test(V.target.tagName)))continue;const _n={relatedTarget:yt._element};V.type==="click"&&(_n.clickEvent=V),yt._completeHide(_n)}}static dataApiKeydownHandler(V){const te=/input|textarea/i.test(V.target.tagName),Be=V.key==="Escape",yt=[J,le].includes(V.key);if(!yt&&!Be||te&&!Be)return;V.preventDefault();const xt=this.matches(jo)?this:Wt.prev(this,jo)[0]||Wt.next(this,jo)[0]||Wt.findOne(jo,V.delegateTarget.parentNode),Yt=_a.getOrCreateInstance(xt);if(yt)return V.stopPropagation(),Yt.show(),void Yt._selectMenuItem(V);Yt._isShown()&&(V.stopPropagation(),Yt.hide(),xt.focus())}}Pt.on(document,Jo,jo,_a.dataApiKeydownHandler),Pt.on(document,Jo,Co,_a.dataApiKeydownHandler),Pt.on(document,Gi,_a.clearMenus),Pt.on(document,Hr,_a.clearMenus),Pt.on(document,Gi,jo,function(_e){_e.preventDefault(),_a.getOrCreateInstance(this).toggle()}),be(_a);const Dn="backdrop",Kc="show",Du=`mousedown.bs.${Dn}`,jn={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Kp={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class vd extends ai{constructor(V){super(),this._config=this._getConfig(V),this._isAppended=!1,this._element=null}static get Default(){return jn}static get DefaultType(){return Kp}static get NAME(){return Dn}show(V){if(!this._config.isVisible)return void ze(V);this._append();const te=this._getElement();this._config.isAnimated&&ee(te),te.classList.add(Kc),this._emulateAnimation(()=>{ze(V)})}hide(V){this._config.isVisible?(this._getElement().classList.remove(Kc),this._emulateAnimation(()=>{this.dispose(),ze(V)})):ze(V)}dispose(){this._isAppended&&(Pt.off(this._element,Du),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const V=document.createElement("div");V.className=this._config.className,this._config.isAnimated&&V.classList.add("fade"),this._element=V}return this._element}_configAfterMerge(V){return V.rootElement=T(V.rootElement),V}_append(){if(this._isAppended)return;const V=this._getElement();this._config.rootElement.append(V),Pt.on(V,Du,()=>{ze(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(V){xe(V,this._getElement(),this._config.isAnimated)}}const Xc=".bs.focustrap",Xp=`focusin${Xc}`,mf=`keydown.tab${Xc}`,Ro="backward",Yp={autofocus:!0,trapElement:null},mc={autofocus:"boolean",trapElement:"element"};class ia extends ai{constructor(V){super(),this._config=this._getConfig(V),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Yp}static get DefaultType(){return mc}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),Pt.off(document,Xc),Pt.on(document,Xp,V=>this._handleFocusin(V)),Pt.on(document,mf,V=>this._handleKeydown(V)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,Pt.off(document,Xc))}_handleFocusin(V){const{trapElement:te}=this._config;if(V.target===document||V.target===te||te.contains(V.target))return;const Be=Wt.focusableChildren(te);Be.length===0?te.focus():this._lastTabNavDirection===Ro?Be[Be.length-1].focus():Be[0].focus()}_handleKeydown(V){V.key==="Tab"&&(this._lastTabNavDirection=V.shiftKey?Ro:"forward")}}const gc=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Rs=".sticky-top",uh="padding-right",bd="margin-right";class Jp{constructor(){this._element=document.body}getWidth(){const V=document.documentElement.clientWidth;return Math.abs(window.innerWidth-V)}hide(){const V=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,uh,te=>te+V),this._setElementAttributes(gc,uh,te=>te+V),this._setElementAttributes(Rs,bd,te=>te-V)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,uh),this._resetElementAttributes(gc,uh),this._resetElementAttributes(Rs,bd)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(V,te,Be){const yt=this.getWidth();this._applyManipulationCallback(V,xt=>{if(xt!==this._element&&window.innerWidth>xt.clientWidth+yt)return;this._saveInitialAttribute(xt,te);const Yt=window.getComputedStyle(xt).getPropertyValue(te);xt.style.setProperty(te,`${Be(Number.parseFloat(Yt))}px`)})}_saveInitialAttribute(V,te){const Be=V.style.getPropertyValue(te);Be&&Br.setDataAttribute(V,te,Be)}_resetElementAttributes(V,te){this._applyManipulationCallback(V,Be=>{const yt=Br.getDataAttribute(Be,te);yt!==null?(Br.removeDataAttribute(Be,te),Be.style.setProperty(te,yt)):Be.style.removeProperty(te)})}_applyManipulationCallback(V,te){if(w(V))te(V);else for(const Be of Wt.find(V,this._element))te(Be)}}const ya=".bs.modal",xd=`hide${ya}`,Al=`hidePrevented${ya}`,kg=`hidden${ya}`,Ou=`show${ya}`,Rg=`shown${ya}`,gf=`resize${ya}`,_f=`click.dismiss${ya}`,Yc=`mousedown.dismiss${ya}`,Lu=`keydown.dismiss${ya}`,xy=`click${ya}.data-api`,Pg="modal-open",dh="show",yf="modal-static",vf={backdrop:!0,focus:!0,keyboard:!0},nl={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Jc extends Ft{constructor(V,te){super(V,te),this._dialog=Wt.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Jp,this._addEventListeners()}static get Default(){return vf}static get DefaultType(){return nl}static get NAME(){return"modal"}toggle(V){return this._isShown?this.hide():this.show(V)}show(V){this._isShown||this._isTransitioning||Pt.trigger(this._element,Ou,{relatedTarget:V}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Pg),this._adjustDialog(),this._backdrop.show(()=>this._showElement(V)))}hide(){this._isShown&&!this._isTransitioning&&(Pt.trigger(this._element,xd).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(dh),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated())))}dispose(){Pt.off(window,ya),Pt.off(this._dialog,ya),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new vd({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new ia({trapElement:this._element})}_showElement(V){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const te=Wt.findOne(".modal-body",this._dialog);te&&(te.scrollTop=0),ee(this._element),this._element.classList.add(dh),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,Pt.trigger(this._element,Rg,{relatedTarget:V})},this._dialog,this._isAnimated())}_addEventListeners(){Pt.on(this._element,Lu,V=>{V.key==="Escape"&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())}),Pt.on(window,gf,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),Pt.on(this._element,Yc,V=>{Pt.one(this._element,_f,te=>{this._element===V.target&&this._element===te.target&&(this._config.backdrop!=="static"?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Pg),this._resetAdjustments(),this._scrollBar.reset(),Pt.trigger(this._element,kg)})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(Pt.trigger(this._element,Al).defaultPrevented)return;const V=this._element.scrollHeight>document.documentElement.clientHeight,te=this._element.style.overflowY;te==="hidden"||this._element.classList.contains(yf)||(V||(this._element.style.overflowY="hidden"),this._element.classList.add(yf),this._queueCallback(()=>{this._element.classList.remove(yf),this._queueCallback(()=>{this._element.style.overflowY=te},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const V=this._element.scrollHeight>document.documentElement.clientHeight,te=this._scrollBar.getWidth(),Be=te>0;if(Be&&!V){const yt=ce()?"paddingLeft":"paddingRight";this._element.style[yt]=`${te}px`}if(!Be&&V){const yt=ce()?"paddingRight":"paddingLeft";this._element.style[yt]=`${te}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(V,te){return this.each(function(){const Be=Jc.getOrCreateInstance(this,V);if(typeof V=="string"){if(Be[V]===void 0)throw new TypeError(`No method named "${V}"`);Be[V](te)}})}}Pt.on(document,xy,'[data-bs-toggle="modal"]',function(_e){const V=Wt.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&_e.preventDefault(),Pt.one(V,Ou,Be=>{Be.defaultPrevented||Pt.one(V,kg,()=>{A(this)&&this.focus()})});const te=Wt.findOne(".modal.show");te&&Jc.getInstance(te).hide(),Jc.getOrCreateInstance(V).toggle(this)}),kn(Jc),be(Jc);const ec=".bs.offcanvas",Qp=".data-api",zu=`load${ec}${Qp}`,wd="show",bf="showing",xf="hiding",Bu=".offcanvas.show",Sd=`show${ec}`,em=`shown${ec}`,wf=`hide${ec}`,Ea=`hidePrevented${ec}`,hh=`hidden${ec}`,Ut=`resize${ec}`,tm=`click${ec}${Qp}`,Cd=`keydown.dismiss${ec}`,Td={backdrop:!0,keyboard:!0,scroll:!1},fh={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Ua extends Ft{constructor(V,te){super(V,te),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Td}static get DefaultType(){return fh}static get NAME(){return"offcanvas"}toggle(V){return this._isShown?this.hide():this.show(V)}show(V){this._isShown||Pt.trigger(this._element,Sd,{relatedTarget:V}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||new Jp().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(bf),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(wd),this._element.classList.remove(bf),Pt.trigger(this._element,em,{relatedTarget:V})},this._element,!0))}hide(){this._isShown&&(Pt.trigger(this._element,wf).defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(xf),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove(wd,xf),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Jp().reset(),Pt.trigger(this._element,hh)},this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const V=!!this._config.backdrop;return new vd({className:"offcanvas-backdrop",isVisible:V,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:V?()=>{this._config.backdrop!=="static"?this.hide():Pt.trigger(this._element,Ea)}:null})}_initializeFocusTrap(){return new ia({trapElement:this._element})}_addEventListeners(){Pt.on(this._element,Cd,V=>{V.key==="Escape"&&(this._config.keyboard?this.hide():Pt.trigger(this._element,Ea))})}static jQueryInterface(V){return this.each(function(){const te=Ua.getOrCreateInstance(this,V);if(typeof V=="string"){if(te[V]===void 0||V.startsWith("_")||V==="constructor")throw new TypeError(`No method named "${V}"`);te[V](this)}})}}Pt.on(document,tm,'[data-bs-toggle="offcanvas"]',function(_e){const V=Wt.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&_e.preventDefault(),D(this))return;Pt.one(V,hh,()=>{A(this)&&this.focus()});const te=Wt.findOne(Bu);te&&te!==V&&Ua.getInstance(te).hide(),Ua.getOrCreateInstance(V).toggle(this)}),Pt.on(window,zu,()=>{for(const _e of Wt.find(Bu))Ua.getOrCreateInstance(_e).show()}),Pt.on(window,Ut,()=>{for(const _e of Wt.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(_e).position!=="fixed"&&Ua.getOrCreateInstance(_e).hide()}),kn(Ua),be(Ua);const kl={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Sf=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),il=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,Ii=(_e,V)=>{const te=_e.nodeName.toLowerCase();return V.includes(te)?!Sf.has(te)||!!il.test(_e.nodeValue):V.filter(Be=>Be instanceof RegExp).some(Be=>Be.test(te))},Ed={allowList:kl,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},wy={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},Sy={entry:"(string|element|function|null)",selector:"(string|element)"};class Cf extends ai{constructor(V){super(),this._config=this._getConfig(V)}static get Default(){return Ed}static get DefaultType(){return wy}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(V=>this._resolvePossibleFunction(V)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(V){return this._checkContent(V),this._config.content={...this._config.content,...V},this}toHtml(){const V=document.createElement("div");V.innerHTML=this._maybeSanitize(this._config.template);for(const[yt,xt]of Object.entries(this._config.content))this._setContent(V,xt,yt);const te=V.children[0],Be=this._resolvePossibleFunction(this._config.extraClass);return Be&&te.classList.add(...Be.split(" ")),te}_typeCheckConfig(V){super._typeCheckConfig(V),this._checkContent(V.content)}_checkContent(V){for(const[te,Be]of Object.entries(V))super._typeCheckConfig({selector:te,entry:Be},Sy)}_setContent(V,te,Be){const yt=Wt.findOne(Be,V);yt&&((te=this._resolvePossibleFunction(te))?w(te)?this._putElementInTemplate(T(te),yt):this._config.html?yt.innerHTML=this._maybeSanitize(te):yt.textContent=te:yt.remove())}_maybeSanitize(V){return this._config.sanitize?function(te,Be,yt){if(!te.length)return te;if(yt&&typeof yt=="function")return yt(te);const xt=new window.DOMParser().parseFromString(te,"text/html"),Yt=[].concat(...xt.body.querySelectorAll("*"));for(const _n of Yt){const Bn=_n.nodeName.toLowerCase();if(!Object.keys(Be).includes(Bn)){_n.remove();continue}const ni=[].concat(..._n.attributes),Jn=[].concat(Be["*"]||[],Be[Bn]||[]);for(const Gn of ni)Ii(Gn,Jn)||_n.removeAttribute(Gn.nodeName)}return xt.body.innerHTML}(V,this._config.allowList,this._config.sanitizeFn):V}_resolvePossibleFunction(V){return ze(V,[void 0,this])}_putElementInTemplate(V,te){if(this._config.html)return te.innerHTML="",void te.append(V);te.textContent=V.textContent}}const Cy=new Set(["sanitize","allowList","sanitizeFn"]),Mr="fade",ph="show",nm=".tooltip-inner",Mg=".modal",Dg="hide.bs.modal",mh="hover",im="focus",Tf="click",Ty={AUTO:"auto",TOP:"top",RIGHT:ce()?"left":"right",BOTTOM:"bottom",LEFT:ce()?"right":"left"},Ef={allowList:kl,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Ey={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Qc extends Ft{constructor(V,te){if(Ni===void 0)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(V,te),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Ef}static get DefaultType(){return Ey}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),Pt.off(this._element.closest(Mg),Dg,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const V=Pt.trigger(this._element,this.constructor.eventName("show")),te=(B(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(V.defaultPrevented||!te)return;this._disposePopper();const Be=this._getTipElement();this._element.setAttribute("aria-describedby",Be.getAttribute("id"));const{container:yt}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(yt.append(Be),Pt.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(Be),Be.classList.add(ph),"ontouchstart"in document.documentElement)for(const xt of[].concat(...document.body.children))Pt.on(xt,"mouseover",N);this._queueCallback(()=>{Pt.trigger(this._element,this.constructor.eventName("shown")),this._isHovered===!1&&this._leave(),this._isHovered=!1},this.tip,this._isAnimated())}hide(){if(this._isShown()&&!Pt.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(ph),"ontouchstart"in document.documentElement)for(const V of[].concat(...document.body.children))Pt.off(V,"mouseover",N);this._activeTrigger[Tf]=!1,this._activeTrigger[im]=!1,this._activeTrigger[mh]=!1,this._isHovered=null,this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),Pt.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(V){const te=this._getTemplateFactory(V).toHtml();if(!te)return null;te.classList.remove(Mr,ph),te.classList.add(`bs-${this.constructor.NAME}-auto`);const Be=(yt=>{do yt+=Math.floor(1e6*Math.random());while(document.getElementById(yt));return yt})(this.constructor.NAME).toString();return te.setAttribute("id",Be),this._isAnimated()&&te.classList.add(Mr),te}setContent(V){this._newContent=V,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(V){return this._templateFactory?this._templateFactory.changeContent(V):this._templateFactory=new Cf({...this._config,content:V,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[nm]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(V){return this.constructor.getOrCreateInstance(V.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Mr)}_isShown(){return this.tip&&this.tip.classList.contains(ph)}_createPopper(V){const te=ze(this._config.placement,[this,V,this._element]),Be=Ty[te.toUpperCase()];return wi(this._element,V,this._getPopperConfig(Be))}_getOffset(){const{offset:V}=this._config;return typeof V=="string"?V.split(",").map(te=>Number.parseInt(te,10)):typeof V=="function"?te=>V(te,this._element):V}_resolvePossibleFunction(V){return ze(V,[this._element,this._element])}_getPopperConfig(V){const te={placement:V,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:Be=>{this._getTipElement().setAttribute("data-popper-placement",Be.state.placement)}}]};return{...te,...ze(this._config.popperConfig,[void 0,te])}}_setListeners(){const V=this._config.trigger.split(" ");for(const te of V)if(te==="click")Pt.on(this._element,this.constructor.eventName("click"),this._config.selector,Be=>{const yt=this._initializeOnDelegatedTarget(Be);yt._activeTrigger[Tf]=!(yt._isShown()&&yt._activeTrigger[Tf]),yt.toggle()});else if(te!=="manual"){const Be=te===mh?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),yt=te===mh?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");Pt.on(this._element,Be,this._config.selector,xt=>{const Yt=this._initializeOnDelegatedTarget(xt);Yt._activeTrigger[xt.type==="focusin"?im:mh]=!0,Yt._enter()}),Pt.on(this._element,yt,this._config.selector,xt=>{const Yt=this._initializeOnDelegatedTarget(xt);Yt._activeTrigger[xt.type==="focusout"?im:mh]=Yt._element.contains(xt.relatedTarget),Yt._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},Pt.on(this._element.closest(Mg),Dg,this._hideModalHandler)}_fixTitle(){const V=this._element.getAttribute("title");V&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",V),this._element.setAttribute("data-bs-original-title",V),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(V,te){clearTimeout(this._timeout),this._timeout=setTimeout(V,te)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(V){const te=Br.getDataAttributes(this._element);for(const Be of Object.keys(te))Cy.has(Be)&&delete te[Be];return V={...te,...typeof V=="object"&&V?V:{}},V=this._mergeConfigObj(V),V=this._configAfterMerge(V),this._typeCheckConfig(V),V}_configAfterMerge(V){return V.container=V.container===!1?document.body:T(V.container),typeof V.delay=="number"&&(V.delay={show:V.delay,hide:V.delay}),typeof V.title=="number"&&(V.title=V.title.toString()),typeof V.content=="number"&&(V.content=V.content.toString()),V}_getDelegateConfig(){const V={};for(const[te,Be]of Object.entries(this._config))this.constructor.Default[te]!==Be&&(V[te]=Be);return V.selector=!1,V.trigger="manual",V}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(V){return this.each(function(){const te=Qc.getOrCreateInstance(this,V);if(typeof V=="string"){if(te[V]===void 0)throw new TypeError(`No method named "${V}"`);te[V]()}})}}be(Qc);const rm=".popover-header",If=".popover-body",om={...Qc.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},Fu={...Qc.DefaultType,content:"(null|string|element|function)"};class _c extends Qc{static get Default(){return om}static get DefaultType(){return Fu}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[rm]:this._getTitle(),[If]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(V){return this.each(function(){const te=_c.getOrCreateInstance(this,V);if(typeof V=="string"){if(te[V]===void 0)throw new TypeError(`No method named "${V}"`);te[V]()}})}}be(_c);const Id=".bs.scrollspy",Af=`activate${Id}`,Nu=`click${Id}`,Og=`load${Id}.data-api`,eu="active",kf="[href]",Vu=".nav-link",Rf=`${Vu}, .nav-item > ${Vu}, .list-group-item`,Pf={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},sm={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class tu extends Ft{constructor(V,te){super(V,te),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Pf}static get DefaultType(){return sm}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const V of this._observableSections.values())this._observer.observe(V)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(V){return V.target=T(V.target)||document.body,V.rootMargin=V.offset?`${V.offset}px 0px -30%`:V.rootMargin,typeof V.threshold=="string"&&(V.threshold=V.threshold.split(",").map(te=>Number.parseFloat(te))),V}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(Pt.off(this._config.target,Nu),Pt.on(this._config.target,Nu,kf,V=>{const te=this._observableSections.get(V.target.hash);if(te){V.preventDefault();const Be=this._rootElement||window,yt=te.offsetTop-this._element.offsetTop;if(Be.scrollTo)return void Be.scrollTo({top:yt,behavior:"smooth"});Be.scrollTop=yt}}))}_getNewObserver(){const V={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(te=>this._observerCallback(te),V)}_observerCallback(V){const te=Yt=>this._targetLinks.get(`#${Yt.target.id}`),Be=Yt=>{this._previousScrollData.visibleEntryTop=Yt.target.offsetTop,this._process(te(Yt))},yt=(this._rootElement||document.documentElement).scrollTop,xt=yt>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=yt;for(const Yt of V){if(!Yt.isIntersecting){this._activeTarget=null,this._clearActiveClass(te(Yt));continue}const _n=Yt.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(xt&&_n){if(Be(Yt),!yt)return}else xt||_n||Be(Yt)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const V=Wt.find(kf,this._config.target);for(const te of V){if(!te.hash||D(te))continue;const Be=Wt.findOne(decodeURI(te.hash),this._element);A(Be)&&(this._targetLinks.set(decodeURI(te.hash),te),this._observableSections.set(te.hash,Be))}}_process(V){this._activeTarget!==V&&(this._clearActiveClass(this._config.target),this._activeTarget=V,V.classList.add(eu),this._activateParents(V),Pt.trigger(this._element,Af,{relatedTarget:V}))}_activateParents(V){if(V.classList.contains("dropdown-item"))Wt.findOne(".dropdown-toggle",V.closest(".dropdown")).classList.add(eu);else for(const te of Wt.parents(V,".nav, .list-group"))for(const Be of Wt.prev(te,Rf))Be.classList.add(eu)}_clearActiveClass(V){V.classList.remove(eu);const te=Wt.find(`${kf}.${eu}`,V);for(const Be of te)Be.classList.remove(eu)}static jQueryInterface(V){return this.each(function(){const te=tu.getOrCreateInstance(this,V);if(typeof V=="string"){if(te[V]===void 0||V.startsWith("_")||V==="constructor")throw new TypeError(`No method named "${V}"`);te[V]()}})}}Pt.on(window,Og,()=>{for(const _e of Wt.find('[data-bs-spy="scroll"]'))tu.getOrCreateInstance(_e)}),be(tu);const Rl=".bs.tab",Lg=`hide${Rl}`,zg=`hidden${Rl}`,Bg=`show${Rl}`,nu=`shown${Rl}`,Fg=`click${Rl}`,Ng=`keydown${Rl}`,Iy=`load${Rl}`,Ay="ArrowLeft",Mf="ArrowRight",Df="ArrowUp",gh="ArrowDown",tc="Home",Of="End",yc="active",Vg="fade",vc="show",iu=".dropdown-toggle",Lf=`:not(${iu})`,Ia='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Ad=`.nav-link${Lf}, .list-group-item${Lf}, [role="tab"]${Lf}, ${Ia}`,_h=`.${yc}[data-bs-toggle="tab"], .${yc}[data-bs-toggle="pill"], .${yc}[data-bs-toggle="list"]`;class nc extends Ft{constructor(V){super(V),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),Pt.on(this._element,Ng,te=>this._keydown(te)))}static get NAME(){return"tab"}show(){const V=this._element;if(this._elemIsActive(V))return;const te=this._getActiveElem(),Be=te?Pt.trigger(te,Lg,{relatedTarget:V}):null;Pt.trigger(V,Bg,{relatedTarget:te}).defaultPrevented||Be&&Be.defaultPrevented||(this._deactivate(te,V),this._activate(V,te))}_activate(V,te){V&&(V.classList.add(yc),this._activate(Wt.getElementFromSelector(V)),this._queueCallback(()=>{V.getAttribute("role")==="tab"?(V.removeAttribute("tabindex"),V.setAttribute("aria-selected",!0),this._toggleDropDown(V,!0),Pt.trigger(V,nu,{relatedTarget:te})):V.classList.add(vc)},V,V.classList.contains(Vg)))}_deactivate(V,te){V&&(V.classList.remove(yc),V.blur(),this._deactivate(Wt.getElementFromSelector(V)),this._queueCallback(()=>{V.getAttribute("role")==="tab"?(V.setAttribute("aria-selected",!1),V.setAttribute("tabindex","-1"),this._toggleDropDown(V,!1),Pt.trigger(V,zg,{relatedTarget:te})):V.classList.remove(vc)},V,V.classList.contains(Vg)))}_keydown(V){if(![Ay,Mf,Df,gh,tc,Of].includes(V.key))return;V.stopPropagation(),V.preventDefault();const te=this._getChildren().filter(yt=>!D(yt));let Be;if([tc,Of].includes(V.key))Be=te[V.key===tc?0:te.length-1];else{const yt=[Mf,gh].includes(V.key);Be=je(te,V.target,yt,!0)}Be&&(Be.focus({preventScroll:!0}),nc.getOrCreateInstance(Be).show())}_getChildren(){return Wt.find(Ad,this._parent)}_getActiveElem(){return this._getChildren().find(V=>this._elemIsActive(V))||null}_setInitialAttributes(V,te){this._setAttributeIfNotExists(V,"role","tablist");for(const Be of te)this._setInitialAttributesOnChild(Be)}_setInitialAttributesOnChild(V){V=this._getInnerElement(V);const te=this._elemIsActive(V),Be=this._getOuterElement(V);V.setAttribute("aria-selected",te),Be!==V&&this._setAttributeIfNotExists(Be,"role","presentation"),te||V.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(V,"role","tab"),this._setInitialAttributesOnTargetPanel(V)}_setInitialAttributesOnTargetPanel(V){const te=Wt.getElementFromSelector(V);te&&(this._setAttributeIfNotExists(te,"role","tabpanel"),V.id&&this._setAttributeIfNotExists(te,"aria-labelledby",`${V.id}`))}_toggleDropDown(V,te){const Be=this._getOuterElement(V);if(!Be.classList.contains("dropdown"))return;const yt=(xt,Yt)=>{const _n=Wt.findOne(xt,Be);_n&&_n.classList.toggle(Yt,te)};yt(iu,yc),yt(".dropdown-menu",vc),Be.setAttribute("aria-expanded",te)}_setAttributeIfNotExists(V,te,Be){V.hasAttribute(te)||V.setAttribute(te,Be)}_elemIsActive(V){return V.classList.contains(yc)}_getInnerElement(V){return V.matches(Ad)?V:Wt.findOne(Ad,V)}_getOuterElement(V){return V.closest(".nav-item, .list-group-item")||V}static jQueryInterface(V){return this.each(function(){const te=nc.getOrCreateInstance(this);if(typeof V=="string"){if(te[V]===void 0||V.startsWith("_")||V==="constructor")throw new TypeError(`No method named "${V}"`);te[V]()}})}}Pt.on(document,Fg,Ia,function(_e){["A","AREA"].includes(this.tagName)&&_e.preventDefault(),D(this)||nc.getOrCreateInstance(this).show()}),Pt.on(window,Iy,()=>{for(const _e of Wt.find(_h))nc.getOrCreateInstance(_e)}),be(nc);const ic=".bs.toast",am=`mouseover${ic}`,zf=`mouseout${ic}`,yh=`focusin${ic}`,kd=`focusout${ic}`,lm=`hide${ic}`,vh=`hidden${ic}`,cm=`show${ic}`,$g=`shown${ic}`,Bf="hide",rc="show",Ff="showing",ky={animation:"boolean",autohide:"boolean",delay:"number"},Ry={animation:!0,autohide:!0,delay:5e3};class ru extends Ft{constructor(V,te){super(V,te),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Ry}static get DefaultType(){return ky}static get NAME(){return"toast"}show(){Pt.trigger(this._element,cm).defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(Bf),ee(this._element),this._element.classList.add(rc,Ff),this._queueCallback(()=>{this._element.classList.remove(Ff),Pt.trigger(this._element,$g),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this.isShown()&&(Pt.trigger(this._element,lm).defaultPrevented||(this._element.classList.add(Ff),this._queueCallback(()=>{this._element.classList.add(Bf),this._element.classList.remove(Ff,rc),Pt.trigger(this._element,vh)},this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(rc),super.dispose()}isShown(){return this._element.classList.contains(rc)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(V,te){switch(V.type){case"mouseover":case"mouseout":this._hasMouseInteraction=te;break;case"focusin":case"focusout":this._hasKeyboardInteraction=te}if(te)return void this._clearTimeout();const Be=V.relatedTarget;this._element===Be||this._element.contains(Be)||this._maybeScheduleHide()}_setListeners(){Pt.on(this._element,am,V=>this._onInteraction(V,!0)),Pt.on(this._element,zf,V=>this._onInteraction(V,!1)),Pt.on(this._element,yh,V=>this._onInteraction(V,!0)),Pt.on(this._element,kd,V=>this._onInteraction(V,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(V){return this.each(function(){const te=ru.getOrCreateInstance(this,V);if(typeof V=="string"){if(te[V]===void 0)throw new TypeError(`No method named "${V}"`);te[V](this)}})}}return kn(ru),be(ru),{Alert:vt,Button:an,Carousel:Xe,Collapse:zn,Dropdown:_a,Modal:Jc,Offcanvas:Ua,Popover:_c,ScrollSpy:tu,Tab:nc,Toast:ru,Tooltip:Qc}})})(KH);var XH=Object.defineProperty,SD=Object.getOwnPropertySymbols,YH=Object.prototype.hasOwnProperty,JH=Object.prototype.propertyIsEnumerable,CD=(t,e,n)=>e in t?XH(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,QH=(t,e)=>{for(var n in e||(e={}))YH.call(e,n)&&CD(t,n,e[n]);if(SD)for(var n of SD(e))JH.call(e,n)&&CD(t,n,e[n]);return t};function xu(t){return t==null||t===""||Array.isArray(t)&&t.length===0||!(t instanceof Date)&&typeof t=="object"&&Object.keys(t).length===0}function eG(t,e,n,r=1){let c=-1,u=xu(t),p=xu(e);return u&&p?c=0:u?c=r:p?c=-r:typeof t=="string"&&typeof e=="string"?c=n(t,e):c=t<e?-1:t>e?1:0,c}function $T(t,e,n=new WeakSet){if(t===e)return!0;if(!t||!e||typeof t!="object"||typeof e!="object"||n.has(t)||n.has(e))return!1;n.add(t).add(e);let r=Array.isArray(t),c=Array.isArray(e),u,p,o;if(r&&c){if(p=t.length,p!=e.length)return!1;for(u=p;u--!==0;)if(!$T(t[u],e[u],n))return!1;return!0}if(r!=c)return!1;let w=t instanceof Date,T=e instanceof Date;if(w!=T)return!1;if(w&&T)return t.getTime()==e.getTime();let A=t instanceof RegExp,D=e instanceof RegExp;if(A!=D)return!1;if(A&&D)return t.toString()==e.toString();let B=Object.keys(t);if(p=B.length,p!==Object.keys(e).length)return!1;for(u=p;u--!==0;)if(!Object.prototype.hasOwnProperty.call(e,B[u]))return!1;for(u=p;u--!==0;)if(o=B[u],!$T(t[o],e[o],n))return!1;return!0}function tG(t,e){return $T(t,e)}function SS(t){return typeof t=="function"&&"call"in t&&"apply"in t}function xr(t){return!xu(t)}function eo(t,e){if(!t||!e)return null;try{let n=t[e];if(xr(n))return n}catch{}if(Object.keys(t).length){if(SS(e))return e(t);if(e.indexOf(".")===-1)return t[e];{let n=e.split("."),r=t;for(let c=0,u=n.length;c<u;++c){if(r==null)return null;r=r[n[c]]}return r}}return null}function xg(t,e,n){return n?eo(t,n)===eo(e,n):tG(t,e)}function nG(t,e){if(t!=null&&e&&e.length){for(let n of e)if(xg(t,n))return!0}return!1}function ih(t,e=!0){return t instanceof Object&&t.constructor===Object&&(e||Object.keys(t).length!==0)}function kz(t={},e={}){let n=QH({},t);return Object.keys(e).forEach(r=>{let c=r;ih(e[c])&&c in t&&ih(t[c])?n[c]=kz(t[c],e[c]):n[c]=e[c]}),n}function iG(...t){return t.reduce((e,n,r)=>r===0?n:kz(e,n),{})}function L2(t,e){let n=-1;if(e){for(let r=0;r<e.length;r++)if(e[r]===t){n=r;break}}return n}function TD(t,e){let n=-1;if(xr(t))try{n=t.findLastIndex(e)}catch{n=t.lastIndexOf([...t].reverse().find(e))}return n}function Lc(t,...e){return SS(t)?t(...e):t}function fc(t,e=!0){return typeof t=="string"&&(e||t!=="")}function Qd(t){return fc(t)?t.replace(/(-|_)/g,"").toLowerCase():t}function lI(t,e="",n={}){let r=Qd(e).split("."),c=r.shift();if(c){if(ih(t)){let u=Object.keys(t).find(p=>Qd(p)===c)||"";return lI(Lc(t[u],n),r.join("."),n)}return}return Lc(t,n)}function Rz(t,e=!0){return Array.isArray(t)&&(e||t.length!==0)}function rG(t){return xr(t)&&!isNaN(t)}function oG(t=""){return xr(t)&&t.length===1&&!!t.match(/\S| /)}function ED(){return new Intl.Collator(void 0,{numeric:!0}).compare}function og(t,e){if(e){let n=e.test(t);return e.lastIndex=0,n}return!1}function sG(...t){return iG(...t)}function ab(t){return t&&t.replace(/\/\*(?:(?!\*\/)[\s\S])*\*\/|[\r\n\t]+/g,"").replace(/ {2,}/g," ").replace(/ ([{:}]) /g,"$1").replace(/([;,]) /g,"$1").replace(/ !/g,"!").replace(/: /g,":").trim()}function fu(t){if(t&&/[\xC0-\xFF\u0100-\u017E]/.test(t)){let e={A:/[\xC0-\xC5\u0100\u0102\u0104]/g,AE:/[\xC6]/g,C:/[\xC7\u0106\u0108\u010A\u010C]/g,D:/[\xD0\u010E\u0110]/g,E:/[\xC8-\xCB\u0112\u0114\u0116\u0118\u011A]/g,G:/[\u011C\u011E\u0120\u0122]/g,H:/[\u0124\u0126]/g,I:/[\xCC-\xCF\u0128\u012A\u012C\u012E\u0130]/g,IJ:/[\u0132]/g,J:/[\u0134]/g,K:/[\u0136]/g,L:/[\u0139\u013B\u013D\u013F\u0141]/g,N:/[\xD1\u0143\u0145\u0147\u014A]/g,O:/[\xD2-\xD6\xD8\u014C\u014E\u0150]/g,OE:/[\u0152]/g,R:/[\u0154\u0156\u0158]/g,S:/[\u015A\u015C\u015E\u0160]/g,T:/[\u0162\u0164\u0166]/g,U:/[\xD9-\xDC\u0168\u016A\u016C\u016E\u0170\u0172]/g,W:/[\u0174]/g,Y:/[\xDD\u0176\u0178]/g,Z:/[\u0179\u017B\u017D]/g,a:/[\xE0-\xE5\u0101\u0103\u0105]/g,ae:/[\xE6]/g,c:/[\xE7\u0107\u0109\u010B\u010D]/g,d:/[\u010F\u0111]/g,e:/[\xE8-\xEB\u0113\u0115\u0117\u0119\u011B]/g,g:/[\u011D\u011F\u0121\u0123]/g,i:/[\xEC-\xEF\u0129\u012B\u012D\u012F\u0131]/g,ij:/[\u0133]/g,j:/[\u0135]/g,k:/[\u0137,\u0138]/g,l:/[\u013A\u013C\u013E\u0140\u0142]/g,n:/[\xF1\u0144\u0146\u0148\u014B]/g,p:/[\xFE]/g,o:/[\xF2-\xF6\xF8\u014D\u014F\u0151]/g,oe:/[\u0153]/g,r:/[\u0155\u0157\u0159]/g,s:/[\u015B\u015D\u015F\u0161]/g,t:/[\u0163\u0165\u0167]/g,u:/[\xF9-\xFC\u0169\u016B\u016D\u016F\u0171\u0173]/g,w:/[\u0175]/g,y:/[\xFD\xFF\u0177]/g,z:/[\u017A\u017C\u017E]/g};for(let n in e)t=t.replace(e[n],n)}return t}function ID(t,e,n){t&&e!==n&&(n>=t.length&&(n%=t.length,e%=t.length),t.splice(n,0,t.splice(e,1)[0]))}function AD(t,e,n=1,r,c=1){let u=eG(t,e,r,n),p=n;return(xu(t)||xu(e))&&(p=c===1?n:c),p*u}function aG(t){return fc(t,!1)?t[0].toUpperCase()+t.slice(1):t}function Pz(t){return fc(t)?t.replace(/(_)/g,"-").replace(/[A-Z]/g,(e,n)=>n===0?e:"-"+e.toLowerCase()).toLowerCase():t}function cI(){let t=new Map;return{on(e,n){let r=t.get(e);return r?r.push(n):r=[n],t.set(e,r),this},off(e,n){let r=t.get(e);return r&&r.splice(r.indexOf(n)>>>0,1),this},emit(e,n){let r=t.get(e);r&&r.forEach(c=>{c(n)})},clear(){t.clear()}}}function Ka(...t){if(t){let e=[];for(let n=0;n<t.length;n++){let r=t[n];if(!r)continue;let c=typeof r;if(c==="string"||c==="number")e.push(r);else if(c==="object"){let u=Array.isArray(r)?[Ka(...r)]:Object.entries(r).map(([p,o])=>o?p:void 0);e=u.length?e.concat(u.filter(p=>!!p)):e}}return e.join(" ").trim()}}function lG(t,e){return t?t.classList?t.classList.contains(e):new RegExp("(^| )"+e+"( |$)","gi").test(t.className):!1}function Wv(t,e){if(t&&e){let n=r=>{lG(t,r)||(t.classList?t.classList.add(r):t.className+=" "+r)};[e].flat().filter(Boolean).forEach(r=>r.split(" ").forEach(n))}}function cG(t){if(t){let e=document.createElement("a");if(e.download!==void 0){let{name:n,src:r}=t;return e.setAttribute("href",r),e.setAttribute("download",n),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e),!0}}return!1}function uG(t,e){let n=new Blob([t],{type:"application/csv;charset=utf-8;"});window.navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(n,e+".csv"):cG({name:e+".csv",src:URL.createObjectURL(n)})||(t="data:text/csv;charset=utf-8,"+t,window.open(encodeURI(t)))}function mp(t,e){if(t&&e){let n=r=>{t.classList?t.classList.remove(r):t.className=t.className.replace(new RegExp("(^|\\b)"+r.split(" ").join("|")+"(\\b|$)","gi")," ")};[e].flat().filter(Boolean).forEach(r=>r.split(" ").forEach(n))}}function jT(t){for(let e of document==null?void 0:document.styleSheets)try{for(let n of e==null?void 0:e.cssRules)for(let r of n==null?void 0:n.style)if(t.test(r))return{name:r,value:n.style.getPropertyValue(r).trim()}}catch{}return null}function Mz(t){let e={width:0,height:0};if(t){let[n,r]=[t.style.visibility,t.style.display];t.style.visibility="hidden",t.style.display="block",e.width=t.offsetWidth,e.height=t.offsetHeight,t.style.display=r,t.style.visibility=n}return e}function Dz(){let t=window,e=document,n=e.documentElement,r=e.getElementsByTagName("body")[0],c=t.innerWidth||n.clientWidth||r.clientWidth,u=t.innerHeight||n.clientHeight||r.clientHeight;return{width:c,height:u}}function UT(t){return t?Math.abs(t.scrollLeft):0}function dG(){let t=document.documentElement;return(window.pageXOffset||UT(t))-(t.clientLeft||0)}function hG(){let t=document.documentElement;return(window.pageYOffset||t.scrollTop)-(t.clientTop||0)}function Oz(t){return t?getComputedStyle(t).direction==="rtl":!1}function Lz(t,e,n=!0){var r,c,u,p;if(t){let o=t.offsetParent?{width:t.offsetWidth,height:t.offsetHeight}:Mz(t),w=o.height,T=o.width,A=e.offsetHeight,D=e.offsetWidth,B=e.getBoundingClientRect(),N=hG(),ee=dG(),Q=Dz(),se,ce,be="top";B.top+A+w>Q.height?(se=B.top+N-w,be="bottom",se<0&&(se=N)):se=A+B.top+N,B.left+T>Q.width?ce=Math.max(0,B.left+ee+D-T):ce=B.left+ee,Oz(t)?t.style.insetInlineEnd=ce+"px":t.style.insetInlineStart=ce+"px",t.style.top=se+"px",t.style.transformOrigin=be,n&&(t.style.marginTop=be==="bottom"?`calc(${(c=(r=jT(/-anchor-gutter$/))==null?void 0:r.value)!=null?c:"2px"} * -1)`:(p=(u=jT(/-anchor-gutter$/))==null?void 0:u.value)!=null?p:"")}}function bw(t,e){t&&(typeof e=="string"?t.style.cssText=e:Object.entries(e||{}).forEach(([n,r])=>t.style[n]=r))}function dc(t,e){return t instanceof HTMLElement?t.offsetWidth:0}function fG(t,e,n=!0,r=void 0){var c;if(t){let u=t.offsetParent?{width:t.offsetWidth,height:t.offsetHeight}:Mz(t),p=e.offsetHeight,o=e.getBoundingClientRect(),w=Dz(),T,A,D=r??"top";if(!r&&o.top+p+u.height>w.height?(T=-1*u.height,D="bottom",o.top+T<0&&(T=-1*o.top)):T=p,u.width>w.width?A=o.left*-1:o.left+u.width>w.width?A=(o.left+u.width-w.width)*-1:A=0,t.style.top=T+"px",t.style.insetInlineStart=A+"px",t.style.transformOrigin=D,n){let B=(c=jT(/-anchor-gutter$/))==null?void 0:c.value;t.style.marginTop=D==="bottom"?`calc(${B??"2px"} * -1)`:B??""}}}function uI(t){if(t){let e=t.parentNode;return e&&e instanceof ShadowRoot&&e.host&&(e=e.host),e}return null}function pG(t){return!!(t!==null&&typeof t<"u"&&t.nodeName&&uI(t))}function wg(t){return typeof Element<"u"?t instanceof Element:t!==null&&typeof t=="object"&&t.nodeType===1&&typeof t.nodeName=="string"}function Wx(){if(window.getSelection){let t=window.getSelection()||{};t.empty?t.empty():t.removeAllRanges&&t.rangeCount>0&&t.getRangeAt(0).getClientRects().length>0&&t.removeAllRanges()}}function xw(t,e={}){if(wg(t)){let n=(r,c)=>{var u,p;let o=(u=t==null?void 0:t.$attrs)!=null&&u[r]?[(p=t==null?void 0:t.$attrs)==null?void 0:p[r]]:[];return[c].flat().reduce((w,T)=>{if(T!=null){let A=typeof T;if(A==="string"||A==="number")w.push(T);else if(A==="object"){let D=Array.isArray(T)?n(r,T):Object.entries(T).map(([B,N])=>r==="style"&&(N||N===0)?`${B.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}:${N}`:N?B:void 0);w=D.length?w.concat(D.filter(B=>!!B)):w}}return w},o)};Object.entries(e).forEach(([r,c])=>{if(c!=null){let u=r.match(/^on(.+)/);u?t.addEventListener(u[1].toLowerCase(),c):r==="p-bind"||r==="pBind"?xw(t,c):(c=r==="class"?[...new Set(n("class",c))].join(" ").trim():r==="style"?n("style",c).join(";").trim():c,(t.$attrs=t.$attrs||{})&&(t.$attrs[r]=c),t.setAttribute(r,c))}})}}function zz(t,e={},...n){{let r=document.createElement(t);return xw(r,e),r.append(...n),r}}function I_(t,e){return wg(t)?Array.from(t.querySelectorAll(e)):[]}function xp(t,e){return wg(t)?t.matches(e)?t:t.querySelector(e):null}function Nl(t,e){t&&document.activeElement!==t&&t.focus(e)}function La(t,e){if(wg(t)){let n=t.getAttribute(e);return isNaN(n)?n==="true"||n==="false"?n==="true":n:+n}}function dI(t,e=""){let n=I_(t,`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            [href]:not([tabindex = "-1"]):not([style*="display:none"]):not([hidden])${e},
            input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e}`),r=[];for(let c of n)getComputedStyle(c).display!="none"&&getComputedStyle(c).visibility!="hidden"&&r.push(c);return r}function gp(t,e){let n=dI(t,e);return n.length>0?n[0]:null}function Ym(t){if(t){let e=t.offsetHeight,n=getComputedStyle(t);return e-=parseFloat(n.paddingTop)+parseFloat(n.paddingBottom)+parseFloat(n.borderTopWidth)+parseFloat(n.borderBottomWidth),e}return 0}function mG(t){if(t){let[e,n]=[t.style.visibility,t.style.display];t.style.visibility="hidden",t.style.display="block";let r=t.offsetHeight;return t.style.display=n,t.style.visibility=e,r}return 0}function gG(t){if(t){let[e,n]=[t.style.visibility,t.style.display];t.style.visibility="hidden",t.style.display="block";let r=t.offsetWidth;return t.style.display=n,t.style.visibility=e,r}return 0}function qx(t){var e;if(t){let n=(e=uI(t))==null?void 0:e.childNodes,r=0;if(n)for(let c=0;c<n.length;c++){if(n[c]===t)return r;n[c].nodeType===1&&r++}}return-1}function Bz(t,e){let n=dI(t,e);return n.length>0?n[n.length-1]:null}function CS(t,e){let n=t.nextElementSibling;for(;n;){if(n.matches(e))return n;n=n.nextElementSibling}return null}function A_(t){if(t){let e=t.getBoundingClientRect();return{top:e.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:e.left+(window.pageXOffset||UT(document.documentElement)||UT(document.body)||0)}}return{top:"auto",left:"auto"}}function ww(t,e){return t?t.offsetHeight:0}function Fz(t,e=[]){let n=uI(t);return n===null?e:Fz(n,e.concat([n]))}function TS(t,e){let n=t.previousElementSibling;for(;n;){if(n.matches(e))return n;n=n.previousElementSibling}return null}function _G(t){let e=[];if(t){let n=Fz(t),r=/(auto|scroll)/,c=u=>{try{let p=window.getComputedStyle(u,null);return r.test(p.getPropertyValue("overflow"))||r.test(p.getPropertyValue("overflowX"))||r.test(p.getPropertyValue("overflowY"))}catch{return!1}};for(let u of n){let p=u.nodeType===1&&u.dataset.scrollselectors;if(p){let o=p.split(",");for(let w of o){let T=xp(u,w);T&&c(T)&&e.push(T)}}u.nodeType!==9&&c(u)&&e.push(u)}}return e}function kD(){if(window.getSelection)return window.getSelection().toString();if(document.getSelection)return document.getSelection().toString()}function Jm(t){if(t){let e=t.offsetWidth,n=getComputedStyle(t);return e-=parseFloat(n.paddingLeft)+parseFloat(n.paddingRight)+parseFloat(n.borderLeftWidth)+parseFloat(n.borderRightWidth),e}return 0}function RD(t,e,n){let r=t[e];typeof r=="function"&&r.apply(t,[])}function yG(){return/(android)/i.test(navigator.userAgent)}function z2(t){if(t){let e=t.nodeName,n=t.parentElement&&t.parentElement.nodeName;return e==="INPUT"||e==="TEXTAREA"||e==="BUTTON"||e==="A"||n==="INPUT"||n==="TEXTAREA"||n==="BUTTON"||n==="A"||!!t.closest(".p-button, .p-checkbox, .p-radiobutton")}return!1}function Nz(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function PD(t,e=""){return wg(t)?t.matches(`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e}`):!1}function Sw(t){return!!(t&&t.offsetParent!=null)}function Vz(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}function hI(t,e="",n){wg(t)&&n!==null&&n!==void 0&&t.setAttribute(e,n)}var cx={};function vG(t="pui_id_"){return Object.hasOwn(cx,t)||(cx[t]=0),cx[t]++,`${t}${cx[t]}`}function bG(){let t=[],e=(p,o,w=999)=>{let T=c(p,o,w),A=T.value+(T.key===p?0:w)+1;return t.push({key:p,value:A}),A},n=p=>{t=t.filter(o=>o.value!==p)},r=(p,o)=>c(p).value,c=(p,o,w=0)=>[...t].reverse().find(T=>!0)||{key:p,value:w},u=p=>p&&parseInt(p.style.zIndex,10)||0;return{get:u,set:(p,o,w)=>{o&&(o.style.zIndex=String(e(p,!0,w)))},clear:p=>{p&&(n(u(p)),p.style.zIndex="")},getCurrent:p=>r(p)}}var U_=bG(),xG=Object.defineProperty,wG=Object.defineProperties,SG=Object.getOwnPropertyDescriptors,Cw=Object.getOwnPropertySymbols,$z=Object.prototype.hasOwnProperty,jz=Object.prototype.propertyIsEnumerable,MD=(t,e,n)=>e in t?xG(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Qu=(t,e)=>{for(var n in e||(e={}))$z.call(e,n)&&MD(t,n,e[n]);if(Cw)for(var n of Cw(e))jz.call(e,n)&&MD(t,n,e[n]);return t},B2=(t,e)=>wG(t,SG(e)),Fh=(t,e)=>{var n={};for(var r in t)$z.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Cw)for(var r of Cw(t))e.indexOf(r)<0&&jz.call(t,r)&&(n[r]=t[r]);return n},CG=cI(),Wa=CG,Mb=/{([^}]*)}/g,Uz=/(\d+\s+[\+\-\*\/]\s+\d+)/g,Hz=/var\([^)]+\)/g;function DD(t){return fc(t)?t.replace(/[A-Z]/g,(e,n)=>n===0?e:"."+e.toLowerCase()).toLowerCase():t}function TG(t){return ih(t)&&t.hasOwnProperty("$value")&&t.hasOwnProperty("$type")?t.$value:t}function EG(t){return t.replaceAll(/ /g,"").replace(/[^\w]/g,"-")}function HT(t="",e=""){return EG(`${fc(t,!1)&&fc(e,!1)?`${t}-`:t}${e}`)}function Gz(t="",e=""){return`--${HT(t,e)}`}function IG(t=""){let e=(t.match(/{/g)||[]).length,n=(t.match(/}/g)||[]).length;return(e+n)%2!==0}function Wz(t,e="",n="",r=[],c){if(fc(t)){let u=t.trim();if(IG(u))return;if(og(u,Mb)){let p=u.replaceAll(Mb,o=>{let w=o.replace(/{|}/g,"").split(".").filter(T=>!r.some(A=>og(T,A)));return`var(${Gz(n,Pz(w.join("-")))}${xr(c)?`, ${c}`:""})`});return og(p.replace(Hz,"0"),Uz)?`calc(${p})`:p}return u}else if(rG(t))return t}function AG(t,e,n){fc(e,!1)&&t.push(`${e}:${n};`)}function k_(t,e){return t?`${t}{${e}}`:""}function qz(t,e){if(t.indexOf("dt(")===-1)return t;function n(p,o){let w=[],T=0,A="",D=null,B=0;for(;T<=p.length;){let N=p[T];if((N==='"'||N==="'"||N==="`")&&p[T-1]!=="\\"&&(D=D===N?null:N),!D&&(N==="("&&B++,N===")"&&B--,(N===","||T===p.length)&&B===0)){let ee=A.trim();ee.startsWith("dt(")?w.push(qz(ee,o)):w.push(r(ee)),A="",T++;continue}N!==void 0&&(A+=N),T++}return w}function r(p){let o=p[0];if((o==='"'||o==="'"||o==="`")&&p[p.length-1]===o)return p.slice(1,-1);let w=Number(p);return isNaN(w)?p:w}let c=[],u=[];for(let p=0;p<t.length;p++)if(t[p]==="d"&&t.slice(p,p+3)==="dt(")u.push(p),p+=2;else if(t[p]===")"&&u.length>0){let o=u.pop();u.length===0&&c.push([o,p])}if(!c.length)return t;for(let p=c.length-1;p>=0;p--){let[o,w]=c[p],T=t.slice(o+3,w),A=n(T,e),D=e(...A);t=t.slice(0,o)+D+t.slice(w+1)}return t}var sg=(...t)=>kG(ts.getTheme(),...t),kG=(t={},e,n,r)=>{if(e){let{variable:c,options:u}=ts.defaults||{},{prefix:p,transform:o}=(t==null?void 0:t.options)||u||{},w=og(e,Mb)?e:`{${e}}`;return r==="value"||xu(r)&&o==="strict"?ts.getTokenValue(e):Wz(w,void 0,p,[c.excludedKeyRegex],n)}return""};function ux(t,...e){if(t instanceof Array){let n=t.reduce((r,c,u)=>{var p;return r+c+((p=Lc(e[u],{dt:sg}))!=null?p:"")},"");return qz(n,sg)}return Lc(t,{dt:sg})}function RG(t,e={}){let n=ts.defaults.variable,{prefix:r=n.prefix,selector:c=n.selector,excludedKeyRegex:u=n.excludedKeyRegex}=e,p=[],o=[],w=[{node:t,path:r}];for(;w.length;){let{node:A,path:D}=w.pop();for(let B in A){let N=A[B],ee=TG(N),Q=og(B,u)?HT(D):HT(D,Pz(B));if(ih(ee))w.push({node:ee,path:Q});else{let se=Gz(Q),ce=Wz(ee,Q,r,[u]);AG(o,se,ce);let be=Q;r&&be.startsWith(r+"-")&&(be=be.slice(r.length+1)),p.push(be.replace(/-/g,"."))}}}let T=o.join("");return{value:o,tokens:p,declarations:T,css:k_(c,T)}}var Ju={regex:{rules:{class:{pattern:/^\.([a-zA-Z][\w-]*)$/,resolve(t){return{type:"class",selector:t,matched:this.pattern.test(t.trim())}}},attr:{pattern:/^\[(.*)\]$/,resolve(t){return{type:"attr",selector:`:root${t}`,matched:this.pattern.test(t.trim())}}},media:{pattern:/^@media (.*)$/,resolve(t){return{type:"media",selector:t,matched:this.pattern.test(t.trim())}}},system:{pattern:/^system$/,resolve(t){return{type:"system",selector:"@media (prefers-color-scheme: dark)",matched:this.pattern.test(t.trim())}}},custom:{resolve(t){return{type:"custom",selector:t,matched:!0}}}},resolve(t){let e=Object.keys(this.rules).filter(n=>n!=="custom").map(n=>this.rules[n]);return[t].flat().map(n=>{var r;return(r=e.map(c=>c.resolve(n)).find(c=>c.matched))!=null?r:this.rules.custom.resolve(n)})}},_toVariables(t,e){return RG(t,{prefix:e==null?void 0:e.prefix})},getCommon({name:t="",theme:e={},params:n,set:r,defaults:c}){var u,p,o,w,T,A,D;let{preset:B,options:N}=e,ee,Q,se,ce,be,ze,xe;if(xr(B)&&N.transform!=="strict"){let{primitive:je,semantic:qe,extend:oe}=B,de=qe||{},{colorScheme:Ee}=de,$e=Fh(de,["colorScheme"]),me=oe||{},{colorScheme:Te}=me,Re=Fh(me,["colorScheme"]),tn=Ee||{},{dark:Zt}=tn,on=Fh(tn,["dark"]),hn=Te||{},{dark:Hn}=hn,Ri=Fh(hn,["dark"]),zi=xr(je)?this._toVariables({primitive:je},N):{},Pt=xr($e)?this._toVariables({semantic:$e},N):{},Di=xr(on)?this._toVariables({light:on},N):{},wo=xr(Zt)?this._toVariables({dark:Zt},N):{},Ur=xr(Re)?this._toVariables({semantic:Re},N):{},Br=xr(Ri)?this._toVariables({light:Ri},N):{},ai=xr(Hn)?this._toVariables({dark:Hn},N):{},[Ft,In]=[(u=zi.declarations)!=null?u:"",zi.tokens],[Wt,kn]=[(p=Pt.declarations)!=null?p:"",Pt.tokens||[]],[dr,Qe]=[(o=Di.declarations)!=null?o:"",Di.tokens||[]],[at,vt]=[(w=wo.declarations)!=null?w:"",wo.tokens||[]],[Gt,an]=[(T=Ur.declarations)!=null?T:"",Ur.tokens||[]],[Qt,On]=[(A=Br.declarations)!=null?A:"",Br.tokens||[]],[fn,mn]=[(D=ai.declarations)!=null?D:"",ai.tokens||[]];ee=this.transformCSS(t,Ft,"light","variable",N,r,c),Q=In;let dn=this.transformCSS(t,`${Wt}${dr}`,"light","variable",N,r,c),pi=this.transformCSS(t,`${at}`,"dark","variable",N,r,c);se=`${dn}${pi}`,ce=[...new Set([...kn,...Qe,...vt])];let Ln=this.transformCSS(t,`${Gt}${Qt}color-scheme:light`,"light","variable",N,r,c),mi=this.transformCSS(t,`${fn}color-scheme:dark`,"dark","variable",N,r,c);be=`${Ln}${mi}`,ze=[...new Set([...an,...On,...mn])],xe=Lc(B.css,{dt:sg})}return{primitive:{css:ee,tokens:Q},semantic:{css:se,tokens:ce},global:{css:be,tokens:ze},style:xe}},getPreset({name:t="",preset:e={},options:n,params:r,set:c,defaults:u,selector:p}){var o,w,T;let A,D,B;if(xr(e)&&n.transform!=="strict"){let N=t.replace("-directive",""),ee=e,{colorScheme:Q,extend:se,css:ce}=ee,be=Fh(ee,["colorScheme","extend","css"]),ze=se||{},{colorScheme:xe}=ze,je=Fh(ze,["colorScheme"]),qe=Q||{},{dark:oe}=qe,de=Fh(qe,["dark"]),Ee=xe||{},{dark:$e}=Ee,me=Fh(Ee,["dark"]),Te=xr(be)?this._toVariables({[N]:Qu(Qu({},be),je)},n):{},Re=xr(de)?this._toVariables({[N]:Qu(Qu({},de),me)},n):{},tn=xr(oe)?this._toVariables({[N]:Qu(Qu({},oe),$e)},n):{},[Zt,on]=[(o=Te.declarations)!=null?o:"",Te.tokens||[]],[hn,Hn]=[(w=Re.declarations)!=null?w:"",Re.tokens||[]],[Ri,zi]=[(T=tn.declarations)!=null?T:"",tn.tokens||[]],Pt=this.transformCSS(N,`${Zt}${hn}`,"light","variable",n,c,u,p),Di=this.transformCSS(N,Ri,"dark","variable",n,c,u,p);A=`${Pt}${Di}`,D=[...new Set([...on,...Hn,...zi])],B=Lc(ce,{dt:sg})}return{css:A,tokens:D,style:B}},getPresetC({name:t="",theme:e={},params:n,set:r,defaults:c}){var u;let{preset:p,options:o}=e,w=(u=p==null?void 0:p.components)==null?void 0:u[t];return this.getPreset({name:t,preset:w,options:o,params:n,set:r,defaults:c})},getPresetD({name:t="",theme:e={},params:n,set:r,defaults:c}){var u,p;let o=t.replace("-directive",""),{preset:w,options:T}=e,A=((u=w==null?void 0:w.components)==null?void 0:u[o])||((p=w==null?void 0:w.directives)==null?void 0:p[o]);return this.getPreset({name:o,preset:A,options:T,params:n,set:r,defaults:c})},applyDarkColorScheme(t){return!(t.darkModeSelector==="none"||t.darkModeSelector===!1)},getColorSchemeOption(t,e){var n;return this.applyDarkColorScheme(t)?this.regex.resolve(t.darkModeSelector===!0?e.options.darkModeSelector:(n=t.darkModeSelector)!=null?n:e.options.darkModeSelector):[]},getLayerOrder(t,e={},n,r){let{cssLayer:c}=e;return c?`@layer ${Lc(c.order||c.name||"primeui",n)}`:""},getCommonStyleSheet({name:t="",theme:e={},params:n,props:r={},set:c,defaults:u}){let p=this.getCommon({name:t,theme:e,params:n,set:c,defaults:u}),o=Object.entries(r).reduce((w,[T,A])=>w.push(`${T}="${A}"`)&&w,[]).join(" ");return Object.entries(p||{}).reduce((w,[T,A])=>{if(ih(A)&&Object.hasOwn(A,"css")){let D=ab(A.css),B=`${T}-variables`;w.push(`<style type="text/css" data-primevue-style-id="${B}" ${o}>${D}</style>`)}return w},[]).join("")},getStyleSheet({name:t="",theme:e={},params:n,props:r={},set:c,defaults:u}){var p;let o={name:t,theme:e,params:n,set:c,defaults:u},w=(p=t.includes("-directive")?this.getPresetD(o):this.getPresetC(o))==null?void 0:p.css,T=Object.entries(r).reduce((A,[D,B])=>A.push(`${D}="${B}"`)&&A,[]).join(" ");return w?`<style type="text/css" data-primevue-style-id="${t}-variables" ${T}>${ab(w)}</style>`:""},createTokens(t={},e,n="",r="",c={}){let u=function(o,w={},T=[]){if(T.includes(this.path))return console.warn(`Circular reference detected at ${this.path}`),{colorScheme:o,path:this.path,paths:w,value:void 0};T.push(this.path),w.name=this.path,w.binding||(w.binding={});let A=this.value;if(typeof this.value=="string"&&Mb.test(this.value)){let D=this.value.trim().replace(Mb,B=>{var N;let ee=B.slice(1,-1),Q=this.tokens[ee];if(!Q)return console.warn(`Token not found for path: ${ee}`),"__UNRESOLVED__";let se=Q.computed(o,w,T);return Array.isArray(se)&&se.length===2?`light-dark(${se[0].value},${se[1].value})`:(N=se==null?void 0:se.value)!=null?N:"__UNRESOLVED__"});A=Uz.test(D.replace(Hz,"0"))?`calc(${D})`:D}return xu(w.binding)&&delete w.binding,T.pop(),{colorScheme:o,path:this.path,paths:w,value:A.includes("__UNRESOLVED__")?void 0:A}},p=(o,w,T)=>{Object.entries(o).forEach(([A,D])=>{let B=og(A,e.variable.excludedKeyRegex)?w:w?`${w}.${DD(A)}`:DD(A),N=T?`${T}.${A}`:A;ih(D)?p(D,B,N):(c[B]||(c[B]={paths:[],computed:(ee,Q={},se=[])=>{if(c[B].paths.length===1)return c[B].paths[0].computed(c[B].paths[0].scheme,Q.binding,se);if(ee&&ee!=="none")for(let ce=0;ce<c[B].paths.length;ce++){let be=c[B].paths[ce];if(be.scheme===ee)return be.computed(ee,Q.binding,se)}return c[B].paths.map(ce=>ce.computed(ce.scheme,Q[ce.scheme],se))}}),c[B].paths.push({path:N,value:D,scheme:N.includes("colorScheme.light")?"light":N.includes("colorScheme.dark")?"dark":"none",computed:u,tokens:c}))})};return p(t,n,r),c},getTokenValue(t,e,n){var r;let c=(o=>o.split(".").filter(w=>!og(w.toLowerCase(),n.variable.excludedKeyRegex)).join("."))(e),u=e.includes("colorScheme.light")?"light":e.includes("colorScheme.dark")?"dark":void 0,p=[(r=t[c])==null?void 0:r.computed(u)].flat().filter(o=>o);return p.length===1?p[0].value:p.reduce((o={},w)=>{let T=w,{colorScheme:A}=T,D=Fh(T,["colorScheme"]);return o[A]=D,o},void 0)},getSelectorRule(t,e,n,r){return n==="class"||n==="attr"?k_(xr(e)?`${t}${e},${t} ${e}`:t,r):k_(t,k_(e??":root",r))},transformCSS(t,e,n,r,c={},u,p,o){if(xr(e)){let{cssLayer:w}=c;if(r!=="style"){let T=this.getColorSchemeOption(c,p);e=n==="dark"?T.reduce((A,{type:D,selector:B})=>(xr(B)&&(A+=B.includes("[CSS]")?B.replace("[CSS]",e):this.getSelectorRule(B,o,D,e)),A),""):k_(o??":root",e)}if(w){let T={name:"primeui"};ih(w)&&(T.name=Lc(w.name,{name:t,type:r})),xr(T.name)&&(e=k_(`@layer ${T.name}`,e),u==null||u.layerNames(T.name))}return e}return""}},ts={defaults:{variable:{prefix:"p",selector:":root",excludedKeyRegex:/^(primitive|semantic|components|directives|variables|colorscheme|light|dark|common|root|states|extend|css)$/gi},options:{prefix:"p",darkModeSelector:"system",cssLayer:!1}},_theme:void 0,_layerNames:new Set,_loadedStyleNames:new Set,_loadingStyles:new Set,_tokens:{},update(t={}){let{theme:e}=t;e&&(this._theme=B2(Qu({},e),{options:Qu(Qu({},this.defaults.options),e.options)}),this._tokens=Ju.createTokens(this.preset,this.defaults),this.clearLoadedStyleNames())},get theme(){return this._theme},get preset(){var t;return((t=this.theme)==null?void 0:t.preset)||{}},get options(){var t;return((t=this.theme)==null?void 0:t.options)||{}},get tokens(){return this._tokens},getTheme(){return this.theme},setTheme(t){this.update({theme:t}),Wa.emit("theme:change",t)},getPreset(){return this.preset},setPreset(t){this._theme=B2(Qu({},this.theme),{preset:t}),this._tokens=Ju.createTokens(t,this.defaults),this.clearLoadedStyleNames(),Wa.emit("preset:change",t),Wa.emit("theme:change",this.theme)},getOptions(){return this.options},setOptions(t){this._theme=B2(Qu({},this.theme),{options:t}),this.clearLoadedStyleNames(),Wa.emit("options:change",t),Wa.emit("theme:change",this.theme)},getLayerNames(){return[...this._layerNames]},setLayerNames(t){this._layerNames.add(t)},getLoadedStyleNames(){return this._loadedStyleNames},isStyleNameLoaded(t){return this._loadedStyleNames.has(t)},setLoadedStyleName(t){this._loadedStyleNames.add(t)},deleteLoadedStyleName(t){this._loadedStyleNames.delete(t)},clearLoadedStyleNames(){this._loadedStyleNames.clear()},getTokenValue(t){return Ju.getTokenValue(this.tokens,t,this.defaults)},getCommon(t="",e){return Ju.getCommon({name:t,theme:this.theme,params:e,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}})},getComponent(t="",e){let n={name:t,theme:this.theme,params:e,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}};return Ju.getPresetC(n)},getDirective(t="",e){let n={name:t,theme:this.theme,params:e,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}};return Ju.getPresetD(n)},getCustomPreset(t="",e,n,r){let c={name:t,preset:e,options:this.options,selector:n,params:r,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}};return Ju.getPreset(c)},getLayerOrderCSS(t=""){return Ju.getLayerOrder(t,this.options,{names:this.getLayerNames()},this.defaults)},transformCSS(t="",e,n="style",r){return Ju.transformCSS(t,e,r,n,this.options,{layerNames:this.setLayerNames.bind(this)},this.defaults)},getCommonStyleSheet(t="",e,n={}){return Ju.getCommonStyleSheet({name:t,theme:this.theme,params:e,props:n,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}})},getStyleSheet(t,e,n={}){return Ju.getStyleSheet({name:t,theme:this.theme,params:e,props:n,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}})},onStyleMounted(t){this._loadingStyles.add(t)},onStyleUpdated(t){this._loadingStyles.add(t)},onStyleLoaded(t,{name:e}){this._loadingStyles.size&&(this._loadingStyles.delete(e),Wa.emit(`theme:${e}:load`,t),!this._loadingStyles.size&&Wa.emit("theme:load"))}},Oa={STARTS_WITH:"startsWith",CONTAINS:"contains",NOT_CONTAINS:"notContains",ENDS_WITH:"endsWith",EQUALS:"equals",NOT_EQUALS:"notEquals",LESS_THAN:"lt",LESS_THAN_OR_EQUAL_TO:"lte",GREATER_THAN:"gt",GREATER_THAN_OR_EQUAL_TO:"gte",DATE_IS:"dateIs",DATE_IS_NOT:"dateIsNot",DATE_BEFORE:"dateBefore",DATE_AFTER:"dateAfter"},Tw={AND:"and",OR:"or"};function OD(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=PG(t))||e){n&&(t=n);var r=0,c=function(){};return{s:c,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(T){throw T},f:c}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var u,p=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var T=n.next();return p=T.done,T},e:function(T){o=!0,u=T},f:function(){try{p||n.return==null||n.return()}finally{if(o)throw u}}}}function PG(t,e){if(t){if(typeof t=="string")return LD(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?LD(t,e):void 0}}function LD(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var GT={filter:function(e,n,r,c,u){var p=[];if(!e)return p;var o=OD(e),w;try{for(o.s();!(w=o.n()).done;){var T=w.value;if(typeof T=="string"){if(this.filters[c](T,r,u)){p.push(T);continue}}else{var A=OD(n),D;try{for(A.s();!(D=A.n()).done;){var B=D.value,N=eo(T,B);if(this.filters[c](N,r,u)){p.push(T);break}}}catch(ee){A.e(ee)}finally{A.f()}}}}catch(ee){o.e(ee)}finally{o.f()}return p},filters:{startsWith:function(e,n,r){if(n==null||n==="")return!0;if(e==null)return!1;var c=fu(n.toString()).toLocaleLowerCase(r),u=fu(e.toString()).toLocaleLowerCase(r);return u.slice(0,c.length)===c},contains:function(e,n,r){if(n==null||n==="")return!0;if(e==null)return!1;var c=fu(n.toString()).toLocaleLowerCase(r),u=fu(e.toString()).toLocaleLowerCase(r);return u.indexOf(c)!==-1},notContains:function(e,n,r){if(n==null||n==="")return!0;if(e==null)return!1;var c=fu(n.toString()).toLocaleLowerCase(r),u=fu(e.toString()).toLocaleLowerCase(r);return u.indexOf(c)===-1},endsWith:function(e,n,r){if(n==null||n==="")return!0;if(e==null)return!1;var c=fu(n.toString()).toLocaleLowerCase(r),u=fu(e.toString()).toLocaleLowerCase(r);return u.indexOf(c,u.length-c.length)!==-1},equals:function(e,n,r){return n==null||n===""?!0:e==null?!1:e.getTime&&n.getTime?e.getTime()===n.getTime():fu(e.toString()).toLocaleLowerCase(r)==fu(n.toString()).toLocaleLowerCase(r)},notEquals:function(e,n,r){return n==null||n===""?!1:e==null?!0:e.getTime&&n.getTime?e.getTime()!==n.getTime():fu(e.toString()).toLocaleLowerCase(r)!=fu(n.toString()).toLocaleLowerCase(r)},in:function(e,n){if(n==null||n.length===0)return!0;for(var r=0;r<n.length;r++)if(xg(e,n[r]))return!0;return!1},between:function(e,n){return n==null||n[0]==null||n[1]==null?!0:e==null?!1:e.getTime?n[0].getTime()<=e.getTime()&&e.getTime()<=n[1].getTime():n[0]<=e&&e<=n[1]},lt:function(e,n){return n==null?!0:e==null?!1:e.getTime&&n.getTime?e.getTime()<n.getTime():e<n},lte:function(e,n){return n==null?!0:e==null?!1:e.getTime&&n.getTime?e.getTime()<=n.getTime():e<=n},gt:function(e,n){return n==null?!0:e==null?!1:e.getTime&&n.getTime?e.getTime()>n.getTime():e>n},gte:function(e,n){return n==null?!0:e==null?!1:e.getTime&&n.getTime?e.getTime()>=n.getTime():e>=n},dateIs:function(e,n){return n==null?!0:e==null?!1:e.toDateString()===n.toDateString()},dateIsNot:function(e,n){return n==null?!0:e==null?!1:e.toDateString()!==n.toDateString()},dateBefore:function(e,n){return n==null?!0:e==null?!1:e.getTime()<n.getTime()},dateAfter:function(e,n){return n==null?!0:e==null?!1:e.getTime()>n.getTime()}},register:function(e,n){this.filters[e]=n}},MG=`
    *,
    ::before,
    ::after {
        box-sizing: border-box;
    }

    /* Non vue overlay animations */
    .p-connected-overlay {
        opacity: 0;
        transform: scaleY(0.8);
        transition:
            transform 0.12s cubic-bezier(0, 0, 0.2, 1),
            opacity 0.12s cubic-bezier(0, 0, 0.2, 1);
    }

    .p-connected-overlay-visible {
        opacity: 1;
        transform: scaleY(1);
    }

    .p-connected-overlay-hidden {
        opacity: 0;
        transform: scaleY(1);
        transition: opacity 0.1s linear;
    }

    /* Vue based overlay animations */
    .p-connected-overlay-enter-from {
        opacity: 0;
        transform: scaleY(0.8);
    }

    .p-connected-overlay-leave-to {
        opacity: 0;
    }

    .p-connected-overlay-enter-active {
        transition:
            transform 0.12s cubic-bezier(0, 0, 0.2, 1),
            opacity 0.12s cubic-bezier(0, 0, 0.2, 1);
    }

    .p-connected-overlay-leave-active {
        transition: opacity 0.1s linear;
    }

    /* Toggleable Content */
    .p-toggleable-content-enter-from,
    .p-toggleable-content-leave-to {
        max-height: 0;
    }

    .p-toggleable-content-enter-to,
    .p-toggleable-content-leave-from {
        max-height: 1000px;
    }

    .p-toggleable-content-leave-active {
        overflow: hidden;
        transition: max-height 0.45s cubic-bezier(0, 1, 0, 1);
    }

    .p-toggleable-content-enter-active {
        overflow: hidden;
        transition: max-height 1s ease-in-out;
    }

    .p-disabled,
    .p-disabled * {
        cursor: default;
        pointer-events: none;
        user-select: none;
    }

    .p-disabled,
    .p-component:disabled {
        opacity: dt('disabled.opacity');
    }

    .pi {
        font-size: dt('icon.size');
    }

    .p-icon {
        width: dt('icon.size');
        height: dt('icon.size');
    }

    .p-overlay-mask {
        background: dt('mask.background');
        color: dt('mask.color');
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
    }

    .p-overlay-mask-enter {
        animation: p-overlay-mask-enter-animation dt('mask.transition.duration') forwards;
    }

    .p-overlay-mask-leave {
        animation: p-overlay-mask-leave-animation dt('mask.transition.duration') forwards;
    }

    @keyframes p-overlay-mask-enter-animation {
        from {
            background: transparent;
        }
        to {
            background: dt('mask.background');
        }
    }
    @keyframes p-overlay-mask-leave-animation {
        from {
            background: dt('mask.background');
        }
        to {
            background: transparent;
        }
    }
`;function Db(t){"@babel/helpers - typeof";return Db=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Db(t)}function zD(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function BD(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?zD(Object(n),!0).forEach(function(r){DG(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zD(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function DG(t,e,n){return(e=OG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OG(t){var e=LG(t,"string");return Db(e)=="symbol"?e:e+""}function LG(t,e){if(Db(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Db(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zG(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;kb()&&kb().components?lh(t):e?t():hy(t)}var BG=0;function FG(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=Si(!1),r=Si(t),c=Si(null),u=Nz()?window.document:void 0,p=e.document,o=p===void 0?u:p,w=e.immediate,T=w===void 0?!0:w,A=e.manual,D=A===void 0?!1:A,B=e.name,N=B===void 0?"style_".concat(++BG):B,ee=e.id,Q=ee===void 0?void 0:ee,se=e.media,ce=se===void 0?void 0:se,be=e.nonce,ze=be===void 0?void 0:be,xe=e.first,je=xe===void 0?!1:xe,qe=e.onMounted,oe=qe===void 0?void 0:qe,de=e.onUpdated,Ee=de===void 0?void 0:de,$e=e.onLoad,me=$e===void 0?void 0:$e,Te=e.props,Re=Te===void 0?{}:Te,tn=function(){},Zt=function(Hn){var Ri=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(o){var zi=BD(BD({},Re),Ri),Pt=zi.name||N,Di=zi.id||Q,wo=zi.nonce||ze;c.value=o.querySelector('style[data-primevue-style-id="'.concat(Pt,'"]'))||o.getElementById(Di)||o.createElement("style"),c.value.isConnected||(r.value=Hn||t,xw(c.value,{type:"text/css",id:Di,media:ce,nonce:wo}),je?o.head.prepend(c.value):o.head.appendChild(c.value),hI(c.value,"data-primevue-style-id",Pt),xw(c.value,zi),c.value.onload=function(Ur){return me==null?void 0:me(Ur,{name:Pt})},oe==null||oe(Pt)),!n.value&&(tn=gu(r,function(Ur){c.value.textContent=Ur,Ee==null||Ee(Pt)},{immediate:!0}),n.value=!0)}},on=function(){!o||!n.value||(tn(),pG(c.value)&&o.head.removeChild(c.value),n.value=!1,c.value=null)};return T&&!D&&zG(Zt),{id:Q,name:N,el:c,css:r,unload:on,load:Zt,isLoaded:XE(n)}}function Ob(t){"@babel/helpers - typeof";return Ob=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ob(t)}var FD,ND,VD,$D;function jD(t,e){return jG(t)||$G(t,e)||VG(t,e)||NG()}function NG(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VG(t,e){if(t){if(typeof t=="string")return UD(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?UD(t,e):void 0}}function UD(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function $G(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,c,u,p,o=[],w=!0,T=!1;try{if(u=(n=n.call(t)).next,e!==0)for(;!(w=(r=u.call(n)).done)&&(o.push(r.value),o.length!==e);w=!0);}catch(A){T=!0,c=A}finally{try{if(!w&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(T)throw c}}return o}}function jG(t){if(Array.isArray(t))return t}function HD(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function F2(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?HD(Object(n),!0).forEach(function(r){UG(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):HD(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function UG(t,e,n){return(e=HG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HG(t){var e=GG(t,"string");return Ob(e)=="symbol"?e:e+""}function GG(t,e){if(Ob(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Ob(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dx(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var WG=function(e){var n=e.dt;return`
.p-hidden-accessible {
    border: 0;
    clip: rect(0 0 0 0);
    height: 1px;
    margin: -1px;
    opacity: 0;
    overflow: hidden;
    padding: 0;
    pointer-events: none;
    position: absolute;
    white-space: nowrap;
    width: 1px;
}

.p-overflow-hidden {
    overflow: hidden;
    padding-right: `.concat(n("scrollbar.width"),`;
}
`)},qG={},ZG={},Kr={name:"base",css:WG,style:MG,classes:qG,inlineStyles:ZG,load:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(u){return u},c=r(ux(FD||(FD=dx(["",""])),e));return xr(c)?FG(ab(c),F2({name:this.name},n)):{}},loadCSS:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.load(this.css,e)},loadStyle:function(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return this.load(this.style,n,function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ts.transformCSS(n.name||e.name,"".concat(c).concat(ux(ND||(ND=dx(["",""])),r)))})},getCommonTheme:function(e){return ts.getCommon(this.name,e)},getComponentTheme:function(e){return ts.getComponent(this.name,e)},getDirectiveTheme:function(e){return ts.getDirective(this.name,e)},getPresetTheme:function(e,n,r){return ts.getCustomPreset(this.name,e,n,r)},getLayerOrderThemeCSS:function(){return ts.getLayerOrderCSS(this.name)},getStyleSheet:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.css){var r=Lc(this.css,{dt:sg})||"",c=ab(ux(VD||(VD=dx(["","",""])),r,e)),u=Object.entries(n).reduce(function(p,o){var w=jD(o,2),T=w[0],A=w[1];return p.push("".concat(T,'="').concat(A,'"'))&&p},[]).join(" ");return xr(c)?'<style type="text/css" data-primevue-style-id="'.concat(this.name,'" ').concat(u,">").concat(c,"</style>"):""}return""},getCommonThemeStyleSheet:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ts.getCommonStyleSheet(this.name,e,n)},getThemeStyleSheet:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=[ts.getStyleSheet(this.name,e,n)];if(this.style){var c=this.name==="base"?"global-style":"".concat(this.name,"-style"),u=ux($D||($D=dx(["",""])),Lc(this.style,{dt:sg})),p=ab(ts.transformCSS(c,u)),o=Object.entries(n).reduce(function(w,T){var A=jD(T,2),D=A[0],B=A[1];return w.push("".concat(D,'="').concat(B,'"'))&&w},[]).join(" ");xr(p)&&r.push('<style type="text/css" data-primevue-style-id="'.concat(c,'" ').concat(o,">").concat(p,"</style>"))}return r.join("")},extend:function(e){return F2(F2({},this),{},{css:void 0,style:void 0},e)}},wp=cI();function Lb(t){"@babel/helpers - typeof";return Lb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lb(t)}function GD(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function hx(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?GD(Object(n),!0).forEach(function(r){KG(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):GD(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function KG(t,e,n){return(e=XG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XG(t){var e=YG(t,"string");return Lb(e)=="symbol"?e:e+""}function YG(t,e){if(Lb(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Lb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var JG={ripple:!1,inputStyle:null,inputVariant:null,locale:{startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",completed:"Completed",pending:"Pending",fileSizeTypes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],chooseYear:"Choose Year",chooseMonth:"Choose Month",chooseDate:"Choose Date",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",prevHour:"Previous Hour",nextHour:"Next Hour",prevMinute:"Previous Minute",nextMinute:"Next Minute",prevSecond:"Previous Second",nextSecond:"Next Second",am:"am",pm:"pm",today:"Today",weekHeader:"Wk",firstDayOfWeek:0,showMonthAfterYear:!1,dateFormat:"mm/dd/yy",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyFilterMessage:"No results found",searchMessage:"{0} results are available",selectionMessage:"{0} items selected",emptySelectionMessage:"No selected item",emptySearchMessage:"No results found",fileChosenMessage:"{0} files",noFileChosenMessage:"No file chosen",emptyMessage:"No available options",aria:{trueLabel:"True",falseLabel:"False",nullLabel:"Not Selected",star:"1 star",stars:"{star} stars",selectAll:"All items selected",unselectAll:"All items unselected",close:"Close",previous:"Previous",next:"Next",navigation:"Navigation",scrollTop:"Scroll Top",moveTop:"Move Top",moveUp:"Move Up",moveDown:"Move Down",moveBottom:"Move Bottom",moveToTarget:"Move to Target",moveToSource:"Move to Source",moveAllToTarget:"Move All to Target",moveAllToSource:"Move All to Source",pageLabel:"Page {page}",firstPageLabel:"First Page",lastPageLabel:"Last Page",nextPageLabel:"Next Page",prevPageLabel:"Previous Page",rowsPerPageLabel:"Rows per page",jumpToPageDropdownLabel:"Jump to Page Dropdown",jumpToPageInputLabel:"Jump to Page Input",selectRow:"Row Selected",unselectRow:"Row Unselected",expandRow:"Row Expanded",collapseRow:"Row Collapsed",showFilterMenu:"Show Filter Menu",hideFilterMenu:"Hide Filter Menu",filterOperator:"Filter Operator",filterConstraint:"Filter Constraint",editRow:"Row Edit",saveEdit:"Save Edit",cancelEdit:"Cancel Edit",listView:"List View",gridView:"Grid View",slide:"Slide",slideNumber:"{slideNumber}",zoomImage:"Zoom Image",zoomIn:"Zoom In",zoomOut:"Zoom Out",rotateRight:"Rotate Right",rotateLeft:"Rotate Left",listLabel:"Option List"}},filterMatchModeOptions:{text:[Oa.STARTS_WITH,Oa.CONTAINS,Oa.NOT_CONTAINS,Oa.ENDS_WITH,Oa.EQUALS,Oa.NOT_EQUALS],numeric:[Oa.EQUALS,Oa.NOT_EQUALS,Oa.LESS_THAN,Oa.LESS_THAN_OR_EQUAL_TO,Oa.GREATER_THAN,Oa.GREATER_THAN_OR_EQUAL_TO],date:[Oa.DATE_IS,Oa.DATE_IS_NOT,Oa.DATE_BEFORE,Oa.DATE_AFTER]},zIndex:{modal:1100,overlay:1e3,menu:1e3,tooltip:1100},theme:void 0,unstyled:!1,pt:void 0,ptOptions:{mergeSections:!0,mergeProps:!1},csp:{nonce:void 0}},QG=Symbol();function eW(t,e){var n={config:T0(e)};return t.config.globalProperties.$primevue=n,t.provide(QG,n),tW(),nW(t,n),n}var M_=[];function tW(){Wa.clear(),M_.forEach(function(t){return t==null?void 0:t()}),M_=[]}function nW(t,e){var n=Si(!1),r=function(){var T;if(((T=e.config)===null||T===void 0?void 0:T.theme)!=="none"&&!ts.isStyleNameLoaded("common")){var A,D,B=((A=Kr.getCommonTheme)===null||A===void 0?void 0:A.call(Kr))||{},N=B.primitive,ee=B.semantic,Q=B.global,se=B.style,ce={nonce:(D=e.config)===null||D===void 0||(D=D.csp)===null||D===void 0?void 0:D.nonce};Kr.load(N==null?void 0:N.css,hx({name:"primitive-variables"},ce)),Kr.load(ee==null?void 0:ee.css,hx({name:"semantic-variables"},ce)),Kr.load(Q==null?void 0:Q.css,hx({name:"global-variables"},ce)),Kr.loadStyle(hx({name:"global-style"},ce),se),ts.setLoadedStyleName("common")}};Wa.on("theme:change",function(w){n.value||(t.config.globalProperties.$primevue.config.theme=w,n.value=!0)});var c=gu(e.config,function(w,T){wp.emit("config:change",{newValue:w,oldValue:T})},{immediate:!0,deep:!0}),u=gu(function(){return e.config.ripple},function(w,T){wp.emit("config:ripple:change",{newValue:w,oldValue:T})},{immediate:!0,deep:!0}),p=gu(function(){return e.config.theme},function(w,T){n.value||ts.setTheme(w),e.config.unstyled||r(),n.value=!1,wp.emit("config:theme:change",{newValue:w,oldValue:T})},{immediate:!0,deep:!1}),o=gu(function(){return e.config.unstyled},function(w,T){!w&&e.config.theme&&r(),wp.emit("config:unstyled:change",{newValue:w,oldValue:T})},{immediate:!0,deep:!0});M_.push(c),M_.push(u),M_.push(p),M_.push(o)}var iW={install:function(e,n){var r=sG(JG,n);eW(e,r)}},rW={transitionDuration:"{transition.duration}"},oW={borderWidth:"0 0 1px 0",borderColor:"{content.border.color}"},sW={color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{text.color}",activeHoverColor:"{text.color}",padding:"1.125rem",fontWeight:"600",borderRadius:"0",borderWidth:"0",borderColor:"{content.border.color}",background:"{content.background}",hoverBackground:"{content.background}",activeBackground:"{content.background}",activeHoverBackground:"{content.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},toggleIcon:{color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{text.color}",activeHoverColor:"{text.color}"},first:{topBorderRadius:"{content.border.radius}",borderWidth:"0"},last:{bottomBorderRadius:"{content.border.radius}",activeBottomBorderRadius:"0"}},aW={borderWidth:"0",borderColor:"{content.border.color}",background:"{content.background}",color:"{text.color}",padding:"0 1.125rem 1.125rem 1.125rem"},lW={root:rW,panel:oW,header:sW,content:aW},cW={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}"},uW={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},dW={padding:"{list.padding}",gap:"{list.gap}"},hW={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},fW={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},pW={width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"},borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},mW={borderRadius:"{border.radius.sm}"},gW={padding:"{list.option.padding}"},_W={light:{chip:{focusBackground:"{surface.200}",focusColor:"{surface.800}"},dropdown:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}"}},dark:{chip:{focusBackground:"{surface.700}",focusColor:"{surface.0}"},dropdown:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}"}}},yW={root:cW,overlay:uW,list:dW,option:hW,optionGroup:fW,dropdown:pW,chip:mW,emptyMessage:gW,colorScheme:_W},vW={width:"2rem",height:"2rem",fontSize:"1rem",background:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"},bW={size:"1rem"},xW={borderColor:"{content.background}",offset:"-0.75rem"},wW={width:"3rem",height:"3rem",fontSize:"1.5rem",icon:{size:"1.5rem"},group:{offset:"-1rem"}},SW={width:"4rem",height:"4rem",fontSize:"2rem",icon:{size:"2rem"},group:{offset:"-1.5rem"}},CW={root:vW,icon:bW,group:xW,lg:wW,xl:SW},TW={borderRadius:"{border.radius.md}",padding:"0 0.5rem",fontSize:"0.75rem",fontWeight:"700",minWidth:"1.5rem",height:"1.5rem"},EW={size:"0.5rem"},IW={fontSize:"0.625rem",minWidth:"1.25rem",height:"1.25rem"},AW={fontSize:"0.875rem",minWidth:"1.75rem",height:"1.75rem"},kW={fontSize:"1rem",minWidth:"2rem",height:"2rem"},RW={light:{primary:{background:"{primary.color}",color:"{primary.contrast.color}"},secondary:{background:"{surface.100}",color:"{surface.600}"},success:{background:"{green.500}",color:"{surface.0}"},info:{background:"{sky.500}",color:"{surface.0}"},warn:{background:"{orange.500}",color:"{surface.0}"},danger:{background:"{red.500}",color:"{surface.0}"},contrast:{background:"{surface.950}",color:"{surface.0}"}},dark:{primary:{background:"{primary.color}",color:"{primary.contrast.color}"},secondary:{background:"{surface.800}",color:"{surface.300}"},success:{background:"{green.400}",color:"{green.950}"},info:{background:"{sky.400}",color:"{sky.950}"},warn:{background:"{orange.400}",color:"{orange.950}"},danger:{background:"{red.400}",color:"{red.950}"},contrast:{background:"{surface.0}",color:"{surface.950}"}}},PW={root:TW,dot:EW,sm:IW,lg:AW,xl:kW,colorScheme:RW},MW={borderRadius:{none:"0",xs:"2px",sm:"4px",md:"6px",lg:"8px",xl:"12px"},emerald:{50:"#ecfdf5",100:"#d1fae5",200:"#a7f3d0",300:"#6ee7b7",400:"#34d399",500:"#10b981",600:"#059669",700:"#047857",800:"#065f46",900:"#064e3b",950:"#022c22"},green:{50:"#f0fdf4",100:"#dcfce7",200:"#bbf7d0",300:"#86efac",400:"#4ade80",500:"#22c55e",600:"#16a34a",700:"#15803d",800:"#166534",900:"#14532d",950:"#052e16"},lime:{50:"#f7fee7",100:"#ecfccb",200:"#d9f99d",300:"#bef264",400:"#a3e635",500:"#84cc16",600:"#65a30d",700:"#4d7c0f",800:"#3f6212",900:"#365314",950:"#1a2e05"},red:{50:"#fef2f2",100:"#fee2e2",200:"#fecaca",300:"#fca5a5",400:"#f87171",500:"#ef4444",600:"#dc2626",700:"#b91c1c",800:"#991b1b",900:"#7f1d1d",950:"#450a0a"},orange:{50:"#fff7ed",100:"#ffedd5",200:"#fed7aa",300:"#fdba74",400:"#fb923c",500:"#f97316",600:"#ea580c",700:"#c2410c",800:"#9a3412",900:"#7c2d12",950:"#431407"},amber:{50:"#fffbeb",100:"#fef3c7",200:"#fde68a",300:"#fcd34d",400:"#fbbf24",500:"#f59e0b",600:"#d97706",700:"#b45309",800:"#92400e",900:"#78350f",950:"#451a03"},yellow:{50:"#fefce8",100:"#fef9c3",200:"#fef08a",300:"#fde047",400:"#facc15",500:"#eab308",600:"#ca8a04",700:"#a16207",800:"#854d0e",900:"#713f12",950:"#422006"},teal:{50:"#f0fdfa",100:"#ccfbf1",200:"#99f6e4",300:"#5eead4",400:"#2dd4bf",500:"#14b8a6",600:"#0d9488",700:"#0f766e",800:"#115e59",900:"#134e4a",950:"#042f2e"},cyan:{50:"#ecfeff",100:"#cffafe",200:"#a5f3fc",300:"#67e8f9",400:"#22d3ee",500:"#06b6d4",600:"#0891b2",700:"#0e7490",800:"#155e75",900:"#164e63",950:"#083344"},sky:{50:"#f0f9ff",100:"#e0f2fe",200:"#bae6fd",300:"#7dd3fc",400:"#38bdf8",500:"#0ea5e9",600:"#0284c7",700:"#0369a1",800:"#075985",900:"#0c4a6e",950:"#082f49"},blue:{50:"#eff6ff",100:"#dbeafe",200:"#bfdbfe",300:"#93c5fd",400:"#60a5fa",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8",800:"#1e40af",900:"#1e3a8a",950:"#172554"},indigo:{50:"#eef2ff",100:"#e0e7ff",200:"#c7d2fe",300:"#a5b4fc",400:"#818cf8",500:"#6366f1",600:"#4f46e5",700:"#4338ca",800:"#3730a3",900:"#312e81",950:"#1e1b4b"},violet:{50:"#f5f3ff",100:"#ede9fe",200:"#ddd6fe",300:"#c4b5fd",400:"#a78bfa",500:"#8b5cf6",600:"#7c3aed",700:"#6d28d9",800:"#5b21b6",900:"#4c1d95",950:"#2e1065"},purple:{50:"#faf5ff",100:"#f3e8ff",200:"#e9d5ff",300:"#d8b4fe",400:"#c084fc",500:"#a855f7",600:"#9333ea",700:"#7e22ce",800:"#6b21a8",900:"#581c87",950:"#3b0764"},fuchsia:{50:"#fdf4ff",100:"#fae8ff",200:"#f5d0fe",300:"#f0abfc",400:"#e879f9",500:"#d946ef",600:"#c026d3",700:"#a21caf",800:"#86198f",900:"#701a75",950:"#4a044e"},pink:{50:"#fdf2f8",100:"#fce7f3",200:"#fbcfe8",300:"#f9a8d4",400:"#f472b6",500:"#ec4899",600:"#db2777",700:"#be185d",800:"#9d174d",900:"#831843",950:"#500724"},rose:{50:"#fff1f2",100:"#ffe4e6",200:"#fecdd3",300:"#fda4af",400:"#fb7185",500:"#f43f5e",600:"#e11d48",700:"#be123c",800:"#9f1239",900:"#881337",950:"#4c0519"},slate:{50:"#f8fafc",100:"#f1f5f9",200:"#e2e8f0",300:"#cbd5e1",400:"#94a3b8",500:"#64748b",600:"#475569",700:"#334155",800:"#1e293b",900:"#0f172a",950:"#020617"},gray:{50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",300:"#d1d5db",400:"#9ca3af",500:"#6b7280",600:"#4b5563",700:"#374151",800:"#1f2937",900:"#111827",950:"#030712"},zinc:{50:"#fafafa",100:"#f4f4f5",200:"#e4e4e7",300:"#d4d4d8",400:"#a1a1aa",500:"#71717a",600:"#52525b",700:"#3f3f46",800:"#27272a",900:"#18181b",950:"#09090b"},neutral:{50:"#fafafa",100:"#f5f5f5",200:"#e5e5e5",300:"#d4d4d4",400:"#a3a3a3",500:"#737373",600:"#525252",700:"#404040",800:"#262626",900:"#171717",950:"#0a0a0a"},stone:{50:"#fafaf9",100:"#f5f5f4",200:"#e7e5e4",300:"#d6d3d1",400:"#a8a29e",500:"#78716c",600:"#57534e",700:"#44403c",800:"#292524",900:"#1c1917",950:"#0c0a09"}},DW={transitionDuration:"0.2s",focusRing:{width:"1px",style:"solid",color:"{primary.color}",offset:"2px",shadow:"none"},disabledOpacity:"0.6",iconSize:"1rem",anchorGutter:"2px",primary:{50:"{emerald.50}",100:"{emerald.100}",200:"{emerald.200}",300:"{emerald.300}",400:"{emerald.400}",500:"{emerald.500}",600:"{emerald.600}",700:"{emerald.700}",800:"{emerald.800}",900:"{emerald.900}",950:"{emerald.950}"},formField:{paddingX:"0.75rem",paddingY:"0.5rem",sm:{fontSize:"0.875rem",paddingX:"0.625rem",paddingY:"0.375rem"},lg:{fontSize:"1.125rem",paddingX:"0.875rem",paddingY:"0.625rem"},borderRadius:"{border.radius.md}",focusRing:{width:"0",style:"none",color:"transparent",offset:"0",shadow:"none"},transitionDuration:"{transition.duration}"},list:{padding:"0.25rem 0.25rem",gap:"2px",header:{padding:"0.5rem 1rem 0.25rem 1rem"},option:{padding:"0.5rem 0.75rem",borderRadius:"{border.radius.sm}"},optionGroup:{padding:"0.5rem 0.75rem",fontWeight:"600"}},content:{borderRadius:"{border.radius.md}"},mask:{transitionDuration:"0.15s"},navigation:{list:{padding:"0.25rem 0.25rem",gap:"2px"},item:{padding:"0.5rem 0.75rem",borderRadius:"{border.radius.sm}",gap:"0.5rem"},submenuLabel:{padding:"0.5rem 0.75rem",fontWeight:"600"},submenuIcon:{size:"0.875rem"}},overlay:{select:{borderRadius:"{border.radius.md}",shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"},popover:{borderRadius:"{border.radius.md}",padding:"0.75rem",shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"},modal:{borderRadius:"{border.radius.xl}",padding:"1.25rem",shadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1)"},navigation:{shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"}},colorScheme:{light:{surface:{0:"#ffffff",50:"{slate.50}",100:"{slate.100}",200:"{slate.200}",300:"{slate.300}",400:"{slate.400}",500:"{slate.500}",600:"{slate.600}",700:"{slate.700}",800:"{slate.800}",900:"{slate.900}",950:"{slate.950}"},primary:{color:"{primary.500}",contrastColor:"#ffffff",hoverColor:"{primary.600}",activeColor:"{primary.700}"},highlight:{background:"{primary.50}",focusBackground:"{primary.100}",color:"{primary.700}",focusColor:"{primary.800}"},mask:{background:"rgba(0,0,0,0.4)",color:"{surface.200}"},formField:{background:"{surface.0}",disabledBackground:"{surface.200}",filledBackground:"{surface.50}",filledHoverBackground:"{surface.50}",filledFocusBackground:"{surface.50}",borderColor:"{surface.300}",hoverBorderColor:"{surface.400}",focusBorderColor:"{primary.color}",invalidBorderColor:"{red.400}",color:"{surface.700}",disabledColor:"{surface.500}",placeholderColor:"{surface.500}",invalidPlaceholderColor:"{red.600}",floatLabelColor:"{surface.500}",floatLabelFocusColor:"{primary.600}",floatLabelActiveColor:"{surface.500}",floatLabelInvalidColor:"{form.field.invalid.placeholder.color}",iconColor:"{surface.400}",shadow:"0 0 #0000, 0 0 #0000, 0 1px 2px 0 rgba(18, 18, 23, 0.05)"},text:{color:"{surface.700}",hoverColor:"{surface.800}",mutedColor:"{surface.500}",hoverMutedColor:"{surface.600}"},content:{background:"{surface.0}",hoverBackground:"{surface.100}",borderColor:"{surface.200}",color:"{text.color}",hoverColor:"{text.hover.color}"},overlay:{select:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"},popover:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"},modal:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"}},list:{option:{focusBackground:"{surface.100}",selectedBackground:"{highlight.background}",selectedFocusBackground:"{highlight.focus.background}",color:"{text.color}",focusColor:"{text.hover.color}",selectedColor:"{highlight.color}",selectedFocusColor:"{highlight.focus.color}",icon:{color:"{surface.400}",focusColor:"{surface.500}"}},optionGroup:{background:"transparent",color:"{text.muted.color}"}},navigation:{item:{focusBackground:"{surface.100}",activeBackground:"{surface.100}",color:"{text.color}",focusColor:"{text.hover.color}",activeColor:"{text.hover.color}",icon:{color:"{surface.400}",focusColor:"{surface.500}",activeColor:"{surface.500}"}},submenuLabel:{background:"transparent",color:"{text.muted.color}"},submenuIcon:{color:"{surface.400}",focusColor:"{surface.500}",activeColor:"{surface.500}"}}},dark:{surface:{0:"#ffffff",50:"{zinc.50}",100:"{zinc.100}",200:"{zinc.200}",300:"{zinc.300}",400:"{zinc.400}",500:"{zinc.500}",600:"{zinc.600}",700:"{zinc.700}",800:"{zinc.800}",900:"{zinc.900}",950:"{zinc.950}"},primary:{color:"{primary.400}",contrastColor:"{surface.900}",hoverColor:"{primary.300}",activeColor:"{primary.200}"},highlight:{background:"color-mix(in srgb, {primary.400}, transparent 84%)",focusBackground:"color-mix(in srgb, {primary.400}, transparent 76%)",color:"rgba(255,255,255,.87)",focusColor:"rgba(255,255,255,.87)"},mask:{background:"rgba(0,0,0,0.6)",color:"{surface.200}"},formField:{background:"{surface.950}",disabledBackground:"{surface.700}",filledBackground:"{surface.800}",filledHoverBackground:"{surface.800}",filledFocusBackground:"{surface.800}",borderColor:"{surface.600}",hoverBorderColor:"{surface.500}",focusBorderColor:"{primary.color}",invalidBorderColor:"{red.300}",color:"{surface.0}",disabledColor:"{surface.400}",placeholderColor:"{surface.400}",invalidPlaceholderColor:"{red.400}",floatLabelColor:"{surface.400}",floatLabelFocusColor:"{primary.color}",floatLabelActiveColor:"{surface.400}",floatLabelInvalidColor:"{form.field.invalid.placeholder.color}",iconColor:"{surface.400}",shadow:"0 0 #0000, 0 0 #0000, 0 1px 2px 0 rgba(18, 18, 23, 0.05)"},text:{color:"{surface.0}",hoverColor:"{surface.0}",mutedColor:"{surface.400}",hoverMutedColor:"{surface.300}"},content:{background:"{surface.900}",hoverBackground:"{surface.800}",borderColor:"{surface.700}",color:"{text.color}",hoverColor:"{text.hover.color}"},overlay:{select:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"},popover:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"},modal:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"}},list:{option:{focusBackground:"{surface.800}",selectedBackground:"{highlight.background}",selectedFocusBackground:"{highlight.focus.background}",color:"{text.color}",focusColor:"{text.hover.color}",selectedColor:"{highlight.color}",selectedFocusColor:"{highlight.focus.color}",icon:{color:"{surface.500}",focusColor:"{surface.400}"}},optionGroup:{background:"transparent",color:"{text.muted.color}"}},navigation:{item:{focusBackground:"{surface.800}",activeBackground:"{surface.800}",color:"{text.color}",focusColor:"{text.hover.color}",activeColor:"{text.hover.color}",icon:{color:"{surface.500}",focusColor:"{surface.400}",activeColor:"{surface.400}"}},submenuLabel:{background:"transparent",color:"{text.muted.color}"},submenuIcon:{color:"{surface.500}",focusColor:"{surface.400}",activeColor:"{surface.400}"}}}}},OW={primitive:MW,semantic:DW},LW={borderRadius:"{content.border.radius}"},zW={root:LW},BW={padding:"1rem",background:"{content.background}",gap:"0.5rem",transitionDuration:"{transition.duration}"},FW={color:"{text.muted.color}",hoverColor:"{text.color}",borderRadius:"{content.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",hoverColor:"{navigation.item.icon.focus.color}"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},NW={color:"{navigation.item.icon.color}"},VW={root:BW,item:FW,separator:NW},$W={borderRadius:"{form.field.border.radius}",roundedBorderRadius:"2rem",gap:"0.5rem",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",iconOnlyWidth:"2.5rem",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}",iconOnlyWidth:"2rem"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}",iconOnlyWidth:"3rem"},label:{fontWeight:"500"},raisedShadow:"0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"},badgeSize:"1rem",transitionDuration:"{form.field.transition.duration}"},jW={light:{root:{primary:{background:"{primary.color}",hoverBackground:"{primary.hover.color}",activeBackground:"{primary.active.color}",borderColor:"{primary.color}",hoverBorderColor:"{primary.hover.color}",activeBorderColor:"{primary.active.color}",color:"{primary.contrast.color}",hoverColor:"{primary.contrast.color}",activeColor:"{primary.contrast.color}",focusRing:{color:"{primary.color}",shadow:"none"}},secondary:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",borderColor:"{surface.100}",hoverBorderColor:"{surface.200}",activeBorderColor:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}",focusRing:{color:"{surface.600}",shadow:"none"}},info:{background:"{sky.500}",hoverBackground:"{sky.600}",activeBackground:"{sky.700}",borderColor:"{sky.500}",hoverBorderColor:"{sky.600}",activeBorderColor:"{sky.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{sky.500}",shadow:"none"}},success:{background:"{green.500}",hoverBackground:"{green.600}",activeBackground:"{green.700}",borderColor:"{green.500}",hoverBorderColor:"{green.600}",activeBorderColor:"{green.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{green.500}",shadow:"none"}},warn:{background:"{orange.500}",hoverBackground:"{orange.600}",activeBackground:"{orange.700}",borderColor:"{orange.500}",hoverBorderColor:"{orange.600}",activeBorderColor:"{orange.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{orange.500}",shadow:"none"}},help:{background:"{purple.500}",hoverBackground:"{purple.600}",activeBackground:"{purple.700}",borderColor:"{purple.500}",hoverBorderColor:"{purple.600}",activeBorderColor:"{purple.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{purple.500}",shadow:"none"}},danger:{background:"{red.500}",hoverBackground:"{red.600}",activeBackground:"{red.700}",borderColor:"{red.500}",hoverBorderColor:"{red.600}",activeBorderColor:"{red.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{red.500}",shadow:"none"}},contrast:{background:"{surface.950}",hoverBackground:"{surface.900}",activeBackground:"{surface.800}",borderColor:"{surface.950}",hoverBorderColor:"{surface.900}",activeBorderColor:"{surface.800}",color:"{surface.0}",hoverColor:"{surface.0}",activeColor:"{surface.0}",focusRing:{color:"{surface.950}",shadow:"none"}}},outlined:{primary:{hoverBackground:"{primary.50}",activeBackground:"{primary.100}",borderColor:"{primary.200}",color:"{primary.color}"},secondary:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.200}",color:"{surface.500}"},success:{hoverBackground:"{green.50}",activeBackground:"{green.100}",borderColor:"{green.200}",color:"{green.500}"},info:{hoverBackground:"{sky.50}",activeBackground:"{sky.100}",borderColor:"{sky.200}",color:"{sky.500}"},warn:{hoverBackground:"{orange.50}",activeBackground:"{orange.100}",borderColor:"{orange.200}",color:"{orange.500}"},help:{hoverBackground:"{purple.50}",activeBackground:"{purple.100}",borderColor:"{purple.200}",color:"{purple.500}"},danger:{hoverBackground:"{red.50}",activeBackground:"{red.100}",borderColor:"{red.200}",color:"{red.500}"},contrast:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.700}",color:"{surface.950}"},plain:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.200}",color:"{surface.700}"}},text:{primary:{hoverBackground:"{primary.50}",activeBackground:"{primary.100}",color:"{primary.color}"},secondary:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.500}"},success:{hoverBackground:"{green.50}",activeBackground:"{green.100}",color:"{green.500}"},info:{hoverBackground:"{sky.50}",activeBackground:"{sky.100}",color:"{sky.500}"},warn:{hoverBackground:"{orange.50}",activeBackground:"{orange.100}",color:"{orange.500}"},help:{hoverBackground:"{purple.50}",activeBackground:"{purple.100}",color:"{purple.500}"},danger:{hoverBackground:"{red.50}",activeBackground:"{red.100}",color:"{red.500}"},contrast:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.950}"},plain:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.700}"}},link:{color:"{primary.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"}},dark:{root:{primary:{background:"{primary.color}",hoverBackground:"{primary.hover.color}",activeBackground:"{primary.active.color}",borderColor:"{primary.color}",hoverBorderColor:"{primary.hover.color}",activeBorderColor:"{primary.active.color}",color:"{primary.contrast.color}",hoverColor:"{primary.contrast.color}",activeColor:"{primary.contrast.color}",focusRing:{color:"{primary.color}",shadow:"none"}},secondary:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",borderColor:"{surface.800}",hoverBorderColor:"{surface.700}",activeBorderColor:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}",focusRing:{color:"{surface.300}",shadow:"none"}},info:{background:"{sky.400}",hoverBackground:"{sky.300}",activeBackground:"{sky.200}",borderColor:"{sky.400}",hoverBorderColor:"{sky.300}",activeBorderColor:"{sky.200}",color:"{sky.950}",hoverColor:"{sky.950}",activeColor:"{sky.950}",focusRing:{color:"{sky.400}",shadow:"none"}},success:{background:"{green.400}",hoverBackground:"{green.300}",activeBackground:"{green.200}",borderColor:"{green.400}",hoverBorderColor:"{green.300}",activeBorderColor:"{green.200}",color:"{green.950}",hoverColor:"{green.950}",activeColor:"{green.950}",focusRing:{color:"{green.400}",shadow:"none"}},warn:{background:"{orange.400}",hoverBackground:"{orange.300}",activeBackground:"{orange.200}",borderColor:"{orange.400}",hoverBorderColor:"{orange.300}",activeBorderColor:"{orange.200}",color:"{orange.950}",hoverColor:"{orange.950}",activeColor:"{orange.950}",focusRing:{color:"{orange.400}",shadow:"none"}},help:{background:"{purple.400}",hoverBackground:"{purple.300}",activeBackground:"{purple.200}",borderColor:"{purple.400}",hoverBorderColor:"{purple.300}",activeBorderColor:"{purple.200}",color:"{purple.950}",hoverColor:"{purple.950}",activeColor:"{purple.950}",focusRing:{color:"{purple.400}",shadow:"none"}},danger:{background:"{red.400}",hoverBackground:"{red.300}",activeBackground:"{red.200}",borderColor:"{red.400}",hoverBorderColor:"{red.300}",activeBorderColor:"{red.200}",color:"{red.950}",hoverColor:"{red.950}",activeColor:"{red.950}",focusRing:{color:"{red.400}",shadow:"none"}},contrast:{background:"{surface.0}",hoverBackground:"{surface.100}",activeBackground:"{surface.200}",borderColor:"{surface.0}",hoverBorderColor:"{surface.100}",activeBorderColor:"{surface.200}",color:"{surface.950}",hoverColor:"{surface.950}",activeColor:"{surface.950}",focusRing:{color:"{surface.0}",shadow:"none"}}},outlined:{primary:{hoverBackground:"color-mix(in srgb, {primary.color}, transparent 96%)",activeBackground:"color-mix(in srgb, {primary.color}, transparent 84%)",borderColor:"{primary.700}",color:"{primary.color}"},secondary:{hoverBackground:"rgba(255,255,255,0.04)",activeBackground:"rgba(255,255,255,0.16)",borderColor:"{surface.700}",color:"{surface.400}"},success:{hoverBackground:"color-mix(in srgb, {green.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {green.400}, transparent 84%)",borderColor:"{green.700}",color:"{green.400}"},info:{hoverBackground:"color-mix(in srgb, {sky.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {sky.400}, transparent 84%)",borderColor:"{sky.700}",color:"{sky.400}"},warn:{hoverBackground:"color-mix(in srgb, {orange.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {orange.400}, transparent 84%)",borderColor:"{orange.700}",color:"{orange.400}"},help:{hoverBackground:"color-mix(in srgb, {purple.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {purple.400}, transparent 84%)",borderColor:"{purple.700}",color:"{purple.400}"},danger:{hoverBackground:"color-mix(in srgb, {red.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {red.400}, transparent 84%)",borderColor:"{red.700}",color:"{red.400}"},contrast:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{surface.500}",color:"{surface.0}"},plain:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{surface.600}",color:"{surface.0}"}},text:{primary:{hoverBackground:"color-mix(in srgb, {primary.color}, transparent 96%)",activeBackground:"color-mix(in srgb, {primary.color}, transparent 84%)",color:"{primary.color}"},secondary:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.400}"},success:{hoverBackground:"color-mix(in srgb, {green.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {green.400}, transparent 84%)",color:"{green.400}"},info:{hoverBackground:"color-mix(in srgb, {sky.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {sky.400}, transparent 84%)",color:"{sky.400}"},warn:{hoverBackground:"color-mix(in srgb, {orange.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {orange.400}, transparent 84%)",color:"{orange.400}"},help:{hoverBackground:"color-mix(in srgb, {purple.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {purple.400}, transparent 84%)",color:"{purple.400}"},danger:{hoverBackground:"color-mix(in srgb, {red.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {red.400}, transparent 84%)",color:"{red.400}"},contrast:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.0}"},plain:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.0}"}},link:{color:"{primary.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"}}},UW={root:$W,colorScheme:jW},HW={background:"{content.background}",borderRadius:"{border.radius.xl}",color:"{content.color}",shadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1)"},GW={padding:"1.25rem",gap:"0.5rem"},WW={gap:"0.5rem"},qW={fontSize:"1.25rem",fontWeight:"500"},ZW={color:"{text.muted.color}"},KW={root:HW,body:GW,caption:WW,title:qW,subtitle:ZW},XW={transitionDuration:"{transition.duration}"},YW={gap:"0.25rem"},JW={padding:"1rem",gap:"0.5rem"},QW={width:"2rem",height:"0.5rem",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},eq={light:{indicator:{background:"{surface.200}",hoverBackground:"{surface.300}",activeBackground:"{primary.color}"}},dark:{indicator:{background:"{surface.700}",hoverBackground:"{surface.600}",activeBackground:"{primary.color}"}}},tq={root:XW,content:YW,indicatorList:JW,indicator:QW,colorScheme:eq},nq={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},iq={width:"2.5rem",color:"{form.field.icon.color}"},rq={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},oq={padding:"{list.padding}",gap:"{list.gap}",mobileIndent:"1rem"},sq={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}",icon:{color:"{list.option.icon.color}",focusColor:"{list.option.icon.focus.color}",size:"0.875rem"}},aq={color:"{form.field.icon.color}"},lq={root:nq,dropdown:iq,overlay:rq,list:oq,option:sq,clearIcon:aq},cq={borderRadius:"{border.radius.sm}",width:"1.25rem",height:"1.25rem",background:"{form.field.background}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.border.color}",checkedBorderColor:"{primary.color}",checkedHoverBorderColor:"{primary.hover.color}",checkedFocusBorderColor:"{primary.color}",checkedDisabledBorderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{width:"1rem",height:"1rem"},lg:{width:"1.5rem",height:"1.5rem"}},uq={size:"0.875rem",color:"{form.field.color}",checkedColor:"{primary.contrast.color}",checkedHoverColor:"{primary.contrast.color}",disabledColor:"{form.field.disabled.color}",sm:{size:"0.75rem"},lg:{size:"1rem"}},dq={root:cq,icon:uq},hq={borderRadius:"16px",paddingX:"0.75rem",paddingY:"0.5rem",gap:"0.5rem",transitionDuration:"{transition.duration}"},fq={width:"2rem",height:"2rem"},pq={size:"1rem"},mq={size:"1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"}},gq={light:{root:{background:"{surface.100}",color:"{surface.800}"},icon:{color:"{surface.800}"},removeIcon:{color:"{surface.800}"}},dark:{root:{background:"{surface.800}",color:"{surface.0}"},icon:{color:"{surface.0}"},removeIcon:{color:"{surface.0}"}}},_q={root:hq,image:fq,icon:pq,removeIcon:mq,colorScheme:gq},yq={transitionDuration:"{transition.duration}"},vq={width:"1.5rem",height:"1.5rem",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},bq={shadow:"{overlay.popover.shadow}",borderRadius:"{overlay.popover.borderRadius}"},xq={light:{panel:{background:"{surface.800}",borderColor:"{surface.900}"},handle:{color:"{surface.0}"}},dark:{panel:{background:"{surface.900}",borderColor:"{surface.700}"},handle:{color:"{surface.0}"}}},wq={root:yq,preview:vq,panel:bq,colorScheme:xq},Sq={size:"2rem",color:"{overlay.modal.color}"},Cq={gap:"1rem"},Tq={icon:Sq,content:Cq},Eq={background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",color:"{overlay.popover.color}",borderRadius:"{overlay.popover.border.radius}",shadow:"{overlay.popover.shadow}",gutter:"10px",arrowOffset:"1.25rem"},Iq={padding:"{overlay.popover.padding}",gap:"1rem"},Aq={size:"1.5rem",color:"{overlay.popover.color}"},kq={gap:"0.5rem",padding:"0 {overlay.popover.padding} {overlay.popover.padding} {overlay.popover.padding}"},Rq={root:Eq,content:Iq,icon:Aq,footer:kq},Pq={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},Mq={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},Dq={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},Oq={mobileIndent:"1rem"},Lq={size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},zq={borderColor:"{content.border.color}"},Bq={root:Pq,list:Mq,item:Dq,submenu:Oq,submenuIcon:Lq,separator:zq},Fq={transitionDuration:"{transition.duration}"},Nq={background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},Vq={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{datatable.border.color}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",gap:"0.5rem",padding:"0.75rem 1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},$q={fontWeight:"600"},jq={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},Uq={borderColor:"{datatable.border.color}",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},Hq={background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},Gq={fontWeight:"600"},Wq={background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},qq={color:"{primary.color}"},Zq={width:"0.5rem"},Kq={width:"1px",color:"{primary.color}"},Xq={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",size:"0.875rem"},Yq={size:"2rem"},Jq={hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",selectedHoverColor:"{primary.color}",size:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Qq={inlineGap:"0.5rem",overlaySelect:{background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},overlayPopover:{background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",borderRadius:"{overlay.popover.border.radius}",color:"{overlay.popover.color}",shadow:"{overlay.popover.shadow}",padding:"{overlay.popover.padding}",gap:"0.5rem"},rule:{borderColor:"{content.border.color}"},constraintList:{padding:"{list.padding}",gap:"{list.gap}"},constraint:{focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",separator:{borderColor:"{content.border.color}"},padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"}},eZ={borderColor:"{datatable.border.color}",borderWidth:"0 0 1px 0"},tZ={borderColor:"{datatable.border.color}",borderWidth:"0 0 1px 0"},nZ={light:{root:{borderColor:"{content.border.color}"},row:{stripedBackground:"{surface.50}"},bodyCell:{selectedBorderColor:"{primary.100}"}},dark:{root:{borderColor:"{surface.800}"},row:{stripedBackground:"{surface.950}"},bodyCell:{selectedBorderColor:"{primary.900}"}}},iZ={root:Fq,header:Nq,headerCell:Vq,columnTitle:$q,row:jq,bodyCell:Uq,footerCell:Hq,columnFooter:Gq,footer:Wq,dropPoint:qq,columnResizer:Zq,resizeIndicator:Kq,sortIcon:Xq,loadingIcon:Yq,rowToggleButton:Jq,filter:Qq,paginatorTop:eZ,paginatorBottom:tZ,colorScheme:nZ},rZ={borderColor:"transparent",borderWidth:"0",borderRadius:"0",padding:"0"},oZ={background:"{content.background}",color:"{content.color}",borderColor:"{content.border.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",borderRadius:"0"},sZ={background:"{content.background}",color:"{content.color}",borderColor:"transparent",borderWidth:"0",padding:"0",borderRadius:"0"},aZ={background:"{content.background}",color:"{content.color}",borderColor:"{content.border.color}",borderWidth:"1px 0 0 0",padding:"0.75rem 1rem",borderRadius:"0"},lZ={borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},cZ={borderColor:"{content.border.color}",borderWidth:"1px 0 0 0"},uZ={root:rZ,header:oZ,content:sZ,footer:aZ,paginatorTop:lZ,paginatorBottom:cZ},dZ={transitionDuration:"{transition.duration}"},hZ={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.popover.shadow}",padding:"{overlay.popover.padding}"},fZ={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",padding:"0 0 0.5rem 0"},pZ={gap:"0.5rem",fontWeight:"500"},mZ={width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"},borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},gZ={color:"{form.field.icon.color}"},_Z={hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}"},yZ={hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}"},vZ={borderColor:"{content.border.color}",gap:"{overlay.popover.padding}"},bZ={margin:"0.5rem 0 0 0"},xZ={padding:"0.25rem",fontWeight:"500",color:"{content.color}"},wZ={hoverBackground:"{content.hover.background}",selectedBackground:"{primary.color}",rangeSelectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{primary.contrast.color}",rangeSelectedColor:"{highlight.color}",width:"2rem",height:"2rem",borderRadius:"50%",padding:"0.25rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},SZ={margin:"0.5rem 0 0 0"},CZ={padding:"0.375rem",borderRadius:"{content.border.radius}"},TZ={margin:"0.5rem 0 0 0"},EZ={padding:"0.375rem",borderRadius:"{content.border.radius}"},IZ={padding:"0.5rem 0 0 0",borderColor:"{content.border.color}"},AZ={padding:"0.5rem 0 0 0",borderColor:"{content.border.color}",gap:"0.5rem",buttonGap:"0.25rem"},kZ={light:{dropdown:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}"},today:{background:"{surface.200}",color:"{surface.900}"}},dark:{dropdown:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}"},today:{background:"{surface.700}",color:"{surface.0}"}}},RZ={root:dZ,panel:hZ,header:fZ,title:pZ,dropdown:mZ,inputIcon:gZ,selectMonth:_Z,selectYear:yZ,group:vZ,dayView:bZ,weekDay:xZ,date:wZ,monthView:SZ,month:CZ,yearView:TZ,year:EZ,buttonbar:IZ,timePicker:AZ,colorScheme:kZ},PZ={background:"{overlay.modal.background}",borderColor:"{overlay.modal.border.color}",color:"{overlay.modal.color}",borderRadius:"{overlay.modal.border.radius}",shadow:"{overlay.modal.shadow}"},MZ={padding:"{overlay.modal.padding}",gap:"0.5rem"},DZ={fontSize:"1.25rem",fontWeight:"600"},OZ={padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}"},LZ={padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}",gap:"0.5rem"},zZ={root:PZ,header:MZ,title:DZ,content:OZ,footer:LZ},BZ={borderColor:"{content.border.color}"},FZ={background:"{content.background}",color:"{text.color}"},NZ={margin:"1rem 0",padding:"0 1rem",content:{padding:"0 0.5rem"}},VZ={margin:"0 1rem",padding:"0.5rem 0",content:{padding:"0.5rem 0"}},$Z={root:BZ,content:FZ,horizontal:NZ,vertical:VZ},jZ={background:"rgba(255, 255, 255, 0.1)",borderColor:"rgba(255, 255, 255, 0.2)",padding:"0.5rem",borderRadius:"{border.radius.xl}"},UZ={borderRadius:"{content.border.radius}",padding:"0.5rem",size:"3rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},HZ={root:jZ,item:UZ},GZ={background:"{overlay.modal.background}",borderColor:"{overlay.modal.border.color}",color:"{overlay.modal.color}",shadow:"{overlay.modal.shadow}"},WZ={padding:"{overlay.modal.padding}"},qZ={fontSize:"1.5rem",fontWeight:"600"},ZZ={padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}"},KZ={padding:"{overlay.modal.padding}"},XZ={root:GZ,header:WZ,title:qZ,content:ZZ,footer:KZ},YZ={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}"},JZ={color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},QZ={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}",padding:"{list.padding}"},eK={focusBackground:"{list.option.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},tK={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"},nK={toolbar:YZ,toolbarItem:JZ,overlay:QZ,overlayOption:eK,content:tK},iK={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",padding:"0 1.125rem 1.125rem 1.125rem",transitionDuration:"{transition.duration}"},rK={background:"{content.background}",hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",borderRadius:"{content.border.radius}",borderWidth:"1px",borderColor:"transparent",padding:"0.5rem 0.75rem",gap:"0.5rem",fontWeight:"600",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},oK={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}"},sK={padding:"0"},aK={root:iK,legend:rK,toggleIcon:oK,content:sK},lK={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",transitionDuration:"{transition.duration}"},cK={background:"transparent",color:"{text.color}",padding:"1.125rem",borderColor:"unset",borderWidth:"0",borderRadius:"0",gap:"0.5rem"},uK={highlightBorderColor:"{primary.color}",padding:"0 1.125rem 1.125rem 1.125rem",gap:"1rem"},dK={padding:"1rem",gap:"1rem",borderColor:"{content.border.color}",info:{gap:"0.5rem"}},hK={gap:"0.5rem"},fK={height:"0.25rem"},pK={gap:"0.5rem"},mK={root:lK,header:cK,content:uK,file:dK,fileList:hK,progressbar:fK,basic:pK},gK={color:"{form.field.float.label.color}",focusColor:"{form.field.float.label.focus.color}",activeColor:"{form.field.float.label.active.color}",invalidColor:"{form.field.float.label.invalid.color}",transitionDuration:"0.2s",positionX:"{form.field.padding.x}",positionY:"{form.field.padding.y}",fontWeight:"500",active:{fontSize:"0.75rem",fontWeight:"400"}},_K={active:{top:"-1.25rem"}},yK={input:{paddingTop:"1.5rem",paddingBottom:"{form.field.padding.y}"},active:{top:"{form.field.padding.y}"}},vK={borderRadius:"{border.radius.xs}",active:{background:"{form.field.background}",padding:"0 0.125rem"}},bK={root:gK,over:_K,in:yK,on:vK},xK={borderWidth:"1px",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",transitionDuration:"{transition.duration}"},wK={background:"rgba(255, 255, 255, 0.1)",hoverBackground:"rgba(255, 255, 255, 0.2)",color:"{surface.100}",hoverColor:"{surface.0}",size:"3rem",gutter:"0.5rem",prev:{borderRadius:"50%"},next:{borderRadius:"50%"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},SK={size:"1.5rem"},CK={background:"{content.background}",padding:"1rem 0.25rem"},TK={size:"2rem",borderRadius:"{content.border.radius}",gutter:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},EK={size:"1rem"},IK={background:"rgba(0, 0, 0, 0.5)",color:"{surface.100}",padding:"1rem"},AK={gap:"0.5rem",padding:"1rem"},kK={width:"1rem",height:"1rem",activeBackground:"{primary.color}",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},RK={background:"rgba(0, 0, 0, 0.5)"},PK={background:"rgba(255, 255, 255, 0.4)",hoverBackground:"rgba(255, 255, 255, 0.6)",activeBackground:"rgba(255, 255, 255, 0.9)"},MK={size:"3rem",gutter:"0.5rem",background:"rgba(255, 255, 255, 0.1)",hoverBackground:"rgba(255, 255, 255, 0.2)",color:"{surface.50}",hoverColor:"{surface.0}",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},DK={size:"1.5rem"},OK={light:{thumbnailNavButton:{hoverBackground:"{surface.100}",color:"{surface.600}",hoverColor:"{surface.700}"},indicatorButton:{background:"{surface.200}",hoverBackground:"{surface.300}"}},dark:{thumbnailNavButton:{hoverBackground:"{surface.700}",color:"{surface.400}",hoverColor:"{surface.0}"},indicatorButton:{background:"{surface.700}",hoverBackground:"{surface.600}"}}},LK={root:xK,navButton:wK,navIcon:SK,thumbnailsContent:CK,thumbnailNavButton:TK,thumbnailNavButtonIcon:EK,caption:IK,indicatorList:AK,indicatorButton:kK,insetIndicatorList:RK,insetIndicatorButton:PK,closeButton:MK,closeButtonIcon:DK,colorScheme:OK},zK={color:"{form.field.icon.color}"},BK={icon:zK},FK={color:"{form.field.float.label.color}",focusColor:"{form.field.float.label.focus.color}",invalidColor:"{form.field.float.label.invalid.color}",transitionDuration:"0.2s",positionX:"{form.field.padding.x}",top:"{form.field.padding.y}",fontSize:"0.75rem",fontWeight:"400"},NK={paddingTop:"1.5rem",paddingBottom:"{form.field.padding.y}"},VK={root:FK,input:NK},$K={transitionDuration:"{transition.duration}"},jK={icon:{size:"1.5rem"},mask:{background:"{mask.background}",color:"{mask.color}"}},UK={position:{left:"auto",right:"1rem",top:"1rem",bottom:"auto"},blur:"8px",background:"rgba(255,255,255,0.1)",borderColor:"rgba(255,255,255,0.2)",borderWidth:"1px",borderRadius:"30px",padding:".5rem",gap:"0.5rem"},HK={hoverBackground:"rgba(255,255,255,0.1)",color:"{surface.50}",hoverColor:"{surface.0}",size:"3rem",iconSize:"1.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},GK={root:$K,preview:jK,toolbar:UK,action:HK},WK={size:"15px",hoverSize:"30px",background:"rgba(255,255,255,0.3)",hoverBackground:"rgba(255,255,255,0.3)",borderColor:"unset",hoverBorderColor:"unset",borderWidth:"0",borderRadius:"50%",transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"rgba(255,255,255,0.3)",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},qK={handle:WK},ZK={padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{content.border.radius}",gap:"0.5rem"},KK={fontWeight:"500"},XK={size:"1rem"},YK={light:{info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)"},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)"},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)"},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)"},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)"},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)"}},dark:{info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)"},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)"},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)"},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)"},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)"},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)"}}},JK={root:ZK,text:KK,icon:XK,colorScheme:YK},QK={padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{transition.duration}"},eX={hoverBackground:"{content.hover.background}",hoverColor:"{content.hover.color}"},tX={root:QK,display:eX},nX={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}"},iX={borderRadius:"{border.radius.sm}"},rX={light:{chip:{focusBackground:"{surface.200}",color:"{surface.800}"}},dark:{chip:{focusBackground:"{surface.700}",color:"{surface.0}"}}},oX={root:nX,chip:iX,colorScheme:rX},sX={background:"{form.field.background}",borderColor:"{form.field.border.color}",color:"{form.field.icon.color}",borderRadius:"{form.field.border.radius}",padding:"0.5rem",minWidth:"2.5rem"},aX={addon:sX},lX={transitionDuration:"{transition.duration}"},cX={width:"2.5rem",borderRadius:"{form.field.border.radius}",verticalPadding:"{form.field.padding.y}"},uX={light:{button:{background:"transparent",hoverBackground:"{surface.100}",activeBackground:"{surface.200}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",color:"{surface.400}",hoverColor:"{surface.500}",activeColor:"{surface.600}"}},dark:{button:{background:"transparent",hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",color:"{surface.400}",hoverColor:"{surface.300}",activeColor:"{surface.200}"}}},dX={root:lX,button:cX,colorScheme:uX},hX={gap:"0.5rem"},fX={width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"}},pX={root:hX,input:fX},mX={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},gX={root:mX},_X={transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},yX={background:"{primary.color}"},vX={background:"{content.border.color}"},bX={color:"{text.muted.color}"},xX={root:_X,value:yX,range:vX,text:bX},wX={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",borderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",shadow:"{form.field.shadow}",borderRadius:"{form.field.border.radius}",transitionDuration:"{form.field.transition.duration}"},SX={padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},CX={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},TX={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},EX={color:"{list.option.color}",gutterStart:"-0.375rem",gutterEnd:"0.375rem"},IX={padding:"{list.option.padding}"},AX={light:{option:{stripedBackground:"{surface.50}"}},dark:{option:{stripedBackground:"{surface.900}"}}},kX={root:wX,list:SX,option:CX,optionGroup:TX,checkmark:EX,emptyMessage:IX,colorScheme:AX},RX={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",verticalOrientation:{padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},horizontalOrientation:{padding:"0.5rem 0.75rem",gap:"0.5rem"},transitionDuration:"{transition.duration}"},PX={borderRadius:"{content.border.radius}",padding:"{navigation.item.padding}"},MX={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},DX={padding:"0",background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",shadow:"{overlay.navigation.shadow}",gap:"0.5rem"},OX={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},LX={padding:"{navigation.submenu.label.padding}",fontWeight:"{navigation.submenu.label.font.weight}",background:"{navigation.submenu.label.background.}",color:"{navigation.submenu.label.color}"},zX={size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},BX={borderColor:"{content.border.color}"},FX={borderRadius:"50%",size:"1.75rem",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",hoverBackground:"{content.hover.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},NX={root:RX,baseItem:PX,item:MX,overlay:DX,submenu:OX,submenuLabel:LX,submenuIcon:zX,separator:BX,mobileButton:FX},VX={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},$X={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},jX={focusBackground:"{navigation.item.focus.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}"}},UX={padding:"{navigation.submenu.label.padding}",fontWeight:"{navigation.submenu.label.font.weight}",background:"{navigation.submenu.label.background}",color:"{navigation.submenu.label.color}"},HX={borderColor:"{content.border.color}"},GX={root:VX,list:$X,item:jX,submenuLabel:UX,separator:HX},WX={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",padding:"0.5rem 0.75rem",transitionDuration:"{transition.duration}"},qX={borderRadius:"{content.border.radius}",padding:"{navigation.item.padding}"},ZX={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},KX={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}",background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",mobileIndent:"1rem",icon:{size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"}},XX={borderColor:"{content.border.color}"},YX={borderRadius:"50%",size:"1.75rem",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",hoverBackground:"{content.hover.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},JX={root:WX,baseItem:qX,item:ZX,submenu:KX,separator:XX,mobileButton:YX},QX={borderRadius:"{content.border.radius}",borderWidth:"1px",transitionDuration:"{transition.duration}"},eY={padding:"0.5rem 0.75rem",gap:"0.5rem",sm:{padding:"0.375rem 0.625rem"},lg:{padding:"0.625rem 0.875rem"}},tY={fontSize:"1rem",fontWeight:"500",sm:{fontSize:"0.875rem"},lg:{fontSize:"1.125rem"}},nY={size:"1.125rem",sm:{size:"1rem"},lg:{size:"1.25rem"}},iY={width:"1.75rem",height:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"}},rY={size:"1rem",sm:{size:"0.875rem"},lg:{size:"1.125rem"}},oY={root:{borderWidth:"1px"}},sY={content:{padding:"0"}},aY={light:{info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"{blue.100}",focusRing:{color:"{blue.600}",shadow:"none"}},outlined:{color:"{blue.600}",borderColor:"{blue.600}"},simple:{color:"{blue.600}"}},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"{green.100}",focusRing:{color:"{green.600}",shadow:"none"}},outlined:{color:"{green.600}",borderColor:"{green.600}"},simple:{color:"{green.600}"}},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"{yellow.100}",focusRing:{color:"{yellow.600}",shadow:"none"}},outlined:{color:"{yellow.600}",borderColor:"{yellow.600}"},simple:{color:"{yellow.600}"}},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"{red.100}",focusRing:{color:"{red.600}",shadow:"none"}},outlined:{color:"{red.600}",borderColor:"{red.600}"},simple:{color:"{red.600}"}},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.200}",focusRing:{color:"{surface.600}",shadow:"none"}},outlined:{color:"{surface.500}",borderColor:"{surface.500}"},simple:{color:"{surface.500}"}},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.800}",focusRing:{color:"{surface.50}",shadow:"none"}},outlined:{color:"{surface.950}",borderColor:"{surface.950}"},simple:{color:"{surface.950}"}}},dark:{info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{blue.500}",shadow:"none"}},outlined:{color:"{blue.500}",borderColor:"{blue.500}"},simple:{color:"{blue.500}"}},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{green.500}",shadow:"none"}},outlined:{color:"{green.500}",borderColor:"{green.500}"},simple:{color:"{green.500}"}},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{yellow.500}",shadow:"none"}},outlined:{color:"{yellow.500}",borderColor:"{yellow.500}"},simple:{color:"{yellow.500}"}},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{red.500}",shadow:"none"}},outlined:{color:"{red.500}",borderColor:"{red.500}"},simple:{color:"{red.500}"}},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.700}",focusRing:{color:"{surface.300}",shadow:"none"}},outlined:{color:"{surface.400}",borderColor:"{surface.400}"},simple:{color:"{surface.400}"}},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.100}",focusRing:{color:"{surface.950}",shadow:"none"}},outlined:{color:"{surface.0}",borderColor:"{surface.0}"},simple:{color:"{surface.0}"}}}},lY={root:QX,content:eY,text:tY,icon:nY,closeButton:iY,closeIcon:rY,outlined:oY,simple:sY,colorScheme:aY},cY={borderRadius:"{content.border.radius}",gap:"1rem"},uY={background:"{content.border.color}",size:"0.5rem"},dY={gap:"0.5rem"},hY={size:"0.5rem"},fY={size:"1rem"},pY={verticalGap:"0.5rem",horizontalGap:"1rem"},mY={root:cY,meters:uY,label:dY,labelMarker:hY,labelIcon:fY,labelList:pY},gY={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},_Y={width:"2.5rem",color:"{form.field.icon.color}"},yY={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},vY={padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},bY={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}",gap:"0.5rem"},xY={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},wY={color:"{form.field.icon.color}"},SY={borderRadius:"{border.radius.sm}"},CY={padding:"{list.option.padding}"},TY={root:gY,dropdown:_Y,overlay:yY,list:vY,option:bY,optionGroup:xY,chip:SY,clearIcon:wY,emptyMessage:CY},EY={gap:"1.125rem"},IY={gap:"0.5rem"},AY={root:EY,controls:IY},kY={gutter:"0.75rem",transitionDuration:"{transition.duration}"},RY={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{content.border.color}",color:"{content.color}",selectedColor:"{highlight.color}",hoverColor:"{content.hover.color}",padding:"0.75rem 1rem",toggleablePadding:"0.75rem 1rem 1.25rem 1rem",borderRadius:"{content.border.radius}"},PY={background:"{content.background}",hoverBackground:"{content.hover.background}",borderColor:"{content.border.color}",color:"{text.muted.color}",hoverColor:"{text.color}",size:"1.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},MY={color:"{content.border.color}",borderRadius:"{content.border.radius}",height:"24px"},DY={root:kY,node:RY,nodeToggleButton:PY,connector:MY},OY={outline:{width:"2px",color:"{content.background}"}},LY={root:OY},zY={padding:"0.5rem 1rem",gap:"0.25rem",borderRadius:"{content.border.radius}",background:"{content.background}",color:"{content.color}",transitionDuration:"{transition.duration}"},BY={background:"transparent",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedColor:"{highlight.color}",width:"2.5rem",height:"2.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},FY={color:"{text.muted.color}"},NY={maxWidth:"2.5rem"},VY={root:zY,navButton:BY,currentPageReport:FY,jumpToPageInput:NY},$Y={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"},jY={background:"transparent",color:"{text.color}",padding:"1.125rem",borderColor:"{content.border.color}",borderWidth:"0",borderRadius:"0"},UY={padding:"0.375rem 1.125rem"},HY={fontWeight:"600"},GY={padding:"0 1.125rem 1.125rem 1.125rem"},WY={padding:"0 1.125rem 1.125rem 1.125rem"},qY={root:$Y,header:jY,toggleableHeader:UY,title:HY,content:GY,footer:WY},ZY={gap:"0.5rem",transitionDuration:"{transition.duration}"},KY={background:"{content.background}",borderColor:"{content.border.color}",borderWidth:"1px",color:"{content.color}",padding:"0.25rem 0.25rem",borderRadius:"{content.border.radius}",first:{borderWidth:"1px",topBorderRadius:"{content.border.radius}"},last:{borderWidth:"1px",bottomBorderRadius:"{content.border.radius}"}},XY={focusBackground:"{navigation.item.focus.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",gap:"0.5rem",padding:"{navigation.item.padding}",borderRadius:"{content.border.radius}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}"}},YY={indent:"1rem"},JY={color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}"},QY={root:ZY,panel:KY,item:XY,submenu:YY,submenuIcon:JY},eJ={background:"{content.border.color}",borderRadius:"{content.border.radius}",height:".75rem"},tJ={color:"{form.field.icon.color}"},nJ={background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",borderRadius:"{overlay.popover.border.radius}",color:"{overlay.popover.color}",padding:"{overlay.popover.padding}",shadow:"{overlay.popover.shadow}"},iJ={gap:"0.5rem"},rJ={light:{strength:{weakBackground:"{red.500}",mediumBackground:"{amber.500}",strongBackground:"{green.500}"}},dark:{strength:{weakBackground:"{red.400}",mediumBackground:"{amber.400}",strongBackground:"{green.400}"}}},oJ={meter:eJ,icon:tJ,overlay:nJ,content:iJ,colorScheme:rJ},sJ={gap:"1.125rem"},aJ={gap:"0.5rem"},lJ={root:sJ,controls:aJ},cJ={background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",color:"{overlay.popover.color}",borderRadius:"{overlay.popover.border.radius}",shadow:"{overlay.popover.shadow}",gutter:"10px",arrowOffset:"1.25rem"},uJ={padding:"{overlay.popover.padding}"},dJ={root:cJ,content:uJ},hJ={background:"{content.border.color}",borderRadius:"{content.border.radius}",height:"1.25rem"},fJ={background:"{primary.color}"},pJ={color:"{primary.contrast.color}",fontSize:"0.75rem",fontWeight:"600"},mJ={root:hJ,value:fJ,label:pJ},gJ={light:{root:{colorOne:"{red.500}",colorTwo:"{blue.500}",colorThree:"{green.500}",colorFour:"{yellow.500}"}},dark:{root:{colorOne:"{red.400}",colorTwo:"{blue.400}",colorThree:"{green.400}",colorFour:"{yellow.400}"}}},_J={colorScheme:gJ},yJ={width:"1.25rem",height:"1.25rem",background:"{form.field.background}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.border.color}",checkedBorderColor:"{primary.color}",checkedHoverBorderColor:"{primary.hover.color}",checkedFocusBorderColor:"{primary.color}",checkedDisabledBorderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{width:"1rem",height:"1rem"},lg:{width:"1.5rem",height:"1.5rem"}},vJ={size:"0.75rem",checkedColor:"{primary.contrast.color}",checkedHoverColor:"{primary.contrast.color}",disabledColor:"{form.field.disabled.color}",sm:{size:"0.5rem"},lg:{size:"1rem"}},bJ={root:yJ,icon:vJ},xJ={gap:"0.25rem",transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},wJ={size:"1rem",color:"{text.muted.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"},SJ={root:xJ,icon:wJ},CJ={light:{root:{background:"rgba(0,0,0,0.1)"}},dark:{root:{background:"rgba(255,255,255,0.3)"}}},TJ={colorScheme:CJ},EJ={transitionDuration:"{transition.duration}"},IJ={size:"9px",borderRadius:"{border.radius.sm}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},AJ={light:{bar:{background:"{surface.100}"}},dark:{bar:{background:"{surface.800}"}}},kJ={root:EJ,bar:IJ,colorScheme:AJ},RJ={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},PJ={width:"2.5rem",color:"{form.field.icon.color}"},MJ={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},DJ={padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},OJ={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},LJ={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},zJ={color:"{form.field.icon.color}"},BJ={color:"{list.option.color}",gutterStart:"-0.375rem",gutterEnd:"0.375rem"},FJ={padding:"{list.option.padding}"},NJ={root:RJ,dropdown:PJ,overlay:MJ,list:DJ,option:OJ,optionGroup:LJ,clearIcon:zJ,checkmark:BJ,emptyMessage:FJ},VJ={borderRadius:"{form.field.border.radius}"},$J={light:{root:{invalidBorderColor:"{form.field.invalid.border.color}"}},dark:{root:{invalidBorderColor:"{form.field.invalid.border.color}"}}},jJ={root:VJ,colorScheme:$J},UJ={borderRadius:"{content.border.radius}"},HJ={light:{root:{background:"{surface.200}",animationBackground:"rgba(255,255,255,0.4)"}},dark:{root:{background:"rgba(255, 255, 255, 0.06)",animationBackground:"rgba(255, 255, 255, 0.04)"}}},GJ={root:UJ,colorScheme:HJ},WJ={transitionDuration:"{transition.duration}"},qJ={background:"{content.border.color}",borderRadius:"{content.border.radius}",size:"3px"},ZJ={background:"{primary.color}"},KJ={width:"20px",height:"20px",borderRadius:"50%",background:"{content.border.color}",hoverBackground:"{content.border.color}",content:{borderRadius:"50%",hoverBackground:"{content.background}",width:"16px",height:"16px",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.08), 0px 1px 1px 0px rgba(0, 0, 0, 0.14)"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},XJ={light:{handle:{content:{background:"{surface.0}"}}},dark:{handle:{content:{background:"{surface.950}"}}}},YJ={root:WJ,track:qJ,range:ZJ,handle:KJ,colorScheme:XJ},JJ={gap:"0.5rem",transitionDuration:"{transition.duration}"},QJ={root:JJ},eQ={borderRadius:"{form.field.border.radius}",roundedBorderRadius:"2rem",raisedShadow:"0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)"},tQ={root:eQ},nQ={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",transitionDuration:"{transition.duration}"},iQ={background:"{content.border.color}"},rQ={size:"24px",background:"transparent",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},oQ={root:nQ,gutter:iQ,handle:rQ},sQ={transitionDuration:"{transition.duration}"},aQ={background:"{content.border.color}",activeBackground:"{primary.color}",margin:"0 0 0 1.625rem",size:"2px"},lQ={padding:"0.5rem",gap:"1rem"},cQ={padding:"0",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},gap:"0.5rem"},uQ={color:"{text.muted.color}",activeColor:"{primary.color}",fontWeight:"500"},dQ={background:"{content.background}",activeBackground:"{content.background}",borderColor:"{content.border.color}",activeBorderColor:"{content.border.color}",color:"{text.muted.color}",activeColor:"{primary.color}",size:"2rem",fontSize:"1.143rem",fontWeight:"500",borderRadius:"50%",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"},hQ={padding:"0.875rem 0.5rem 1.125rem 0.5rem"},fQ={background:"{content.background}",color:"{content.color}",padding:"0",indent:"1rem"},pQ={root:sQ,separator:aQ,step:lQ,stepHeader:cQ,stepTitle:uQ,stepNumber:dQ,steppanels:hQ,steppanel:fQ},mQ={transitionDuration:"{transition.duration}"},gQ={background:"{content.border.color}"},_Q={borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},gap:"0.5rem"},yQ={color:"{text.muted.color}",activeColor:"{primary.color}",fontWeight:"500"},vQ={background:"{content.background}",activeBackground:"{content.background}",borderColor:"{content.border.color}",activeBorderColor:"{content.border.color}",color:"{text.muted.color}",activeColor:"{primary.color}",size:"2rem",fontSize:"1.143rem",fontWeight:"500",borderRadius:"50%",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"},bQ={root:mQ,separator:gQ,itemLink:_Q,itemLabel:yQ,itemNumber:vQ},xQ={transitionDuration:"{transition.duration}"},wQ={borderWidth:"0 0 1px 0",background:"{content.background}",borderColor:"{content.border.color}"},SQ={background:"transparent",hoverBackground:"transparent",activeBackground:"transparent",borderWidth:"0 0 1px 0",borderColor:"{content.border.color}",hoverBorderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}",padding:"1rem 1.125rem",fontWeight:"600",margin:"0 0 -1px 0",gap:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},CQ={color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},TQ={height:"1px",bottom:"-1px",background:"{primary.color}"},EQ={root:xQ,tablist:wQ,item:SQ,itemIcon:CQ,activeBar:TQ},IQ={transitionDuration:"{transition.duration}"},AQ={borderWidth:"0 0 1px 0",background:"{content.background}",borderColor:"{content.border.color}"},kQ={background:"transparent",hoverBackground:"transparent",activeBackground:"transparent",borderWidth:"0 0 1px 0",borderColor:"{content.border.color}",hoverBorderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}",padding:"1rem 1.125rem",fontWeight:"600",margin:"0 0 -1px 0",gap:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},RQ={background:"{content.background}",color:"{content.color}",padding:"0.875rem 1.125rem 1.125rem 1.125rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"inset {focus.ring.shadow}"}},PQ={background:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",width:"2.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},MQ={height:"1px",bottom:"-1px",background:"{primary.color}"},DQ={light:{navButton:{shadow:"0px 0px 10px 50px rgba(255, 255, 255, 0.6)"}},dark:{navButton:{shadow:"0px 0px 10px 50px color-mix(in srgb, {content.background}, transparent 50%)"}}},OQ={root:IQ,tablist:AQ,tab:kQ,tabpanel:RQ,navButton:PQ,activeBar:MQ,colorScheme:DQ},LQ={transitionDuration:"{transition.duration}"},zQ={background:"{content.background}",borderColor:"{content.border.color}"},BQ={borderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},FQ={background:"{content.background}",color:"{content.color}"},NQ={background:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}"},VQ={light:{navButton:{shadow:"0px 0px 10px 50px rgba(255, 255, 255, 0.6)"}},dark:{navButton:{shadow:"0px 0px 10px 50px color-mix(in srgb, {content.background}, transparent 50%)"}}},$Q={root:LQ,tabList:zQ,tab:BQ,tabPanel:FQ,navButton:NQ,colorScheme:VQ},jQ={fontSize:"0.875rem",fontWeight:"700",padding:"0.25rem 0.5rem",gap:"0.25rem",borderRadius:"{content.border.radius}",roundedBorderRadius:"{border.radius.xl}"},UQ={size:"0.75rem"},HQ={light:{primary:{background:"{primary.100}",color:"{primary.700}"},secondary:{background:"{surface.100}",color:"{surface.600}"},success:{background:"{green.100}",color:"{green.700}"},info:{background:"{sky.100}",color:"{sky.700}"},warn:{background:"{orange.100}",color:"{orange.700}"},danger:{background:"{red.100}",color:"{red.700}"},contrast:{background:"{surface.950}",color:"{surface.0}"}},dark:{primary:{background:"color-mix(in srgb, {primary.500}, transparent 84%)",color:"{primary.300}"},secondary:{background:"{surface.800}",color:"{surface.300}"},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",color:"{green.300}"},info:{background:"color-mix(in srgb, {sky.500}, transparent 84%)",color:"{sky.300}"},warn:{background:"color-mix(in srgb, {orange.500}, transparent 84%)",color:"{orange.300}"},danger:{background:"color-mix(in srgb, {red.500}, transparent 84%)",color:"{red.300}"},contrast:{background:"{surface.0}",color:"{surface.950}"}}},GQ={root:jQ,icon:UQ,colorScheme:HQ},WQ={background:"{form.field.background}",borderColor:"{form.field.border.color}",color:"{form.field.color}",height:"18rem",padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{form.field.border.radius}"},qQ={gap:"0.25rem"},ZQ={margin:"2px 0"},KQ={root:WQ,prompt:qQ,commandResponse:ZQ},XQ={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},YQ={root:XQ},JQ={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},QQ={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},eee={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},tee={mobileIndent:"1rem"},nee={size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},iee={borderColor:"{content.border.color}"},ree={root:JQ,list:QQ,item:eee,submenu:tee,submenuIcon:nee,separator:iee},oee={minHeight:"5rem"},see={eventContent:{padding:"1rem 0"}},aee={eventContent:{padding:"0 1rem"}},lee={size:"1.125rem",borderRadius:"50%",borderWidth:"2px",background:"{content.background}",borderColor:"{content.border.color}",content:{borderRadius:"50%",size:"0.375rem",background:"{primary.color}",insetShadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"}},cee={color:"{content.border.color}",size:"2px"},uee={event:oee,horizontal:see,vertical:aee,eventMarker:lee,eventConnector:cee},dee={width:"25rem",borderRadius:"{content.border.radius}",borderWidth:"1px",transitionDuration:"{transition.duration}"},hee={size:"1.125rem"},fee={padding:"{overlay.popover.padding}",gap:"0.5rem"},pee={gap:"0.5rem"},mee={fontWeight:"500",fontSize:"1rem"},gee={fontWeight:"500",fontSize:"0.875rem"},_ee={width:"1.75rem",height:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"}},yee={size:"1rem"},vee={light:{root:{blur:"1.5px"},info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"{blue.100}",focusRing:{color:"{blue.600}",shadow:"none"}}},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"{green.100}",focusRing:{color:"{green.600}",shadow:"none"}}},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"{yellow.100}",focusRing:{color:"{yellow.600}",shadow:"none"}}},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"{red.100}",focusRing:{color:"{red.600}",shadow:"none"}}},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.200}",focusRing:{color:"{surface.600}",shadow:"none"}}},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.800}",focusRing:{color:"{surface.50}",shadow:"none"}}}},dark:{root:{blur:"10px"},info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{blue.500}",shadow:"none"}}},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{green.500}",shadow:"none"}}},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{yellow.500}",shadow:"none"}}},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{red.500}",shadow:"none"}}},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.700}",focusRing:{color:"{surface.300}",shadow:"none"}}},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",detailColor:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.100}",focusRing:{color:"{surface.950}",shadow:"none"}}}}},bee={root:dee,icon:hee,content:fee,text:pee,summary:mee,detail:gee,closeButton:_ee,closeIcon:yee,colorScheme:vee},xee={padding:"0.25rem",borderRadius:"{content.border.radius}",gap:"0.5rem",fontWeight:"500",disabledBackground:"{form.field.disabled.background}",disabledBorderColor:"{form.field.disabled.background}",disabledColor:"{form.field.disabled.color}",invalidBorderColor:"{form.field.invalid.border.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",padding:"0.25rem"},lg:{fontSize:"{form.field.lg.font.size}",padding:"0.25rem"}},wee={disabledColor:"{form.field.disabled.color}"},See={padding:"0.25rem 0.75rem",borderRadius:"{content.border.radius}",checkedShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.02), 0px 1px 2px 0px rgba(0, 0, 0, 0.04)",sm:{padding:"0.25rem 0.75rem"},lg:{padding:"0.25rem 0.75rem"}},Cee={light:{root:{background:"{surface.100}",checkedBackground:"{surface.100}",hoverBackground:"{surface.100}",borderColor:"{surface.100}",color:"{surface.500}",hoverColor:"{surface.700}",checkedColor:"{surface.900}",checkedBorderColor:"{surface.100}"},content:{checkedBackground:"{surface.0}"},icon:{color:"{surface.500}",hoverColor:"{surface.700}",checkedColor:"{surface.900}"}},dark:{root:{background:"{surface.950}",checkedBackground:"{surface.950}",hoverBackground:"{surface.950}",borderColor:"{surface.950}",color:"{surface.400}",hoverColor:"{surface.300}",checkedColor:"{surface.0}",checkedBorderColor:"{surface.950}"},content:{checkedBackground:"{surface.800}"},icon:{color:"{surface.400}",hoverColor:"{surface.300}",checkedColor:"{surface.0}"}}},Tee={root:xee,icon:wee,content:See,colorScheme:Cee},Eee={width:"2.5rem",height:"1.5rem",borderRadius:"30px",gap:"0.25rem",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},borderWidth:"1px",borderColor:"transparent",hoverBorderColor:"transparent",checkedBorderColor:"transparent",checkedHoverBorderColor:"transparent",invalidBorderColor:"{form.field.invalid.border.color}",transitionDuration:"{form.field.transition.duration}",slideDuration:"0.2s"},Iee={borderRadius:"50%",size:"1rem"},Aee={light:{root:{background:"{surface.300}",disabledBackground:"{form.field.disabled.background}",hoverBackground:"{surface.400}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}"},handle:{background:"{surface.0}",disabledBackground:"{form.field.disabled.color}",hoverBackground:"{surface.0}",checkedBackground:"{surface.0}",checkedHoverBackground:"{surface.0}",color:"{text.muted.color}",hoverColor:"{text.color}",checkedColor:"{primary.color}",checkedHoverColor:"{primary.hover.color}"}},dark:{root:{background:"{surface.700}",disabledBackground:"{surface.600}",hoverBackground:"{surface.600}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}"},handle:{background:"{surface.400}",disabledBackground:"{surface.900}",hoverBackground:"{surface.300}",checkedBackground:"{surface.900}",checkedHoverBackground:"{surface.900}",color:"{surface.900}",hoverColor:"{surface.800}",checkedColor:"{primary.color}",checkedHoverColor:"{primary.hover.color}"}}},kee={root:Eee,handle:Iee,colorScheme:Aee},Ree={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",padding:"0.75rem"},Pee={root:Ree},Mee={maxWidth:"12.5rem",gutter:"0.25rem",shadow:"{overlay.popover.shadow}",padding:"0.5rem 0.75rem",borderRadius:"{overlay.popover.border.radius}"},Dee={light:{root:{background:"{surface.700}",color:"{surface.0}"}},dark:{root:{background:"{surface.700}",color:"{surface.0}"}}},Oee={root:Mee,colorScheme:Dee},Lee={background:"{content.background}",color:"{content.color}",padding:"1rem",gap:"2px",indent:"1rem",transitionDuration:"{transition.duration}"},zee={padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{text.color}",hoverColor:"{text.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},gap:"0.25rem"},Bee={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedColor:"{highlight.color}"},Fee={borderRadius:"50%",size:"1.75rem",hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedHoverColor:"{primary.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Nee={size:"2rem"},Vee={margin:"0 0 0.5rem 0"},$ee={root:Lee,node:zee,nodeIcon:Bee,nodeToggleButton:Fee,loadingIcon:Nee,filter:Vee},jee={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},Uee={width:"2.5rem",color:"{form.field.icon.color}"},Hee={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},Gee={padding:"{list.padding}"},Wee={padding:"{list.option.padding}"},qee={borderRadius:"{border.radius.sm}"},Zee={color:"{form.field.icon.color}"},Kee={root:jee,dropdown:Uee,overlay:Hee,tree:Gee,emptyMessage:Wee,chip:qee,clearIcon:Zee},Xee={transitionDuration:"{transition.duration}"},Yee={background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem"},Jee={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{treetable.border.color}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",gap:"0.5rem",padding:"0.75rem 1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},Qee={fontWeight:"600"},ete={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},tte={borderColor:"{treetable.border.color}",padding:"0.75rem 1rem",gap:"0.5rem"},nte={background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",padding:"0.75rem 1rem"},ite={fontWeight:"600"},rte={background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem"},ote={width:"0.5rem"},ste={width:"1px",color:"{primary.color}"},ate={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",size:"0.875rem"},lte={size:"2rem"},cte={hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",selectedHoverColor:"{primary.color}",size:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},ute={borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},dte={borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},hte={light:{root:{borderColor:"{content.border.color}"},bodyCell:{selectedBorderColor:"{primary.100}"}},dark:{root:{borderColor:"{surface.800}"},bodyCell:{selectedBorderColor:"{primary.900}"}}},fte={root:Xee,header:Yee,headerCell:Jee,columnTitle:Qee,row:ete,bodyCell:tte,footerCell:nte,columnFooter:ite,footer:rte,columnResizer:ote,resizeIndicator:ste,sortIcon:ate,loadingIcon:lte,nodeToggleButton:cte,paginatorTop:ute,paginatorBottom:dte,colorScheme:hte},pte={mask:{background:"{content.background}",color:"{text.muted.color}"},icon:{size:"2rem"}},mte={loader:pte},gte=Object.defineProperty,_te=Object.defineProperties,yte=Object.getOwnPropertyDescriptors,WD=Object.getOwnPropertySymbols,vte=Object.prototype.hasOwnProperty,bte=Object.prototype.propertyIsEnumerable,qD=(t,e,n)=>e in t?gte(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ZD,xte=(ZD=((t,e)=>{for(var n in e||(e={}))vte.call(e,n)&&qD(t,n,e[n]);if(WD)for(var n of WD(e))bte.call(e,n)&&qD(t,n,e[n]);return t})({},OW),_te(ZD,yte({components:{accordion:lW,autocomplete:yW,avatar:CW,badge:PW,blockui:zW,breadcrumb:VW,button:UW,card:KW,carousel:tq,cascadeselect:lq,checkbox:dq,chip:_q,colorpicker:wq,confirmdialog:Tq,confirmpopup:Rq,contextmenu:Bq,datatable:iZ,dataview:uZ,datepicker:RZ,dialog:zZ,divider:$Z,dock:HZ,drawer:XZ,editor:nK,fieldset:aK,fileupload:mK,floatlabel:bK,galleria:LK,iconfield:BK,iftalabel:VK,image:GK,imagecompare:qK,inlinemessage:JK,inplace:tX,inputchips:oX,inputgroup:aX,inputnumber:dX,inputotp:pX,inputtext:gX,knob:xX,listbox:kX,megamenu:NX,menu:GX,menubar:JX,message:lY,metergroup:mY,multiselect:TY,orderlist:AY,organizationchart:DY,overlaybadge:LY,paginator:VY,panel:qY,panelmenu:QY,password:oJ,picklist:lJ,popover:dJ,progressbar:mJ,progressspinner:_J,radiobutton:bJ,rating:SJ,ripple:TJ,scrollpanel:kJ,select:NJ,selectbutton:jJ,skeleton:GJ,slider:YJ,speeddial:QJ,splitbutton:tQ,splitter:oQ,stepper:pQ,steps:bQ,tabmenu:EQ,tabs:OQ,tabview:$Q,tag:GQ,terminal:KQ,textarea:YQ,tieredmenu:ree,timeline:uee,toast:bee,togglebutton:Tee,toggleswitch:kee,toolbar:Pee,tooltip:Oee,tree:$ee,treeselect:Kee,treetable:fte,virtualscroller:mte}})));/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const R_=typeof document<"u";function Zz(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function wte(t){return t.__esModule||t[Symbol.toStringTag]==="Module"||t.default&&Zz(t.default)}const Bo=Object.assign;function N2(t,e){const n={};for(const r in e){const c=e[r];n[r]=ud(c)?c.map(t):t(c)}return n}const lb=()=>{},ud=Array.isArray,Kz=/#/g,Ste=/&/g,Cte=/\//g,Tte=/=/g,Ete=/\?/g,Xz=/\+/g,Ite=/%5B/g,Ate=/%5D/g,Yz=/%5E/g,kte=/%60/g,Jz=/%7B/g,Rte=/%7C/g,Qz=/%7D/g,Pte=/%20/g;function fI(t){return encodeURI(""+t).replace(Rte,"|").replace(Ite,"[").replace(Ate,"]")}function Mte(t){return fI(t).replace(Jz,"{").replace(Qz,"}").replace(Yz,"^")}function WT(t){return fI(t).replace(Xz,"%2B").replace(Pte,"+").replace(Kz,"%23").replace(Ste,"%26").replace(kte,"`").replace(Jz,"{").replace(Qz,"}").replace(Yz,"^")}function Dte(t){return WT(t).replace(Tte,"%3D")}function Ote(t){return fI(t).replace(Kz,"%23").replace(Ete,"%3F")}function Lte(t){return t==null?"":Ote(t).replace(Cte,"%2F")}function zb(t){try{return decodeURIComponent(""+t)}catch{}return""+t}const zte=/\/$/,Bte=t=>t.replace(zte,"");function V2(t,e,n="/"){let r,c={},u="",p="";const o=e.indexOf("#");let w=e.indexOf("?");return o<w&&o>=0&&(w=-1),w>-1&&(r=e.slice(0,w),u=e.slice(w+1,o>-1?o:e.length),c=t(u)),o>-1&&(r=r||e.slice(0,o),p=e.slice(o,e.length)),r=$te(r??e,n),{fullPath:r+(u&&"?")+u+p,path:r,query:c,hash:zb(p)}}function Fte(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function KD(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function Nte(t,e,n){const r=e.matched.length-1,c=n.matched.length-1;return r>-1&&r===c&&ty(e.matched[r],n.matched[c])&&eB(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function ty(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function eB(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!Vte(t[n],e[n]))return!1;return!0}function Vte(t,e){return ud(t)?XD(t,e):ud(e)?XD(e,t):t===e}function XD(t,e){return ud(e)?t.length===e.length&&t.every((n,r)=>n===e[r]):t.length===1&&t[0]===e}function $te(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),r=t.split("/"),c=r[r.length-1];(c===".."||c===".")&&r.push("");let u=n.length-1,p,o;for(p=0;p<r.length;p++)if(o=r[p],o!==".")if(o==="..")u>1&&u--;else break;return n.slice(0,u).join("/")+"/"+r.slice(p).join("/")}const lp={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Bb;(function(t){t.pop="pop",t.push="push"})(Bb||(Bb={}));var cb;(function(t){t.back="back",t.forward="forward",t.unknown=""})(cb||(cb={}));function jte(t){if(!t)if(R_){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),Bte(t)}const Ute=/^[^#]+#/;function Hte(t,e){return t.replace(Ute,"#")+e}function Gte(t,e){const n=document.documentElement.getBoundingClientRect(),r=t.getBoundingClientRect();return{behavior:e.behavior,left:r.left-n.left-(e.left||0),top:r.top-n.top-(e.top||0)}}const ES=()=>({left:window.scrollX,top:window.scrollY});function Wte(t){let e;if("el"in t){const n=t.el,r=typeof n=="string"&&n.startsWith("#"),c=typeof n=="string"?r?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!c)return;e=Gte(c,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function YD(t,e){return(history.state?history.state.position-e:-1)+t}const qT=new Map;function qte(t,e){qT.set(t,e)}function Zte(t){const e=qT.get(t);return qT.delete(t),e}let Kte=()=>location.protocol+"//"+location.host;function tB(t,e){const{pathname:n,search:r,hash:c}=e,u=t.indexOf("#");if(u>-1){let o=c.includes(t.slice(u))?t.slice(u).length:1,w=c.slice(o);return w[0]!=="/"&&(w="/"+w),KD(w,"")}return KD(n,t)+r+c}function Xte(t,e,n,r){let c=[],u=[],p=null;const o=({state:B})=>{const N=tB(t,location),ee=n.value,Q=e.value;let se=0;if(B){if(n.value=N,e.value=B,p&&p===ee){p=null;return}se=Q?B.position-Q.position:0}else r(N);c.forEach(ce=>{ce(n.value,ee,{delta:se,type:Bb.pop,direction:se?se>0?cb.forward:cb.back:cb.unknown})})};function w(){p=n.value}function T(B){c.push(B);const N=()=>{const ee=c.indexOf(B);ee>-1&&c.splice(ee,1)};return u.push(N),N}function A(){const{history:B}=window;B.state&&B.replaceState(Bo({},B.state,{scroll:ES()}),"")}function D(){for(const B of u)B();u=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",A)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",A,{passive:!0}),{pauseListeners:w,listen:T,destroy:D}}function JD(t,e,n,r=!1,c=!1){return{back:t,current:e,forward:n,replaced:r,position:window.history.length,scroll:c?ES():null}}function Yte(t){const{history:e,location:n}=window,r={value:tB(t,n)},c={value:e.state};c.value||u(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function u(w,T,A){const D=t.indexOf("#"),B=D>-1?(n.host&&document.querySelector("base")?t:t.slice(D))+w:Kte()+t+w;try{e[A?"replaceState":"pushState"](T,"",B),c.value=T}catch(N){console.error(N),n[A?"replace":"assign"](B)}}function p(w,T){const A=Bo({},e.state,JD(c.value.back,w,c.value.forward,!0),T,{position:c.value.position});u(w,A,!0),r.value=w}function o(w,T){const A=Bo({},c.value,e.state,{forward:w,scroll:ES()});u(A.current,A,!0);const D=Bo({},JD(r.value,w,null),{position:A.position+1},T);u(w,D,!1),r.value=w}return{location:r,state:c,push:o,replace:p}}function Jte(t){t=jte(t);const e=Yte(t),n=Xte(t,e.state,e.location,e.replace);function r(u,p=!0){p||n.pauseListeners(),history.go(u)}const c=Bo({location:"",base:t,go:r,createHref:Hte.bind(null,t)},e,n);return Object.defineProperty(c,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(c,"state",{enumerable:!0,get:()=>e.state.value}),c}function Qte(t){return t=location.host?t||location.pathname+location.search:"",t.includes("#")||(t+="#"),Jte(t)}function ene(t){return typeof t=="string"||t&&typeof t=="object"}function nB(t){return typeof t=="string"||typeof t=="symbol"}const iB=Symbol("");var QD;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(QD||(QD={}));function ny(t,e){return Bo(new Error,{type:t,[iB]:!0},e)}function Nh(t,e){return t instanceof Error&&iB in t&&(e==null||!!(t.type&e))}const e3="[^/]+?",tne={sensitive:!1,strict:!1,start:!0,end:!0},nne=/[.+*?^${}()[\]/\\]/g;function ine(t,e){const n=Bo({},tne,e),r=[];let c=n.start?"^":"";const u=[];for(const T of t){const A=T.length?[]:[90];n.strict&&!T.length&&(c+="/");for(let D=0;D<T.length;D++){const B=T[D];let N=40+(n.sensitive?.25:0);if(B.type===0)D||(c+="/"),c+=B.value.replace(nne,"\\$&"),N+=40;else if(B.type===1){const{value:ee,repeatable:Q,optional:se,regexp:ce}=B;u.push({name:ee,repeatable:Q,optional:se});const be=ce||e3;if(be!==e3){N+=10;try{new RegExp(`(${be})`)}catch(xe){throw new Error(`Invalid custom RegExp for param "${ee}" (${be}): `+xe.message)}}let ze=Q?`((?:${be})(?:/(?:${be}))*)`:`(${be})`;D||(ze=se&&T.length<2?`(?:/${ze})`:"/"+ze),se&&(ze+="?"),c+=ze,N+=20,se&&(N+=-8),Q&&(N+=-20),be===".*"&&(N+=-50)}A.push(N)}r.push(A)}if(n.strict&&n.end){const T=r.length-1;r[T][r[T].length-1]+=.7000000000000001}n.strict||(c+="/?"),n.end?c+="$":n.strict&&!c.endsWith("/")&&(c+="(?:/|$)");const p=new RegExp(c,n.sensitive?"":"i");function o(T){const A=T.match(p),D={};if(!A)return null;for(let B=1;B<A.length;B++){const N=A[B]||"",ee=u[B-1];D[ee.name]=N&&ee.repeatable?N.split("/"):N}return D}function w(T){let A="",D=!1;for(const B of t){(!D||!A.endsWith("/"))&&(A+="/"),D=!1;for(const N of B)if(N.type===0)A+=N.value;else if(N.type===1){const{value:ee,repeatable:Q,optional:se}=N,ce=ee in T?T[ee]:"";if(ud(ce)&&!Q)throw new Error(`Provided param "${ee}" is an array but it is not repeatable (* or + modifiers)`);const be=ud(ce)?ce.join("/"):ce;if(!be)if(se)B.length<2&&(A.endsWith("/")?A=A.slice(0,-1):D=!0);else throw new Error(`Missing required param "${ee}"`);A+=be}}return A||"/"}return{re:p,score:r,keys:u,parse:o,stringify:w}}function rne(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=e[n]-t[n];if(r)return r;n++}return t.length<e.length?t.length===1&&t[0]===80?-1:1:t.length>e.length?e.length===1&&e[0]===80?1:-1:0}function rB(t,e){let n=0;const r=t.score,c=e.score;for(;n<r.length&&n<c.length;){const u=rne(r[n],c[n]);if(u)return u;n++}if(Math.abs(c.length-r.length)===1){if(t3(r))return 1;if(t3(c))return-1}return c.length-r.length}function t3(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const one={type:0,value:""},sne=/[a-zA-Z0-9_]/;function ane(t){if(!t)return[[]];if(t==="/")return[[one]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(N){throw new Error(`ERR (${n})/"${T}": ${N}`)}let n=0,r=n;const c=[];let u;function p(){u&&c.push(u),u=[]}let o=0,w,T="",A="";function D(){T&&(n===0?u.push({type:0,value:T}):n===1||n===2||n===3?(u.length>1&&(w==="*"||w==="+")&&e(`A repeatable param (${T}) must be alone in its segment. eg: '/:ids+.`),u.push({type:1,value:T,regexp:A,repeatable:w==="*"||w==="+",optional:w==="*"||w==="?"})):e("Invalid state to consume buffer"),T="")}function B(){T+=w}for(;o<t.length;){if(w=t[o++],w==="\\"&&n!==2){r=n,n=4;continue}switch(n){case 0:w==="/"?(T&&D(),p()):w===":"?(D(),n=1):B();break;case 4:B(),n=r;break;case 1:w==="("?n=2:sne.test(w)?B():(D(),n=0,w!=="*"&&w!=="?"&&w!=="+"&&o--);break;case 2:w===")"?A[A.length-1]=="\\"?A=A.slice(0,-1)+w:n=3:A+=w;break;case 3:D(),n=0,w!=="*"&&w!=="?"&&w!=="+"&&o--,A="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${T}"`),D(),p(),c}function lne(t,e,n){const r=ine(ane(t.path),n),c=Bo(r,{record:t,parent:e,children:[],alias:[]});return e&&!c.record.aliasOf==!e.record.aliasOf&&e.children.push(c),c}function cne(t,e){const n=[],r=new Map;e=o3({strict:!1,end:!0,sensitive:!1},e);function c(D){return r.get(D)}function u(D,B,N){const ee=!N,Q=i3(D);Q.aliasOf=N&&N.record;const se=o3(e,D),ce=[Q];if("alias"in D){const xe=typeof D.alias=="string"?[D.alias]:D.alias;for(const je of xe)ce.push(i3(Bo({},Q,{components:N?N.record.components:Q.components,path:je,aliasOf:N?N.record:Q})))}let be,ze;for(const xe of ce){const{path:je}=xe;if(B&&je[0]!=="/"){const qe=B.record.path,oe=qe[qe.length-1]==="/"?"":"/";xe.path=B.record.path+(je&&oe+je)}if(be=lne(xe,B,se),N?N.alias.push(be):(ze=ze||be,ze!==be&&ze.alias.push(be),ee&&D.name&&!r3(be)&&p(D.name)),oB(be)&&w(be),Q.children){const qe=Q.children;for(let oe=0;oe<qe.length;oe++)u(qe[oe],be,N&&N.children[oe])}N=N||be}return ze?()=>{p(ze)}:lb}function p(D){if(nB(D)){const B=r.get(D);B&&(r.delete(D),n.splice(n.indexOf(B),1),B.children.forEach(p),B.alias.forEach(p))}else{const B=n.indexOf(D);B>-1&&(n.splice(B,1),D.record.name&&r.delete(D.record.name),D.children.forEach(p),D.alias.forEach(p))}}function o(){return n}function w(D){const B=hne(D,n);n.splice(B,0,D),D.record.name&&!r3(D)&&r.set(D.record.name,D)}function T(D,B){let N,ee={},Q,se;if("name"in D&&D.name){if(N=r.get(D.name),!N)throw ny(1,{location:D});se=N.record.name,ee=Bo(n3(B.params,N.keys.filter(ze=>!ze.optional).concat(N.parent?N.parent.keys.filter(ze=>ze.optional):[]).map(ze=>ze.name)),D.params&&n3(D.params,N.keys.map(ze=>ze.name))),Q=N.stringify(ee)}else if(D.path!=null)Q=D.path,N=n.find(ze=>ze.re.test(Q)),N&&(ee=N.parse(Q),se=N.record.name);else{if(N=B.name?r.get(B.name):n.find(ze=>ze.re.test(B.path)),!N)throw ny(1,{location:D,currentLocation:B});se=N.record.name,ee=Bo({},B.params,D.params),Q=N.stringify(ee)}const ce=[];let be=N;for(;be;)ce.unshift(be.record),be=be.parent;return{name:se,path:Q,params:ee,matched:ce,meta:dne(ce)}}t.forEach(D=>u(D));function A(){n.length=0,r.clear()}return{addRoute:u,resolve:T,removeRoute:p,clearRoutes:A,getRoutes:o,getRecordMatcher:c}}function n3(t,e){const n={};for(const r of e)r in t&&(n[r]=t[r]);return n}function i3(t){const e={path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:t.aliasOf,beforeEnter:t.beforeEnter,props:une(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function une(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const r in t.components)e[r]=typeof n=="object"?n[r]:n;return e}function r3(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function dne(t){return t.reduce((e,n)=>Bo(e,n.meta),{})}function o3(t,e){const n={};for(const r in t)n[r]=r in e?e[r]:t[r];return n}function hne(t,e){let n=0,r=e.length;for(;n!==r;){const u=n+r>>1;rB(t,e[u])<0?r=u:n=u+1}const c=fne(t);return c&&(r=e.lastIndexOf(c,r-1)),r}function fne(t){let e=t;for(;e=e.parent;)if(oB(e)&&rB(t,e)===0)return e}function oB({record:t}){return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function pne(t){const e={};if(t===""||t==="?")return e;const r=(t[0]==="?"?t.slice(1):t).split("&");for(let c=0;c<r.length;++c){const u=r[c].replace(Xz," "),p=u.indexOf("="),o=zb(p<0?u:u.slice(0,p)),w=p<0?null:zb(u.slice(p+1));if(o in e){let T=e[o];ud(T)||(T=e[o]=[T]),T.push(w)}else e[o]=w}return e}function s3(t){let e="";for(let n in t){const r=t[n];if(n=Dte(n),r==null){r!==void 0&&(e+=(e.length?"&":"")+n);continue}(ud(r)?r.map(u=>u&&WT(u)):[r&&WT(r)]).forEach(u=>{u!==void 0&&(e+=(e.length?"&":"")+n,u!=null&&(e+="="+u))})}return e}function mne(t){const e={};for(const n in t){const r=t[n];r!==void 0&&(e[n]=ud(r)?r.map(c=>c==null?null:""+c):r==null?r:""+r)}return e}const gne=Symbol(""),a3=Symbol(""),IS=Symbol(""),pI=Symbol(""),ZT=Symbol("");function Lv(){let t=[];function e(r){return t.push(r),()=>{const c=t.indexOf(r);c>-1&&t.splice(c,1)}}function n(){t=[]}return{add:e,list:()=>t.slice(),reset:n}}function pp(t,e,n,r,c,u=p=>p()){const p=r&&(r.enterCallbacks[c]=r.enterCallbacks[c]||[]);return()=>new Promise((o,w)=>{const T=B=>{B===!1?w(ny(4,{from:n,to:e})):B instanceof Error?w(B):ene(B)?w(ny(2,{from:e,to:B})):(p&&r.enterCallbacks[c]===p&&typeof B=="function"&&p.push(B),o())},A=u(()=>t.call(r&&r.instances[c],e,n,T));let D=Promise.resolve(A);t.length<3&&(D=D.then(T)),D.catch(B=>w(B))})}function $2(t,e,n,r,c=u=>u()){const u=[];for(const p of t)for(const o in p.components){let w=p.components[o];if(!(e!=="beforeRouteEnter"&&!p.instances[o]))if(Zz(w)){const A=(w.__vccOpts||w)[e];A&&u.push(pp(A,n,r,p,o,c))}else{let T=w();u.push(()=>T.then(A=>{if(!A)throw new Error(`Couldn't resolve component "${o}" at "${p.path}"`);const D=wte(A)?A.default:A;p.mods[o]=A,p.components[o]=D;const N=(D.__vccOpts||D)[e];return N&&pp(N,n,r,p,o,c)()}))}}return u}function l3(t){const e=ad(IS),n=ad(pI),r=Dc(()=>{const w=ss(t.to);return e.resolve(w)}),c=Dc(()=>{const{matched:w}=r.value,{length:T}=w,A=w[T-1],D=n.matched;if(!A||!D.length)return-1;const B=D.findIndex(ty.bind(null,A));if(B>-1)return B;const N=c3(w[T-2]);return T>1&&c3(A)===N&&D[D.length-1].path!==N?D.findIndex(ty.bind(null,w[T-2])):B}),u=Dc(()=>c.value>-1&&xne(n.params,r.value.params)),p=Dc(()=>c.value>-1&&c.value===n.matched.length-1&&eB(n.params,r.value.params));function o(w={}){if(bne(w)){const T=e[ss(t.replace)?"replace":"push"](ss(t.to)).catch(lb);return t.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>T),T}return Promise.resolve()}return{route:r,href:Dc(()=>r.value.href),isActive:u,isExactActive:p,navigate:o}}function _ne(t){return t.length===1?t[0]:t}const yne=ez({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:l3,setup(t,{slots:e}){const n=T0(l3(t)),{options:r}=ad(IS),c=Dc(()=>({[u3(t.activeClass,r.linkActiveClass,"router-link-active")]:n.isActive,[u3(t.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const u=e.default&&_ne(e.default(n));return t.custom?u:sI("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:c.value},u)}}}),vne=yne;function bne(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function xne(t,e){for(const n in e){const r=e[n],c=t[n];if(typeof r=="string"){if(r!==c)return!1}else if(!ud(c)||c.length!==r.length||r.some((u,p)=>u!==c[p]))return!1}return!0}function c3(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const u3=(t,e,n)=>t??e??n,wne=ez({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const r=ad(ZT),c=Dc(()=>t.route||r.value),u=ad(a3,0),p=Dc(()=>{let T=ss(u);const{matched:A}=c.value;let D;for(;(D=A[T])&&!D.components;)T++;return T}),o=Dc(()=>c.value.matched[p.value]);Ux(a3,Dc(()=>p.value+1)),Ux(gne,o),Ux(ZT,c);const w=Si();return gu(()=>[w.value,o.value,t.name],([T,A,D],[B,N,ee])=>{A&&(A.instances[D]=T,N&&N!==A&&T&&T===B&&(A.leaveGuards.size||(A.leaveGuards=N.leaveGuards),A.updateGuards.size||(A.updateGuards=N.updateGuards))),T&&A&&(!N||!ty(A,N)||!B)&&(A.enterCallbacks[D]||[]).forEach(Q=>Q(T))},{flush:"post"}),()=>{const T=c.value,A=t.name,D=o.value,B=D&&D.components[A];if(!B)return d3(n.default,{Component:B,route:T});const N=D.props[A],ee=N?N===!0?T.params:typeof N=="function"?N(T):N:null,se=sI(B,Bo({},ee,e,{onVnodeUnmounted:ce=>{ce.component.isUnmounted&&(D.instances[A]=null)},ref:w}));return d3(n.default,{Component:se,route:T})||se}}});function d3(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const Sne=wne;function Cne(t){const e=cne(t.routes,t),n=t.parseQuery||pne,r=t.stringifyQuery||s3,c=t.history,u=Lv(),p=Lv(),o=Lv(),w=Aj(lp);let T=lp;R_&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const A=N2.bind(null,Ft=>""+Ft),D=N2.bind(null,Lte),B=N2.bind(null,zb);function N(Ft,In){let Wt,kn;return nB(Ft)?(Wt=e.getRecordMatcher(Ft),kn=In):kn=Ft,e.addRoute(kn,Wt)}function ee(Ft){const In=e.getRecordMatcher(Ft);In&&e.removeRoute(In)}function Q(){return e.getRoutes().map(Ft=>Ft.record)}function se(Ft){return!!e.getRecordMatcher(Ft)}function ce(Ft,In){if(In=Bo({},In||w.value),typeof Ft=="string"){const vt=V2(n,Ft,In.path),Gt=e.resolve({path:vt.path},In),an=c.createHref(vt.fullPath);return Bo(vt,Gt,{params:B(Gt.params),hash:zb(vt.hash),redirectedFrom:void 0,href:an})}let Wt;if(Ft.path!=null)Wt=Bo({},Ft,{path:V2(n,Ft.path,In.path).path});else{const vt=Bo({},Ft.params);for(const Gt in vt)vt[Gt]==null&&delete vt[Gt];Wt=Bo({},Ft,{params:D(vt)}),In.params=D(In.params)}const kn=e.resolve(Wt,In),dr=Ft.hash||"";kn.params=A(B(kn.params));const Qe=Fte(r,Bo({},Ft,{hash:Mte(dr),path:kn.path})),at=c.createHref(Qe);return Bo({fullPath:Qe,hash:dr,query:r===s3?mne(Ft.query):Ft.query||{}},kn,{redirectedFrom:void 0,href:at})}function be(Ft){return typeof Ft=="string"?V2(n,Ft,w.value.path):Bo({},Ft)}function ze(Ft,In){if(T!==Ft)return ny(8,{from:In,to:Ft})}function xe(Ft){return oe(Ft)}function je(Ft){return xe(Bo(be(Ft),{replace:!0}))}function qe(Ft){const In=Ft.matched[Ft.matched.length-1];if(In&&In.redirect){const{redirect:Wt}=In;let kn=typeof Wt=="function"?Wt(Ft):Wt;return typeof kn=="string"&&(kn=kn.includes("?")||kn.includes("#")?kn=be(kn):{path:kn},kn.params={}),Bo({query:Ft.query,hash:Ft.hash,params:kn.path!=null?{}:Ft.params},kn)}}function oe(Ft,In){const Wt=T=ce(Ft),kn=w.value,dr=Ft.state,Qe=Ft.force,at=Ft.replace===!0,vt=qe(Wt);if(vt)return oe(Bo(be(vt),{state:typeof vt=="object"?Bo({},dr,vt.state):dr,force:Qe,replace:at}),In||Wt);const Gt=Wt;Gt.redirectedFrom=In;let an;return!Qe&&Nte(r,kn,Wt)&&(an=ny(16,{to:Gt,from:kn}),Pt(kn,kn,!0,!1)),(an?Promise.resolve(an):$e(Gt,kn)).catch(Qt=>Nh(Qt)?Nh(Qt,2)?Qt:zi(Qt):Hn(Qt,Gt,kn)).then(Qt=>{if(Qt){if(Nh(Qt,2))return oe(Bo({replace:at},be(Qt.to),{state:typeof Qt.to=="object"?Bo({},dr,Qt.to.state):dr,force:Qe}),In||Gt)}else Qt=Te(Gt,kn,!0,at,dr);return me(Gt,kn,Qt),Qt})}function de(Ft,In){const Wt=ze(Ft,In);return Wt?Promise.reject(Wt):Promise.resolve()}function Ee(Ft){const In=Ur.values().next().value;return In&&typeof In.runWithContext=="function"?In.runWithContext(Ft):Ft()}function $e(Ft,In){let Wt;const[kn,dr,Qe]=Tne(Ft,In);Wt=$2(kn.reverse(),"beforeRouteLeave",Ft,In);for(const vt of kn)vt.leaveGuards.forEach(Gt=>{Wt.push(pp(Gt,Ft,In))});const at=de.bind(null,Ft,In);return Wt.push(at),ai(Wt).then(()=>{Wt=[];for(const vt of u.list())Wt.push(pp(vt,Ft,In));return Wt.push(at),ai(Wt)}).then(()=>{Wt=$2(dr,"beforeRouteUpdate",Ft,In);for(const vt of dr)vt.updateGuards.forEach(Gt=>{Wt.push(pp(Gt,Ft,In))});return Wt.push(at),ai(Wt)}).then(()=>{Wt=[];for(const vt of Qe)if(vt.beforeEnter)if(ud(vt.beforeEnter))for(const Gt of vt.beforeEnter)Wt.push(pp(Gt,Ft,In));else Wt.push(pp(vt.beforeEnter,Ft,In));return Wt.push(at),ai(Wt)}).then(()=>(Ft.matched.forEach(vt=>vt.enterCallbacks={}),Wt=$2(Qe,"beforeRouteEnter",Ft,In,Ee),Wt.push(at),ai(Wt))).then(()=>{Wt=[];for(const vt of p.list())Wt.push(pp(vt,Ft,In));return Wt.push(at),ai(Wt)}).catch(vt=>Nh(vt,8)?vt:Promise.reject(vt))}function me(Ft,In,Wt){o.list().forEach(kn=>Ee(()=>kn(Ft,In,Wt)))}function Te(Ft,In,Wt,kn,dr){const Qe=ze(Ft,In);if(Qe)return Qe;const at=In===lp,vt=R_?history.state:{};Wt&&(kn||at?c.replace(Ft.fullPath,Bo({scroll:at&&vt&&vt.scroll},dr)):c.push(Ft.fullPath,dr)),w.value=Ft,Pt(Ft,In,Wt,at),zi()}let Re;function tn(){Re||(Re=c.listen((Ft,In,Wt)=>{if(!Br.listening)return;const kn=ce(Ft),dr=qe(kn);if(dr){oe(Bo(dr,{replace:!0,force:!0}),kn).catch(lb);return}T=kn;const Qe=w.value;R_&&qte(YD(Qe.fullPath,Wt.delta),ES()),$e(kn,Qe).catch(at=>Nh(at,12)?at:Nh(at,2)?(oe(Bo(be(at.to),{force:!0}),kn).then(vt=>{Nh(vt,20)&&!Wt.delta&&Wt.type===Bb.pop&&c.go(-1,!1)}).catch(lb),Promise.reject()):(Wt.delta&&c.go(-Wt.delta,!1),Hn(at,kn,Qe))).then(at=>{at=at||Te(kn,Qe,!1),at&&(Wt.delta&&!Nh(at,8)?c.go(-Wt.delta,!1):Wt.type===Bb.pop&&Nh(at,20)&&c.go(-1,!1)),me(kn,Qe,at)}).catch(lb)}))}let Zt=Lv(),on=Lv(),hn;function Hn(Ft,In,Wt){zi(Ft);const kn=on.list();return kn.length?kn.forEach(dr=>dr(Ft,In,Wt)):console.error(Ft),Promise.reject(Ft)}function Ri(){return hn&&w.value!==lp?Promise.resolve():new Promise((Ft,In)=>{Zt.add([Ft,In])})}function zi(Ft){return hn||(hn=!Ft,tn(),Zt.list().forEach(([In,Wt])=>Ft?Wt(Ft):In()),Zt.reset()),Ft}function Pt(Ft,In,Wt,kn){const{scrollBehavior:dr}=t;if(!R_||!dr)return Promise.resolve();const Qe=!Wt&&Zte(YD(Ft.fullPath,0))||(kn||!Wt)&&history.state&&history.state.scroll||null;return hy().then(()=>dr(Ft,In,Qe)).then(at=>at&&Wte(at)).catch(at=>Hn(at,Ft,In))}const Di=Ft=>c.go(Ft);let wo;const Ur=new Set,Br={currentRoute:w,listening:!0,addRoute:N,removeRoute:ee,clearRoutes:e.clearRoutes,hasRoute:se,getRoutes:Q,resolve:ce,options:t,push:xe,replace:je,go:Di,back:()=>Di(-1),forward:()=>Di(1),beforeEach:u.add,beforeResolve:p.add,afterEach:o.add,onError:on.add,isReady:Ri,install(Ft){const In=this;Ft.component("RouterLink",vne),Ft.component("RouterView",Sne),Ft.config.globalProperties.$router=In,Object.defineProperty(Ft.config.globalProperties,"$route",{enumerable:!0,get:()=>ss(w)}),R_&&!wo&&w.value===lp&&(wo=!0,xe(c.location).catch(dr=>{}));const Wt={};for(const dr in lp)Object.defineProperty(Wt,dr,{get:()=>w.value[dr],enumerable:!0});Ft.provide(IS,In),Ft.provide(pI,B4(Wt)),Ft.provide(ZT,w);const kn=Ft.unmount;Ur.add(Ft),Ft.unmount=function(){Ur.delete(Ft),Ur.size<1&&(T=lp,Re&&Re(),Re=null,w.value=lp,wo=!1,hn=!1),kn()}}};function ai(Ft){return Ft.reduce((In,Wt)=>In.then(()=>Ee(Wt)),Promise.resolve())}return Br}function Tne(t,e){const n=[],r=[],c=[],u=Math.max(e.matched.length,t.matched.length);for(let p=0;p<u;p++){const o=e.matched[p];o&&(t.matched.find(T=>ty(T,o))?r.push(o):n.push(o));const w=t.matched[p];w&&(e.matched.find(T=>ty(T,w))||c.push(w))}return[n,r,c]}function Ene(){return ad(IS)}function Ine(t){return ad(pI)}const Ane={},kne={class:"home-hero d-flex flex-column justify-content-center align-items-center text-center"};function Rne(t,e){return We(),wt("section",kne,[...e[0]||(e[0]=[Pe("div",{class:"content"},[Pe("h1",{class:"hero-title mb-3"},"Youth Wellbeing Platform"),Pe("p",{class:"hero-quote fst-italic mb-4"}," “Empowering the next generation to flourish — together in mind, body & community.” "),Pe("p",{class:"hero-about mx-auto"}," Our mission is to support youth mental health through accessible programs, trusted resources, and a connected community. Whether you’re seeking guidance, looking for support, or wanting to explore wellbeing strategies — this platform is here for you. ")],-1)])])}const Pne=Cu(Ane,[["render",Rne],["__scopeId","data-v-7d67d5b5"]]);function Fb(t){"@babel/helpers - typeof";return Fb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fb(t)}function Mne(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Dne(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Lne(r.key),r)}}function One(t,e,n){return e&&Dne(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Lne(t){var e=zne(t,"string");return Fb(e)=="symbol"?e:e+""}function zne(t,e){if(Fb(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Fb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var sB=function(){function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){};Mne(this,t),this.element=e,this.listener=n}return One(t,[{key:"bindScrollListener",value:function(){this.scrollableParents=_G(this.element);for(var n=0;n<this.scrollableParents.length;n++)this.scrollableParents[n].addEventListener("scroll",this.listener)}},{key:"unbindScrollListener",value:function(){if(this.scrollableParents)for(var n=0;n<this.scrollableParents.length;n++)this.scrollableParents[n].removeEventListener("scroll",this.listener)}},{key:"destroy",value:function(){this.unbindScrollListener(),this.element=null,this.listener=null,this.scrollableParents=null}}])}();function Nb(t){"@babel/helpers - typeof";return Nb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nb(t)}function Bne(t){return $ne(t)||Vne(t)||Nne(t)||Fne()}function Fne(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nne(t,e){if(t){if(typeof t=="string")return KT(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?KT(t,e):void 0}}function Vne(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function $ne(t){if(Array.isArray(t))return KT(t)}function KT(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function jne(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Une(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,aB(r.key),r)}}function Hne(t,e,n){return e&&Une(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function h3(t,e,n){return(e=aB(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aB(t){var e=Gne(t,"string");return Nb(e)=="symbol"?e:e+""}function Gne(t,e){if(Nb(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Nb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var iy=function(){function t(e){var n=e.init,r=e.type;jne(this,t),h3(this,"helpers",void 0),h3(this,"type",void 0),this.helpers=new Set(n),this.type=r}return Hne(t,[{key:"add",value:function(n){this.helpers.add(n)}},{key:"update",value:function(){}},{key:"delete",value:function(n){this.helpers.delete(n)}},{key:"clear",value:function(){this.helpers.clear()}},{key:"get",value:function(n,r){var c=this._get(n,r),u=c?this._recursive(Bne(this.helpers),c):null;return xr(u)?u:null}},{key:"_isMatched",value:function(n,r){var c,u=n==null?void 0:n.parent;return(u==null||(c=u.vnode)===null||c===void 0?void 0:c.key)===r||u&&this._isMatched(u,r)||!1}},{key:"_get",value:function(n,r){var c,u;return((c=r||(n==null?void 0:n.$slots))===null||c===void 0||(u=c.default)===null||u===void 0?void 0:u.call(c))||null}},{key:"_recursive",value:function(){var n=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],u=[];return c.forEach(function(p){p.children instanceof Array?u=u.concat(n._recursive(u,p.children)):p.type.name===n.type?u.push(p):xr(p.key)&&(u=u.concat(r.filter(function(o){return n._isMatched(o,p.key)}).map(function(o){return o.vnode})))}),u}}])}();function Gp(t,e){if(t){var n=t.props;if(n){var r=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),c=Object.prototype.hasOwnProperty.call(n,r)?r:e;return t.type.extends.props[e].type===Boolean&&n[c]===""?!0:n[c]}}return null}var _p={_loadedStyleNames:new Set,getLoadedStyleNames:function(){return this._loadedStyleNames},isStyleNameLoaded:function(e){return this._loadedStyleNames.has(e)},setLoadedStyleName:function(e){this._loadedStyleNames.add(e)},deleteLoadedStyleName:function(e){this._loadedStyleNames.delete(e)},clearLoadedStyleNames:function(){this._loadedStyleNames.clear()}};function Wne(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"pc",e=Uj();return"".concat(t).concat(e.replace("v-","").replaceAll("-","_"))}var f3=Kr.extend({name:"common"});function Vb(t){"@babel/helpers - typeof";return Vb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vb(t)}function qne(t){return uB(t)||Zne(t)||cB(t)||lB()}function Zne(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function zv(t,e){return uB(t)||Kne(t,e)||cB(t,e)||lB()}function lB(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cB(t,e){if(t){if(typeof t=="string")return p3(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p3(t,e):void 0}}function p3(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Kne(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,c,u,p,o=[],w=!0,T=!1;try{if(u=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;w=!1}else for(;!(w=(r=u.call(n)).done)&&(o.push(r.value),o.length!==e);w=!0);}catch(A){T=!0,c=A}finally{try{if(!w&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(T)throw c}}return o}}function uB(t){if(Array.isArray(t))return t}function m3(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function Qr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?m3(Object(n),!0).forEach(function(r){qv(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m3(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function qv(t,e,n){return(e=Xne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xne(t){var e=Yne(t,"string");return Vb(e)=="symbol"?e:e+""}function Yne(t,e){if(Vb(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Vb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Lo={name:"BaseComponent",props:{pt:{type:Object,default:void 0},ptOptions:{type:Object,default:void 0},unstyled:{type:Boolean,default:void 0},dt:{type:Object,default:void 0}},inject:{$parentInstance:{default:void 0}},watch:{isUnstyled:{immediate:!0,handler:function(e){Wa.off("theme:change",this._loadCoreStyles),e||(this._loadCoreStyles(),this._themeChangeListener(this._loadCoreStyles))}},dt:{immediate:!0,handler:function(e,n){var r=this;Wa.off("theme:change",this._themeScopedListener),e?(this._loadScopedThemeStyles(e),this._themeScopedListener=function(){return r._loadScopedThemeStyles(e)},this._themeChangeListener(this._themeScopedListener)):this._unloadScopedThemeStyles()}}},scopedStyleEl:void 0,rootEl:void 0,uid:void 0,$attrSelector:void 0,beforeCreate:function(){var e,n,r,c,u,p,o,w,T,A,D,B=(e=this.pt)===null||e===void 0?void 0:e._usept,N=B?(n=this.pt)===null||n===void 0||(n=n.originalValue)===null||n===void 0?void 0:n[this.$.type.name]:void 0,ee=B?(r=this.pt)===null||r===void 0||(r=r.value)===null||r===void 0?void 0:r[this.$.type.name]:this.pt;(c=ee||N)===null||c===void 0||(c=c.hooks)===null||c===void 0||(u=c.onBeforeCreate)===null||u===void 0||u.call(c);var Q=(p=this.$primevueConfig)===null||p===void 0||(p=p.pt)===null||p===void 0?void 0:p._usept,se=Q?(o=this.$primevue)===null||o===void 0||(o=o.config)===null||o===void 0||(o=o.pt)===null||o===void 0?void 0:o.originalValue:void 0,ce=Q?(w=this.$primevue)===null||w===void 0||(w=w.config)===null||w===void 0||(w=w.pt)===null||w===void 0?void 0:w.value:(T=this.$primevue)===null||T===void 0||(T=T.config)===null||T===void 0?void 0:T.pt;(A=ce||se)===null||A===void 0||(A=A[this.$.type.name])===null||A===void 0||(A=A.hooks)===null||A===void 0||(D=A.onBeforeCreate)===null||D===void 0||D.call(A),this.$attrSelector=Wne(),this.uid=this.$attrs.id||this.$attrSelector.replace("pc","pv_id_")},created:function(){this._hook("onCreated")},beforeMount:function(){var e;this.rootEl=xp(wg(this.$el)?this.$el:(e=this.$el)===null||e===void 0?void 0:e.parentElement,"[".concat(this.$attrSelector,"]")),this.rootEl&&(this.rootEl.$pc=Qr({name:this.$.type.name,attrSelector:this.$attrSelector},this.$params)),this._loadStyles(),this._hook("onBeforeMount")},mounted:function(){this._hook("onMounted")},beforeUpdate:function(){this._hook("onBeforeUpdate")},updated:function(){this._hook("onUpdated")},beforeUnmount:function(){this._hook("onBeforeUnmount")},unmounted:function(){this._removeThemeListeners(),this._unloadScopedThemeStyles(),this._hook("onUnmounted")},methods:{_hook:function(e){if(!this.$options.hostName){var n=this._usePT(this._getPT(this.pt,this.$.type.name),this._getOptionValue,"hooks.".concat(e)),r=this._useDefaultPT(this._getOptionValue,"hooks.".concat(e));n==null||n(),r==null||r()}},_mergeProps:function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),c=1;c<n;c++)r[c-1]=arguments[c];return SS(e)?e.apply(void 0,r):ft.apply(void 0,r)},_load:function(){_p.isStyleNameLoaded("base")||(Kr.loadCSS(this.$styleOptions),this._loadGlobalStyles(),_p.setLoadedStyleName("base")),this._loadThemeStyles()},_loadStyles:function(){this._load(),this._themeChangeListener(this._load)},_loadCoreStyles:function(){var e,n;!_p.isStyleNameLoaded((e=this.$style)===null||e===void 0?void 0:e.name)&&(n=this.$style)!==null&&n!==void 0&&n.name&&(f3.loadCSS(this.$styleOptions),this.$options.style&&this.$style.loadCSS(this.$styleOptions),_p.setLoadedStyleName(this.$style.name))},_loadGlobalStyles:function(){var e=this._useGlobalPT(this._getOptionValue,"global.css",this.$params);xr(e)&&Kr.load(e,Qr({name:"global"},this.$styleOptions))},_loadThemeStyles:function(){var e,n;if(!(this.isUnstyled||this.$theme==="none")){if(!ts.isStyleNameLoaded("common")){var r,c,u=((r=this.$style)===null||r===void 0||(c=r.getCommonTheme)===null||c===void 0?void 0:c.call(r))||{},p=u.primitive,o=u.semantic,w=u.global,T=u.style;Kr.load(p==null?void 0:p.css,Qr({name:"primitive-variables"},this.$styleOptions)),Kr.load(o==null?void 0:o.css,Qr({name:"semantic-variables"},this.$styleOptions)),Kr.load(w==null?void 0:w.css,Qr({name:"global-variables"},this.$styleOptions)),Kr.loadStyle(Qr({name:"global-style"},this.$styleOptions),T),ts.setLoadedStyleName("common")}if(!ts.isStyleNameLoaded((e=this.$style)===null||e===void 0?void 0:e.name)&&(n=this.$style)!==null&&n!==void 0&&n.name){var A,D,B,N,ee=((A=this.$style)===null||A===void 0||(D=A.getComponentTheme)===null||D===void 0?void 0:D.call(A))||{},Q=ee.css,se=ee.style;(B=this.$style)===null||B===void 0||B.load(Q,Qr({name:"".concat(this.$style.name,"-variables")},this.$styleOptions)),(N=this.$style)===null||N===void 0||N.loadStyle(Qr({name:"".concat(this.$style.name,"-style")},this.$styleOptions),se),ts.setLoadedStyleName(this.$style.name)}if(!ts.isStyleNameLoaded("layer-order")){var ce,be,ze=(ce=this.$style)===null||ce===void 0||(be=ce.getLayerOrderThemeCSS)===null||be===void 0?void 0:be.call(ce);Kr.load(ze,Qr({name:"layer-order",first:!0},this.$styleOptions)),ts.setLoadedStyleName("layer-order")}}},_loadScopedThemeStyles:function(e){var n,r,c,u=((n=this.$style)===null||n===void 0||(r=n.getPresetTheme)===null||r===void 0?void 0:r.call(n,e,"[".concat(this.$attrSelector,"]")))||{},p=u.css,o=(c=this.$style)===null||c===void 0?void 0:c.load(p,Qr({name:"".concat(this.$attrSelector,"-").concat(this.$style.name)},this.$styleOptions));this.scopedStyleEl=o.el},_unloadScopedThemeStyles:function(){var e;(e=this.scopedStyleEl)===null||e===void 0||(e=e.value)===null||e===void 0||e.remove()},_themeChangeListener:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};_p.clearLoadedStyleNames(),Wa.on("theme:change",e)},_removeThemeListeners:function(){Wa.off("theme:change",this._loadCoreStyles),Wa.off("theme:change",this._load),Wa.off("theme:change",this._themeScopedListener)},_getHostInstance:function(e){return e?this.$options.hostName?e.$.type.name===this.$options.hostName?e:this._getHostInstance(e.$parentInstance):e.$parentInstance:void 0},_getPropValue:function(e){var n;return this[e]||((n=this._getHostInstance(this))===null||n===void 0?void 0:n[e])},_getOptionValue:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return lI(e,n,r)},_getPTValue:function(){var e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,p=/./g.test(r)&&!!c[r.split(".")[0]],o=this._getPropValue("ptOptions")||((e=this.$primevueConfig)===null||e===void 0?void 0:e.ptOptions)||{},w=o.mergeSections,T=w===void 0?!0:w,A=o.mergeProps,D=A===void 0?!1:A,B=u?p?this._useGlobalPT(this._getPTClassValue,r,c):this._useDefaultPT(this._getPTClassValue,r,c):void 0,N=p?void 0:this._getPTSelf(n,this._getPTClassValue,r,Qr(Qr({},c),{},{global:B||{}})),ee=this._getPTDatasets(r);return T||!T&&N?D?this._mergeProps(D,B,N,ee):Qr(Qr(Qr({},B),N),ee):Qr(Qr({},N),ee)},_getPTSelf:function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length,r=new Array(n>1?n-1:0),c=1;c<n;c++)r[c-1]=arguments[c];return ft(this._usePT.apply(this,[this._getPT(e,this.$name)].concat(r)),this._usePT.apply(this,[this.$_attrsPT].concat(r)))},_getPTDatasets:function(){var e,n,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",c="data-pc-",u=r==="root"&&xr((e=this.pt)===null||e===void 0?void 0:e["data-pc-section"]);return r!=="transition"&&Qr(Qr({},r==="root"&&Qr(Qr(qv({},"".concat(c,"name"),Qd(u?(n=this.pt)===null||n===void 0?void 0:n["data-pc-section"]:this.$.type.name)),u&&qv({},"".concat(c,"extend"),Qd(this.$.type.name))),{},qv({},"".concat(this.$attrSelector),""))),{},qv({},"".concat(c,"section"),Qd(r)))},_getPTClassValue:function(){var e=this._getOptionValue.apply(this,arguments);return fc(e)||Rz(e)?{class:e}:e},_getPT:function(e){var n=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",c=arguments.length>2?arguments[2]:void 0,u=function(o){var w,T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,A=c?c(o):o,D=Qd(r),B=Qd(n.$name);return(w=T?D!==B?A==null?void 0:A[D]:void 0:A==null?void 0:A[D])!==null&&w!==void 0?w:A};return e!=null&&e.hasOwnProperty("_usept")?{_usept:e._usept,originalValue:u(e.originalValue),value:u(e.value)}:u(e,!0)},_usePT:function(e,n,r,c){var u=function(Q){return n(Q,r,c)};if(e!=null&&e.hasOwnProperty("_usept")){var p,o=e._usept||((p=this.$primevueConfig)===null||p===void 0?void 0:p.ptOptions)||{},w=o.mergeSections,T=w===void 0?!0:w,A=o.mergeProps,D=A===void 0?!1:A,B=u(e.originalValue),N=u(e.value);return B===void 0&&N===void 0?void 0:fc(N)?N:fc(B)?B:T||!T&&N?D?this._mergeProps(D,B,N):Qr(Qr({},B),N):N}return u(e)},_useGlobalPT:function(e,n,r){return this._usePT(this.globalPT,e,n,r)},_useDefaultPT:function(e,n,r){return this._usePT(this.defaultPT,e,n,r)},ptm:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._getPTValue(this.pt,e,Qr(Qr({},this.$params),n))},ptmi:function(){var e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=ft(this.$_attrsWithoutPT,this.ptm(n,r));return c!=null&&c.hasOwnProperty("id")&&((e=c.id)!==null&&e!==void 0||(c.id=this.$id)),c},ptmo:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this._getPTValue(e,n,Qr({instance:this},r),!1)},cx:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.isUnstyled?void 0:this._getOptionValue(this.$style.classes,e,Qr(Qr({},this.$params),n))},sx:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n){var c=this._getOptionValue(this.$style.inlineStyles,e,Qr(Qr({},this.$params),r)),u=this._getOptionValue(f3.inlineStyles,e,Qr(Qr({},this.$params),r));return[u,c]}}},computed:{globalPT:function(){var e,n=this;return this._getPT((e=this.$primevueConfig)===null||e===void 0?void 0:e.pt,void 0,function(r){return Lc(r,{instance:n})})},defaultPT:function(){var e,n=this;return this._getPT((e=this.$primevueConfig)===null||e===void 0?void 0:e.pt,void 0,function(r){return n._getOptionValue(r,n.$name,Qr({},n.$params))||Lc(r,Qr({},n.$params))})},isUnstyled:function(){var e;return this.unstyled!==void 0?this.unstyled:(e=this.$primevueConfig)===null||e===void 0?void 0:e.unstyled},$id:function(){return this.$attrs.id||this.uid},$inProps:function(){var e,n=Object.keys(((e=this.$.vnode)===null||e===void 0?void 0:e.props)||{});return Object.fromEntries(Object.entries(this.$props).filter(function(r){var c=zv(r,1),u=c[0];return n==null?void 0:n.includes(u)}))},$theme:function(){var e;return(e=this.$primevueConfig)===null||e===void 0?void 0:e.theme},$style:function(){return Qr(Qr({classes:void 0,inlineStyles:void 0,load:function(){},loadCSS:function(){},loadStyle:function(){}},(this._getHostInstance(this)||{}).$style),this.$options.style)},$styleOptions:function(){var e;return{nonce:(e=this.$primevueConfig)===null||e===void 0||(e=e.csp)===null||e===void 0?void 0:e.nonce}},$primevueConfig:function(){var e;return(e=this.$primevue)===null||e===void 0?void 0:e.config},$name:function(){return this.$options.hostName||this.$.type.name},$params:function(){var e=this._getHostInstance(this)||this.$parent;return{instance:this,props:this.$props,state:this.$data,attrs:this.$attrs,parent:{instance:e,props:e==null?void 0:e.$props,state:e==null?void 0:e.$data,attrs:e==null?void 0:e.$attrs}}},$_attrsPT:function(){return Object.entries(this.$attrs||{}).filter(function(e){var n=zv(e,1),r=n[0];return r==null?void 0:r.startsWith("pt:")}).reduce(function(e,n){var r=zv(n,2),c=r[0],u=r[1],p=c.split(":"),o=qne(p),w=o.slice(1);return w==null||w.reduce(function(T,A,D,B){return!T[A]&&(T[A]=D===B.length-1?u:{}),T[A]},e),e},{})},$_attrsWithoutPT:function(){return Object.entries(this.$attrs||{}).filter(function(e){var n=zv(e,1),r=n[0];return!(r!=null&&r.startsWith("pt:"))}).reduce(function(e,n){var r=zv(n,2),c=r[0],u=r[1];return e[c]=u,e},{})}}},Jne=`
.p-icon {
    display: inline-block;
    vertical-align: baseline;
}

.p-icon-spin {
    -webkit-animation: p-icon-spin 2s infinite linear;
    animation: p-icon-spin 2s infinite linear;
}

@-webkit-keyframes p-icon-spin {
    0% {
        -webkit-transform: rotate(0deg);
        transform: rotate(0deg);
    }
    100% {
        -webkit-transform: rotate(359deg);
        transform: rotate(359deg);
    }
}

@keyframes p-icon-spin {
    0% {
        -webkit-transform: rotate(0deg);
        transform: rotate(0deg);
    }
    100% {
        -webkit-transform: rotate(359deg);
        transform: rotate(359deg);
    }
}
`,Qne=Kr.extend({name:"baseicon",css:Jne});function $b(t){"@babel/helpers - typeof";return $b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$b(t)}function g3(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function _3(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?g3(Object(n),!0).forEach(function(r){eie(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g3(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function eie(t,e,n){return(e=tie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tie(t){var e=nie(t,"string");return $b(e)=="symbol"?e:e+""}function nie(t,e){if($b(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if($b(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var qo={name:"BaseIcon",extends:Lo,props:{label:{type:String,default:void 0},spin:{type:Boolean,default:!1}},style:Qne,provide:function(){return{$pcIcon:this,$parentInstance:this}},methods:{pti:function(){var e=xu(this.label);return _3(_3({},!this.isUnstyled&&{class:["p-icon",{"p-icon-spin":this.spin}]}),{},{role:e?void 0:"img","aria-label":e?void 0:this.label,"aria-hidden":e})}}},dB={name:"ArrowDownIcon",extends:qo};function iie(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.99994 14C6.91097 14.0004 6.82281 13.983 6.74064 13.9489C6.65843 13.9148 6.58387 13.8646 6.52133 13.8013L1.10198 8.38193C0.982318 8.25351 0.917175 8.08367 0.920272 7.90817C0.923368 7.73267 0.994462 7.56523 1.11858 7.44111C1.24269 7.317 1.41014 7.2459 1.58563 7.2428C1.76113 7.23971 1.93098 7.30485 2.0594 7.42451L6.32263 11.6877V0.677419C6.32263 0.497756 6.394 0.325452 6.52104 0.198411C6.64808 0.0713706 6.82039 0 7.00005 0C7.17971 0 7.35202 0.0713706 7.47906 0.198411C7.6061 0.325452 7.67747 0.497756 7.67747 0.677419V11.6877L11.9407 7.42451C12.0691 7.30485 12.2389 7.23971 12.4144 7.2428C12.5899 7.2459 12.7574 7.317 12.8815 7.44111C13.0056 7.56523 13.0767 7.73267 13.0798 7.90817C13.0829 8.08367 13.0178 8.25351 12.8981 8.38193L7.47875 13.8013C7.41621 13.8646 7.34164 13.9148 7.25944 13.9489C7.17727 13.983 7.08912 14.0004 7.00015 14C7.00012 14 7.00009 14 7.00005 14C7.00001 14 6.99998 14 6.99994 14Z",fill:"currentColor"},null,-1)]),16)}dB.render=iie;var hB={name:"ArrowUpIcon",extends:qo};function rie(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.51551 13.799C6.64205 13.9255 6.813 13.9977 6.99193 14C7.17087 13.9977 7.34182 13.9255 7.46835 13.799C7.59489 13.6725 7.66701 13.5015 7.66935 13.3226V2.31233L11.9326 6.57554C11.9951 6.63887 12.0697 6.68907 12.1519 6.72319C12.2341 6.75731 12.3223 6.77467 12.4113 6.77425C12.5003 6.77467 12.5885 6.75731 12.6707 6.72319C12.7529 6.68907 12.8274 6.63887 12.89 6.57554C13.0168 6.44853 13.0881 6.27635 13.0881 6.09683C13.0881 5.91732 13.0168 5.74514 12.89 5.61812L7.48846 0.216594C7.48274 0.210436 7.4769 0.204374 7.47094 0.198411C7.3439 0.0713707 7.1716 0 6.99193 0C6.81227 0 6.63997 0.0713707 6.51293 0.198411C6.50704 0.204296 6.50128 0.210278 6.49563 0.216354L1.09386 5.61812C0.974201 5.74654 0.909057 5.91639 0.912154 6.09189C0.91525 6.26738 0.986345 6.43483 1.11046 6.55894C1.23457 6.68306 1.40202 6.75415 1.57752 6.75725C1.75302 6.76035 1.92286 6.6952 2.05128 6.57554L6.31451 2.31231V13.3226C6.31685 13.5015 6.38898 13.6725 6.51551 13.799Z",fill:"currentColor"},null,-1)]),16)}hB.render=rie;var A0={name:"SpinnerIcon",extends:qo};function oie(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{d:"M6.99701 14C5.85441 13.999 4.72939 13.7186 3.72012 13.1832C2.71084 12.6478 1.84795 11.8737 1.20673 10.9284C0.565504 9.98305 0.165424 8.89526 0.041387 7.75989C-0.0826496 6.62453 0.073125 5.47607 0.495122 4.4147C0.917119 3.35333 1.59252 2.4113 2.46241 1.67077C3.33229 0.930247 4.37024 0.413729 5.4857 0.166275C6.60117 -0.0811796 7.76026 -0.0520535 8.86188 0.251112C9.9635 0.554278 10.9742 1.12227 11.8057 1.90555C11.915 2.01493 11.9764 2.16319 11.9764 2.31778C11.9764 2.47236 11.915 2.62062 11.8057 2.73C11.7521 2.78503 11.688 2.82877 11.6171 2.85864C11.5463 2.8885 11.4702 2.90389 11.3933 2.90389C11.3165 2.90389 11.2404 2.8885 11.1695 2.85864C11.0987 2.82877 11.0346 2.78503 10.9809 2.73C9.9998 1.81273 8.73246 1.26138 7.39226 1.16876C6.05206 1.07615 4.72086 1.44794 3.62279 2.22152C2.52471 2.99511 1.72683 4.12325 1.36345 5.41602C1.00008 6.70879 1.09342 8.08723 1.62775 9.31926C2.16209 10.5513 3.10478 11.5617 4.29713 12.1803C5.48947 12.7989 6.85865 12.988 8.17414 12.7157C9.48963 12.4435 10.6711 11.7264 11.5196 10.6854C12.3681 9.64432 12.8319 8.34282 12.8328 7C12.8328 6.84529 12.8943 6.69692 13.0038 6.58752C13.1132 6.47812 13.2616 6.41667 13.4164 6.41667C13.5712 6.41667 13.7196 6.47812 13.8291 6.58752C13.9385 6.69692 14 6.84529 14 7C14 8.85651 13.2622 10.637 11.9489 11.9497C10.6356 13.2625 8.85432 14 6.99701 14Z",fill:"currentColor"},null,-1)]),16)}A0.render=oie;var sie=`
    .p-paginator {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-wrap: wrap;
        background: dt('paginator.background');
        color: dt('paginator.color');
        padding: dt('paginator.padding');
        border-radius: dt('paginator.border.radius');
        gap: dt('paginator.gap');
    }

    .p-paginator-content {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-wrap: wrap;
        gap: dt('paginator.gap');
    }

    .p-paginator-content-start {
        margin-inline-end: auto;
    }

    .p-paginator-content-end {
        margin-inline-start: auto;
    }

    .p-paginator-page,
    .p-paginator-next,
    .p-paginator-last,
    .p-paginator-first,
    .p-paginator-prev {
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        line-height: 1;
        user-select: none;
        overflow: hidden;
        position: relative;
        background: dt('paginator.nav.button.background');
        border: 0 none;
        color: dt('paginator.nav.button.color');
        min-width: dt('paginator.nav.button.width');
        height: dt('paginator.nav.button.height');
        transition:
            background dt('paginator.transition.duration'),
            color dt('paginator.transition.duration'),
            outline-color dt('paginator.transition.duration'),
            box-shadow dt('paginator.transition.duration');
        border-radius: dt('paginator.nav.button.border.radius');
        padding: 0;
        margin: 0;
    }

    .p-paginator-page:focus-visible,
    .p-paginator-next:focus-visible,
    .p-paginator-last:focus-visible,
    .p-paginator-first:focus-visible,
    .p-paginator-prev:focus-visible {
        box-shadow: dt('paginator.nav.button.focus.ring.shadow');
        outline: dt('paginator.nav.button.focus.ring.width') dt('paginator.nav.button.focus.ring.style') dt('paginator.nav.button.focus.ring.color');
        outline-offset: dt('paginator.nav.button.focus.ring.offset');
    }

    .p-paginator-page:not(.p-disabled):not(.p-paginator-page-selected):hover,
    .p-paginator-first:not(.p-disabled):hover,
    .p-paginator-prev:not(.p-disabled):hover,
    .p-paginator-next:not(.p-disabled):hover,
    .p-paginator-last:not(.p-disabled):hover {
        background: dt('paginator.nav.button.hover.background');
        color: dt('paginator.nav.button.hover.color');
    }

    .p-paginator-page.p-paginator-page-selected {
        background: dt('paginator.nav.button.selected.background');
        color: dt('paginator.nav.button.selected.color');
    }

    .p-paginator-current {
        color: dt('paginator.current.page.report.color');
    }

    .p-paginator-pages {
        display: flex;
        align-items: center;
        gap: dt('paginator.gap');
    }

    .p-paginator-jtp-input .p-inputtext {
        max-width: dt('paginator.jump.to.page.input.max.width');
    }

    .p-paginator-first:dir(rtl),
    .p-paginator-prev:dir(rtl),
    .p-paginator-next:dir(rtl),
    .p-paginator-last:dir(rtl) {
        transform: rotate(180deg);
    }
`;function jb(t){"@babel/helpers - typeof";return jb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jb(t)}function aie(t,e,n){return(e=lie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lie(t){var e=cie(t,"string");return jb(e)=="symbol"?e:e+""}function cie(t,e){if(jb(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(jb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var uie={paginator:function(e){var n=e.instance,r=e.key;return["p-paginator p-component",aie({"p-paginator-default":!n.hasBreakpoints()},"p-paginator-".concat(r),n.hasBreakpoints())]},content:"p-paginator-content",contentStart:"p-paginator-content-start",contentEnd:"p-paginator-content-end",first:function(e){var n=e.instance;return["p-paginator-first",{"p-disabled":n.$attrs.disabled}]},firstIcon:"p-paginator-first-icon",prev:function(e){var n=e.instance;return["p-paginator-prev",{"p-disabled":n.$attrs.disabled}]},prevIcon:"p-paginator-prev-icon",next:function(e){var n=e.instance;return["p-paginator-next",{"p-disabled":n.$attrs.disabled}]},nextIcon:"p-paginator-next-icon",last:function(e){var n=e.instance;return["p-paginator-last",{"p-disabled":n.$attrs.disabled}]},lastIcon:"p-paginator-last-icon",pages:"p-paginator-pages",page:function(e){var n=e.props,r=e.pageLink;return["p-paginator-page",{"p-paginator-page-selected":r-1===n.page}]},current:"p-paginator-current",pcRowPerPageDropdown:"p-paginator-rpp-dropdown",pcJumpToPageDropdown:"p-paginator-jtp-dropdown",pcJumpToPageInputText:"p-paginator-jtp-input"},die=Kr.extend({name:"paginator",style:sie,classes:uie}),fB={name:"AngleDoubleLeftIcon",extends:qo};function hie(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.71602 11.164C5.80782 11.2021 5.9063 11.2215 6.00569 11.221C6.20216 11.2301 6.39427 11.1612 6.54025 11.0294C6.68191 10.8875 6.76148 10.6953 6.76148 10.4948C6.76148 10.2943 6.68191 10.1021 6.54025 9.96024L3.51441 6.9344L6.54025 3.90855C6.624 3.76126 6.65587 3.59011 6.63076 3.42254C6.60564 3.25498 6.525 3.10069 6.40175 2.98442C6.2785 2.86815 6.11978 2.79662 5.95104 2.7813C5.78229 2.76598 5.61329 2.80776 5.47112 2.89994L1.97123 6.39983C1.82957 6.54167 1.75 6.73393 1.75 6.9344C1.75 7.13486 1.82957 7.32712 1.97123 7.46896L5.47112 10.9991C5.54096 11.0698 5.62422 11.1259 5.71602 11.164ZM11.0488 10.9689C11.1775 11.1156 11.3585 11.2061 11.5531 11.221C11.7477 11.2061 11.9288 11.1156 12.0574 10.9689C12.1815 10.8302 12.25 10.6506 12.25 10.4645C12.25 10.2785 12.1815 10.0989 12.0574 9.96024L9.03158 6.93439L12.0574 3.90855C12.1248 3.76739 12.1468 3.60881 12.1204 3.45463C12.0939 3.30045 12.0203 3.15826 11.9097 3.04765C11.7991 2.93703 11.6569 2.86343 11.5027 2.83698C11.3486 2.81053 11.19 2.83252 11.0488 2.89994L7.51865 6.36957C7.37699 6.51141 7.29742 6.70367 7.29742 6.90414C7.29742 7.1046 7.37699 7.29686 7.51865 7.4387L11.0488 10.9689Z",fill:"currentColor"},null,-1)]),16)}fB.render=hie;function Ub(t){"@babel/helpers - typeof";return Ub=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ub(t)}function y3(t,e){return gie(t)||mie(t,e)||pie(t,e)||fie()}function fie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pie(t,e){if(t){if(typeof t=="string")return v3(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v3(t,e):void 0}}function v3(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function mie(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,c,u,p,o=[],w=!0,T=!1;try{if(u=(n=n.call(t)).next,e!==0)for(;!(w=(r=u.call(n)).done)&&(o.push(r.value),o.length!==e);w=!0);}catch(A){T=!0,c=A}finally{try{if(!w&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(T)throw c}}return o}}function gie(t){if(Array.isArray(t))return t}function b3(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function xo(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?b3(Object(n),!0).forEach(function(r){XT(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):b3(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function XT(t,e,n){return(e=_ie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ie(t){var e=yie(t,"string");return Ub(e)=="symbol"?e:e+""}function yie(t,e){if(Ub(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Ub(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ir={_getMeta:function(){return[ih(arguments.length<=0?void 0:arguments[0])||arguments.length<=0?void 0:arguments[0],Lc(ih(arguments.length<=0?void 0:arguments[0])?arguments.length<=0?void 0:arguments[0]:arguments.length<=1?void 0:arguments[1])]},_getConfig:function(e,n){var r,c,u;return(r=(e==null||(c=e.instance)===null||c===void 0?void 0:c.$primevue)||(n==null||(u=n.ctx)===null||u===void 0||(u=u.appContext)===null||u===void 0||(u=u.config)===null||u===void 0||(u=u.globalProperties)===null||u===void 0?void 0:u.$primevue))===null||r===void 0?void 0:r.config},_getOptionValue:lI,_getPTValue:function(){var e,n,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,w=function(){var be=Ir._getOptionValue.apply(Ir,arguments);return fc(be)||Rz(be)?{class:be}:be},T=((e=r.binding)===null||e===void 0||(e=e.value)===null||e===void 0?void 0:e.ptOptions)||((n=r.$primevueConfig)===null||n===void 0?void 0:n.ptOptions)||{},A=T.mergeSections,D=A===void 0?!0:A,B=T.mergeProps,N=B===void 0?!1:B,ee=o?Ir._useDefaultPT(r,r.defaultPT(),w,u,p):void 0,Q=Ir._usePT(r,Ir._getPT(c,r.$name),w,u,xo(xo({},p),{},{global:ee||{}})),se=Ir._getPTDatasets(r,u);return D||!D&&Q?N?Ir._mergeProps(r,N,ee,Q,se):xo(xo(xo({},ee),Q),se):xo(xo({},Q),se)},_getPTDatasets:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r="data-pc-";return xo(xo({},n==="root"&&XT({},"".concat(r,"name"),Qd(e.$name))),{},XT({},"".concat(r,"section"),Qd(n)))},_getPT:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0,c=function(p){var o,w=r?r(p):p,T=Qd(n);return(o=w==null?void 0:w[T])!==null&&o!==void 0?o:w};return e&&Object.hasOwn(e,"_usept")?{_usept:e._usept,originalValue:c(e.originalValue),value:c(e.value)}:c(e)},_usePT:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0,u=arguments.length>4?arguments[4]:void 0,p=function(se){return r(se,c,u)};if(n&&Object.hasOwn(n,"_usept")){var o,w=n._usept||((o=e.$primevueConfig)===null||o===void 0?void 0:o.ptOptions)||{},T=w.mergeSections,A=T===void 0?!0:T,D=w.mergeProps,B=D===void 0?!1:D,N=p(n.originalValue),ee=p(n.value);return N===void 0&&ee===void 0?void 0:fc(ee)?ee:fc(N)?N:A||!A&&ee?B?Ir._mergeProps(e,B,N,ee):xo(xo({},N),ee):ee}return p(n)},_useDefaultPT:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0,u=arguments.length>4?arguments[4]:void 0;return Ir._usePT(e,n,r,c,u)},_loadStyles:function(){var e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0,c=arguments.length>2?arguments[2]:void 0,u=Ir._getConfig(r,c),p={nonce:u==null||(e=u.csp)===null||e===void 0?void 0:e.nonce};Ir._loadCoreStyles(n,p),Ir._loadThemeStyles(n,p),Ir._loadScopedThemeStyles(n,p),Ir._removeThemeListeners(n),n.$loadStyles=function(){return Ir._loadThemeStyles(n,p)},Ir._themeChangeListener(n.$loadStyles)},_loadCoreStyles:function(){var e,n,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=arguments.length>1?arguments[1]:void 0;if(!_p.isStyleNameLoaded((e=r.$style)===null||e===void 0?void 0:e.name)&&(n=r.$style)!==null&&n!==void 0&&n.name){var u;Kr.loadCSS(c),(u=r.$style)===null||u===void 0||u.loadCSS(c),_p.setLoadedStyleName(r.$style.name)}},_loadThemeStyles:function(){var e,n,r,c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=arguments.length>1?arguments[1]:void 0;if(!(c!=null&&c.isUnstyled()||(c==null||(e=c.theme)===null||e===void 0?void 0:e.call(c))==="none")){if(!ts.isStyleNameLoaded("common")){var p,o,w=((p=c.$style)===null||p===void 0||(o=p.getCommonTheme)===null||o===void 0?void 0:o.call(p))||{},T=w.primitive,A=w.semantic,D=w.global,B=w.style;Kr.load(T==null?void 0:T.css,xo({name:"primitive-variables"},u)),Kr.load(A==null?void 0:A.css,xo({name:"semantic-variables"},u)),Kr.load(D==null?void 0:D.css,xo({name:"global-variables"},u)),Kr.loadStyle(xo({name:"global-style"},u),B),ts.setLoadedStyleName("common")}if(!ts.isStyleNameLoaded((n=c.$style)===null||n===void 0?void 0:n.name)&&(r=c.$style)!==null&&r!==void 0&&r.name){var N,ee,Q,se,ce=((N=c.$style)===null||N===void 0||(ee=N.getDirectiveTheme)===null||ee===void 0?void 0:ee.call(N))||{},be=ce.css,ze=ce.style;(Q=c.$style)===null||Q===void 0||Q.load(be,xo({name:"".concat(c.$style.name,"-variables")},u)),(se=c.$style)===null||se===void 0||se.loadStyle(xo({name:"".concat(c.$style.name,"-style")},u),ze),ts.setLoadedStyleName(c.$style.name)}if(!ts.isStyleNameLoaded("layer-order")){var xe,je,qe=(xe=c.$style)===null||xe===void 0||(je=xe.getLayerOrderThemeCSS)===null||je===void 0?void 0:je.call(xe);Kr.load(qe,xo({name:"layer-order",first:!0},u)),ts.setLoadedStyleName("layer-order")}}},_loadScopedThemeStyles:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,r=e.preset();if(r&&e.$attrSelector){var c,u,p,o=((c=e.$style)===null||c===void 0||(u=c.getPresetTheme)===null||u===void 0?void 0:u.call(c,r,"[".concat(e.$attrSelector,"]")))||{},w=o.css,T=(p=e.$style)===null||p===void 0?void 0:p.load(w,xo({name:"".concat(e.$attrSelector,"-").concat(e.$style.name)},n));e.scopedStyleEl=T.el}},_themeChangeListener:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};_p.clearLoadedStyleNames(),Wa.on("theme:change",e)},_removeThemeListeners:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Wa.off("theme:change",e.$loadStyles),e.$loadStyles=void 0},_hook:function(e,n,r,c,u,p){var o,w,T="on".concat(aG(n)),A=Ir._getConfig(c,u),D=r==null?void 0:r.$instance,B=Ir._usePT(D,Ir._getPT(c==null||(o=c.value)===null||o===void 0?void 0:o.pt,e),Ir._getOptionValue,"hooks.".concat(T)),N=Ir._useDefaultPT(D,A==null||(w=A.pt)===null||w===void 0||(w=w.directives)===null||w===void 0?void 0:w[e],Ir._getOptionValue,"hooks.".concat(T)),ee={el:r,binding:c,vnode:u,prevVnode:p};B==null||B(D,ee),N==null||N(D,ee)},_mergeProps:function(){for(var e=arguments.length>1?arguments[1]:void 0,n=arguments.length,r=new Array(n>2?n-2:0),c=2;c<n;c++)r[c-2]=arguments[c];return SS(e)?e.apply(void 0,r):ft.apply(void 0,r)},_extend:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=function(o,w,T,A,D){var B,N,ee,Q;w._$instances=w._$instances||{};var se=Ir._getConfig(T,A),ce=w._$instances[e]||{},be=xu(ce)?xo(xo({},n),n==null?void 0:n.methods):{};w._$instances[e]=xo(xo({},ce),{},{$name:e,$host:w,$binding:T,$modifiers:T==null?void 0:T.modifiers,$value:T==null?void 0:T.value,$el:ce.$el||w||void 0,$style:xo({classes:void 0,inlineStyles:void 0,load:function(){},loadCSS:function(){},loadStyle:function(){}},n==null?void 0:n.style),$primevueConfig:se,$attrSelector:(B=w.$pd)===null||B===void 0||(B=B[e])===null||B===void 0?void 0:B.attrSelector,defaultPT:function(){return Ir._getPT(se==null?void 0:se.pt,void 0,function(xe){var je;return xe==null||(je=xe.directives)===null||je===void 0?void 0:je[e]})},isUnstyled:function(){var xe,je;return((xe=w._$instances[e])===null||xe===void 0||(xe=xe.$binding)===null||xe===void 0||(xe=xe.value)===null||xe===void 0?void 0:xe.unstyled)!==void 0?(je=w._$instances[e])===null||je===void 0||(je=je.$binding)===null||je===void 0||(je=je.value)===null||je===void 0?void 0:je.unstyled:se==null?void 0:se.unstyled},theme:function(){var xe;return(xe=w._$instances[e])===null||xe===void 0||(xe=xe.$primevueConfig)===null||xe===void 0?void 0:xe.theme},preset:function(){var xe;return(xe=w._$instances[e])===null||xe===void 0||(xe=xe.$binding)===null||xe===void 0||(xe=xe.value)===null||xe===void 0?void 0:xe.dt},ptm:function(){var xe,je=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",qe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ir._getPTValue(w._$instances[e],(xe=w._$instances[e])===null||xe===void 0||(xe=xe.$binding)===null||xe===void 0||(xe=xe.value)===null||xe===void 0?void 0:xe.pt,je,xo({},qe))},ptmo:function(){var xe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},je=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",qe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Ir._getPTValue(w._$instances[e],xe,je,qe,!1)},cx:function(){var xe,je,qe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(xe=w._$instances[e])!==null&&xe!==void 0&&xe.isUnstyled()?void 0:Ir._getOptionValue((je=w._$instances[e])===null||je===void 0||(je=je.$style)===null||je===void 0?void 0:je.classes,qe,xo({},oe))},sx:function(){var xe,je=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",qe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,oe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return qe?Ir._getOptionValue((xe=w._$instances[e])===null||xe===void 0||(xe=xe.$style)===null||xe===void 0?void 0:xe.inlineStyles,je,xo({},oe)):void 0}},be),w.$instance=w._$instances[e],(N=(ee=w.$instance)[o])===null||N===void 0||N.call(ee,w,T,A,D),w["$".concat(e)]=w.$instance,Ir._hook(e,o,w,T,A,D),w.$pd||(w.$pd={}),w.$pd[e]=xo(xo({},(Q=w.$pd)===null||Q===void 0?void 0:Q[e]),{},{name:e,instance:w._$instances[e]})},c=function(o){var w,T,A,D=o._$instances[e],B=D==null?void 0:D.watch,N=function(se){var ce,be=se.newValue,ze=se.oldValue;return B==null||(ce=B.config)===null||ce===void 0?void 0:ce.call(D,be,ze)},ee=function(se){var ce,be=se.newValue,ze=se.oldValue;return B==null||(ce=B["config.ripple"])===null||ce===void 0?void 0:ce.call(D,be,ze)};D.$watchersCallback={config:N,"config.ripple":ee},B==null||(w=B.config)===null||w===void 0||w.call(D,D==null?void 0:D.$primevueConfig),wp.on("config:change",N),B==null||(T=B["config.ripple"])===null||T===void 0||T.call(D,D==null||(A=D.$primevueConfig)===null||A===void 0?void 0:A.ripple),wp.on("config:ripple:change",ee)},u=function(o){var w=o._$instances[e].$watchersCallback;w&&(wp.off("config:change",w.config),wp.off("config:ripple:change",w["config.ripple"]),o._$instances[e].$watchersCallback=void 0)};return{created:function(o,w,T,A){o.$pd||(o.$pd={}),o.$pd[e]={name:e,attrSelector:vG("pd")},r("created",o,w,T,A)},beforeMount:function(o,w,T,A){var D;Ir._loadStyles((D=o.$pd[e])===null||D===void 0?void 0:D.instance,w,T),r("beforeMount",o,w,T,A),c(o)},mounted:function(o,w,T,A){var D;Ir._loadStyles((D=o.$pd[e])===null||D===void 0?void 0:D.instance,w,T),r("mounted",o,w,T,A)},beforeUpdate:function(o,w,T,A){r("beforeUpdate",o,w,T,A)},updated:function(o,w,T,A){var D;Ir._loadStyles((D=o.$pd[e])===null||D===void 0?void 0:D.instance,w,T),r("updated",o,w,T,A)},beforeUnmount:function(o,w,T,A){var D;u(o),Ir._removeThemeListeners((D=o.$pd[e])===null||D===void 0?void 0:D.instance),r("beforeUnmount",o,w,T,A)},unmounted:function(o,w,T,A){var D;(D=o.$pd[e])===null||D===void 0||(D=D.instance)===null||D===void 0||(D=D.scopedStyleEl)===null||D===void 0||(D=D.value)===null||D===void 0||D.remove(),r("unmounted",o,w,T,A)}}},extend:function(){var e=Ir._getMeta.apply(Ir,arguments),n=y3(e,2),r=n[0],c=n[1];return xo({extend:function(){var p=Ir._getMeta.apply(Ir,arguments),o=y3(p,2),w=o[0],T=o[1];return Ir.extend(w,xo(xo(xo({},c),c==null?void 0:c.methods),T))}},Ir._extend(r,c))}},vie=`
    .p-ink {
        display: block;
        position: absolute;
        background: dt('ripple.background');
        border-radius: 100%;
        transform: scale(0);
        pointer-events: none;
    }

    .p-ink-active {
        animation: ripple 0.4s linear;
    }

    @keyframes ripple {
        100% {
            opacity: 0;
            transform: scale(2.5);
        }
    }
`,bie={root:"p-ink"},xie=Kr.extend({name:"ripple-directive",style:vie,classes:bie}),wie=Ir.extend({style:xie});function Hb(t){"@babel/helpers - typeof";return Hb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hb(t)}function Sie(t){return Iie(t)||Eie(t)||Tie(t)||Cie()}function Cie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tie(t,e){if(t){if(typeof t=="string")return YT(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?YT(t,e):void 0}}function Eie(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Iie(t){if(Array.isArray(t))return YT(t)}function YT(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function x3(t,e,n){return(e=Aie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aie(t){var e=kie(t,"string");return Hb(e)=="symbol"?e:e+""}function kie(t,e){if(Hb(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Hb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Wp=wie.extend("ripple",{watch:{"config.ripple":function(e){e?(this.createRipple(this.$host),this.bindEvents(this.$host),this.$host.setAttribute("data-pd-ripple",!0),this.$host.style.overflow="hidden",this.$host.style.position="relative"):(this.remove(this.$host),this.$host.removeAttribute("data-pd-ripple"))}},unmounted:function(e){this.remove(e)},timeout:void 0,methods:{bindEvents:function(e){e.addEventListener("mousedown",this.onMouseDown.bind(this))},unbindEvents:function(e){e.removeEventListener("mousedown",this.onMouseDown.bind(this))},createRipple:function(e){var n=this.getInk(e);n||(n=zz("span",x3(x3({role:"presentation","aria-hidden":!0,"data-p-ink":!0,"data-p-ink-active":!1,class:!this.isUnstyled()&&this.cx("root"),onAnimationEnd:this.onAnimationEnd.bind(this)},this.$attrSelector,""),"p-bind",this.ptm("root"))),e.appendChild(n),this.$el=n)},remove:function(e){var n=this.getInk(e);n&&(this.$host.style.overflow="",this.$host.style.position="",this.unbindEvents(e),n.removeEventListener("animationend",this.onAnimationEnd),n.remove())},onMouseDown:function(e){var n=this,r=e.currentTarget,c=this.getInk(r);if(!(!c||getComputedStyle(c,null).display==="none")){if(!this.isUnstyled()&&mp(c,"p-ink-active"),c.setAttribute("data-p-ink-active","false"),!Ym(c)&&!Jm(c)){var u=Math.max(dc(r),ww(r));c.style.height=u+"px",c.style.width=u+"px"}var p=A_(r),o=e.pageX-p.left+document.body.scrollTop-Jm(c)/2,w=e.pageY-p.top+document.body.scrollLeft-Ym(c)/2;c.style.top=w+"px",c.style.left=o+"px",!this.isUnstyled()&&Wv(c,"p-ink-active"),c.setAttribute("data-p-ink-active","true"),this.timeout=setTimeout(function(){c&&(!n.isUnstyled()&&mp(c,"p-ink-active"),c.setAttribute("data-p-ink-active","false"))},401)}},onAnimationEnd:function(e){this.timeout&&clearTimeout(this.timeout),!this.isUnstyled()&&mp(e.currentTarget,"p-ink-active"),e.currentTarget.setAttribute("data-p-ink-active","false")},getInk:function(e){return e&&e.children?Sie(e.children).find(function(n){return La(n,"data-pc-name")==="ripple"}):void 0}}}),pB={name:"BlankIcon",extends:qo};function Rie(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("rect",{width:"1",height:"1",fill:"currentColor","fill-opacity":"0"},null,-1)]),16)}pB.render=Rie;var fy={name:"CheckIcon",extends:qo};function Pie(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{d:"M4.86199 11.5948C4.78717 11.5923 4.71366 11.5745 4.64596 11.5426C4.57826 11.5107 4.51779 11.4652 4.46827 11.4091L0.753985 7.69483C0.683167 7.64891 0.623706 7.58751 0.580092 7.51525C0.536478 7.44299 0.509851 7.36177 0.502221 7.27771C0.49459 7.19366 0.506156 7.10897 0.536046 7.03004C0.565935 6.95111 0.613367 6.88 0.674759 6.82208C0.736151 6.76416 0.8099 6.72095 0.890436 6.69571C0.970973 6.67046 1.05619 6.66385 1.13966 6.67635C1.22313 6.68886 1.30266 6.72017 1.37226 6.76792C1.44186 6.81567 1.4997 6.8786 1.54141 6.95197L4.86199 10.2503L12.6397 2.49483C12.7444 2.42694 12.8689 2.39617 12.9932 2.40745C13.1174 2.41873 13.2343 2.47141 13.3251 2.55705C13.4159 2.64268 13.4753 2.75632 13.4938 2.87973C13.5123 3.00315 13.4888 3.1292 13.4271 3.23768L5.2557 11.4091C5.20618 11.4652 5.14571 11.5107 5.07801 11.5426C5.01031 11.5745 4.9368 11.5923 4.86199 11.5948Z",fill:"currentColor"},null,-1)]),16)}fy.render=Pie;var AS={name:"ChevronDownIcon",extends:qo};function Mie(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{d:"M7.01744 10.398C6.91269 10.3985 6.8089 10.378 6.71215 10.3379C6.61541 10.2977 6.52766 10.2386 6.45405 10.1641L1.13907 4.84913C1.03306 4.69404 0.985221 4.5065 1.00399 4.31958C1.02276 4.13266 1.10693 3.95838 1.24166 3.82747C1.37639 3.69655 1.55301 3.61742 1.74039 3.60402C1.92777 3.59062 2.11386 3.64382 2.26584 3.75424L7.01744 8.47394L11.769 3.75424C11.9189 3.65709 12.097 3.61306 12.2748 3.62921C12.4527 3.64535 12.6199 3.72073 12.7498 3.84328C12.8797 3.96582 12.9647 4.12842 12.9912 4.30502C13.0177 4.48162 12.9841 4.662 12.8958 4.81724L7.58083 10.1322C7.50996 10.2125 7.42344 10.2775 7.32656 10.3232C7.22968 10.3689 7.12449 10.3944 7.01744 10.398Z",fill:"currentColor"},null,-1)]),16)}AS.render=Mie;var mB={name:"SearchIcon",extends:qo};function Die(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M2.67602 11.0265C3.6661 11.688 4.83011 12.0411 6.02086 12.0411C6.81149 12.0411 7.59438 11.8854 8.32483 11.5828C8.87005 11.357 9.37808 11.0526 9.83317 10.6803L12.9769 13.8241C13.0323 13.8801 13.0983 13.9245 13.171 13.9548C13.2438 13.985 13.3219 14.0003 13.4007 14C13.4795 14.0003 13.5575 13.985 13.6303 13.9548C13.7031 13.9245 13.7691 13.8801 13.8244 13.8241C13.9367 13.7116 13.9998 13.5592 13.9998 13.4003C13.9998 13.2414 13.9367 13.089 13.8244 12.9765L10.6807 9.8328C11.053 9.37773 11.3573 8.86972 11.5831 8.32452C11.8857 7.59408 12.0414 6.81119 12.0414 6.02056C12.0414 4.8298 11.6883 3.66579 11.0268 2.67572C10.3652 1.68564 9.42494 0.913972 8.32483 0.45829C7.22472 0.00260857 6.01418 -0.116618 4.84631 0.115686C3.67844 0.34799 2.60568 0.921393 1.76369 1.76338C0.921698 2.60537 0.348296 3.67813 0.115991 4.84601C-0.116313 6.01388 0.00291375 7.22441 0.458595 8.32452C0.914277 9.42464 1.68595 10.3649 2.67602 11.0265ZM3.35565 2.0158C4.14456 1.48867 5.07206 1.20731 6.02086 1.20731C7.29317 1.20731 8.51338 1.71274 9.41304 2.6124C10.3127 3.51206 10.8181 4.73226 10.8181 6.00457C10.8181 6.95337 10.5368 7.88088 10.0096 8.66978C9.48251 9.45868 8.73328 10.0736 7.85669 10.4367C6.98011 10.7997 6.01554 10.8947 5.08496 10.7096C4.15439 10.5245 3.2996 10.0676 2.62869 9.39674C1.95778 8.72583 1.50089 7.87104 1.31579 6.94046C1.13068 6.00989 1.22568 5.04532 1.58878 4.16874C1.95187 3.29215 2.56675 2.54292 3.35565 2.0158Z",fill:"currentColor"},null,-1)]),16)}mB.render=Die;var mI={name:"TimesIcon",extends:qo};function Oie(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{d:"M8.01186 7.00933L12.27 2.75116C12.341 2.68501 12.398 2.60524 12.4375 2.51661C12.4769 2.42798 12.4982 2.3323 12.4999 2.23529C12.5016 2.13827 12.4838 2.0419 12.4474 1.95194C12.4111 1.86197 12.357 1.78024 12.2884 1.71163C12.2198 1.64302 12.138 1.58893 12.0481 1.55259C11.9581 1.51625 11.8617 1.4984 11.7647 1.50011C11.6677 1.50182 11.572 1.52306 11.4834 1.56255C11.3948 1.60204 11.315 1.65898 11.2488 1.72997L6.99067 5.98814L2.7325 1.72997C2.59553 1.60234 2.41437 1.53286 2.22718 1.53616C2.03999 1.53946 1.8614 1.61529 1.72901 1.74767C1.59663 1.88006 1.5208 2.05865 1.5175 2.24584C1.5142 2.43303 1.58368 2.61419 1.71131 2.75116L5.96948 7.00933L1.71131 11.2675C1.576 11.403 1.5 11.5866 1.5 11.7781C1.5 11.9696 1.576 12.1532 1.71131 12.2887C1.84679 12.424 2.03043 12.5 2.2219 12.5C2.41338 12.5 2.59702 12.424 2.7325 12.2887L6.99067 8.03052L11.2488 12.2887C11.3843 12.424 11.568 12.5 11.7594 12.5C11.9509 12.5 12.1346 12.424 12.27 12.2887C12.4053 12.1532 12.4813 11.9696 12.4813 11.7781C12.4813 11.5866 12.4053 11.403 12.27 11.2675L8.01186 7.00933Z",fill:"currentColor"},null,-1)]),16)}mI.render=Oie;var Lie=`
    .p-iconfield {
        position: relative;
        display: block;
    }

    .p-inputicon {
        position: absolute;
        top: 50%;
        margin-top: calc(-1 * (dt('icon.size') / 2));
        color: dt('iconfield.icon.color');
        line-height: 1;
        z-index: 1;
    }

    .p-iconfield .p-inputicon:first-child {
        inset-inline-start: dt('form.field.padding.x');
    }

    .p-iconfield .p-inputicon:last-child {
        inset-inline-end: dt('form.field.padding.x');
    }

    .p-iconfield .p-inputtext:not(:first-child),
    .p-iconfield .p-inputwrapper:not(:first-child) .p-inputtext {
        padding-inline-start: calc((dt('form.field.padding.x') * 2) + dt('icon.size'));
    }

    .p-iconfield .p-inputtext:not(:last-child) {
        padding-inline-end: calc((dt('form.field.padding.x') * 2) + dt('icon.size'));
    }

    .p-iconfield:has(.p-inputfield-sm) .p-inputicon {
        font-size: dt('form.field.sm.font.size');
        width: dt('form.field.sm.font.size');
        height: dt('form.field.sm.font.size');
        margin-top: calc(-1 * (dt('form.field.sm.font.size') / 2));
    }

    .p-iconfield:has(.p-inputfield-lg) .p-inputicon {
        font-size: dt('form.field.lg.font.size');
        width: dt('form.field.lg.font.size');
        height: dt('form.field.lg.font.size');
        margin-top: calc(-1 * (dt('form.field.lg.font.size') / 2));
    }
`,zie={root:"p-iconfield"},Bie=Kr.extend({name:"iconfield",style:Lie,classes:zie}),Fie={name:"BaseIconField",extends:Lo,style:Bie,provide:function(){return{$pcIconField:this,$parentInstance:this}}},gB={name:"IconField",extends:Fie,inheritAttrs:!1};function Nie(t,e,n,r,c,u){return We(),wt("div",ft({class:t.cx("root")},t.ptmi("root")),[Ti(t.$slots,"default")],16)}gB.render=Nie;var Vie={root:"p-inputicon"},$ie=Kr.extend({name:"inputicon",classes:Vie}),jie={name:"BaseInputIcon",extends:Lo,style:$ie,props:{class:null},provide:function(){return{$pcInputIcon:this,$parentInstance:this}}},_B={name:"InputIcon",extends:jie,inheritAttrs:!1,computed:{containerClass:function(){return[this.cx("root"),this.class]}}};function Uie(t,e,n,r,c,u){return We(),wt("span",ft({class:u.containerClass},t.ptmi("root"),{"aria-hidden":"true"}),[Ti(t.$slots,"default")],16)}_B.render=Uie;var yB={name:"BaseEditableHolder",extends:Lo,emits:["update:modelValue","value-change"],props:{modelValue:{type:null,default:void 0},defaultValue:{type:null,default:void 0},name:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},disabled:{type:Boolean,default:!1},formControl:{type:Object,default:void 0}},inject:{$parentInstance:{default:void 0},$pcForm:{default:void 0},$pcFormField:{default:void 0}},data:function(){return{d_value:this.defaultValue!==void 0?this.defaultValue:this.modelValue}},watch:{modelValue:function(e){this.d_value=e},defaultValue:function(e){this.d_value=e},$formName:{immediate:!0,handler:function(e){var n,r;this.formField=((n=this.$pcForm)===null||n===void 0||(r=n.register)===null||r===void 0?void 0:r.call(n,e,this.$formControl))||{}}},$formControl:{immediate:!0,handler:function(e){var n,r;this.formField=((n=this.$pcForm)===null||n===void 0||(r=n.register)===null||r===void 0?void 0:r.call(n,this.$formName,e))||{}}},$formDefaultValue:{immediate:!0,handler:function(e){this.d_value!==e&&(this.d_value=e)}},$formValue:{immediate:!1,handler:function(e){var n;(n=this.$pcForm)!==null&&n!==void 0&&n.getFieldState(this.$formName)&&e!==this.d_value&&(this.d_value=e)}}},formField:{},methods:{writeValue:function(e,n){var r,c;this.controlled&&(this.d_value=e,this.$emit("update:modelValue",e)),this.$emit("value-change",e),(r=(c=this.formField).onChange)===null||r===void 0||r.call(c,{originalEvent:n,value:e})},findNonEmpty:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.find(xr)}},computed:{$filled:function(){return xr(this.d_value)},$invalid:function(){var e,n;return!this.$formNovalidate&&this.findNonEmpty(this.invalid,(e=this.$pcFormField)===null||e===void 0||(e=e.$field)===null||e===void 0?void 0:e.invalid,(n=this.$pcForm)===null||n===void 0||(n=n.getFieldState(this.$formName))===null||n===void 0?void 0:n.invalid)},$formName:function(){var e;return this.$formNovalidate?void 0:this.name||((e=this.$formControl)===null||e===void 0?void 0:e.name)},$formControl:function(){var e;return this.formControl||((e=this.$pcFormField)===null||e===void 0?void 0:e.formControl)},$formNovalidate:function(){var e;return(e=this.$formControl)===null||e===void 0?void 0:e.novalidate},$formDefaultValue:function(){var e,n;return this.findNonEmpty(this.d_value,(e=this.$pcFormField)===null||e===void 0?void 0:e.initialValue,(n=this.$pcForm)===null||n===void 0||(n=n.initialValues)===null||n===void 0?void 0:n[this.$formName])},$formValue:function(){var e,n;return this.findNonEmpty((e=this.$pcFormField)===null||e===void 0||(e=e.$field)===null||e===void 0?void 0:e.value,(n=this.$pcForm)===null||n===void 0||(n=n.getFieldState(this.$formName))===null||n===void 0?void 0:n.value)},controlled:function(){return this.$inProps.hasOwnProperty("modelValue")||!this.$inProps.hasOwnProperty("modelValue")&&!this.$inProps.hasOwnProperty("defaultValue")},filled:function(){return this.$filled}}},k0={name:"BaseInput",extends:yB,props:{size:{type:String,default:null},fluid:{type:Boolean,default:null},variant:{type:String,default:null}},inject:{$parentInstance:{default:void 0},$pcFluid:{default:void 0}},computed:{$variant:function(){var e;return(e=this.variant)!==null&&e!==void 0?e:this.$primevue.config.inputStyle||this.$primevue.config.inputVariant},$fluid:function(){var e;return(e=this.fluid)!==null&&e!==void 0?e:!!this.$pcFluid},hasFluid:function(){return this.$fluid}}},Hie=`
    .p-inputtext {
        font-family: inherit;
        font-feature-settings: inherit;
        font-size: 1rem;
        color: dt('inputtext.color');
        background: dt('inputtext.background');
        padding-block: dt('inputtext.padding.y');
        padding-inline: dt('inputtext.padding.x');
        border: 1px solid dt('inputtext.border.color');
        transition:
            background dt('inputtext.transition.duration'),
            color dt('inputtext.transition.duration'),
            border-color dt('inputtext.transition.duration'),
            outline-color dt('inputtext.transition.duration'),
            box-shadow dt('inputtext.transition.duration');
        appearance: none;
        border-radius: dt('inputtext.border.radius');
        outline-color: transparent;
        box-shadow: dt('inputtext.shadow');
    }

    .p-inputtext:enabled:hover {
        border-color: dt('inputtext.hover.border.color');
    }

    .p-inputtext:enabled:focus {
        border-color: dt('inputtext.focus.border.color');
        box-shadow: dt('inputtext.focus.ring.shadow');
        outline: dt('inputtext.focus.ring.width') dt('inputtext.focus.ring.style') dt('inputtext.focus.ring.color');
        outline-offset: dt('inputtext.focus.ring.offset');
    }

    .p-inputtext.p-invalid {
        border-color: dt('inputtext.invalid.border.color');
    }

    .p-inputtext.p-variant-filled {
        background: dt('inputtext.filled.background');
    }

    .p-inputtext.p-variant-filled:enabled:hover {
        background: dt('inputtext.filled.hover.background');
    }

    .p-inputtext.p-variant-filled:enabled:focus {
        background: dt('inputtext.filled.focus.background');
    }

    .p-inputtext:disabled {
        opacity: 1;
        background: dt('inputtext.disabled.background');
        color: dt('inputtext.disabled.color');
    }

    .p-inputtext::placeholder {
        color: dt('inputtext.placeholder.color');
    }

    .p-inputtext.p-invalid::placeholder {
        color: dt('inputtext.invalid.placeholder.color');
    }

    .p-inputtext-sm {
        font-size: dt('inputtext.sm.font.size');
        padding-block: dt('inputtext.sm.padding.y');
        padding-inline: dt('inputtext.sm.padding.x');
    }

    .p-inputtext-lg {
        font-size: dt('inputtext.lg.font.size');
        padding-block: dt('inputtext.lg.padding.y');
        padding-inline: dt('inputtext.lg.padding.x');
    }

    .p-inputtext-fluid {
        width: 100%;
    }
`,Gie={root:function(e){var n=e.instance,r=e.props;return["p-inputtext p-component",{"p-filled":n.$filled,"p-inputtext-sm p-inputfield-sm":r.size==="small","p-inputtext-lg p-inputfield-lg":r.size==="large","p-invalid":n.$invalid,"p-variant-filled":n.$variant==="filled","p-inputtext-fluid":n.$fluid}]}},Wie=Kr.extend({name:"inputtext",style:Hie,classes:Gie}),qie={name:"BaseInputText",extends:k0,style:Wie,provide:function(){return{$pcInputText:this,$parentInstance:this}}};function Gb(t){"@babel/helpers - typeof";return Gb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gb(t)}function Zie(t,e,n){return(e=Kie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kie(t){var e=Xie(t,"string");return Gb(e)=="symbol"?e:e+""}function Xie(t,e){if(Gb(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Gb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var gI={name:"InputText",extends:qie,inheritAttrs:!1,methods:{onInput:function(e){this.writeValue(e.target.value,e)}},computed:{attrs:function(){return ft(this.ptmi("root",{context:{filled:this.$filled,disabled:this.disabled}}),this.formField)},dataP:function(){return Ka(Zie({invalid:this.$invalid,fluid:this.$fluid,filled:this.$variant==="filled"},this.size,this.size))}}},Yie=["value","name","disabled","aria-invalid","data-p"];function Jie(t,e,n,r,c,u){return We(),wt("input",ft({type:"text",class:t.cx("root"),value:t.d_value,name:t.name,disabled:t.disabled,"aria-invalid":t.$invalid||void 0,"data-p":u.dataP,onInput:e[0]||(e[0]=function(){return u.onInput&&u.onInput.apply(u,arguments)})},u.attrs),null,16,Yie)}gI.render=Jie;var Sp=cI(),_I={name:"Portal",props:{appendTo:{type:[String,Object],default:"body"},disabled:{type:Boolean,default:!1}},data:function(){return{mounted:!1}},mounted:function(){this.mounted=Nz()},computed:{inline:function(){return this.disabled||this.appendTo==="self"}}};function Qie(t,e,n,r,c,u){return u.inline?Ti(t.$slots,"default",{key:0}):c.mounted?(We(),Sn(Nj,{key:1,to:n.appendTo},[Ti(t.$slots,"default")],8,["to"])):Zn("",!0)}_I.render=Qie;var ere=`
    .p-virtualscroller-loader {
        background: dt('virtualscroller.loader.mask.background');
        color: dt('virtualscroller.loader.mask.color');
    }

    .p-virtualscroller-loading-icon {
        font-size: dt('virtualscroller.loader.icon.size');
        width: dt('virtualscroller.loader.icon.size');
        height: dt('virtualscroller.loader.icon.size');
    }
`,tre=`
.p-virtualscroller {
    position: relative;
    overflow: auto;
    contain: strict;
    transform: translateZ(0);
    will-change: scroll-position;
    outline: 0 none;
}

.p-virtualscroller-content {
    position: absolute;
    top: 0;
    left: 0;
    min-height: 100%;
    min-width: 100%;
    will-change: transform;
}

.p-virtualscroller-spacer {
    position: absolute;
    top: 0;
    left: 0;
    height: 1px;
    width: 1px;
    transform-origin: 0 0;
    pointer-events: none;
}

.p-virtualscroller-loader {
    position: sticky;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

.p-virtualscroller-loader-mask {
    display: flex;
    align-items: center;
    justify-content: center;
}

.p-virtualscroller-horizontal > .p-virtualscroller-content {
    display: flex;
}

.p-virtualscroller-inline .p-virtualscroller-content {
    position: static;
}

.p-virtualscroller .p-virtualscroller-loading {
    transform: none !important;
    min-height: 0;
    position: sticky;
    inset-block-start: 0;
    inset-inline-start: 0;
}
`,w3=Kr.extend({name:"virtualscroller",css:tre,style:ere}),nre={name:"BaseVirtualScroller",extends:Lo,props:{id:{type:String,default:null},style:null,class:null,items:{type:Array,default:null},itemSize:{type:[Number,Array],default:0},scrollHeight:null,scrollWidth:null,orientation:{type:String,default:"vertical"},numToleratedItems:{type:Number,default:null},delay:{type:Number,default:0},resizeDelay:{type:Number,default:10},lazy:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loaderDisabled:{type:Boolean,default:!1},columns:{type:Array,default:null},loading:{type:Boolean,default:!1},showSpacer:{type:Boolean,default:!0},showLoader:{type:Boolean,default:!1},tabindex:{type:Number,default:0},inline:{type:Boolean,default:!1},step:{type:Number,default:0},appendOnly:{type:Boolean,default:!1},autoSize:{type:Boolean,default:!1}},style:w3,provide:function(){return{$pcVirtualScroller:this,$parentInstance:this}},beforeMount:function(){var e;w3.loadCSS({nonce:(e=this.$primevueConfig)===null||e===void 0||(e=e.csp)===null||e===void 0?void 0:e.nonce})}};function Wb(t){"@babel/helpers - typeof";return Wb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wb(t)}function S3(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function Bv(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?S3(Object(n),!0).forEach(function(r){vB(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S3(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function vB(t,e,n){return(e=ire(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ire(t){var e=rre(t,"string");return Wb(e)=="symbol"?e:e+""}function rre(t,e){if(Wb(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Wb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var yI={name:"VirtualScroller",extends:nre,inheritAttrs:!1,emits:["update:numToleratedItems","scroll","scroll-index-change","lazy-load"],data:function(){var e=this.isBoth();return{first:e?{rows:0,cols:0}:0,last:e?{rows:0,cols:0}:0,page:e?{rows:0,cols:0}:0,numItemsInViewport:e?{rows:0,cols:0}:0,lastScrollPos:e?{top:0,left:0}:0,d_numToleratedItems:this.numToleratedItems,d_loading:this.loading,loaderArr:[],spacerStyle:{},contentStyle:{}}},element:null,content:null,lastScrollPos:null,scrollTimeout:null,resizeTimeout:null,defaultWidth:0,defaultHeight:0,defaultContentWidth:0,defaultContentHeight:0,isRangeChanged:!1,lazyLoadState:{},resizeListener:null,resizeObserver:null,initialized:!1,watch:{numToleratedItems:function(e){this.d_numToleratedItems=e},loading:function(e,n){this.lazy&&e!==n&&e!==this.d_loading&&(this.d_loading=e)},items:{handler:function(e,n){(!n||n.length!==(e||[]).length)&&(this.init(),this.calculateAutoSize())},deep:!0},itemSize:function(){this.init(),this.calculateAutoSize()},orientation:function(){this.lastScrollPos=this.isBoth()?{top:0,left:0}:0},scrollHeight:function(){this.init(),this.calculateAutoSize()},scrollWidth:function(){this.init(),this.calculateAutoSize()}},mounted:function(){this.viewInit(),this.lastScrollPos=this.isBoth()?{top:0,left:0}:0,this.lazyLoadState=this.lazyLoadState||{}},updated:function(){!this.initialized&&this.viewInit()},unmounted:function(){this.unbindResizeListener(),this.initialized=!1},methods:{viewInit:function(){Sw(this.element)&&(this.setContentEl(this.content),this.init(),this.calculateAutoSize(),this.defaultWidth=Jm(this.element),this.defaultHeight=Ym(this.element),this.defaultContentWidth=Jm(this.content),this.defaultContentHeight=Ym(this.content),this.initialized=!0),this.element&&this.bindResizeListener()},init:function(){this.disabled||(this.setSize(),this.calculateOptions(),this.setSpacerSize())},isVertical:function(){return this.orientation==="vertical"},isHorizontal:function(){return this.orientation==="horizontal"},isBoth:function(){return this.orientation==="both"},scrollTo:function(e){this.element&&this.element.scrollTo(e)},scrollToIndex:function(e){var n=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto",c=this.isBoth(),u=this.isHorizontal(),p=c?e.every(function(oe){return oe>-1}):e>-1;if(p){var o=this.first,w=this.element,T=w.scrollTop,A=T===void 0?0:T,D=w.scrollLeft,B=D===void 0?0:D,N=this.calculateNumItems(),ee=N.numToleratedItems,Q=this.getContentPosition(),se=this.itemSize,ce=function(){var de=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,Ee=arguments.length>1?arguments[1]:void 0;return de<=Ee?0:de},be=function(de,Ee,$e){return de*Ee+$e},ze=function(){var de=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,Ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return n.scrollTo({left:de,top:Ee,behavior:r})},xe=c?{rows:0,cols:0}:0,je=!1,qe=!1;c?(xe={rows:ce(e[0],ee[0]),cols:ce(e[1],ee[1])},ze(be(xe.cols,se[1],Q.left),be(xe.rows,se[0],Q.top)),qe=this.lastScrollPos.top!==A||this.lastScrollPos.left!==B,je=xe.rows!==o.rows||xe.cols!==o.cols):(xe=ce(e,ee),u?ze(be(xe,se,Q.left),A):ze(B,be(xe,se,Q.top)),qe=this.lastScrollPos!==(u?B:A),je=xe!==o),this.isRangeChanged=je,qe&&(this.first=xe)}},scrollInView:function(e,n){var r=this,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"auto";if(n){var u=this.isBoth(),p=this.isHorizontal(),o=u?e.every(function(se){return se>-1}):e>-1;if(o){var w=this.getRenderedRange(),T=w.first,A=w.viewport,D=function(){var ce=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return r.scrollTo({left:ce,top:be,behavior:c})},B=n==="to-start",N=n==="to-end";if(B){if(u)A.first.rows-T.rows>e[0]?D(A.first.cols*this.itemSize[1],(A.first.rows-1)*this.itemSize[0]):A.first.cols-T.cols>e[1]&&D((A.first.cols-1)*this.itemSize[1],A.first.rows*this.itemSize[0]);else if(A.first-T>e){var ee=(A.first-1)*this.itemSize;p?D(ee,0):D(0,ee)}}else if(N){if(u)A.last.rows-T.rows<=e[0]+1?D(A.first.cols*this.itemSize[1],(A.first.rows+1)*this.itemSize[0]):A.last.cols-T.cols<=e[1]+1&&D((A.first.cols+1)*this.itemSize[1],A.first.rows*this.itemSize[0]);else if(A.last-T<=e+1){var Q=(A.first+1)*this.itemSize;p?D(Q,0):D(0,Q)}}}}else this.scrollToIndex(e,c)},getRenderedRange:function(){var e=function(D,B){return Math.floor(D/(B||D))},n=this.first,r=0;if(this.element){var c=this.isBoth(),u=this.isHorizontal(),p=this.element,o=p.scrollTop,w=p.scrollLeft;if(c)n={rows:e(o,this.itemSize[0]),cols:e(w,this.itemSize[1])},r={rows:n.rows+this.numItemsInViewport.rows,cols:n.cols+this.numItemsInViewport.cols};else{var T=u?w:o;n=e(T,this.itemSize),r=n+this.numItemsInViewport}}return{first:this.first,last:this.last,viewport:{first:n,last:r}}},calculateNumItems:function(){var e=this.isBoth(),n=this.isHorizontal(),r=this.itemSize,c=this.getContentPosition(),u=this.element?this.element.offsetWidth-c.left:0,p=this.element?this.element.offsetHeight-c.top:0,o=function(B,N){return Math.ceil(B/(N||B))},w=function(B){return Math.ceil(B/2)},T=e?{rows:o(p,r[0]),cols:o(u,r[1])}:o(n?u:p,r),A=this.d_numToleratedItems||(e?[w(T.rows),w(T.cols)]:w(T));return{numItemsInViewport:T,numToleratedItems:A}},calculateOptions:function(){var e=this,n=this.isBoth(),r=this.first,c=this.calculateNumItems(),u=c.numItemsInViewport,p=c.numToleratedItems,o=function(A,D,B){var N=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return e.getLast(A+D+(A<B?2:3)*B,N)},w=n?{rows:o(r.rows,u.rows,p[0]),cols:o(r.cols,u.cols,p[1],!0)}:o(r,u,p);this.last=w,this.numItemsInViewport=u,this.d_numToleratedItems=p,this.$emit("update:numToleratedItems",this.d_numToleratedItems),this.showLoader&&(this.loaderArr=n?Array.from({length:u.rows}).map(function(){return Array.from({length:u.cols})}):Array.from({length:u})),this.lazy&&Promise.resolve().then(function(){var T;e.lazyLoadState={first:e.step?n?{rows:0,cols:r.cols}:0:r,last:Math.min(e.step?e.step:w,((T=e.items)===null||T===void 0?void 0:T.length)||0)},e.$emit("lazy-load",e.lazyLoadState)})},calculateAutoSize:function(){var e=this;this.autoSize&&!this.d_loading&&Promise.resolve().then(function(){if(e.content){var n=e.isBoth(),r=e.isHorizontal(),c=e.isVertical();e.content.style.minHeight=e.content.style.minWidth="auto",e.content.style.position="relative",e.element.style.contain="none";var u=[Jm(e.element),Ym(e.element)],p=u[0],o=u[1];(n||r)&&(e.element.style.width=p<e.defaultWidth?p+"px":e.scrollWidth||e.defaultWidth+"px"),(n||c)&&(e.element.style.height=o<e.defaultHeight?o+"px":e.scrollHeight||e.defaultHeight+"px"),e.content.style.minHeight=e.content.style.minWidth="",e.content.style.position="",e.element.style.contain=""}})},getLast:function(){var e,n,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,c=arguments.length>1?arguments[1]:void 0;return this.items?Math.min(c?((e=this.columns||this.items[0])===null||e===void 0?void 0:e.length)||0:((n=this.items)===null||n===void 0?void 0:n.length)||0,r):0},getContentPosition:function(){if(this.content){var e=getComputedStyle(this.content),n=parseFloat(e.paddingLeft)+Math.max(parseFloat(e.left)||0,0),r=parseFloat(e.paddingRight)+Math.max(parseFloat(e.right)||0,0),c=parseFloat(e.paddingTop)+Math.max(parseFloat(e.top)||0,0),u=parseFloat(e.paddingBottom)+Math.max(parseFloat(e.bottom)||0,0);return{left:n,right:r,top:c,bottom:u,x:n+r,y:c+u}}return{left:0,right:0,top:0,bottom:0,x:0,y:0}},setSize:function(){var e=this;if(this.element){var n=this.isBoth(),r=this.isHorizontal(),c=this.element.parentElement,u=this.scrollWidth||"".concat(this.element.offsetWidth||c.offsetWidth,"px"),p=this.scrollHeight||"".concat(this.element.offsetHeight||c.offsetHeight,"px"),o=function(T,A){return e.element.style[T]=A};n||r?(o("height",p),o("width",u)):o("height",p)}},setSpacerSize:function(){var e=this,n=this.items;if(n){var r=this.isBoth(),c=this.isHorizontal(),u=this.getContentPosition(),p=function(w,T,A){var D=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return e.spacerStyle=Bv(Bv({},e.spacerStyle),vB({},"".concat(w),(T||[]).length*A+D+"px"))};r?(p("height",n,this.itemSize[0],u.y),p("width",this.columns||n[1],this.itemSize[1],u.x)):c?p("width",this.columns||n,this.itemSize,u.x):p("height",n,this.itemSize,u.y)}},setContentPosition:function(e){var n=this;if(this.content&&!this.appendOnly){var r=this.isBoth(),c=this.isHorizontal(),u=e?e.first:this.first,p=function(A,D){return A*D},o=function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return n.contentStyle=Bv(Bv({},n.contentStyle),{transform:"translate3d(".concat(A,"px, ").concat(D,"px, 0)")})};if(r)o(p(u.cols,this.itemSize[1]),p(u.rows,this.itemSize[0]));else{var w=p(u,this.itemSize);c?o(w,0):o(0,w)}}},onScrollPositionChange:function(e){var n=this,r=e.target,c=this.isBoth(),u=this.isHorizontal(),p=this.getContentPosition(),o=function(me,Te){return me?me>Te?me-Te:me:0},w=function(me,Te){return Math.floor(me/(Te||me))},T=function(me,Te,Re,tn,Zt,on){return me<=Zt?Zt:on?Re-tn-Zt:Te+Zt-1},A=function(me,Te,Re,tn,Zt,on,hn,Hn){if(me<=on)return 0;var Ri=Math.max(0,hn?me<Te?Re:me-on:me>Te?Re:me-2*on),zi=n.getLast(Ri,Hn);return Ri>zi?zi-Zt:Ri},D=function(me,Te,Re,tn,Zt,on){var hn=Te+tn+2*Zt;return me>=Zt&&(hn+=Zt+1),n.getLast(hn,on)},B=o(r.scrollTop,p.top),N=o(r.scrollLeft,p.left),ee=c?{rows:0,cols:0}:0,Q=this.last,se=!1,ce=this.lastScrollPos;if(c){var be=this.lastScrollPos.top<=B,ze=this.lastScrollPos.left<=N;if(!this.appendOnly||this.appendOnly&&(be||ze)){var xe={rows:w(B,this.itemSize[0]),cols:w(N,this.itemSize[1])},je={rows:T(xe.rows,this.first.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0],be),cols:T(xe.cols,this.first.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],ze)};ee={rows:A(xe.rows,je.rows,this.first.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0],be),cols:A(xe.cols,je.cols,this.first.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],ze,!0)},Q={rows:D(xe.rows,ee.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0]),cols:D(xe.cols,ee.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],!0)},se=ee.rows!==this.first.rows||Q.rows!==this.last.rows||ee.cols!==this.first.cols||Q.cols!==this.last.cols||this.isRangeChanged,ce={top:B,left:N}}}else{var qe=u?N:B,oe=this.lastScrollPos<=qe;if(!this.appendOnly||this.appendOnly&&oe){var de=w(qe,this.itemSize),Ee=T(de,this.first,this.last,this.numItemsInViewport,this.d_numToleratedItems,oe);ee=A(de,Ee,this.first,this.last,this.numItemsInViewport,this.d_numToleratedItems,oe),Q=D(de,ee,this.last,this.numItemsInViewport,this.d_numToleratedItems),se=ee!==this.first||Q!==this.last||this.isRangeChanged,ce=qe}}return{first:ee,last:Q,isRangeChanged:se,scrollPos:ce}},onScrollChange:function(e){var n=this.onScrollPositionChange(e),r=n.first,c=n.last,u=n.isRangeChanged,p=n.scrollPos;if(u){var o={first:r,last:c};if(this.setContentPosition(o),this.first=r,this.last=c,this.lastScrollPos=p,this.$emit("scroll-index-change",o),this.lazy&&this.isPageChanged(r)){var w,T,A={first:this.step?Math.min(this.getPageByFirst(r)*this.step,(((w=this.items)===null||w===void 0?void 0:w.length)||0)-this.step):r,last:Math.min(this.step?(this.getPageByFirst(r)+1)*this.step:c,((T=this.items)===null||T===void 0?void 0:T.length)||0)},D=this.lazyLoadState.first!==A.first||this.lazyLoadState.last!==A.last;D&&this.$emit("lazy-load",A),this.lazyLoadState=A}}},onScroll:function(e){var n=this;if(this.$emit("scroll",e),this.delay){if(this.scrollTimeout&&clearTimeout(this.scrollTimeout),this.isPageChanged()){if(!this.d_loading&&this.showLoader){var r=this.onScrollPositionChange(e),c=r.isRangeChanged,u=c||(this.step?this.isPageChanged():!1);u&&(this.d_loading=!0)}this.scrollTimeout=setTimeout(function(){n.onScrollChange(e),n.d_loading&&n.showLoader&&(!n.lazy||n.loading===void 0)&&(n.d_loading=!1,n.page=n.getPageByFirst())},this.delay)}}else this.onScrollChange(e)},onResize:function(){var e=this;this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){if(Sw(e.element)){var n=e.isBoth(),r=e.isVertical(),c=e.isHorizontal(),u=[Jm(e.element),Ym(e.element)],p=u[0],o=u[1],w=p!==e.defaultWidth,T=o!==e.defaultHeight,A=n?w||T:c?w:r?T:!1;A&&(e.d_numToleratedItems=e.numToleratedItems,e.defaultWidth=p,e.defaultHeight=o,e.defaultContentWidth=Jm(e.content),e.defaultContentHeight=Ym(e.content),e.init())}},this.resizeDelay)},bindResizeListener:function(){var e=this;this.resizeListener||(this.resizeListener=this.onResize.bind(this),window.addEventListener("resize",this.resizeListener),window.addEventListener("orientationchange",this.resizeListener),this.resizeObserver=new ResizeObserver(function(){e.onResize()}),this.resizeObserver.observe(this.element))},unbindResizeListener:function(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),window.removeEventListener("orientationchange",this.resizeListener),this.resizeListener=null),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)},getOptions:function(e){var n=(this.items||[]).length,r=this.isBoth()?this.first.rows+e:this.first+e;return{index:r,count:n,first:r===0,last:r===n-1,even:r%2===0,odd:r%2!==0}},getLoaderOptions:function(e,n){var r=this.loaderArr.length;return Bv({index:e,count:r,first:e===0,last:e===r-1,even:e%2===0,odd:e%2!==0},n)},getPageByFirst:function(e){return Math.floor(((e??this.first)+this.d_numToleratedItems*4)/(this.step||1))},isPageChanged:function(e){return this.step&&!this.lazy?this.page!==this.getPageByFirst(e??this.first):!0},setContentEl:function(e){this.content=e||this.content||xp(this.element,'[data-pc-section="content"]')},elementRef:function(e){this.element=e},contentRef:function(e){this.content=e}},computed:{containerClass:function(){return["p-virtualscroller",this.class,{"p-virtualscroller-inline":this.inline,"p-virtualscroller-both p-both-scroll":this.isBoth(),"p-virtualscroller-horizontal p-horizontal-scroll":this.isHorizontal()}]},contentClass:function(){return["p-virtualscroller-content",{"p-virtualscroller-loading":this.d_loading}]},loaderClass:function(){return["p-virtualscroller-loader",{"p-virtualscroller-loader-mask":!this.$slots.loader}]},loadedItems:function(){var e=this;return this.items&&!this.d_loading?this.isBoth()?this.items.slice(this.appendOnly?0:this.first.rows,this.last.rows).map(function(n){return e.columns?n:n.slice(e.appendOnly?0:e.first.cols,e.last.cols)}):this.isHorizontal()&&this.columns?this.items:this.items.slice(this.appendOnly?0:this.first,this.last):[]},loadedRows:function(){return this.d_loading?this.loaderDisabled?this.loaderArr:[]:this.loadedItems},loadedColumns:function(){if(this.columns){var e=this.isBoth(),n=this.isHorizontal();if(e||n)return this.d_loading&&this.loaderDisabled?e?this.loaderArr[0]:this.loaderArr:this.columns.slice(e?this.first.cols:this.first,e?this.last.cols:this.last)}return this.columns}},components:{SpinnerIcon:A0}},ore=["tabindex"];function sre(t,e,n,r,c,u){var p=Ai("SpinnerIcon");return t.disabled?(We(),wt(Mi,{key:1},[Ti(t.$slots,"default"),Ti(t.$slots,"content",{items:t.items,rows:t.items,columns:u.loadedColumns})],64)):(We(),wt("div",ft({key:0,ref:u.elementRef,class:u.containerClass,tabindex:t.tabindex,style:t.style,onScroll:e[0]||(e[0]=function(){return u.onScroll&&u.onScroll.apply(u,arguments)})},t.ptmi("root")),[Ti(t.$slots,"content",{styleClass:u.contentClass,items:u.loadedItems,getItemOptions:u.getOptions,loading:c.d_loading,getLoaderOptions:u.getLoaderOptions,itemSize:t.itemSize,rows:u.loadedRows,columns:u.loadedColumns,contentRef:u.contentRef,spacerStyle:c.spacerStyle,contentStyle:c.contentStyle,vertical:u.isVertical(),horizontal:u.isHorizontal(),both:u.isBoth()},function(){return[Pe("div",ft({ref:u.contentRef,class:u.contentClass,style:c.contentStyle},t.ptm("content")),[(We(!0),wt(Mi,null,ea(u.loadedItems,function(o,w){return Ti(t.$slots,"item",{key:w,item:o,options:u.getOptions(w)})}),128))],16)]}),t.showSpacer?(We(),wt("div",ft({key:0,class:"p-virtualscroller-spacer",style:c.spacerStyle},t.ptm("spacer")),null,16)):Zn("",!0),!t.loaderDisabled&&t.showLoader&&c.d_loading?(We(),wt("div",ft({key:1,class:u.loaderClass},t.ptm("loader")),[t.$slots&&t.$slots.loader?(We(!0),wt(Mi,{key:0},ea(c.loaderArr,function(o,w){return Ti(t.$slots,"loader",{key:w,options:u.getLoaderOptions(w,u.isBoth()&&{numCols:t.d_numItemsInViewport.cols})})}),128)):Zn("",!0),Ti(t.$slots,"loadingicon",{},function(){return[hi(p,ft({spin:"",class:"p-virtualscroller-loading-icon"},t.ptm("loadingIcon")),null,16)]})],16)):Zn("",!0)],16,ore))}yI.render=sre;var are=`
    .p-select {
        display: inline-flex;
        cursor: pointer;
        position: relative;
        user-select: none;
        background: dt('select.background');
        border: 1px solid dt('select.border.color');
        transition:
            background dt('select.transition.duration'),
            color dt('select.transition.duration'),
            border-color dt('select.transition.duration'),
            outline-color dt('select.transition.duration'),
            box-shadow dt('select.transition.duration');
        border-radius: dt('select.border.radius');
        outline-color: transparent;
        box-shadow: dt('select.shadow');
    }

    .p-select:not(.p-disabled):hover {
        border-color: dt('select.hover.border.color');
    }

    .p-select:not(.p-disabled).p-focus {
        border-color: dt('select.focus.border.color');
        box-shadow: dt('select.focus.ring.shadow');
        outline: dt('select.focus.ring.width') dt('select.focus.ring.style') dt('select.focus.ring.color');
        outline-offset: dt('select.focus.ring.offset');
    }

    .p-select.p-variant-filled {
        background: dt('select.filled.background');
    }

    .p-select.p-variant-filled:not(.p-disabled):hover {
        background: dt('select.filled.hover.background');
    }

    .p-select.p-variant-filled:not(.p-disabled).p-focus {
        background: dt('select.filled.focus.background');
    }

    .p-select.p-invalid {
        border-color: dt('select.invalid.border.color');
    }

    .p-select.p-disabled {
        opacity: 1;
        background: dt('select.disabled.background');
    }

    .p-select-clear-icon {
        position: absolute;
        top: 50%;
        margin-top: -0.5rem;
        color: dt('select.clear.icon.color');
        inset-inline-end: dt('select.dropdown.width');
    }

    .p-select-dropdown {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
        background: transparent;
        color: dt('select.dropdown.color');
        width: dt('select.dropdown.width');
        border-start-end-radius: dt('select.border.radius');
        border-end-end-radius: dt('select.border.radius');
    }

    .p-select-label {
        display: block;
        white-space: nowrap;
        overflow: hidden;
        flex: 1 1 auto;
        width: 1%;
        padding: dt('select.padding.y') dt('select.padding.x');
        text-overflow: ellipsis;
        cursor: pointer;
        color: dt('select.color');
        background: transparent;
        border: 0 none;
        outline: 0 none;
        font-size: 1rem;
    }

    .p-select-label.p-placeholder {
        color: dt('select.placeholder.color');
    }

    .p-select.p-invalid .p-select-label.p-placeholder {
        color: dt('select.invalid.placeholder.color');
    }

    .p-select:has(.p-select-clear-icon) .p-select-label {
        padding-inline-end: calc(1rem + dt('select.padding.x'));
    }

    .p-select.p-disabled .p-select-label {
        color: dt('select.disabled.color');
    }

    .p-select-label-empty {
        overflow: hidden;
        opacity: 0;
    }

    input.p-select-label {
        cursor: default;
    }

    .p-select-overlay {
        position: absolute;
        top: 0;
        left: 0;
        background: dt('select.overlay.background');
        color: dt('select.overlay.color');
        border: 1px solid dt('select.overlay.border.color');
        border-radius: dt('select.overlay.border.radius');
        box-shadow: dt('select.overlay.shadow');
        min-width: 100%;
    }

    .p-select-header {
        padding: dt('select.list.header.padding');
    }

    .p-select-filter {
        width: 100%;
    }

    .p-select-list-container {
        overflow: auto;
    }

    .p-select-option-group {
        cursor: auto;
        margin: 0;
        padding: dt('select.option.group.padding');
        background: dt('select.option.group.background');
        color: dt('select.option.group.color');
        font-weight: dt('select.option.group.font.weight');
    }

    .p-select-list {
        margin: 0;
        padding: 0;
        list-style-type: none;
        padding: dt('select.list.padding');
        gap: dt('select.list.gap');
        display: flex;
        flex-direction: column;
    }

    .p-select-option {
        cursor: pointer;
        font-weight: normal;
        white-space: nowrap;
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: center;
        padding: dt('select.option.padding');
        border: 0 none;
        color: dt('select.option.color');
        background: transparent;
        transition:
            background dt('select.transition.duration'),
            color dt('select.transition.duration'),
            border-color dt('select.transition.duration'),
            box-shadow dt('select.transition.duration'),
            outline-color dt('select.transition.duration');
        border-radius: dt('select.option.border.radius');
    }

    .p-select-option:not(.p-select-option-selected):not(.p-disabled).p-focus {
        background: dt('select.option.focus.background');
        color: dt('select.option.focus.color');
    }

    .p-select-option.p-select-option-selected {
        background: dt('select.option.selected.background');
        color: dt('select.option.selected.color');
    }

    .p-select-option.p-select-option-selected.p-focus {
        background: dt('select.option.selected.focus.background');
        color: dt('select.option.selected.focus.color');
    }

    .p-select-option-blank-icon {
        flex-shrink: 0;
    }

    .p-select-option-check-icon {
        position: relative;
        flex-shrink: 0;
        margin-inline-start: dt('select.checkmark.gutter.start');
        margin-inline-end: dt('select.checkmark.gutter.end');
        color: dt('select.checkmark.color');
    }

    .p-select-empty-message {
        padding: dt('select.empty.message.padding');
    }

    .p-select-fluid {
        display: flex;
        width: 100%;
    }

    .p-select-sm .p-select-label {
        font-size: dt('select.sm.font.size');
        padding-block: dt('select.sm.padding.y');
        padding-inline: dt('select.sm.padding.x');
    }

    .p-select-sm .p-select-dropdown .p-icon {
        font-size: dt('select.sm.font.size');
        width: dt('select.sm.font.size');
        height: dt('select.sm.font.size');
    }

    .p-select-lg .p-select-label {
        font-size: dt('select.lg.font.size');
        padding-block: dt('select.lg.padding.y');
        padding-inline: dt('select.lg.padding.x');
    }

    .p-select-lg .p-select-dropdown .p-icon {
        font-size: dt('select.lg.font.size');
        width: dt('select.lg.font.size');
        height: dt('select.lg.font.size');
    }
`,lre={root:function(e){var n=e.instance,r=e.props,c=e.state;return["p-select p-component p-inputwrapper",{"p-disabled":r.disabled,"p-invalid":n.$invalid,"p-variant-filled":n.$variant==="filled","p-focus":c.focused,"p-inputwrapper-filled":n.$filled,"p-inputwrapper-focus":c.focused||c.overlayVisible,"p-select-open":c.overlayVisible,"p-select-fluid":n.$fluid,"p-select-sm p-inputfield-sm":r.size==="small","p-select-lg p-inputfield-lg":r.size==="large"}]},label:function(e){var n=e.instance,r=e.props;return["p-select-label",{"p-placeholder":!r.editable&&n.label===r.placeholder,"p-select-label-empty":!r.editable&&!n.$slots.value&&(n.label==="p-emptylabel"||n.label.length===0)}]},clearIcon:"p-select-clear-icon",dropdown:"p-select-dropdown",loadingicon:"p-select-loading-icon",dropdownIcon:"p-select-dropdown-icon",overlay:"p-select-overlay p-component",header:"p-select-header",pcFilter:"p-select-filter",listContainer:"p-select-list-container",list:"p-select-list",optionGroup:"p-select-option-group",optionGroupLabel:"p-select-option-group-label",option:function(e){var n=e.instance,r=e.props,c=e.state,u=e.option,p=e.focusedOption;return["p-select-option",{"p-select-option-selected":n.isSelected(u)&&r.highlightOnSelect,"p-focus":c.focusedOptionIndex===p,"p-disabled":n.isOptionDisabled(u)}]},optionLabel:"p-select-option-label",optionCheckIcon:"p-select-option-check-icon",optionBlankIcon:"p-select-option-blank-icon",emptyMessage:"p-select-empty-message"},cre=Kr.extend({name:"select",style:are,classes:lre}),ure={name:"BaseSelect",extends:k0,props:{options:Array,optionLabel:[String,Function],optionValue:[String,Function],optionDisabled:[String,Function],optionGroupLabel:[String,Function],optionGroupChildren:[String,Function],scrollHeight:{type:String,default:"14rem"},filter:Boolean,filterPlaceholder:String,filterLocale:String,filterMatchMode:{type:String,default:"contains"},filterFields:{type:Array,default:null},editable:Boolean,placeholder:{type:String,default:null},dataKey:null,showClear:{type:Boolean,default:!1},inputId:{type:String,default:null},inputClass:{type:[String,Object],default:null},inputStyle:{type:Object,default:null},labelId:{type:String,default:null},labelClass:{type:[String,Object],default:null},labelStyle:{type:Object,default:null},panelClass:{type:[String,Object],default:null},overlayStyle:{type:Object,default:null},overlayClass:{type:[String,Object],default:null},panelStyle:{type:Object,default:null},appendTo:{type:[String,Object],default:"body"},loading:{type:Boolean,default:!1},clearIcon:{type:String,default:void 0},dropdownIcon:{type:String,default:void 0},filterIcon:{type:String,default:void 0},loadingIcon:{type:String,default:void 0},resetFilterOnHide:{type:Boolean,default:!1},resetFilterOnClear:{type:Boolean,default:!1},virtualScrollerOptions:{type:Object,default:null},autoOptionFocus:{type:Boolean,default:!1},autoFilterFocus:{type:Boolean,default:!1},selectOnFocus:{type:Boolean,default:!1},focusOnHover:{type:Boolean,default:!0},highlightOnSelect:{type:Boolean,default:!0},checkmark:{type:Boolean,default:!1},filterMessage:{type:String,default:null},selectionMessage:{type:String,default:null},emptySelectionMessage:{type:String,default:null},emptyFilterMessage:{type:String,default:null},emptyMessage:{type:String,default:null},tabindex:{type:Number,default:0},ariaLabel:{type:String,default:null},ariaLabelledby:{type:String,default:null}},style:cre,provide:function(){return{$pcSelect:this,$parentInstance:this}}};function qb(t){"@babel/helpers - typeof";return qb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qb(t)}function dre(t){return mre(t)||pre(t)||fre(t)||hre()}function hre(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fre(t,e){if(t){if(typeof t=="string")return JT(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?JT(t,e):void 0}}function pre(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function mre(t){if(Array.isArray(t))return JT(t)}function JT(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function C3(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function T3(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?C3(Object(n),!0).forEach(function(r){Hm(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C3(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Hm(t,e,n){return(e=gre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gre(t){var e=_re(t,"string");return qb(e)=="symbol"?e:e+""}function _re(t,e){if(qb(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(qb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var kS={name:"Select",extends:ure,inheritAttrs:!1,emits:["change","focus","blur","before-show","before-hide","show","hide","filter"],outsideClickListener:null,scrollHandler:null,resizeListener:null,labelClickListener:null,matchMediaOrientationListener:null,overlay:null,list:null,virtualScroller:null,searchTimeout:null,searchValue:null,isModelValueChanged:!1,data:function(){return{clicked:!1,focused:!1,focusedOptionIndex:-1,filterValue:null,overlayVisible:!1,queryOrientation:null}},watch:{modelValue:function(){this.isModelValueChanged=!0},options:function(){this.autoUpdateModel()}},mounted:function(){this.autoUpdateModel(),this.bindLabelClickListener(),this.bindMatchMediaOrientationListener()},updated:function(){this.overlayVisible&&this.isModelValueChanged&&this.scrollInView(this.findSelectedOptionIndex()),this.isModelValueChanged=!1},beforeUnmount:function(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.unbindLabelClickListener(),this.unbindMatchMediaOrientationListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.overlay&&(U_.clear(this.overlay),this.overlay=null)},methods:{getOptionIndex:function(e,n){return this.virtualScrollerDisabled?e:n&&n(e).index},getOptionLabel:function(e){return this.optionLabel?eo(e,this.optionLabel):e},getOptionValue:function(e){return this.optionValue?eo(e,this.optionValue):e},getOptionRenderKey:function(e,n){return(this.dataKey?eo(e,this.dataKey):this.getOptionLabel(e))+"_"+n},getPTItemOptions:function(e,n,r,c){return this.ptm(c,{context:{option:e,index:r,selected:this.isSelected(e),focused:this.focusedOptionIndex===this.getOptionIndex(r,n),disabled:this.isOptionDisabled(e)}})},isOptionDisabled:function(e){return this.optionDisabled?eo(e,this.optionDisabled):!1},isOptionGroup:function(e){return this.optionGroupLabel&&e.optionGroup&&e.group},getOptionGroupLabel:function(e){return eo(e,this.optionGroupLabel)},getOptionGroupChildren:function(e){return eo(e,this.optionGroupChildren)},getAriaPosInset:function(e){var n=this;return(this.optionGroupLabel?e-this.visibleOptions.slice(0,e).filter(function(r){return n.isOptionGroup(r)}).length:e)+1},show:function(e){this.$emit("before-show"),this.overlayVisible=!0,this.focusedOptionIndex=this.focusedOptionIndex!==-1?this.focusedOptionIndex:this.autoOptionFocus?this.findFirstFocusedOptionIndex():this.editable?-1:this.findSelectedOptionIndex(),e&&Nl(this.$refs.focusInput)},hide:function(e){var n=this,r=function(){n.$emit("before-hide"),n.overlayVisible=!1,n.clicked=!1,n.focusedOptionIndex=-1,n.searchValue="",n.resetFilterOnHide&&(n.filterValue=null),e&&Nl(n.$refs.focusInput)};setTimeout(function(){r()},0)},onFocus:function(e){this.disabled||(this.focused=!0,this.overlayVisible&&(this.focusedOptionIndex=this.focusedOptionIndex!==-1?this.focusedOptionIndex:this.autoOptionFocus?this.findFirstFocusedOptionIndex():this.editable?-1:this.findSelectedOptionIndex(),this.scrollInView(this.focusedOptionIndex)),this.$emit("focus",e))},onBlur:function(e){var n=this;setTimeout(function(){var r,c;n.focused=!1,n.focusedOptionIndex=-1,n.searchValue="",n.$emit("blur",e),(r=(c=n.formField).onBlur)===null||r===void 0||r.call(c,e)},100)},onKeyDown:function(e){if(this.disabled){e.preventDefault();return}if(yG())switch(e.code){case"Backspace":this.onBackspaceKey(e,this.editable);break;case"Enter":case"NumpadDecimal":this.onEnterKey(e);break;default:e.preventDefault();return}var n=e.metaKey||e.ctrlKey;switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e,this.editable);break;case"ArrowLeft":case"ArrowRight":this.onArrowLeftKey(e,this.editable);break;case"Home":this.onHomeKey(e,this.editable);break;case"End":this.onEndKey(e,this.editable);break;case"PageDown":this.onPageDownKey(e);break;case"PageUp":this.onPageUpKey(e);break;case"Space":this.onSpaceKey(e,this.editable);break;case"Enter":case"NumpadEnter":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e);break;case"Backspace":this.onBackspaceKey(e,this.editable);break;case"ShiftLeft":case"ShiftRight":break;default:!n&&oG(e.key)&&(!this.overlayVisible&&this.show(),!this.editable&&this.searchOptions(e,e.key));break}this.clicked=!1},onEditableInput:function(e){var n=e.target.value;this.searchValue="";var r=this.searchOptions(e,n);!r&&(this.focusedOptionIndex=-1),this.updateModel(e,n),!this.overlayVisible&&xr(n)&&this.show()},onContainerClick:function(e){this.disabled||this.loading||e.target.tagName==="INPUT"||e.target.getAttribute("data-pc-section")==="clearicon"||e.target.closest('[data-pc-section="clearicon"]')||((!this.overlay||!this.overlay.contains(e.target))&&(this.overlayVisible?this.hide(!0):this.show(!0)),this.clicked=!0)},onClearClick:function(e){this.updateModel(e,null),this.resetFilterOnClear&&(this.filterValue=null)},onFirstHiddenFocus:function(e){var n=e.relatedTarget===this.$refs.focusInput?gp(this.overlay,':not([data-p-hidden-focusable="true"])'):this.$refs.focusInput;Nl(n)},onLastHiddenFocus:function(e){var n=e.relatedTarget===this.$refs.focusInput?Bz(this.overlay,':not([data-p-hidden-focusable="true"])'):this.$refs.focusInput;Nl(n)},onOptionSelect:function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,c=this.getOptionValue(n)!==""?this.getOptionValue(n):this.getOptionLabel(n);this.updateModel(e,c),r&&this.hide(!0)},onOptionMouseMove:function(e,n){this.focusOnHover&&this.changeFocusedOptionIndex(e,n)},onFilterChange:function(e){var n=e.target.value;this.filterValue=n,this.focusedOptionIndex=-1,this.$emit("filter",{originalEvent:e,value:n}),!this.virtualScrollerDisabled&&this.virtualScroller.scrollToIndex(0)},onFilterKeyDown:function(e){if(!e.isComposing)switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e,!0);break;case"ArrowLeft":case"ArrowRight":this.onArrowLeftKey(e,!0);break;case"Home":this.onHomeKey(e,!0);break;case"End":this.onEndKey(e,!0);break;case"Enter":case"NumpadEnter":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e,!0);break}},onFilterBlur:function(){this.focusedOptionIndex=-1},onFilterUpdated:function(){this.overlayVisible&&this.alignOverlay()},onOverlayClick:function(e){Sp.emit("overlay-click",{originalEvent:e,target:this.$el})},onOverlayKeyDown:function(e){switch(e.code){case"Escape":this.onEscapeKey(e);break}},onArrowDownKey:function(e){if(!this.overlayVisible)this.show(),this.editable&&this.changeFocusedOptionIndex(e,this.findSelectedOptionIndex());else{var n=this.focusedOptionIndex!==-1?this.findNextOptionIndex(this.focusedOptionIndex):this.clicked?this.findFirstOptionIndex():this.findFirstFocusedOptionIndex();this.changeFocusedOptionIndex(e,n)}e.preventDefault()},onArrowUpKey:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.altKey&&!n)this.focusedOptionIndex!==-1&&this.onOptionSelect(e,this.visibleOptions[this.focusedOptionIndex]),this.overlayVisible&&this.hide(),e.preventDefault();else{var r=this.focusedOptionIndex!==-1?this.findPrevOptionIndex(this.focusedOptionIndex):this.clicked?this.findLastOptionIndex():this.findLastFocusedOptionIndex();this.changeFocusedOptionIndex(e,r),!this.overlayVisible&&this.show(),e.preventDefault()}},onArrowLeftKey:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n&&(this.focusedOptionIndex=-1)},onHomeKey:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(n){var r=e.currentTarget;e.shiftKey?r.setSelectionRange(0,e.target.selectionStart):(r.setSelectionRange(0,0),this.focusedOptionIndex=-1)}else this.changeFocusedOptionIndex(e,this.findFirstOptionIndex()),!this.overlayVisible&&this.show();e.preventDefault()},onEndKey:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(n){var r=e.currentTarget;if(e.shiftKey)r.setSelectionRange(e.target.selectionStart,r.value.length);else{var c=r.value.length;r.setSelectionRange(c,c),this.focusedOptionIndex=-1}}else this.changeFocusedOptionIndex(e,this.findLastOptionIndex()),!this.overlayVisible&&this.show();e.preventDefault()},onPageUpKey:function(e){this.scrollInView(0),e.preventDefault()},onPageDownKey:function(e){this.scrollInView(this.visibleOptions.length-1),e.preventDefault()},onEnterKey:function(e){this.overlayVisible?(this.focusedOptionIndex!==-1&&this.onOptionSelect(e,this.visibleOptions[this.focusedOptionIndex]),this.hide(!0)):(this.focusedOptionIndex=-1,this.onArrowDownKey(e)),e.preventDefault()},onSpaceKey:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;!n&&this.onEnterKey(e)},onEscapeKey:function(e){this.overlayVisible&&this.hide(!0),e.preventDefault(),e.stopPropagation()},onTabKey:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n||(this.overlayVisible&&this.hasFocusableElements()?(Nl(this.$refs.firstHiddenFocusableElementOnOverlay),e.preventDefault()):(this.focusedOptionIndex!==-1&&this.onOptionSelect(e,this.visibleOptions[this.focusedOptionIndex]),this.overlayVisible&&this.hide(this.filter)))},onBackspaceKey:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n&&!this.overlayVisible&&this.show()},onOverlayEnter:function(e){var n=this;U_.set("overlay",e,this.$primevue.config.zIndex.overlay),bw(e,{position:"absolute",top:"0"}),this.alignOverlay(),this.scrollInView(),this.$attrSelector&&e.setAttribute(this.$attrSelector,""),setTimeout(function(){n.autoFilterFocus&&n.filter&&Nl(n.$refs.filterInput.$el),n.autoUpdateModel()},1)},onOverlayAfterEnter:function(){this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.$emit("show")},onOverlayLeave:function(){var e=this;this.unbindOutsideClickListener(),this.unbindScrollListener(),this.unbindResizeListener(),this.autoFilterFocus&&this.filter&&!this.editable&&this.$nextTick(function(){e.$refs.filterInput&&Nl(e.$refs.filterInput.$el)}),this.$emit("hide"),this.overlay=null},onOverlayAfterLeave:function(e){U_.clear(e)},alignOverlay:function(){this.appendTo==="self"?fG(this.overlay,this.$el):this.overlay&&(this.overlay.style.minWidth=dc(this.$el)+"px",Lz(this.overlay,this.$el))},bindOutsideClickListener:function(){var e=this;this.outsideClickListener||(this.outsideClickListener=function(n){var r=n.composedPath();e.overlayVisible&&e.overlay&&!r.includes(e.$el)&&!r.includes(e.overlay)&&e.hide()},document.addEventListener("click",this.outsideClickListener,!0))},unbindOutsideClickListener:function(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener,!0),this.outsideClickListener=null)},bindScrollListener:function(){var e=this;this.scrollHandler||(this.scrollHandler=new sB(this.$refs.container,function(){e.overlayVisible&&e.hide()})),this.scrollHandler.bindScrollListener()},unbindScrollListener:function(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener:function(){var e=this;this.resizeListener||(this.resizeListener=function(){e.overlayVisible&&!Vz()&&e.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener:function(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},bindLabelClickListener:function(){var e=this;if(!this.editable&&!this.labelClickListener){var n=document.querySelector('label[for="'.concat(this.labelId,'"]'));n&&Sw(n)&&(this.labelClickListener=function(){Nl(e.$refs.focusInput)},n.addEventListener("click",this.labelClickListener))}},unbindLabelClickListener:function(){if(this.labelClickListener){var e=document.querySelector('label[for="'.concat(this.labelId,'"]'));e&&Sw(e)&&e.removeEventListener("click",this.labelClickListener)}},bindMatchMediaOrientationListener:function(){var e=this;if(!this.matchMediaOrientationListener){var n=matchMedia("(orientation: portrait)");this.queryOrientation=n,this.matchMediaOrientationListener=function(){e.alignOverlay()},this.queryOrientation.addEventListener("change",this.matchMediaOrientationListener)}},unbindMatchMediaOrientationListener:function(){this.matchMediaOrientationListener&&(this.queryOrientation.removeEventListener("change",this.matchMediaOrientationListener),this.queryOrientation=null,this.matchMediaOrientationListener=null)},hasFocusableElements:function(){return dI(this.overlay,':not([data-p-hidden-focusable="true"])').length>0},isOptionExactMatched:function(e){var n;return this.isValidOption(e)&&typeof this.getOptionLabel(e)=="string"&&((n=this.getOptionLabel(e))===null||n===void 0?void 0:n.toLocaleLowerCase(this.filterLocale))==this.searchValue.toLocaleLowerCase(this.filterLocale)},isOptionStartsWith:function(e){var n;return this.isValidOption(e)&&typeof this.getOptionLabel(e)=="string"&&((n=this.getOptionLabel(e))===null||n===void 0?void 0:n.toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue.toLocaleLowerCase(this.filterLocale)))},isValidOption:function(e){return xr(e)&&!(this.isOptionDisabled(e)||this.isOptionGroup(e))},isValidSelectedOption:function(e){return this.isValidOption(e)&&this.isSelected(e)},isSelected:function(e){return xg(this.d_value,this.getOptionValue(e)!==""?this.getOptionValue(e):this.getOptionLabel(e),this.equalityKey)},findFirstOptionIndex:function(){var e=this;return this.visibleOptions.findIndex(function(n){return e.isValidOption(n)})},findLastOptionIndex:function(){var e=this;return TD(this.visibleOptions,function(n){return e.isValidOption(n)})},findNextOptionIndex:function(e){var n=this,r=e<this.visibleOptions.length-1?this.visibleOptions.slice(e+1).findIndex(function(c){return n.isValidOption(c)}):-1;return r>-1?r+e+1:e},findPrevOptionIndex:function(e){var n=this,r=e>0?TD(this.visibleOptions.slice(0,e),function(c){return n.isValidOption(c)}):-1;return r>-1?r:e},findSelectedOptionIndex:function(){var e=this;return this.$filled?this.visibleOptions.findIndex(function(n){return e.isValidSelectedOption(n)}):-1},findFirstFocusedOptionIndex:function(){var e=this.findSelectedOptionIndex();return e<0?this.findFirstOptionIndex():e},findLastFocusedOptionIndex:function(){var e=this.findSelectedOptionIndex();return e<0?this.findLastOptionIndex():e},searchOptions:function(e,n){var r=this;this.searchValue=(this.searchValue||"")+n;var c=-1,u=!1;return xr(this.searchValue)&&(c=this.visibleOptions.findIndex(function(p){return r.isOptionExactMatched(p)}),c===-1&&(c=this.visibleOptions.findIndex(function(p){return r.isOptionStartsWith(p)})),c!==-1&&(u=!0),c===-1&&this.focusedOptionIndex===-1&&(c=this.findFirstFocusedOptionIndex()),c!==-1&&this.changeFocusedOptionIndex(e,c)),this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(function(){r.searchValue="",r.searchTimeout=null},500),u},changeFocusedOptionIndex:function(e,n){this.focusedOptionIndex!==n&&(this.focusedOptionIndex=n,this.scrollInView(),this.selectOnFocus&&this.onOptionSelect(e,this.visibleOptions[n],!1))},scrollInView:function(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:-1;this.$nextTick(function(){var r=n!==-1?"".concat(e.$id,"_").concat(n):e.focusedOptionId,c=xp(e.list,'li[id="'.concat(r,'"]'));c?c.scrollIntoView&&c.scrollIntoView({block:"nearest",inline:"nearest"}):e.virtualScrollerDisabled||e.virtualScroller&&e.virtualScroller.scrollToIndex(n!==-1?n:e.focusedOptionIndex)})},autoUpdateModel:function(){this.autoOptionFocus&&(this.focusedOptionIndex=this.findFirstFocusedOptionIndex()),this.selectOnFocus&&this.autoOptionFocus&&!this.$filled&&this.onOptionSelect(null,this.visibleOptions[this.focusedOptionIndex],!1)},updateModel:function(e,n){this.writeValue(n,e),this.$emit("change",{originalEvent:e,value:n})},flatOptions:function(e){var n=this;return(e||[]).reduce(function(r,c,u){r.push({optionGroup:c,group:!0,index:u});var p=n.getOptionGroupChildren(c);return p&&p.forEach(function(o){return r.push(o)}),r},[])},overlayRef:function(e){this.overlay=e},listRef:function(e,n){this.list=e,n&&n(e)},virtualScrollerRef:function(e){this.virtualScroller=e}},computed:{visibleOptions:function(){var e=this,n=this.optionGroupLabel?this.flatOptions(this.options):this.options||[];if(this.filterValue){var r=GT.filter(n,this.searchFields,this.filterValue,this.filterMatchMode,this.filterLocale);if(this.optionGroupLabel){var c=this.options||[],u=[];return c.forEach(function(p){var o=e.getOptionGroupChildren(p),w=o.filter(function(T){return r.includes(T)});w.length>0&&u.push(T3(T3({},p),{},Hm({},typeof e.optionGroupChildren=="string"?e.optionGroupChildren:"items",dre(w))))}),this.flatOptions(u)}return r}return n},hasSelectedOption:function(){return this.$filled},label:function(){var e=this.findSelectedOptionIndex();return e!==-1?this.getOptionLabel(this.visibleOptions[e]):this.placeholder||"p-emptylabel"},editableInputValue:function(){var e=this.findSelectedOptionIndex();return e!==-1?this.getOptionLabel(this.visibleOptions[e]):this.d_value||""},equalityKey:function(){return this.optionValue?null:this.dataKey},searchFields:function(){return this.filterFields||[this.optionLabel]},filterResultMessageText:function(){return xr(this.visibleOptions)?this.filterMessageText.replaceAll("{0}",this.visibleOptions.length):this.emptyFilterMessageText},filterMessageText:function(){return this.filterMessage||this.$primevue.config.locale.searchMessage||""},emptyFilterMessageText:function(){return this.emptyFilterMessage||this.$primevue.config.locale.emptySearchMessage||this.$primevue.config.locale.emptyFilterMessage||""},emptyMessageText:function(){return this.emptyMessage||this.$primevue.config.locale.emptyMessage||""},selectionMessageText:function(){return this.selectionMessage||this.$primevue.config.locale.selectionMessage||""},emptySelectionMessageText:function(){return this.emptySelectionMessage||this.$primevue.config.locale.emptySelectionMessage||""},selectedMessageText:function(){return this.$filled?this.selectionMessageText.replaceAll("{0}","1"):this.emptySelectionMessageText},focusedOptionId:function(){return this.focusedOptionIndex!==-1?"".concat(this.$id,"_").concat(this.focusedOptionIndex):null},ariaSetSize:function(){var e=this;return this.visibleOptions.filter(function(n){return!e.isOptionGroup(n)}).length},isClearIconVisible:function(){return this.showClear&&this.d_value!=null&&xr(this.options)},virtualScrollerDisabled:function(){return!this.virtualScrollerOptions},containerDataP:function(){return Ka(Hm({invalid:this.$invalid,disabled:this.disabled,focus:this.focused,fluid:this.$fluid,filled:this.$variant==="filled"},this.size,this.size))},labelDataP:function(){return Ka(Hm(Hm({placeholder:!this.editable&&this.label===this.placeholder,clearable:this.showClear,disabled:this.disabled,editable:this.editable},this.size,this.size),"empty",!this.editable&&!this.$slots.value&&(this.label==="p-emptylabel"||this.label.length===0)))},dropdownIconDataP:function(){return Ka(Hm({},this.size,this.size))},overlayDataP:function(){return Ka(Hm({},"portal-"+this.appendTo,"portal-"+this.appendTo))}},directives:{ripple:Wp},components:{InputText:gI,VirtualScroller:yI,Portal:_I,InputIcon:_B,IconField:gB,TimesIcon:mI,ChevronDownIcon:AS,SpinnerIcon:A0,SearchIcon:mB,CheckIcon:fy,BlankIcon:pB}},yre=["id","data-p"],vre=["name","id","value","placeholder","tabindex","disabled","aria-label","aria-labelledby","aria-expanded","aria-controls","aria-activedescendant","aria-invalid","data-p"],bre=["name","id","tabindex","aria-label","aria-labelledby","aria-expanded","aria-controls","aria-activedescendant","aria-invalid","aria-disabled","data-p"],xre=["data-p"],wre=["id"],Sre=["id"],Cre=["id","aria-label","aria-selected","aria-disabled","aria-setsize","aria-posinset","onMousedown","onMousemove","data-p-selected","data-p-focused","data-p-disabled"];function Tre(t,e,n,r,c,u){var p=Ai("SpinnerIcon"),o=Ai("InputText"),w=Ai("SearchIcon"),T=Ai("InputIcon"),A=Ai("IconField"),D=Ai("CheckIcon"),B=Ai("BlankIcon"),N=Ai("VirtualScroller"),ee=Ai("Portal"),Q=uf("ripple");return We(),wt("div",ft({ref:"container",id:t.$id,class:t.cx("root"),onClick:e[12]||(e[12]=function(){return u.onContainerClick&&u.onContainerClick.apply(u,arguments)}),"data-p":u.containerDataP},t.ptmi("root")),[t.editable?(We(),wt("input",ft({key:0,ref:"focusInput",name:t.name,id:t.labelId||t.inputId,type:"text",class:[t.cx("label"),t.inputClass,t.labelClass],style:[t.inputStyle,t.labelStyle],value:u.editableInputValue,placeholder:t.placeholder,tabindex:t.disabled?-1:t.tabindex,disabled:t.disabled,autocomplete:"off",role:"combobox","aria-label":t.ariaLabel,"aria-labelledby":t.ariaLabelledby,"aria-haspopup":"listbox","aria-expanded":c.overlayVisible,"aria-controls":t.$id+"_list","aria-activedescendant":c.focused?u.focusedOptionId:void 0,"aria-invalid":t.invalid||void 0,onFocus:e[0]||(e[0]=function(){return u.onFocus&&u.onFocus.apply(u,arguments)}),onBlur:e[1]||(e[1]=function(){return u.onBlur&&u.onBlur.apply(u,arguments)}),onKeydown:e[2]||(e[2]=function(){return u.onKeyDown&&u.onKeyDown.apply(u,arguments)}),onInput:e[3]||(e[3]=function(){return u.onEditableInput&&u.onEditableInput.apply(u,arguments)}),"data-p":u.labelDataP},t.ptm("label")),null,16,vre)):(We(),wt("span",ft({key:1,ref:"focusInput",name:t.name,id:t.labelId||t.inputId,class:[t.cx("label"),t.inputClass,t.labelClass],style:[t.inputStyle,t.labelStyle],tabindex:t.disabled?-1:t.tabindex,role:"combobox","aria-label":t.ariaLabel||(u.label==="p-emptylabel"?void 0:u.label),"aria-labelledby":t.ariaLabelledby,"aria-haspopup":"listbox","aria-expanded":c.overlayVisible,"aria-controls":t.$id+"_list","aria-activedescendant":c.focused?u.focusedOptionId:void 0,"aria-invalid":t.invalid||void 0,"aria-disabled":t.disabled,onFocus:e[4]||(e[4]=function(){return u.onFocus&&u.onFocus.apply(u,arguments)}),onBlur:e[5]||(e[5]=function(){return u.onBlur&&u.onBlur.apply(u,arguments)}),onKeydown:e[6]||(e[6]=function(){return u.onKeyDown&&u.onKeyDown.apply(u,arguments)}),"data-p":u.labelDataP},t.ptm("label")),[Ti(t.$slots,"value",{value:t.d_value,placeholder:t.placeholder},function(){var se;return[Ss(wr(u.label==="p-emptylabel"?" ":(se=u.label)!==null&&se!==void 0?se:"empty"),1)]})],16,bre)),u.isClearIconVisible?Ti(t.$slots,"clearicon",{key:2,class:pr(t.cx("clearIcon")),clearCallback:u.onClearClick},function(){return[(We(),Sn(lr(t.clearIcon?"i":"TimesIcon"),ft({ref:"clearIcon",class:[t.cx("clearIcon"),t.clearIcon],onClick:u.onClearClick},t.ptm("clearIcon"),{"data-pc-section":"clearicon"}),null,16,["class","onClick"]))]}):Zn("",!0),Pe("div",ft({class:t.cx("dropdown")},t.ptm("dropdown")),[t.loading?Ti(t.$slots,"loadingicon",{key:0,class:pr(t.cx("loadingIcon"))},function(){return[t.loadingIcon?(We(),wt("span",ft({key:0,class:[t.cx("loadingIcon"),"pi-spin",t.loadingIcon],"aria-hidden":"true"},t.ptm("loadingIcon")),null,16)):(We(),Sn(p,ft({key:1,class:t.cx("loadingIcon"),spin:"","aria-hidden":"true"},t.ptm("loadingIcon")),null,16,["class"]))]}):Ti(t.$slots,"dropdownicon",{key:1,class:pr(t.cx("dropdownIcon"))},function(){return[(We(),Sn(lr(t.dropdownIcon?"span":"ChevronDownIcon"),ft({class:[t.cx("dropdownIcon"),t.dropdownIcon],"aria-hidden":"true","data-p":u.dropdownIconDataP},t.ptm("dropdownIcon")),null,16,["class","data-p"]))]})],16),hi(ee,{appendTo:t.appendTo},{default:si(function(){return[hi(aI,ft({name:"p-connected-overlay",onEnter:u.onOverlayEnter,onAfterEnter:u.onOverlayAfterEnter,onLeave:u.onOverlayLeave,onAfterLeave:u.onOverlayAfterLeave},t.ptm("transition")),{default:si(function(){return[c.overlayVisible?(We(),wt("div",ft({key:0,ref:u.overlayRef,class:[t.cx("overlay"),t.panelClass,t.overlayClass],style:[t.panelStyle,t.overlayStyle],onClick:e[10]||(e[10]=function(){return u.onOverlayClick&&u.onOverlayClick.apply(u,arguments)}),onKeydown:e[11]||(e[11]=function(){return u.onOverlayKeyDown&&u.onOverlayKeyDown.apply(u,arguments)}),"data-p":u.overlayDataP},t.ptm("overlay")),[Pe("span",ft({ref:"firstHiddenFocusableElementOnOverlay",role:"presentation","aria-hidden":"true",class:"p-hidden-accessible p-hidden-focusable",tabindex:0,onFocus:e[7]||(e[7]=function(){return u.onFirstHiddenFocus&&u.onFirstHiddenFocus.apply(u,arguments)})},t.ptm("hiddenFirstFocusableEl"),{"data-p-hidden-accessible":!0,"data-p-hidden-focusable":!0}),null,16),Ti(t.$slots,"header",{value:t.d_value,options:u.visibleOptions}),t.filter?(We(),wt("div",ft({key:0,class:t.cx("header")},t.ptm("header")),[hi(A,{unstyled:t.unstyled,pt:t.ptm("pcFilterContainer")},{default:si(function(){return[hi(o,{ref:"filterInput",type:"text",value:c.filterValue,onVnodeMounted:u.onFilterUpdated,onVnodeUpdated:u.onFilterUpdated,class:pr(t.cx("pcFilter")),placeholder:t.filterPlaceholder,variant:t.variant,unstyled:t.unstyled,role:"searchbox",autocomplete:"off","aria-owns":t.$id+"_list","aria-activedescendant":u.focusedOptionId,onKeydown:u.onFilterKeyDown,onBlur:u.onFilterBlur,onInput:u.onFilterChange,pt:t.ptm("pcFilter"),formControl:{novalidate:!0}},null,8,["value","onVnodeMounted","onVnodeUpdated","class","placeholder","variant","unstyled","aria-owns","aria-activedescendant","onKeydown","onBlur","onInput","pt"]),hi(T,{unstyled:t.unstyled,pt:t.ptm("pcFilterIconContainer")},{default:si(function(){return[Ti(t.$slots,"filtericon",{},function(){return[t.filterIcon?(We(),wt("span",ft({key:0,class:t.filterIcon},t.ptm("filterIcon")),null,16)):(We(),Sn(w,fS(ft({key:1},t.ptm("filterIcon"))),null,16))]})]}),_:3},8,["unstyled","pt"])]}),_:3},8,["unstyled","pt"]),Pe("span",ft({role:"status","aria-live":"polite",class:"p-hidden-accessible"},t.ptm("hiddenFilterResult"),{"data-p-hidden-accessible":!0}),wr(u.filterResultMessageText),17)],16)):Zn("",!0),Pe("div",ft({class:t.cx("listContainer"),style:{"max-height":u.virtualScrollerDisabled?t.scrollHeight:""}},t.ptm("listContainer")),[hi(N,ft({ref:u.virtualScrollerRef},t.virtualScrollerOptions,{items:u.visibleOptions,style:{height:t.scrollHeight},tabindex:-1,disabled:u.virtualScrollerDisabled,pt:t.ptm("virtualScroller")}),Eb({content:si(function(se){var ce=se.styleClass,be=se.contentRef,ze=se.items,xe=se.getItemOptions,je=se.contentStyle,qe=se.itemSize;return[Pe("ul",ft({ref:function(de){return u.listRef(de,be)},id:t.$id+"_list",class:[t.cx("list"),ce],style:je,role:"listbox"},t.ptm("list")),[(We(!0),wt(Mi,null,ea(ze,function(oe,de){return We(),wt(Mi,{key:u.getOptionRenderKey(oe,u.getOptionIndex(de,xe))},[u.isOptionGroup(oe)?(We(),wt("li",ft({key:0,id:t.$id+"_"+u.getOptionIndex(de,xe),style:{height:qe?qe+"px":void 0},class:t.cx("optionGroup"),role:"option"},{ref_for:!0},t.ptm("optionGroup")),[Ti(t.$slots,"optiongroup",{option:oe.optionGroup,index:u.getOptionIndex(de,xe)},function(){return[Pe("span",ft({class:t.cx("optionGroupLabel")},{ref_for:!0},t.ptm("optionGroupLabel")),wr(u.getOptionGroupLabel(oe.optionGroup)),17)]})],16,Sre)):Ki((We(),wt("li",ft({key:1,id:t.$id+"_"+u.getOptionIndex(de,xe),class:t.cx("option",{option:oe,focusedOption:u.getOptionIndex(de,xe)}),style:{height:qe?qe+"px":void 0},role:"option","aria-label":u.getOptionLabel(oe),"aria-selected":u.isSelected(oe),"aria-disabled":u.isOptionDisabled(oe),"aria-setsize":u.ariaSetSize,"aria-posinset":u.getAriaPosInset(u.getOptionIndex(de,xe)),onMousedown:function($e){return u.onOptionSelect($e,oe)},onMousemove:function($e){return u.onOptionMouseMove($e,u.getOptionIndex(de,xe))},onClick:e[8]||(e[8]=df(function(){},["stop"])),"data-p-selected":!t.checkmark&&u.isSelected(oe),"data-p-focused":c.focusedOptionIndex===u.getOptionIndex(de,xe),"data-p-disabled":u.isOptionDisabled(oe)},{ref_for:!0},u.getPTItemOptions(oe,xe,de,"option")),[t.checkmark?(We(),wt(Mi,{key:0},[u.isSelected(oe)?(We(),Sn(D,ft({key:0,class:t.cx("optionCheckIcon")},{ref_for:!0},t.ptm("optionCheckIcon")),null,16,["class"])):(We(),Sn(B,ft({key:1,class:t.cx("optionBlankIcon")},{ref_for:!0},t.ptm("optionBlankIcon")),null,16,["class"]))],64)):Zn("",!0),Ti(t.$slots,"option",{option:oe,selected:u.isSelected(oe),index:u.getOptionIndex(de,xe)},function(){return[Pe("span",ft({class:t.cx("optionLabel")},{ref_for:!0},t.ptm("optionLabel")),wr(u.getOptionLabel(oe)),17)]})],16,Cre)),[[Q]])],64)}),128)),c.filterValue&&(!ze||ze&&ze.length===0)?(We(),wt("li",ft({key:0,class:t.cx("emptyMessage"),role:"option"},t.ptm("emptyMessage"),{"data-p-hidden-accessible":!0}),[Ti(t.$slots,"emptyfilter",{},function(){return[Ss(wr(u.emptyFilterMessageText),1)]})],16)):!t.options||t.options&&t.options.length===0?(We(),wt("li",ft({key:1,class:t.cx("emptyMessage"),role:"option"},t.ptm("emptyMessage"),{"data-p-hidden-accessible":!0}),[Ti(t.$slots,"empty",{},function(){return[Ss(wr(u.emptyMessageText),1)]})],16)):Zn("",!0)],16,wre)]}),_:2},[t.$slots.loader?{name:"loader",fn:si(function(se){var ce=se.options;return[Ti(t.$slots,"loader",{options:ce})]}),key:"0"}:void 0]),1040,["items","style","disabled","pt"])],16),Ti(t.$slots,"footer",{value:t.d_value,options:u.visibleOptions}),!t.options||t.options&&t.options.length===0?(We(),wt("span",ft({key:1,role:"status","aria-live":"polite",class:"p-hidden-accessible"},t.ptm("hiddenEmptyMessage"),{"data-p-hidden-accessible":!0}),wr(u.emptyMessageText),17)):Zn("",!0),Pe("span",ft({role:"status","aria-live":"polite",class:"p-hidden-accessible"},t.ptm("hiddenSelectedMessage"),{"data-p-hidden-accessible":!0}),wr(u.selectedMessageText),17),Pe("span",ft({ref:"lastHiddenFocusableElementOnOverlay",role:"presentation","aria-hidden":"true",class:"p-hidden-accessible p-hidden-focusable",tabindex:0,onFocus:e[9]||(e[9]=function(){return u.onLastHiddenFocus&&u.onLastHiddenFocus.apply(u,arguments)})},t.ptm("hiddenLastFocusableEl"),{"data-p-hidden-accessible":!0,"data-p-hidden-focusable":!0}),null,16)],16,xre)):Zn("",!0)]}),_:3},16,["onEnter","onAfterEnter","onLeave","onAfterLeave"])]}),_:3},8,["appendTo"])],16,yre)}kS.render=Tre;var bB={name:"AngleDownIcon",extends:qo};function Ere(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{d:"M3.58659 4.5007C3.68513 4.50023 3.78277 4.51945 3.87379 4.55723C3.9648 4.59501 4.04735 4.65058 4.11659 4.7207L7.11659 7.7207L10.1166 4.7207C10.2619 4.65055 10.4259 4.62911 10.5843 4.65956C10.7427 4.69002 10.8871 4.77074 10.996 4.88976C11.1049 5.00877 11.1726 5.15973 11.1889 5.32022C11.2052 5.48072 11.1693 5.6422 11.0866 5.7807L7.58659 9.2807C7.44597 9.42115 7.25534 9.50004 7.05659 9.50004C6.85784 9.50004 6.66722 9.42115 6.52659 9.2807L3.02659 5.7807C2.88614 5.64007 2.80725 5.44945 2.80725 5.2507C2.80725 5.05195 2.88614 4.86132 3.02659 4.7207C3.09932 4.64685 3.18675 4.58911 3.28322 4.55121C3.37969 4.51331 3.48305 4.4961 3.58659 4.5007Z",fill:"currentColor"},null,-1)]),16)}bB.render=Ere;var xB={name:"AngleUpIcon",extends:qo};function Ire(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{d:"M10.4134 9.49931C10.3148 9.49977 10.2172 9.48055 10.1262 9.44278C10.0352 9.405 9.95263 9.34942 9.88338 9.27931L6.88338 6.27931L3.88338 9.27931C3.73811 9.34946 3.57409 9.3709 3.41567 9.34044C3.25724 9.30999 3.11286 9.22926 3.00395 9.11025C2.89504 8.99124 2.82741 8.84028 2.8111 8.67978C2.79478 8.51928 2.83065 8.35781 2.91338 8.21931L6.41338 4.71931C6.55401 4.57886 6.74463 4.49997 6.94338 4.49997C7.14213 4.49997 7.33276 4.57886 7.47338 4.71931L10.9734 8.21931C11.1138 8.35994 11.1927 8.55056 11.1927 8.74931C11.1927 8.94806 11.1138 9.13868 10.9734 9.27931C10.9007 9.35315 10.8132 9.41089 10.7168 9.44879C10.6203 9.48669 10.5169 9.5039 10.4134 9.49931Z",fill:"currentColor"},null,-1)]),16)}xB.render=Ire;var Are=`
    .p-inputnumber {
        display: inline-flex;
        position: relative;
    }

    .p-inputnumber-button {
        display: flex;
        align-items: center;
        justify-content: center;
        flex: 0 0 auto;
        cursor: pointer;
        background: dt('inputnumber.button.background');
        color: dt('inputnumber.button.color');
        width: dt('inputnumber.button.width');
        transition:
            background dt('inputnumber.transition.duration'),
            color dt('inputnumber.transition.duration'),
            border-color dt('inputnumber.transition.duration'),
            outline-color dt('inputnumber.transition.duration');
    }

    .p-inputnumber-button:disabled {
        cursor: auto;
    }

    .p-inputnumber-button:not(:disabled):hover {
        background: dt('inputnumber.button.hover.background');
        color: dt('inputnumber.button.hover.color');
    }

    .p-inputnumber-button:not(:disabled):active {
        background: dt('inputnumber.button.active.background');
        color: dt('inputnumber.button.active.color');
    }

    .p-inputnumber-stacked .p-inputnumber-button {
        position: relative;
        flex: 1 1 auto;
        border: 0 none;
    }

    .p-inputnumber-stacked .p-inputnumber-button-group {
        display: flex;
        flex-direction: column;
        position: absolute;
        inset-block-start: 1px;
        inset-inline-end: 1px;
        height: calc(100% - 2px);
        z-index: 1;
    }

    .p-inputnumber-stacked .p-inputnumber-increment-button {
        padding: 0;
        border-start-end-radius: calc(dt('inputnumber.button.border.radius') - 1px);
    }

    .p-inputnumber-stacked .p-inputnumber-decrement-button {
        padding: 0;
        border-end-end-radius: calc(dt('inputnumber.button.border.radius') - 1px);
    }

    .p-inputnumber-horizontal .p-inputnumber-button {
        border: 1px solid dt('inputnumber.button.border.color');
    }

    .p-inputnumber-horizontal .p-inputnumber-button:hover {
        border-color: dt('inputnumber.button.hover.border.color');
    }

    .p-inputnumber-horizontal .p-inputnumber-button:active {
        border-color: dt('inputnumber.button.active.border.color');
    }

    .p-inputnumber-horizontal .p-inputnumber-increment-button {
        order: 3;
        border-start-end-radius: dt('inputnumber.button.border.radius');
        border-end-end-radius: dt('inputnumber.button.border.radius');
        border-inline-start: 0 none;
    }

    .p-inputnumber-horizontal .p-inputnumber-input {
        order: 2;
        border-radius: 0;
    }

    .p-inputnumber-horizontal .p-inputnumber-decrement-button {
        order: 1;
        border-start-start-radius: dt('inputnumber.button.border.radius');
        border-end-start-radius: dt('inputnumber.button.border.radius');
        border-inline-end: 0 none;
    }

    .p-floatlabel:has(.p-inputnumber-horizontal) label {
        margin-inline-start: dt('inputnumber.button.width');
    }

    .p-inputnumber-vertical {
        flex-direction: column;
    }

    .p-inputnumber-vertical .p-inputnumber-button {
        border: 1px solid dt('inputnumber.button.border.color');
        padding: dt('inputnumber.button.vertical.padding');
    }

    .p-inputnumber-vertical .p-inputnumber-button:hover {
        border-color: dt('inputnumber.button.hover.border.color');
    }

    .p-inputnumber-vertical .p-inputnumber-button:active {
        border-color: dt('inputnumber.button.active.border.color');
    }

    .p-inputnumber-vertical .p-inputnumber-increment-button {
        order: 1;
        border-start-start-radius: dt('inputnumber.button.border.radius');
        border-start-end-radius: dt('inputnumber.button.border.radius');
        width: 100%;
        border-block-end: 0 none;
    }

    .p-inputnumber-vertical .p-inputnumber-input {
        order: 2;
        border-radius: 0;
        text-align: center;
    }

    .p-inputnumber-vertical .p-inputnumber-decrement-button {
        order: 3;
        border-end-start-radius: dt('inputnumber.button.border.radius');
        border-end-end-radius: dt('inputnumber.button.border.radius');
        width: 100%;
        border-block-start: 0 none;
    }

    .p-inputnumber-input {
        flex: 1 1 auto;
    }

    .p-inputnumber-fluid {
        width: 100%;
    }

    .p-inputnumber-fluid .p-inputnumber-input {
        width: 1%;
    }

    .p-inputnumber-fluid.p-inputnumber-vertical .p-inputnumber-input {
        width: 100%;
    }

    .p-inputnumber:has(.p-inputtext-sm) .p-inputnumber-button .p-icon {
        font-size: dt('form.field.sm.font.size');
        width: dt('form.field.sm.font.size');
        height: dt('form.field.sm.font.size');
    }

    .p-inputnumber:has(.p-inputtext-lg) .p-inputnumber-button .p-icon {
        font-size: dt('form.field.lg.font.size');
        width: dt('form.field.lg.font.size');
        height: dt('form.field.lg.font.size');
    }

    .p-inputnumber-clear-icon {
        position: absolute;
        top: 50%;
        margin-top: -0.5rem;
        cursor: pointer;
        inset-inline-end: dt('form.field.padding.x');
        color: dt('form.field.icon.color');
    }

    .p-inputnumber-stacked .p-inputnumber-clear-icon, 
    .p-inputnumber-horizontal .p-inputnumber-clear-icon {
        inset-inline-end: calc(dt('inputnumber.button.width') + dt('form.field.padding.x'));
    }
`,kre={root:function(e){var n=e.instance,r=e.props;return["p-inputnumber p-component p-inputwrapper",{"p-invalid":n.$invalid,"p-inputwrapper-filled":n.$filled||r.allowEmpty===!1,"p-inputwrapper-focus":n.focused,"p-inputnumber-stacked":r.showButtons&&r.buttonLayout==="stacked","p-inputnumber-horizontal":r.showButtons&&r.buttonLayout==="horizontal","p-inputnumber-vertical":r.showButtons&&r.buttonLayout==="vertical","p-inputnumber-fluid":n.$fluid}]},pcInputText:"p-inputnumber-input",buttonGroup:"p-inputnumber-button-group",incrementButton:function(e){var n=e.instance,r=e.props;return["p-inputnumber-button p-inputnumber-increment-button",{"p-disabled":r.showButtons&&r.max!==null&&n.maxBoundry()}]},decrementButton:function(e){var n=e.instance,r=e.props;return["p-inputnumber-button p-inputnumber-decrement-button",{"p-disabled":r.showButtons&&r.min!==null&&n.minBoundry()}]}},Rre=Kr.extend({name:"inputnumber",style:Are,classes:kre}),Pre={name:"BaseInputNumber",extends:k0,props:{format:{type:Boolean,default:!0},showButtons:{type:Boolean,default:!1},buttonLayout:{type:String,default:"stacked"},incrementButtonClass:{type:String,default:null},decrementButtonClass:{type:String,default:null},incrementButtonIcon:{type:String,default:void 0},incrementIcon:{type:String,default:void 0},decrementButtonIcon:{type:String,default:void 0},decrementIcon:{type:String,default:void 0},locale:{type:String,default:void 0},localeMatcher:{type:String,default:void 0},mode:{type:String,default:"decimal"},prefix:{type:String,default:null},suffix:{type:String,default:null},currency:{type:String,default:void 0},currencyDisplay:{type:String,default:void 0},useGrouping:{type:Boolean,default:!0},minFractionDigits:{type:Number,default:void 0},maxFractionDigits:{type:Number,default:void 0},roundingMode:{type:String,default:"halfExpand",validator:function(e){return["ceil","floor","expand","trunc","halfCeil","halfFloor","halfExpand","halfTrunc","halfEven"].includes(e)}},min:{type:Number,default:null},max:{type:Number,default:null},step:{type:Number,default:1},allowEmpty:{type:Boolean,default:!0},highlightOnFocus:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},placeholder:{type:String,default:null},inputId:{type:String,default:null},inputClass:{type:[String,Object],default:null},inputStyle:{type:Object,default:null},ariaLabelledby:{type:String,default:null},ariaLabel:{type:String,default:null},required:{type:Boolean,default:!1}},style:Rre,provide:function(){return{$pcInputNumber:this,$parentInstance:this}}};function Zb(t){"@babel/helpers - typeof";return Zb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zb(t)}function E3(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function I3(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?E3(Object(n),!0).forEach(function(r){QT(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):E3(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function QT(t,e,n){return(e=Mre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mre(t){var e=Dre(t,"string");return Zb(e)=="symbol"?e:e+""}function Dre(t,e){if(Zb(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Zb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ore(t){return Fre(t)||Bre(t)||zre(t)||Lre()}function Lre(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zre(t,e){if(t){if(typeof t=="string")return eE(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eE(t,e):void 0}}function Bre(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Fre(t){if(Array.isArray(t))return eE(t)}function eE(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var wB={name:"InputNumber",extends:Pre,inheritAttrs:!1,emits:["input","focus","blur"],inject:{$pcFluid:{default:null}},numberFormat:null,_numeral:null,_decimal:null,_group:null,_minusSign:null,_currency:null,_suffix:null,_prefix:null,_index:null,groupChar:"",isSpecialChar:null,prefixChar:null,suffixChar:null,timer:null,data:function(){return{d_modelValue:this.d_value,focused:!1}},watch:{d_value:function(e){this.d_modelValue=e},locale:function(e,n){this.updateConstructParser(e,n)},localeMatcher:function(e,n){this.updateConstructParser(e,n)},mode:function(e,n){this.updateConstructParser(e,n)},currency:function(e,n){this.updateConstructParser(e,n)},currencyDisplay:function(e,n){this.updateConstructParser(e,n)},useGrouping:function(e,n){this.updateConstructParser(e,n)},minFractionDigits:function(e,n){this.updateConstructParser(e,n)},maxFractionDigits:function(e,n){this.updateConstructParser(e,n)},suffix:function(e,n){this.updateConstructParser(e,n)},prefix:function(e,n){this.updateConstructParser(e,n)}},created:function(){this.constructParser()},methods:{getOptions:function(){return{localeMatcher:this.localeMatcher,style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,useGrouping:this.useGrouping,minimumFractionDigits:this.minFractionDigits,maximumFractionDigits:this.maxFractionDigits,roundingMode:this.roundingMode}},constructParser:function(){this.numberFormat=new Intl.NumberFormat(this.locale,this.getOptions());var e=Ore(new Intl.NumberFormat(this.locale,{useGrouping:!1}).format(9876543210)).reverse(),n=new Map(e.map(function(r,c){return[r,c]}));this._numeral=new RegExp("[".concat(e.join(""),"]"),"g"),this._group=this.getGroupingExpression(),this._minusSign=this.getMinusSignExpression(),this._currency=this.getCurrencyExpression(),this._decimal=this.getDecimalExpression(),this._suffix=this.getSuffixExpression(),this._prefix=this.getPrefixExpression(),this._index=function(r){return n.get(r)}},updateConstructParser:function(e,n){e!==n&&this.constructParser()},escapeRegExp:function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},getDecimalExpression:function(){var e=new Intl.NumberFormat(this.locale,I3(I3({},this.getOptions()),{},{useGrouping:!1}));return new RegExp("[".concat(e.format(1.1).replace(this._currency,"").trim().replace(this._numeral,""),"]"),"g")},getGroupingExpression:function(){var e=new Intl.NumberFormat(this.locale,{useGrouping:!0});return this.groupChar=e.format(1e6).trim().replace(this._numeral,"").charAt(0),new RegExp("[".concat(this.groupChar,"]"),"g")},getMinusSignExpression:function(){var e=new Intl.NumberFormat(this.locale,{useGrouping:!1});return new RegExp("[".concat(e.format(-1).trim().replace(this._numeral,""),"]"),"g")},getCurrencyExpression:function(){if(this.currency){var e=new Intl.NumberFormat(this.locale,{style:"currency",currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0,roundingMode:this.roundingMode});return new RegExp("[".concat(e.format(1).replace(/\s/g,"").replace(this._numeral,"").replace(this._group,""),"]"),"g")}return new RegExp("[]","g")},getPrefixExpression:function(){if(this.prefix)this.prefixChar=this.prefix;else{var e=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay});this.prefixChar=e.format(1).split("1")[0]}return new RegExp("".concat(this.escapeRegExp(this.prefixChar||"")),"g")},getSuffixExpression:function(){if(this.suffix)this.suffixChar=this.suffix;else{var e=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0,roundingMode:this.roundingMode});this.suffixChar=e.format(1).split("1")[1]}return new RegExp("".concat(this.escapeRegExp(this.suffixChar||"")),"g")},formatValue:function(e){if(e!=null){if(e==="-")return e;if(this.format){var n=new Intl.NumberFormat(this.locale,this.getOptions()),r=n.format(e);return this.prefix&&(r=this.prefix+r),this.suffix&&(r=r+this.suffix),r}return e.toString()}return""},parseValue:function(e){var n=e.replace(this._suffix,"").replace(this._prefix,"").trim().replace(/\s/g,"").replace(this._currency,"").replace(this._group,"").replace(this._minusSign,"-").replace(this._decimal,".").replace(this._numeral,this._index);if(n){if(n==="-")return n;var r=+n;return isNaN(r)?null:r}return null},repeat:function(e,n,r){var c=this;if(!this.readonly){var u=n||500;this.clearTimer(),this.timer=setTimeout(function(){c.repeat(e,40,r)},u),this.spin(e,r)}},addWithPrecision:function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;return Math.round((e+n)*r)/r},spin:function(e,n){if(this.$refs.input){var r=this.step*n,c=this.parseValue(this.$refs.input.$el.value)||0,u=this.validateValue(this.addWithPrecision(c,r));this.updateInput(u,null,"spin"),this.updateModel(e,u),this.handleOnInput(e,c,u)}},onUpButtonMouseDown:function(e){this.disabled||(this.$refs.input.$el.focus(),this.repeat(e,null,1),e.preventDefault())},onUpButtonMouseUp:function(){this.disabled||this.clearTimer()},onUpButtonMouseLeave:function(){this.disabled||this.clearTimer()},onUpButtonKeyUp:function(){this.disabled||this.clearTimer()},onUpButtonKeyDown:function(e){(e.code==="Space"||e.code==="Enter"||e.code==="NumpadEnter")&&this.repeat(e,null,1)},onDownButtonMouseDown:function(e){this.disabled||(this.$refs.input.$el.focus(),this.repeat(e,null,-1),e.preventDefault())},onDownButtonMouseUp:function(){this.disabled||this.clearTimer()},onDownButtonMouseLeave:function(){this.disabled||this.clearTimer()},onDownButtonKeyUp:function(){this.disabled||this.clearTimer()},onDownButtonKeyDown:function(e){(e.code==="Space"||e.code==="Enter"||e.code==="NumpadEnter")&&this.repeat(e,null,-1)},onUserInput:function(){this.isSpecialChar&&(this.$refs.input.$el.value=this.lastValue),this.isSpecialChar=!1},onInputKeyDown:function(e){if(!this.readonly){if(e.altKey||e.ctrlKey||e.metaKey){this.isSpecialChar=!0,this.lastValue=this.$refs.input.$el.value;return}this.lastValue=e.target.value;var n=e.target.selectionStart,r=e.target.selectionEnd,c=r-n,u=e.target.value,p=null,o=e.code||e.key;switch(o){case"ArrowUp":this.spin(e,1),e.preventDefault();break;case"ArrowDown":this.spin(e,-1),e.preventDefault();break;case"ArrowLeft":if(c>1){var w=this.isNumeralChar(u.charAt(n))?n+1:n+2;this.$refs.input.$el.setSelectionRange(w,w)}else this.isNumeralChar(u.charAt(n-1))||e.preventDefault();break;case"ArrowRight":if(c>1){var T=r-1;this.$refs.input.$el.setSelectionRange(T,T)}else this.isNumeralChar(u.charAt(n))||e.preventDefault();break;case"Tab":case"Enter":case"NumpadEnter":p=this.validateValue(this.parseValue(u)),this.$refs.input.$el.value=this.formatValue(p),this.$refs.input.$el.setAttribute("aria-valuenow",p),this.updateModel(e,p);break;case"Backspace":{if(e.preventDefault(),n===r){n>=u.length&&this.suffixChar!==null&&(n=u.length-this.suffixChar.length,this.$refs.input.$el.setSelectionRange(n,n));var A=u.charAt(n-1),D=this.getDecimalCharIndexes(u),B=D.decimalCharIndex,N=D.decimalCharIndexWithoutPrefix;if(this.isNumeralChar(A)){var ee=this.getDecimalLength(u);if(this._group.test(A))this._group.lastIndex=0,p=u.slice(0,n-2)+u.slice(n-1);else if(this._decimal.test(A))this._decimal.lastIndex=0,ee?this.$refs.input.$el.setSelectionRange(n-1,n-1):p=u.slice(0,n-1)+u.slice(n);else if(B>0&&n>B){var Q=this.isDecimalMode()&&(this.minFractionDigits||0)<ee?"":"0";p=u.slice(0,n-1)+Q+u.slice(n)}else N===1?(p=u.slice(0,n-1)+"0"+u.slice(n),p=this.parseValue(p)>0?p:""):p=u.slice(0,n-1)+u.slice(n)}this.updateValue(e,p,null,"delete-single")}else p=this.deleteRange(u,n,r),this.updateValue(e,p,null,"delete-range");break}case"Delete":if(e.preventDefault(),n===r){var se=u.charAt(n),ce=this.getDecimalCharIndexes(u),be=ce.decimalCharIndex,ze=ce.decimalCharIndexWithoutPrefix;if(this.isNumeralChar(se)){var xe=this.getDecimalLength(u);if(this._group.test(se))this._group.lastIndex=0,p=u.slice(0,n)+u.slice(n+2);else if(this._decimal.test(se))this._decimal.lastIndex=0,xe?this.$refs.input.$el.setSelectionRange(n+1,n+1):p=u.slice(0,n)+u.slice(n+1);else if(be>0&&n>be){var je=this.isDecimalMode()&&(this.minFractionDigits||0)<xe?"":"0";p=u.slice(0,n)+je+u.slice(n+1)}else ze===1?(p=u.slice(0,n)+"0"+u.slice(n+1),p=this.parseValue(p)>0?p:""):p=u.slice(0,n)+u.slice(n+1)}this.updateValue(e,p,null,"delete-back-single")}else p=this.deleteRange(u,n,r),this.updateValue(e,p,null,"delete-range");break;case"Home":e.preventDefault(),xr(this.min)&&this.updateModel(e,this.min);break;case"End":e.preventDefault(),xr(this.max)&&this.updateModel(e,this.max);break}}},onInputKeyPress:function(e){if(!this.readonly){var n=e.key,r=this.isDecimalSign(n),c=this.isMinusSign(n);e.code!=="Enter"&&e.preventDefault(),(Number(n)>=0&&Number(n)<=9||c||r)&&this.insert(e,n,{isDecimalSign:r,isMinusSign:c})}},onPaste:function(e){if(!this.readonly){e.preventDefault();var n=(e.clipboardData||window.clipboardData).getData("Text");if(n){var r=this.parseValue(n);r!=null&&this.insert(e,r.toString())}}},allowMinusSign:function(){return this.min===null||this.min<0},isMinusSign:function(e){return this._minusSign.test(e)||e==="-"?(this._minusSign.lastIndex=0,!0):!1},isDecimalSign:function(e){var n;return(n=this.locale)!==null&&n!==void 0&&n.includes("fr")&&[".",","].includes(e)||this._decimal.test(e)?(this._decimal.lastIndex=0,!0):!1},isDecimalMode:function(){return this.mode==="decimal"},getDecimalCharIndexes:function(e){var n=e.search(this._decimal);this._decimal.lastIndex=0;var r=e.replace(this._prefix,"").trim().replace(/\s/g,"").replace(this._currency,""),c=r.search(this._decimal);return this._decimal.lastIndex=0,{decimalCharIndex:n,decimalCharIndexWithoutPrefix:c}},getCharIndexes:function(e){var n=e.search(this._decimal);this._decimal.lastIndex=0;var r=e.search(this._minusSign);this._minusSign.lastIndex=0;var c=e.search(this._suffix);this._suffix.lastIndex=0;var u=e.search(this._currency);return this._currency.lastIndex=0,{decimalCharIndex:n,minusCharIndex:r,suffixCharIndex:c,currencyCharIndex:u}},insert:function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{isDecimalSign:!1,isMinusSign:!1},c=n.search(this._minusSign);if(this._minusSign.lastIndex=0,!(!this.allowMinusSign()&&c!==-1)){var u=this.$refs.input.$el.selectionStart,p=this.$refs.input.$el.selectionEnd,o=this.$refs.input.$el.value.trim(),w=this.getCharIndexes(o),T=w.decimalCharIndex,A=w.minusCharIndex,D=w.suffixCharIndex,B=w.currencyCharIndex,N;if(r.isMinusSign){var ee=A===-1;(u===0||u===B+1)&&(N=o,(ee||p!==0)&&(N=this.insertText(o,n,0,p)),this.updateValue(e,N,n,"insert"))}else if(r.isDecimalSign)T>0&&u===T?this.updateValue(e,o,n,"insert"):T>u&&T<p?(N=this.insertText(o,n,u,p),this.updateValue(e,N,n,"insert")):T===-1&&this.maxFractionDigits&&(N=this.insertText(o,n,u,p),this.updateValue(e,N,n,"insert"));else{var Q=this.numberFormat.resolvedOptions().maximumFractionDigits,se=u!==p?"range-insert":"insert";if(T>0&&u>T){if(u+n.length-(T+1)<=Q){var ce=B>=u?B-1:D>=u?D:o.length;N=o.slice(0,u)+n+o.slice(u+n.length,ce)+o.slice(ce),this.updateValue(e,N,n,se)}}else N=this.insertText(o,n,u,p),this.updateValue(e,N,n,se)}}},insertText:function(e,n,r,c){var u=n==="."?n:n.split(".");if(u.length===2){var p=e.slice(r,c).search(this._decimal);return this._decimal.lastIndex=0,p>0?e.slice(0,r)+this.formatValue(n)+e.slice(c):this.formatValue(n)||e}else return c-r===e.length?this.formatValue(n):r===0?n+e.slice(c):c===e.length?e.slice(0,r)+n:e.slice(0,r)+n+e.slice(c)},deleteRange:function(e,n,r){var c;return r-n===e.length?c="":n===0?c=e.slice(r):r===e.length?c=e.slice(0,n):c=e.slice(0,n)+e.slice(r),c},initCursor:function(){var e=this.$refs.input.$el.selectionStart,n=this.$refs.input.$el.value,r=n.length,c=null,u=(this.prefixChar||"").length;n=n.replace(this._prefix,""),e=e-u;var p=n.charAt(e);if(this.isNumeralChar(p))return e+u;for(var o=e-1;o>=0;)if(p=n.charAt(o),this.isNumeralChar(p)){c=o+u;break}else o--;if(c!==null)this.$refs.input.$el.setSelectionRange(c+1,c+1);else{for(o=e;o<r;)if(p=n.charAt(o),this.isNumeralChar(p)){c=o+u;break}else o++;c!==null&&this.$refs.input.$el.setSelectionRange(c,c)}return c||0},onInputClick:function(){var e=this.$refs.input.$el.value;!this.readonly&&e!==kD()&&this.initCursor()},isNumeralChar:function(e){return e.length===1&&(this._numeral.test(e)||this._decimal.test(e)||this._group.test(e)||this._minusSign.test(e))?(this.resetRegex(),!0):!1},resetRegex:function(){this._numeral.lastIndex=0,this._decimal.lastIndex=0,this._group.lastIndex=0,this._minusSign.lastIndex=0},updateValue:function(e,n,r,c){var u=this.$refs.input.$el.value,p=null;n!=null&&(p=this.parseValue(n),p=!p&&!this.allowEmpty?0:p,this.updateInput(p,r,c,n),this.handleOnInput(e,u,p))},handleOnInput:function(e,n,r){if(this.isValueChanged(n,r)){var c,u;this.$emit("input",{originalEvent:e,value:r,formattedValue:n}),(c=(u=this.formField).onInput)===null||c===void 0||c.call(u,{originalEvent:e,value:r})}},isValueChanged:function(e,n){if(n===null&&e!==null)return!0;if(n!=null){var r=typeof e=="string"?this.parseValue(e):e;return n!==r}return!1},validateValue:function(e){return e==="-"||e==null?null:this.min!=null&&e<this.min?this.min:this.max!=null&&e>this.max?this.max:e},updateInput:function(e,n,r,c){n=n||"";var u=this.$refs.input.$el.value,p=this.formatValue(e),o=u.length;if(p!==c&&(p=this.concatValues(p,c)),o===0){this.$refs.input.$el.value=p,this.$refs.input.$el.setSelectionRange(0,0);var w=this.initCursor(),T=w+n.length;this.$refs.input.$el.setSelectionRange(T,T)}else{var A=this.$refs.input.$el.selectionStart,D=this.$refs.input.$el.selectionEnd;this.$refs.input.$el.value=p;var B=p.length;if(r==="range-insert"){var N=this.parseValue((u||"").slice(0,A)),ee=N!==null?N.toString():"",Q=ee.split("").join("(".concat(this.groupChar,")?")),se=new RegExp(Q,"g");se.test(p);var ce=n.split("").join("(".concat(this.groupChar,")?")),be=new RegExp(ce,"g");be.test(p.slice(se.lastIndex)),D=se.lastIndex+be.lastIndex,this.$refs.input.$el.setSelectionRange(D,D)}else if(B===o)r==="insert"||r==="delete-back-single"?this.$refs.input.$el.setSelectionRange(D+1,D+1):r==="delete-single"?this.$refs.input.$el.setSelectionRange(D-1,D-1):(r==="delete-range"||r==="spin")&&this.$refs.input.$el.setSelectionRange(D,D);else if(r==="delete-back-single"){var ze=u.charAt(D-1),xe=u.charAt(D),je=o-B,qe=this._group.test(xe);qe&&je===1?D+=1:!qe&&this.isNumeralChar(ze)&&(D+=-1*je+1),this._group.lastIndex=0,this.$refs.input.$el.setSelectionRange(D,D)}else if(u==="-"&&r==="insert"){this.$refs.input.$el.setSelectionRange(0,0);var oe=this.initCursor(),de=oe+n.length+1;this.$refs.input.$el.setSelectionRange(de,de)}else D=D+(B-o),this.$refs.input.$el.setSelectionRange(D,D)}this.$refs.input.$el.setAttribute("aria-valuenow",e)},concatValues:function(e,n){if(e&&n){var r=n.search(this._decimal);return this._decimal.lastIndex=0,this.suffixChar?r!==-1?e.replace(this.suffixChar,"").split(this._decimal)[0]+n.replace(this.suffixChar,"").slice(r)+this.suffixChar:e:r!==-1?e.split(this._decimal)[0]+n.slice(r):e}return e},getDecimalLength:function(e){if(e){var n=e.split(this._decimal);if(n.length===2)return n[1].replace(this._suffix,"").trim().replace(/\s/g,"").replace(this._currency,"").length}return 0},updateModel:function(e,n){this.writeValue(n,e)},onInputFocus:function(e){this.focused=!0,!this.disabled&&!this.readonly&&this.$refs.input.$el.value!==kD()&&this.highlightOnFocus&&e.target.select(),this.$emit("focus",e)},onInputBlur:function(e){var n,r;this.focused=!1;var c=e.target,u=this.validateValue(this.parseValue(c.value));this.$emit("blur",{originalEvent:e,value:c.value}),(n=(r=this.formField).onBlur)===null||n===void 0||n.call(r,e),c.value=this.formatValue(u),c.setAttribute("aria-valuenow",u),this.updateModel(e,u),!this.disabled&&!this.readonly&&this.highlightOnFocus&&Wx()},clearTimer:function(){this.timer&&clearTimeout(this.timer)},maxBoundry:function(){return this.d_value>=this.max},minBoundry:function(){return this.d_value<=this.min}},computed:{upButtonListeners:function(){var e=this;return{mousedown:function(r){return e.onUpButtonMouseDown(r)},mouseup:function(r){return e.onUpButtonMouseUp(r)},mouseleave:function(r){return e.onUpButtonMouseLeave(r)},keydown:function(r){return e.onUpButtonKeyDown(r)},keyup:function(r){return e.onUpButtonKeyUp(r)}}},downButtonListeners:function(){var e=this;return{mousedown:function(r){return e.onDownButtonMouseDown(r)},mouseup:function(r){return e.onDownButtonMouseUp(r)},mouseleave:function(r){return e.onDownButtonMouseLeave(r)},keydown:function(r){return e.onDownButtonKeyDown(r)},keyup:function(r){return e.onDownButtonKeyUp(r)}}},formattedValue:function(){var e=!this.d_value&&!this.allowEmpty?0:this.d_value;return this.formatValue(e)},getFormatter:function(){return this.numberFormat},dataP:function(){return Ka(QT(QT({invalid:this.$invalid,fluid:this.$fluid,filled:this.$variant==="filled"},this.size,this.size),this.buttonLayout,this.showButtons&&this.buttonLayout))}},components:{InputText:gI,AngleUpIcon:xB,AngleDownIcon:bB}},Nre=["data-p"],Vre=["data-p"],$re=["disabled","data-p"],jre=["disabled","data-p"],Ure=["disabled","data-p"],Hre=["disabled","data-p"];function Gre(t,e,n,r,c,u){var p=Ai("InputText");return We(),wt("span",ft({class:t.cx("root")},t.ptmi("root"),{"data-p":u.dataP}),[hi(p,{ref:"input",id:t.inputId,name:t.$formName,role:"spinbutton",class:pr([t.cx("pcInputText"),t.inputClass]),style:C0(t.inputStyle),defaultValue:u.formattedValue,"aria-valuemin":t.min,"aria-valuemax":t.max,"aria-valuenow":t.d_value,inputmode:t.mode==="decimal"&&!t.minFractionDigits?"numeric":"decimal",disabled:t.disabled,readonly:t.readonly,placeholder:t.placeholder,"aria-labelledby":t.ariaLabelledby,"aria-label":t.ariaLabel,required:t.required,size:t.size,invalid:t.invalid,variant:t.variant,onInput:u.onUserInput,onKeydown:u.onInputKeyDown,onKeypress:u.onInputKeyPress,onPaste:u.onPaste,onClick:u.onInputClick,onFocus:u.onInputFocus,onBlur:u.onInputBlur,pt:t.ptm("pcInputText"),unstyled:t.unstyled,"data-p":u.dataP},null,8,["id","name","class","style","defaultValue","aria-valuemin","aria-valuemax","aria-valuenow","inputmode","disabled","readonly","placeholder","aria-labelledby","aria-label","required","size","invalid","variant","onInput","onKeydown","onKeypress","onPaste","onClick","onFocus","onBlur","pt","unstyled","data-p"]),t.showButtons&&t.buttonLayout==="stacked"?(We(),wt("span",ft({key:0,class:t.cx("buttonGroup")},t.ptm("buttonGroup"),{"data-p":u.dataP}),[Ti(t.$slots,"incrementbutton",{listeners:u.upButtonListeners},function(){return[Pe("button",ft({class:[t.cx("incrementButton"),t.incrementButtonClass]},lx(u.upButtonListeners),{disabled:t.disabled,tabindex:-1,"aria-hidden":"true",type:"button"},t.ptm("incrementButton"),{"data-p":u.dataP}),[Ti(t.$slots,t.$slots.incrementicon?"incrementicon":"incrementbuttonicon",{},function(){return[(We(),Sn(lr(t.incrementIcon||t.incrementButtonIcon?"span":"AngleUpIcon"),ft({class:[t.incrementIcon,t.incrementButtonIcon]},t.ptm("incrementIcon"),{"data-pc-section":"incrementicon"}),null,16,["class"]))]})],16,$re)]}),Ti(t.$slots,"decrementbutton",{listeners:u.downButtonListeners},function(){return[Pe("button",ft({class:[t.cx("decrementButton"),t.decrementButtonClass]},lx(u.downButtonListeners),{disabled:t.disabled,tabindex:-1,"aria-hidden":"true",type:"button"},t.ptm("decrementButton"),{"data-p":u.dataP}),[Ti(t.$slots,t.$slots.decrementicon?"decrementicon":"decrementbuttonicon",{},function(){return[(We(),Sn(lr(t.decrementIcon||t.decrementButtonIcon?"span":"AngleDownIcon"),ft({class:[t.decrementIcon,t.decrementButtonIcon]},t.ptm("decrementIcon"),{"data-pc-section":"decrementicon"}),null,16,["class"]))]})],16,jre)]})],16,Vre)):Zn("",!0),Ti(t.$slots,"incrementbutton",{listeners:u.upButtonListeners},function(){return[t.showButtons&&t.buttonLayout!=="stacked"?(We(),wt("button",ft({key:0,class:[t.cx("incrementButton"),t.incrementButtonClass]},lx(u.upButtonListeners),{disabled:t.disabled,tabindex:-1,"aria-hidden":"true",type:"button"},t.ptm("incrementButton"),{"data-p":u.dataP}),[Ti(t.$slots,t.$slots.incrementicon?"incrementicon":"incrementbuttonicon",{},function(){return[(We(),Sn(lr(t.incrementIcon||t.incrementButtonIcon?"span":"AngleUpIcon"),ft({class:[t.incrementIcon,t.incrementButtonIcon]},t.ptm("incrementIcon"),{"data-pc-section":"incrementicon"}),null,16,["class"]))]})],16,Ure)):Zn("",!0)]}),Ti(t.$slots,"decrementbutton",{listeners:u.downButtonListeners},function(){return[t.showButtons&&t.buttonLayout!=="stacked"?(We(),wt("button",ft({key:0,class:[t.cx("decrementButton"),t.decrementButtonClass]},lx(u.downButtonListeners),{disabled:t.disabled,tabindex:-1,"aria-hidden":"true",type:"button"},t.ptm("decrementButton"),{"data-p":u.dataP}),[Ti(t.$slots,t.$slots.decrementicon?"decrementicon":"decrementbuttonicon",{},function(){return[(We(),Sn(lr(t.decrementIcon||t.decrementButtonIcon?"span":"AngleDownIcon"),ft({class:[t.decrementIcon,t.decrementButtonIcon]},t.ptm("decrementIcon"),{"data-pc-section":"decrementicon"}),null,16,["class"]))]})],16,Hre)):Zn("",!0)]})],16,Nre)}wB.render=Gre;var SB={name:"AngleDoubleRightIcon",extends:qo};function Wre(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7.68757 11.1451C7.7791 11.1831 7.8773 11.2024 7.9764 11.2019C8.07769 11.1985 8.17721 11.1745 8.26886 11.1312C8.36052 11.088 8.44238 11.0265 8.50943 10.9505L12.0294 7.49085C12.1707 7.34942 12.25 7.15771 12.25 6.95782C12.25 6.75794 12.1707 6.56622 12.0294 6.42479L8.50943 2.90479C8.37014 2.82159 8.20774 2.78551 8.04633 2.80192C7.88491 2.81833 7.73309 2.88635 7.6134 2.99588C7.4937 3.10541 7.41252 3.25061 7.38189 3.40994C7.35126 3.56927 7.37282 3.73423 7.44337 3.88033L10.4605 6.89748L7.44337 9.91463C7.30212 10.0561 7.22278 10.2478 7.22278 10.4477C7.22278 10.6475 7.30212 10.8393 7.44337 10.9807C7.51301 11.0512 7.59603 11.1071 7.68757 11.1451ZM1.94207 10.9505C2.07037 11.0968 2.25089 11.1871 2.44493 11.2019C2.63898 11.1871 2.81949 11.0968 2.94779 10.9505L6.46779 7.49085C6.60905 7.34942 6.68839 7.15771 6.68839 6.95782C6.68839 6.75793 6.60905 6.56622 6.46779 6.42479L2.94779 2.90479C2.80704 2.83757 2.6489 2.81563 2.49517 2.84201C2.34143 2.86839 2.19965 2.94178 2.08936 3.05207C1.97906 3.16237 1.90567 3.30415 1.8793 3.45788C1.85292 3.61162 1.87485 3.76975 1.94207 3.9105L4.95922 6.92765L1.94207 9.9448C1.81838 10.0831 1.75 10.2621 1.75 10.4477C1.75 10.6332 1.81838 10.8122 1.94207 10.9505Z",fill:"currentColor"},null,-1)]),16)}SB.render=Wre;var CB={name:"AngleRightIcon",extends:qo};function qre(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{d:"M5.25 11.1728C5.14929 11.1694 5.05033 11.1455 4.9592 11.1025C4.86806 11.0595 4.78666 10.9984 4.72 10.9228C4.57955 10.7822 4.50066 10.5916 4.50066 10.3928C4.50066 10.1941 4.57955 10.0035 4.72 9.86283L7.72 6.86283L4.72 3.86283C4.66067 3.71882 4.64765 3.55991 4.68275 3.40816C4.71785 3.25642 4.79932 3.11936 4.91585 3.01602C5.03238 2.91268 5.17819 2.84819 5.33305 2.83149C5.4879 2.81479 5.64411 2.84671 5.78 2.92283L9.28 6.42283C9.42045 6.56346 9.49934 6.75408 9.49934 6.95283C9.49934 7.15158 9.42045 7.34221 9.28 7.48283L5.78 10.9228C5.71333 10.9984 5.63193 11.0595 5.5408 11.1025C5.44966 11.1455 5.35071 11.1694 5.25 11.1728Z",fill:"currentColor"},null,-1)]),16)}CB.render=qre;var TB={name:"AngleLeftIcon",extends:qo};function Zre(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{d:"M8.75 11.185C8.65146 11.1854 8.55381 11.1662 8.4628 11.1284C8.37179 11.0906 8.28924 11.0351 8.22 10.965L4.72 7.46496C4.57955 7.32433 4.50066 7.13371 4.50066 6.93496C4.50066 6.73621 4.57955 6.54558 4.72 6.40496L8.22 2.93496C8.36095 2.84357 8.52851 2.80215 8.69582 2.81733C8.86312 2.83252 9.02048 2.90344 9.14268 3.01872C9.26487 3.134 9.34483 3.28696 9.36973 3.4531C9.39463 3.61924 9.36303 3.78892 9.28 3.93496L6.28 6.93496L9.28 9.93496C9.42045 10.0756 9.49934 10.2662 9.49934 10.465C9.49934 10.6637 9.42045 10.8543 9.28 10.995C9.13526 11.1257 8.9448 11.1939 8.75 11.185Z",fill:"currentColor"},null,-1)]),16)}TB.render=Zre;var Kre={name:"BasePaginator",extends:Lo,props:{totalRecords:{type:Number,default:0},rows:{type:Number,default:0},first:{type:Number,default:0},pageLinkSize:{type:Number,default:5},rowsPerPageOptions:{type:Array,default:null},template:{type:[Object,String],default:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown"},currentPageReportTemplate:{type:null,default:"({currentPage} of {totalPages})"},alwaysShow:{type:Boolean,default:!0}},style:die,provide:function(){return{$pcPaginator:this,$parentInstance:this}}},EB={name:"CurrentPageReport",hostName:"Paginator",extends:Lo,props:{pageCount:{type:Number,default:0},currentPage:{type:Number,default:0},page:{type:Number,default:0},first:{type:Number,default:0},rows:{type:Number,default:0},totalRecords:{type:Number,default:0},template:{type:String,default:"({currentPage} of {totalPages})"}},computed:{text:function(){var e=this.template.replace("{currentPage}",this.currentPage).replace("{totalPages}",this.pageCount).replace("{first}",this.pageCount>0?this.first+1:0).replace("{last}",Math.min(this.first+this.rows,this.totalRecords)).replace("{rows}",this.rows).replace("{totalRecords}",this.totalRecords);return e}}};function Xre(t,e,n,r,c,u){return We(),wt("span",ft({class:t.cx("current")},t.ptm("current")),wr(u.text),17)}EB.render=Xre;var IB={name:"FirstPageLink",hostName:"Paginator",extends:Lo,props:{template:{type:Function,default:null}},methods:{getPTOptions:function(e){return this.ptm(e,{context:{disabled:this.$attrs.disabled}})}},components:{AngleDoubleLeftIcon:fB},directives:{ripple:Wp}};function Yre(t,e,n,r,c,u){var p=uf("ripple");return Ki((We(),wt("button",ft({class:t.cx("first"),type:"button"},u.getPTOptions("first"),{"data-pc-group-section":"pagebutton"}),[(We(),Sn(lr(n.template||"AngleDoubleLeftIcon"),ft({class:t.cx("firstIcon")},u.getPTOptions("firstIcon")),null,16,["class"]))],16)),[[p]])}IB.render=Yre;var AB={name:"JumpToPageDropdown",hostName:"Paginator",extends:Lo,emits:["page-change"],props:{page:Number,pageCount:Number,disabled:Boolean,templates:null},methods:{onChange:function(e){this.$emit("page-change",e)}},computed:{pageOptions:function(){for(var e=[],n=0;n<this.pageCount;n++)e.push({label:String(n+1),value:n});return e}},components:{JTPSelect:kS}};function Jre(t,e,n,r,c,u){var p=Ai("JTPSelect");return We(),Sn(p,{modelValue:n.page,options:u.pageOptions,optionLabel:"label",optionValue:"value","onUpdate:modelValue":e[0]||(e[0]=function(o){return u.onChange(o)}),class:pr(t.cx("pcJumpToPageDropdown")),disabled:n.disabled,unstyled:t.unstyled,pt:t.ptm("pcJumpToPageDropdown"),"data-pc-group-section":"pagedropdown"},Eb({_:2},[n.templates.jumptopagedropdownicon?{name:"dropdownicon",fn:si(function(o){return[(We(),Sn(lr(n.templates.jumptopagedropdownicon),{class:pr(o.class)},null,8,["class"]))]}),key:"0"}:void 0]),1032,["modelValue","options","class","disabled","unstyled","pt"])}AB.render=Jre;var kB={name:"JumpToPageInput",hostName:"Paginator",extends:Lo,inheritAttrs:!1,emits:["page-change"],props:{page:Number,pageCount:Number,disabled:Boolean},data:function(){return{d_page:this.page}},watch:{page:function(e){this.d_page=e}},methods:{onChange:function(e){e!==this.page&&(this.d_page=e,this.$emit("page-change",e-1))}},computed:{inputArialabel:function(){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.jumpToPageInputLabel:void 0}},components:{JTPInput:wB}};function Qre(t,e,n,r,c,u){var p=Ai("JTPInput");return We(),Sn(p,{ref:"jtpInput",modelValue:c.d_page,class:pr(t.cx("pcJumpToPageInputText")),"aria-label":u.inputArialabel,disabled:n.disabled,"onUpdate:modelValue":u.onChange,unstyled:t.unstyled,pt:t.ptm("pcJumpToPageInputText")},null,8,["modelValue","class","aria-label","disabled","onUpdate:modelValue","unstyled","pt"])}kB.render=Qre;var RB={name:"LastPageLink",hostName:"Paginator",extends:Lo,props:{template:{type:Function,default:null}},methods:{getPTOptions:function(e){return this.ptm(e,{context:{disabled:this.$attrs.disabled}})}},components:{AngleDoubleRightIcon:SB},directives:{ripple:Wp}};function eoe(t,e,n,r,c,u){var p=uf("ripple");return Ki((We(),wt("button",ft({class:t.cx("last"),type:"button"},u.getPTOptions("last"),{"data-pc-group-section":"pagebutton"}),[(We(),Sn(lr(n.template||"AngleDoubleRightIcon"),ft({class:t.cx("lastIcon")},u.getPTOptions("lastIcon")),null,16,["class"]))],16)),[[p]])}RB.render=eoe;var PB={name:"NextPageLink",hostName:"Paginator",extends:Lo,props:{template:{type:Function,default:null}},methods:{getPTOptions:function(e){return this.ptm(e,{context:{disabled:this.$attrs.disabled}})}},components:{AngleRightIcon:CB},directives:{ripple:Wp}};function toe(t,e,n,r,c,u){var p=uf("ripple");return Ki((We(),wt("button",ft({class:t.cx("next"),type:"button"},u.getPTOptions("next"),{"data-pc-group-section":"pagebutton"}),[(We(),Sn(lr(n.template||"AngleRightIcon"),ft({class:t.cx("nextIcon")},u.getPTOptions("nextIcon")),null,16,["class"]))],16)),[[p]])}PB.render=toe;var MB={name:"PageLinks",hostName:"Paginator",extends:Lo,inheritAttrs:!1,emits:["click"],props:{value:Array,page:Number},methods:{getPTOptions:function(e,n){return this.ptm(n,{context:{active:e===this.page}})},onPageLinkClick:function(e,n){this.$emit("click",{originalEvent:e,value:n})},ariaPageLabel:function(e){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.pageLabel.replace(/{page}/g,e):void 0}},directives:{ripple:Wp}},noe=["aria-label","aria-current","onClick","data-p-active"];function ioe(t,e,n,r,c,u){var p=uf("ripple");return We(),wt("span",ft({class:t.cx("pages")},t.ptm("pages")),[(We(!0),wt(Mi,null,ea(n.value,function(o){return Ki((We(),wt("button",ft({key:o,class:t.cx("page",{pageLink:o}),type:"button","aria-label":u.ariaPageLabel(o),"aria-current":o-1===n.page?"page":void 0,onClick:function(T){return u.onPageLinkClick(T,o)}},{ref_for:!0},u.getPTOptions(o-1,"page"),{"data-p-active":o-1===n.page}),[Ss(wr(o),1)],16,noe)),[[p]])}),128))],16)}MB.render=ioe;var DB={name:"PrevPageLink",hostName:"Paginator",extends:Lo,props:{template:{type:Function,default:null}},methods:{getPTOptions:function(e){return this.ptm(e,{context:{disabled:this.$attrs.disabled}})}},components:{AngleLeftIcon:TB},directives:{ripple:Wp}};function roe(t,e,n,r,c,u){var p=uf("ripple");return Ki((We(),wt("button",ft({class:t.cx("prev"),type:"button"},u.getPTOptions("prev"),{"data-pc-group-section":"pagebutton"}),[(We(),Sn(lr(n.template||"AngleLeftIcon"),ft({class:t.cx("prevIcon")},u.getPTOptions("prevIcon")),null,16,["class"]))],16)),[[p]])}DB.render=roe;var OB={name:"RowsPerPageDropdown",hostName:"Paginator",extends:Lo,emits:["rows-change"],props:{options:Array,rows:Number,disabled:Boolean,templates:null},methods:{onChange:function(e){this.$emit("rows-change",e)}},computed:{rowsOptions:function(){var e=[];if(this.options)for(var n=0;n<this.options.length;n++)e.push({label:String(this.options[n]),value:this.options[n]});return e}},components:{RPPSelect:kS}};function ooe(t,e,n,r,c,u){var p=Ai("RPPSelect");return We(),Sn(p,{modelValue:n.rows,options:u.rowsOptions,optionLabel:"label",optionValue:"value","onUpdate:modelValue":e[0]||(e[0]=function(o){return u.onChange(o)}),class:pr(t.cx("pcRowPerPageDropdown")),disabled:n.disabled,unstyled:t.unstyled,pt:t.ptm("pcRowPerPageDropdown"),"data-pc-group-section":"pagedropdown"},Eb({_:2},[n.templates.rowsperpagedropdownicon?{name:"dropdownicon",fn:si(function(o){return[(We(),Sn(lr(n.templates.rowsperpagedropdownicon),{class:pr(o.class)},null,8,["class"]))]}),key:"0"}:void 0]),1032,["modelValue","options","class","disabled","unstyled","pt"])}OB.render=ooe;function tE(t){"@babel/helpers - typeof";return tE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tE(t)}function A3(t,e){return coe(t)||loe(t,e)||aoe(t,e)||soe()}function soe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aoe(t,e){if(t){if(typeof t=="string")return k3(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k3(t,e):void 0}}function k3(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function loe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,c,u,p,o=[],w=!0,T=!1;try{if(u=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;w=!1}else for(;!(w=(r=u.call(n)).done)&&(o.push(r.value),o.length!==e);w=!0);}catch(A){T=!0,c=A}finally{try{if(!w&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(T)throw c}}return o}}function coe(t){if(Array.isArray(t))return t}var LB={name:"Paginator",extends:Kre,inheritAttrs:!1,emits:["update:first","update:rows","page"],data:function(){return{d_first:this.first,d_rows:this.rows}},watch:{first:function(e){this.d_first=e},rows:function(e){this.d_rows=e},totalRecords:function(e){this.page>0&&e&&this.d_first>=e&&this.changePage(this.pageCount-1)}},mounted:function(){this.createStyle()},methods:{changePage:function(e){var n=this.pageCount;if(e>=0&&e<n){this.d_first=this.d_rows*e;var r={page:e,first:this.d_first,rows:this.d_rows,pageCount:n};this.$emit("update:first",this.d_first),this.$emit("update:rows",this.d_rows),this.$emit("page",r)}},changePageToFirst:function(e){this.isFirstPage||this.changePage(0),e.preventDefault()},changePageToPrev:function(e){this.changePage(this.page-1),e.preventDefault()},changePageLink:function(e){this.changePage(e.value-1),e.originalEvent.preventDefault()},changePageToNext:function(e){this.changePage(this.page+1),e.preventDefault()},changePageToLast:function(e){this.isLastPage||this.changePage(this.pageCount-1),e.preventDefault()},onRowChange:function(e){this.d_rows=e,this.changePage(this.page)},createStyle:function(){var e=this;if(this.hasBreakpoints()&&!this.isUnstyled){var n;this.styleElement=document.createElement("style"),this.styleElement.type="text/css",hI(this.styleElement,"nonce",(n=this.$primevue)===null||n===void 0||(n=n.config)===null||n===void 0||(n=n.csp)===null||n===void 0?void 0:n.nonce),document.body.appendChild(this.styleElement);var r="",c=Object.keys(this.template),u={};c.sort(function(ee,Q){return parseInt(ee)-parseInt(Q)}).forEach(function(ee){u[ee]=e.template[ee]});for(var p=0,o=Object.entries(Object.entries(u));p<o.length;p++){var w=A3(o[p],2),T=w[0],A=A3(w[1],1),D=A[0],B=void 0,N=void 0;D!=="default"&&typeof Object.keys(u)[T-1]=="string"?N=Number(Object.keys(u)[T-1].slice(0,-2))+1+"px":N=Object.keys(u)[T-1],B=Object.entries(u)[T-1]?"and (min-width:".concat(N,")"):"",D==="default"?r+=`
                            @media screen `.concat(B,` {
                                .p-paginator[`).concat(this.$attrSelector,`],
                                    display: flex;
                                }
                            }
                        `):r+=`
.p-paginator-`.concat(D,` {
    display: none;
}
@media screen `).concat(B," and (max-width: ").concat(D,`) {
    .p-paginator-`).concat(D,` {
        display: flex;
    }

    .p-paginator-default{
        display: none;
    }
}
                    `)}this.styleElement.innerHTML=r}},hasBreakpoints:function(){return tE(this.template)==="object"},getAriaLabel:function(e){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria[e]:void 0}},computed:{templateItems:function(){var e={};if(this.hasBreakpoints()){e=this.template,e.default||(e.default="FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown");for(var n in e)e[n]=this.template[n].split(" ").map(function(r){return r.trim()});return e}return e.default=this.template.split(" ").map(function(r){return r.trim()}),e},page:function(){return Math.floor(this.d_first/this.d_rows)},pageCount:function(){return Math.ceil(this.totalRecords/this.d_rows)},isFirstPage:function(){return this.page===0},isLastPage:function(){return this.page===this.pageCount-1},calculatePageLinkBoundaries:function(){var e=this.pageCount,n=Math.min(this.pageLinkSize,e),r=Math.max(0,Math.ceil(this.page-n/2)),c=Math.min(e-1,r+n-1),u=this.pageLinkSize-(c-r+1);return r=Math.max(0,r-u),[r,c]},pageLinks:function(){for(var e=[],n=this.calculatePageLinkBoundaries,r=n[0],c=n[1],u=r;u<=c;u++)e.push(u+1);return e},currentState:function(){return{page:this.page,first:this.d_first,rows:this.d_rows}},empty:function(){return this.pageCount===0},currentPage:function(){return this.pageCount>0?this.page+1:0},last:function(){return Math.min(this.d_first+this.rows,this.totalRecords)}},components:{CurrentPageReport:EB,FirstPageLink:IB,LastPageLink:RB,NextPageLink:PB,PageLinks:MB,PrevPageLink:DB,RowsPerPageDropdown:OB,JumpToPageDropdown:AB,JumpToPageInput:kB}};function uoe(t,e,n,r,c,u){var p=Ai("FirstPageLink"),o=Ai("PrevPageLink"),w=Ai("NextPageLink"),T=Ai("LastPageLink"),A=Ai("PageLinks"),D=Ai("CurrentPageReport"),B=Ai("RowsPerPageDropdown"),N=Ai("JumpToPageDropdown"),ee=Ai("JumpToPageInput");return t.alwaysShow||u.pageLinks&&u.pageLinks.length>1?(We(),wt("nav",fS(ft({key:0},t.ptmi("paginatorContainer"))),[(We(!0),wt(Mi,null,ea(u.templateItems,function(Q,se){return We(),wt("div",ft({key:se,ref_for:!0,ref:"paginator",class:t.cx("paginator",{key:se})},{ref_for:!0},t.ptm("root")),[t.$slots.container?Ti(t.$slots,"container",{key:0,first:c.d_first+1,last:u.last,rows:c.d_rows,page:u.page,pageCount:u.pageCount,pageLinks:u.pageLinks,totalRecords:t.totalRecords,firstPageCallback:u.changePageToFirst,lastPageCallback:u.changePageToLast,prevPageCallback:u.changePageToPrev,nextPageCallback:u.changePageToNext,rowChangeCallback:u.onRowChange,changePageCallback:u.changePage}):(We(),wt(Mi,{key:1},[t.$slots.start?(We(),wt("div",ft({key:0,class:t.cx("contentStart")},{ref_for:!0},t.ptm("contentStart")),[Ti(t.$slots,"start",{state:u.currentState})],16)):Zn("",!0),Pe("div",ft({class:t.cx("content")},{ref_for:!0},t.ptm("content")),[(We(!0),wt(Mi,null,ea(Q,function(ce){return We(),wt(Mi,{key:ce},[ce==="FirstPageLink"?(We(),Sn(p,{key:0,"aria-label":u.getAriaLabel("firstPageLabel"),template:t.$slots.firsticon||t.$slots.firstpagelinkicon,onClick:e[0]||(e[0]=function(be){return u.changePageToFirst(be)}),disabled:u.isFirstPage||u.empty,unstyled:t.unstyled,pt:t.pt},null,8,["aria-label","template","disabled","unstyled","pt"])):ce==="PrevPageLink"?(We(),Sn(o,{key:1,"aria-label":u.getAriaLabel("prevPageLabel"),template:t.$slots.previcon||t.$slots.prevpagelinkicon,onClick:e[1]||(e[1]=function(be){return u.changePageToPrev(be)}),disabled:u.isFirstPage||u.empty,unstyled:t.unstyled,pt:t.pt},null,8,["aria-label","template","disabled","unstyled","pt"])):ce==="NextPageLink"?(We(),Sn(w,{key:2,"aria-label":u.getAriaLabel("nextPageLabel"),template:t.$slots.nexticon||t.$slots.nextpagelinkicon,onClick:e[2]||(e[2]=function(be){return u.changePageToNext(be)}),disabled:u.isLastPage||u.empty,unstyled:t.unstyled,pt:t.pt},null,8,["aria-label","template","disabled","unstyled","pt"])):ce==="LastPageLink"?(We(),Sn(T,{key:3,"aria-label":u.getAriaLabel("lastPageLabel"),template:t.$slots.lasticon||t.$slots.lastpagelinkicon,onClick:e[3]||(e[3]=function(be){return u.changePageToLast(be)}),disabled:u.isLastPage||u.empty,unstyled:t.unstyled,pt:t.pt},null,8,["aria-label","template","disabled","unstyled","pt"])):ce==="PageLinks"?(We(),Sn(A,{key:4,"aria-label":u.getAriaLabel("pageLabel"),value:u.pageLinks,page:u.page,onClick:e[4]||(e[4]=function(be){return u.changePageLink(be)}),unstyled:t.unstyled,pt:t.pt},null,8,["aria-label","value","page","unstyled","pt"])):ce==="CurrentPageReport"?(We(),Sn(D,{key:5,"aria-live":"polite",template:t.currentPageReportTemplate,currentPage:u.currentPage,page:u.page,pageCount:u.pageCount,first:c.d_first,rows:c.d_rows,totalRecords:t.totalRecords,unstyled:t.unstyled,pt:t.pt},null,8,["template","currentPage","page","pageCount","first","rows","totalRecords","unstyled","pt"])):ce==="RowsPerPageDropdown"&&t.rowsPerPageOptions?(We(),Sn(B,{key:6,"aria-label":u.getAriaLabel("rowsPerPageLabel"),rows:c.d_rows,options:t.rowsPerPageOptions,onRowsChange:e[5]||(e[5]=function(be){return u.onRowChange(be)}),disabled:u.empty,templates:t.$slots,unstyled:t.unstyled,pt:t.pt},null,8,["aria-label","rows","options","disabled","templates","unstyled","pt"])):ce==="JumpToPageDropdown"?(We(),Sn(N,{key:7,"aria-label":u.getAriaLabel("jumpToPageDropdownLabel"),page:u.page,pageCount:u.pageCount,onPageChange:e[6]||(e[6]=function(be){return u.changePage(be)}),disabled:u.empty,templates:t.$slots,unstyled:t.unstyled,pt:t.pt},null,8,["aria-label","page","pageCount","disabled","templates","unstyled","pt"])):ce==="JumpToPageInput"?(We(),Sn(ee,{key:8,page:u.currentPage,onPageChange:e[7]||(e[7]=function(be){return u.changePage(be)}),disabled:u.empty,unstyled:t.unstyled,pt:t.pt},null,8,["page","disabled","unstyled","pt"])):Zn("",!0)],64)}),128))],16),t.$slots.end?(We(),wt("div",ft({key:1,class:t.cx("contentEnd")},{ref_for:!0},t.ptm("contentEnd")),[Ti(t.$slots,"end",{state:u.currentState})],16)):Zn("",!0)],64))],16)}),128))],16)):Zn("",!0)}LB.render=uoe;var doe=`
    .p-datatable {
        position: relative;
    }

    .p-datatable-table {
        border-spacing: 0;
        border-collapse: separate;
        width: 100%;
    }

    .p-datatable-scrollable > .p-datatable-table-container {
        position: relative;
    }

    .p-datatable-scrollable-table > .p-datatable-thead {
        inset-block-start: 0;
        z-index: 1;
    }

    .p-datatable-scrollable-table > .p-datatable-frozen-tbody {
        position: sticky;
        z-index: 1;
    }

    .p-datatable-scrollable-table > .p-datatable-tfoot {
        inset-block-end: 0;
        z-index: 1;
    }

    .p-datatable-scrollable .p-datatable-frozen-column {
        position: sticky;
        background: dt('datatable.header.cell.background');
    }

    .p-datatable-scrollable th.p-datatable-frozen-column {
        z-index: 1;
    }

    .p-datatable-scrollable > .p-datatable-table-container > .p-datatable-table > .p-datatable-thead,
    .p-datatable-scrollable > .p-datatable-table-container > .p-virtualscroller > .p-datatable-table > .p-datatable-thead {
        background: dt('datatable.header.cell.background');
    }

    .p-datatable-scrollable > .p-datatable-table-container > .p-datatable-table > .p-datatable-tfoot,
    .p-datatable-scrollable > .p-datatable-table-container > .p-virtualscroller > .p-datatable-table > .p-datatable-tfoot {
        background: dt('datatable.footer.cell.background');
    }

    .p-datatable-flex-scrollable {
        display: flex;
        flex-direction: column;
        height: 100%;
    }

    .p-datatable-flex-scrollable > .p-datatable-table-container {
        display: flex;
        flex-direction: column;
        flex: 1;
        height: 100%;
    }

    .p-datatable-scrollable-table > .p-datatable-tbody > .p-datatable-row-group-header {
        position: sticky;
        z-index: 1;
    }

    .p-datatable-resizable-table > .p-datatable-thead > tr > th,
    .p-datatable-resizable-table > .p-datatable-tfoot > tr > td,
    .p-datatable-resizable-table > .p-datatable-tbody > tr > td {
        overflow: hidden;
        white-space: nowrap;
    }

    .p-datatable-resizable-table > .p-datatable-thead > tr > th.p-datatable-resizable-column:not(.p-datatable-frozen-column) {
        background-clip: padding-box;
        position: relative;
    }

    .p-datatable-resizable-table-fit > .p-datatable-thead > tr > th.p-datatable-resizable-column:last-child .p-datatable-column-resizer {
        display: none;
    }

    .p-datatable-column-resizer {
        display: block;
        position: absolute;
        inset-block-start: 0;
        inset-inline-end: 0;
        margin: 0;
        width: dt('datatable.column.resizer.width');
        height: 100%;
        padding: 0;
        cursor: col-resize;
        border: 1px solid transparent;
    }

    .p-datatable-column-header-content {
        display: flex;
        align-items: center;
        gap: dt('datatable.header.cell.gap');
    }

    .p-datatable-column-resize-indicator {
        width: dt('datatable.resize.indicator.width');
        position: absolute;
        z-index: 10;
        display: none;
        background: dt('datatable.resize.indicator.color');
    }

    .p-datatable-row-reorder-indicator-up,
    .p-datatable-row-reorder-indicator-down {
        position: absolute;
        display: none;
    }

    .p-datatable-reorderable-column,
    .p-datatable-reorderable-row-handle {
        cursor: move;
    }

    .p-datatable-mask {
        position: absolute;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 2;
    }

    .p-datatable-inline-filter {
        display: flex;
        align-items: center;
        width: 100%;
        gap: dt('datatable.filter.inline.gap');
    }

    .p-datatable-inline-filter .p-datatable-filter-element-container {
        flex: 1 1 auto;
        width: 1%;
    }

    .p-datatable-filter-overlay {
        background: dt('datatable.filter.overlay.select.background');
        color: dt('datatable.filter.overlay.select.color');
        border: 1px solid dt('datatable.filter.overlay.select.border.color');
        border-radius: dt('datatable.filter.overlay.select.border.radius');
        box-shadow: dt('datatable.filter.overlay.select.shadow');
        min-width: 12.5rem;
    }

    .p-datatable-filter-constraint-list {
        margin: 0;
        list-style: none;
        display: flex;
        flex-direction: column;
        padding: dt('datatable.filter.constraint.list.padding');
        gap: dt('datatable.filter.constraint.list.gap');
    }

    .p-datatable-filter-constraint {
        padding: dt('datatable.filter.constraint.padding');
        color: dt('datatable.filter.constraint.color');
        border-radius: dt('datatable.filter.constraint.border.radius');
        cursor: pointer;
        transition:
            background dt('datatable.transition.duration'),
            color dt('datatable.transition.duration'),
            border-color dt('datatable.transition.duration'),
            box-shadow dt('datatable.transition.duration');
    }

    .p-datatable-filter-constraint-selected {
        background: dt('datatable.filter.constraint.selected.background');
        color: dt('datatable.filter.constraint.selected.color');
    }

    .p-datatable-filter-constraint:not(.p-datatable-filter-constraint-selected):not(.p-disabled):hover {
        background: dt('datatable.filter.constraint.focus.background');
        color: dt('datatable.filter.constraint.focus.color');
    }

    .p-datatable-filter-constraint:focus-visible {
        outline: 0 none;
        background: dt('datatable.filter.constraint.focus.background');
        color: dt('datatable.filter.constraint.focus.color');
    }

    .p-datatable-filter-constraint-selected:focus-visible {
        outline: 0 none;
        background: dt('datatable.filter.constraint.selected.focus.background');
        color: dt('datatable.filter.constraint.selected.focus.color');
    }

    .p-datatable-filter-constraint-separator {
        border-block-start: 1px solid dt('datatable.filter.constraint.separator.border.color');
    }

    .p-datatable-popover-filter {
        display: inline-flex;
        margin-inline-start: auto;
    }

    .p-datatable-filter-overlay-popover {
        background: dt('datatable.filter.overlay.popover.background');
        color: dt('datatable.filter.overlay.popover.color');
        border: 1px solid dt('datatable.filter.overlay.popover.border.color');
        border-radius: dt('datatable.filter.overlay.popover.border.radius');
        box-shadow: dt('datatable.filter.overlay.popover.shadow');
        min-width: 12.5rem;
        padding: dt('datatable.filter.overlay.popover.padding');
        display: flex;
        flex-direction: column;
        gap: dt('datatable.filter.overlay.popover.gap');
    }

    .p-datatable-filter-operator-dropdown {
        width: 100%;
    }

    .p-datatable-filter-rule-list,
    .p-datatable-filter-rule {
        display: flex;
        flex-direction: column;
        gap: dt('datatable.filter.overlay.popover.gap');
    }

    .p-datatable-filter-rule {
        border-block-end: 1px solid dt('datatable.filter.rule.border.color');
        padding-bottom: dt('datatable.filter.overlay.popover.gap');
    }

    .p-datatable-filter-rule:last-child {
        border-block-end: 0 none;
        padding-bottom: 0;
    }

    .p-datatable-filter-add-rule-button {
        width: 100%;
    }

    .p-datatable-filter-remove-rule-button {
        width: 100%;
    }

    .p-datatable-filter-buttonbar {
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .p-datatable-virtualscroller-spacer {
        display: flex;
    }

    .p-datatable .p-virtualscroller .p-virtualscroller-loading {
        transform: none !important;
        min-height: 0;
        position: sticky;
        inset-block-start: 0;
        inset-inline-start: 0;
    }

    .p-datatable-paginator-top {
        border-color: dt('datatable.paginator.top.border.color');
        border-style: solid;
        border-width: dt('datatable.paginator.top.border.width');
    }

    .p-datatable-paginator-bottom {
        border-color: dt('datatable.paginator.bottom.border.color');
        border-style: solid;
        border-width: dt('datatable.paginator.bottom.border.width');
    }

    .p-datatable-header {
        background: dt('datatable.header.background');
        color: dt('datatable.header.color');
        border-color: dt('datatable.header.border.color');
        border-style: solid;
        border-width: dt('datatable.header.border.width');
        padding: dt('datatable.header.padding');
    }

    .p-datatable-footer {
        background: dt('datatable.footer.background');
        color: dt('datatable.footer.color');
        border-color: dt('datatable.footer.border.color');
        border-style: solid;
        border-width: dt('datatable.footer.border.width');
        padding: dt('datatable.footer.padding');
    }

    .p-datatable-header-cell {
        padding: dt('datatable.header.cell.padding');
        background: dt('datatable.header.cell.background');
        border-color: dt('datatable.header.cell.border.color');
        border-style: solid;
        border-width: 0 0 1px 0;
        color: dt('datatable.header.cell.color');
        font-weight: normal;
        text-align: start;
        transition:
            background dt('datatable.transition.duration'),
            color dt('datatable.transition.duration'),
            border-color dt('datatable.transition.duration'),
            outline-color dt('datatable.transition.duration'),
            box-shadow dt('datatable.transition.duration');
    }

    .p-datatable-column-title {
        font-weight: dt('datatable.column.title.font.weight');
    }

    .p-datatable-tbody > tr {
        outline-color: transparent;
        background: dt('datatable.row.background');
        color: dt('datatable.row.color');
        transition:
            background dt('datatable.transition.duration'),
            color dt('datatable.transition.duration'),
            border-color dt('datatable.transition.duration'),
            outline-color dt('datatable.transition.duration'),
            box-shadow dt('datatable.transition.duration');
    }

    .p-datatable-tbody > tr > td {
        text-align: start;
        border-color: dt('datatable.body.cell.border.color');
        border-style: solid;
        border-width: 0 0 1px 0;
        padding: dt('datatable.body.cell.padding');
    }

    .p-datatable-hoverable .p-datatable-tbody > tr:not(.p-datatable-row-selected):hover {
        background: dt('datatable.row.hover.background');
        color: dt('datatable.row.hover.color');
    }

    .p-datatable-tbody > tr.p-datatable-row-selected {
        background: dt('datatable.row.selected.background');
        color: dt('datatable.row.selected.color');
    }

    .p-datatable-tbody > tr:has(+ .p-datatable-row-selected) > td {
        border-block-end-color: dt('datatable.body.cell.selected.border.color');
    }

    .p-datatable-tbody > tr.p-datatable-row-selected > td {
        border-block-end-color: dt('datatable.body.cell.selected.border.color');
    }

    .p-datatable-tbody > tr:focus-visible,
    .p-datatable-tbody > tr.p-datatable-contextmenu-row-selected {
        box-shadow: dt('datatable.row.focus.ring.shadow');
        outline: dt('datatable.row.focus.ring.width') dt('datatable.row.focus.ring.style') dt('datatable.row.focus.ring.color');
        outline-offset: dt('datatable.row.focus.ring.offset');
    }

    .p-datatable-tfoot > tr > td {
        text-align: start;
        padding: dt('datatable.footer.cell.padding');
        border-color: dt('datatable.footer.cell.border.color');
        border-style: solid;
        border-width: 0 0 1px 0;
        color: dt('datatable.footer.cell.color');
        background: dt('datatable.footer.cell.background');
    }

    .p-datatable-column-footer {
        font-weight: dt('datatable.column.footer.font.weight');
    }

    .p-datatable-sortable-column {
        cursor: pointer;
        user-select: none;
        outline-color: transparent;
    }

    .p-datatable-column-title,
    .p-datatable-sort-icon,
    .p-datatable-sort-badge {
        vertical-align: middle;
    }

    .p-datatable-sort-icon {
        color: dt('datatable.sort.icon.color');
        font-size: dt('datatable.sort.icon.size');
        width: dt('datatable.sort.icon.size');
        height: dt('datatable.sort.icon.size');
        transition: color dt('datatable.transition.duration');
    }

    .p-datatable-sortable-column:not(.p-datatable-column-sorted):hover {
        background: dt('datatable.header.cell.hover.background');
        color: dt('datatable.header.cell.hover.color');
    }

    .p-datatable-sortable-column:not(.p-datatable-column-sorted):hover .p-datatable-sort-icon {
        color: dt('datatable.sort.icon.hover.color');
    }

    .p-datatable-column-sorted {
        background: dt('datatable.header.cell.selected.background');
        color: dt('datatable.header.cell.selected.color');
    }

    .p-datatable-column-sorted .p-datatable-sort-icon {
        color: dt('datatable.header.cell.selected.color');
    }

    .p-datatable-sortable-column:focus-visible {
        box-shadow: dt('datatable.header.cell.focus.ring.shadow');
        outline: dt('datatable.header.cell.focus.ring.width') dt('datatable.header.cell.focus.ring.style') dt('datatable.header.cell.focus.ring.color');
        outline-offset: dt('datatable.header.cell.focus.ring.offset');
    }

    .p-datatable-hoverable .p-datatable-selectable-row {
        cursor: pointer;
    }

    .p-datatable-tbody > tr.p-datatable-dragpoint-top > td {
        box-shadow: inset 0 2px 0 0 dt('datatable.drop.point.color');
    }

    .p-datatable-tbody > tr.p-datatable-dragpoint-bottom > td {
        box-shadow: inset 0 -2px 0 0 dt('datatable.drop.point.color');
    }

    .p-datatable-loading-icon {
        font-size: dt('datatable.loading.icon.size');
        width: dt('datatable.loading.icon.size');
        height: dt('datatable.loading.icon.size');
    }

    .p-datatable-gridlines .p-datatable-header {
        border-width: 1px 1px 0 1px;
    }

    .p-datatable-gridlines .p-datatable-footer {
        border-width: 0 1px 1px 1px;
    }

    .p-datatable-gridlines .p-datatable-paginator-top {
        border-width: 1px 1px 0 1px;
    }

    .p-datatable-gridlines .p-datatable-paginator-bottom {
        border-width: 0 1px 1px 1px;
    }

    .p-datatable-gridlines .p-datatable-thead > tr > th {
        border-width: 1px 0 1px 1px;
    }

    .p-datatable-gridlines .p-datatable-thead > tr > th:last-child {
        border-width: 1px;
    }

    .p-datatable-gridlines .p-datatable-tbody > tr > td {
        border-width: 1px 0 0 1px;
    }

    .p-datatable-gridlines .p-datatable-tbody > tr > td:last-child {
        border-width: 1px 1px 0 1px;
    }

    .p-datatable-gridlines .p-datatable-tbody > tr:last-child > td {
        border-width: 1px 0 1px 1px;
    }

    .p-datatable-gridlines .p-datatable-tbody > tr:last-child > td:last-child {
        border-width: 1px;
    }

    .p-datatable-gridlines .p-datatable-tfoot > tr > td {
        border-width: 1px 0 1px 1px;
    }

    .p-datatable-gridlines .p-datatable-tfoot > tr > td:last-child {
        border-width: 1px 1px 1px 1px;
    }

    .p-datatable.p-datatable-gridlines .p-datatable-thead + .p-datatable-tfoot > tr > td {
        border-width: 0 0 1px 1px;
    }

    .p-datatable.p-datatable-gridlines .p-datatable-thead + .p-datatable-tfoot > tr > td:last-child {
        border-width: 0 1px 1px 1px;
    }

    .p-datatable.p-datatable-gridlines:has(.p-datatable-thead):has(.p-datatable-tbody) .p-datatable-tbody > tr > td {
        border-width: 0 0 1px 1px;
    }

    .p-datatable.p-datatable-gridlines:has(.p-datatable-thead):has(.p-datatable-tbody) .p-datatable-tbody > tr > td:last-child {
        border-width: 0 1px 1px 1px;
    }

    .p-datatable.p-datatable-gridlines:has(.p-datatable-tbody):has(.p-datatable-tfoot) .p-datatable-tbody > tr:last-child > td {
        border-width: 0 0 0 1px;
    }

    .p-datatable.p-datatable-gridlines:has(.p-datatable-tbody):has(.p-datatable-tfoot) .p-datatable-tbody > tr:last-child > td:last-child {
        border-width: 0 1px 0 1px;
    }

    .p-datatable.p-datatable-striped .p-datatable-tbody > tr.p-row-odd {
        background: dt('datatable.row.striped.background');
    }

    .p-datatable.p-datatable-striped .p-datatable-tbody > tr.p-row-odd.p-datatable-row-selected {
        background: dt('datatable.row.selected.background');
        color: dt('datatable.row.selected.color');
    }

    .p-datatable-striped.p-datatable-hoverable .p-datatable-tbody > tr:not(.p-datatable-row-selected):hover {
        background: dt('datatable.row.hover.background');
        color: dt('datatable.row.hover.color');
    }

    .p-datatable.p-datatable-sm .p-datatable-header {
        padding: dt('datatable.header.sm.padding');
    }

    .p-datatable.p-datatable-sm .p-datatable-thead > tr > th {
        padding: dt('datatable.header.cell.sm.padding');
    }

    .p-datatable.p-datatable-sm .p-datatable-tbody > tr > td {
        padding: dt('datatable.body.cell.sm.padding');
    }

    .p-datatable.p-datatable-sm .p-datatable-tfoot > tr > td {
        padding: dt('datatable.footer.cell.sm.padding');
    }

    .p-datatable.p-datatable-sm .p-datatable-footer {
        padding: dt('datatable.footer.sm.padding');
    }

    .p-datatable.p-datatable-lg .p-datatable-header {
        padding: dt('datatable.header.lg.padding');
    }

    .p-datatable.p-datatable-lg .p-datatable-thead > tr > th {
        padding: dt('datatable.header.cell.lg.padding');
    }

    .p-datatable.p-datatable-lg .p-datatable-tbody > tr > td {
        padding: dt('datatable.body.cell.lg.padding');
    }

    .p-datatable.p-datatable-lg .p-datatable-tfoot > tr > td {
        padding: dt('datatable.footer.cell.lg.padding');
    }

    .p-datatable.p-datatable-lg .p-datatable-footer {
        padding: dt('datatable.footer.lg.padding');
    }

    .p-datatable-row-toggle-button {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
        position: relative;
        width: dt('datatable.row.toggle.button.size');
        height: dt('datatable.row.toggle.button.size');
        color: dt('datatable.row.toggle.button.color');
        border: 0 none;
        background: transparent;
        cursor: pointer;
        border-radius: dt('datatable.row.toggle.button.border.radius');
        transition:
            background dt('datatable.transition.duration'),
            color dt('datatable.transition.duration'),
            border-color dt('datatable.transition.duration'),
            outline-color dt('datatable.transition.duration'),
            box-shadow dt('datatable.transition.duration');
        outline-color: transparent;
        user-select: none;
    }

    .p-datatable-row-toggle-button:enabled:hover {
        color: dt('datatable.row.toggle.button.hover.color');
        background: dt('datatable.row.toggle.button.hover.background');
    }

    .p-datatable-tbody > tr.p-datatable-row-selected .p-datatable-row-toggle-button:hover {
        background: dt('datatable.row.toggle.button.selected.hover.background');
        color: dt('datatable.row.toggle.button.selected.hover.color');
    }

    .p-datatable-row-toggle-button:focus-visible {
        box-shadow: dt('datatable.row.toggle.button.focus.ring.shadow');
        outline: dt('datatable.row.toggle.button.focus.ring.width') dt('datatable.row.toggle.button.focus.ring.style') dt('datatable.row.toggle.button.focus.ring.color');
        outline-offset: dt('datatable.row.toggle.button.focus.ring.offset');
    }

    .p-datatable-row-toggle-icon:dir(rtl) {
        transform: rotate(180deg);
    }
`,hoe={root:function(e){var n=e.props;return["p-datatable p-component",{"p-datatable-hoverable":n.rowHover||n.selectionMode,"p-datatable-resizable":n.resizableColumns,"p-datatable-resizable-fit":n.resizableColumns&&n.columnResizeMode==="fit","p-datatable-scrollable":n.scrollable,"p-datatable-flex-scrollable":n.scrollable&&n.scrollHeight==="flex","p-datatable-striped":n.stripedRows,"p-datatable-gridlines":n.showGridlines,"p-datatable-sm":n.size==="small","p-datatable-lg":n.size==="large"}]},mask:"p-datatable-mask p-overlay-mask",loadingIcon:"p-datatable-loading-icon",header:"p-datatable-header",pcPaginator:function(e){var n=e.position;return"p-datatable-paginator-"+n},tableContainer:"p-datatable-table-container",table:function(e){var n=e.props;return["p-datatable-table",{"p-datatable-scrollable-table":n.scrollable,"p-datatable-resizable-table":n.resizableColumns,"p-datatable-resizable-table-fit":n.resizableColumns&&n.columnResizeMode==="fit"}]},thead:"p-datatable-thead",headerCell:function(e){var n=e.instance,r=e.props,c=e.column;return c&&!n.columnProp("hidden")&&(r.rowGroupMode!=="subheader"||r.groupRowsBy!==n.columnProp(c,"field"))?["p-datatable-header-cell",{"p-datatable-frozen-column":n.columnProp("frozen")}]:["p-datatable-header-cell",{"p-datatable-sortable-column":n.columnProp("sortable"),"p-datatable-resizable-column":n.resizableColumns,"p-datatable-column-sorted":n.isColumnSorted(),"p-datatable-frozen-column":n.columnProp("frozen"),"p-datatable-reorderable-column":r.reorderableColumns}]},columnResizer:"p-datatable-column-resizer",columnHeaderContent:"p-datatable-column-header-content",columnTitle:"p-datatable-column-title",columnFooter:"p-datatable-column-footer",sortIcon:"p-datatable-sort-icon",pcSortBadge:"p-datatable-sort-badge",filter:function(e){var n=e.props;return["p-datatable-filter",{"p-datatable-inline-filter":n.display==="row","p-datatable-popover-filter":n.display==="menu"}]},filterElementContainer:"p-datatable-filter-element-container",pcColumnFilterButton:"p-datatable-column-filter-button",pcColumnFilterClearButton:"p-datatable-column-filter-clear-button",filterOverlay:function(e){var n=e.props;return["p-datatable-filter-overlay p-component",{"p-datatable-filter-overlay-popover":n.display==="menu"}]},filterConstraintList:"p-datatable-filter-constraint-list",filterConstraint:function(e){var n=e.instance,r=e.matchMode;return["p-datatable-filter-constraint",{"p-datatable-filter-constraint-selected":r&&n.isRowMatchModeSelected(r.value)}]},filterConstraintSeparator:"p-datatable-filter-constraint-separator",filterOperator:"p-datatable-filter-operator",pcFilterOperatorDropdown:"p-datatable-filter-operator-dropdown",filterRuleList:"p-datatable-filter-rule-list",filterRule:"p-datatable-filter-rule",pcFilterConstraintDropdown:"p-datatable-filter-constraint-dropdown",pcFilterRemoveRuleButton:"p-datatable-filter-remove-rule-button",pcFilterAddRuleButton:"p-datatable-filter-add-rule-button",filterButtonbar:"p-datatable-filter-buttonbar",pcFilterClearButton:"p-datatable-filter-clear-button",pcFilterApplyButton:"p-datatable-filter-apply-button",tbody:function(e){var n=e.props;return n.frozenRow?"p-datatable-tbody p-datatable-frozen-tbody":"p-datatable-tbody"},rowGroupHeader:"p-datatable-row-group-header",rowToggleButton:"p-datatable-row-toggle-button",rowToggleIcon:"p-datatable-row-toggle-icon",row:function(e){var n=e.instance,r=e.props,c=e.index,u=e.columnSelectionMode,p=[];return r.selectionMode&&p.push("p-datatable-selectable-row"),r.selection&&p.push({"p-datatable-row-selected":u?n.isSelected&&n.$parentInstance.$parentInstance.highlightOnSelect:n.isSelected}),r.contextMenuSelection&&p.push({"p-datatable-contextmenu-row-selected":n.isSelectedWithContextMenu}),p.push(c%2===0?"p-row-even":"p-row-odd"),p},rowExpansion:"p-datatable-row-expansion",rowGroupFooter:"p-datatable-row-group-footer",emptyMessage:"p-datatable-empty-message",bodyCell:function(e){var n=e.instance;return[{"p-datatable-frozen-column":n.columnProp("frozen")}]},reorderableRowHandle:"p-datatable-reorderable-row-handle",pcRowEditorInit:"p-datatable-row-editor-init",pcRowEditorSave:"p-datatable-row-editor-save",pcRowEditorCancel:"p-datatable-row-editor-cancel",tfoot:"p-datatable-tfoot",footerCell:function(e){var n=e.instance;return[{"p-datatable-frozen-column":n.columnProp("frozen")}]},virtualScrollerSpacer:"p-datatable-virtualscroller-spacer",footer:"p-datatable-footer",columnResizeIndicator:"p-datatable-column-resize-indicator",rowReorderIndicatorUp:"p-datatable-row-reorder-indicator-up",rowReorderIndicatorDown:"p-datatable-row-reorder-indicator-down"},foe={tableContainer:{overflow:"auto"},thead:{position:"sticky"},tfoot:{position:"sticky"}},poe=Kr.extend({name:"datatable",style:doe,classes:hoe,inlineStyles:foe}),vI={name:"ChevronRightIcon",extends:qo};function moe(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{d:"M4.38708 13C4.28408 13.0005 4.18203 12.9804 4.08691 12.9409C3.99178 12.9014 3.9055 12.8433 3.83313 12.7701C3.68634 12.6231 3.60388 12.4238 3.60388 12.2161C3.60388 12.0084 3.68634 11.8091 3.83313 11.6622L8.50507 6.99022L3.83313 2.31827C3.69467 2.16968 3.61928 1.97313 3.62287 1.77005C3.62645 1.56698 3.70872 1.37322 3.85234 1.22959C3.99596 1.08597 4.18972 1.00371 4.3928 1.00012C4.59588 0.996539 4.79242 1.07192 4.94102 1.21039L10.1669 6.43628C10.3137 6.58325 10.3962 6.78249 10.3962 6.99022C10.3962 7.19795 10.3137 7.39718 10.1669 7.54416L4.94102 12.7701C4.86865 12.8433 4.78237 12.9014 4.68724 12.9409C4.59212 12.9804 4.49007 13.0005 4.38708 13Z",fill:"currentColor"},null,-1)]),16)}vI.render=moe;var zB={name:"BarsIcon",extends:qo};function goe(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M13.3226 3.6129H0.677419C0.497757 3.6129 0.325452 3.54152 0.198411 3.41448C0.0713707 3.28744 0 3.11514 0 2.93548C0 2.75581 0.0713707 2.58351 0.198411 2.45647C0.325452 2.32943 0.497757 2.25806 0.677419 2.25806H13.3226C13.5022 2.25806 13.6745 2.32943 13.8016 2.45647C13.9286 2.58351 14 2.75581 14 2.93548C14 3.11514 13.9286 3.28744 13.8016 3.41448C13.6745 3.54152 13.5022 3.6129 13.3226 3.6129ZM13.3226 7.67741H0.677419C0.497757 7.67741 0.325452 7.60604 0.198411 7.479C0.0713707 7.35196 0 7.17965 0 6.99999C0 6.82033 0.0713707 6.64802 0.198411 6.52098C0.325452 6.39394 0.497757 6.32257 0.677419 6.32257H13.3226C13.5022 6.32257 13.6745 6.39394 13.8016 6.52098C13.9286 6.64802 14 6.82033 14 6.99999C14 7.17965 13.9286 7.35196 13.8016 7.479C13.6745 7.60604 13.5022 7.67741 13.3226 7.67741ZM0.677419 11.7419H13.3226C13.5022 11.7419 13.6745 11.6706 13.8016 11.5435C13.9286 11.4165 14 11.2442 14 11.0645C14 10.8848 13.9286 10.7125 13.8016 10.5855C13.6745 10.4585 13.5022 10.3871 13.3226 10.3871H0.677419C0.497757 10.3871 0.325452 10.4585 0.198411 10.5855C0.0713707 10.7125 0 10.8848 0 11.0645C0 11.2442 0.0713707 11.4165 0.198411 11.5435C0.325452 11.6706 0.497757 11.7419 0.677419 11.7419Z",fill:"currentColor"},null,-1)]),16)}zB.render=goe;var BB={name:"PencilIcon",extends:qo};function _oe(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{d:"M0.609628 13.959C0.530658 13.9599 0.452305 13.9451 0.379077 13.9156C0.305849 13.8861 0.239191 13.8424 0.18294 13.787C0.118447 13.7234 0.0688234 13.6464 0.0376166 13.5614C0.00640987 13.4765 -0.00560954 13.3857 0.00241768 13.2956L0.25679 10.1501C0.267698 10.0041 0.331934 9.86709 0.437312 9.76516L9.51265 0.705715C10.0183 0.233014 10.6911 -0.0203041 11.3835 0.00127367C12.0714 0.00660201 12.7315 0.27311 13.2298 0.746671C13.7076 1.23651 13.9824 1.88848 13.9992 2.57201C14.0159 3.25554 13.7733 3.92015 13.32 4.4327L4.23648 13.5331C4.13482 13.6342 4.0017 13.6978 3.85903 13.7133L0.667067 14L0.609628 13.959ZM1.43018 10.4696L1.25787 12.714L3.50619 12.5092L12.4502 3.56444C12.6246 3.35841 12.7361 3.10674 12.7714 2.83933C12.8067 2.57193 12.7644 2.30002 12.6495 2.05591C12.5346 1.8118 12.3519 1.60575 12.1231 1.46224C11.8943 1.31873 11.6291 1.2438 11.3589 1.24633C11.1813 1.23508 11.0033 1.25975 10.8355 1.31887C10.6677 1.37798 10.5136 1.47033 10.3824 1.59036L1.43018 10.4696Z",fill:"currentColor"},null,-1)]),16)}BB.render=_oe;var yoe=`
    .p-badge {
        display: inline-flex;
        border-radius: dt('badge.border.radius');
        align-items: center;
        justify-content: center;
        padding: dt('badge.padding');
        background: dt('badge.primary.background');
        color: dt('badge.primary.color');
        font-size: dt('badge.font.size');
        font-weight: dt('badge.font.weight');
        min-width: dt('badge.min.width');
        height: dt('badge.height');
    }

    .p-badge-dot {
        width: dt('badge.dot.size');
        min-width: dt('badge.dot.size');
        height: dt('badge.dot.size');
        border-radius: 50%;
        padding: 0;
    }

    .p-badge-circle {
        padding: 0;
        border-radius: 50%;
    }

    .p-badge-secondary {
        background: dt('badge.secondary.background');
        color: dt('badge.secondary.color');
    }

    .p-badge-success {
        background: dt('badge.success.background');
        color: dt('badge.success.color');
    }

    .p-badge-info {
        background: dt('badge.info.background');
        color: dt('badge.info.color');
    }

    .p-badge-warn {
        background: dt('badge.warn.background');
        color: dt('badge.warn.color');
    }

    .p-badge-danger {
        background: dt('badge.danger.background');
        color: dt('badge.danger.color');
    }

    .p-badge-contrast {
        background: dt('badge.contrast.background');
        color: dt('badge.contrast.color');
    }

    .p-badge-sm {
        font-size: dt('badge.sm.font.size');
        min-width: dt('badge.sm.min.width');
        height: dt('badge.sm.height');
    }

    .p-badge-lg {
        font-size: dt('badge.lg.font.size');
        min-width: dt('badge.lg.min.width');
        height: dt('badge.lg.height');
    }

    .p-badge-xl {
        font-size: dt('badge.xl.font.size');
        min-width: dt('badge.xl.min.width');
        height: dt('badge.xl.height');
    }
`,voe={root:function(e){var n=e.props,r=e.instance;return["p-badge p-component",{"p-badge-circle":xr(n.value)&&String(n.value).length===1,"p-badge-dot":xu(n.value)&&!r.$slots.default,"p-badge-sm":n.size==="small","p-badge-lg":n.size==="large","p-badge-xl":n.size==="xlarge","p-badge-info":n.severity==="info","p-badge-success":n.severity==="success","p-badge-warn":n.severity==="warn","p-badge-danger":n.severity==="danger","p-badge-secondary":n.severity==="secondary","p-badge-contrast":n.severity==="contrast"}]}},boe=Kr.extend({name:"badge",style:yoe,classes:voe}),xoe={name:"BaseBadge",extends:Lo,props:{value:{type:[String,Number],default:null},severity:{type:String,default:null},size:{type:String,default:null}},style:boe,provide:function(){return{$pcBadge:this,$parentInstance:this}}};function Kb(t){"@babel/helpers - typeof";return Kb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kb(t)}function R3(t,e,n){return(e=woe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function woe(t){var e=Soe(t,"string");return Kb(e)=="symbol"?e:e+""}function Soe(t,e){if(Kb(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Kb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var bI={name:"Badge",extends:xoe,inheritAttrs:!1,computed:{dataP:function(){return Ka(R3(R3({circle:this.value!=null&&String(this.value).length===1,empty:this.value==null&&!this.$slots.default},this.severity,this.severity),this.size,this.size))}}},Coe=["data-p"];function Toe(t,e,n,r,c,u){return We(),wt("span",ft({class:t.cx("root"),"data-p":u.dataP},t.ptmi("root")),[Ti(t.$slots,"default",{},function(){return[Ss(wr(t.value),1)]})],16,Coe)}bI.render=Toe;var Eoe=`
    .p-button {
        display: inline-flex;
        cursor: pointer;
        user-select: none;
        align-items: center;
        justify-content: center;
        overflow: hidden;
        position: relative;
        color: dt('button.primary.color');
        background: dt('button.primary.background');
        border: 1px solid dt('button.primary.border.color');
        padding: dt('button.padding.y') dt('button.padding.x');
        font-size: 1rem;
        font-family: inherit;
        font-feature-settings: inherit;
        transition:
            background dt('button.transition.duration'),
            color dt('button.transition.duration'),
            border-color dt('button.transition.duration'),
            outline-color dt('button.transition.duration'),
            box-shadow dt('button.transition.duration');
        border-radius: dt('button.border.radius');
        outline-color: transparent;
        gap: dt('button.gap');
    }

    .p-button:disabled {
        cursor: default;
    }

    .p-button-icon-right {
        order: 1;
    }

    .p-button-icon-right:dir(rtl) {
        order: -1;
    }

    .p-button:not(.p-button-vertical) .p-button-icon:not(.p-button-icon-right):dir(rtl) {
        order: 1;
    }

    .p-button-icon-bottom {
        order: 2;
    }

    .p-button-icon-only {
        width: dt('button.icon.only.width');
        padding-inline-start: 0;
        padding-inline-end: 0;
        gap: 0;
    }

    .p-button-icon-only.p-button-rounded {
        border-radius: 50%;
        height: dt('button.icon.only.width');
    }

    .p-button-icon-only .p-button-label {
        visibility: hidden;
        width: 0;
    }

    .p-button-icon-only::after {
        content: "\0A0";
        visibility: hidden;
        width: 0;
    }

    .p-button-sm {
        font-size: dt('button.sm.font.size');
        padding: dt('button.sm.padding.y') dt('button.sm.padding.x');
    }

    .p-button-sm .p-button-icon {
        font-size: dt('button.sm.font.size');
    }

    .p-button-sm.p-button-icon-only {
        width: dt('button.sm.icon.only.width');
    }

    .p-button-sm.p-button-icon-only.p-button-rounded {
        height: dt('button.sm.icon.only.width');
    }

    .p-button-lg {
        font-size: dt('button.lg.font.size');
        padding: dt('button.lg.padding.y') dt('button.lg.padding.x');
    }

    .p-button-lg .p-button-icon {
        font-size: dt('button.lg.font.size');
    }

    .p-button-lg.p-button-icon-only {
        width: dt('button.lg.icon.only.width');
    }

    .p-button-lg.p-button-icon-only.p-button-rounded {
        height: dt('button.lg.icon.only.width');
    }

    .p-button-vertical {
        flex-direction: column;
    }

    .p-button-label {
        font-weight: dt('button.label.font.weight');
    }

    .p-button-fluid {
        width: 100%;
    }

    .p-button-fluid.p-button-icon-only {
        width: dt('button.icon.only.width');
    }

    .p-button:not(:disabled):hover {
        background: dt('button.primary.hover.background');
        border: 1px solid dt('button.primary.hover.border.color');
        color: dt('button.primary.hover.color');
    }

    .p-button:not(:disabled):active {
        background: dt('button.primary.active.background');
        border: 1px solid dt('button.primary.active.border.color');
        color: dt('button.primary.active.color');
    }

    .p-button:focus-visible {
        box-shadow: dt('button.primary.focus.ring.shadow');
        outline: dt('button.focus.ring.width') dt('button.focus.ring.style') dt('button.primary.focus.ring.color');
        outline-offset: dt('button.focus.ring.offset');
    }

    .p-button .p-badge {
        min-width: dt('button.badge.size');
        height: dt('button.badge.size');
        line-height: dt('button.badge.size');
    }

    .p-button-raised {
        box-shadow: dt('button.raised.shadow');
    }

    .p-button-rounded {
        border-radius: dt('button.rounded.border.radius');
    }

    .p-button-secondary {
        background: dt('button.secondary.background');
        border: 1px solid dt('button.secondary.border.color');
        color: dt('button.secondary.color');
    }

    .p-button-secondary:not(:disabled):hover {
        background: dt('button.secondary.hover.background');
        border: 1px solid dt('button.secondary.hover.border.color');
        color: dt('button.secondary.hover.color');
    }

    .p-button-secondary:not(:disabled):active {
        background: dt('button.secondary.active.background');
        border: 1px solid dt('button.secondary.active.border.color');
        color: dt('button.secondary.active.color');
    }

    .p-button-secondary:focus-visible {
        outline-color: dt('button.secondary.focus.ring.color');
        box-shadow: dt('button.secondary.focus.ring.shadow');
    }

    .p-button-success {
        background: dt('button.success.background');
        border: 1px solid dt('button.success.border.color');
        color: dt('button.success.color');
    }

    .p-button-success:not(:disabled):hover {
        background: dt('button.success.hover.background');
        border: 1px solid dt('button.success.hover.border.color');
        color: dt('button.success.hover.color');
    }

    .p-button-success:not(:disabled):active {
        background: dt('button.success.active.background');
        border: 1px solid dt('button.success.active.border.color');
        color: dt('button.success.active.color');
    }

    .p-button-success:focus-visible {
        outline-color: dt('button.success.focus.ring.color');
        box-shadow: dt('button.success.focus.ring.shadow');
    }

    .p-button-info {
        background: dt('button.info.background');
        border: 1px solid dt('button.info.border.color');
        color: dt('button.info.color');
    }

    .p-button-info:not(:disabled):hover {
        background: dt('button.info.hover.background');
        border: 1px solid dt('button.info.hover.border.color');
        color: dt('button.info.hover.color');
    }

    .p-button-info:not(:disabled):active {
        background: dt('button.info.active.background');
        border: 1px solid dt('button.info.active.border.color');
        color: dt('button.info.active.color');
    }

    .p-button-info:focus-visible {
        outline-color: dt('button.info.focus.ring.color');
        box-shadow: dt('button.info.focus.ring.shadow');
    }

    .p-button-warn {
        background: dt('button.warn.background');
        border: 1px solid dt('button.warn.border.color');
        color: dt('button.warn.color');
    }

    .p-button-warn:not(:disabled):hover {
        background: dt('button.warn.hover.background');
        border: 1px solid dt('button.warn.hover.border.color');
        color: dt('button.warn.hover.color');
    }

    .p-button-warn:not(:disabled):active {
        background: dt('button.warn.active.background');
        border: 1px solid dt('button.warn.active.border.color');
        color: dt('button.warn.active.color');
    }

    .p-button-warn:focus-visible {
        outline-color: dt('button.warn.focus.ring.color');
        box-shadow: dt('button.warn.focus.ring.shadow');
    }

    .p-button-help {
        background: dt('button.help.background');
        border: 1px solid dt('button.help.border.color');
        color: dt('button.help.color');
    }

    .p-button-help:not(:disabled):hover {
        background: dt('button.help.hover.background');
        border: 1px solid dt('button.help.hover.border.color');
        color: dt('button.help.hover.color');
    }

    .p-button-help:not(:disabled):active {
        background: dt('button.help.active.background');
        border: 1px solid dt('button.help.active.border.color');
        color: dt('button.help.active.color');
    }

    .p-button-help:focus-visible {
        outline-color: dt('button.help.focus.ring.color');
        box-shadow: dt('button.help.focus.ring.shadow');
    }

    .p-button-danger {
        background: dt('button.danger.background');
        border: 1px solid dt('button.danger.border.color');
        color: dt('button.danger.color');
    }

    .p-button-danger:not(:disabled):hover {
        background: dt('button.danger.hover.background');
        border: 1px solid dt('button.danger.hover.border.color');
        color: dt('button.danger.hover.color');
    }

    .p-button-danger:not(:disabled):active {
        background: dt('button.danger.active.background');
        border: 1px solid dt('button.danger.active.border.color');
        color: dt('button.danger.active.color');
    }

    .p-button-danger:focus-visible {
        outline-color: dt('button.danger.focus.ring.color');
        box-shadow: dt('button.danger.focus.ring.shadow');
    }

    .p-button-contrast {
        background: dt('button.contrast.background');
        border: 1px solid dt('button.contrast.border.color');
        color: dt('button.contrast.color');
    }

    .p-button-contrast:not(:disabled):hover {
        background: dt('button.contrast.hover.background');
        border: 1px solid dt('button.contrast.hover.border.color');
        color: dt('button.contrast.hover.color');
    }

    .p-button-contrast:not(:disabled):active {
        background: dt('button.contrast.active.background');
        border: 1px solid dt('button.contrast.active.border.color');
        color: dt('button.contrast.active.color');
    }

    .p-button-contrast:focus-visible {
        outline-color: dt('button.contrast.focus.ring.color');
        box-shadow: dt('button.contrast.focus.ring.shadow');
    }

    .p-button-outlined {
        background: transparent;
        border-color: dt('button.outlined.primary.border.color');
        color: dt('button.outlined.primary.color');
    }

    .p-button-outlined:not(:disabled):hover {
        background: dt('button.outlined.primary.hover.background');
        border-color: dt('button.outlined.primary.border.color');
        color: dt('button.outlined.primary.color');
    }

    .p-button-outlined:not(:disabled):active {
        background: dt('button.outlined.primary.active.background');
        border-color: dt('button.outlined.primary.border.color');
        color: dt('button.outlined.primary.color');
    }

    .p-button-outlined.p-button-secondary {
        border-color: dt('button.outlined.secondary.border.color');
        color: dt('button.outlined.secondary.color');
    }

    .p-button-outlined.p-button-secondary:not(:disabled):hover {
        background: dt('button.outlined.secondary.hover.background');
        border-color: dt('button.outlined.secondary.border.color');
        color: dt('button.outlined.secondary.color');
    }

    .p-button-outlined.p-button-secondary:not(:disabled):active {
        background: dt('button.outlined.secondary.active.background');
        border-color: dt('button.outlined.secondary.border.color');
        color: dt('button.outlined.secondary.color');
    }

    .p-button-outlined.p-button-success {
        border-color: dt('button.outlined.success.border.color');
        color: dt('button.outlined.success.color');
    }

    .p-button-outlined.p-button-success:not(:disabled):hover {
        background: dt('button.outlined.success.hover.background');
        border-color: dt('button.outlined.success.border.color');
        color: dt('button.outlined.success.color');
    }

    .p-button-outlined.p-button-success:not(:disabled):active {
        background: dt('button.outlined.success.active.background');
        border-color: dt('button.outlined.success.border.color');
        color: dt('button.outlined.success.color');
    }

    .p-button-outlined.p-button-info {
        border-color: dt('button.outlined.info.border.color');
        color: dt('button.outlined.info.color');
    }

    .p-button-outlined.p-button-info:not(:disabled):hover {
        background: dt('button.outlined.info.hover.background');
        border-color: dt('button.outlined.info.border.color');
        color: dt('button.outlined.info.color');
    }

    .p-button-outlined.p-button-info:not(:disabled):active {
        background: dt('button.outlined.info.active.background');
        border-color: dt('button.outlined.info.border.color');
        color: dt('button.outlined.info.color');
    }

    .p-button-outlined.p-button-warn {
        border-color: dt('button.outlined.warn.border.color');
        color: dt('button.outlined.warn.color');
    }

    .p-button-outlined.p-button-warn:not(:disabled):hover {
        background: dt('button.outlined.warn.hover.background');
        border-color: dt('button.outlined.warn.border.color');
        color: dt('button.outlined.warn.color');
    }

    .p-button-outlined.p-button-warn:not(:disabled):active {
        background: dt('button.outlined.warn.active.background');
        border-color: dt('button.outlined.warn.border.color');
        color: dt('button.outlined.warn.color');
    }

    .p-button-outlined.p-button-help {
        border-color: dt('button.outlined.help.border.color');
        color: dt('button.outlined.help.color');
    }

    .p-button-outlined.p-button-help:not(:disabled):hover {
        background: dt('button.outlined.help.hover.background');
        border-color: dt('button.outlined.help.border.color');
        color: dt('button.outlined.help.color');
    }

    .p-button-outlined.p-button-help:not(:disabled):active {
        background: dt('button.outlined.help.active.background');
        border-color: dt('button.outlined.help.border.color');
        color: dt('button.outlined.help.color');
    }

    .p-button-outlined.p-button-danger {
        border-color: dt('button.outlined.danger.border.color');
        color: dt('button.outlined.danger.color');
    }

    .p-button-outlined.p-button-danger:not(:disabled):hover {
        background: dt('button.outlined.danger.hover.background');
        border-color: dt('button.outlined.danger.border.color');
        color: dt('button.outlined.danger.color');
    }

    .p-button-outlined.p-button-danger:not(:disabled):active {
        background: dt('button.outlined.danger.active.background');
        border-color: dt('button.outlined.danger.border.color');
        color: dt('button.outlined.danger.color');
    }

    .p-button-outlined.p-button-contrast {
        border-color: dt('button.outlined.contrast.border.color');
        color: dt('button.outlined.contrast.color');
    }

    .p-button-outlined.p-button-contrast:not(:disabled):hover {
        background: dt('button.outlined.contrast.hover.background');
        border-color: dt('button.outlined.contrast.border.color');
        color: dt('button.outlined.contrast.color');
    }

    .p-button-outlined.p-button-contrast:not(:disabled):active {
        background: dt('button.outlined.contrast.active.background');
        border-color: dt('button.outlined.contrast.border.color');
        color: dt('button.outlined.contrast.color');
    }

    .p-button-outlined.p-button-plain {
        border-color: dt('button.outlined.plain.border.color');
        color: dt('button.outlined.plain.color');
    }

    .p-button-outlined.p-button-plain:not(:disabled):hover {
        background: dt('button.outlined.plain.hover.background');
        border-color: dt('button.outlined.plain.border.color');
        color: dt('button.outlined.plain.color');
    }

    .p-button-outlined.p-button-plain:not(:disabled):active {
        background: dt('button.outlined.plain.active.background');
        border-color: dt('button.outlined.plain.border.color');
        color: dt('button.outlined.plain.color');
    }

    .p-button-text {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.primary.color');
    }

    .p-button-text:not(:disabled):hover {
        background: dt('button.text.primary.hover.background');
        border-color: transparent;
        color: dt('button.text.primary.color');
    }

    .p-button-text:not(:disabled):active {
        background: dt('button.text.primary.active.background');
        border-color: transparent;
        color: dt('button.text.primary.color');
    }

    .p-button-text.p-button-secondary {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.secondary.color');
    }

    .p-button-text.p-button-secondary:not(:disabled):hover {
        background: dt('button.text.secondary.hover.background');
        border-color: transparent;
        color: dt('button.text.secondary.color');
    }

    .p-button-text.p-button-secondary:not(:disabled):active {
        background: dt('button.text.secondary.active.background');
        border-color: transparent;
        color: dt('button.text.secondary.color');
    }

    .p-button-text.p-button-success {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.success.color');
    }

    .p-button-text.p-button-success:not(:disabled):hover {
        background: dt('button.text.success.hover.background');
        border-color: transparent;
        color: dt('button.text.success.color');
    }

    .p-button-text.p-button-success:not(:disabled):active {
        background: dt('button.text.success.active.background');
        border-color: transparent;
        color: dt('button.text.success.color');
    }

    .p-button-text.p-button-info {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.info.color');
    }

    .p-button-text.p-button-info:not(:disabled):hover {
        background: dt('button.text.info.hover.background');
        border-color: transparent;
        color: dt('button.text.info.color');
    }

    .p-button-text.p-button-info:not(:disabled):active {
        background: dt('button.text.info.active.background');
        border-color: transparent;
        color: dt('button.text.info.color');
    }

    .p-button-text.p-button-warn {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.warn.color');
    }

    .p-button-text.p-button-warn:not(:disabled):hover {
        background: dt('button.text.warn.hover.background');
        border-color: transparent;
        color: dt('button.text.warn.color');
    }

    .p-button-text.p-button-warn:not(:disabled):active {
        background: dt('button.text.warn.active.background');
        border-color: transparent;
        color: dt('button.text.warn.color');
    }

    .p-button-text.p-button-help {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.help.color');
    }

    .p-button-text.p-button-help:not(:disabled):hover {
        background: dt('button.text.help.hover.background');
        border-color: transparent;
        color: dt('button.text.help.color');
    }

    .p-button-text.p-button-help:not(:disabled):active {
        background: dt('button.text.help.active.background');
        border-color: transparent;
        color: dt('button.text.help.color');
    }

    .p-button-text.p-button-danger {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.danger.color');
    }

    .p-button-text.p-button-danger:not(:disabled):hover {
        background: dt('button.text.danger.hover.background');
        border-color: transparent;
        color: dt('button.text.danger.color');
    }

    .p-button-text.p-button-danger:not(:disabled):active {
        background: dt('button.text.danger.active.background');
        border-color: transparent;
        color: dt('button.text.danger.color');
    }

    .p-button-text.p-button-contrast {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.contrast.color');
    }

    .p-button-text.p-button-contrast:not(:disabled):hover {
        background: dt('button.text.contrast.hover.background');
        border-color: transparent;
        color: dt('button.text.contrast.color');
    }

    .p-button-text.p-button-contrast:not(:disabled):active {
        background: dt('button.text.contrast.active.background');
        border-color: transparent;
        color: dt('button.text.contrast.color');
    }

    .p-button-text.p-button-plain {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.plain.color');
    }

    .p-button-text.p-button-plain:not(:disabled):hover {
        background: dt('button.text.plain.hover.background');
        border-color: transparent;
        color: dt('button.text.plain.color');
    }

    .p-button-text.p-button-plain:not(:disabled):active {
        background: dt('button.text.plain.active.background');
        border-color: transparent;
        color: dt('button.text.plain.color');
    }

    .p-button-link {
        background: transparent;
        border-color: transparent;
        color: dt('button.link.color');
    }

    .p-button-link:not(:disabled):hover {
        background: transparent;
        border-color: transparent;
        color: dt('button.link.hover.color');
    }

    .p-button-link:not(:disabled):hover .p-button-label {
        text-decoration: underline;
    }

    .p-button-link:not(:disabled):active {
        background: transparent;
        border-color: transparent;
        color: dt('button.link.active.color');
    }
`;function Xb(t){"@babel/helpers - typeof";return Xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xb(t)}function Ud(t,e,n){return(e=Ioe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ioe(t){var e=Aoe(t,"string");return Xb(e)=="symbol"?e:e+""}function Aoe(t,e){if(Xb(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Xb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var koe={root:function(e){var n=e.instance,r=e.props;return["p-button p-component",Ud(Ud(Ud(Ud(Ud(Ud(Ud(Ud(Ud({"p-button-icon-only":n.hasIcon&&!r.label&&!r.badge,"p-button-vertical":(r.iconPos==="top"||r.iconPos==="bottom")&&r.label,"p-button-loading":r.loading,"p-button-link":r.link||r.variant==="link"},"p-button-".concat(r.severity),r.severity),"p-button-raised",r.raised),"p-button-rounded",r.rounded),"p-button-text",r.text||r.variant==="text"),"p-button-outlined",r.outlined||r.variant==="outlined"),"p-button-sm",r.size==="small"),"p-button-lg",r.size==="large"),"p-button-plain",r.plain),"p-button-fluid",n.hasFluid)]},loadingIcon:"p-button-loading-icon",icon:function(e){var n=e.props;return["p-button-icon",Ud({},"p-button-icon-".concat(n.iconPos),n.label)]},label:"p-button-label"},Roe=Kr.extend({name:"button",style:Eoe,classes:koe}),Poe={name:"BaseButton",extends:Lo,props:{label:{type:String,default:null},icon:{type:String,default:null},iconPos:{type:String,default:"left"},iconClass:{type:[String,Object],default:null},badge:{type:String,default:null},badgeClass:{type:[String,Object],default:null},badgeSeverity:{type:String,default:"secondary"},loading:{type:Boolean,default:!1},loadingIcon:{type:String,default:void 0},as:{type:[String,Object],default:"BUTTON"},asChild:{type:Boolean,default:!1},link:{type:Boolean,default:!1},severity:{type:String,default:null},raised:{type:Boolean,default:!1},rounded:{type:Boolean,default:!1},text:{type:Boolean,default:!1},outlined:{type:Boolean,default:!1},size:{type:String,default:null},variant:{type:String,default:null},plain:{type:Boolean,default:!1},fluid:{type:Boolean,default:null}},style:Roe,provide:function(){return{$pcButton:this,$parentInstance:this}}};function Yb(t){"@babel/helpers - typeof";return Yb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yb(t)}function ac(t,e,n){return(e=Moe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Moe(t){var e=Doe(t,"string");return Yb(e)=="symbol"?e:e+""}function Doe(t,e){if(Yb(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Yb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xI={name:"Button",extends:Poe,inheritAttrs:!1,inject:{$pcFluid:{default:null}},methods:{getPTOptions:function(e){var n=e==="root"?this.ptmi:this.ptm;return n(e,{context:{disabled:this.disabled}})}},computed:{disabled:function(){return this.$attrs.disabled||this.$attrs.disabled===""||this.loading},defaultAriaLabel:function(){return this.label?this.label+(this.badge?" "+this.badge:""):this.$attrs.ariaLabel},hasIcon:function(){return this.icon||this.$slots.icon},attrs:function(){return ft(this.asAttrs,this.a11yAttrs,this.getPTOptions("root"))},asAttrs:function(){return this.as==="BUTTON"?{type:"button",disabled:this.disabled}:void 0},a11yAttrs:function(){return{"aria-label":this.defaultAriaLabel,"data-pc-name":"button","data-p-disabled":this.disabled,"data-p-severity":this.severity}},hasFluid:function(){return xu(this.fluid)?!!this.$pcFluid:this.fluid},dataP:function(){return Ka(ac(ac(ac(ac(ac(ac(ac(ac(ac(ac({},this.size,this.size),"icon-only",this.hasIcon&&!this.label&&!this.badge),"loading",this.loading),"fluid",this.hasFluid),"rounded",this.rounded),"raised",this.raised),"outlined",this.outlined||this.variant==="outlined"),"text",this.text||this.variant==="text"),"link",this.link||this.variant==="link"),"vertical",(this.iconPos==="top"||this.iconPos==="bottom")&&this.label))},dataIconP:function(){return Ka(ac(ac({},this.iconPos,this.iconPos),this.size,this.size))},dataLabelP:function(){return Ka(ac(ac({},this.size,this.size),"icon-only",this.hasIcon&&!this.label&&!this.badge))}},components:{SpinnerIcon:A0,Badge:bI},directives:{ripple:Wp}},Ooe=["data-p"],Loe=["data-p"];function zoe(t,e,n,r,c,u){var p=Ai("SpinnerIcon"),o=Ai("Badge"),w=uf("ripple");return t.asChild?Ti(t.$slots,"default",{key:1,class:pr(t.cx("root")),a11yAttrs:u.a11yAttrs}):Ki((We(),Sn(lr(t.as),ft({key:0,class:t.cx("root"),"data-p":u.dataP},u.attrs),{default:si(function(){return[Ti(t.$slots,"default",{},function(){return[t.loading?Ti(t.$slots,"loadingicon",ft({key:0,class:[t.cx("loadingIcon"),t.cx("icon")]},t.ptm("loadingIcon")),function(){return[t.loadingIcon?(We(),wt("span",ft({key:0,class:[t.cx("loadingIcon"),t.cx("icon"),t.loadingIcon]},t.ptm("loadingIcon")),null,16)):(We(),Sn(p,ft({key:1,class:[t.cx("loadingIcon"),t.cx("icon")],spin:""},t.ptm("loadingIcon")),null,16,["class"]))]}):Ti(t.$slots,"icon",ft({key:1,class:[t.cx("icon")]},t.ptm("icon")),function(){return[t.icon?(We(),wt("span",ft({key:0,class:[t.cx("icon"),t.icon,t.iconClass],"data-p":u.dataIconP},t.ptm("icon")),null,16,Ooe)):Zn("",!0)]}),t.label?(We(),wt("span",ft({key:2,class:t.cx("label")},t.ptm("label"),{"data-p":u.dataLabelP}),wr(t.label),17,Loe)):Zn("",!0),t.badge?(We(),Sn(o,{key:3,value:t.badge,class:pr(t.badgeClass),severity:t.badgeSeverity,unstyled:t.unstyled,pt:t.ptm("pcBadge")},null,8,["value","class","severity","unstyled","pt"])):Zn("",!0)]})]}),_:3},16,["class","data-p"])),[[w]])}xI.render=zoe;var FB={name:"MinusIcon",extends:qo};function Boe(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{d:"M13.2222 7.77778H0.777778C0.571498 7.77778 0.373667 7.69584 0.227806 7.54998C0.0819442 7.40412 0 7.20629 0 7.00001C0 6.79373 0.0819442 6.5959 0.227806 6.45003C0.373667 6.30417 0.571498 6.22223 0.777778 6.22223H13.2222C13.4285 6.22223 13.6263 6.30417 13.7722 6.45003C13.9181 6.5959 14 6.79373 14 7.00001C14 7.20629 13.9181 7.40412 13.7722 7.54998C13.6263 7.69584 13.4285 7.77778 13.2222 7.77778Z",fill:"currentColor"},null,-1)]),16)}FB.render=Boe;var Foe=`
    .p-checkbox {
        position: relative;
        display: inline-flex;
        user-select: none;
        vertical-align: bottom;
        width: dt('checkbox.width');
        height: dt('checkbox.height');
    }

    .p-checkbox-input {
        cursor: pointer;
        appearance: none;
        position: absolute;
        inset-block-start: 0;
        inset-inline-start: 0;
        width: 100%;
        height: 100%;
        padding: 0;
        margin: 0;
        opacity: 0;
        z-index: 1;
        outline: 0 none;
        border: 1px solid transparent;
        border-radius: dt('checkbox.border.radius');
    }

    .p-checkbox-box {
        display: flex;
        justify-content: center;
        align-items: center;
        border-radius: dt('checkbox.border.radius');
        border: 1px solid dt('checkbox.border.color');
        background: dt('checkbox.background');
        width: dt('checkbox.width');
        height: dt('checkbox.height');
        transition:
            background dt('checkbox.transition.duration'),
            color dt('checkbox.transition.duration'),
            border-color dt('checkbox.transition.duration'),
            box-shadow dt('checkbox.transition.duration'),
            outline-color dt('checkbox.transition.duration');
        outline-color: transparent;
        box-shadow: dt('checkbox.shadow');
    }

    .p-checkbox-icon {
        transition-duration: dt('checkbox.transition.duration');
        color: dt('checkbox.icon.color');
        font-size: dt('checkbox.icon.size');
        width: dt('checkbox.icon.size');
        height: dt('checkbox.icon.size');
    }

    .p-checkbox:not(.p-disabled):has(.p-checkbox-input:hover) .p-checkbox-box {
        border-color: dt('checkbox.hover.border.color');
    }

    .p-checkbox-checked .p-checkbox-box {
        border-color: dt('checkbox.checked.border.color');
        background: dt('checkbox.checked.background');
    }

    .p-checkbox-checked .p-checkbox-icon {
        color: dt('checkbox.icon.checked.color');
    }

    .p-checkbox-checked:not(.p-disabled):has(.p-checkbox-input:hover) .p-checkbox-box {
        background: dt('checkbox.checked.hover.background');
        border-color: dt('checkbox.checked.hover.border.color');
    }

    .p-checkbox-checked:not(.p-disabled):has(.p-checkbox-input:hover) .p-checkbox-icon {
        color: dt('checkbox.icon.checked.hover.color');
    }

    .p-checkbox:not(.p-disabled):has(.p-checkbox-input:focus-visible) .p-checkbox-box {
        border-color: dt('checkbox.focus.border.color');
        box-shadow: dt('checkbox.focus.ring.shadow');
        outline: dt('checkbox.focus.ring.width') dt('checkbox.focus.ring.style') dt('checkbox.focus.ring.color');
        outline-offset: dt('checkbox.focus.ring.offset');
    }

    .p-checkbox-checked:not(.p-disabled):has(.p-checkbox-input:focus-visible) .p-checkbox-box {
        border-color: dt('checkbox.checked.focus.border.color');
    }

    .p-checkbox.p-invalid > .p-checkbox-box {
        border-color: dt('checkbox.invalid.border.color');
    }

    .p-checkbox.p-variant-filled .p-checkbox-box {
        background: dt('checkbox.filled.background');
    }

    .p-checkbox-checked.p-variant-filled .p-checkbox-box {
        background: dt('checkbox.checked.background');
    }

    .p-checkbox-checked.p-variant-filled:not(.p-disabled):has(.p-checkbox-input:hover) .p-checkbox-box {
        background: dt('checkbox.checked.hover.background');
    }

    .p-checkbox.p-disabled {
        opacity: 1;
    }

    .p-checkbox.p-disabled .p-checkbox-box {
        background: dt('checkbox.disabled.background');
        border-color: dt('checkbox.checked.disabled.border.color');
    }

    .p-checkbox.p-disabled .p-checkbox-box .p-checkbox-icon {
        color: dt('checkbox.icon.disabled.color');
    }

    .p-checkbox-sm,
    .p-checkbox-sm .p-checkbox-box {
        width: dt('checkbox.sm.width');
        height: dt('checkbox.sm.height');
    }

    .p-checkbox-sm .p-checkbox-icon {
        font-size: dt('checkbox.icon.sm.size');
        width: dt('checkbox.icon.sm.size');
        height: dt('checkbox.icon.sm.size');
    }

    .p-checkbox-lg,
    .p-checkbox-lg .p-checkbox-box {
        width: dt('checkbox.lg.width');
        height: dt('checkbox.lg.height');
    }

    .p-checkbox-lg .p-checkbox-icon {
        font-size: dt('checkbox.icon.lg.size');
        width: dt('checkbox.icon.lg.size');
        height: dt('checkbox.icon.lg.size');
    }
`,Noe={root:function(e){var n=e.instance,r=e.props;return["p-checkbox p-component",{"p-checkbox-checked":n.checked,"p-disabled":r.disabled,"p-invalid":n.$pcCheckboxGroup?n.$pcCheckboxGroup.$invalid:n.$invalid,"p-variant-filled":n.$variant==="filled","p-checkbox-sm p-inputfield-sm":r.size==="small","p-checkbox-lg p-inputfield-lg":r.size==="large"}]},box:"p-checkbox-box",input:"p-checkbox-input",icon:"p-checkbox-icon"},Voe=Kr.extend({name:"checkbox",style:Foe,classes:Noe}),$oe={name:"BaseCheckbox",extends:k0,props:{value:null,binary:Boolean,indeterminate:{type:Boolean,default:!1},trueValue:{type:null,default:!0},falseValue:{type:null,default:!1},readonly:{type:Boolean,default:!1},required:{type:Boolean,default:!1},tabindex:{type:Number,default:null},inputId:{type:String,default:null},inputClass:{type:[String,Object],default:null},inputStyle:{type:Object,default:null},ariaLabelledby:{type:String,default:null},ariaLabel:{type:String,default:null}},style:Voe,provide:function(){return{$pcCheckbox:this,$parentInstance:this}}};function Jb(t){"@babel/helpers - typeof";return Jb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jb(t)}function joe(t,e,n){return(e=Uoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uoe(t){var e=Hoe(t,"string");return Jb(e)=="symbol"?e:e+""}function Hoe(t,e){if(Jb(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Jb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Goe(t){return Koe(t)||Zoe(t)||qoe(t)||Woe()}function Woe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qoe(t,e){if(t){if(typeof t=="string")return nE(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?nE(t,e):void 0}}function Zoe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Koe(t){if(Array.isArray(t))return nE(t)}function nE(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var wI={name:"Checkbox",extends:$oe,inheritAttrs:!1,emits:["change","focus","blur","update:indeterminate"],inject:{$pcCheckboxGroup:{default:void 0}},data:function(){return{d_indeterminate:this.indeterminate}},watch:{indeterminate:function(e){this.d_indeterminate=e}},methods:{getPTOptions:function(e){var n=e==="root"?this.ptmi:this.ptm;return n(e,{context:{checked:this.checked,indeterminate:this.d_indeterminate,disabled:this.disabled}})},onChange:function(e){var n=this;if(!this.disabled&&!this.readonly){var r=this.$pcCheckboxGroup?this.$pcCheckboxGroup.d_value:this.d_value,c;this.binary?c=this.d_indeterminate?this.trueValue:this.checked?this.falseValue:this.trueValue:this.checked||this.d_indeterminate?c=r.filter(function(u){return!xg(u,n.value)}):c=r?[].concat(Goe(r),[this.value]):[this.value],this.d_indeterminate&&(this.d_indeterminate=!1,this.$emit("update:indeterminate",this.d_indeterminate)),this.$pcCheckboxGroup?this.$pcCheckboxGroup.writeValue(c,e):this.writeValue(c,e),this.$emit("change",e)}},onFocus:function(e){this.$emit("focus",e)},onBlur:function(e){var n,r;this.$emit("blur",e),(n=(r=this.formField).onBlur)===null||n===void 0||n.call(r,e)}},computed:{groupName:function(){return this.$pcCheckboxGroup?this.$pcCheckboxGroup.groupName:this.$formName},checked:function(){var e=this.$pcCheckboxGroup?this.$pcCheckboxGroup.d_value:this.d_value;return this.d_indeterminate?!1:this.binary?e===this.trueValue:nG(this.value,e)},dataP:function(){return Ka(joe({invalid:this.$invalid,checked:this.checked,disabled:this.disabled,filled:this.$variant==="filled"},this.size,this.size))}},components:{CheckIcon:fy,MinusIcon:FB}},Xoe=["data-p-checked","data-p-indeterminate","data-p-disabled","data-p"],Yoe=["id","value","name","checked","tabindex","disabled","readonly","required","aria-labelledby","aria-label","aria-invalid","aria-checked"],Joe=["data-p"];function Qoe(t,e,n,r,c,u){var p=Ai("CheckIcon"),o=Ai("MinusIcon");return We(),wt("div",ft({class:t.cx("root")},u.getPTOptions("root"),{"data-p-checked":u.checked,"data-p-indeterminate":c.d_indeterminate||void 0,"data-p-disabled":t.disabled,"data-p":u.dataP}),[Pe("input",ft({id:t.inputId,type:"checkbox",class:[t.cx("input"),t.inputClass],style:t.inputStyle,value:t.value,name:u.groupName,checked:u.checked,tabindex:t.tabindex,disabled:t.disabled,readonly:t.readonly,required:t.required,"aria-labelledby":t.ariaLabelledby,"aria-label":t.ariaLabel,"aria-invalid":t.invalid||void 0,"aria-checked":c.d_indeterminate?"mixed":void 0,onFocus:e[0]||(e[0]=function(){return u.onFocus&&u.onFocus.apply(u,arguments)}),onBlur:e[1]||(e[1]=function(){return u.onBlur&&u.onBlur.apply(u,arguments)}),onChange:e[2]||(e[2]=function(){return u.onChange&&u.onChange.apply(u,arguments)})},u.getPTOptions("input")),null,16,Yoe),Pe("div",ft({class:t.cx("box")},u.getPTOptions("box"),{"data-p":u.dataP}),[Ti(t.$slots,"icon",{checked:u.checked,indeterminate:c.d_indeterminate,class:pr(t.cx("icon")),dataP:u.dataP},function(){return[u.checked?(We(),Sn(p,ft({key:0,class:t.cx("icon")},u.getPTOptions("icon"),{"data-p":u.dataP}),null,16,["class","data-p"])):c.d_indeterminate?(We(),Sn(o,ft({key:1,class:t.cx("icon")},u.getPTOptions("icon"),{"data-p":u.dataP}),null,16,["class","data-p"])):Zn("",!0)]})],16,Joe)],16,Xoe)}wI.render=Qoe;var ese=`
    .p-radiobutton {
        position: relative;
        display: inline-flex;
        user-select: none;
        vertical-align: bottom;
        width: dt('radiobutton.width');
        height: dt('radiobutton.height');
    }

    .p-radiobutton-input {
        cursor: pointer;
        appearance: none;
        position: absolute;
        top: 0;
        inset-inline-start: 0;
        width: 100%;
        height: 100%;
        padding: 0;
        margin: 0;
        opacity: 0;
        z-index: 1;
        outline: 0 none;
        border: 1px solid transparent;
        border-radius: 50%;
    }

    .p-radiobutton-box {
        display: flex;
        justify-content: center;
        align-items: center;
        border-radius: 50%;
        border: 1px solid dt('radiobutton.border.color');
        background: dt('radiobutton.background');
        width: dt('radiobutton.width');
        height: dt('radiobutton.height');
        transition:
            background dt('radiobutton.transition.duration'),
            color dt('radiobutton.transition.duration'),
            border-color dt('radiobutton.transition.duration'),
            box-shadow dt('radiobutton.transition.duration'),
            outline-color dt('radiobutton.transition.duration');
        outline-color: transparent;
        box-shadow: dt('radiobutton.shadow');
    }

    .p-radiobutton-icon {
        transition-duration: dt('radiobutton.transition.duration');
        background: transparent;
        font-size: dt('radiobutton.icon.size');
        width: dt('radiobutton.icon.size');
        height: dt('radiobutton.icon.size');
        border-radius: 50%;
        backface-visibility: hidden;
        transform: translateZ(0) scale(0.1);
    }

    .p-radiobutton:not(.p-disabled):has(.p-radiobutton-input:hover) .p-radiobutton-box {
        border-color: dt('radiobutton.hover.border.color');
    }

    .p-radiobutton-checked .p-radiobutton-box {
        border-color: dt('radiobutton.checked.border.color');
        background: dt('radiobutton.checked.background');
    }

    .p-radiobutton-checked .p-radiobutton-box .p-radiobutton-icon {
        background: dt('radiobutton.icon.checked.color');
        transform: translateZ(0) scale(1, 1);
        visibility: visible;
    }

    .p-radiobutton-checked:not(.p-disabled):has(.p-radiobutton-input:hover) .p-radiobutton-box {
        border-color: dt('radiobutton.checked.hover.border.color');
        background: dt('radiobutton.checked.hover.background');
    }

    .p-radiobutton:not(.p-disabled):has(.p-radiobutton-input:hover).p-radiobutton-checked .p-radiobutton-box .p-radiobutton-icon {
        background: dt('radiobutton.icon.checked.hover.color');
    }

    .p-radiobutton:not(.p-disabled):has(.p-radiobutton-input:focus-visible) .p-radiobutton-box {
        border-color: dt('radiobutton.focus.border.color');
        box-shadow: dt('radiobutton.focus.ring.shadow');
        outline: dt('radiobutton.focus.ring.width') dt('radiobutton.focus.ring.style') dt('radiobutton.focus.ring.color');
        outline-offset: dt('radiobutton.focus.ring.offset');
    }

    .p-radiobutton-checked:not(.p-disabled):has(.p-radiobutton-input:focus-visible) .p-radiobutton-box {
        border-color: dt('radiobutton.checked.focus.border.color');
    }

    .p-radiobutton.p-invalid > .p-radiobutton-box {
        border-color: dt('radiobutton.invalid.border.color');
    }

    .p-radiobutton.p-variant-filled .p-radiobutton-box {
        background: dt('radiobutton.filled.background');
    }

    .p-radiobutton.p-variant-filled.p-radiobutton-checked .p-radiobutton-box {
        background: dt('radiobutton.checked.background');
    }

    .p-radiobutton.p-variant-filled:not(.p-disabled):has(.p-radiobutton-input:hover).p-radiobutton-checked .p-radiobutton-box {
        background: dt('radiobutton.checked.hover.background');
    }

    .p-radiobutton.p-disabled {
        opacity: 1;
    }

    .p-radiobutton.p-disabled .p-radiobutton-box {
        background: dt('radiobutton.disabled.background');
        border-color: dt('radiobutton.checked.disabled.border.color');
    }

    .p-radiobutton-checked.p-disabled .p-radiobutton-box .p-radiobutton-icon {
        background: dt('radiobutton.icon.disabled.color');
    }

    .p-radiobutton-sm,
    .p-radiobutton-sm .p-radiobutton-box {
        width: dt('radiobutton.sm.width');
        height: dt('radiobutton.sm.height');
    }

    .p-radiobutton-sm .p-radiobutton-icon {
        font-size: dt('radiobutton.icon.sm.size');
        width: dt('radiobutton.icon.sm.size');
        height: dt('radiobutton.icon.sm.size');
    }

    .p-radiobutton-lg,
    .p-radiobutton-lg .p-radiobutton-box {
        width: dt('radiobutton.lg.width');
        height: dt('radiobutton.lg.height');
    }

    .p-radiobutton-lg .p-radiobutton-icon {
        font-size: dt('radiobutton.icon.lg.size');
        width: dt('radiobutton.icon.lg.size');
        height: dt('radiobutton.icon.lg.size');
    }
`,tse={root:function(e){var n=e.instance,r=e.props;return["p-radiobutton p-component",{"p-radiobutton-checked":n.checked,"p-disabled":r.disabled,"p-invalid":n.$pcRadioButtonGroup?n.$pcRadioButtonGroup.$invalid:n.$invalid,"p-variant-filled":n.$variant==="filled","p-radiobutton-sm p-inputfield-sm":r.size==="small","p-radiobutton-lg p-inputfield-lg":r.size==="large"}]},box:"p-radiobutton-box",input:"p-radiobutton-input",icon:"p-radiobutton-icon"},nse=Kr.extend({name:"radiobutton",style:ese,classes:tse}),ise={name:"BaseRadioButton",extends:k0,props:{value:null,binary:Boolean,readonly:{type:Boolean,default:!1},tabindex:{type:Number,default:null},inputId:{type:String,default:null},inputClass:{type:[String,Object],default:null},inputStyle:{type:Object,default:null},ariaLabelledby:{type:String,default:null},ariaLabel:{type:String,default:null}},style:nse,provide:function(){return{$pcRadioButton:this,$parentInstance:this}}};function Qb(t){"@babel/helpers - typeof";return Qb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qb(t)}function rse(t,e,n){return(e=ose(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ose(t){var e=sse(t,"string");return Qb(e)=="symbol"?e:e+""}function sse(t,e){if(Qb(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Qb(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var NB={name:"RadioButton",extends:ise,inheritAttrs:!1,emits:["change","focus","blur"],inject:{$pcRadioButtonGroup:{default:void 0}},methods:{getPTOptions:function(e){var n=e==="root"?this.ptmi:this.ptm;return n(e,{context:{checked:this.checked,disabled:this.disabled}})},onChange:function(e){if(!this.disabled&&!this.readonly){var n=this.binary?!this.checked:this.value;this.$pcRadioButtonGroup?this.$pcRadioButtonGroup.writeValue(n,e):this.writeValue(n,e),this.$emit("change",e)}},onFocus:function(e){this.$emit("focus",e)},onBlur:function(e){var n,r;this.$emit("blur",e),(n=(r=this.formField).onBlur)===null||n===void 0||n.call(r,e)}},computed:{groupName:function(){return this.$pcRadioButtonGroup?this.$pcRadioButtonGroup.groupName:this.$formName},checked:function(){var e=this.$pcRadioButtonGroup?this.$pcRadioButtonGroup.d_value:this.d_value;return e!=null&&(this.binary?!!e:xg(e,this.value))},dataP:function(){return Ka(rse({invalid:this.$invalid,checked:this.checked,disabled:this.disabled,filled:this.$variant==="filled"},this.size,this.size))}}},ase=["data-p-checked","data-p-disabled","data-p"],lse=["id","value","name","checked","tabindex","disabled","readonly","aria-labelledby","aria-label","aria-invalid"],cse=["data-p"],use=["data-p"];function dse(t,e,n,r,c,u){return We(),wt("div",ft({class:t.cx("root")},u.getPTOptions("root"),{"data-p-checked":u.checked,"data-p-disabled":t.disabled,"data-p":u.dataP}),[Pe("input",ft({id:t.inputId,type:"radio",class:[t.cx("input"),t.inputClass],style:t.inputStyle,value:t.value,name:u.groupName,checked:u.checked,tabindex:t.tabindex,disabled:t.disabled,readonly:t.readonly,"aria-labelledby":t.ariaLabelledby,"aria-label":t.ariaLabel,"aria-invalid":t.invalid||void 0,onFocus:e[0]||(e[0]=function(){return u.onFocus&&u.onFocus.apply(u,arguments)}),onBlur:e[1]||(e[1]=function(){return u.onBlur&&u.onBlur.apply(u,arguments)}),onChange:e[2]||(e[2]=function(){return u.onChange&&u.onChange.apply(u,arguments)})},u.getPTOptions("input")),null,16,lse),Pe("div",ft({class:t.cx("box")},u.getPTOptions("box"),{"data-p":u.dataP}),[Pe("div",ft({class:t.cx("icon")},u.getPTOptions("icon"),{"data-p":u.dataP}),null,16,use)],16,cse)],16,ase)}NB.render=dse;var VB={name:"FilterIcon",extends:qo};function hse(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{d:"M8.64708 14H5.35296C5.18981 13.9979 5.03395 13.9321 4.91858 13.8167C4.8032 13.7014 4.73745 13.5455 4.73531 13.3824V7L0.329431 0.98C0.259794 0.889466 0.217389 0.780968 0.20718 0.667208C0.19697 0.553448 0.219379 0.439133 0.271783 0.337647C0.324282 0.236453 0.403423 0.151519 0.500663 0.0920138C0.597903 0.0325088 0.709548 0.000692754 0.823548 0H13.1765C13.2905 0.000692754 13.4021 0.0325088 13.4994 0.0920138C13.5966 0.151519 13.6758 0.236453 13.7283 0.337647C13.7807 0.439133 13.8031 0.553448 13.7929 0.667208C13.7826 0.780968 13.7402 0.889466 13.6706 0.98L9.26472 7V13.3824C9.26259 13.5455 9.19683 13.7014 9.08146 13.8167C8.96609 13.9321 8.81022 13.9979 8.64708 14ZM5.97061 12.7647H8.02943V6.79412C8.02878 6.66289 8.07229 6.53527 8.15296 6.43177L11.9412 1.23529H2.05884L5.86355 6.43177C5.94422 6.53527 5.98773 6.66289 5.98708 6.79412L5.97061 12.7647Z",fill:"currentColor"},null,-1)]),16)}VB.render=hse;var $B={name:"FilterFillIcon",extends:qo};function fse(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{d:"M13.7274 0.33847C13.6228 0.130941 13.4095 0 13.1764 0H0.82351C0.590451 0 0.377157 0.130941 0.272568 0.33847C0.167157 0.545999 0.187746 0.795529 0.325275 0.98247L4.73527 6.99588V13.3824C4.73527 13.7233 5.01198 14 5.35292 14H8.64704C8.98798 14 9.26469 13.7233 9.26469 13.3824V6.99588L13.6747 0.98247C13.8122 0.795529 13.8328 0.545999 13.7274 0.33847Z",fill:"currentColor"},null,-1)]),16)}$B.render=fse;var jB={name:"FilterSlashIcon",extends:qo};function pse(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M13.4994 0.0920138C13.5967 0.151519 13.6758 0.236453 13.7283 0.337647C13.7807 0.439133 13.8031 0.553448 13.7929 0.667208C13.7827 0.780968 13.7403 0.889466 13.6707 0.98L11.406 4.06823C11.3099 4.19928 11.1656 4.28679 11.005 4.3115C10.8444 4.33621 10.6805 4.2961 10.5495 4.2C10.4184 4.1039 10.3309 3.95967 10.3062 3.79905C10.2815 3.63843 10.3216 3.47458 10.4177 3.34353L11.9412 1.23529H7.41184C7.24803 1.23529 7.09093 1.17022 6.97509 1.05439C6.85926 0.938558 6.79419 0.781457 6.79419 0.617647C6.79419 0.453837 6.85926 0.296736 6.97509 0.180905C7.09093 0.0650733 7.24803 0 7.41184 0H13.1765C13.2905 0.000692754 13.4022 0.0325088 13.4994 0.0920138ZM4.20008 0.181168H4.24126L13.2013 9.03411C13.3169 9.14992 13.3819 9.3069 13.3819 9.47058C13.3819 9.63426 13.3169 9.79124 13.2013 9.90705C13.1445 9.96517 13.0766 10.0112 13.0016 10.0423C12.9266 10.0735 12.846 10.0891 12.7648 10.0882C12.6836 10.0886 12.6032 10.0728 12.5283 10.0417C12.4533 10.0106 12.3853 9.96479 12.3283 9.90705L9.3142 6.92587L9.26479 6.99999V13.3823C9.26265 13.5455 9.19689 13.7014 9.08152 13.8167C8.96615 13.9321 8.81029 13.9979 8.64714 14H5.35302C5.18987 13.9979 5.03401 13.9321 4.91864 13.8167C4.80327 13.7014 4.73751 13.5455 4.73537 13.3823V6.99999L0.329492 1.02117C0.259855 0.930634 0.21745 0.822137 0.207241 0.708376C0.197031 0.594616 0.21944 0.480301 0.271844 0.378815C0.324343 0.277621 0.403484 0.192687 0.500724 0.133182C0.597964 0.073677 0.709609 0.041861 0.823609 0.0411682H3.86243C3.92448 0.0461551 3.9855 0.060022 4.04361 0.0823446C4.10037 0.10735 4.15311 0.140655 4.20008 0.181168ZM8.02949 6.79411C8.02884 6.66289 8.07235 6.53526 8.15302 6.43176L8.42478 6.05293L3.55773 1.23529H2.0589L5.84714 6.43176C5.92781 6.53526 5.97132 6.66289 5.97067 6.79411V12.7647H8.02949V6.79411Z",fill:"currentColor"},null,-1)]),16)}jB.render=pse;var UB={name:"PlusIcon",extends:qo};function mse(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{d:"M7.67742 6.32258V0.677419C7.67742 0.497757 7.60605 0.325452 7.47901 0.198411C7.35197 0.0713707 7.17966 0 7 0C6.82034 0 6.64803 0.0713707 6.52099 0.198411C6.39395 0.325452 6.32258 0.497757 6.32258 0.677419V6.32258H0.677419C0.497757 6.32258 0.325452 6.39395 0.198411 6.52099C0.0713707 6.64803 0 6.82034 0 7C0 7.17966 0.0713707 7.35197 0.198411 7.47901C0.325452 7.60605 0.497757 7.67742 0.677419 7.67742H6.32258V13.3226C6.32492 13.5015 6.39704 13.6725 6.52358 13.799C6.65012 13.9255 6.82106 13.9977 7 14C7.17966 14 7.35197 13.9286 7.47901 13.8016C7.60605 13.6745 7.67742 13.5022 7.67742 13.3226V7.67742H13.3226C13.5022 7.67742 13.6745 7.60605 13.8016 7.47901C13.9286 7.35197 14 7.17966 14 7C13.9977 6.82106 13.9255 6.65012 13.799 6.52358C13.6725 6.39704 13.5015 6.32492 13.3226 6.32258H7.67742Z",fill:"currentColor"},null,-1)]),16)}UB.render=mse;var HB={name:"TrashIcon",extends:qo};function gse(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.44802 13.9955H10.552C10.8056 14.0129 11.06 13.9797 11.3006 13.898C11.5412 13.8163 11.7632 13.6877 11.9537 13.5196C12.1442 13.3515 12.2995 13.1473 12.4104 12.9188C12.5213 12.6903 12.5858 12.442 12.6 12.1884V4.36041H13.4C13.5591 4.36041 13.7117 4.29722 13.8243 4.18476C13.9368 4.07229 14 3.91976 14 3.76071C14 3.60166 13.9368 3.44912 13.8243 3.33666C13.7117 3.22419 13.5591 3.16101 13.4 3.16101H12.0537C12.0203 3.1557 11.9863 3.15299 11.952 3.15299C11.9178 3.15299 11.8838 3.1557 11.8503 3.16101H11.2285C11.2421 3.10893 11.2487 3.05513 11.248 3.00106V1.80966C11.2171 1.30262 10.9871 0.828306 10.608 0.48989C10.229 0.151475 9.73159 -0.0236625 9.22402 0.00257442H4.77602C4.27251 -0.0171866 3.78126 0.160868 3.40746 0.498617C3.03365 0.836366 2.807 1.30697 2.77602 1.80966V3.00106C2.77602 3.0556 2.78346 3.10936 2.79776 3.16101H0.6C0.521207 3.16101 0.443185 3.17652 0.37039 3.20666C0.297595 3.2368 0.231451 3.28097 0.175736 3.33666C0.120021 3.39235 0.0758251 3.45846 0.0456722 3.53121C0.0155194 3.60397 0 3.68196 0 3.76071C0 3.83946 0.0155194 3.91744 0.0456722 3.9902C0.0758251 4.06296 0.120021 4.12907 0.175736 4.18476C0.231451 4.24045 0.297595 4.28462 0.37039 4.31476C0.443185 4.3449 0.521207 4.36041 0.6 4.36041H1.40002V12.1884C1.41426 12.442 1.47871 12.6903 1.58965 12.9188C1.7006 13.1473 1.85582 13.3515 2.04633 13.5196C2.23683 13.6877 2.45882 13.8163 2.69944 13.898C2.94005 13.9797 3.1945 14.0129 3.44802 13.9955ZM2.60002 4.36041H11.304V12.1884C11.304 12.5163 10.952 12.7961 10.504 12.7961H3.40002C2.97602 12.7961 2.60002 12.5163 2.60002 12.1884V4.36041ZM3.95429 3.16101C3.96859 3.10936 3.97602 3.0556 3.97602 3.00106V1.80966C3.97602 1.48183 4.33602 1.20197 4.77602 1.20197H9.24802C9.66403 1.20197 10.048 1.48183 10.048 1.80966V3.00106C10.0473 3.05515 10.054 3.10896 10.0678 3.16101H3.95429ZM5.57571 10.997C5.41731 10.995 5.26597 10.9311 5.15395 10.8191C5.04193 10.7071 4.97808 10.5558 4.97601 10.3973V6.77517C4.97601 6.61612 5.0392 6.46359 5.15166 6.35112C5.26413 6.23866 5.41666 6.17548 5.57571 6.17548C5.73476 6.17548 5.8873 6.23866 5.99976 6.35112C6.11223 6.46359 6.17541 6.61612 6.17541 6.77517V10.3894C6.17647 10.4688 6.16174 10.5476 6.13208 10.6213C6.10241 10.695 6.05841 10.762 6.00261 10.8186C5.94682 10.8751 5.88035 10.92 5.80707 10.9506C5.73378 10.9813 5.65514 10.9971 5.57571 10.997ZM7.99968 10.8214C8.11215 10.9339 8.26468 10.997 8.42373 10.997C8.58351 10.9949 8.73604 10.93 8.84828 10.8163C8.96052 10.7025 9.02345 10.5491 9.02343 10.3894V6.77517C9.02343 6.61612 8.96025 6.46359 8.84778 6.35112C8.73532 6.23866 8.58278 6.17548 8.42373 6.17548C8.26468 6.17548 8.11215 6.23866 7.99968 6.35112C7.88722 6.46359 7.82404 6.61612 7.82404 6.77517V10.3973C7.82404 10.5564 7.88722 10.7089 7.99968 10.8214Z",fill:"currentColor"},null,-1)]),16)}HB.render=gse;var _se=Kr.extend({name:"focustrap-directive"}),yse=Ir.extend({style:_se});function e0(t){"@babel/helpers - typeof";return e0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e0(t)}function P3(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function M3(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?P3(Object(n),!0).forEach(function(r){vse(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):P3(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function vse(t,e,n){return(e=bse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bse(t){var e=xse(t,"string");return e0(e)=="symbol"?e:e+""}function xse(t,e){if(e0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(e0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var wse=yse.extend("focustrap",{mounted:function(e,n){var r=n.value||{},c=r.disabled;c||(this.createHiddenFocusableElements(e,n),this.bind(e,n),this.autoElementFocus(e,n)),e.setAttribute("data-pd-focustrap",!0),this.$el=e},updated:function(e,n){var r=n.value||{},c=r.disabled;c&&this.unbind(e)},unmounted:function(e){this.unbind(e)},methods:{getComputedSelector:function(e){return':not(.p-hidden-focusable):not([data-p-hidden-focusable="true"])'.concat(e??"")},bind:function(e,n){var r=this,c=n.value||{},u=c.onFocusIn,p=c.onFocusOut;e.$_pfocustrap_mutationobserver=new MutationObserver(function(o){o.forEach(function(w){if(w.type==="childList"&&!e.contains(document.activeElement)){var T=function(D){var B=PD(D)?PD(D,r.getComputedSelector(e.$_pfocustrap_focusableselector))?D:gp(e,r.getComputedSelector(e.$_pfocustrap_focusableselector)):gp(D);return xr(B)?B:D.nextSibling&&T(D.nextSibling)};Nl(T(w.nextSibling))}})}),e.$_pfocustrap_mutationobserver.disconnect(),e.$_pfocustrap_mutationobserver.observe(e,{childList:!0}),e.$_pfocustrap_focusinlistener=function(o){return u&&u(o)},e.$_pfocustrap_focusoutlistener=function(o){return p&&p(o)},e.addEventListener("focusin",e.$_pfocustrap_focusinlistener),e.addEventListener("focusout",e.$_pfocustrap_focusoutlistener)},unbind:function(e){e.$_pfocustrap_mutationobserver&&e.$_pfocustrap_mutationobserver.disconnect(),e.$_pfocustrap_focusinlistener&&e.removeEventListener("focusin",e.$_pfocustrap_focusinlistener)&&(e.$_pfocustrap_focusinlistener=null),e.$_pfocustrap_focusoutlistener&&e.removeEventListener("focusout",e.$_pfocustrap_focusoutlistener)&&(e.$_pfocustrap_focusoutlistener=null)},autoFocus:function(e){this.autoElementFocus(this.$el,{value:M3(M3({},e),{},{autoFocus:!0})})},autoElementFocus:function(e,n){var r=n.value||{},c=r.autoFocusSelector,u=c===void 0?"":c,p=r.firstFocusableSelector,o=p===void 0?"":p,w=r.autoFocus,T=w===void 0?!1:w,A=gp(e,"[autofocus]".concat(this.getComputedSelector(u)));T&&!A&&(A=gp(e,this.getComputedSelector(o))),Nl(A)},onFirstHiddenElementFocus:function(e){var n,r=e.currentTarget,c=e.relatedTarget,u=c===r.$_pfocustrap_lasthiddenfocusableelement||!((n=this.$el)!==null&&n!==void 0&&n.contains(c))?gp(r.parentElement,this.getComputedSelector(r.$_pfocustrap_focusableselector)):r.$_pfocustrap_lasthiddenfocusableelement;Nl(u)},onLastHiddenElementFocus:function(e){var n,r=e.currentTarget,c=e.relatedTarget,u=c===r.$_pfocustrap_firsthiddenfocusableelement||!((n=this.$el)!==null&&n!==void 0&&n.contains(c))?Bz(r.parentElement,this.getComputedSelector(r.$_pfocustrap_focusableselector)):r.$_pfocustrap_firsthiddenfocusableelement;Nl(u)},createHiddenFocusableElements:function(e,n){var r=this,c=n.value||{},u=c.tabIndex,p=u===void 0?0:u,o=c.firstFocusableSelector,w=o===void 0?"":o,T=c.lastFocusableSelector,A=T===void 0?"":T,D=function(Q){return zz("span",{class:"p-hidden-accessible p-hidden-focusable",tabIndex:p,role:"presentation","aria-hidden":!0,"data-p-hidden-accessible":!0,"data-p-hidden-focusable":!0,onFocus:Q==null?void 0:Q.bind(r)})},B=D(this.onFirstHiddenElementFocus),N=D(this.onLastHiddenElementFocus);B.$_pfocustrap_lasthiddenfocusableelement=N,B.$_pfocustrap_focusableselector=w,B.setAttribute("data-pc-section","firstfocusableelement"),N.$_pfocustrap_firsthiddenfocusableelement=B,N.$_pfocustrap_focusableselector=A,N.setAttribute("data-pc-section","lastfocusableelement"),e.prepend(B),e.append(N)}}}),iE={name:"SortAltIcon",extends:qo};function Sse(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{d:"M5.64515 3.61291C5.47353 3.61291 5.30192 3.54968 5.16644 3.4142L3.38708 1.63484L1.60773 3.4142C1.34579 3.67613 0.912244 3.67613 0.650309 3.4142C0.388374 3.15226 0.388374 2.71871 0.650309 2.45678L2.90837 0.198712C3.17031 -0.0632236 3.60386 -0.0632236 3.86579 0.198712L6.12386 2.45678C6.38579 2.71871 6.38579 3.15226 6.12386 3.4142C5.98837 3.54968 5.81676 3.61291 5.64515 3.61291Z",fill:"currentColor"},null,-1),Pe("path",{d:"M3.38714 14C3.01681 14 2.70972 13.6929 2.70972 13.3226V0.677419C2.70972 0.307097 3.01681 0 3.38714 0C3.75746 0 4.06456 0.307097 4.06456 0.677419V13.3226C4.06456 13.6929 3.75746 14 3.38714 14Z",fill:"currentColor"},null,-1),Pe("path",{d:"M10.6129 14C10.4413 14 10.2697 13.9368 10.1342 13.8013L7.87611 11.5432C7.61418 11.2813 7.61418 10.8477 7.87611 10.5858C8.13805 10.3239 8.5716 10.3239 8.83353 10.5858L10.6129 12.3652L12.3922 10.5858C12.6542 10.3239 13.0877 10.3239 13.3497 10.5858C13.6116 10.8477 13.6116 11.2813 13.3497 11.5432L11.0916 13.8013C10.9561 13.9368 10.7845 14 10.6129 14Z",fill:"currentColor"},null,-1),Pe("path",{d:"M10.6129 14C10.2426 14 9.93552 13.6929 9.93552 13.3226V0.677419C9.93552 0.307097 10.2426 0 10.6129 0C10.9833 0 11.2904 0.307097 11.2904 0.677419V13.3226C11.2904 13.6929 10.9832 14 10.6129 14Z",fill:"currentColor"},null,-1)]),16)}iE.render=Sse;var rE={name:"SortAmountDownIcon",extends:qo};function Cse(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{d:"M4.93953 10.5858L3.83759 11.6877V0.677419C3.83759 0.307097 3.53049 0 3.16017 0C2.78985 0 2.48275 0.307097 2.48275 0.677419V11.6877L1.38082 10.5858C1.11888 10.3239 0.685331 10.3239 0.423396 10.5858C0.16146 10.8477 0.16146 11.2813 0.423396 11.5432L2.68146 13.8013C2.74469 13.8645 2.81694 13.9097 2.89823 13.9458C2.97952 13.9819 3.06985 14 3.16017 14C3.25049 14 3.33178 13.9819 3.42211 13.9458C3.5034 13.9097 3.57565 13.8645 3.63888 13.8013L5.89694 11.5432C6.15888 11.2813 6.15888 10.8477 5.89694 10.5858C5.63501 10.3239 5.20146 10.3239 4.93953 10.5858ZM13.0957 0H7.22468C6.85436 0 6.54726 0.307097 6.54726 0.677419C6.54726 1.04774 6.85436 1.35484 7.22468 1.35484H13.0957C13.466 1.35484 13.7731 1.04774 13.7731 0.677419C13.7731 0.307097 13.466 0 13.0957 0ZM7.22468 5.41935H9.48275C9.85307 5.41935 10.1602 5.72645 10.1602 6.09677C10.1602 6.4671 9.85307 6.77419 9.48275 6.77419H7.22468C6.85436 6.77419 6.54726 6.4671 6.54726 6.09677C6.54726 5.72645 6.85436 5.41935 7.22468 5.41935ZM7.6763 8.12903H7.22468C6.85436 8.12903 6.54726 8.43613 6.54726 8.80645C6.54726 9.17677 6.85436 9.48387 7.22468 9.48387H7.6763C8.04662 9.48387 8.35372 9.17677 8.35372 8.80645C8.35372 8.43613 8.04662 8.12903 7.6763 8.12903ZM7.22468 2.70968H11.2892C11.6595 2.70968 11.9666 3.01677 11.9666 3.3871C11.9666 3.75742 11.6595 4.06452 11.2892 4.06452H7.22468C6.85436 4.06452 6.54726 3.75742 6.54726 3.3871C6.54726 3.01677 6.85436 2.70968 7.22468 2.70968Z",fill:"currentColor"},null,-1)]),16)}rE.render=Cse;var oE={name:"SortAmountUpAltIcon",extends:qo};function Tse(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{d:"M3.63435 0.19871C3.57113 0.135484 3.49887 0.0903226 3.41758 0.0541935C3.255 -0.0180645 3.06532 -0.0180645 2.90274 0.0541935C2.82145 0.0903226 2.74919 0.135484 2.68597 0.19871L0.427901 2.45677C0.165965 2.71871 0.165965 3.15226 0.427901 3.41419C0.689836 3.67613 1.12338 3.67613 1.38532 3.41419L2.48726 2.31226V13.3226C2.48726 13.6929 2.79435 14 3.16467 14C3.535 14 3.84209 13.6929 3.84209 13.3226V2.31226L4.94403 3.41419C5.07951 3.54968 5.25113 3.6129 5.42274 3.6129C5.59435 3.6129 5.76597 3.54968 5.90145 3.41419C6.16338 3.15226 6.16338 2.71871 5.90145 2.45677L3.64338 0.19871H3.63435ZM13.7685 13.3226C13.7685 12.9523 13.4615 12.6452 13.0911 12.6452H7.22016C6.84984 12.6452 6.54274 12.9523 6.54274 13.3226C6.54274 13.6929 6.84984 14 7.22016 14H13.0911C13.4615 14 13.7685 13.6929 13.7685 13.3226ZM7.22016 8.58064C6.84984 8.58064 6.54274 8.27355 6.54274 7.90323C6.54274 7.5329 6.84984 7.22581 7.22016 7.22581H9.47823C9.84855 7.22581 10.1556 7.5329 10.1556 7.90323C10.1556 8.27355 9.84855 8.58064 9.47823 8.58064H7.22016ZM7.22016 5.87097H7.67177C8.0421 5.87097 8.34919 5.56387 8.34919 5.19355C8.34919 4.82323 8.0421 4.51613 7.67177 4.51613H7.22016C6.84984 4.51613 6.54274 4.82323 6.54274 5.19355C6.54274 5.56387 6.84984 5.87097 7.22016 5.87097ZM11.2847 11.2903H7.22016C6.84984 11.2903 6.54274 10.9832 6.54274 10.6129C6.54274 10.2426 6.84984 9.93548 7.22016 9.93548H11.2847C11.655 9.93548 11.9621 10.2426 11.9621 10.6129C11.9621 10.9832 11.655 11.2903 11.2847 11.2903Z",fill:"currentColor"},null,-1)]),16)}oE.render=Tse;var Ese={name:"BaseDataTable",extends:Lo,props:{value:{type:Array,default:null},dataKey:{type:[String,Function],default:null},rows:{type:Number,default:0},first:{type:Number,default:0},totalRecords:{type:Number,default:0},paginator:{type:Boolean,default:!1},paginatorPosition:{type:String,default:"bottom"},alwaysShowPaginator:{type:Boolean,default:!0},paginatorTemplate:{type:[Object,String],default:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown"},pageLinkSize:{type:Number,default:5},rowsPerPageOptions:{type:Array,default:null},currentPageReportTemplate:{type:String,default:"({currentPage} of {totalPages})"},lazy:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},loadingIcon:{type:String,default:void 0},sortField:{type:[String,Function],default:null},sortOrder:{type:Number,default:null},defaultSortOrder:{type:Number,default:1},nullSortOrder:{type:Number,default:1},multiSortMeta:{type:Array,default:null},sortMode:{type:String,default:"single"},removableSort:{type:Boolean,default:!1},filters:{type:Object,default:null},filterDisplay:{type:String,default:null},globalFilterFields:{type:Array,default:null},filterLocale:{type:String,default:void 0},selection:{type:[Array,Object],default:null},selectionMode:{type:String,default:null},compareSelectionBy:{type:String,default:"deepEquals"},metaKeySelection:{type:Boolean,default:!1},contextMenu:{type:Boolean,default:!1},contextMenuSelection:{type:Object,default:null},selectAll:{type:Boolean,default:null},rowHover:{type:Boolean,default:!1},csvSeparator:{type:String,default:","},exportFilename:{type:String,default:"download"},exportFunction:{type:Function,default:null},resizableColumns:{type:Boolean,default:!1},columnResizeMode:{type:String,default:"fit"},reorderableColumns:{type:Boolean,default:!1},expandedRows:{type:[Array,Object],default:null},expandedRowIcon:{type:String,default:void 0},collapsedRowIcon:{type:String,default:void 0},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String,Function],default:null},expandableRowGroups:{type:Boolean,default:!1},expandedRowGroups:{type:Array,default:null},stateStorage:{type:String,default:"session"},stateKey:{type:String,default:null},editMode:{type:String,default:null},editingRows:{type:Array,default:null},rowClass:{type:Function,default:null},rowStyle:{type:Function,default:null},scrollable:{type:Boolean,default:!1},virtualScrollerOptions:{type:Object,default:null},scrollHeight:{type:String,default:null},frozenValue:{type:Array,default:null},breakpoint:{type:String,default:"960px"},showHeaders:{type:Boolean,default:!0},showGridlines:{type:Boolean,default:!1},stripedRows:{type:Boolean,default:!1},highlightOnSelect:{type:Boolean,default:!1},size:{type:String,default:null},tableStyle:{type:null,default:null},tableClass:{type:[String,Object],default:null},tableProps:{type:Object,default:null},filterInputProps:{type:null,default:null},filterButtonProps:{type:Object,default:function(){return{filter:{severity:"secondary",text:!0,rounded:!0},inline:{clear:{severity:"secondary",text:!0,rounded:!0}},popover:{addRule:{severity:"info",text:!0,size:"small"},removeRule:{severity:"danger",text:!0,size:"small"},apply:{size:"small"},clear:{outlined:!0,size:"small"}}}}},editButtonProps:{type:Object,default:function(){return{init:{severity:"secondary",text:!0,rounded:!0},save:{severity:"secondary",text:!0,rounded:!0},cancel:{severity:"secondary",text:!0,rounded:!0}}}}},style:poe,provide:function(){return{$pcDataTable:this,$parentInstance:this}}},GB={name:"RowCheckbox",hostName:"DataTable",extends:Lo,emits:["change"],props:{value:null,checked:null,column:null,rowCheckboxIconTemplate:{type:Function,default:null},index:{type:Number,default:null}},methods:{getColumnPT:function(e){var n={props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:this.index,checked:this.checked,disabled:this.$attrs.disabled}};return ft(this.ptm("column.".concat(e),{column:n}),this.ptm("column.".concat(e),n),this.ptmo(this.getColumnProp(),e,n))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},onChange:function(e){this.$attrs.disabled||this.$emit("change",{originalEvent:e,data:this.value})}},computed:{checkboxAriaLabel:function(){return this.$primevue.config.locale.aria?this.checked?this.$primevue.config.locale.aria.selectRow:this.$primevue.config.locale.aria.unselectRow:void 0}},components:{CheckIcon:fy,Checkbox:wI}};function Ise(t,e,n,r,c,u){var p=Ai("CheckIcon"),o=Ai("Checkbox");return We(),Sn(o,{modelValue:n.checked,binary:!0,disabled:t.$attrs.disabled,"aria-label":u.checkboxAriaLabel,onChange:u.onChange,unstyled:t.unstyled,pt:u.getColumnPT("pcRowCheckbox")},{icon:si(function(w){return[n.rowCheckboxIconTemplate?(We(),Sn(lr(n.rowCheckboxIconTemplate),{key:0,checked:w.checked,class:pr(w.class)},null,8,["checked","class"])):!n.rowCheckboxIconTemplate&&w.checked?(We(),Sn(p,ft({key:1,class:w.class},u.getColumnPT("pcRowCheckbox.icon")),null,16,["class"])):Zn("",!0)]}),_:1},8,["modelValue","disabled","aria-label","onChange","unstyled","pt"])}GB.render=Ise;var WB={name:"RowRadioButton",hostName:"DataTable",extends:Lo,emits:["change"],props:{value:null,checked:null,name:null,column:null,index:{type:Number,default:null}},methods:{getColumnPT:function(e){var n={props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:this.index,checked:this.checked,disabled:this.$attrs.disabled}};return ft(this.ptm("column.".concat(e),{column:n}),this.ptm("column.".concat(e),n),this.ptmo(this.getColumnProp(),e,n))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},onChange:function(e){this.$attrs.disabled||this.$emit("change",{originalEvent:e,data:this.value})}},components:{RadioButton:NB}};function Ase(t,e,n,r,c,u){var p=Ai("RadioButton");return We(),Sn(p,{modelValue:n.checked,binary:!0,disabled:t.$attrs.disabled,name:n.name,onChange:u.onChange,unstyled:t.unstyled,pt:u.getColumnPT("pcRowRadiobutton")},null,8,["modelValue","disabled","name","onChange","unstyled","pt"])}WB.render=Ase;function Zv(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,n=typeof Symbol=="function"?Symbol:{},r=n.iterator||"@@iterator",c=n.toStringTag||"@@toStringTag";function u(N,ee,Q,se){var ce=ee&&ee.prototype instanceof o?ee:o,be=Object.create(ce.prototype);return Mc(be,"_invoke",function(ze,xe,je){var qe,oe,de,Ee=0,$e=je||[],me=!1,Te={p:0,n:0,v:t,a:Re,f:Re.bind(t,4),d:function(Zt,on){return qe=Zt,oe=0,de=t,Te.n=on,p}};function Re(tn,Zt){for(oe=tn,de=Zt,e=0;!me&&Ee&&!on&&e<$e.length;e++){var on,hn=$e[e],Hn=Te.p,Ri=hn[2];tn>3?(on=Ri===Zt)&&(de=hn[(oe=hn[4])?5:(oe=3,3)],hn[4]=hn[5]=t):hn[0]<=Hn&&((on=tn<2&&Hn<hn[1])?(oe=0,Te.v=Zt,Te.n=hn[1]):Hn<Ri&&(on=tn<3||hn[0]>Zt||Zt>Ri)&&(hn[4]=tn,hn[5]=Zt,Te.n=Ri,oe=0))}if(on||tn>1)return p;throw me=!0,Zt}return function(tn,Zt,on){if(Ee>1)throw TypeError("Generator is already running");for(me&&Zt===1&&Re(Zt,on),oe=Zt,de=on;(e=oe<2?t:de)||!me;){qe||(oe?oe<3?(oe>1&&(Te.n=-1),Re(oe,de)):Te.n=de:Te.v=de);try{if(Ee=2,qe){if(oe||(tn="next"),e=qe[tn]){if(!(e=e.call(qe,de)))throw TypeError("iterator result is not an object");if(!e.done)return e;de=e.value,oe<2&&(oe=0)}else oe===1&&(e=qe.return)&&e.call(qe),oe<2&&(de=TypeError("The iterator does not provide a '"+tn+"' method"),oe=1);qe=t}else if((e=(me=Te.n<0)?de:ze.call(xe,Te))!==p)break}catch(hn){qe=t,oe=1,de=hn}finally{Ee=1}}return{value:e,done:me}}}(N,Q,se),!0),be}var p={};function o(){}function w(){}function T(){}e=Object.getPrototypeOf;var A=[][r]?e(e([][r]())):(Mc(e={},r,function(){return this}),e),D=T.prototype=o.prototype=Object.create(A);function B(N){return Object.setPrototypeOf?Object.setPrototypeOf(N,T):(N.__proto__=T,Mc(N,c,"GeneratorFunction")),N.prototype=Object.create(D),N}return w.prototype=T,Mc(D,"constructor",T),Mc(T,"constructor",w),w.displayName="GeneratorFunction",Mc(T,c,"GeneratorFunction"),Mc(D),Mc(D,c,"Generator"),Mc(D,r,function(){return this}),Mc(D,"toString",function(){return"[object Generator]"}),(Zv=function(){return{w:u,m:B}})()}function Mc(t,e,n,r){var c=Object.defineProperty;try{c({},"",{})}catch{c=0}Mc=function(p,o,w,T){function A(D,B){Mc(p,D,function(N){return this._invoke(D,B,N)})}o?c?c(p,o,{value:w,enumerable:!T,configurable:!T,writable:!T}):p[o]=w:(A("next",0),A("throw",1),A("return",2))},Mc(t,e,n,r)}function D3(t,e,n,r,c,u,p){try{var o=t[u](p),w=o.value}catch(T){return void n(T)}o.done?e(w):Promise.resolve(w).then(r,c)}function O3(t){return function(){var e=this,n=arguments;return new Promise(function(r,c){var u=t.apply(e,n);function p(w){D3(u,r,c,p,o,"next",w)}function o(w){D3(u,r,c,p,o,"throw",w)}p(void 0)})}}var qB={name:"BodyCell",hostName:"DataTable",extends:Lo,emits:["cell-edit-init","cell-edit-complete","cell-edit-cancel","row-edit-init","row-edit-save","row-edit-cancel","row-toggle","radio-change","checkbox-change","editing-meta-change"],props:{rowData:{type:Object,default:null},column:{type:Object,default:null},frozenRow:{type:Boolean,default:!1},rowIndex:{type:Number,default:null},index:{type:Number,default:null},isRowExpanded:{type:Boolean,default:!1},selected:{type:Boolean,default:!1},editing:{type:Boolean,default:!1},editingMeta:{type:Object,default:null},editMode:{type:String,default:null},virtualScrollerContentProps:{type:Object,default:null},ariaControls:{type:String,default:null},name:{type:String,default:null},expandedRowIcon:{type:String,default:null},collapsedRowIcon:{type:String,default:null},editButtonProps:{type:Object,default:null}},documentEditListener:null,selfClick:!1,overlayEventListener:null,editCompleteTimeout:null,data:function(){return{d_editing:this.editing,styleObject:{}}},watch:{editing:function(e){this.d_editing=e},"$data.d_editing":function(e){this.$emit("editing-meta-change",{data:this.rowData,field:this.field||"field_".concat(this.index),index:this.rowIndex,editing:e})}},mounted:function(){this.columnProp("frozen")&&this.updateStickyPosition()},updated:function(){var e=this;this.columnProp("frozen")&&this.updateStickyPosition(),this.d_editing&&(this.editMode==="cell"||this.editMode==="row"&&this.columnProp("rowEditor"))&&setTimeout(function(){var n=gp(e.$el);n&&n.focus()},1)},beforeUnmount:function(){this.overlayEventListener&&(Sp.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null)},methods:{columnProp:function(e){return Gp(this.column,e)},getColumnPT:function(e){var n,r,c={props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:this.index,size:(n=this.$parentInstance)===null||n===void 0||(n=n.$parentInstance)===null||n===void 0?void 0:n.size,showGridlines:(r=this.$parentInstance)===null||r===void 0||(r=r.$parentInstance)===null||r===void 0?void 0:r.showGridlines}};return ft(this.ptm("column.".concat(e),{column:c}),this.ptm("column.".concat(e),c),this.ptmo(this.getColumnProp(),e,c))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},resolveFieldData:function(){return eo(this.rowData,this.field)},toggleRow:function(e){this.$emit("row-toggle",{originalEvent:e,data:this.rowData})},toggleRowWithRadio:function(e,n){this.$emit("radio-change",{originalEvent:e.originalEvent,index:n,data:e.data})},toggleRowWithCheckbox:function(e,n){this.$emit("checkbox-change",{originalEvent:e.originalEvent,index:n,data:e.data})},isEditable:function(){return this.column.children&&this.column.children.editor!=null},bindDocumentEditListener:function(){var e=this;this.documentEditListener||(this.documentEditListener=function(n){e.selfClick=e.$el&&e.$el.contains(n.target),e.editCompleteTimeout&&clearTimeout(e.editCompleteTimeout),e.selfClick||(e.editCompleteTimeout=setTimeout(function(){e.completeEdit(n,"outside")},1))},document.addEventListener("mousedown",this.documentEditListener))},unbindDocumentEditListener:function(){this.documentEditListener&&(document.removeEventListener("mousedown",this.documentEditListener),this.documentEditListener=null,this.selfClick=!1,this.editCompleteTimeout&&(clearTimeout(this.editCompleteTimeout),this.editCompleteTimeout=null))},switchCellToViewMode:function(){this.d_editing=!1,this.unbindDocumentEditListener(),Sp.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null},onClick:function(e){var n=this;this.editMode==="cell"&&this.isEditable()&&(this.d_editing||(this.d_editing=!0,this.bindDocumentEditListener(),this.$emit("cell-edit-init",{originalEvent:e,data:this.rowData,field:this.field,index:this.rowIndex}),this.overlayEventListener=function(r){n.selfClick=n.$el&&n.$el.contains(r.target)},Sp.on("overlay-click",this.overlayEventListener)))},completeEdit:function(e,n){var r={originalEvent:e,data:this.rowData,newData:this.editingRowData,value:this.rowData[this.field],newValue:this.editingRowData[this.field],field:this.field,index:this.rowIndex,type:n,defaultPrevented:!1,preventDefault:function(){this.defaultPrevented=!0}};this.$emit("cell-edit-complete",r),r.defaultPrevented||this.switchCellToViewMode()},onKeyDown:function(e){if(this.editMode==="cell")switch(e.code){case"Enter":case"NumpadEnter":this.completeEdit(e,"enter");break;case"Escape":this.switchCellToViewMode(),this.$emit("cell-edit-cancel",{originalEvent:e,data:this.rowData,field:this.field,index:this.rowIndex});break;case"Tab":this.completeEdit(e,"tab"),e.shiftKey?this.moveToPreviousCell(e):this.moveToNextCell(e);break}},moveToPreviousCell:function(e){var n=this;return O3(Zv().m(function r(){var c,u;return Zv().w(function(p){for(;;)switch(p.n){case 0:if(c=n.findCell(e.target),u=n.findPreviousEditableColumn(c),!u){p.n=2;break}return p.n=1,n.$nextTick();case 1:RD(u,"click"),e.preventDefault();case 2:return p.a(2)}},r)}))()},moveToNextCell:function(e){var n=this;return O3(Zv().m(function r(){var c,u;return Zv().w(function(p){for(;;)switch(p.n){case 0:if(c=n.findCell(e.target),u=n.findNextEditableColumn(c),!u){p.n=2;break}return p.n=1,n.$nextTick();case 1:RD(u,"click"),e.preventDefault();case 2:return p.a(2)}},r)}))()},findCell:function(e){if(e){for(var n=e;n&&!La(n,"data-p-cell-editing");)n=n.parentElement;return n}else return null},findPreviousEditableColumn:function(e){var n=e.previousElementSibling;if(!n){var r=e.parentElement.previousElementSibling;r&&(n=r.lastElementChild)}return n?La(n,"data-p-editable-column")?n:this.findPreviousEditableColumn(n):null},findNextEditableColumn:function(e){var n=e.nextElementSibling;if(!n){var r=e.parentElement.nextElementSibling;r&&(n=r.firstElementChild)}return n?La(n,"data-p-editable-column")?n:this.findNextEditableColumn(n):null},onRowEditInit:function(e){this.$emit("row-edit-init",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},onRowEditSave:function(e){this.$emit("row-edit-save",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},onRowEditCancel:function(e){this.$emit("row-edit-cancel",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},editorInitCallback:function(e){this.$emit("row-edit-init",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},editorSaveCallback:function(e){this.editMode==="row"?this.$emit("row-edit-save",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex}):this.completeEdit(e,"enter")},editorCancelCallback:function(e){this.editMode==="row"?this.$emit("row-edit-cancel",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex}):(this.switchCellToViewMode(),this.$emit("cell-edit-cancel",{originalEvent:e,data:this.rowData,field:this.field,index:this.rowIndex}))},updateStickyPosition:function(){if(this.columnProp("frozen")){var e=this.columnProp("alignFrozen");if(e==="right"){var n=0,r=CS(this.$el,'[data-p-frozen-column="true"]');r&&(n=dc(r)+parseFloat(r.style["inset-inline-end"]||0)),this.styleObject.insetInlineEnd=n+"px"}else{var c=0,u=TS(this.$el,'[data-p-frozen-column="true"]');u&&(c=dc(u)+parseFloat(u.style["inset-inline-start"]||0)),this.styleObject.insetInlineStart=c+"px"}}},getVirtualScrollerProp:function(e){return this.virtualScrollerContentProps?this.virtualScrollerContentProps[e]:null}},computed:{editingRowData:function(){return this.editingMeta[this.rowIndex]?this.editingMeta[this.rowIndex].data:this.rowData},field:function(){return this.columnProp("field")},containerClass:function(){return[this.columnProp("bodyClass"),this.columnProp("class"),this.cx("bodyCell")]},containerStyle:function(){var e=this.columnProp("bodyStyle"),n=this.columnProp("style");return this.columnProp("frozen")?[n,e,this.styleObject]:[n,e]},loading:function(){return this.getVirtualScrollerProp("loading")},loadingOptions:function(){var e=this.getVirtualScrollerProp("getLoaderOptions");return e&&e(this.rowIndex,{cellIndex:this.index,cellFirst:this.index===0,cellLast:this.index===this.getVirtualScrollerProp("columns").length-1,cellEven:this.index%2===0,cellOdd:this.index%2!==0,column:this.column,field:this.field})},expandButtonAriaLabel:function(){return this.$primevue.config.locale.aria?this.isRowExpanded?this.$primevue.config.locale.aria.collapseRow:this.$primevue.config.locale.aria.expandRow:void 0},initButtonAriaLabel:function(){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.editRow:void 0},saveButtonAriaLabel:function(){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.saveEdit:void 0},cancelButtonAriaLabel:function(){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.cancelEdit:void 0}},components:{DTRadioButton:WB,DTCheckbox:GB,Button:xI,ChevronDownIcon:AS,ChevronRightIcon:vI,BarsIcon:zB,PencilIcon:BB,CheckIcon:fy,TimesIcon:mI},directives:{ripple:Wp}};function t0(t){"@babel/helpers - typeof";return t0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t0(t)}function L3(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function fx(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?L3(Object(n),!0).forEach(function(r){kse(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L3(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function kse(t,e,n){return(e=Rse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rse(t){var e=Pse(t,"string");return t0(e)=="symbol"?e:e+""}function Pse(t,e){if(t0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(t0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Mse=["colspan","rowspan","data-p-selection-column","data-p-editable-column","data-p-cell-editing","data-p-frozen-column"],Dse=["aria-expanded","aria-controls","aria-label"];function Ose(t,e,n,r,c,u){var p=Ai("DTRadioButton"),o=Ai("DTCheckbox"),w=Ai("BarsIcon"),T=Ai("ChevronDownIcon"),A=Ai("ChevronRightIcon"),D=Ai("Button"),B=uf("ripple");return u.loading?(We(),wt("td",ft({key:0,style:u.containerStyle,class:u.containerClass,role:"cell"},fx(fx({},u.getColumnPT("root")),u.getColumnPT("bodyCell"))),[(We(),Sn(lr(n.column.children.loading),{data:n.rowData,column:n.column,field:u.field,index:n.rowIndex,frozenRow:n.frozenRow,loadingOptions:u.loadingOptions},null,8,["data","column","field","index","frozenRow","loadingOptions"]))],16)):(We(),wt("td",ft({key:1,style:u.containerStyle,class:u.containerClass,colspan:u.columnProp("colspan"),rowspan:u.columnProp("rowspan"),onClick:e[3]||(e[3]=function(){return u.onClick&&u.onClick.apply(u,arguments)}),onKeydown:e[4]||(e[4]=function(){return u.onKeyDown&&u.onKeyDown.apply(u,arguments)}),role:"cell"},fx(fx({},u.getColumnPT("root")),u.getColumnPT("bodyCell")),{"data-p-selection-column":u.columnProp("selectionMode")!=null,"data-p-editable-column":u.isEditable(),"data-p-cell-editing":c.d_editing,"data-p-frozen-column":u.columnProp("frozen")}),[n.column.children&&n.column.children.body&&!c.d_editing?(We(),Sn(lr(n.column.children.body),{key:0,data:n.rowData,column:n.column,field:u.field,index:n.rowIndex,frozenRow:n.frozenRow,editorInitCallback:u.editorInitCallback,rowTogglerCallback:u.toggleRow},null,8,["data","column","field","index","frozenRow","editorInitCallback","rowTogglerCallback"])):n.column.children&&n.column.children.editor&&c.d_editing?(We(),Sn(lr(n.column.children.editor),{key:1,data:u.editingRowData,column:n.column,field:u.field,index:n.rowIndex,frozenRow:n.frozenRow,editorSaveCallback:u.editorSaveCallback,editorCancelCallback:u.editorCancelCallback},null,8,["data","column","field","index","frozenRow","editorSaveCallback","editorCancelCallback"])):n.column.children&&n.column.children.body&&!n.column.children.editor&&c.d_editing?(We(),Sn(lr(n.column.children.body),{key:2,data:u.editingRowData,column:n.column,field:u.field,index:n.rowIndex,frozenRow:n.frozenRow},null,8,["data","column","field","index","frozenRow"])):u.columnProp("selectionMode")?(We(),wt(Mi,{key:3},[u.columnProp("selectionMode")==="single"?(We(),Sn(p,{key:0,value:n.rowData,name:n.name,checked:n.selected,onChange:e[0]||(e[0]=function(N){return u.toggleRowWithRadio(N,n.rowIndex)}),column:n.column,index:n.index,unstyled:t.unstyled,pt:t.pt},null,8,["value","name","checked","column","index","unstyled","pt"])):u.columnProp("selectionMode")==="multiple"?(We(),Sn(o,{key:1,value:n.rowData,checked:n.selected,rowCheckboxIconTemplate:n.column.children&&n.column.children.rowcheckboxicon,"aria-selected":n.selected?!0:void 0,onChange:e[1]||(e[1]=function(N){return u.toggleRowWithCheckbox(N,n.rowIndex)}),column:n.column,index:n.index,unstyled:t.unstyled,pt:t.pt},null,8,["value","checked","rowCheckboxIconTemplate","aria-selected","column","index","unstyled","pt"])):Zn("",!0)],64)):u.columnProp("rowReorder")?(We(),wt(Mi,{key:4},[n.column.children&&n.column.children.rowreordericon?(We(),Sn(lr(n.column.children.rowreordericon),{key:0,class:pr(t.cx("reorderableRowHandle"))},null,8,["class"])):u.columnProp("rowReorderIcon")?(We(),wt("i",ft({key:1,class:[t.cx("reorderableRowHandle"),u.columnProp("rowReorderIcon")]},u.getColumnPT("reorderableRowHandle")),null,16)):(We(),Sn(w,ft({key:2,class:t.cx("reorderableRowHandle")},u.getColumnPT("reorderableRowHandle")),null,16,["class"]))],64)):u.columnProp("expander")?Ki((We(),wt("button",ft({key:5,class:t.cx("rowToggleButton"),type:"button","aria-expanded":n.isRowExpanded,"aria-controls":n.ariaControls,"aria-label":u.expandButtonAriaLabel,onClick:e[2]||(e[2]=df(function(){return u.toggleRow&&u.toggleRow.apply(u,arguments)},["stop"])),"data-p-selected":"selected"},u.getColumnPT("rowToggleButton"),{"data-pc-group-section":"rowactionbutton"}),[n.column.children&&n.column.children.rowtoggleicon?(We(),Sn(lr(n.column.children.rowtoggleicon),{key:0,class:pr(t.cx("rowToggleIcon")),rowExpanded:n.isRowExpanded},null,8,["class","rowExpanded"])):n.column.children&&n.column.children.rowtogglericon?(We(),Sn(lr(n.column.children.rowtogglericon),{key:1,class:pr(t.cx("rowToggleIcon")),rowExpanded:n.isRowExpanded},null,8,["class","rowExpanded"])):(We(),wt(Mi,{key:2},[n.isRowExpanded&&n.expandedRowIcon?(We(),wt("span",{key:0,class:pr([t.cx("rowToggleIcon"),n.expandedRowIcon])},null,2)):n.isRowExpanded&&!n.expandedRowIcon?(We(),Sn(T,ft({key:1,class:t.cx("rowToggleIcon")},u.getColumnPT("rowToggleIcon")),null,16,["class"])):!n.isRowExpanded&&n.collapsedRowIcon?(We(),wt("span",{key:2,class:pr([t.cx("rowToggleIcon"),n.collapsedRowIcon])},null,2)):!n.isRowExpanded&&!n.collapsedRowIcon?(We(),Sn(A,ft({key:3,class:t.cx("rowToggleIcon")},u.getColumnPT("rowToggleIcon")),null,16,["class"])):Zn("",!0)],64))],16,Dse)),[[B]]):n.editMode==="row"&&u.columnProp("rowEditor")?(We(),wt(Mi,{key:6},[c.d_editing?Zn("",!0):(We(),Sn(D,ft({key:0,class:t.cx("pcRowEditorInit"),"aria-label":u.initButtonAriaLabel,unstyled:t.unstyled,onClick:u.onRowEditInit},n.editButtonProps.init,{pt:u.getColumnPT("pcRowEditorInit"),"data-pc-group-section":"rowactionbutton"}),{icon:si(function(N){return[(We(),Sn(lr(n.column.children&&n.column.children.roweditoriniticon||"PencilIcon"),ft({class:N.class},u.getColumnPT("pcRowEditorInit").icon),null,16,["class"]))]}),_:1},16,["class","aria-label","unstyled","onClick","pt"])),c.d_editing?(We(),Sn(D,ft({key:1,class:t.cx("pcRowEditorSave"),"aria-label":u.saveButtonAriaLabel,unstyled:t.unstyled,onClick:u.onRowEditSave},n.editButtonProps.save,{pt:u.getColumnPT("pcRowEditorSave"),"data-pc-group-section":"rowactionbutton"}),{icon:si(function(N){return[(We(),Sn(lr(n.column.children&&n.column.children.roweditorsaveicon||"CheckIcon"),ft({class:N.class},u.getColumnPT("pcRowEditorSave").icon),null,16,["class"]))]}),_:1},16,["class","aria-label","unstyled","onClick","pt"])):Zn("",!0),c.d_editing?(We(),Sn(D,ft({key:2,class:t.cx("pcRowEditorCancel"),"aria-label":u.cancelButtonAriaLabel,unstyled:t.unstyled,onClick:u.onRowEditCancel},n.editButtonProps.cancel,{pt:u.getColumnPT("pcRowEditorCancel"),"data-pc-group-section":"rowactionbutton"}),{icon:si(function(N){return[(We(),Sn(lr(n.column.children&&n.column.children.roweditorcancelicon||"TimesIcon"),ft({class:N.class},u.getColumnPT("pcRowEditorCancel").icon),null,16,["class"]))]}),_:1},16,["class","aria-label","unstyled","onClick","pt"])):Zn("",!0)],64)):(We(),wt(Mi,{key:7},[Ss(wr(u.resolveFieldData()),1)],64))],16,Mse))}qB.render=Ose;function n0(t){"@babel/helpers - typeof";return n0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n0(t)}function Lse(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=zse(t))||e){n&&(t=n);var r=0,c=function(){};return{s:c,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(T){throw T},f:c}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var u,p=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var T=n.next();return p=T.done,T},e:function(T){o=!0,u=T},f:function(){try{p||n.return==null||n.return()}finally{if(o)throw u}}}}function zse(t,e){if(t){if(typeof t=="string")return z3(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?z3(t,e):void 0}}function z3(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function B3(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function F3(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?B3(Object(n),!0).forEach(function(r){Bse(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):B3(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Bse(t,e,n){return(e=Fse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fse(t){var e=Nse(t,"string");return n0(e)=="symbol"?e:e+""}function Nse(t,e){if(n0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(n0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ZB={name:"BodyRow",hostName:"DataTable",extends:Lo,emits:["rowgroup-toggle","row-click","row-dblclick","row-rightclick","row-touchend","row-keydown","row-mousedown","row-dragstart","row-dragover","row-dragleave","row-dragend","row-drop","row-toggle","radio-change","checkbox-change","cell-edit-init","cell-edit-complete","cell-edit-cancel","row-edit-init","row-edit-save","row-edit-cancel","editing-meta-change"],props:{rowData:{type:Object,default:null},index:{type:Number,default:0},value:{type:Array,default:null},columns:{type:null,default:null},frozenRow:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String,Function],default:null},expandableRowGroups:{type:Boolean,default:!1},expandedRowGroups:{type:Array,default:null},first:{type:Number,default:0},dataKey:{type:[String,Function],default:null},expandedRowIcon:{type:String,default:null},collapsedRowIcon:{type:String,default:null},expandedRows:{type:[Array,Object],default:null},selection:{type:[Array,Object],default:null},selectionKeys:{type:null,default:null},selectionMode:{type:String,default:null},contextMenu:{type:Boolean,default:!1},contextMenuSelection:{type:Object,default:null},rowClass:{type:null,default:null},rowStyle:{type:null,default:null},rowGroupHeaderStyle:{type:null,default:null},editMode:{type:String,default:null},compareSelectionBy:{type:String,default:"deepEquals"},editingRows:{type:Array,default:null},editingRowKeys:{type:null,default:null},editingMeta:{type:Object,default:null},templates:{type:null,default:null},scrollable:{type:Boolean,default:!1},editButtonProps:{type:Object,default:null},virtualScrollerContentProps:{type:Object,default:null},isVirtualScrollerDisabled:{type:Boolean,default:!1},expandedRowId:{type:String,default:null},nameAttributeSelector:{type:String,default:null}},data:function(){return{d_rowExpanded:!1}},watch:{expandedRows:{deep:!0,immediate:!0,handler:function(e){var n=this;this.d_rowExpanded=this.dataKey?(e==null?void 0:e[eo(this.rowData,this.dataKey)])!==void 0:e==null?void 0:e.some(function(r){return n.equals(n.rowData,r)})}}},methods:{columnProp:function(e,n){return Gp(e,n)},getColumnPT:function(e){var n={parent:{instance:this,props:this.$props,state:this.$data}};return ft(this.ptm("column.".concat(e),{column:n}),this.ptm("column.".concat(e),n),this.ptmo(this.columnProp({},"pt"),e,n))},getBodyRowPTOptions:function(e){var n,r=(n=this.$parentInstance)===null||n===void 0?void 0:n.$parentInstance;return this.ptm(e,{context:{index:this.rowIndex,selectable:(r==null?void 0:r.rowHover)||(r==null?void 0:r.selectionMode),selected:this.isSelected,stripedRows:(r==null?void 0:r.stripedRows)||!1}})},shouldRenderBodyCell:function(e){var n=this.columnProp(e,"hidden");if(this.rowGroupMode&&!n){var r=this.columnProp(e,"field");if(this.rowGroupMode==="subheader")return this.groupRowsBy!==r;if(this.rowGroupMode==="rowspan")if(this.isGrouped(e)){var c=this.value[this.rowIndex-1];if(c){var u=eo(this.value[this.rowIndex],r),p=eo(c,r);return u!==p}else return!0}else return!0}else return!n},calculateRowGroupSize:function(e){if(this.isGrouped(e)){var n=this.rowIndex,r=this.columnProp(e,"field"),c=eo(this.value[n],r),u=c,p=0;for(this.d_rowExpanded&&p++;c===u;){p++;var o=this.value[++n];if(o)u=eo(o,r);else break}return p===1?null:p}else return null},isGrouped:function(e){var n=this.columnProp(e,"field");return this.groupRowsBy&&n?Array.isArray(this.groupRowsBy)?this.groupRowsBy.indexOf(n)>-1:this.groupRowsBy===n:!1},findIndexInSelection:function(e){return this.findIndex(e,this.selection)},findIndex:function(e,n){var r=-1;if(n&&n.length){for(var c=0;c<n.length;c++)if(this.equals(e,n[c])){r=c;break}}return r},equals:function(e,n){return this.compareSelectionBy==="equals"?e===n:xg(e,n,this.dataKey)},onRowGroupToggle:function(e){this.$emit("rowgroup-toggle",{originalEvent:e,data:this.rowData})},onRowClick:function(e){this.$emit("row-click",{originalEvent:e,data:this.rowData,index:this.rowIndex})},onRowDblClick:function(e){this.$emit("row-dblclick",{originalEvent:e,data:this.rowData,index:this.rowIndex})},onRowRightClick:function(e){this.$emit("row-rightclick",{originalEvent:e,data:this.rowData,index:this.rowIndex})},onRowTouchEnd:function(e){this.$emit("row-touchend",e)},onRowKeyDown:function(e){this.$emit("row-keydown",{originalEvent:e,data:this.rowData,index:this.rowIndex})},onRowMouseDown:function(e){this.$emit("row-mousedown",e)},onRowDragStart:function(e){this.$emit("row-dragstart",{originalEvent:e,index:this.rowIndex})},onRowDragOver:function(e){this.$emit("row-dragover",{originalEvent:e,index:this.rowIndex})},onRowDragLeave:function(e){this.$emit("row-dragleave",e)},onRowDragEnd:function(e){this.$emit("row-dragend",e)},onRowDrop:function(e){this.$emit("row-drop",e)},onRowToggle:function(e){this.d_rowExpanded=!this.d_rowExpanded,this.$emit("row-toggle",F3(F3({},e),{},{expanded:this.d_rowExpanded}))},onRadioChange:function(e){this.$emit("radio-change",e)},onCheckboxChange:function(e){this.$emit("checkbox-change",e)},onCellEditInit:function(e){this.$emit("cell-edit-init",e)},onCellEditComplete:function(e){this.$emit("cell-edit-complete",e)},onCellEditCancel:function(e){this.$emit("cell-edit-cancel",e)},onRowEditInit:function(e){this.$emit("row-edit-init",e)},onRowEditSave:function(e){this.$emit("row-edit-save",e)},onRowEditCancel:function(e){this.$emit("row-edit-cancel",e)},onEditingMetaChange:function(e){this.$emit("editing-meta-change",e)},getVirtualScrollerProp:function(e,n){return n=n||this.virtualScrollerContentProps,n?n[e]:null}},computed:{rowIndex:function(){var e=this.getVirtualScrollerProp("getItemOptions");return e?e(this.index).index:this.index},rowStyles:function(){var e;return(e=this.rowStyle)===null||e===void 0?void 0:e.call(this,this.rowData)},rowClasses:function(){var e=[],n=null;if(this.rowClass){var r=this.rowClass(this.rowData);r&&e.push(r)}if(this.columns){var c=Lse(this.columns),u;try{for(c.s();!(u=c.n()).done;){var p=u.value,o=this.columnProp(p,"selectionMode");if(xr(o)){n=o;break}}}catch(w){c.e(w)}finally{c.f()}}return[this.cx("row",{rowData:this.rowData,index:this.rowIndex,columnSelectionMode:n}),e]},rowTabindex:function(){return this.selection===null&&(this.selectionMode==="single"||this.selectionMode==="multiple")&&this.rowIndex===0?0:-1},isRowEditing:function(){return this.rowData&&this.editingRows?this.dataKey?this.editingRowKeys?this.editingRowKeys[eo(this.rowData,this.dataKey)]!==void 0:!1:this.findIndex(this.rowData,this.editingRows)>-1:!1},isRowGroupExpanded:function(){if(this.expandableRowGroups&&this.expandedRowGroups){var e=eo(this.rowData,this.groupRowsBy);return this.expandedRowGroups.indexOf(e)>-1}return!1},isSelected:function(){return this.rowData&&this.selection?this.dataKey?this.selectionKeys?this.selectionKeys[eo(this.rowData,this.dataKey)]!==void 0:!1:this.selection instanceof Array?this.findIndexInSelection(this.rowData)>-1:this.equals(this.rowData,this.selection):!1},isSelectedWithContextMenu:function(){return this.rowData&&this.contextMenuSelection?this.equals(this.rowData,this.contextMenuSelection,this.dataKey):!1},shouldRenderRowGroupHeader:function(){var e=eo(this.rowData,this.groupRowsBy),n=this.value[this.rowIndex-1];if(n){var r=eo(n,this.groupRowsBy);return e!==r}else return!0},shouldRenderRowGroupFooter:function(){if(this.expandableRowGroups&&!this.isRowGroupExpanded)return!1;var e=eo(this.rowData,this.groupRowsBy),n=this.value[this.rowIndex+1];if(n){var r=eo(n,this.groupRowsBy);return e!==r}else return!0},columnsLength:function(){var e=this;if(this.columns){var n=0;return this.columns.forEach(function(r){e.columnProp(r,"hidden")&&n++}),this.columns.length-n}return 0}},components:{DTBodyCell:qB,ChevronDownIcon:AS,ChevronRightIcon:vI}};function i0(t){"@babel/helpers - typeof";return i0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i0(t)}function N3(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function cp(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?N3(Object(n),!0).forEach(function(r){Vse(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):N3(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Vse(t,e,n){return(e=$se(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $se(t){var e=jse(t,"string");return i0(e)=="symbol"?e:e+""}function jse(t,e){if(i0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(i0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Use=["colspan"],Hse=["tabindex","aria-selected","data-p-index","data-p-selectable-row","data-p-selected","data-p-selected-contextmenu"],Gse=["id"],Wse=["colspan"],qse=["colspan"],Zse=["colspan"];function Kse(t,e,n,r,c,u){var p=Ai("ChevronDownIcon"),o=Ai("ChevronRightIcon"),w=Ai("DTBodyCell");return n.empty?(We(),wt("tr",ft({key:1,class:t.cx("emptyMessage"),role:"row"},t.ptm("emptyMessage")),[Pe("td",ft({colspan:u.columnsLength},cp(cp({},u.getColumnPT("bodycell")),t.ptm("emptyMessageCell"))),[n.templates.empty?(We(),Sn(lr(n.templates.empty),{key:0})):Zn("",!0)],16,Zse)],16)):(We(),wt(Mi,{key:0},[n.templates.groupheader&&n.rowGroupMode==="subheader"&&u.shouldRenderRowGroupHeader?(We(),wt("tr",ft({key:0,class:t.cx("rowGroupHeader"),style:n.rowGroupHeaderStyle,role:"row"},t.ptm("rowGroupHeader")),[Pe("td",ft({colspan:u.columnsLength-1},cp(cp({},u.getColumnPT("bodycell")),t.ptm("rowGroupHeaderCell"))),[n.expandableRowGroups?(We(),wt("button",ft({key:0,class:t.cx("rowToggleButton"),onClick:e[0]||(e[0]=function(){return u.onRowGroupToggle&&u.onRowGroupToggle.apply(u,arguments)}),type:"button"},t.ptm("rowToggleButton")),[n.templates.rowtoggleicon||n.templates.rowgrouptogglericon?(We(),Sn(lr(n.templates.rowtoggleicon||n.templates.rowgrouptogglericon),{key:0,expanded:u.isRowGroupExpanded},null,8,["expanded"])):(We(),wt(Mi,{key:1},[u.isRowGroupExpanded&&n.expandedRowIcon?(We(),wt("span",ft({key:0,class:[t.cx("rowToggleIcon"),n.expandedRowIcon]},t.ptm("rowToggleIcon")),null,16)):u.isRowGroupExpanded&&!n.expandedRowIcon?(We(),Sn(p,ft({key:1,class:t.cx("rowToggleIcon")},t.ptm("rowToggleIcon")),null,16,["class"])):!u.isRowGroupExpanded&&n.collapsedRowIcon?(We(),wt("span",ft({key:2,class:[t.cx("rowToggleIcon"),n.collapsedRowIcon]},t.ptm("rowToggleIcon")),null,16)):!u.isRowGroupExpanded&&!n.collapsedRowIcon?(We(),Sn(o,ft({key:3,class:t.cx("rowToggleIcon")},t.ptm("rowToggleIcon")),null,16,["class"])):Zn("",!0)],64))],16)):Zn("",!0),(We(),Sn(lr(n.templates.groupheader),{data:n.rowData,index:u.rowIndex},null,8,["data","index"]))],16,Use)],16)):Zn("",!0),!n.expandableRowGroups||u.isRowGroupExpanded?(We(),wt("tr",ft({key:1,class:u.rowClasses,style:u.rowStyles,tabindex:u.rowTabindex,role:"row","aria-selected":n.selectionMode?u.isSelected:null,onClick:e[1]||(e[1]=function(){return u.onRowClick&&u.onRowClick.apply(u,arguments)}),onDblclick:e[2]||(e[2]=function(){return u.onRowDblClick&&u.onRowDblClick.apply(u,arguments)}),onContextmenu:e[3]||(e[3]=function(){return u.onRowRightClick&&u.onRowRightClick.apply(u,arguments)}),onTouchend:e[4]||(e[4]=function(){return u.onRowTouchEnd&&u.onRowTouchEnd.apply(u,arguments)}),onKeydown:e[5]||(e[5]=df(function(){return u.onRowKeyDown&&u.onRowKeyDown.apply(u,arguments)},["self"])),onMousedown:e[6]||(e[6]=function(){return u.onRowMouseDown&&u.onRowMouseDown.apply(u,arguments)}),onDragstart:e[7]||(e[7]=function(){return u.onRowDragStart&&u.onRowDragStart.apply(u,arguments)}),onDragover:e[8]||(e[8]=function(){return u.onRowDragOver&&u.onRowDragOver.apply(u,arguments)}),onDragleave:e[9]||(e[9]=function(){return u.onRowDragLeave&&u.onRowDragLeave.apply(u,arguments)}),onDragend:e[10]||(e[10]=function(){return u.onRowDragEnd&&u.onRowDragEnd.apply(u,arguments)}),onDrop:e[11]||(e[11]=function(){return u.onRowDrop&&u.onRowDrop.apply(u,arguments)})},u.getBodyRowPTOptions("bodyRow"),{"data-p-index":u.rowIndex,"data-p-selectable-row":!!n.selectionMode,"data-p-selected":n.selection&&u.isSelected,"data-p-selected-contextmenu":n.contextMenuSelection&&u.isSelectedWithContextMenu}),[(We(!0),wt(Mi,null,ea(n.columns,function(T,A){return We(),wt(Mi,null,[u.shouldRenderBodyCell(T)?(We(),Sn(w,{key:u.columnProp(T,"columnKey")||u.columnProp(T,"field")||A,rowData:n.rowData,column:T,rowIndex:u.rowIndex,index:A,selected:u.isSelected,frozenRow:n.frozenRow,rowspan:n.rowGroupMode==="rowspan"?u.calculateRowGroupSize(T):null,editMode:n.editMode,editing:n.editMode==="row"&&u.isRowEditing,editingMeta:n.editingMeta,virtualScrollerContentProps:n.virtualScrollerContentProps,ariaControls:n.expandedRowId+"_"+u.rowIndex+"_expansion",name:n.nameAttributeSelector,isRowExpanded:c.d_rowExpanded,expandedRowIcon:n.expandedRowIcon,collapsedRowIcon:n.collapsedRowIcon,editButtonProps:n.editButtonProps,onRadioChange:u.onRadioChange,onCheckboxChange:u.onCheckboxChange,onRowToggle:u.onRowToggle,onCellEditInit:u.onCellEditInit,onCellEditComplete:u.onCellEditComplete,onCellEditCancel:u.onCellEditCancel,onRowEditInit:u.onRowEditInit,onRowEditSave:u.onRowEditSave,onRowEditCancel:u.onRowEditCancel,onEditingMetaChange:u.onEditingMetaChange,unstyled:t.unstyled,pt:t.pt},null,8,["rowData","column","rowIndex","index","selected","frozenRow","rowspan","editMode","editing","editingMeta","virtualScrollerContentProps","ariaControls","name","isRowExpanded","expandedRowIcon","collapsedRowIcon","editButtonProps","onRadioChange","onCheckboxChange","onRowToggle","onCellEditInit","onCellEditComplete","onCellEditCancel","onRowEditInit","onRowEditSave","onRowEditCancel","onEditingMetaChange","unstyled","pt"])):Zn("",!0)],64)}),256))],16,Hse)):Zn("",!0),n.templates.expansion&&n.expandedRows&&c.d_rowExpanded?(We(),wt("tr",ft({key:2,id:n.expandedRowId+"_"+u.rowIndex+"_expansion",class:t.cx("rowExpansion"),role:"row"},t.ptm("rowExpansion")),[Pe("td",ft({colspan:u.columnsLength},cp(cp({},u.getColumnPT("bodycell")),t.ptm("rowExpansionCell"))),[(We(),Sn(lr(n.templates.expansion),{data:n.rowData,index:u.rowIndex},null,8,["data","index"]))],16,Wse)],16,Gse)):Zn("",!0),n.templates.groupfooter&&n.rowGroupMode==="subheader"&&u.shouldRenderRowGroupFooter?(We(),wt("tr",ft({key:3,class:t.cx("rowGroupFooter"),role:"row"},t.ptm("rowGroupFooter")),[Pe("td",ft({colspan:u.columnsLength-1},cp(cp({},u.getColumnPT("bodycell")),t.ptm("rowGroupFooterCell"))),[(We(),Sn(lr(n.templates.groupfooter),{data:n.rowData,index:u.rowIndex},null,8,["data","index"]))],16,qse)],16)):Zn("",!0)],64))}ZB.render=Kse;var KB={name:"TableBody",hostName:"DataTable",extends:Lo,emits:["rowgroup-toggle","row-click","row-dblclick","row-rightclick","row-touchend","row-keydown","row-mousedown","row-dragstart","row-dragover","row-dragleave","row-dragend","row-drop","row-toggle","radio-change","checkbox-change","cell-edit-init","cell-edit-complete","cell-edit-cancel","row-edit-init","row-edit-save","row-edit-cancel","editing-meta-change"],props:{value:{type:Array,default:null},columns:{type:null,default:null},frozenRow:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String,Function],default:null},expandableRowGroups:{type:Boolean,default:!1},expandedRowGroups:{type:Array,default:null},first:{type:Number,default:0},dataKey:{type:[String,Function],default:null},expandedRowIcon:{type:String,default:null},collapsedRowIcon:{type:String,default:null},expandedRows:{type:[Array,Object],default:null},selection:{type:[Array,Object],default:null},selectionKeys:{type:null,default:null},selectionMode:{type:String,default:null},rowHover:{type:Boolean,default:!1},contextMenu:{type:Boolean,default:!1},contextMenuSelection:{type:Object,default:null},rowClass:{type:null,default:null},rowStyle:{type:null,default:null},editMode:{type:String,default:null},compareSelectionBy:{type:String,default:"deepEquals"},editingRows:{type:Array,default:null},editingRowKeys:{type:null,default:null},editingMeta:{type:Object,default:null},templates:{type:null,default:null},scrollable:{type:Boolean,default:!1},editButtonProps:{type:Object,default:null},virtualScrollerContentProps:{type:Object,default:null},isVirtualScrollerDisabled:{type:Boolean,default:!1}},data:function(){return{rowGroupHeaderStyleObject:{}}},mounted:function(){this.frozenRow&&this.updateFrozenRowStickyPosition(),this.scrollable&&this.rowGroupMode==="subheader"&&this.updateFrozenRowGroupHeaderStickyPosition()},updated:function(){this.frozenRow&&this.updateFrozenRowStickyPosition(),this.scrollable&&this.rowGroupMode==="subheader"&&this.updateFrozenRowGroupHeaderStickyPosition()},methods:{getRowKey:function(e,n){return this.dataKey?eo(e,this.dataKey):n},updateFrozenRowStickyPosition:function(){this.$el.style.top=ww(this.$el.previousElementSibling)+"px"},updateFrozenRowGroupHeaderStickyPosition:function(){var e=ww(this.$el.previousElementSibling);this.rowGroupHeaderStyleObject.top=e+"px"},getVirtualScrollerProp:function(e,n){return n=n||this.virtualScrollerContentProps,n?n[e]:null},bodyRef:function(e){var n=this.getVirtualScrollerProp("contentRef");n&&n(e)}},computed:{rowGroupHeaderStyle:function(){return this.scrollable?{top:this.rowGroupHeaderStyleObject.top}:null},bodyContentStyle:function(){return this.getVirtualScrollerProp("contentStyle")},ptmTBodyOptions:function(){var e;return{context:{scrollable:(e=this.$parentInstance)===null||e===void 0||(e=e.$parentInstance)===null||e===void 0?void 0:e.scrollable}}},dataP:function(){return Ka({hoverable:this.rowHover||this.selectionMode,frozen:this.frozenRow})}},components:{DTBodyRow:ZB}},Xse=["data-p"];function Yse(t,e,n,r,c,u){var p=Ai("DTBodyRow");return We(),wt("tbody",ft({ref:u.bodyRef,class:t.cx("tbody"),role:"rowgroup",style:u.bodyContentStyle,"data-p":u.dataP},t.ptm("tbody",u.ptmTBodyOptions)),[n.empty?(We(),Sn(p,{key:1,empty:n.empty,columns:n.columns,templates:n.templates,unstyled:t.unstyled,pt:t.pt},null,8,["empty","columns","templates","unstyled","pt"])):(We(!0),wt(Mi,{key:0},ea(n.value,function(o,w){return We(),Sn(p,{key:u.getRowKey(o,w),rowData:o,index:w,value:n.value,columns:n.columns,frozenRow:n.frozenRow,empty:n.empty,first:n.first,dataKey:n.dataKey,selection:n.selection,selectionKeys:n.selectionKeys,selectionMode:n.selectionMode,contextMenu:n.contextMenu,contextMenuSelection:n.contextMenuSelection,rowGroupMode:n.rowGroupMode,groupRowsBy:n.groupRowsBy,expandableRowGroups:n.expandableRowGroups,rowClass:n.rowClass,rowStyle:n.rowStyle,editMode:n.editMode,compareSelectionBy:n.compareSelectionBy,scrollable:n.scrollable,expandedRowIcon:n.expandedRowIcon,collapsedRowIcon:n.collapsedRowIcon,expandedRows:n.expandedRows,expandedRowGroups:n.expandedRowGroups,editingRows:n.editingRows,editingRowKeys:n.editingRowKeys,templates:n.templates,editButtonProps:n.editButtonProps,virtualScrollerContentProps:n.virtualScrollerContentProps,isVirtualScrollerDisabled:n.isVirtualScrollerDisabled,editingMeta:n.editingMeta,rowGroupHeaderStyle:u.rowGroupHeaderStyle,expandedRowId:t.$id,nameAttributeSelector:t.$attrSelector,onRowgroupToggle:e[0]||(e[0]=function(T){return t.$emit("rowgroup-toggle",T)}),onRowClick:e[1]||(e[1]=function(T){return t.$emit("row-click",T)}),onRowDblclick:e[2]||(e[2]=function(T){return t.$emit("row-dblclick",T)}),onRowRightclick:e[3]||(e[3]=function(T){return t.$emit("row-rightclick",T)}),onRowTouchend:e[4]||(e[4]=function(T){return t.$emit("row-touchend",T)}),onRowKeydown:e[5]||(e[5]=function(T){return t.$emit("row-keydown",T)}),onRowMousedown:e[6]||(e[6]=function(T){return t.$emit("row-mousedown",T)}),onRowDragstart:e[7]||(e[7]=function(T){return t.$emit("row-dragstart",T)}),onRowDragover:e[8]||(e[8]=function(T){return t.$emit("row-dragover",T)}),onRowDragleave:e[9]||(e[9]=function(T){return t.$emit("row-dragleave",T)}),onRowDragend:e[10]||(e[10]=function(T){return t.$emit("row-dragend",T)}),onRowDrop:e[11]||(e[11]=function(T){return t.$emit("row-drop",T)}),onRowToggle:e[12]||(e[12]=function(T){return t.$emit("row-toggle",T)}),onRadioChange:e[13]||(e[13]=function(T){return t.$emit("radio-change",T)}),onCheckboxChange:e[14]||(e[14]=function(T){return t.$emit("checkbox-change",T)}),onCellEditInit:e[15]||(e[15]=function(T){return t.$emit("cell-edit-init",T)}),onCellEditComplete:e[16]||(e[16]=function(T){return t.$emit("cell-edit-complete",T)}),onCellEditCancel:e[17]||(e[17]=function(T){return t.$emit("cell-edit-cancel",T)}),onRowEditInit:e[18]||(e[18]=function(T){return t.$emit("row-edit-init",T)}),onRowEditSave:e[19]||(e[19]=function(T){return t.$emit("row-edit-save",T)}),onRowEditCancel:e[20]||(e[20]=function(T){return t.$emit("row-edit-cancel",T)}),onEditingMetaChange:e[21]||(e[21]=function(T){return t.$emit("editing-meta-change",T)}),unstyled:t.unstyled,pt:t.pt},null,8,["rowData","index","value","columns","frozenRow","empty","first","dataKey","selection","selectionKeys","selectionMode","contextMenu","contextMenuSelection","rowGroupMode","groupRowsBy","expandableRowGroups","rowClass","rowStyle","editMode","compareSelectionBy","scrollable","expandedRowIcon","collapsedRowIcon","expandedRows","expandedRowGroups","editingRows","editingRowKeys","templates","editButtonProps","virtualScrollerContentProps","isVirtualScrollerDisabled","editingMeta","rowGroupHeaderStyle","expandedRowId","nameAttributeSelector","unstyled","pt"])}),128))],16,Xse)}KB.render=Yse;var XB={name:"FooterCell",hostName:"DataTable",extends:Lo,props:{column:{type:Object,default:null},index:{type:Number,default:null}},data:function(){return{styleObject:{}}},mounted:function(){this.columnProp("frozen")&&this.updateStickyPosition()},updated:function(){this.columnProp("frozen")&&this.updateStickyPosition()},methods:{columnProp:function(e){return Gp(this.column,e)},getColumnPT:function(e){var n,r,c={props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:this.index,size:(n=this.$parentInstance)===null||n===void 0||(n=n.$parentInstance)===null||n===void 0?void 0:n.size,showGridlines:((r=this.$parentInstance)===null||r===void 0||(r=r.$parentInstance)===null||r===void 0?void 0:r.showGridlines)||!1}};return ft(this.ptm("column.".concat(e),{column:c}),this.ptm("column.".concat(e),c),this.ptmo(this.getColumnProp(),e,c))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},updateStickyPosition:function(){if(this.columnProp("frozen")){var e=this.columnProp("alignFrozen");if(e==="right"){var n=0,r=CS(this.$el,'[data-p-frozen-column="true"]');r&&(n=dc(r)+parseFloat(r.style["inset-inline-end"]||0)),this.styleObject.insetInlineEnd=n+"px"}else{var c=0,u=TS(this.$el,'[data-p-frozen-column="true"]');u&&(c=dc(u)+parseFloat(u.style["inset-inline-start"]||0)),this.styleObject.insetInlineStart=c+"px"}}}},computed:{containerClass:function(){return[this.columnProp("footerClass"),this.columnProp("class"),this.cx("footerCell")]},containerStyle:function(){var e=this.columnProp("footerStyle"),n=this.columnProp("style");return this.columnProp("frozen")?[n,e,this.styleObject]:[n,e]}}};function r0(t){"@babel/helpers - typeof";return r0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r0(t)}function V3(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function $3(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?V3(Object(n),!0).forEach(function(r){Jse(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):V3(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Jse(t,e,n){return(e=Qse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qse(t){var e=eae(t,"string");return r0(e)=="symbol"?e:e+""}function eae(t,e){if(r0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(r0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var tae=["colspan","rowspan","data-p-frozen-column"];function nae(t,e,n,r,c,u){return We(),wt("td",ft({style:u.containerStyle,class:u.containerClass,role:"cell",colspan:u.columnProp("colspan"),rowspan:u.columnProp("rowspan")},$3($3({},u.getColumnPT("root")),u.getColumnPT("footerCell")),{"data-p-frozen-column":u.columnProp("frozen")}),[n.column.children&&n.column.children.footer?(We(),Sn(lr(n.column.children.footer),{key:0,column:n.column},null,8,["column"])):Zn("",!0),u.columnProp("footer")?(We(),wt("span",ft({key:1,class:t.cx("columnFooter")},u.getColumnPT("columnFooter")),wr(u.columnProp("footer")),17)):Zn("",!0)],16,tae)}XB.render=nae;function iae(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=rae(t))||e){n&&(t=n);var r=0,c=function(){};return{s:c,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(T){throw T},f:c}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var u,p=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var T=n.next();return p=T.done,T},e:function(T){o=!0,u=T},f:function(){try{p||n.return==null||n.return()}finally{if(o)throw u}}}}function rae(t,e){if(t){if(typeof t=="string")return j3(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j3(t,e):void 0}}function j3(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var YB={name:"TableFooter",hostName:"DataTable",extends:Lo,props:{columnGroup:{type:null,default:null},columns:{type:Object,default:null}},provide:function(){return{$rows:this.d_footerRows,$columns:this.d_footerColumns}},data:function(){return{d_footerRows:new iy({type:"Row"}),d_footerColumns:new iy({type:"Column"})}},beforeUnmount:function(){this.d_footerRows.clear(),this.d_footerColumns.clear()},methods:{columnProp:function(e,n){return Gp(e,n)},getColumnGroupPT:function(e){var n={props:this.getColumnGroupProps(),parent:{instance:this,props:this.$props,state:this.$data},context:{type:"footer",scrollable:this.ptmTFootOptions.context.scrollable}};return ft(this.ptm("columnGroup.".concat(e),{columnGroup:n}),this.ptm("columnGroup.".concat(e),n),this.ptmo(this.getColumnGroupProps(),e,n))},getColumnGroupProps:function(){return this.columnGroup&&this.columnGroup.props&&this.columnGroup.props.pt?this.columnGroup.props.pt:void 0},getRowPT:function(e,n,r){var c={props:e.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:r}};return ft(this.ptm("row.".concat(n),{row:c}),this.ptm("row.".concat(n),c),this.ptmo(this.getRowProp(e),n,c))},getRowProp:function(e){return e.props&&e.props.pt?e.props.pt:void 0},getFooterRows:function(){var e;return(e=this.d_footerRows)===null||e===void 0?void 0:e.get(this.columnGroup,this.columnGroup.children)},getFooterColumns:function(e){var n;return(n=this.d_footerColumns)===null||n===void 0?void 0:n.get(e,e.children)}},computed:{hasFooter:function(){var e=!1;if(this.columnGroup)e=!0;else if(this.columns){var n=iae(this.columns),r;try{for(n.s();!(r=n.n()).done;){var c=r.value;if(this.columnProp(c,"footer")||c.children&&c.children.footer){e=!0;break}}}catch(u){n.e(u)}finally{n.f()}}return e},ptmTFootOptions:function(){var e;return{context:{scrollable:(e=this.$parentInstance)===null||e===void 0||(e=e.$parentInstance)===null||e===void 0?void 0:e.scrollable}}}},components:{DTFooterCell:XB}};function o0(t){"@babel/helpers - typeof";return o0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o0(t)}function U3(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function px(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?U3(Object(n),!0).forEach(function(r){oae(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):U3(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function oae(t,e,n){return(e=sae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sae(t){var e=aae(t,"string");return o0(e)=="symbol"?e:e+""}function aae(t,e){if(o0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(o0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var lae=["data-p-scrollable"];function cae(t,e,n,r,c,u){var p,o=Ai("DTFooterCell");return u.hasFooter?(We(),wt("tfoot",ft({key:0,class:t.cx("tfoot"),style:t.sx("tfoot"),role:"rowgroup"},n.columnGroup?px(px({},t.ptm("tfoot",u.ptmTFootOptions)),u.getColumnGroupPT("root")):t.ptm("tfoot",u.ptmTFootOptions),{"data-p-scrollable":(p=t.$parentInstance)===null||p===void 0||(p=p.$parentInstance)===null||p===void 0?void 0:p.scrollable,"data-pc-section":"tfoot"}),[n.columnGroup?(We(!0),wt(Mi,{key:1},ea(u.getFooterRows(),function(w,T){return We(),wt("tr",ft({key:T,role:"row"},{ref_for:!0},px(px({},t.ptm("footerRow")),u.getRowPT(w,"root",T))),[(We(!0),wt(Mi,null,ea(u.getFooterColumns(w),function(A,D){return We(),wt(Mi,{key:u.columnProp(A,"columnKey")||u.columnProp(A,"field")||D},[u.columnProp(A,"hidden")?Zn("",!0):(We(),Sn(o,{key:0,column:A,index:T,pt:t.pt},null,8,["column","index","pt"]))],64)}),128))],16)}),128)):(We(),wt("tr",ft({key:0,role:"row"},t.ptm("footerRow")),[(We(!0),wt(Mi,null,ea(n.columns,function(w,T){return We(),wt(Mi,{key:u.columnProp(w,"columnKey")||u.columnProp(w,"field")||T},[u.columnProp(w,"hidden")?Zn("",!0):(We(),Sn(o,{key:0,column:w,pt:t.pt},null,8,["column","pt"]))],64)}),128))],16))],16,lae)):Zn("",!0)}YB.render=cae;function s0(t){"@babel/helpers - typeof";return s0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s0(t)}function H3(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function Fm(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?H3(Object(n),!0).forEach(function(r){uae(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):H3(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function uae(t,e,n){return(e=dae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dae(t){var e=hae(t,"string");return s0(e)=="symbol"?e:e+""}function hae(t,e){if(s0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(s0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var SI={name:"ColumnFilter",hostName:"DataTable",extends:Lo,emits:["filter-change","filter-apply","operator-change","matchmode-change","constraint-add","constraint-remove","filter-clear","apply-click"],props:{field:{type:String,default:null},type:{type:String,default:"text"},display:{type:String,default:null},showMenu:{type:Boolean,default:!0},matchMode:{type:String,default:null},showOperator:{type:Boolean,default:!0},showClearButton:{type:Boolean,default:!0},showApplyButton:{type:Boolean,default:!0},showMatchModes:{type:Boolean,default:!0},showAddButton:{type:Boolean,default:!0},matchModeOptions:{type:Array,default:null},maxConstraints:{type:Number,default:2},filterElement:{type:Function,default:null},filterHeaderTemplate:{type:Function,default:null},filterFooterTemplate:{type:Function,default:null},filterClearTemplate:{type:Function,default:null},filterApplyTemplate:{type:Function,default:null},filterIconTemplate:{type:Function,default:null},filterAddIconTemplate:{type:Function,default:null},filterRemoveIconTemplate:{type:Function,default:null},filterClearIconTemplate:{type:Function,default:null},filters:{type:Object,default:null},filtersStore:{type:Object,default:null},filterMenuClass:{type:String,default:null},filterMenuStyle:{type:null,default:null},filterInputProps:{type:null,default:null},filterButtonProps:{type:null,default:null},column:null},data:function(){return{overlayVisible:!1,defaultMatchMode:null,defaultOperator:null}},overlay:null,selfClick:!1,overlayEventListener:null,beforeUnmount:function(){this.overlayEventListener&&(Sp.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null),this.overlay&&(U_.clear(this.overlay),this.onOverlayHide())},mounted:function(){if(this.filters&&this.filters[this.field]){var e=this.filters[this.field];e.operator?(this.defaultMatchMode=e.constraints[0].matchMode,this.defaultOperator=e.operator):this.defaultMatchMode=this.filters[this.field].matchMode}},methods:{getColumnPT:function(e,n){var r=Fm({props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data}},n);return ft(this.ptm("column.".concat(e),{column:r}),this.ptm("column.".concat(e),r),this.ptmo(this.getColumnProp(),e,r))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},ptmFilterConstraintOptions:function(e){return{context:{highlighted:e&&this.isRowMatchModeSelected(e.value)}}},clearFilter:function(){var e=Fm({},this.filters);e[this.field].operator?(e[this.field].constraints.splice(1),e[this.field].operator=this.defaultOperator,e[this.field].constraints[0]={value:null,matchMode:this.defaultMatchMode}):(e[this.field].value=null,e[this.field].matchMode=this.defaultMatchMode),this.$emit("filter-clear"),this.$emit("filter-change",e),this.$emit("filter-apply"),this.hide()},applyFilter:function(){this.$emit("apply-click",{field:this.field,constraints:this.filters[this.field]}),this.$emit("filter-apply"),this.hide()},hasFilter:function(){if(this.filtersStore){var e=this.filtersStore[this.field];if(e)return e.operator?!this.isFilterBlank(e.constraints[0].value):!this.isFilterBlank(e.value)}return!1},hasRowFilter:function(){return this.filters[this.field]&&!this.isFilterBlank(this.filters[this.field].value)},isFilterBlank:function(e){return e!=null?typeof e=="string"&&e.trim().length==0||e instanceof Array&&e.length==0:!0},toggleMenu:function(e){this.overlayVisible=!this.overlayVisible,e.preventDefault()},onToggleButtonKeyDown:function(e){switch(e.code){case"Enter":case"NumpadEnter":case"Space":this.toggleMenu(e);break;case"Escape":this.overlayVisible=!1;break}},onRowMatchModeChange:function(e){var n=Fm({},this.filters);n[this.field].matchMode=e,this.$emit("matchmode-change",{field:this.field,matchMode:e}),this.$emit("filter-change",n),this.$emit("filter-apply"),this.hide()},onRowMatchModeKeyDown:function(e){var n=e.target;switch(e.code){case"ArrowDown":var r=this.findNextItem(n);r&&(n.removeAttribute("tabindex"),r.tabIndex="0",r.focus()),e.preventDefault();break;case"ArrowUp":var c=this.findPrevItem(n);c&&(n.removeAttribute("tabindex"),c.tabIndex="0",c.focus()),e.preventDefault();break}},isRowMatchModeSelected:function(e){return this.filters[this.field].matchMode===e},onOperatorChange:function(e){var n=Fm({},this.filters);n[this.field].operator=e,this.$emit("filter-change",n),this.$emit("operator-change",{field:this.field,operator:e}),this.showApplyButton||this.$emit("filter-apply")},onMenuMatchModeChange:function(e,n){var r=Fm({},this.filters);r[this.field].constraints[n].matchMode=e,this.$emit("matchmode-change",{field:this.field,matchMode:e,index:n}),this.showApplyButton||this.$emit("filter-apply")},addConstraint:function(){var e=Fm({},this.filters),n={value:null,matchMode:this.defaultMatchMode};e[this.field].constraints.push(n),this.$emit("constraint-add",{field:this.field,constraint:n}),this.$emit("filter-change",e),this.showApplyButton||this.$emit("filter-apply")},removeConstraint:function(e){var n=Fm({},this.filters),r=n[this.field].constraints.splice(e,1);this.$emit("constraint-remove",{field:this.field,constraint:r}),this.$emit("filter-change",n),this.showApplyButton||this.$emit("filter-apply")},filterCallback:function(){this.$emit("filter-apply")},findNextItem:function(e){var n=e.nextElementSibling;return n?La(n,"data-pc-section")==="filterconstraintseparator"?this.findNextItem(n):n:e.parentElement.firstElementChild},findPrevItem:function(e){var n=e.previousElementSibling;return n?La(n,"data-pc-section")==="filterconstraintseparator"?this.findPrevItem(n):n:e.parentElement.lastElementChild},hide:function(){this.overlayVisible=!1,this.showMenuButton&&Nl(this.$refs.icon.$el)},onContentClick:function(e){this.selfClick=!0,Sp.emit("overlay-click",{originalEvent:e,target:this.overlay})},onContentMouseDown:function(){this.selfClick=!0},onOverlayEnter:function(e){var n=this;this.filterMenuStyle&&bw(this.overlay,this.filterMenuStyle),U_.set("overlay",e,this.$primevue.config.zIndex.overlay),bw(e,{position:"absolute",top:"0"}),Lz(this.overlay,this.$refs.icon.$el),this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.overlayEventListener=function(r){n.isOutsideClicked(r.target)||(n.selfClick=!0)},Sp.on("overlay-click",this.overlayEventListener)},onOverlayAfterEnter:function(){var e;(e=this.overlay)===null||e===void 0||(e=e.$focustrap)===null||e===void 0||e.autoFocus()},onOverlayLeave:function(){this.onOverlayHide()},onOverlayAfterLeave:function(e){U_.clear(e)},onOverlayHide:function(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.unbindScrollListener(),this.overlay=null,Sp.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null},overlayRef:function(e){this.overlay=e},isOutsideClicked:function(e){return!this.isTargetClicked(e)&&this.overlay&&!(this.overlay.isSameNode(e)||this.overlay.contains(e))},isTargetClicked:function(e){return this.$refs.icon&&(this.$refs.icon.$el.isSameNode(e)||this.$refs.icon.$el.contains(e))},bindOutsideClickListener:function(){var e=this;this.outsideClickListener||(this.outsideClickListener=function(n){e.overlayVisible&&!e.selfClick&&e.isOutsideClicked(n.target)&&(e.overlayVisible=!1),e.selfClick=!1},document.addEventListener("click",this.outsideClickListener,!0))},unbindOutsideClickListener:function(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener,!0),this.outsideClickListener=null,this.selfClick=!1)},bindScrollListener:function(){var e=this;this.scrollHandler||(this.scrollHandler=new sB(this.$refs.icon.$el,function(){e.overlayVisible&&e.hide()})),this.scrollHandler.bindScrollListener()},unbindScrollListener:function(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener:function(){var e=this;this.resizeListener||(this.resizeListener=function(){e.overlayVisible&&!Vz()&&e.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener:function(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)}},computed:{showMenuButton:function(){return this.showMenu&&(this.display==="row"?this.type!=="boolean":!0)},overlayId:function(){return this.$id+"_overlay"},matchModes:function(){var e=this;return this.matchModeOptions||this.$primevue.config.filterMatchModeOptions[this.type].map(function(n){return{label:e.$primevue.config.locale[n],value:n}})},isShowMatchModes:function(){return this.type!=="boolean"&&this.showMatchModes&&this.matchModes},operatorOptions:function(){return[{label:this.$primevue.config.locale.matchAll,value:Tw.AND},{label:this.$primevue.config.locale.matchAny,value:Tw.OR}]},noFilterLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.noFilter:void 0},isShowOperator:function(){return this.showOperator&&this.filters[this.field].operator},operator:function(){return this.filters[this.field].operator},fieldConstraints:function(){return this.filters[this.field].constraints||[this.filters[this.field]]},showRemoveIcon:function(){return this.fieldConstraints.length>1},removeRuleButtonLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.removeRule:void 0},addRuleButtonLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.addRule:void 0},isShowAddConstraint:function(){return this.showAddButton&&this.filters[this.field].operator&&this.fieldConstraints&&this.fieldConstraints.length<this.maxConstraints},clearButtonLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.clear:void 0},applyButtonLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.apply:void 0},columnFilterButtonAriaLabel:function(){return this.$primevue.config.locale?this.overlayVisible?this.$primevue.config.locale.showFilterMenu:this.$primevue.config.locale.hideFilterMenu:void 0},filterOperatorAriaLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.filterOperator:void 0},filterRuleAriaLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.filterConstraint:void 0},ptmHeaderFilterClearParams:function(){return{context:{hidden:this.hasRowFilter()}}},ptmFilterMenuParams:function(){return{context:{overlayVisible:this.overlayVisible,active:this.hasFilter()}}}},components:{Select:kS,Button:xI,Portal:_I,FilterSlashIcon:jB,FilterFillIcon:$B,FilterIcon:VB,TrashIcon:HB,PlusIcon:UB},directives:{focustrap:wse}};function a0(t){"@babel/helpers - typeof";return a0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a0(t)}function G3(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function mx(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?G3(Object(n),!0).forEach(function(r){fae(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):G3(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function fae(t,e,n){return(e=pae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pae(t){var e=mae(t,"string");return a0(e)=="symbol"?e:e+""}function mae(t,e){if(a0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(a0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var gae=["id","aria-modal"],_ae=["onClick","onKeydown","tabindex"];function yae(t,e,n,r,c,u){var p=Ai("Button"),o=Ai("Select"),w=Ai("Portal"),T=uf("focustrap");return We(),wt("div",ft({class:t.cx("filter")},u.getColumnPT("filter")),[n.display==="row"?(We(),wt("div",ft({key:0,class:t.cx("filterElementContainer")},mx(mx({},n.filterInputProps),u.getColumnPT("filterElementContainer"))),[(We(),Sn(lr(n.filterElement),{field:n.field,filterModel:n.filters[n.field],filterCallback:u.filterCallback},null,8,["field","filterModel","filterCallback"]))],16)):Zn("",!0),u.showMenuButton?(We(),Sn(p,ft({key:1,ref:"icon","aria-label":u.columnFilterButtonAriaLabel,"aria-haspopup":"true","aria-expanded":c.overlayVisible,"aria-controls":u.overlayId,class:t.cx("pcColumnFilterButton"),unstyled:t.unstyled,onClick:e[0]||(e[0]=function(A){return u.toggleMenu(A)}),onKeydown:e[1]||(e[1]=function(A){return u.onToggleButtonKeyDown(A)})},mx(mx({},u.getColumnPT("pcColumnFilterButton",u.ptmFilterMenuParams)),n.filterButtonProps.filter)),{icon:si(function(A){return[(We(),Sn(lr(n.filterIconTemplate||(u.hasFilter()?"FilterFillIcon":"FilterIcon")),ft({class:A.class},u.getColumnPT("filterMenuIcon")),null,16,["class"]))]}),_:1},16,["aria-label","aria-expanded","aria-controls","class","unstyled"])):Zn("",!0),hi(w,null,{default:si(function(){return[hi(aI,ft({name:"p-connected-overlay",onEnter:u.onOverlayEnter,onAfterEnter:u.onOverlayAfterEnter,onLeave:u.onOverlayLeave,onAfterLeave:u.onOverlayAfterLeave},u.getColumnPT("transition")),{default:si(function(){return[c.overlayVisible?Ki((We(),wt("div",ft({key:0,ref:u.overlayRef,id:u.overlayId,"aria-modal":c.overlayVisible,role:"dialog",class:[t.cx("filterOverlay"),n.filterMenuClass],onKeydown:e[10]||(e[10]=O2(function(){return u.hide&&u.hide.apply(u,arguments)},["escape"])),onClick:e[11]||(e[11]=function(){return u.onContentClick&&u.onContentClick.apply(u,arguments)}),onMousedown:e[12]||(e[12]=function(){return u.onContentMouseDown&&u.onContentMouseDown.apply(u,arguments)})},u.getColumnPT("filterOverlay")),[(We(),Sn(lr(n.filterHeaderTemplate),{field:n.field,filterModel:n.filters[n.field],filterCallback:u.filterCallback},null,8,["field","filterModel","filterCallback"])),n.display==="row"?(We(),wt("ul",ft({key:0,class:t.cx("filterConstraintList")},u.getColumnPT("filterConstraintList")),[(We(!0),wt(Mi,null,ea(u.matchModes,function(A,D){return We(),wt("li",ft({key:A.label,class:t.cx("filterConstraint",{matchMode:A}),onClick:function(N){return u.onRowMatchModeChange(A.value)},onKeydown:[e[2]||(e[2]=function(B){return u.onRowMatchModeKeyDown(B)}),O2(df(function(B){return u.onRowMatchModeChange(A.value)},["prevent"]),["enter"])],tabindex:D===0?"0":null},{ref_for:!0},u.getColumnPT("filterConstraint",u.ptmFilterConstraintOptions(A))),wr(A.label),17,_ae)}),128)),Pe("li",ft({class:t.cx("filterConstraintSeparator")},u.getColumnPT("filterConstraintSeparator")),null,16),Pe("li",ft({class:t.cx("filterConstraint"),onClick:e[3]||(e[3]=function(A){return u.clearFilter()}),onKeydown:[e[4]||(e[4]=function(A){return u.onRowMatchModeKeyDown(A)}),e[5]||(e[5]=O2(function(A){return t.onRowClearItemClick()},["enter"]))]},u.getColumnPT("filterConstraint")),wr(u.noFilterLabel),17)],16)):(We(),wt(Mi,{key:1},[u.isShowOperator?(We(),wt("div",ft({key:0,class:t.cx("filterOperator")},u.getColumnPT("filterOperator")),[hi(o,{options:u.operatorOptions,modelValue:u.operator,"aria-label":u.filterOperatorAriaLabel,class:pr(t.cx("pcFilterOperatorDropdown")),optionLabel:"label",optionValue:"value","onUpdate:modelValue":e[6]||(e[6]=function(A){return u.onOperatorChange(A)}),unstyled:t.unstyled,pt:u.getColumnPT("pcFilterOperatorDropdown")},null,8,["options","modelValue","aria-label","class","unstyled","pt"])],16)):Zn("",!0),Pe("div",ft({class:t.cx("filterRuleList")},u.getColumnPT("filterRuleList")),[(We(!0),wt(Mi,null,ea(u.fieldConstraints,function(A,D){return We(),wt("div",ft({key:D,class:t.cx("filterRule")},{ref_for:!0},u.getColumnPT("filterRule")),[u.isShowMatchModes?(We(),Sn(o,{key:0,options:u.matchModes,modelValue:A.matchMode,class:pr(t.cx("pcFilterConstraintDropdown")),optionLabel:"label",optionValue:"value","aria-label":u.filterRuleAriaLabel,"onUpdate:modelValue":function(N){return u.onMenuMatchModeChange(N,D)},unstyled:t.unstyled,pt:u.getColumnPT("pcFilterConstraintDropdown")},null,8,["options","modelValue","class","aria-label","onUpdate:modelValue","unstyled","pt"])):Zn("",!0),n.display==="menu"?(We(),Sn(lr(n.filterElement),{key:1,field:n.field,filterModel:A,filterCallback:u.filterCallback,applyFilter:u.applyFilter},null,8,["field","filterModel","filterCallback","applyFilter"])):Zn("",!0),u.showRemoveIcon?(We(),wt("div",ft({key:2,ref_for:!0},u.getColumnPT("filterRemove")),[hi(p,ft({type:"button",class:t.cx("pcFilterRemoveRuleButton"),onClick:function(N){return u.removeConstraint(D)},label:u.removeRuleButtonLabel,unstyled:t.unstyled},{ref_for:!0},n.filterButtonProps.popover.removeRule,{pt:u.getColumnPT("pcFilterRemoveRuleButton")}),{icon:si(function(B){return[(We(),Sn(lr(n.filterRemoveIconTemplate||"TrashIcon"),ft({class:B.class},{ref_for:!0},u.getColumnPT("pcFilterRemoveRuleButton").icon),null,16,["class"]))]}),_:2},1040,["class","onClick","label","unstyled","pt"])],16)):Zn("",!0)],16)}),128))],16),u.isShowAddConstraint?(We(),wt("div",fS(ft({key:1},u.getColumnPT("filterAddButtonContainer"))),[hi(p,ft({type:"button",label:u.addRuleButtonLabel,iconPos:"left",class:t.cx("pcFilterAddRuleButton"),onClick:e[7]||(e[7]=function(A){return u.addConstraint()}),unstyled:t.unstyled},n.filterButtonProps.popover.addRule,{pt:u.getColumnPT("pcFilterAddRuleButton")}),{icon:si(function(A){return[(We(),Sn(lr(n.filterAddIconTemplate||"PlusIcon"),ft({class:A.class},u.getColumnPT("pcFilterAddRuleButton").icon),null,16,["class"]))]}),_:1},16,["label","class","unstyled","pt"])],16)):Zn("",!0),Pe("div",ft({class:t.cx("filterButtonbar")},u.getColumnPT("filterButtonbar")),[!n.filterClearTemplate&&n.showClearButton?(We(),Sn(p,ft({key:0,type:"button",class:t.cx("pcFilterClearButton"),label:u.clearButtonLabel,onClick:e[8]||(e[8]=function(A){return u.clearFilter()}),unstyled:t.unstyled},n.filterButtonProps.popover.clear,{pt:u.getColumnPT("pcFilterClearButton")}),null,16,["class","label","unstyled","pt"])):(We(),Sn(lr(n.filterClearTemplate),{key:1,field:n.field,filterModel:n.filters[n.field],filterCallback:u.clearFilter},null,8,["field","filterModel","filterCallback"])),n.showApplyButton?(We(),wt(Mi,{key:2},[n.filterApplyTemplate?(We(),Sn(lr(n.filterApplyTemplate),{key:1,field:n.field,filterModel:n.filters[n.field],filterCallback:u.applyFilter},null,8,["field","filterModel","filterCallback"])):(We(),Sn(p,ft({key:0,type:"button",class:t.cx("pcFilterApplyButton"),label:u.applyButtonLabel,onClick:e[9]||(e[9]=function(A){return u.applyFilter()}),unstyled:t.unstyled},n.filterButtonProps.popover.apply,{pt:u.getColumnPT("pcFilterApplyButton")}),null,16,["class","label","unstyled","pt"]))],64)):Zn("",!0)],16)],64)),(We(),Sn(lr(n.filterFooterTemplate),{field:n.field,filterModel:n.filters[n.field],filterCallback:u.filterCallback},null,8,["field","filterModel","filterCallback"]))],16,gae)),[[T]]):Zn("",!0)]}),_:1},16,["onEnter","onAfterEnter","onLeave","onAfterLeave"])]}),_:1})],16)}SI.render=yae;var CI={name:"HeaderCheckbox",hostName:"DataTable",extends:Lo,emits:["change"],props:{checked:null,disabled:null,column:null,headerCheckboxIconTemplate:{type:Function,default:null}},methods:{getColumnPT:function(e){var n={props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data},context:{checked:this.checked,disabled:this.disabled}};return ft(this.ptm("column.".concat(e),{column:n}),this.ptm("column.".concat(e),n),this.ptmo(this.getColumnProp(),e,n))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},onChange:function(e){this.$emit("change",{originalEvent:e,checked:!this.checked})}},computed:{headerCheckboxAriaLabel:function(){return this.$primevue.config.locale.aria?this.checked?this.$primevue.config.locale.aria.selectAll:this.$primevue.config.locale.aria.unselectAll:void 0}},components:{CheckIcon:fy,Checkbox:wI}};function vae(t,e,n,r,c,u){var p=Ai("Checkbox");return We(),Sn(p,{modelValue:n.checked,binary:!0,disabled:n.disabled,"aria-label":u.headerCheckboxAriaLabel,onChange:u.onChange,unstyled:t.unstyled,pt:u.getColumnPT("pcHeaderCheckbox")},null,8,["modelValue","disabled","aria-label","onChange","unstyled","pt"])}CI.render=vae;var JB={name:"FilterHeaderCell",hostName:"DataTable",extends:Lo,emits:["checkbox-change","filter-change","filter-apply","operator-change","matchmode-change","constraint-add","constraint-remove","apply-click"],props:{column:{type:Object,default:null},index:{type:Number,default:null},allRowsSelected:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},display:{type:String,default:"row"},filters:{type:Object,default:null},filtersStore:{type:Object,default:null},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String,Function],default:null},filterInputProps:{type:null,default:null},filterButtonProps:{type:null,default:null}},data:function(){return{styleObject:{}}},mounted:function(){this.columnProp("frozen")&&this.updateStickyPosition()},updated:function(){this.columnProp("frozen")&&this.updateStickyPosition()},methods:{columnProp:function(e){return Gp(this.column,e)},getColumnPT:function(e){if(!this.column)return null;var n={props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:this.index}};return ft(this.ptm("column.".concat(e),{column:n}),this.ptm("column.".concat(e),n),this.ptmo(this.getColumnProp(),e,n))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},updateStickyPosition:function(){if(this.columnProp("frozen")){var e=this.columnProp("alignFrozen");if(e==="right"){var n=0,r=CS(this.$el,'[data-p-frozen-column="true"]');r&&(n=dc(r)+parseFloat(r.style["inset-inline-end"]||0)),this.styleObject.insetInlineEnd=n+"px"}else{var c=0,u=TS(this.$el,'[data-p-frozen-column="true"]');u&&(c=dc(u)+parseFloat(u.style["inset-inline-start"]||0)),this.styleObject.insetInlineStart=c+"px"}}}},computed:{getFilterColumnHeaderClass:function(){return[this.cx("headerCell",{column:this.column}),this.columnProp("filterHeaderClass"),this.columnProp("class")]},getFilterColumnHeaderStyle:function(){return this.columnProp("frozen")?[this.columnProp("filterHeaderStyle"),this.columnProp("style"),this.styleObject]:[this.columnProp("filterHeaderStyle"),this.columnProp("style")]}},components:{DTHeaderCheckbox:CI,DTColumnFilter:SI}};function l0(t){"@babel/helpers - typeof";return l0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l0(t)}function W3(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function q3(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?W3(Object(n),!0).forEach(function(r){bae(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):W3(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function bae(t,e,n){return(e=xae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xae(t){var e=wae(t,"string");return l0(e)=="symbol"?e:e+""}function wae(t,e){if(l0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(l0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Sae=["data-p-frozen-column"];function Cae(t,e,n,r,c,u){var p=Ai("DTHeaderCheckbox"),o=Ai("DTColumnFilter");return!u.columnProp("hidden")&&(n.rowGroupMode!=="subheader"||n.groupRowsBy!==u.columnProp("field"))?(We(),wt("th",ft({key:0,style:u.getFilterColumnHeaderStyle,class:u.getFilterColumnHeaderClass},q3(q3({},u.getColumnPT("root")),u.getColumnPT("headerCell")),{"data-p-frozen-column":u.columnProp("frozen")}),[u.columnProp("selectionMode")==="multiple"?(We(),Sn(p,{key:0,checked:n.allRowsSelected,disabled:n.empty,onChange:e[0]||(e[0]=function(w){return t.$emit("checkbox-change",w)}),column:n.column,unstyled:t.unstyled,pt:t.pt},null,8,["checked","disabled","column","unstyled","pt"])):Zn("",!0),n.column.children&&n.column.children.filter?(We(),Sn(o,{key:1,field:u.columnProp("filterField")||u.columnProp("field"),type:u.columnProp("dataType"),display:"row",showMenu:u.columnProp("showFilterMenu"),filterElement:n.column.children&&n.column.children.filter,filterHeaderTemplate:n.column.children&&n.column.children.filterheader,filterFooterTemplate:n.column.children&&n.column.children.filterfooter,filterClearTemplate:n.column.children&&n.column.children.filterclear,filterApplyTemplate:n.column.children&&n.column.children.filterapply,filterIconTemplate:n.column.children&&n.column.children.filtericon,filterAddIconTemplate:n.column.children&&n.column.children.filteraddicon,filterRemoveIconTemplate:n.column.children&&n.column.children.filterremoveicon,filterClearIconTemplate:n.column.children&&n.column.children.filterclearicon,filters:n.filters,filtersStore:n.filtersStore,filterInputProps:n.filterInputProps,filterButtonProps:n.filterButtonProps,onFilterChange:e[1]||(e[1]=function(w){return t.$emit("filter-change",w)}),onFilterApply:e[2]||(e[2]=function(w){return t.$emit("filter-apply")}),filterMenuStyle:u.columnProp("filterMenuStyle"),filterMenuClass:u.columnProp("filterMenuClass"),showOperator:u.columnProp("showFilterOperator"),showClearButton:u.columnProp("showClearButton"),showApplyButton:u.columnProp("showApplyButton"),showMatchModes:u.columnProp("showFilterMatchModes"),showAddButton:u.columnProp("showAddButton"),matchModeOptions:u.columnProp("filterMatchModeOptions"),maxConstraints:u.columnProp("maxConstraints"),onOperatorChange:e[3]||(e[3]=function(w){return t.$emit("operator-change",w)}),onMatchmodeChange:e[4]||(e[4]=function(w){return t.$emit("matchmode-change",w)}),onConstraintAdd:e[5]||(e[5]=function(w){return t.$emit("constraint-add",w)}),onConstraintRemove:e[6]||(e[6]=function(w){return t.$emit("constraint-remove",w)}),onApplyClick:e[7]||(e[7]=function(w){return t.$emit("apply-click",w)}),column:n.column,unstyled:t.unstyled,pt:t.pt},null,8,["field","type","showMenu","filterElement","filterHeaderTemplate","filterFooterTemplate","filterClearTemplate","filterApplyTemplate","filterIconTemplate","filterAddIconTemplate","filterRemoveIconTemplate","filterClearIconTemplate","filters","filtersStore","filterInputProps","filterButtonProps","filterMenuStyle","filterMenuClass","showOperator","showClearButton","showApplyButton","showMatchModes","showAddButton","matchModeOptions","maxConstraints","column","unstyled","pt"])):Zn("",!0)],16,Sae)):Zn("",!0)}JB.render=Cae;var QB={name:"HeaderCell",hostName:"DataTable",extends:Lo,emits:["column-click","column-mousedown","column-dragstart","column-dragover","column-dragleave","column-drop","column-resizestart","checkbox-change","filter-change","filter-apply","operator-change","matchmode-change","constraint-add","constraint-remove","filter-clear","apply-click"],props:{column:{type:Object,default:null},index:{type:Number,default:null},resizableColumns:{type:Boolean,default:!1},groupRowsBy:{type:[Array,String,Function],default:null},sortMode:{type:String,default:"single"},groupRowSortField:{type:[String,Function],default:null},sortField:{type:[String,Function],default:null},sortOrder:{type:Number,default:null},multiSortMeta:{type:Array,default:null},allRowsSelected:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},filterDisplay:{type:String,default:null},filters:{type:Object,default:null},filtersStore:{type:Object,default:null},filterColumn:{type:Boolean,default:!1},reorderableColumns:{type:Boolean,default:!1},filterInputProps:{type:null,default:null},filterButtonProps:{type:null,default:null}},data:function(){return{styleObject:{}}},mounted:function(){this.columnProp("frozen")&&this.updateStickyPosition()},updated:function(){this.columnProp("frozen")&&this.updateStickyPosition()},methods:{columnProp:function(e){return Gp(this.column,e)},getColumnPT:function(e){var n,r,c={props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:this.index,sortable:this.columnProp("sortable")===""||this.columnProp("sortable"),sorted:this.isColumnSorted(),resizable:this.resizableColumns,size:(n=this.$parentInstance)===null||n===void 0||(n=n.$parentInstance)===null||n===void 0?void 0:n.size,showGridlines:((r=this.$parentInstance)===null||r===void 0||(r=r.$parentInstance)===null||r===void 0?void 0:r.showGridlines)||!1}};return ft(this.ptm("column.".concat(e),{column:c}),this.ptm("column.".concat(e),c),this.ptmo(this.getColumnProp(),e,c))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},onClick:function(e){this.$emit("column-click",{originalEvent:e,column:this.column})},onKeyDown:function(e){(e.code==="Enter"||e.code==="NumpadEnter"||e.code==="Space")&&e.currentTarget.nodeName==="TH"&&La(e.currentTarget,"data-p-sortable-column")&&(this.$emit("column-click",{originalEvent:e,column:this.column}),e.preventDefault())},onMouseDown:function(e){this.$emit("column-mousedown",{originalEvent:e,column:this.column})},onDragStart:function(e){this.$emit("column-dragstart",{originalEvent:e,column:this.column})},onDragOver:function(e){this.$emit("column-dragover",{originalEvent:e,column:this.column})},onDragLeave:function(e){this.$emit("column-dragleave",{originalEvent:e,column:this.column})},onDrop:function(e){this.$emit("column-drop",{originalEvent:e,column:this.column})},onResizeStart:function(e){this.$emit("column-resizestart",e)},getMultiSortMetaIndex:function(){var e=this;return this.multiSortMeta.findIndex(function(n){return n.field===e.columnProp("field")||n.field===e.columnProp("sortField")})},getBadgeValue:function(){var e=this.getMultiSortMetaIndex();return this.groupRowsBy&&this.groupRowsBy===this.groupRowSortField&&e>-1?e:e+1},isMultiSorted:function(){return this.sortMode==="multiple"&&this.columnProp("sortable")&&this.getMultiSortMetaIndex()>-1},isColumnSorted:function(){return this.sortMode==="single"?this.sortField&&(this.sortField===this.columnProp("field")||this.sortField===this.columnProp("sortField")):this.isMultiSorted()},updateStickyPosition:function(){if(this.columnProp("frozen")){var e=this.columnProp("alignFrozen");if(e==="right"){var n=0,r=CS(this.$el,'[data-p-frozen-column="true"]');r&&(n=dc(r)+parseFloat(r.style["inset-inline-end"]||0)),this.styleObject.insetInlineEnd=n+"px"}else{var c=0,u=TS(this.$el,'[data-p-frozen-column="true"]');u&&(c=dc(u)+parseFloat(u.style["inset-inline-start"]||0)),this.styleObject.insetInlineStart=c+"px"}var p=this.$el.parentElement.nextElementSibling;if(p){var o=qx(this.$el);p.children[o]&&(p.children[o].style["inset-inline-start"]=this.styleObject["inset-inline-start"],p.children[o].style["inset-inline-end"]=this.styleObject["inset-inline-end"])}}},onHeaderCheckboxChange:function(e){this.$emit("checkbox-change",e)}},computed:{containerClass:function(){return[this.cx("headerCell"),this.filterColumn?this.columnProp("filterHeaderClass"):this.columnProp("headerClass"),this.columnProp("class")]},containerStyle:function(){var e=this.filterColumn?this.columnProp("filterHeaderStyle"):this.columnProp("headerStyle"),n=this.columnProp("style");return this.columnProp("frozen")?[n,e,this.styleObject]:[n,e]},sortState:function(){var e=!1,n=null;if(this.sortMode==="single")e=this.sortField&&(this.sortField===this.columnProp("field")||this.sortField===this.columnProp("sortField")),n=e?this.sortOrder:0;else if(this.sortMode==="multiple"){var r=this.getMultiSortMetaIndex();r>-1&&(e=!0,n=this.multiSortMeta[r].order)}return{sorted:e,sortOrder:n}},sortableColumnIcon:function(){var e=this.sortState,n=e.sorted,r=e.sortOrder;if(n){if(n&&r>0)return oE;if(n&&r<0)return rE}else return iE;return null},ariaSort:function(){if(this.columnProp("sortable")){var e=this.sortState,n=e.sorted,r=e.sortOrder;return n&&r<0?"descending":n&&r>0?"ascending":"none"}else return null}},components:{Badge:bI,DTHeaderCheckbox:CI,DTColumnFilter:SI,SortAltIcon:iE,SortAmountUpAltIcon:oE,SortAmountDownIcon:rE}};function c0(t){"@babel/helpers - typeof";return c0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c0(t)}function Z3(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function K3(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Z3(Object(n),!0).forEach(function(r){Tae(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Z3(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Tae(t,e,n){return(e=Eae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Eae(t){var e=Iae(t,"string");return c0(e)=="symbol"?e:e+""}function Iae(t,e){if(c0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(c0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Aae=["tabindex","colspan","rowspan","aria-sort","data-p-sortable-column","data-p-resizable-column","data-p-sorted","data-p-filter-column","data-p-frozen-column","data-p-reorderable-column"];function kae(t,e,n,r,c,u){var p=Ai("Badge"),o=Ai("DTHeaderCheckbox"),w=Ai("DTColumnFilter");return We(),wt("th",ft({style:u.containerStyle,class:u.containerClass,tabindex:u.columnProp("sortable")?"0":null,role:"columnheader",colspan:u.columnProp("colspan"),rowspan:u.columnProp("rowspan"),"aria-sort":u.ariaSort,onClick:e[8]||(e[8]=function(){return u.onClick&&u.onClick.apply(u,arguments)}),onKeydown:e[9]||(e[9]=function(){return u.onKeyDown&&u.onKeyDown.apply(u,arguments)}),onMousedown:e[10]||(e[10]=function(){return u.onMouseDown&&u.onMouseDown.apply(u,arguments)}),onDragstart:e[11]||(e[11]=function(){return u.onDragStart&&u.onDragStart.apply(u,arguments)}),onDragover:e[12]||(e[12]=function(){return u.onDragOver&&u.onDragOver.apply(u,arguments)}),onDragleave:e[13]||(e[13]=function(){return u.onDragLeave&&u.onDragLeave.apply(u,arguments)}),onDrop:e[14]||(e[14]=function(){return u.onDrop&&u.onDrop.apply(u,arguments)})},K3(K3({},u.getColumnPT("root")),u.getColumnPT("headerCell")),{"data-p-sortable-column":u.columnProp("sortable"),"data-p-resizable-column":n.resizableColumns,"data-p-sorted":u.isColumnSorted(),"data-p-filter-column":n.filterColumn,"data-p-frozen-column":u.columnProp("frozen"),"data-p-reorderable-column":n.reorderableColumns}),[n.resizableColumns&&!u.columnProp("frozen")?(We(),wt("span",ft({key:0,class:t.cx("columnResizer"),onMousedown:e[0]||(e[0]=function(){return u.onResizeStart&&u.onResizeStart.apply(u,arguments)})},u.getColumnPT("columnResizer")),null,16)):Zn("",!0),Pe("div",ft({class:t.cx("columnHeaderContent")},u.getColumnPT("columnHeaderContent")),[n.column.children&&n.column.children.header?(We(),Sn(lr(n.column.children.header),{key:0,column:n.column},null,8,["column"])):Zn("",!0),u.columnProp("header")?(We(),wt("span",ft({key:1,class:t.cx("columnTitle")},u.getColumnPT("columnTitle")),wr(u.columnProp("header")),17)):Zn("",!0),u.columnProp("sortable")?(We(),wt("span",fS(ft({key:2},u.getColumnPT("sort"))),[(We(),Sn(lr(n.column.children&&n.column.children.sorticon||u.sortableColumnIcon),ft({sorted:u.sortState.sorted,sortOrder:u.sortState.sortOrder,class:t.cx("sortIcon")},u.getColumnPT("sorticon")),null,16,["sorted","sortOrder","class"]))],16)):Zn("",!0),u.isMultiSorted()?(We(),Sn(p,{key:3,class:pr(t.cx("pcSortBadge")),pt:u.getColumnPT("pcSortBadge"),value:u.getBadgeValue(),size:"small"},null,8,["class","pt","value"])):Zn("",!0),u.columnProp("selectionMode")==="multiple"&&n.filterDisplay!=="row"?(We(),Sn(o,{key:4,checked:n.allRowsSelected,onChange:u.onHeaderCheckboxChange,disabled:n.empty,headerCheckboxIconTemplate:n.column.children&&n.column.children.headercheckboxicon,column:n.column,unstyled:t.unstyled,pt:t.pt},null,8,["checked","onChange","disabled","headerCheckboxIconTemplate","column","unstyled","pt"])):Zn("",!0),n.filterDisplay==="menu"&&n.column.children&&n.column.children.filter?(We(),Sn(w,{key:5,field:u.columnProp("filterField")||u.columnProp("field"),type:u.columnProp("dataType"),display:"menu",showMenu:u.columnProp("showFilterMenu"),filterElement:n.column.children&&n.column.children.filter,filterHeaderTemplate:n.column.children&&n.column.children.filterheader,filterFooterTemplate:n.column.children&&n.column.children.filterfooter,filterClearTemplate:n.column.children&&n.column.children.filterclear,filterApplyTemplate:n.column.children&&n.column.children.filterapply,filterIconTemplate:n.column.children&&n.column.children.filtericon,filterAddIconTemplate:n.column.children&&n.column.children.filteraddicon,filterRemoveIconTemplate:n.column.children&&n.column.children.filterremoveicon,filterClearIconTemplate:n.column.children&&n.column.children.filterclearicon,filters:n.filters,filtersStore:n.filtersStore,filterInputProps:n.filterInputProps,filterButtonProps:n.filterButtonProps,onFilterChange:e[1]||(e[1]=function(T){return t.$emit("filter-change",T)}),onFilterApply:e[2]||(e[2]=function(T){return t.$emit("filter-apply")}),filterMenuStyle:u.columnProp("filterMenuStyle"),filterMenuClass:u.columnProp("filterMenuClass"),showOperator:u.columnProp("showFilterOperator"),showClearButton:u.columnProp("showClearButton"),showApplyButton:u.columnProp("showApplyButton"),showMatchModes:u.columnProp("showFilterMatchModes"),showAddButton:u.columnProp("showAddButton"),matchModeOptions:u.columnProp("filterMatchModeOptions"),maxConstraints:u.columnProp("maxConstraints"),onOperatorChange:e[3]||(e[3]=function(T){return t.$emit("operator-change",T)}),onMatchmodeChange:e[4]||(e[4]=function(T){return t.$emit("matchmode-change",T)}),onConstraintAdd:e[5]||(e[5]=function(T){return t.$emit("constraint-add",T)}),onConstraintRemove:e[6]||(e[6]=function(T){return t.$emit("constraint-remove",T)}),onApplyClick:e[7]||(e[7]=function(T){return t.$emit("apply-click",T)}),column:n.column,unstyled:t.unstyled,pt:t.pt},null,8,["field","type","showMenu","filterElement","filterHeaderTemplate","filterFooterTemplate","filterClearTemplate","filterApplyTemplate","filterIconTemplate","filterAddIconTemplate","filterRemoveIconTemplate","filterClearIconTemplate","filters","filtersStore","filterInputProps","filterButtonProps","filterMenuStyle","filterMenuClass","showOperator","showClearButton","showApplyButton","showMatchModes","showAddButton","matchModeOptions","maxConstraints","column","unstyled","pt"])):Zn("",!0)],16)],16,Aae)}QB.render=kae;var eF={name:"TableHeader",hostName:"DataTable",extends:Lo,emits:["column-click","column-mousedown","column-dragstart","column-dragover","column-dragleave","column-drop","column-resizestart","checkbox-change","filter-change","filter-apply","operator-change","matchmode-change","constraint-add","constraint-remove","filter-clear","apply-click"],props:{columnGroup:{type:null,default:null},columns:{type:null,default:null},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String,Function],default:null},resizableColumns:{type:Boolean,default:!1},allRowsSelected:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},sortMode:{type:String,default:"single"},groupRowSortField:{type:[String,Function],default:null},sortField:{type:[String,Function],default:null},sortOrder:{type:Number,default:null},multiSortMeta:{type:Array,default:null},filterDisplay:{type:String,default:null},filters:{type:Object,default:null},filtersStore:{type:Object,default:null},reorderableColumns:{type:Boolean,default:!1},first:{type:Number,default:0},filterInputProps:{type:null,default:null},filterButtonProps:{type:null,default:null}},provide:function(){return{$rows:this.d_headerRows,$columns:this.d_headerColumns}},data:function(){return{d_headerRows:new iy({type:"Row"}),d_headerColumns:new iy({type:"Column"})}},beforeUnmount:function(){this.d_headerRows.clear(),this.d_headerColumns.clear()},methods:{columnProp:function(e,n){return Gp(e,n)},getColumnGroupPT:function(e){var n,r={props:this.getColumnGroupProps(),parent:{instance:this,props:this.$props,state:this.$data},context:{type:"header",scrollable:(n=this.$parentInstance)===null||n===void 0||(n=n.$parentInstance)===null||n===void 0?void 0:n.scrollable}};return ft(this.ptm("columnGroup.".concat(e),{columnGroup:r}),this.ptm("columnGroup.".concat(e),r),this.ptmo(this.getColumnGroupProps(),e,r))},getColumnGroupProps:function(){return this.columnGroup&&this.columnGroup.props&&this.columnGroup.props.pt?this.columnGroup.props.pt:void 0},getRowPT:function(e,n,r){var c={props:e.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:r}};return ft(this.ptm("row.".concat(n),{row:c}),this.ptm("row.".concat(n),c),this.ptmo(this.getRowProp(e),n,c))},getRowProp:function(e){return e.props&&e.props.pt?e.props.pt:void 0},getColumnPT:function(e,n,r){var c={props:e.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:r}};return ft(this.ptm("column.".concat(n),{column:c}),this.ptm("column.".concat(n),c),this.ptmo(this.getColumnProp(e),n,c))},getColumnProp:function(e){return e.props&&e.props.pt?e.props.pt:void 0},getFilterColumnHeaderClass:function(e){return[this.cx("headerCell",{column:e}),this.columnProp(e,"filterHeaderClass"),this.columnProp(e,"class")]},getFilterColumnHeaderStyle:function(e){return[this.columnProp(e,"filterHeaderStyle"),this.columnProp(e,"style")]},getHeaderRows:function(){var e;return(e=this.d_headerRows)===null||e===void 0?void 0:e.get(this.columnGroup,this.columnGroup.children)},getHeaderColumns:function(e){var n;return(n=this.d_headerColumns)===null||n===void 0?void 0:n.get(e,e.children)}},computed:{ptmTHeadOptions:function(){var e;return{context:{scrollable:(e=this.$parentInstance)===null||e===void 0||(e=e.$parentInstance)===null||e===void 0?void 0:e.scrollable}}}},components:{DTHeaderCell:QB,DTFilterHeaderCell:JB}};function u0(t){"@babel/helpers - typeof";return u0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u0(t)}function X3(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function gx(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?X3(Object(n),!0).forEach(function(r){Rae(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):X3(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Rae(t,e,n){return(e=Pae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pae(t){var e=Mae(t,"string");return u0(e)=="symbol"?e:e+""}function Mae(t,e){if(u0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(u0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Dae=["data-p-scrollable"];function Oae(t,e,n,r,c,u){var p,o=Ai("DTHeaderCell"),w=Ai("DTFilterHeaderCell");return We(),wt("thead",ft({class:t.cx("thead"),style:t.sx("thead"),role:"rowgroup"},n.columnGroup?gx(gx({},t.ptm("thead",u.ptmTHeadOptions)),u.getColumnGroupPT("root")):t.ptm("thead",u.ptmTHeadOptions),{"data-p-scrollable":(p=t.$parentInstance)===null||p===void 0||(p=p.$parentInstance)===null||p===void 0?void 0:p.scrollable,"data-pc-section":"thead"}),[n.columnGroup?(We(!0),wt(Mi,{key:1},ea(u.getHeaderRows(),function(T,A){return We(),wt("tr",ft({key:A,role:"row"},{ref_for:!0},gx(gx({},t.ptm("headerRow")),u.getRowPT(T,"root",A))),[(We(!0),wt(Mi,null,ea(u.getHeaderColumns(T),function(D,B){return We(),wt(Mi,{key:u.columnProp(D,"columnKey")||u.columnProp(D,"field")||B},[!u.columnProp(D,"hidden")&&(n.rowGroupMode!=="subheader"||n.groupRowsBy!==u.columnProp(D,"field"))&&typeof D.children!="string"?(We(),Sn(o,{key:0,column:D,onColumnClick:e[15]||(e[15]=function(N){return t.$emit("column-click",N)}),onColumnMousedown:e[16]||(e[16]=function(N){return t.$emit("column-mousedown",N)}),groupRowsBy:n.groupRowsBy,groupRowSortField:n.groupRowSortField,sortMode:n.sortMode,sortField:n.sortField,sortOrder:n.sortOrder,multiSortMeta:n.multiSortMeta,allRowsSelected:n.allRowsSelected,empty:n.empty,onCheckboxChange:e[17]||(e[17]=function(N){return t.$emit("checkbox-change",N)}),filters:n.filters,filterDisplay:n.filterDisplay,filtersStore:n.filtersStore,filterInputProps:n.filterInputProps,filterButtonProps:n.filterButtonProps,onFilterChange:e[18]||(e[18]=function(N){return t.$emit("filter-change",N)}),onFilterApply:e[19]||(e[19]=function(N){return t.$emit("filter-apply")}),onOperatorChange:e[20]||(e[20]=function(N){return t.$emit("operator-change",N)}),onMatchmodeChange:e[21]||(e[21]=function(N){return t.$emit("matchmode-change",N)}),onConstraintAdd:e[22]||(e[22]=function(N){return t.$emit("constraint-add",N)}),onConstraintRemove:e[23]||(e[23]=function(N){return t.$emit("constraint-remove",N)}),onApplyClick:e[24]||(e[24]=function(N){return t.$emit("apply-click",N)}),unstyled:t.unstyled,pt:t.pt},null,8,["column","groupRowsBy","groupRowSortField","sortMode","sortField","sortOrder","multiSortMeta","allRowsSelected","empty","filters","filterDisplay","filtersStore","filterInputProps","filterButtonProps","unstyled","pt"])):Zn("",!0)],64)}),128))],16)}),128)):(We(),wt("tr",ft({key:0,role:"row"},t.ptm("headerRow")),[(We(!0),wt(Mi,null,ea(n.columns,function(T,A){return We(),wt(Mi,{key:u.columnProp(T,"columnKey")||u.columnProp(T,"field")||A},[!u.columnProp(T,"hidden")&&(n.rowGroupMode!=="subheader"||n.groupRowsBy!==u.columnProp(T,"field"))?(We(),Sn(o,{key:0,column:T,index:A,onColumnClick:e[0]||(e[0]=function(D){return t.$emit("column-click",D)}),onColumnMousedown:e[1]||(e[1]=function(D){return t.$emit("column-mousedown",D)}),onColumnDragstart:e[2]||(e[2]=function(D){return t.$emit("column-dragstart",D)}),onColumnDragover:e[3]||(e[3]=function(D){return t.$emit("column-dragover",D)}),onColumnDragleave:e[4]||(e[4]=function(D){return t.$emit("column-dragleave",D)}),onColumnDrop:e[5]||(e[5]=function(D){return t.$emit("column-drop",D)}),groupRowsBy:n.groupRowsBy,groupRowSortField:n.groupRowSortField,reorderableColumns:n.reorderableColumns,resizableColumns:n.resizableColumns,onColumnResizestart:e[6]||(e[6]=function(D){return t.$emit("column-resizestart",D)}),sortMode:n.sortMode,sortField:n.sortField,sortOrder:n.sortOrder,multiSortMeta:n.multiSortMeta,allRowsSelected:n.allRowsSelected,empty:n.empty,onCheckboxChange:e[7]||(e[7]=function(D){return t.$emit("checkbox-change",D)}),filters:n.filters,filterDisplay:n.filterDisplay,filtersStore:n.filtersStore,filterInputProps:n.filterInputProps,filterButtonProps:n.filterButtonProps,first:n.first,onFilterChange:e[8]||(e[8]=function(D){return t.$emit("filter-change",D)}),onFilterApply:e[9]||(e[9]=function(D){return t.$emit("filter-apply")}),onOperatorChange:e[10]||(e[10]=function(D){return t.$emit("operator-change",D)}),onMatchmodeChange:e[11]||(e[11]=function(D){return t.$emit("matchmode-change",D)}),onConstraintAdd:e[12]||(e[12]=function(D){return t.$emit("constraint-add",D)}),onConstraintRemove:e[13]||(e[13]=function(D){return t.$emit("constraint-remove",D)}),onApplyClick:e[14]||(e[14]=function(D){return t.$emit("apply-click",D)}),unstyled:t.unstyled,pt:t.pt},null,8,["column","index","groupRowsBy","groupRowSortField","reorderableColumns","resizableColumns","sortMode","sortField","sortOrder","multiSortMeta","allRowsSelected","empty","filters","filterDisplay","filtersStore","filterInputProps","filterButtonProps","first","unstyled","pt"])):Zn("",!0)],64)}),128))],16)),n.filterDisplay==="row"?(We(),wt("tr",ft({key:2,role:"row"},t.ptm("headerRow")),[(We(!0),wt(Mi,null,ea(n.columns,function(T,A){return We(),wt(Mi,{key:u.columnProp(T,"columnKey")||u.columnProp(T,"field")||A},[!u.columnProp(T,"hidden")&&(n.rowGroupMode!=="subheader"||n.groupRowsBy!==u.columnProp(T,"field"))?(We(),Sn(w,{key:0,column:T,index:A,allRowsSelected:n.allRowsSelected,empty:n.empty,display:"row",filters:n.filters,filtersStore:n.filtersStore,filterInputProps:n.filterInputProps,filterButtonProps:n.filterButtonProps,onFilterChange:e[25]||(e[25]=function(D){return t.$emit("filter-change",D)}),onFilterApply:e[26]||(e[26]=function(D){return t.$emit("filter-apply")}),onOperatorChange:e[27]||(e[27]=function(D){return t.$emit("operator-change",D)}),onMatchmodeChange:e[28]||(e[28]=function(D){return t.$emit("matchmode-change",D)}),onConstraintAdd:e[29]||(e[29]=function(D){return t.$emit("constraint-add",D)}),onConstraintRemove:e[30]||(e[30]=function(D){return t.$emit("constraint-remove",D)}),onApplyClick:e[31]||(e[31]=function(D){return t.$emit("apply-click",D)}),onCheckboxChange:e[32]||(e[32]=function(D){return t.$emit("checkbox-change",D)}),unstyled:t.unstyled,pt:t.pt},null,8,["column","index","allRowsSelected","empty","filters","filtersStore","filterInputProps","filterButtonProps","unstyled","pt"])):Zn("",!0)],64)}),128))],16)):Zn("",!0)],16,Dae)}eF.render=Oae;var Lae=["expanded"];function eh(t){"@babel/helpers - typeof";return eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eh(t)}function zae(t,e){if(t==null)return{};var n,r,c=Bae(t,e);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(t);for(r=0;r<u.length;r++)n=u[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(c[n]=t[n])}return c}function Bae(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function Y3(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function Pc(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Y3(Object(n),!0).forEach(function(r){Fae(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Y3(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Fae(t,e,n){return(e=Nae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nae(t){var e=Vae(t,"string");return eh(e)=="symbol"?e:e+""}function Vae(t,e){if(eh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(eh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function J3(t,e){return Uae(t)||jae(t,e)||TI(t,e)||$ae()}function $ae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jae(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,c,u,p,o=[],w=!0,T=!1;try{if(u=(n=n.call(t)).next,e!==0)for(;!(w=(r=u.call(n)).done)&&(o.push(r.value),o.length!==e);w=!0);}catch(A){T=!0,c=A}finally{try{if(!w&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(T)throw c}}return o}}function Uae(t){if(Array.isArray(t))return t}function Fv(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=TI(t))||e){n&&(t=n);var r=0,c=function(){};return{s:c,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(T){throw T},f:c}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var u,p=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var T=n.next();return p=T.done,T},e:function(T){o=!0,u=T},f:function(){try{p||n.return==null||n.return()}finally{if(o)throw u}}}}function zs(t){return Wae(t)||Gae(t)||TI(t)||Hae()}function Hae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TI(t,e){if(t){if(typeof t=="string")return sE(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sE(t,e):void 0}}function Gae(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Wae(t){if(Array.isArray(t))return sE(t)}function sE(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var RS={name:"DataTable",extends:Ese,inheritAttrs:!1,emits:["value-change","update:first","update:rows","page","update:sortField","update:sortOrder","update:multiSortMeta","sort","filter","row-click","row-dblclick","update:selection","row-select","row-unselect","update:contextMenuSelection","row-contextmenu","row-unselect-all","row-select-all","select-all-change","column-resize-end","column-reorder","row-reorder","update:expandedRows","row-collapse","row-expand","update:expandedRowGroups","rowgroup-collapse","rowgroup-expand","update:filters","state-restore","state-save","cell-edit-init","cell-edit-complete","cell-edit-cancel","update:editingRows","row-edit-init","row-edit-save","row-edit-cancel"],provide:function(){return{$columns:this.d_columns.get(),$columnGroups:this.d_columnGroups.get()}},data:function(){return{d_first:this.first,d_rows:this.rows,d_sortField:this.sortField,d_sortOrder:this.sortOrder,d_nullSortOrder:this.nullSortOrder,d_multiSortMeta:this.multiSortMeta?zs(this.multiSortMeta):[],d_groupRowsSortMeta:null,d_selectionKeys:null,d_columnOrder:null,d_editingRowKeys:null,d_editingMeta:{},d_filters:this.cloneFilters(this.filters),d_columns:new iy({type:"Column"}),d_columnGroups:new iy({type:"ColumnGroup"})}},rowTouched:!1,anchorRowIndex:null,rangeRowIndex:null,documentColumnResizeListener:null,documentColumnResizeEndListener:null,lastResizeHelperX:null,resizeColumnElement:null,columnResizing:!1,colReorderIconWidth:null,colReorderIconHeight:null,draggedColumn:null,draggedColumnElement:null,draggedRowIndex:null,droppedRowIndex:null,rowDragging:null,columnWidthsState:null,tableWidthState:null,columnWidthsRestored:!1,watch:{first:function(e){this.d_first=e},rows:function(e){this.d_rows=e},sortField:function(e){this.d_sortField=e},sortOrder:function(e){this.d_sortOrder=e},nullSortOrder:function(e){this.d_nullSortOrder=e},multiSortMeta:function(e){this.d_multiSortMeta=e},selection:{immediate:!0,handler:function(e){this.dataKey&&this.updateSelectionKeys(e)}},editingRows:{immediate:!0,handler:function(e){this.dataKey&&this.updateEditingRowKeys(e)}},filters:{deep:!0,handler:function(e){this.d_filters=this.cloneFilters(e)}}},mounted:function(){this.isStateful()&&(this.restoreState(),this.resizableColumns&&this.restoreColumnWidths()),this.editMode==="row"&&this.dataKey&&!this.d_editingRowKeys&&this.updateEditingRowKeys(this.editingRows)},beforeUnmount:function(){this.unbindColumnResizeEvents(),this.destroyStyleElement(),this.d_columns.clear(),this.d_columnGroups.clear()},updated:function(){this.isStateful()&&this.saveState(),this.editMode==="row"&&this.dataKey&&!this.d_editingRowKeys&&this.updateEditingRowKeys(this.editingRows)},methods:{columnProp:function(e,n){return Gp(e,n)},onPage:function(e){var n=this;this.clearEditingMetaData(),this.d_first=e.first,this.d_rows=e.rows;var r=this.createLazyLoadEvent(e);r.pageCount=e.pageCount,r.page=e.page,this.$emit("update:first",this.d_first),this.$emit("update:rows",this.d_rows),this.$emit("page",r),this.$nextTick(function(){n.$emit("value-change",n.processedData)})},onColumnHeaderClick:function(e){var n=this,r=e.originalEvent,c=e.column;if(this.columnProp(c,"sortable")){var u=r.target,p=this.columnProp(c,"sortField")||this.columnProp(c,"field");if(La(u,"data-p-sortable-column")===!0||La(u,"data-pc-section")==="columntitle"||La(u,"data-pc-section")==="columnheadercontent"||La(u,"data-pc-section")==="sorticon"||La(u.parentElement,"data-pc-section")==="sorticon"||La(u.parentElement.parentElement,"data-pc-section")==="sorticon"||u.closest('[data-p-sortable-column="true"]')&&!u.closest('[data-pc-section="columnfilterbutton"]')&&!z2(r.target)){if(Wx(),this.sortMode==="single")this.d_sortField===p?this.removableSort&&this.d_sortOrder*-1===this.defaultSortOrder?(this.d_sortOrder=null,this.d_sortField=null):this.d_sortOrder=this.d_sortOrder*-1:(this.d_sortOrder=this.defaultSortOrder,this.d_sortField=p),this.$emit("update:sortField",this.d_sortField),this.$emit("update:sortOrder",this.d_sortOrder),this.resetPage();else if(this.sortMode==="multiple"){var o=r.metaKey||r.ctrlKey;o||(this.d_multiSortMeta=this.d_multiSortMeta.filter(function(w){return w.field===p})),this.addMultiSortField(p),this.$emit("update:multiSortMeta",this.d_multiSortMeta)}this.$emit("sort",this.createLazyLoadEvent(r)),this.$nextTick(function(){n.$emit("value-change",n.processedData)})}}},sortSingle:function(e){var n=this;if(this.clearEditingMetaData(),this.groupRowsBy&&this.groupRowsBy===this.sortField)return this.d_multiSortMeta=[{field:this.sortField,order:this.sortOrder||this.defaultSortOrder},{field:this.d_sortField,order:this.d_sortOrder}],this.sortMultiple(e);var r=zs(e),c=new Map,u=Fv(r),p;try{for(u.s();!(p=u.n()).done;){var o=p.value;c.set(o,eo(o,this.d_sortField))}}catch(T){u.e(T)}finally{u.f()}var w=ED();return r.sort(function(T,A){var D=c.get(T),B=c.get(A);return AD(D,B,n.d_sortOrder,w,n.d_nullSortOrder)}),r},sortMultiple:function(e){var n=this;if(this.clearEditingMetaData(),this.groupRowsBy&&(this.d_groupRowsSortMeta||this.d_multiSortMeta.length&&this.groupRowsBy===this.d_multiSortMeta[0].field)){var r=this.d_multiSortMeta[0];!this.d_groupRowsSortMeta&&(this.d_groupRowsSortMeta=r),r.field!==this.d_groupRowsSortMeta.field&&(this.d_multiSortMeta=[this.d_groupRowsSortMeta].concat(zs(this.d_multiSortMeta)))}var c=zs(e);return c.sort(function(u,p){return n.multisortField(u,p,0)}),c},multisortField:function(e,n,r){var c=eo(e,this.d_multiSortMeta[r].field),u=eo(n,this.d_multiSortMeta[r].field),p=ED();return c===u?this.d_multiSortMeta.length-1>r?this.multisortField(e,n,r+1):0:AD(c,u,this.d_multiSortMeta[r].order,p,this.d_nullSortOrder)},addMultiSortField:function(e){var n=this.d_multiSortMeta.findIndex(function(r){return r.field===e});n>=0?this.removableSort&&this.d_multiSortMeta[n].order*-1===this.defaultSortOrder?this.d_multiSortMeta.splice(n,1):this.d_multiSortMeta[n]={field:e,order:this.d_multiSortMeta[n].order*-1}:this.d_multiSortMeta.push({field:e,order:this.defaultSortOrder}),this.d_multiSortMeta=zs(this.d_multiSortMeta)},getActiveFilters:function(e){var n=function(p){var o=J3(p,2),w=o[0],T=o[1];if(T.constraints){var A=T.constraints.filter(function(D){return D.value!==null});if(A.length>0)return[w,Pc(Pc({},T),{},{constraints:A})]}else if(T.value!==null)return[w,T]},r=function(p){return p!==void 0},c=Object.entries(e).map(n).filter(r);return Object.fromEntries(c)},filter:function(e){var n=this;if(e){this.clearEditingMetaData();var r=this.getActiveFilters(this.filters),c;r.global&&(c=this.globalFilterFields||this.columns.map(function(xe){return n.columnProp(xe,"filterField")||n.columnProp(xe,"field")}));for(var u=[],p=0;p<e.length;p++){var o=!0,w=!1,T=!1;for(var A in r)if(Object.prototype.hasOwnProperty.call(r,A)&&A!=="global"){T=!0;var D=A,B=r[D];if(B.operator){var N=Fv(B.constraints),ee;try{for(N.s();!(ee=N.n()).done;){var Q=ee.value;if(o=this.executeLocalFilter(D,e[p],Q),B.operator===Tw.OR&&o||B.operator===Tw.AND&&!o)break}}catch(xe){N.e(xe)}finally{N.f()}}else o=this.executeLocalFilter(D,e[p],B);if(!o)break}if(o&&r.global&&!w&&c)for(var se=0;se<c.length;se++){var ce=c[se];if(w=GT.filters[r.global.matchMode||Oa.CONTAINS](eo(e[p],ce),r.global.value,this.filterLocale),w)break}var be=void 0;r.global?be=T?T&&o&&w:w:be=T&&o,be&&u.push(e[p])}(u.length===this.value.length||Object.keys(r).length==0)&&(u=e);var ze=this.createLazyLoadEvent();return ze.filteredValue=u,this.$emit("filter",ze),this.$emit("value-change",u),u}},executeLocalFilter:function(e,n,r){var c=r.value,u=r.matchMode||Oa.STARTS_WITH,p=eo(n,e),o=GT.filters[u];return o(p,c,this.filterLocale)},onRowClick:function(e){var n=e.originalEvent,r=this.$refs.bodyRef&&this.$refs.bodyRef.$el,c=xp(r,'tr[data-p-selectable-row="true"][tabindex="0"]');if(!z2(n.target)){if(this.$emit("row-click",e),this.selectionMode){var u=e.data,p=this.d_first+e.index;if(this.isMultipleSelectionMode()&&n.shiftKey&&this.anchorRowIndex!=null)Wx(),this.rangeRowIndex=p,this.selectRange(n);else{var o=this.isSelected(u),w=this.rowTouched?!1:this.metaKeySelection;if(this.anchorRowIndex=p,this.rangeRowIndex=p,w){var T=n.metaKey||n.ctrlKey;if(o&&T){if(this.isSingleSelectionMode())this.$emit("update:selection",null);else{var A=this.findIndexInSelection(u),D=this.selection.filter(function(ze,xe){return xe!=A});this.$emit("update:selection",D)}this.$emit("row-unselect",{originalEvent:n,data:u,index:p,type:"row"})}else{if(this.isSingleSelectionMode())this.$emit("update:selection",u);else if(this.isMultipleSelectionMode()){var B=T?this.selection||[]:[];B=[].concat(zs(B),[u]),this.$emit("update:selection",B)}this.$emit("row-select",{originalEvent:n,data:u,index:p,type:"row"})}}else if(this.selectionMode==="single")o?(this.$emit("update:selection",null),this.$emit("row-unselect",{originalEvent:n,data:u,index:p,type:"row"})):(this.$emit("update:selection",u),this.$emit("row-select",{originalEvent:n,data:u,index:p,type:"row"}));else if(this.selectionMode==="multiple")if(o){var N=this.findIndexInSelection(u),ee=this.selection.filter(function(ze,xe){return xe!=N});this.$emit("update:selection",ee),this.$emit("row-unselect",{originalEvent:n,data:u,index:p,type:"row"})}else{var Q=this.selection?[].concat(zs(this.selection),[u]):[u];this.$emit("update:selection",Q),this.$emit("row-select",{originalEvent:n,data:u,index:p,type:"row"})}}}if(this.rowTouched=!1,c){var se,ce;if(((se=n.target)===null||se===void 0?void 0:se.getAttribute("data-pc-section"))==="rowtoggleicon")return;var be=(ce=n.currentTarget)===null||ce===void 0?void 0:ce.closest('tr[data-p-selectable-row="true"]');c.tabIndex="-1",be&&(be.tabIndex="0")}}},onRowDblClick:function(e){var n=e.originalEvent;z2(n.target)||this.$emit("row-dblclick",e)},onRowRightClick:function(e){this.contextMenu&&(Wx(),e.originalEvent.target.focus()),this.$emit("update:contextMenuSelection",e.data),this.$emit("row-contextmenu",e)},onRowTouchEnd:function(){this.rowTouched=!0},onRowKeyDown:function(e,n){var r=e.originalEvent,c=e.data,u=e.index,p=r.metaKey||r.ctrlKey;if(this.selectionMode){var o=r.target;switch(r.code){case"ArrowDown":this.onArrowDownKey(r,o,u,n);break;case"ArrowUp":this.onArrowUpKey(r,o,u,n);break;case"Home":this.onHomeKey(r,o,u,n);break;case"End":this.onEndKey(r,o,u,n);break;case"Enter":case"NumpadEnter":this.onEnterKey(r,c,u);break;case"Space":this.onSpaceKey(r,c,u,n);break;case"Tab":this.onTabKey(r,u);break;default:if(r.code==="KeyA"&&p&&this.isMultipleSelectionMode()){var w=this.dataToRender(n.rows);this.$emit("update:selection",w)}var T=r.code==="KeyC"&&p;T||r.preventDefault();break}}},onArrowDownKey:function(e,n,r,c){var u=this.findNextSelectableRow(n);if(u&&this.focusRowChange(n,u),e.shiftKey){var p=this.dataToRender(c.rows),o=r+1>=p.length?p.length-1:r+1;this.onRowClick({originalEvent:e,data:p[o],index:o})}e.preventDefault()},onArrowUpKey:function(e,n,r,c){var u=this.findPrevSelectableRow(n);if(u&&this.focusRowChange(n,u),e.shiftKey){var p=this.dataToRender(c.rows),o=r-1<=0?0:r-1;this.onRowClick({originalEvent:e,data:p[o],index:o})}e.preventDefault()},onHomeKey:function(e,n,r,c){var u=this.findFirstSelectableRow();if(u&&this.focusRowChange(n,u),e.ctrlKey&&e.shiftKey){var p=this.dataToRender(c.rows);this.$emit("update:selection",p.slice(0,r+1))}e.preventDefault()},onEndKey:function(e,n,r,c){var u=this.findLastSelectableRow();if(u&&this.focusRowChange(n,u),e.ctrlKey&&e.shiftKey){var p=this.dataToRender(c.rows);this.$emit("update:selection",p.slice(r,p.length))}e.preventDefault()},onEnterKey:function(e,n,r){this.onRowClick({originalEvent:e,data:n,index:r}),e.preventDefault()},onSpaceKey:function(e,n,r,c){if(this.onEnterKey(e,n,r),e.shiftKey&&this.selection!==null){var u=this.dataToRender(c.rows),p;if(this.selection.length>0){var o,w;o=L2(this.selection[0],u),w=L2(this.selection[this.selection.length-1],u),p=r<=o?w:o}else p=L2(this.selection,u);var T=p!==r?u.slice(Math.min(p,r),Math.max(p,r)+1):n;this.$emit("update:selection",T)}},onTabKey:function(e,n){var r=this.$refs.bodyRef&&this.$refs.bodyRef.$el,c=I_(r,'tr[data-p-selectable-row="true"]');if(e.code==="Tab"&&c&&c.length>0){var u=xp(r,'tr[data-p-selected="true"]'),p=xp(r,'tr[data-p-selectable-row="true"][tabindex="0"]');u?(u.tabIndex="0",p&&p!==u&&(p.tabIndex="-1")):(c[0].tabIndex="0",p!==c[0]&&c[n]&&(c[n].tabIndex="-1"))}},findNextSelectableRow:function(e){var n=e.nextElementSibling;return n?La(n,"data-p-selectable-row")===!0?n:this.findNextSelectableRow(n):null},findPrevSelectableRow:function(e){var n=e.previousElementSibling;return n?La(n,"data-p-selectable-row")===!0?n:this.findPrevSelectableRow(n):null},findFirstSelectableRow:function(){var e=xp(this.$refs.table,'tr[data-p-selectable-row="true"]');return e},findLastSelectableRow:function(){var e=I_(this.$refs.table,'tr[data-p-selectable-row="true"]');return e?e[e.length-1]:null},focusRowChange:function(e,n){e.tabIndex="-1",n.tabIndex="0",Nl(n)},toggleRowWithRadio:function(e){var n=e.data;this.isSelected(n)?(this.$emit("update:selection",null),this.$emit("row-unselect",{originalEvent:e.originalEvent,data:n,index:e.index,type:"radiobutton"})):(this.$emit("update:selection",n),this.$emit("row-select",{originalEvent:e.originalEvent,data:n,index:e.index,type:"radiobutton"}))},toggleRowWithCheckbox:function(e){var n=e.data;if(this.isSelected(n)){var r=this.findIndexInSelection(n),c=this.selection.filter(function(p,o){return o!=r});this.$emit("update:selection",c),this.$emit("row-unselect",{originalEvent:e.originalEvent,data:n,index:e.index,type:"checkbox"})}else{var u=this.selection?zs(this.selection):[];u=[].concat(zs(u),[n]),this.$emit("update:selection",u),this.$emit("row-select",{originalEvent:e.originalEvent,data:n,index:e.index,type:"checkbox"})}},toggleRowsWithCheckbox:function(e){if(this.selectAll!==null)this.$emit("select-all-change",e);else{var n=e.originalEvent,r=e.checked,c=[];r?(c=this.frozenValue?[].concat(zs(this.frozenValue),zs(this.processedData)):this.processedData,this.$emit("row-select-all",{originalEvent:n,data:c})):this.$emit("row-unselect-all",{originalEvent:n}),this.$emit("update:selection",c)}},isSingleSelectionMode:function(){return this.selectionMode==="single"},isMultipleSelectionMode:function(){return this.selectionMode==="multiple"},isSelected:function(e){return e&&this.selection?this.dataKey?this.d_selectionKeys?this.d_selectionKeys[eo(e,this.dataKey)]!==void 0:!1:this.selection instanceof Array?this.findIndexInSelection(e)>-1:this.equals(e,this.selection):!1},findIndexInSelection:function(e){return this.findIndex(e,this.selection)},findIndex:function(e,n){var r=-1;if(n&&n.length){for(var c=0;c<n.length;c++)if(this.equals(e,n[c])){r=c;break}}return r},updateSelectionKeys:function(e){if(this.d_selectionKeys={},Array.isArray(e)){var n=Fv(e),r;try{for(n.s();!(r=n.n()).done;){var c=r.value;this.d_selectionKeys[String(eo(c,this.dataKey))]=1}}catch(u){n.e(u)}finally{n.f()}}else this.d_selectionKeys[String(eo(e,this.dataKey))]=1},updateEditingRowKeys:function(e){if(e&&e.length){this.d_editingRowKeys={};var n=Fv(e),r;try{for(n.s();!(r=n.n()).done;){var c=r.value;this.d_editingRowKeys[String(eo(c,this.dataKey))]=1}}catch(u){n.e(u)}finally{n.f()}}else this.d_editingRowKeys=null},equals:function(e,n){return this.compareSelectionBy==="equals"?e===n:xg(e,n,this.dataKey)},selectRange:function(e){var n,r;this.rangeRowIndex>this.anchorRowIndex?(n=this.anchorRowIndex,r=this.rangeRowIndex):this.rangeRowIndex<this.anchorRowIndex?(n=this.rangeRowIndex,r=this.anchorRowIndex):(n=this.rangeRowIndex,r=this.rangeRowIndex),this.lazy&&this.paginator&&(n-=this.d_first,r-=this.d_first);for(var c=this.processedData,u=[],p=n;p<=r;p++){var o=c[p];u.push(o),this.$emit("row-select",{originalEvent:e,data:o,type:"row"})}this.$emit("update:selection",u)},generateCSV:function(e,n){var r=this,c="\uFEFF";n||(n=this.processedData,e&&e.selectionOnly?n=this.selection||[]:this.frozenValue&&(n=n?[].concat(zs(this.frozenValue),zs(n)):this.frozenValue));for(var u=!1,p=0;p<this.columns.length;p++){var o=this.columns[p];this.columnProp(o,"exportable")!==!1&&this.columnProp(o,"field")&&(u?c+=this.csvSeparator:u=!0,c+='"'+(this.columnProp(o,"exportHeader")||this.columnProp(o,"header")||this.columnProp(o,"field"))+'"')}n&&n.forEach(function(D){c+=`
`;for(var B=!1,N=0;N<r.columns.length;N++){var ee=r.columns[N];if(r.columnProp(ee,"exportable")!==!1&&r.columnProp(ee,"field")){B?c+=r.csvSeparator:B=!0;var Q=eo(D,r.columnProp(ee,"field"));Q!=null?r.exportFunction?Q=r.exportFunction({data:Q,field:r.columnProp(ee,"field")}):Q=String(Q).replace(/"/g,'""'):Q="",c+='"'+Q+'"'}}});for(var w=!1,T=0;T<this.columns.length;T++){var A=this.columns[T];T===0&&(c+=`
`),this.columnProp(A,"exportable")!==!1&&this.columnProp(A,"exportFooter")&&(w?c+=this.csvSeparator:w=!0,c+='"'+(this.columnProp(A,"exportFooter")||this.columnProp(A,"footer")||this.columnProp(A,"field"))+'"')}return c},exportCSV:function(e,n){var r=this.generateCSV(e,n);uG(r,this.exportFilename)},resetPage:function(){this.d_first=0,this.$emit("update:first",this.d_first)},onColumnResizeStart:function(e){var n=A_(this.$el).left;this.resizeColumnElement=e.target.parentElement,this.columnResizing=!0,this.lastResizeHelperX=e.pageX-n+this.$el.scrollLeft,this.bindColumnResizeEvents()},onColumnResize:function(e){var n=A_(this.$el).left;this.$el.setAttribute("data-p-unselectable-text","true"),!this.isUnstyled&&bw(this.$el,{"user-select":"none"}),this.$refs.resizeHelper.style.height=this.$el.offsetHeight+"px",this.$refs.resizeHelper.style.top="0px",this.$refs.resizeHelper.style.left=e.pageX-n+this.$el.scrollLeft+"px",this.$refs.resizeHelper.style.display="block"},onColumnResizeEnd:function(){var e=Oz(this.$el)?this.lastResizeHelperX-this.$refs.resizeHelper.offsetLeft:this.$refs.resizeHelper.offsetLeft-this.lastResizeHelperX,n=this.resizeColumnElement.offsetWidth,r=n+e,c=this.resizeColumnElement.style.minWidth||15;if(n+e>parseInt(c,10)){if(this.columnResizeMode==="fit"){var u=this.resizeColumnElement.nextElementSibling,p=u.offsetWidth-e;r>15&&p>15&&this.resizeTableCells(r,p)}else if(this.columnResizeMode==="expand"){var o=this.$refs.table.offsetWidth+e+"px",w=function(B){B&&(B.style.width=B.style.minWidth=o)};if(this.resizeTableCells(r),w(this.$refs.table),!this.virtualScrollerDisabled){var T=this.$refs.bodyRef&&this.$refs.bodyRef.$el,A=this.$refs.frozenBodyRef&&this.$refs.frozenBodyRef.$el;w(T),w(A)}}this.$emit("column-resize-end",{element:this.resizeColumnElement,delta:e})}this.$refs.resizeHelper.style.display="none",this.resizeColumn=null,this.$el.removeAttribute("data-p-unselectable-text"),!this.isUnstyled&&(this.$el.style["user-select"]=""),this.unbindColumnResizeEvents(),this.isStateful()&&this.saveState()},resizeTableCells:function(e,n){var r=qx(this.resizeColumnElement),c=[],u=I_(this.$refs.table,'thead[data-pc-section="thead"] > tr > th');u.forEach(function(w){return c.push(dc(w))}),this.destroyStyleElement(),this.createStyleElement();var p="",o='[data-pc-name="datatable"]['.concat(this.$attrSelector,'] > [data-pc-section="tablecontainer"] ').concat(this.virtualScrollerDisabled?"":'> [data-pc-name="virtualscroller"]',' > table[data-pc-section="table"]');c.forEach(function(w,T){var A=T===r?e:n&&T===r+1?n:w,D="width: ".concat(A,"px !important; max-width: ").concat(A,"px !important");p+=`
                    `.concat(o,' > thead[data-pc-section="thead"] > tr > th:nth-child(').concat(T+1,`),
                    `).concat(o,' > tbody[data-pc-section="tbody"] > tr > td:nth-child(').concat(T+1,`),
                    `).concat(o,' > tfoot[data-pc-section="tfoot"] > tr > td:nth-child(').concat(T+1,`) {
                        `).concat(D,`
                    }
                `)}),this.styleElement.innerHTML=p},bindColumnResizeEvents:function(){var e=this;this.documentColumnResizeListener||(this.documentColumnResizeListener=function(n){e.columnResizing&&e.onColumnResize(n)},document.addEventListener("mousemove",this.documentColumnResizeListener)),this.documentColumnResizeEndListener||(this.documentColumnResizeEndListener=function(){e.columnResizing&&(e.columnResizing=!1,e.onColumnResizeEnd())},document.addEventListener("mouseup",this.documentColumnResizeEndListener))},unbindColumnResizeEvents:function(){this.documentColumnResizeListener&&(document.removeEventListener("document",this.documentColumnResizeListener),this.documentColumnResizeListener=null),this.documentColumnResizeEndListener&&(document.removeEventListener("document",this.documentColumnResizeEndListener),this.documentColumnResizeEndListener=null)},onColumnHeaderMouseDown:function(e){var n=e.originalEvent,r=e.column;this.reorderableColumns&&this.columnProp(r,"reorderableColumn")!==!1&&(n.target.nodeName==="INPUT"||n.target.nodeName==="TEXTAREA"||La(n.target,'[data-pc-section="columnresizer"]')?n.currentTarget.draggable=!1:n.currentTarget.draggable=!0)},onColumnHeaderDragStart:function(e){var n=e.originalEvent,r=e.column;if(this.columnResizing){n.preventDefault();return}this.colReorderIconWidth=gG(this.$refs.reorderIndicatorUp),this.colReorderIconHeight=mG(this.$refs.reorderIndicatorUp),this.draggedColumn=r,this.draggedColumnElement=this.findParentHeader(n.target),n.dataTransfer.setData("text","b")},onColumnHeaderDragOver:function(e){var n=e.originalEvent,r=e.column,c=this.findParentHeader(n.target);if(this.reorderableColumns&&this.draggedColumnElement&&c&&!this.columnProp(r,"frozen")){n.preventDefault();var u=A_(this.$el),p=A_(c);if(this.draggedColumnElement!==c){var o=p.left-u.left,w=p.left+c.offsetWidth/2;this.$refs.reorderIndicatorUp.style.top=p.top-u.top-(this.colReorderIconHeight-1)+"px",this.$refs.reorderIndicatorDown.style.top=p.top-u.top+c.offsetHeight+"px",n.pageX>w?(this.$refs.reorderIndicatorUp.style.left=o+c.offsetWidth-Math.ceil(this.colReorderIconWidth/2)+"px",this.$refs.reorderIndicatorDown.style.left=o+c.offsetWidth-Math.ceil(this.colReorderIconWidth/2)+"px",this.dropPosition=1):(this.$refs.reorderIndicatorUp.style.left=o-Math.ceil(this.colReorderIconWidth/2)+"px",this.$refs.reorderIndicatorDown.style.left=o-Math.ceil(this.colReorderIconWidth/2)+"px",this.dropPosition=-1),this.$refs.reorderIndicatorUp.style.display="block",this.$refs.reorderIndicatorDown.style.display="block"}}},onColumnHeaderDragLeave:function(e){var n=e.originalEvent;this.reorderableColumns&&this.draggedColumnElement&&(n.preventDefault(),this.$refs.reorderIndicatorUp.style.display="none",this.$refs.reorderIndicatorDown.style.display="none")},onColumnHeaderDrop:function(e){var n=this,r=e.originalEvent,c=e.column;if(r.preventDefault(),this.draggedColumnElement){var u=qx(this.draggedColumnElement),p=qx(this.findParentHeader(r.target)),o=u!==p;if(o&&(p-u===1&&this.dropPosition===-1||p-u===-1&&this.dropPosition===1)&&(o=!1),o){var w=function(ce,be){return n.columnProp(ce,"columnKey")||n.columnProp(be,"columnKey")?n.columnProp(ce,"columnKey")===n.columnProp(be,"columnKey"):n.columnProp(ce,"field")===n.columnProp(be,"field")},T=this.columns.findIndex(function(se){return w(se,n.draggedColumn)}),A=this.columns.findIndex(function(se){return w(se,c)}),D=[],B=I_(this.$el,'thead[data-pc-section="thead"] > tr > th');B.forEach(function(se){return D.push(dc(se))});var N=D.find(function(se,ce){return ce===T}),ee=D.filter(function(se,ce){return ce!==T}),Q=[].concat(zs(ee.slice(0,A)),[N],zs(ee.slice(A)));this.addColumnWidthStyles(Q),A<T&&this.dropPosition===1&&A++,A>T&&this.dropPosition===-1&&A--,ID(this.columns,T,A),this.updateReorderableColumns(),this.$emit("column-reorder",{originalEvent:r,dragIndex:T,dropIndex:A})}this.$refs.reorderIndicatorUp.style.display="none",this.$refs.reorderIndicatorDown.style.display="none",this.draggedColumnElement.draggable=!1,this.draggedColumnElement=null,this.draggedColumn=null,this.dropPosition=null}},findParentHeader:function(e){if(e.nodeName==="TH")return e;for(var n=e.parentElement;n.nodeName!=="TH"&&(n=n.parentElement,!!n););return n},findColumnByKey:function(e,n){if(e&&e.length)for(var r=0;r<e.length;r++){var c=e[r];if(this.columnProp(c,"columnKey")===n||this.columnProp(c,"field")===n)return c}return null},onRowMouseDown:function(e){La(e.target,"data-pc-section")==="reorderablerowhandle"||La(e.target.parentElement,"data-pc-section")==="reorderablerowhandle"?e.currentTarget.draggable=!0:e.currentTarget.draggable=!1},onRowDragStart:function(e){var n=e.originalEvent,r=e.index;this.rowDragging=!0,this.draggedRowIndex=r,n.dataTransfer.setData("text","b")},onRowDragOver:function(e){var n=e.originalEvent,r=e.index;if(this.rowDragging&&this.draggedRowIndex!==r){var c=n.currentTarget,u=A_(c).top,p=n.pageY,o=u+ww(c)/2,w=c.previousElementSibling;p<o?(c.setAttribute("data-p-datatable-dragpoint-bottom","false"),!this.isUnstyled&&mp(c,"p-datatable-dragpoint-bottom"),this.droppedRowIndex=r,w?(w.setAttribute("data-p-datatable-dragpoint-bottom","true"),!this.isUnstyled&&Wv(w,"p-datatable-dragpoint-bottom")):(c.setAttribute("data-p-datatable-dragpoint-top","true"),!this.isUnstyled&&Wv(c,"p-datatable-dragpoint-top"))):(w?(w.setAttribute("data-p-datatable-dragpoint-bottom","false"),!this.isUnstyled&&mp(w,"p-datatable-dragpoint-bottom")):(c.setAttribute("data-p-datatable-dragpoint-top","true"),!this.isUnstyled&&Wv(c,"p-datatable-dragpoint-top")),this.droppedRowIndex=r+1,c.setAttribute("data-p-datatable-dragpoint-bottom","true"),!this.isUnstyled&&Wv(c,"p-datatable-dragpoint-bottom")),n.preventDefault()}},onRowDragLeave:function(e){var n=e.currentTarget,r=n.previousElementSibling;r&&(r.setAttribute("data-p-datatable-dragpoint-bottom","false"),!this.isUnstyled&&mp(r,"p-datatable-dragpoint-bottom")),n.setAttribute("data-p-datatable-dragpoint-bottom","false"),!this.isUnstyled&&mp(n,"p-datatable-dragpoint-bottom"),n.setAttribute("data-p-datatable-dragpoint-top","false"),!this.isUnstyled&&mp(n,"p-datatable-dragpoint-top")},onRowDragEnd:function(e){this.rowDragging=!1,this.draggedRowIndex=null,this.droppedRowIndex=null,e.currentTarget.draggable=!1},onRowDrop:function(e){if(this.droppedRowIndex!=null){var n=this.draggedRowIndex>this.droppedRowIndex?this.droppedRowIndex:this.droppedRowIndex===0?0:this.droppedRowIndex-1,r=zs(this.processedData);ID(r,this.draggedRowIndex+this.d_first,n+this.d_first),this.$emit("row-reorder",{originalEvent:e,dragIndex:this.draggedRowIndex,dropIndex:n,value:r})}this.onRowDragLeave(e),this.onRowDragEnd(e),e.preventDefault()},toggleRow:function(e){var n=this,r=e.expanded,c=zae(e,Lae),u=e.data,p;if(this.dataKey){var o=eo(u,this.dataKey);p=this.expandedRows?Pc({},this.expandedRows):{},r?p[o]=!0:delete p[o]}else p=this.expandedRows?zs(this.expandedRows):[],r?p.push(u):p=p.filter(function(w){return!n.equals(u,w)});this.$emit("update:expandedRows",p),r?this.$emit("row-expand",c):this.$emit("row-collapse",c)},toggleRowGroup:function(e){var n=e.originalEvent,r=e.data,c=eo(r,this.groupRowsBy),u=this.expandedRowGroups?zs(this.expandedRowGroups):[];this.isRowGroupExpanded(r)?(u=u.filter(function(p){return p!==c}),this.$emit("update:expandedRowGroups",u),this.$emit("rowgroup-collapse",{originalEvent:n,data:c})):(u.push(c),this.$emit("update:expandedRowGroups",u),this.$emit("rowgroup-expand",{originalEvent:n,data:c}))},isRowGroupExpanded:function(e){if(this.expandableRowGroups&&this.expandedRowGroups){var n=eo(e,this.groupRowsBy);return this.expandedRowGroups.indexOf(n)>-1}return!1},isStateful:function(){return this.stateKey!=null},getStorage:function(){switch(this.stateStorage){case"local":return window.localStorage;case"session":return window.sessionStorage;default:throw new Error(this.stateStorage+' is not a valid value for the state storage, supported values are "local" and "session".')}},saveState:function(){var e=this.getStorage(),n={};this.paginator&&(n.first=this.d_first,n.rows=this.d_rows),this.d_sortField&&(typeof this.d_sortField!="function"&&(n.sortField=this.d_sortField),n.sortOrder=this.d_sortOrder),this.d_multiSortMeta&&(n.multiSortMeta=this.d_multiSortMeta),this.hasFilters&&(n.filters=this.filters),this.resizableColumns&&this.saveColumnWidths(n),this.reorderableColumns&&(n.columnOrder=this.d_columnOrder),this.expandedRows&&(n.expandedRows=this.expandedRows),this.expandedRowGroups&&(n.expandedRowGroups=this.expandedRowGroups),this.selection&&(n.selection=this.selection,n.selectionKeys=this.d_selectionKeys),Object.keys(n).length&&e.setItem(this.stateKey,JSON.stringify(n)),this.$emit("state-save",n)},restoreState:function(){var e=this.getStorage(),n=e.getItem(this.stateKey),r=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/,c=function(w,T){return typeof T=="string"&&r.test(T)?new Date(T):T},u;try{u=JSON.parse(n,c)}catch{}if(!u||eh(u)!=="object"){e.removeItem(this.stateKey);return}var p={};this.paginator&&(typeof u.first=="number"&&(this.d_first=u.first,this.$emit("update:first",this.d_first),p.first=this.d_first),typeof u.rows=="number"&&(this.d_rows=u.rows,this.$emit("update:rows",this.d_rows),p.rows=this.d_rows)),typeof u.sortField=="string"&&(this.d_sortField=u.sortField,this.$emit("update:sortField",this.d_sortField),p.sortField=this.d_sortField),typeof u.sortOrder=="number"&&(this.d_sortOrder=u.sortOrder,this.$emit("update:sortOrder",this.d_sortOrder),p.sortOrder=this.d_sortOrder),Array.isArray(u.multiSortMeta)&&(this.d_multiSortMeta=u.multiSortMeta,this.$emit("update:multiSortMeta",this.d_multiSortMeta),p.multiSortMeta=this.d_multiSortMeta),this.hasFilters&&eh(u.filters)==="object"&&u.filters!==null&&(this.d_filters=this.cloneFilters(u.filters),this.$emit("update:filters",this.d_filters),p.filters=this.d_filters),this.resizableColumns&&(typeof u.columnWidths=="string"&&(this.columnWidthsState=u.columnWidths,p.columnWidths=this.columnWidthsState),typeof u.tableWidth=="string"&&(this.tableWidthState=u.tableWidth,p.tableWidth=this.tableWidthState)),this.reorderableColumns&&Array.isArray(u.columnOrder)&&(this.d_columnOrder=u.columnOrder,p.columnOrder=this.d_columnOrder),eh(u.expandedRows)==="object"&&u.expandedRows!==null&&(this.$emit("update:expandedRows",u.expandedRows),p.expandedRows=u.expandedRows),Array.isArray(u.expandedRowGroups)&&(this.$emit("update:expandedRowGroups",u.expandedRowGroups),p.expandedRowGroups=u.expandedRowGroups),eh(u.selection)==="object"&&u.selection!==null&&(eh(u.selectionKeys)==="object"&&u.selectionKeys!==null&&(this.d_selectionKeys=u.selectionKeys,p.selectionKeys=this.d_selectionKeys),this.$emit("update:selection",u.selection),p.selection=u.selection),this.$emit("state-restore",p)},saveColumnWidths:function(e){var n=[],r=I_(this.$el,'thead[data-pc-section="thead"] > tr > th');r.forEach(function(c){return n.push(dc(c))}),e.columnWidths=n.join(","),this.columnResizeMode==="expand"&&(e.tableWidth=dc(this.$refs.table)+"px")},addColumnWidthStyles:function(e){this.createStyleElement();var n="",r='[data-pc-name="datatable"]['.concat(this.$attrSelector,'] > [data-pc-section="tablecontainer"] ').concat(this.virtualScrollerDisabled?"":'> [data-pc-name="virtualscroller"]',' > table[data-pc-section="table"]');e.forEach(function(c,u){var p="width: ".concat(c,"px !important; max-width: ").concat(c,"px !important");n+=`
        `.concat(r,' > thead[data-pc-section="thead"] > tr > th:nth-child(').concat(u+1,`),
        `).concat(r,' > tbody[data-pc-section="tbody"] > tr > td:nth-child(').concat(u+1,`),
        `).concat(r,' > tfoot[data-pc-section="tfoot"] > tr > td:nth-child(').concat(u+1,`) {
            `).concat(p,`
        }
    `)}),this.styleElement.innerHTML=n},restoreColumnWidths:function(){if(this.columnWidthsState){var e=this.columnWidthsState.split(",");this.columnResizeMode==="expand"&&this.tableWidthState&&(this.$refs.table.style.width=this.tableWidthState,this.$refs.table.style.minWidth=this.tableWidthState),xr(e)&&this.addColumnWidthStyles(e)}},onCellEditInit:function(e){this.$emit("cell-edit-init",e)},onCellEditComplete:function(e){this.$emit("cell-edit-complete",e)},onCellEditCancel:function(e){this.$emit("cell-edit-cancel",e)},onRowEditInit:function(e){var n=this.editingRows?zs(this.editingRows):[];n.push(e.data),this.$emit("update:editingRows",n),this.$emit("row-edit-init",e)},onRowEditSave:function(e){var n=zs(this.editingRows);n.splice(this.findIndex(e.data,n),1),this.$emit("update:editingRows",n),this.$emit("row-edit-save",e)},onRowEditCancel:function(e){var n=zs(this.editingRows);n.splice(this.findIndex(e.data,n),1),this.$emit("update:editingRows",n),this.$emit("row-edit-cancel",e)},onEditingMetaChange:function(e){var n=e.data,r=e.field,c=e.index,u=e.editing,p=Pc({},this.d_editingMeta),o=p[c];if(u)!o&&(o=p[c]={data:Pc({},n),fields:[]}),o.fields.push(r);else if(o){var w=o.fields.filter(function(T){return T!==r});w.length?o.fields=w:delete p[c]}this.d_editingMeta=p},clearEditingMetaData:function(){this.editMode&&(this.d_editingMeta={})},createLazyLoadEvent:function(e){return{originalEvent:e,first:this.d_first,rows:this.d_rows,sortField:this.d_sortField,sortOrder:this.d_sortOrder,multiSortMeta:this.d_multiSortMeta,filters:this.d_filters}},hasGlobalFilter:function(){return this.filters&&Object.prototype.hasOwnProperty.call(this.filters,"global")},onFilterChange:function(e){this.d_filters=e},onFilterApply:function(){this.d_first=0,this.$emit("update:first",this.d_first),this.$emit("update:filters",this.d_filters),this.lazy&&this.$emit("filter",this.createLazyLoadEvent())},cloneFilters:function(e){var n={};return e&&Object.entries(e).forEach(function(r){var c=J3(r,2),u=c[0],p=c[1];n[u]=p.operator?{operator:p.operator,constraints:p.constraints.map(function(o){return Pc({},o)})}:Pc({},p)}),n},updateReorderableColumns:function(){var e=this,n=[];this.columns.forEach(function(r){return n.push(e.columnProp(r,"columnKey")||e.columnProp(r,"field"))}),this.d_columnOrder=n},createStyleElement:function(){var e;this.styleElement=document.createElement("style"),this.styleElement.type="text/css",hI(this.styleElement,"nonce",(e=this.$primevue)===null||e===void 0||(e=e.config)===null||e===void 0||(e=e.csp)===null||e===void 0?void 0:e.nonce),document.head.appendChild(this.styleElement)},destroyStyleElement:function(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)},dataToRender:function(e){var n=e||this.processedData;if(n&&this.paginator){var r=this.lazy?0:this.d_first;return n.slice(r,r+this.d_rows)}return n},getVirtualScrollerRef:function(){return this.$refs.virtualScroller},hasSpacerStyle:function(e){return xr(e)}},computed:{columns:function(){var e=this.d_columns.get(this);if(e&&this.reorderableColumns&&this.d_columnOrder){var n=[],r=Fv(this.d_columnOrder),c;try{for(r.s();!(c=r.n()).done;){var u=c.value,p=this.findColumnByKey(e,u);p&&!this.columnProp(p,"hidden")&&n.push(p)}}catch(o){r.e(o)}finally{r.f()}return[].concat(n,zs(e.filter(function(o){return n.indexOf(o)<0})))}return e},columnGroups:function(){return this.d_columnGroups.get(this)},headerColumnGroup:function(){var e,n=this;return(e=this.columnGroups)===null||e===void 0?void 0:e.find(function(r){return n.columnProp(r,"type")==="header"})},footerColumnGroup:function(){var e,n=this;return(e=this.columnGroups)===null||e===void 0?void 0:e.find(function(r){return n.columnProp(r,"type")==="footer"})},hasFilters:function(){return this.filters&&Object.keys(this.filters).length>0&&this.filters.constructor===Object},processedData:function(){var e,n=this.value||[];return!this.lazy&&!((e=this.virtualScrollerOptions)!==null&&e!==void 0&&e.lazy)&&n&&n.length&&(this.hasFilters&&(n=this.filter(n)),this.sorted&&(this.sortMode==="single"?n=this.sortSingle(n):this.sortMode==="multiple"&&(n=this.sortMultiple(n)))),n},totalRecordsLength:function(){if(this.lazy)return this.totalRecords;var e=this.processedData;return e?e.length:0},empty:function(){var e=this.processedData;return!e||e.length===0},paginatorTop:function(){return this.paginator&&(this.paginatorPosition!=="bottom"||this.paginatorPosition==="both")},paginatorBottom:function(){return this.paginator&&(this.paginatorPosition!=="top"||this.paginatorPosition==="both")},sorted:function(){return this.d_sortField||this.d_multiSortMeta&&this.d_multiSortMeta.length>0},allRowsSelected:function(){var e=this;if(this.selectAll!==null)return this.selectAll;var n=this.frozenValue?[].concat(zs(this.frozenValue),zs(this.processedData)):this.processedData;return xr(n)&&this.selection&&Array.isArray(this.selection)&&n.every(function(r){return e.selection.some(function(c){return e.equals(c,r)})})},groupRowSortField:function(){return this.sortMode==="single"?this.sortField:this.d_groupRowsSortMeta?this.d_groupRowsSortMeta.field:null},headerFilterButtonProps:function(){return Pc(Pc({filter:{severity:"secondary",text:!0,rounded:!0}},this.filterButtonProps),{},{inline:Pc({clear:{severity:"secondary",text:!0,rounded:!0}},this.filterButtonProps.inline),popover:Pc({addRule:{severity:"info",text:!0,size:"small"},removeRule:{severity:"danger",text:!0,size:"small"},apply:{size:"small"},clear:{outlined:!0,size:"small"}},this.filterButtonProps.popover)})},rowEditButtonProps:function(){return Pc(Pc({},{init:{severity:"secondary",text:!0,rounded:!0},save:{severity:"secondary",text:!0,rounded:!0},cancel:{severity:"secondary",text:!0,rounded:!0}}),this.editButtonProps)},virtualScrollerDisabled:function(){return xu(this.virtualScrollerOptions)||!this.scrollable},dataP:function(){return Ka({scrollable:this.scrollable,"flex-scrollable":this.scrollable&&this.scrollHeight==="flex"})}},components:{DTPaginator:LB,DTTableHeader:eF,DTTableBody:KB,DTTableFooter:YB,DTVirtualScroller:yI,ArrowDownIcon:dB,ArrowUpIcon:hB,SpinnerIcon:A0}};function d0(t){"@babel/helpers - typeof";return d0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d0(t)}function Q3(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),n.push.apply(n,r)}return n}function eO(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Q3(Object(n),!0).forEach(function(r){qae(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Q3(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function qae(t,e,n){return(e=Zae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zae(t){var e=Kae(t,"string");return d0(e)=="symbol"?e:e+""}function Kae(t,e){if(d0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(d0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Xae=["data-p"],Yae=["data-p"];function Jae(t,e,n,r,c,u){var p=Ai("SpinnerIcon"),o=Ai("DTPaginator"),w=Ai("DTTableHeader"),T=Ai("DTTableBody"),A=Ai("DTTableFooter"),D=Ai("DTVirtualScroller");return We(),wt("div",ft({class:t.cx("root"),"data-scrollselectors":".p-datatable-wrapper","data-p":u.dataP},t.ptmi("root")),[Ti(t.$slots,"default"),t.loading?(We(),wt("div",ft({key:0,class:t.cx("mask")},t.ptm("mask")),[t.$slots.loading?Ti(t.$slots,"loading",{key:0}):(We(),wt(Mi,{key:1},[t.$slots.loadingicon?(We(),Sn(lr(t.$slots.loadingicon),{key:0,class:pr(t.cx("loadingIcon"))},null,8,["class"])):t.loadingIcon?(We(),wt("i",ft({key:1,class:[t.cx("loadingIcon"),"pi-spin",t.loadingIcon]},t.ptm("loadingIcon")),null,16)):(We(),Sn(p,ft({key:2,spin:"",class:t.cx("loadingIcon")},t.ptm("loadingIcon")),null,16,["class"]))],64))],16)):Zn("",!0),t.$slots.header?(We(),wt("div",ft({key:1,class:t.cx("header")},t.ptm("header")),[Ti(t.$slots,"header")],16)):Zn("",!0),u.paginatorTop?(We(),Sn(o,{key:2,rows:c.d_rows,first:c.d_first,totalRecords:u.totalRecordsLength,pageLinkSize:t.pageLinkSize,template:t.paginatorTemplate,rowsPerPageOptions:t.rowsPerPageOptions,currentPageReportTemplate:t.currentPageReportTemplate,class:pr(t.cx("pcPaginator",{position:"top"})),onPage:e[0]||(e[0]=function(B){return u.onPage(B)}),alwaysShow:t.alwaysShowPaginator,unstyled:t.unstyled,"data-p-top":!0,pt:t.ptm("pcPaginator")},Eb({_:2},[t.$slots.paginatorcontainer?{name:"container",fn:si(function(B){return[Ti(t.$slots,"paginatorcontainer",{first:B.first,last:B.last,rows:B.rows,page:B.page,pageCount:B.pageCount,pageLinks:B.pageLinks,totalRecords:B.totalRecords,firstPageCallback:B.firstPageCallback,lastPageCallback:B.lastPageCallback,prevPageCallback:B.prevPageCallback,nextPageCallback:B.nextPageCallback,rowChangeCallback:B.rowChangeCallback,changePageCallback:B.changePageCallback})]}),key:"0"}:void 0,t.$slots.paginatorstart?{name:"start",fn:si(function(){return[Ti(t.$slots,"paginatorstart")]}),key:"1"}:void 0,t.$slots.paginatorend?{name:"end",fn:si(function(){return[Ti(t.$slots,"paginatorend")]}),key:"2"}:void 0,t.$slots.paginatorfirstpagelinkicon?{name:"firstpagelinkicon",fn:si(function(B){return[Ti(t.$slots,"paginatorfirstpagelinkicon",{class:pr(B.class)})]}),key:"3"}:void 0,t.$slots.paginatorprevpagelinkicon?{name:"prevpagelinkicon",fn:si(function(B){return[Ti(t.$slots,"paginatorprevpagelinkicon",{class:pr(B.class)})]}),key:"4"}:void 0,t.$slots.paginatornextpagelinkicon?{name:"nextpagelinkicon",fn:si(function(B){return[Ti(t.$slots,"paginatornextpagelinkicon",{class:pr(B.class)})]}),key:"5"}:void 0,t.$slots.paginatorlastpagelinkicon?{name:"lastpagelinkicon",fn:si(function(B){return[Ti(t.$slots,"paginatorlastpagelinkicon",{class:pr(B.class)})]}),key:"6"}:void 0,t.$slots.paginatorjumptopagedropdownicon?{name:"jumptopagedropdownicon",fn:si(function(B){return[Ti(t.$slots,"paginatorjumptopagedropdownicon",{class:pr(B.class)})]}),key:"7"}:void 0,t.$slots.paginatorrowsperpagedropdownicon?{name:"rowsperpagedropdownicon",fn:si(function(B){return[Ti(t.$slots,"paginatorrowsperpagedropdownicon",{class:pr(B.class)})]}),key:"8"}:void 0]),1032,["rows","first","totalRecords","pageLinkSize","template","rowsPerPageOptions","currentPageReportTemplate","class","alwaysShow","unstyled","pt"])):Zn("",!0),Pe("div",ft({class:t.cx("tableContainer"),style:[t.sx("tableContainer"),{maxHeight:u.virtualScrollerDisabled?t.scrollHeight:""}],"data-p":u.dataP},t.ptm("tableContainer")),[hi(D,ft({ref:"virtualScroller"},t.virtualScrollerOptions,{items:u.processedData,columns:u.columns,style:t.scrollHeight!=="flex"?{height:t.scrollHeight}:void 0,scrollHeight:t.scrollHeight!=="flex"?void 0:"100%",disabled:u.virtualScrollerDisabled,loaderDisabled:"",inline:"",autoSize:"",showSpacer:!1,pt:t.ptm("virtualScroller")}),{content:si(function(B){return[Pe("table",ft({ref:"table",role:"table",class:[t.cx("table"),t.tableClass],style:[t.tableStyle,B.spacerStyle]},eO(eO({},t.tableProps),t.ptm("table"))),[t.showHeaders?(We(),Sn(w,{key:0,columnGroup:u.headerColumnGroup,columns:B.columns,rowGroupMode:t.rowGroupMode,groupRowsBy:t.groupRowsBy,groupRowSortField:u.groupRowSortField,reorderableColumns:t.reorderableColumns,resizableColumns:t.resizableColumns,allRowsSelected:u.allRowsSelected,empty:u.empty,sortMode:t.sortMode,sortField:c.d_sortField,sortOrder:c.d_sortOrder,multiSortMeta:c.d_multiSortMeta,filters:c.d_filters,filtersStore:t.filters,filterDisplay:t.filterDisplay,filterButtonProps:u.headerFilterButtonProps,filterInputProps:t.filterInputProps,first:c.d_first,onColumnClick:e[1]||(e[1]=function(N){return u.onColumnHeaderClick(N)}),onColumnMousedown:e[2]||(e[2]=function(N){return u.onColumnHeaderMouseDown(N)}),onFilterChange:u.onFilterChange,onFilterApply:u.onFilterApply,onColumnDragstart:e[3]||(e[3]=function(N){return u.onColumnHeaderDragStart(N)}),onColumnDragover:e[4]||(e[4]=function(N){return u.onColumnHeaderDragOver(N)}),onColumnDragleave:e[5]||(e[5]=function(N){return u.onColumnHeaderDragLeave(N)}),onColumnDrop:e[6]||(e[6]=function(N){return u.onColumnHeaderDrop(N)}),onColumnResizestart:e[7]||(e[7]=function(N){return u.onColumnResizeStart(N)}),onCheckboxChange:e[8]||(e[8]=function(N){return u.toggleRowsWithCheckbox(N)}),unstyled:t.unstyled,pt:t.pt},null,8,["columnGroup","columns","rowGroupMode","groupRowsBy","groupRowSortField","reorderableColumns","resizableColumns","allRowsSelected","empty","sortMode","sortField","sortOrder","multiSortMeta","filters","filtersStore","filterDisplay","filterButtonProps","filterInputProps","first","onFilterChange","onFilterApply","unstyled","pt"])):Zn("",!0),t.frozenValue?(We(),Sn(T,{key:1,ref:"frozenBodyRef",value:t.frozenValue,frozenRow:!0,columns:B.columns,first:c.d_first,dataKey:t.dataKey,selection:t.selection,selectionKeys:c.d_selectionKeys,selectionMode:t.selectionMode,rowHover:t.rowHover,contextMenu:t.contextMenu,contextMenuSelection:t.contextMenuSelection,rowGroupMode:t.rowGroupMode,groupRowsBy:t.groupRowsBy,expandableRowGroups:t.expandableRowGroups,rowClass:t.rowClass,rowStyle:t.rowStyle,editMode:t.editMode,compareSelectionBy:t.compareSelectionBy,scrollable:t.scrollable,expandedRowIcon:t.expandedRowIcon,collapsedRowIcon:t.collapsedRowIcon,expandedRows:t.expandedRows,expandedRowGroups:t.expandedRowGroups,editingRows:t.editingRows,editingRowKeys:c.d_editingRowKeys,templates:t.$slots,editButtonProps:u.rowEditButtonProps,isVirtualScrollerDisabled:!0,onRowgroupToggle:u.toggleRowGroup,onRowClick:e[9]||(e[9]=function(N){return u.onRowClick(N)}),onRowDblclick:e[10]||(e[10]=function(N){return u.onRowDblClick(N)}),onRowRightclick:e[11]||(e[11]=function(N){return u.onRowRightClick(N)}),onRowTouchend:u.onRowTouchEnd,onRowKeydown:u.onRowKeyDown,onRowMousedown:u.onRowMouseDown,onRowDragstart:e[12]||(e[12]=function(N){return u.onRowDragStart(N)}),onRowDragover:e[13]||(e[13]=function(N){return u.onRowDragOver(N)}),onRowDragleave:e[14]||(e[14]=function(N){return u.onRowDragLeave(N)}),onRowDragend:e[15]||(e[15]=function(N){return u.onRowDragEnd(N)}),onRowDrop:e[16]||(e[16]=function(N){return u.onRowDrop(N)}),onRowToggle:e[17]||(e[17]=function(N){return u.toggleRow(N)}),onRadioChange:e[18]||(e[18]=function(N){return u.toggleRowWithRadio(N)}),onCheckboxChange:e[19]||(e[19]=function(N){return u.toggleRowWithCheckbox(N)}),onCellEditInit:e[20]||(e[20]=function(N){return u.onCellEditInit(N)}),onCellEditComplete:e[21]||(e[21]=function(N){return u.onCellEditComplete(N)}),onCellEditCancel:e[22]||(e[22]=function(N){return u.onCellEditCancel(N)}),onRowEditInit:e[23]||(e[23]=function(N){return u.onRowEditInit(N)}),onRowEditSave:e[24]||(e[24]=function(N){return u.onRowEditSave(N)}),onRowEditCancel:e[25]||(e[25]=function(N){return u.onRowEditCancel(N)}),editingMeta:c.d_editingMeta,onEditingMetaChange:u.onEditingMetaChange,unstyled:t.unstyled,pt:t.pt},null,8,["value","columns","first","dataKey","selection","selectionKeys","selectionMode","rowHover","contextMenu","contextMenuSelection","rowGroupMode","groupRowsBy","expandableRowGroups","rowClass","rowStyle","editMode","compareSelectionBy","scrollable","expandedRowIcon","collapsedRowIcon","expandedRows","expandedRowGroups","editingRows","editingRowKeys","templates","editButtonProps","onRowgroupToggle","onRowTouchend","onRowKeydown","onRowMousedown","editingMeta","onEditingMetaChange","unstyled","pt"])):Zn("",!0),hi(T,{ref:"bodyRef",value:u.dataToRender(B.rows),class:pr(B.styleClass),columns:B.columns,empty:u.empty,first:c.d_first,dataKey:t.dataKey,selection:t.selection,selectionKeys:c.d_selectionKeys,selectionMode:t.selectionMode,rowHover:t.rowHover,contextMenu:t.contextMenu,contextMenuSelection:t.contextMenuSelection,rowGroupMode:t.rowGroupMode,groupRowsBy:t.groupRowsBy,expandableRowGroups:t.expandableRowGroups,rowClass:t.rowClass,rowStyle:t.rowStyle,editMode:t.editMode,compareSelectionBy:t.compareSelectionBy,scrollable:t.scrollable,expandedRowIcon:t.expandedRowIcon,collapsedRowIcon:t.collapsedRowIcon,expandedRows:t.expandedRows,expandedRowGroups:t.expandedRowGroups,editingRows:t.editingRows,editingRowKeys:c.d_editingRowKeys,templates:t.$slots,editButtonProps:u.rowEditButtonProps,virtualScrollerContentProps:B,isVirtualScrollerDisabled:u.virtualScrollerDisabled,onRowgroupToggle:u.toggleRowGroup,onRowClick:e[26]||(e[26]=function(N){return u.onRowClick(N)}),onRowDblclick:e[27]||(e[27]=function(N){return u.onRowDblClick(N)}),onRowRightclick:e[28]||(e[28]=function(N){return u.onRowRightClick(N)}),onRowTouchend:u.onRowTouchEnd,onRowKeydown:function(ee){return u.onRowKeyDown(ee,B)},onRowMousedown:u.onRowMouseDown,onRowDragstart:e[29]||(e[29]=function(N){return u.onRowDragStart(N)}),onRowDragover:e[30]||(e[30]=function(N){return u.onRowDragOver(N)}),onRowDragleave:e[31]||(e[31]=function(N){return u.onRowDragLeave(N)}),onRowDragend:e[32]||(e[32]=function(N){return u.onRowDragEnd(N)}),onRowDrop:e[33]||(e[33]=function(N){return u.onRowDrop(N)}),onRowToggle:e[34]||(e[34]=function(N){return u.toggleRow(N)}),onRadioChange:e[35]||(e[35]=function(N){return u.toggleRowWithRadio(N)}),onCheckboxChange:e[36]||(e[36]=function(N){return u.toggleRowWithCheckbox(N)}),onCellEditInit:e[37]||(e[37]=function(N){return u.onCellEditInit(N)}),onCellEditComplete:e[38]||(e[38]=function(N){return u.onCellEditComplete(N)}),onCellEditCancel:e[39]||(e[39]=function(N){return u.onCellEditCancel(N)}),onRowEditInit:e[40]||(e[40]=function(N){return u.onRowEditInit(N)}),onRowEditSave:e[41]||(e[41]=function(N){return u.onRowEditSave(N)}),onRowEditCancel:e[42]||(e[42]=function(N){return u.onRowEditCancel(N)}),editingMeta:c.d_editingMeta,onEditingMetaChange:u.onEditingMetaChange,unstyled:t.unstyled,pt:t.pt},null,8,["value","class","columns","empty","first","dataKey","selection","selectionKeys","selectionMode","rowHover","contextMenu","contextMenuSelection","rowGroupMode","groupRowsBy","expandableRowGroups","rowClass","rowStyle","editMode","compareSelectionBy","scrollable","expandedRowIcon","collapsedRowIcon","expandedRows","expandedRowGroups","editingRows","editingRowKeys","templates","editButtonProps","virtualScrollerContentProps","isVirtualScrollerDisabled","onRowgroupToggle","onRowTouchend","onRowKeydown","onRowMousedown","editingMeta","onEditingMetaChange","unstyled","pt"]),u.hasSpacerStyle(B.spacerStyle)?(We(),wt("tbody",ft({key:2,class:t.cx("virtualScrollerSpacer"),style:{height:"calc(".concat(B.spacerStyle.height," - ").concat(B.rows.length*B.itemSize,"px)")}},t.ptm("virtualScrollerSpacer")),null,16)):Zn("",!0),hi(A,{columnGroup:u.footerColumnGroup,columns:B.columns,pt:t.pt},null,8,["columnGroup","columns","pt"])],16)]}),_:1},16,["items","columns","style","scrollHeight","disabled","pt"])],16,Yae),u.paginatorBottom?(We(),Sn(o,{key:3,rows:c.d_rows,first:c.d_first,totalRecords:u.totalRecordsLength,pageLinkSize:t.pageLinkSize,template:t.paginatorTemplate,rowsPerPageOptions:t.rowsPerPageOptions,currentPageReportTemplate:t.currentPageReportTemplate,class:pr(t.cx("pcPaginator",{position:"bottom"})),onPage:e[43]||(e[43]=function(B){return u.onPage(B)}),alwaysShow:t.alwaysShowPaginator,unstyled:t.unstyled,"data-p-bottom":!0,pt:t.ptm("pcPaginator")},Eb({_:2},[t.$slots.paginatorcontainer?{name:"container",fn:si(function(B){return[Ti(t.$slots,"paginatorcontainer",{first:B.first,last:B.last,rows:B.rows,page:B.page,pageCount:B.pageCount,pageLinks:B.pageLinks,totalRecords:B.totalRecords,firstPageCallback:B.firstPageCallback,lastPageCallback:B.lastPageCallback,prevPageCallback:B.prevPageCallback,nextPageCallback:B.nextPageCallback,rowChangeCallback:B.rowChangeCallback,changePageCallback:B.changePageCallback})]}),key:"0"}:void 0,t.$slots.paginatorstart?{name:"start",fn:si(function(){return[Ti(t.$slots,"paginatorstart")]}),key:"1"}:void 0,t.$slots.paginatorend?{name:"end",fn:si(function(){return[Ti(t.$slots,"paginatorend")]}),key:"2"}:void 0,t.$slots.paginatorfirstpagelinkicon?{name:"firstpagelinkicon",fn:si(function(B){return[Ti(t.$slots,"paginatorfirstpagelinkicon",{class:pr(B.class)})]}),key:"3"}:void 0,t.$slots.paginatorprevpagelinkicon?{name:"prevpagelinkicon",fn:si(function(B){return[Ti(t.$slots,"paginatorprevpagelinkicon",{class:pr(B.class)})]}),key:"4"}:void 0,t.$slots.paginatornextpagelinkicon?{name:"nextpagelinkicon",fn:si(function(B){return[Ti(t.$slots,"paginatornextpagelinkicon",{class:pr(B.class)})]}),key:"5"}:void 0,t.$slots.paginatorlastpagelinkicon?{name:"lastpagelinkicon",fn:si(function(B){return[Ti(t.$slots,"paginatorlastpagelinkicon",{class:pr(B.class)})]}),key:"6"}:void 0,t.$slots.paginatorjumptopagedropdownicon?{name:"jumptopagedropdownicon",fn:si(function(B){return[Ti(t.$slots,"paginatorjumptopagedropdownicon",{class:pr(B.class)})]}),key:"7"}:void 0,t.$slots.paginatorrowsperpagedropdownicon?{name:"rowsperpagedropdownicon",fn:si(function(B){return[Ti(t.$slots,"paginatorrowsperpagedropdownicon",{class:pr(B.class)})]}),key:"8"}:void 0]),1032,["rows","first","totalRecords","pageLinkSize","template","rowsPerPageOptions","currentPageReportTemplate","class","alwaysShow","unstyled","pt"])):Zn("",!0),t.$slots.footer?(We(),wt("div",ft({key:4,class:t.cx("footer")},t.ptm("footer")),[Ti(t.$slots,"footer")],16)):Zn("",!0),Pe("div",ft({ref:"resizeHelper",class:t.cx("columnResizeIndicator"),style:{display:"none"}},t.ptm("columnResizeIndicator")),null,16),t.reorderableColumns?(We(),wt("span",ft({key:5,ref:"reorderIndicatorUp",class:t.cx("rowReorderIndicatorUp"),style:{position:"absolute",display:"none"}},t.ptm("rowReorderIndicatorUp")),[(We(),Sn(lr(t.$slots.rowreorderindicatorupicon||t.$slots.reorderindicatorupicon||"ArrowDownIcon")))],16)):Zn("",!0),t.reorderableColumns?(We(),wt("span",ft({key:6,ref:"reorderIndicatorDown",class:t.cx("rowReorderIndicatorDown"),style:{position:"absolute",display:"none"}},t.ptm("rowReorderIndicatorDown")),[(We(),Sn(lr(t.$slots.rowreorderindicatordownicon||t.$slots.reorderindicatordownicon||"ArrowUpIcon")))],16)):Zn("",!0)],16,Xae)}RS.render=Jae;var Qae=Kr.extend({name:"column"}),ele={name:"BaseColumn",extends:Lo,props:{columnKey:{type:null,default:null},field:{type:[String,Function],default:null},sortField:{type:[String,Function],default:null},filterField:{type:[String,Function],default:null},dataType:{type:String,default:"text"},sortable:{type:Boolean,default:!1},header:{type:null,default:null},footer:{type:null,default:null},style:{type:null,default:null},class:{type:String,default:null},headerStyle:{type:null,default:null},headerClass:{type:String,default:null},bodyStyle:{type:null,default:null},bodyClass:{type:String,default:null},footerStyle:{type:null,default:null},footerClass:{type:String,default:null},showFilterMenu:{type:Boolean,default:!0},showFilterOperator:{type:Boolean,default:!0},showClearButton:{type:Boolean,default:!1},showApplyButton:{type:Boolean,default:!0},showFilterMatchModes:{type:Boolean,default:!0},showAddButton:{type:Boolean,default:!0},filterMatchModeOptions:{type:Array,default:null},maxConstraints:{type:Number,default:2},excludeGlobalFilter:{type:Boolean,default:!1},filterHeaderClass:{type:String,default:null},filterHeaderStyle:{type:null,default:null},filterMenuClass:{type:String,default:null},filterMenuStyle:{type:null,default:null},selectionMode:{type:String,default:null},expander:{type:Boolean,default:!1},colspan:{type:Number,default:null},rowspan:{type:Number,default:null},rowReorder:{type:Boolean,default:!1},rowReorderIcon:{type:String,default:void 0},reorderableColumn:{type:Boolean,default:!0},rowEditor:{type:Boolean,default:!1},frozen:{type:Boolean,default:!1},alignFrozen:{type:String,default:"left"},exportable:{type:Boolean,default:!0},exportHeader:{type:String,default:null},exportFooter:{type:String,default:null},filterMatchMode:{type:String,default:null},hidden:{type:Boolean,default:!1}},style:Qae,provide:function(){return{$pcColumn:this,$parentInstance:this}}},$l={name:"Column",extends:ele,inheritAttrs:!1,inject:["$columns"],mounted:function(){var e;(e=this.$columns)===null||e===void 0||e.add(this.$)},unmounted:function(){var e;(e=this.$columns)===null||e===void 0||e.delete(this.$)},render:function(){return null}},tF={name:"BanIcon",extends:qo};function tle(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{d:"M7 0C5.61553 0 4.26215 0.410543 3.11101 1.17971C1.95987 1.94888 1.06266 3.04213 0.532846 4.32122C0.00303296 5.6003 -0.13559 7.00776 0.134506 8.36563C0.404603 9.7235 1.07129 10.9708 2.05026 11.9497C3.02922 12.9287 4.2765 13.5954 5.63437 13.8655C6.99224 14.1356 8.3997 13.997 9.67879 13.4672C10.9579 12.9373 12.0511 12.0401 12.8203 10.889C13.5895 9.73785 14 8.38447 14 7C14 5.14348 13.2625 3.36301 11.9497 2.05025C10.637 0.737498 8.85652 0 7 0ZM1.16667 7C1.16549 5.65478 1.63303 4.35118 2.48889 3.31333L10.6867 11.5111C9.83309 12.2112 8.79816 12.6544 7.70243 12.789C6.60669 12.9236 5.49527 12.744 4.49764 12.2713C3.50001 11.7986 2.65724 11.0521 2.06751 10.1188C1.47778 9.18558 1.16537 8.10397 1.16667 7ZM11.5111 10.6867L3.31334 2.48889C4.43144 1.57388 5.84966 1.10701 7.29265 1.1789C8.73565 1.2508 10.1004 1.85633 11.1221 2.87795C12.1437 3.89956 12.7492 5.26435 12.8211 6.70735C12.893 8.15034 12.4261 9.56856 11.5111 10.6867Z",fill:"currentColor"},null,-1)]),16)}tF.render=tle;var nF={name:"StarIcon",extends:qo};function nle(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{d:"M10.9741 13.6721C10.8806 13.6719 10.7886 13.6483 10.7066 13.6033L7.00002 11.6545L3.29345 13.6033C3.19926 13.6539 3.09281 13.6771 2.98612 13.6703C2.87943 13.6636 2.77676 13.6271 2.6897 13.5651C2.60277 13.5014 2.53529 13.4147 2.4948 13.3148C2.45431 13.215 2.44241 13.1058 2.46042 12.9995L3.17881 8.87264L0.167699 5.95324C0.0922333 5.8777 0.039368 5.78258 0.0150625 5.67861C-0.00924303 5.57463 -0.00402231 5.46594 0.030136 5.36477C0.0621323 5.26323 0.122141 5.17278 0.203259 5.10383C0.284377 5.03488 0.383311 4.99023 0.488681 4.97501L4.63087 4.37126L6.48797 0.618832C6.54083 0.530159 6.61581 0.456732 6.70556 0.405741C6.79532 0.35475 6.89678 0.327942 7.00002 0.327942C7.10325 0.327942 7.20471 0.35475 7.29447 0.405741C7.38422 0.456732 7.4592 0.530159 7.51206 0.618832L9.36916 4.37126L13.5114 4.97501C13.6167 4.99023 13.7157 5.03488 13.7968 5.10383C13.8779 5.17278 13.9379 5.26323 13.9699 5.36477C14.0041 5.46594 14.0093 5.57463 13.985 5.67861C13.9607 5.78258 13.9078 5.8777 13.8323 5.95324L10.8212 8.87264L11.532 12.9995C11.55 13.1058 11.5381 13.215 11.4976 13.3148C11.4571 13.4147 11.3896 13.5014 11.3027 13.5651C11.2059 13.632 11.0917 13.6692 10.9741 13.6721ZM7.00002 10.4393C7.09251 10.4404 7.18371 10.4613 7.2675 10.5005L10.2098 12.029L9.65193 8.75036C9.6368 8.6584 9.64343 8.56418 9.6713 8.47526C9.69918 8.38633 9.74751 8.30518 9.81242 8.23832L12.1969 5.94559L8.90298 5.45648C8.81188 5.44198 8.72555 5.406 8.65113 5.35152C8.57671 5.29703 8.51633 5.2256 8.475 5.14314L7.00002 2.1626L5.52503 5.15078C5.4837 5.23324 5.42332 5.30467 5.3489 5.35916C5.27448 5.41365 5.18815 5.44963 5.09705 5.46412L1.80318 5.94559L4.18761 8.23832C4.25252 8.30518 4.30085 8.38633 4.32873 8.47526C4.3566 8.56418 4.36323 8.6584 4.3481 8.75036L3.7902 12.0519L6.73253 10.5234C6.81451 10.4762 6.9058 10.4475 7.00002 10.4393Z",fill:"currentColor"},null,-1)]),16)}nF.render=nle;var iF={name:"StarFillIcon",extends:qo};function ile(t,e,n,r,c,u){return We(),wt("svg",ft({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),e[0]||(e[0]=[Pe("path",{d:"M13.9718 5.36453C13.9398 5.26298 13.8798 5.17252 13.7986 5.10356C13.7175 5.0346 13.6186 4.98994 13.5132 4.97472L9.37043 4.37088L7.51307 0.617955C7.46021 0.529271 7.38522 0.455834 7.29545 0.404836C7.20568 0.353838 7.1042 0.327026 7.00096 0.327026C6.89771 0.327026 6.79624 0.353838 6.70647 0.404836C6.6167 0.455834 6.54171 0.529271 6.48885 0.617955L4.63149 4.37088L0.488746 4.97472C0.383363 4.98994 0.284416 5.0346 0.203286 5.10356C0.122157 5.17252 0.0621407 5.26298 0.03014 5.36453C-0.00402286 5.46571 -0.00924428 5.57442 0.0150645 5.67841C0.0393733 5.7824 0.0922457 5.87753 0.167722 5.95308L3.17924 8.87287L2.4684 13.0003C2.45038 13.1066 2.46229 13.2158 2.50278 13.3157C2.54328 13.4156 2.61077 13.5022 2.6977 13.5659C2.78477 13.628 2.88746 13.6644 2.99416 13.6712C3.10087 13.678 3.20733 13.6547 3.30153 13.6042L7.00096 11.6551L10.708 13.6042C10.79 13.6491 10.882 13.6728 10.9755 13.673C11.0958 13.6716 11.2129 13.6343 11.3119 13.5659C11.3988 13.5022 11.4663 13.4156 11.5068 13.3157C11.5473 13.2158 11.5592 13.1066 11.5412 13.0003L10.8227 8.87287L13.8266 5.95308C13.9033 5.87835 13.9577 5.7836 13.9833 5.67957C14.009 5.57554 14.005 5.4664 13.9718 5.36453Z",fill:"currentColor"},null,-1)]),16)}iF.render=ile;var rle=`
    .p-rating {
        position: relative;
        display: flex;
        align-items: center;
        gap: dt('rating.gap');
    }

    .p-rating-option {
        display: inline-flex;
        align-items: center;
        cursor: pointer;
        outline-color: transparent;
        border-radius: 50%;
        transition:
            background dt('rating.transition.duration'),
            color dt('rating.transition.duration'),
            border-color dt('rating.transition.duration'),
            outline-color dt('rating.transition.duration'),
            box-shadow dt('rating.transition.duration');
    }

    .p-rating-option.p-focus-visible {
        box-shadow: dt('rating.focus.ring.shadow');
        outline: dt('rating.focus.ring.width') dt('rating.focus.ring.style') dt('rating.focus.ring.color');
        outline-offset: dt('rating.focus.ring.offset');
    }

    .p-rating-icon {
        color: dt('rating.icon.color');
        transition:
            background dt('rating.transition.duration'),
            color dt('rating.transition.duration'),
            border-color dt('rating.transition.duration'),
            outline-color dt('rating.transition.duration'),
            box-shadow dt('rating.transition.duration');
        font-size: dt('rating.icon.size');
        width: dt('rating.icon.size');
        height: dt('rating.icon.size');
    }

    .p-rating:not(.p-disabled):not(.p-readonly) .p-rating-option:hover .p-rating-icon {
        color: dt('rating.icon.hover.color');
    }

    .p-rating-option-active .p-rating-icon {
        color: dt('rating.icon.active.color');
    }

    .p-rating-icon.p-invalid {
        /* @todo */
        stroke: dt('rating.invalid.icon.color');
    }

    .p-rating.p-readonly .p-rating-option {
        cursor: not-allowed;
    }
`,ole={root:function(e){var n=e.props;return["p-rating",{"p-readonly":n.readonly,"p-disabled":n.disabled}]},option:function(e){var n=e.instance,r=e.value;return["p-rating-option",{"p-rating-option-active":r<=n.d_value,"p-focus-visible":r===n.focusedOptionIndex&&n.isFocusVisibleItem}]},onIcon:function(e){var n=e.instance;return["p-rating-icon p-rating-on-icon",{"p-invalid":n.$invalid}]},offIcon:function(e){var n=e.instance;return["p-rating-icon p-rating-off-icon",{"p-invalid":n.$invalid}]}},sle=Kr.extend({name:"rating",style:rle,classes:ole}),ale={name:"BaseRating",extends:yB,props:{readonly:{type:Boolean,default:!1},stars:{type:Number,default:5},onIcon:{type:String,default:void 0},offIcon:{type:String,default:void 0}},style:sle,provide:function(){return{$pcRating:this,$parentInstance:this}}},Ew={name:"Rating",extends:ale,inheritAttrs:!1,emits:["change","focus","blur"],data:function(){return{focusedOptionIndex:-1,isFocusVisibleItem:!0}},methods:{getPTOptions:function(e,n){return this.ptm(e,{context:{active:n<=this.d_value,focused:n===this.focusedOptionIndex}})},onOptionClick:function(e,n){if(!this.readonly&&!this.disabled){this.onOptionSelect(e,n),this.isFocusVisibleItem=!1;var r=gp(e.currentTarget);r&&Nl(r)}},onFocus:function(e,n){var r;this.focusedOptionIndex=n,this.isFocusVisibleItem=((r=e.sourceCapabilities)===null||r===void 0?void 0:r.firesTouchEvents)===!1,this.$emit("focus",e)},onBlur:function(e){var n,r;this.focusedOptionIndex=-1,this.$emit("blur",e),(n=(r=this.formField).onBlur)===null||n===void 0||n.call(r)},onChange:function(e,n){this.onOptionSelect(e,n),this.isFocusVisibleItem=!0},onOptionSelect:function(e,n){this.focusedOptionIndex===n||this.d_value===n?(this.focusedOptionIndex=-1,this.updateModel(e,null)):(this.focusedOptionIndex=n,this.updateModel(e,n||null))},updateModel:function(e,n){this.writeValue(n,e),this.$emit("change",{originalEvent:e,value:n})},starAriaLabel:function(e){return e===1?this.$primevue.config.locale.aria.star:this.$primevue.config.locale.aria.stars.replace(/{star}/g,e)},dataOption:function(e){return Ka({readonly:this.readonly,disabled:this.disabled,active:e<=this.d_value,"focus-visible":e===this.focusedOptionIndex&&this.isFocusVisibleItem})}},computed:{namex:function(){return this.name||"".concat(this.$attrSelector,"_name")},dataP:function(){return Ka({readonly:this.readonly,disabled:this.disabled})}},components:{StarFillIcon:iF,StarIcon:nF,BanIcon:tF}},lle=["data-p"],cle=["onClick","data-p-active","data-p-focused","data-p"],ule=["value","name","checked","disabled","readonly","aria-label","onFocus","onChange"];function dle(t,e,n,r,c,u){return We(),wt("div",ft({class:t.cx("root")},t.ptmi("root"),{"data-p":u.dataP}),[(We(!0),wt(Mi,null,ea(t.stars,function(p){return We(),wt("div",ft({key:p,class:t.cx("option",{value:p}),onClick:function(w){return u.onOptionClick(w,p)}},{ref_for:!0},u.getPTOptions("option",p),{"data-p-active":p<=t.d_value,"data-p-focused":p===c.focusedOptionIndex,"data-p":u.dataOption(p)}),[Pe("span",ft({class:"p-hidden-accessible"},{ref_for:!0},t.ptm("hiddenOptionInputContainer"),{"data-p-hidden-accessible":!0}),[Pe("input",ft({type:"radio",value:p,name:u.namex,checked:t.d_value===p,disabled:t.disabled,readonly:t.readonly,"aria-label":u.starAriaLabel(p),onFocus:function(w){return u.onFocus(w,p)},onBlur:e[0]||(e[0]=function(){return u.onBlur&&u.onBlur.apply(u,arguments)}),onChange:function(w){return u.onChange(w,p)}},{ref_for:!0},t.ptm("hiddenOptionInput")),null,16,ule)],16),p<=t.d_value?Ti(t.$slots,"onicon",{key:0,value:p,toggleCallback:function(w){return u.onChange(w,p)},class:pr(t.cx("onIcon"))},function(){return[(We(),Sn(lr(t.onIcon?"span":"StarFillIcon"),ft({class:[t.cx("onIcon"),t.onIcon]},{ref_for:!0},t.ptm("onIcon")),null,16,["class"]))]}):Ti(t.$slots,"officon",{key:1,value:p,class:pr(t.cx("offIcon")),toggleCallback:function(w){return u.onChange(w,p)}},function(){return[(We(),Sn(lr(t.offIcon?"span":"StarIcon"),ft({class:[t.cx("offIcon"),t.offIcon]},{ref_for:!0},t.ptm("offIcon")),null,16,["class"]))]})],16,cle)}),128))],16,lle)}Ew.render=dle;function ef(t){return typeof t!="string"?"":t.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#39;")}const hle={key:0,class:"mb-4"},fle={class:"row g-2"},ple={class:"col-md-4"},mle={class:"col-md-3"},gle={class:"col-md-3"},_le={class:"col-md-2"},yle={class:"row g-2 mt-2"},vle={class:"col-md-3"},ble={class:"d-flex flex-wrap align-items-center gap-2 mb-3"},xle={class:"input-group",style:{"max-width":"420px"}},wle={class:"ms-lg-auto d-flex gap-2"},Sle={class:"table-responsive-fluid"},Cle=["onUpdate:modelValue"],Tle=["onUpdate:modelValue"],Ele=["onUpdate:modelValue"],Ile=["onUpdate:modelValue"],Ale=["onUpdate:modelValue"],kle={class:"d-flex align-items-center gap-2"},Rle={class:"d-flex justify-content-center gap-2"},Ple=["onClick","disabled","title"],Mle="https://sendregistrationemail-6rwlj53o6q-ts.a.run.app",Dle={__name:"Programs",setup(t){function e(){try{return JSON.parse(localStorage.getItem("session")||localStorage.getItem("currentUser")||"null")}catch{return null}}const n=Si(e()),r=Dc(()=>!!n.value),c=Dc(()=>{var je;const xe=(((je=n.value)==null?void 0:je.role)||"").toLowerCase();return xe==="caregiver"||xe==="admin"}),u=[{id:1,title:"Managing Anxiety",topic:"Anxiety",date:"2025-09-10",mode:"Online",seats:12,isDefault:!0},{id:2,title:"Sleep and Mindfulness",topic:"Sleep",date:"2025-09-15",mode:"In-person",seats:8,isDefault:!0},{id:3,title:"Healthy Friendships",topic:"Relationships",date:"2025-09-18",mode:"Online",seats:0,isDefault:!0}],p=Si([]),o=Si({title:"",topic:"",date:"",mode:"",seats:1});lh(()=>{let xe=[];try{const je=localStorage.getItem("programs");xe=je?JSON.parse(je):[]}catch{xe=[]}!Array.isArray(xe)||xe.length===0?(p.value=[...u],localStorage.setItem("programs",JSON.stringify(p.value))):p.value=xe}),gu(p,xe=>{try{localStorage.setItem("programs",JSON.stringify(xe))}catch{}},{deep:!0});function w(){p.value.push({id:Date.now(),title:ef(o.value.title),topic:ef(o.value.topic),date:o.value.date,mode:o.value.mode,seats:Number(o.value.seats)||1,isDefault:!1}),T()}function T(){o.value={title:"",topic:"",date:"",mode:"",seats:1}}function A(){p.value=p.value.filter(xe=>xe.isDefault===!0);try{localStorage.setItem("programs",JSON.stringify(p.value))}catch{}}async function D(xe){var je,qe,oe;if(r.value&&xe.seats>0){xe.seats-=1,alert(`You registered for: ${xe.title}`);try{const de=(((je=n.value)==null?void 0:je.email)||((oe=(qe=n.value)==null?void 0:qe.user)==null?void 0:oe.email)||"").trim();de&&await fetch(Mle,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:de,program:{title:xe.title,topic:xe.topic,date:xe.date,mode:xe.mode}})})}catch(de){console.warn("sendRegistrationEmail failed (non-blocking):",de)}}}function B(){try{return JSON.parse(localStorage.getItem("reviews")||"[]")}catch{return[]}}function N(xe){const qe=B().filter(de=>de&&Number(de.programId)===Number(xe));return qe.length?qe.reduce((de,Ee)=>de+(Number(Ee.rating??Ee.stars)||0),0)/qe.length:0}const ee=Si({global:{value:null,matchMode:"contains"},title:{value:null,matchMode:"contains"},topic:{value:null,matchMode:"contains"},date:{value:null,matchMode:"contains"},mode:{value:null,matchMode:"equals"},seats:{value:null,matchMode:"equals"}});function Q(){Object.keys(ee.value).forEach(xe=>{ee.value[xe].value=null})}function se(){const xe=["Title","Topic","Date","Mode","Seats","AvgRating"],je=p.value.map($e=>[ze($e.title),ze($e.topic),ze($e.date),ze($e.mode),String($e.seats),N($e.id).toFixed(1)]),qe=[xe,...je].map($e=>$e.map(me=>`"${String(me).replace(/"/g,'""')}"`).join(",")).join(`\r
`),oe=new Blob([qe],{type:"text/csv;charset=utf-8;"}),de=URL.createObjectURL(oe),Ee=document.createElement("a");Ee.href=de,Ee.download="programs.csv",Ee.click(),URL.revokeObjectURL(de)}function ce(){const xe=`
    <style>
      body { font-family: Arial, sans-serif; padding: 16px; }
      h1 { margin-bottom: 12px; }
      table { width: 100%; border-collapse: collapse; }
      th, td { border: 1px solid #ccc; padding: 8px; }
      th { background: #f2f2f2; text-align: left; }
    </style>
  `,je=p.value.map(de=>`
    <tr>
      <td>${be(de.title)}</td>
      <td>${be(de.topic)}</td>
      <td>${be(de.date)}</td>
      <td>${be(de.mode)}</td>
      <td>${String(de.seats)}</td>
      <td>${Number(N(de.id)).toFixed(1)}</td>
    </tr>
  `).join(""),qe=`
    <!doctype html>
    <html>
      <head>${xe}</head>
      <body onload="window.print()">
        <h1>Programs</h1>
        <table>
          <thead>
            <tr>
              <th>Title</th>
              <th>Topic</th>
              <th>Date</th>
              <th>Mode</th>
              <th>Seats</th>
              <th>Rating</th>
            </tr>
          </thead>
          <tbody>${je}</tbody>
        </table>
      </body>
    </html>
  `,oe=window.open("","_blank");oe&&(oe.document.open(),oe.document.write(qe),oe.document.close())}function be(xe=""){return String(xe).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function ze(xe=""){return String(xe??"").trim()}return(xe,je)=>{const qe=Ai("router-link");return We(),wt("div",null,[je[14]||(je[14]=Pe("h1",{class:"mb-3 text-center"},"Programs",-1)),c.value?(We(),wt("div",hle,[Pe("form",{onSubmit:df(w,["prevent"])},[Pe("div",fle,[Pe("div",ple,[Ki(Pe("input",{"onUpdate:modelValue":je[0]||(je[0]=oe=>o.value.title=oe),type:"text",class:"form-control",placeholder:"Program Title",required:""},null,512),[[to,o.value.title]])]),Pe("div",mle,[Ki(Pe("input",{"onUpdate:modelValue":je[1]||(je[1]=oe=>o.value.topic=oe),type:"text",class:"form-control",placeholder:"Topic",required:""},null,512),[[to,o.value.topic]])]),Pe("div",gle,[Ki(Pe("input",{"onUpdate:modelValue":je[2]||(je[2]=oe=>o.value.date=oe),type:"date",class:"form-control",required:""},null,512),[[to,o.value.date]])]),Pe("div",_le,[Ki(Pe("select",{"onUpdate:modelValue":je[3]||(je[3]=oe=>o.value.mode=oe),class:"form-select",required:""},[...je[8]||(je[8]=[Pe("option",{disabled:"",value:""},"Mode",-1),Pe("option",{value:"Online"},"Online",-1),Pe("option",{value:"In-person"},"In-person",-1)])],512),[[ey,o.value.mode]])])]),Pe("div",yle,[Pe("div",vle,[Ki(Pe("input",{"onUpdate:modelValue":je[4]||(je[4]=oe=>o.value.seats=oe),type:"number",class:"form-control",placeholder:"Seats",min:"1",required:""},null,512),[[to,o.value.seats,void 0,{number:!0}]])]),Pe("div",{class:"col-md-9 d-flex gap-2"},[je[9]||(je[9]=Pe("button",{type:"submit",class:"btn btn-custom"},"Add Program",-1)),Pe("button",{type:"button",class:"btn btn-custom",onClick:T},"Clear Form"),Pe("button",{type:"button",class:"btn btn-custom ms-auto",onClick:A},"Clear Programs")])])],32)])):Zn("",!0),je[15]||(je[15]=Pe("h1",{class:"mb-3 text-center"},"Upcoming Programs",-1)),Pe("div",ble,[Pe("div",xle,[je[10]||(je[10]=Pe("span",{class:"input-group-text"},"Search all",-1)),Ki(Pe("input",{"onUpdate:modelValue":je[5]||(je[5]=oe=>ee.value.global.value=oe),type:"text",class:"form-control",placeholder:"Type to search title, topic, date, mode…"},null,512),[[to,ee.value.global.value]]),Pe("button",{class:"btn btn-custom",onClick:Q},"Clear")]),Pe("div",wle,[Pe("button",{class:"btn btn-custom",onClick:je[6]||(je[6]=oe=>se())},"Export CSV"),Pe("button",{class:"btn btn-custom",onClick:je[7]||(je[7]=oe=>ce())},"Export PDF")])]),Pe("div",Sle,[hi(ss(RS),{value:p.value,paginator:"",rows:10,rowsPerPageOptions:[10,20,50],responsiveLayout:"stack",breakpoint:"992px",sortMode:"multiple",class:"p-datatable-sm shadow-sm",filters:ee.value,globalFilterFields:["title","topic","date","mode","seats"]},{empty:si(()=>[...je[13]||(je[13]=[Pe("div",{class:"py-4 text-center text-muted"}," No programs yet. Caregivers/Admins can add new programs above. ",-1)])]),default:si(()=>[hi(ss($l),{field:"title",header:"Title",sortable:"",filter:"",showFilterMenu:!1},{filter:si(({filterModel:oe})=>[Ki(Pe("input",{"onUpdate:modelValue":de=>oe.value=de,type:"text",class:"form-control",placeholder:"Search title"},null,8,Cle),[[to,oe.value]])]),_:1}),hi(ss($l),{field:"topic",header:"Topic",sortable:"",filter:"",showFilterMenu:!1},{filter:si(({filterModel:oe})=>[Ki(Pe("input",{"onUpdate:modelValue":de=>oe.value=de,type:"text",class:"form-control",placeholder:"Search topic"},null,8,Tle),[[to,oe.value]])]),_:1}),hi(ss($l),{field:"date",header:"Date",sortable:"",filter:"",showFilterMenu:!1},{filter:si(({filterModel:oe})=>[Ki(Pe("input",{"onUpdate:modelValue":de=>oe.value=de,type:"text",class:"form-control",placeholder:"yyyy-mm-dd"},null,8,Ele),[[to,oe.value]])]),_:1}),hi(ss($l),{field:"mode",header:"Mode",sortable:"",filter:"",showFilterMenu:!1},{filter:si(({filterModel:oe})=>[Ki(Pe("select",{"onUpdate:modelValue":de=>oe.value=de,class:"form-select"},[...je[11]||(je[11]=[Pe("option",{value:""},"All",-1),Pe("option",{value:"Online"},"Online",-1),Pe("option",{value:"In-person"},"In-person",-1)])],8,Ile),[[ey,oe.value]])]),_:1}),hi(ss($l),{field:"seats",header:"Seats Left",sortable:"",filter:"",showFilterMenu:!1},{filter:si(({filterModel:oe})=>[Ki(Pe("input",{"onUpdate:modelValue":de=>oe.value=de,type:"number",class:"form-control",placeholder:"e.g. 5"},null,8,Ale),[[to,oe.value]])]),_:1}),hi(ss($l),{header:"Rating"},{body:si(oe=>[Pe("div",kle,[hi(ss(Ew),{modelValue:N(oe.data.id),cancel:!1,readonly:""},null,8,["modelValue"]),Pe("small",null,"("+wr(N(oe.data.id).toFixed(1))+")",1)])]),_:1}),hi(ss($l),{header:"Action",bodyClass:"text-center"},{body:si(oe=>[Pe("div",Rle,[Pe("button",{class:"btn btn-custom btn-sm",onClick:de=>D(oe.data),disabled:oe.data.seats===0||!r.value,title:r.value?"":"Login to register"},wr(oe.data.seats===0?"Full":"Register"),9,Ple),hi(qe,{class:"btn btn-custom btn-sm",to:{name:"reviews",query:{programId:oe.data.id}},title:r.value?"":"Login to review"},{default:si(()=>[...je[12]||(je[12]=[Ss(" Review ",-1)])]),_:2},1032,["to","title"])])]),_:1})]),_:1},8,["value","filters"])])])}}},Ole=Cu(Dle,[["__scopeId","data-v-b2640580"]]),Lle={class:"row"},zle={class:"card h-100 shadow-sm"},Ble={class:"card-body"},Fle={class:"card-title"},Nle={class:"card-text"},Vle=["onClick"],$le=["onClick"],jle={__name:"Resources",setup(t){const e=[{id:1,title:"Mindfulness Guide",description:"Learn how to practice mindfulness daily."},{id:2,title:"Coping with Stress",description:"Strategies to manage stress effectively."},{id:3,title:"Healthy Sleep Tips",description:"Better sleep for better mental health."}],n=Si([]),r=Si([]);lh(()=>{const p=localStorage.getItem("resources");n.value=p?JSON.parse(p):e}),gu(n,p=>{localStorage.setItem("resources",JSON.stringify(p))},{deep:!0});function c(p){r.value.push(p),alert(`Saved: ${p.title}`)}function u(p){alert(`Reported: ${p.title}`)}return(p,o)=>(We(),wt("div",null,[o[0]||(o[0]=Pe("h1",null,"Resources",-1)),o[1]||(o[1]=Pe("p",{class:"text-muted"}," Explore self-help guides, stories, and tools to support mental health. ",-1)),Pe("div",Lle,[(We(!0),wt(Mi,null,ea(n.value,w=>(We(),wt("div",{class:"col-md-4 mb-4",key:w.id},[Pe("div",zle,[Pe("div",Ble,[Pe("h5",Fle,wr(w.title),1),Pe("p",Nle,wr(w.description),1),Pe("button",{class:"btn btn-custom btn-sm",onClick:T=>c(w)}," Save ",8,Vle),Pe("button",{class:"btn btn-outline-secondary btn-sm ms-2",onClick:T=>u(w)}," Report ",8,$le)])])]))),128))])]))}},Ule=Cu(jle,[["__scopeId","data-v-ef8eb636"]]),Hle=()=>{};var tO={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rF=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let c=t.charCodeAt(r);c<128?e[n++]=c:c<2048?(e[n++]=c>>6|192,e[n++]=c&63|128):(c&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(c=65536+((c&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=c>>18|240,e[n++]=c>>12&63|128,e[n++]=c>>6&63|128,e[n++]=c&63|128):(e[n++]=c>>12|224,e[n++]=c>>6&63|128,e[n++]=c&63|128)}return e},Gle=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const c=t[n++];if(c<128)e[r++]=String.fromCharCode(c);else if(c>191&&c<224){const u=t[n++];e[r++]=String.fromCharCode((c&31)<<6|u&63)}else if(c>239&&c<365){const u=t[n++],p=t[n++],o=t[n++],w=((c&7)<<18|(u&63)<<12|(p&63)<<6|o&63)-65536;e[r++]=String.fromCharCode(55296+(w>>10)),e[r++]=String.fromCharCode(56320+(w&1023))}else{const u=t[n++],p=t[n++];e[r++]=String.fromCharCode((c&15)<<12|(u&63)<<6|p&63)}}return e.join("")},oF={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let c=0;c<t.length;c+=3){const u=t[c],p=c+1<t.length,o=p?t[c+1]:0,w=c+2<t.length,T=w?t[c+2]:0,A=u>>2,D=(u&3)<<4|o>>4;let B=(o&15)<<2|T>>6,N=T&63;w||(N=64,p||(B=64)),r.push(n[A],n[D],n[B],n[N])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(rF(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Gle(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let c=0;c<t.length;){const u=n[t.charAt(c++)],o=c<t.length?n[t.charAt(c)]:0;++c;const T=c<t.length?n[t.charAt(c)]:64;++c;const D=c<t.length?n[t.charAt(c)]:64;if(++c,u==null||o==null||T==null||D==null)throw new Wle;const B=u<<2|o>>4;if(r.push(B),T!==64){const N=o<<4&240|T>>2;if(r.push(N),D!==64){const ee=T<<6&192|D;r.push(ee)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Wle extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const qle=function(t){const e=rF(t);return oF.encodeByteArray(e,!0)},Iw=function(t){return qle(t).replace(/\./g,"")},sF=function(t){try{return oF.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zle(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kle=()=>Zle().__FIREBASE_DEFAULTS__,Xle=()=>{if(typeof process>"u"||typeof tO>"u")return;const t=tO.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Yle=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&sF(t[1]);return e&&JSON.parse(e)},EI=()=>{try{return Hle()||Kle()||Xle()||Yle()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},aF=t=>{var e,n;return(n=(e=EI())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},Jle=t=>{const e=aF(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},lF=()=>{var t;return(t=EI())==null?void 0:t.config},cF=t=>{var e;return(e=EI())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qle{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R0(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function uF(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ece(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",c=t.iat||0,u=t.sub||t.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const p={iss:`https://securetoken.google.com/${r}`,aud:r,iat:c,exp:c+3600,auth_time:c,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Iw(JSON.stringify(n)),Iw(JSON.stringify(p)),""].join(".")}const ub={};function tce(){const t={prod:[],emulator:[]};for(const e of Object.keys(ub))ub[e]?t.emulator.push(e):t.prod.push(e);return t}function nce(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let nO=!1;function dF(t,e){if(typeof window>"u"||typeof document>"u"||!R0(window.location.host)||ub[t]===e||ub[t]||nO)return;ub[t]=e;function n(B){return`__firebase__banner__${B}`}const r="__firebase__banner",u=tce().prod.length>0;function p(){const B=document.getElementById(r);B&&B.remove()}function o(B){B.style.display="flex",B.style.background="#7faaf0",B.style.position="fixed",B.style.bottom="5px",B.style.left="5px",B.style.padding=".5em",B.style.borderRadius="5px",B.style.alignItems="center"}function w(B,N){B.setAttribute("width","24"),B.setAttribute("id",N),B.setAttribute("height","24"),B.setAttribute("viewBox","0 0 24 24"),B.setAttribute("fill","none"),B.style.marginLeft="-6px"}function T(){const B=document.createElement("span");return B.style.cursor="pointer",B.style.marginLeft="16px",B.style.fontSize="24px",B.innerHTML=" &times;",B.onclick=()=>{nO=!0,p()},B}function A(B,N){B.setAttribute("id",N),B.innerText="Learn more",B.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",B.setAttribute("target","__blank"),B.style.paddingLeft="5px",B.style.textDecoration="underline"}function D(){const B=nce(r),N=n("text"),ee=document.getElementById(N)||document.createElement("span"),Q=n("learnmore"),se=document.getElementById(Q)||document.createElement("a"),ce=n("preprendIcon"),be=document.getElementById(ce)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(B.created){const ze=B.element;o(ze),A(se,Q);const xe=T();w(be,ce),ze.append(be,ee,se,xe),document.body.appendChild(ze)}u?(ee.innerText="Preview backend disconnected.",be.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(be.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,ee.innerText="Preview backend running in this workspace."),ee.setAttribute("id",N)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",D):D()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gl(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ice(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Gl())}function rce(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function hF(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function oce(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function sce(){const t=Gl();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function fF(){try{return typeof indexedDB=="object"}catch{return!1}}function pF(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",c=self.indexedDB.open(r);c.onsuccess=()=>{c.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},c.onupgradeneeded=()=>{n=!1},c.onerror=()=>{var u;e(((u=c.error)==null?void 0:u.message)||"")}}catch(n){e(n)}})}function ace(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lce="FirebaseError";class pd extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=lce,Object.setPrototypeOf(this,pd.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Sg.prototype.create)}}class Sg{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},c=`${this.service}/${e}`,u=this.errors[e],p=u?cce(u,r):"Error",o=`${this.serviceName}: ${p} (${c}).`;return new pd(c,o,r)}}function cce(t,e){return t.replace(uce,(n,r)=>{const c=e[r];return c!=null?String(c):`<${r}?>`})}const uce=/\{\$([^}]+)}/g;function dce(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Np(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const c of n){if(!r.includes(c))return!1;const u=t[c],p=e[c];if(iO(u)&&iO(p)){if(!Np(u,p))return!1}else if(u!==p)return!1}for(const c of r)if(!n.includes(c))return!1;return!0}function iO(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P0(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(c=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(c))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Kv(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[c,u]=r.split("=");e[decodeURIComponent(c)]=decodeURIComponent(u)}}),e}function Xv(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function hce(t,e){const n=new fce(t,e);return n.subscribe.bind(n)}class fce{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let c;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");pce(e,["next","error","complete"])?c=e:c={next:e,error:n,complete:r},c.next===void 0&&(c.next=j2),c.error===void 0&&(c.error=j2),c.complete===void 0&&(c.complete=j2);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?c.error(this.finalError):c.complete()}catch{}}),this.observers.push(c),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function pce(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function j2(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mce=1e3,gce=2,_ce=4*60*60*1e3,yce=.5;function rO(t,e=mce,n=gce){const r=e*Math.pow(n,t),c=Math.round(yce*r*(Math.random()-.5)*2);return Math.min(_ce,r+c)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nc(t){return t&&t._delegate?t._delegate:t}class dd{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gm="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vce{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Qle;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const c=this.getOrInitializeService({instanceIdentifier:n});c&&r.resolve(c)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(c){if(r)return null;throw c}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(xce(e))try{this.getOrInitializeService({instanceIdentifier:Gm})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(n);try{const u=this.getOrInitializeService({instanceIdentifier:c});r.resolve(u)}catch{}}}}clearInstance(e=Gm){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Gm){return this.instances.has(e)}getOptions(e=Gm){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const c=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[u,p]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(u);r===o&&p.resolve(c)}return c}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),c=this.onInitCallbacks.get(r)??new Set;c.add(e),this.onInitCallbacks.set(r,c);const u=this.instances.get(r);return u&&e(u,r),()=>{c.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const c of r)try{c(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:bce(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Gm){return this.component?this.component.multipleInstances?e:Gm:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function bce(t){return t===Gm?void 0:t}function xce(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wce{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new vce(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var No;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(No||(No={}));const Sce={debug:No.DEBUG,verbose:No.VERBOSE,info:No.INFO,warn:No.WARN,error:No.ERROR,silent:No.SILENT},Cce=No.INFO,Tce={[No.DEBUG]:"log",[No.VERBOSE]:"log",[No.INFO]:"info",[No.WARN]:"warn",[No.ERROR]:"error"},Ece=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),c=Tce[e];if(c)console[c](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class PS{constructor(e){this.name=e,this._logLevel=Cce,this._logHandler=Ece,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in No))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Sce[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,No.DEBUG,...e),this._logHandler(this,No.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,No.VERBOSE,...e),this._logHandler(this,No.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,No.INFO,...e),this._logHandler(this,No.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,No.WARN,...e),this._logHandler(this,No.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,No.ERROR,...e),this._logHandler(this,No.ERROR,...e)}}const Ice=(t,e)=>e.some(n=>t instanceof n);let oO,sO;function Ace(){return oO||(oO=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function kce(){return sO||(sO=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const mF=new WeakMap,aE=new WeakMap,gF=new WeakMap,U2=new WeakMap,II=new WeakMap;function Rce(t){const e=new Promise((n,r)=>{const c=()=>{t.removeEventListener("success",u),t.removeEventListener("error",p)},u=()=>{n(Pp(t.result)),c()},p=()=>{r(t.error),c()};t.addEventListener("success",u),t.addEventListener("error",p)});return e.then(n=>{n instanceof IDBCursor&&mF.set(n,t)}).catch(()=>{}),II.set(e,t),e}function Pce(t){if(aE.has(t))return;const e=new Promise((n,r)=>{const c=()=>{t.removeEventListener("complete",u),t.removeEventListener("error",p),t.removeEventListener("abort",p)},u=()=>{n(),c()},p=()=>{r(t.error||new DOMException("AbortError","AbortError")),c()};t.addEventListener("complete",u),t.addEventListener("error",p),t.addEventListener("abort",p)});aE.set(t,e)}let lE={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return aE.get(t);if(e==="objectStoreNames")return t.objectStoreNames||gF.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Pp(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Mce(t){lE=t(lE)}function Dce(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(H2(this),e,...n);return gF.set(r,e.sort?e.sort():[e]),Pp(r)}:kce().includes(t)?function(...e){return t.apply(H2(this),e),Pp(mF.get(this))}:function(...e){return Pp(t.apply(H2(this),e))}}function Oce(t){return typeof t=="function"?Dce(t):(t instanceof IDBTransaction&&Pce(t),Ice(t,Ace())?new Proxy(t,lE):t)}function Pp(t){if(t instanceof IDBRequest)return Rce(t);if(U2.has(t))return U2.get(t);const e=Oce(t);return e!==t&&(U2.set(t,e),II.set(e,t)),e}const H2=t=>II.get(t);function _F(t,e,{blocked:n,upgrade:r,blocking:c,terminated:u}={}){const p=indexedDB.open(t,e),o=Pp(p);return r&&p.addEventListener("upgradeneeded",w=>{r(Pp(p.result),w.oldVersion,w.newVersion,Pp(p.transaction),w)}),n&&p.addEventListener("blocked",w=>n(w.oldVersion,w.newVersion,w)),o.then(w=>{u&&w.addEventListener("close",()=>u()),c&&w.addEventListener("versionchange",T=>c(T.oldVersion,T.newVersion,T))}).catch(()=>{}),o}const Lce=["get","getKey","getAll","getAllKeys","count"],zce=["put","add","delete","clear"],G2=new Map;function aO(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(G2.get(e))return G2.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,c=zce.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(c||Lce.includes(n)))return;const u=async function(p,...o){const w=this.transaction(p,c?"readwrite":"readonly");let T=w.store;return r&&(T=T.index(o.shift())),(await Promise.all([T[n](...o),c&&w.done]))[0]};return G2.set(e,u),u}Mce(t=>({...t,get:(e,n,r)=>aO(e,n)||t.get(e,n,r),has:(e,n)=>!!aO(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bce{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Fce(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function Fce(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const cE="@firebase/app",lO="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sf=new PS("@firebase/app"),Nce="@firebase/app-compat",Vce="@firebase/analytics-compat",$ce="@firebase/analytics",jce="@firebase/app-check-compat",Uce="@firebase/app-check",Hce="@firebase/auth",Gce="@firebase/auth-compat",Wce="@firebase/database",qce="@firebase/data-connect",Zce="@firebase/database-compat",Kce="@firebase/functions",Xce="@firebase/functions-compat",Yce="@firebase/installations",Jce="@firebase/installations-compat",Qce="@firebase/messaging",eue="@firebase/messaging-compat",tue="@firebase/performance",nue="@firebase/performance-compat",iue="@firebase/remote-config",rue="@firebase/remote-config-compat",oue="@firebase/storage",sue="@firebase/storage-compat",aue="@firebase/firestore",lue="@firebase/ai",cue="@firebase/firestore-compat",uue="firebase",due="12.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uE="[DEFAULT]",hue={[cE]:"fire-core",[Nce]:"fire-core-compat",[$ce]:"fire-analytics",[Vce]:"fire-analytics-compat",[Uce]:"fire-app-check",[jce]:"fire-app-check-compat",[Hce]:"fire-auth",[Gce]:"fire-auth-compat",[Wce]:"fire-rtdb",[qce]:"fire-data-connect",[Zce]:"fire-rtdb-compat",[Kce]:"fire-fn",[Xce]:"fire-fn-compat",[Yce]:"fire-iid",[Jce]:"fire-iid-compat",[Qce]:"fire-fcm",[eue]:"fire-fcm-compat",[tue]:"fire-perf",[nue]:"fire-perf-compat",[iue]:"fire-rc",[rue]:"fire-rc-compat",[oue]:"fire-gcs",[sue]:"fire-gcs-compat",[aue]:"fire-fst",[cue]:"fire-fst-compat",[lue]:"fire-vertex","fire-js":"fire-js",[uue]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aw=new Map,fue=new Map,dE=new Map;function cO(t,e){try{t.container.addComponent(e)}catch(n){sf.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function sh(t){const e=t.name;if(dE.has(e))return sf.debug(`There were multiple attempts to register component ${e}.`),!1;dE.set(e,t);for(const n of Aw.values())cO(n,t);for(const n of fue.values())cO(n,t);return!0}function Cg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function mu(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pue={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Mp=new Sg("app","Firebase",pue);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mue{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new dd("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Mp.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const py=due;function yF(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:uE,automaticDataCollectionEnabled:!0,...e},c=r.name;if(typeof c!="string"||!c)throw Mp.create("bad-app-name",{appName:String(c)});if(n||(n=lF()),!n)throw Mp.create("no-options");const u=Aw.get(c);if(u){if(Np(n,u.options)&&Np(r,u.config))return u;throw Mp.create("duplicate-app",{appName:c})}const p=new wce(c);for(const w of dE.values())p.addComponent(w);const o=new mue(n,r,p);return Aw.set(c,o),o}function AI(t=uE){const e=Aw.get(t);if(!e&&t===uE&&lF())return yF();if(!e)throw Mp.create("no-app",{appName:t});return e}function vu(t,e,n){let r=hue[t]??t;n&&(r+=`-${n}`);const c=r.match(/\s|\//),u=e.match(/\s|\//);if(c||u){const p=[`Unable to register library "${r}" with version "${e}":`];c&&p.push(`library name "${r}" contains illegal characters (whitespace or "/")`),c&&u&&p.push("and"),u&&p.push(`version name "${e}" contains illegal characters (whitespace or "/")`),sf.warn(p.join(" "));return}sh(new dd(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gue="firebase-heartbeat-database",_ue=1,h0="firebase-heartbeat-store";let W2=null;function vF(){return W2||(W2=_F(gue,_ue,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(h0)}catch(n){console.warn(n)}}}}).catch(t=>{throw Mp.create("idb-open",{originalErrorMessage:t.message})})),W2}async function yue(t){try{const n=(await vF()).transaction(h0),r=await n.objectStore(h0).get(bF(t));return await n.done,r}catch(e){if(e instanceof pd)sf.warn(e.message);else{const n=Mp.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});sf.warn(n.message)}}}async function uO(t,e){try{const r=(await vF()).transaction(h0,"readwrite");await r.objectStore(h0).put(e,bF(t)),await r.done}catch(n){if(n instanceof pd)sf.warn(n.message);else{const r=Mp.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});sf.warn(r.message)}}}function bF(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vue=1024,bue=30;class xue{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Sue(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const c=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),u=dO();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===u||this._heartbeatsCache.heartbeats.some(p=>p.date===u))return;if(this._heartbeatsCache.heartbeats.push({date:u,agent:c}),this._heartbeatsCache.heartbeats.length>bue){const p=Cue(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(p,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){sf.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=dO(),{heartbeatsToSend:r,unsentEntries:c}=wue(this._heartbeatsCache.heartbeats),u=Iw(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,c.length>0?(this._heartbeatsCache.heartbeats=c,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),u}catch(n){return sf.warn(n),""}}}function dO(){return new Date().toISOString().substring(0,10)}function wue(t,e=vue){const n=[];let r=t.slice();for(const c of t){const u=n.find(p=>p.agent===c.agent);if(u){if(u.dates.push(c.date),hO(n)>e){u.dates.pop();break}}else if(n.push({agent:c.agent,dates:[c.date]}),hO(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Sue{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return fF()?pF().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await yue(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return uO(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return uO(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function hO(t){return Iw(JSON.stringify({version:2,heartbeats:t})).length}function Cue(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tue(t){sh(new dd("platform-logger",e=>new Bce(e),"PRIVATE")),sh(new dd("heartbeat",e=>new xue(e),"PRIVATE")),vu(cE,lO,t),vu(cE,lO,"esm2020"),vu("fire-js","")}Tue("");var Eue="firebase",Iue="12.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vu(Eue,Iue,"app");const xF="@firebase/installations",kI="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wF=1e4,SF=`w:${kI}`,CF="FIS_v2",Aue="https://firebaseinstallations.googleapis.com/v1",kue=60*60*1e3,Rue="installations",Pue="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mue={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},hg=new Sg(Rue,Pue,Mue);function TF(t){return t instanceof pd&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EF({projectId:t}){return`${Aue}/projects/${t}/installations`}function IF(t){return{token:t.token,requestStatus:2,expiresIn:Oue(t.expiresIn),creationTime:Date.now()}}async function AF(t,e){const r=(await e.json()).error;return hg.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function kF({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function Due(t,{refreshToken:e}){const n=kF(t);return n.append("Authorization",Lue(e)),n}async function RF(t){const e=await t();return e.status>=500&&e.status<600?t():e}function Oue(t){return Number(t.replace("s","000"))}function Lue(t){return`${CF} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zue({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=EF(t),c=kF(t),u=e.getImmediate({optional:!0});if(u){const T=await u.getHeartbeatsHeader();T&&c.append("x-firebase-client",T)}const p={fid:n,authVersion:CF,appId:t.appId,sdkVersion:SF},o={method:"POST",headers:c,body:JSON.stringify(p)},w=await RF(()=>fetch(r,o));if(w.ok){const T=await w.json();return{fid:T.fid||n,registrationStatus:2,refreshToken:T.refreshToken,authToken:IF(T.authToken)}}else throw await AF("Create Installation",w)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PF(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bue(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fue=/^[cdef][\w-]{21}$/,hE="";function Nue(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=Vue(t);return Fue.test(n)?n:hE}catch{return hE}}function Vue(t){return Bue(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MS(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MF=new Map;function DF(t,e){const n=MS(t);OF(n,e),$ue(n,e)}function OF(t,e){const n=MF.get(t);if(n)for(const r of n)r(e)}function $ue(t,e){const n=jue();n&&n.postMessage({key:t,fid:e}),Uue()}let tg=null;function jue(){return!tg&&"BroadcastChannel"in self&&(tg=new BroadcastChannel("[Firebase] FID Change"),tg.onmessage=t=>{OF(t.data.key,t.data.fid)}),tg}function Uue(){MF.size===0&&tg&&(tg.close(),tg=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hue="firebase-installations-database",Gue=1,fg="firebase-installations-store";let q2=null;function RI(){return q2||(q2=_F(Hue,Gue,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(fg)}}})),q2}async function kw(t,e){const n=MS(t),c=(await RI()).transaction(fg,"readwrite"),u=c.objectStore(fg),p=await u.get(n);return await u.put(e,n),await c.done,(!p||p.fid!==e.fid)&&DF(t,e.fid),e}async function LF(t){const e=MS(t),r=(await RI()).transaction(fg,"readwrite");await r.objectStore(fg).delete(e),await r.done}async function DS(t,e){const n=MS(t),c=(await RI()).transaction(fg,"readwrite"),u=c.objectStore(fg),p=await u.get(n),o=e(p);return o===void 0?await u.delete(n):await u.put(o,n),await c.done,o&&(!p||p.fid!==o.fid)&&DF(t,o.fid),o}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PI(t){let e;const n=await DS(t.appConfig,r=>{const c=Wue(r),u=que(t,c);return e=u.registrationPromise,u.installationEntry});return n.fid===hE?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function Wue(t){const e=t||{fid:Nue(),registrationStatus:0};return zF(e)}function que(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const c=Promise.reject(hg.create("app-offline"));return{installationEntry:e,registrationPromise:c}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=Zue(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:Kue(t)}:{installationEntry:e}}async function Zue(t,e){try{const n=await zue(t,e);return kw(t.appConfig,n)}catch(n){throw TF(n)&&n.customData.serverCode===409?await LF(t.appConfig):await kw(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function Kue(t){let e=await fO(t.appConfig);for(;e.registrationStatus===1;)await PF(100),e=await fO(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await PI(t);return r||n}return e}function fO(t){return DS(t,e=>{if(!e)throw hg.create("installation-not-found");return zF(e)})}function zF(t){return Xue(t)?{fid:t.fid,registrationStatus:0}:t}function Xue(t){return t.registrationStatus===1&&t.registrationTime+wF<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yue({appConfig:t,heartbeatServiceProvider:e},n){const r=Jue(t,n),c=Due(t,n),u=e.getImmediate({optional:!0});if(u){const T=await u.getHeartbeatsHeader();T&&c.append("x-firebase-client",T)}const p={installation:{sdkVersion:SF,appId:t.appId}},o={method:"POST",headers:c,body:JSON.stringify(p)},w=await RF(()=>fetch(r,o));if(w.ok){const T=await w.json();return IF(T)}else throw await AF("Generate Auth Token",w)}function Jue(t,{fid:e}){return`${EF(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MI(t,e=!1){let n;const r=await DS(t.appConfig,u=>{if(!BF(u))throw hg.create("not-registered");const p=u.authToken;if(!e&&tde(p))return u;if(p.requestStatus===1)return n=Que(t,e),u;{if(!navigator.onLine)throw hg.create("app-offline");const o=ide(u);return n=ede(t,o),o}});return n?await n:r.authToken}async function Que(t,e){let n=await pO(t.appConfig);for(;n.authToken.requestStatus===1;)await PF(100),n=await pO(t.appConfig);const r=n.authToken;return r.requestStatus===0?MI(t,e):r}function pO(t){return DS(t,e=>{if(!BF(e))throw hg.create("not-registered");const n=e.authToken;return rde(n)?{...e,authToken:{requestStatus:0}}:e})}async function ede(t,e){try{const n=await Yue(t,e),r={...e,authToken:n};return await kw(t.appConfig,r),n}catch(n){if(TF(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await LF(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await kw(t.appConfig,r)}throw n}}function BF(t){return t!==void 0&&t.registrationStatus===2}function tde(t){return t.requestStatus===2&&!nde(t)}function nde(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+kue}function ide(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function rde(t){return t.requestStatus===1&&t.requestTime+wF<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ode(t){const e=t,{installationEntry:n,registrationPromise:r}=await PI(e);return r?r.catch(console.error):MI(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sde(t,e=!1){const n=t;return await ade(n),(await MI(n,e)).token}async function ade(t){const{registrationPromise:e}=await PI(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lde(t){if(!t||!t.options)throw Z2("App Configuration");if(!t.name)throw Z2("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Z2(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Z2(t){return hg.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FF="installations",cde="installations-internal",ude=t=>{const e=t.getProvider("app").getImmediate(),n=lde(e),r=Cg(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},dde=t=>{const e=t.getProvider("app").getImmediate(),n=Cg(e,FF).getImmediate();return{getId:()=>ode(n),getToken:c=>sde(n,c)}};function hde(){sh(new dd(FF,ude,"PUBLIC")),sh(new dd(cde,dde,"PRIVATE"))}hde();vu(xF,kI);vu(xF,kI,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rw="analytics",fde="firebase_id",pde="origin",mde=60*1e3,gde="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",DI="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ul=new PS("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _de={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},zc=new Sg("analytics","Analytics",_de);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yde(t){if(!t.startsWith(DI)){const e=zc.create("invalid-gtag-resource",{gtagURL:t});return Ul.warn(e.message),""}return t}function NF(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function vde(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function bde(t,e){const n=vde("firebase-js-sdk-policy",{createScriptURL:yde}),r=document.createElement("script"),c=`${DI}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(c):c,r.async=!0,document.head.appendChild(r)}function xde(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function wde(t,e,n,r,c,u){const p=r[c];try{if(p)await e[p];else{const w=(await NF(n)).find(T=>T.measurementId===c);w&&await e[w.appId]}}catch(o){Ul.error(o)}t("config",c,u)}async function Sde(t,e,n,r,c){try{let u=[];if(c&&c.send_to){let p=c.send_to;Array.isArray(p)||(p=[p]);const o=await NF(n);for(const w of p){const T=o.find(D=>D.measurementId===w),A=T&&e[T.appId];if(A)u.push(A);else{u=[];break}}}u.length===0&&(u=Object.values(e)),await Promise.all(u),t("event",r,c||{})}catch(u){Ul.error(u)}}function Cde(t,e,n,r){async function c(u,...p){try{if(u==="event"){const[o,w]=p;await Sde(t,e,n,o,w)}else if(u==="config"){const[o,w]=p;await wde(t,e,n,r,o,w)}else if(u==="consent"){const[o,w]=p;t("consent",o,w)}else if(u==="get"){const[o,w,T]=p;t("get",o,w,T)}else if(u==="set"){const[o]=p;t("set",o)}else t(u,...p)}catch(o){Ul.error(o)}}return c}function Tde(t,e,n,r,c){let u=function(...p){window[r].push(arguments)};return window[c]&&typeof window[c]=="function"&&(u=window[c]),window[c]=Cde(u,t,e,n),{gtagCore:u,wrappedGtag:window[c]}}function Ede(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(DI)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ide=30,Ade=1e3;class kde{constructor(e={},n=Ade){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const VF=new kde;function Rde(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function Pde(t){var p;const{appId:e,apiKey:n}=t,r={method:"GET",headers:Rde(n)},c=gde.replace("{app-id}",e),u=await fetch(c,r);if(u.status!==200&&u.status!==304){let o="";try{const w=await u.json();(p=w.error)!=null&&p.message&&(o=w.error.message)}catch{}throw zc.create("config-fetch-failed",{httpStatus:u.status,responseMessage:o})}return u.json()}async function Mde(t,e=VF,n){const{appId:r,apiKey:c,measurementId:u}=t.options;if(!r)throw zc.create("no-app-id");if(!c){if(u)return{measurementId:u,appId:r};throw zc.create("no-api-key")}const p=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new Lde;return setTimeout(async()=>{o.abort()},mde),$F({appId:r,apiKey:c,measurementId:u},p,o,e)}async function $F(t,{throttleEndTimeMillis:e,backoffCount:n},r,c=VF){var o;const{appId:u,measurementId:p}=t;try{await Dde(r,e)}catch(w){if(p)return Ul.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${p} provided in the "measurementId" field in the local Firebase config. [${w==null?void 0:w.message}]`),{appId:u,measurementId:p};throw w}try{const w=await Pde(t);return c.deleteThrottleMetadata(u),w}catch(w){const T=w;if(!Ode(T)){if(c.deleteThrottleMetadata(u),p)return Ul.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${p} provided in the "measurementId" field in the local Firebase config. [${T==null?void 0:T.message}]`),{appId:u,measurementId:p};throw w}const A=Number((o=T==null?void 0:T.customData)==null?void 0:o.httpStatus)===503?rO(n,c.intervalMillis,Ide):rO(n,c.intervalMillis),D={throttleEndTimeMillis:Date.now()+A,backoffCount:n+1};return c.setThrottleMetadata(u,D),Ul.debug(`Calling attemptFetch again in ${A} millis`),$F(t,D,r,c)}}function Dde(t,e){return new Promise((n,r)=>{const c=Math.max(e-Date.now(),0),u=setTimeout(n,c);t.addEventListener(()=>{clearTimeout(u),r(zc.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Ode(t){if(!(t instanceof pd)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class Lde{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function zde(t,e,n,r,c){if(c&&c.global){t("event",n,r);return}else{const u=await e,p={...r,send_to:u};t("event",n,p)}}async function Bde(t,e,n,r){if(r&&r.global){const c={};for(const u of Object.keys(n))c[`user_properties.${u}`]=n[u];return t("set",c),Promise.resolve()}else{const c=await e;t("config",c,{update:!0,user_properties:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fde(){if(fF())try{await pF()}catch(t){return Ul.warn(zc.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return Ul.warn(zc.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function Nde(t,e,n,r,c,u,p){const o=Mde(t);o.then(B=>{n[B.measurementId]=B.appId,t.options.measurementId&&B.measurementId!==t.options.measurementId&&Ul.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${B.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(B=>Ul.error(B)),e.push(o);const w=Fde().then(B=>{if(B)return r.getId()}),[T,A]=await Promise.all([o,w]);Ede(u)||bde(u,T.measurementId),c("js",new Date);const D=(p==null?void 0:p.config)??{};return D[pde]="firebase",D.update=!0,A!=null&&(D[fde]=A),c("config",T.measurementId,D),T.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vde{constructor(e){this.app=e}_delete(){return delete H_[this.app.options.appId],Promise.resolve()}}let H_={},mO=[];const gO={};let K2="dataLayer",$de="gtag",_O,OI,yO=!1;function jde(){const t=[];if(hF()&&t.push("This is a browser extension environment."),ace()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,c)=>`(${c+1}) ${r}`).join(" "),n=zc.create("invalid-analytics-context",{errorInfo:e});Ul.warn(n.message)}}function Ude(t,e,n){jde();const r=t.options.appId;if(!r)throw zc.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)Ul.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw zc.create("no-api-key");if(H_[r]!=null)throw zc.create("already-exists",{id:r});if(!yO){xde(K2);const{wrappedGtag:u,gtagCore:p}=Tde(H_,mO,gO,K2,$de);OI=u,_O=p,yO=!0}return H_[r]=Nde(t,mO,gO,e,_O,K2,n),new Vde(t)}function Hde(t=AI()){t=Nc(t);const e=Cg(t,Rw);return e.isInitialized()?e.getImmediate():Gde(t)}function Gde(t,e={}){const n=Cg(t,Rw);if(n.isInitialized()){const c=n.getImmediate();if(Np(e,n.getOptions()))return c;throw zc.create("already-initialized")}return n.initialize({options:e})}function Wde(t,e,n){t=Nc(t),Bde(OI,H_[t.app.options.appId],e,n).catch(r=>Ul.error(r))}function qde(t,e,n,r){t=Nc(t),zde(OI,H_[t.app.options.appId],e,n,r).catch(c=>Ul.error(c))}const vO="@firebase/analytics",bO="0.10.19";function Zde(){sh(new dd(Rw,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),c=e.getProvider("installations-internal").getImmediate();return Ude(r,c,n)},"PUBLIC")),sh(new dd("analytics-internal",t,"PRIVATE")),vu(vO,bO),vu(vO,bO,"esm2020");function t(e){try{const n=e.getProvider(Rw).getImmediate();return{logEvent:(r,c,u)=>qde(n,r,c,u),setUserProperties:(r,c)=>Wde(n,r,c)}}catch(n){throw zc.create("interop-component-reg-failed",{reason:n})}}}Zde();function jF(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Kde=jF,UF=new Sg("auth","Firebase",jF());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pw=new PS("@firebase/auth");function Xde(t,...e){Pw.logLevel<=No.WARN&&Pw.warn(`Auth (${py}): ${t}`,...e)}function Zx(t,...e){Pw.logLevel<=No.ERROR&&Pw.error(`Auth (${py}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hd(t,...e){throw LI(t,...e)}function rh(t,...e){return LI(t,...e)}function HF(t,e,n){const r={...Kde(),[e]:n};return new Sg("auth","Firebase",r).create(e,{appName:t.name})}function tf(t){return HF(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function LI(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return UF.create(t,...e)}function tr(t,e,...n){if(!t)throw LI(e,...n)}function Yh(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Zx(e),new Error(e)}function af(t,e){t||Yh(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fE(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function Yde(){return xO()==="http:"||xO()==="https:"}function xO(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jde(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Yde()||hF()||"connection"in navigator)?navigator.onLine:!0}function Qde(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{constructor(e,n){this.shortDelay=e,this.longDelay=n,af(n>e,"Short delay should be less than long delay!"),this.isMobile=ice()||oce()}get(){return Jde()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zI(t,e){af(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GF{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Yh("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Yh("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Yh("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ehe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const the=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],nhe=new M0(3e4,6e4);function qp(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function hf(t,e,n,r,c={}){return WF(t,c,async()=>{let u={},p={};r&&(e==="GET"?p=r:u={body:JSON.stringify(r)});const o=P0({key:t.config.apiKey,...p}).slice(1),w=await t._getAdditionalHeaders();w["Content-Type"]="application/json",t.languageCode&&(w["X-Firebase-Locale"]=t.languageCode);const T={method:e,headers:w,...u};return rce()||(T.referrerPolicy="no-referrer"),t.emulatorConfig&&R0(t.emulatorConfig.host)&&(T.credentials="include"),GF.fetch()(await qF(t,t.config.apiHost,n,o),T)})}async function WF(t,e,n){t._canInitEmulator=!1;const r={...ehe,...e};try{const c=new rhe(t),u=await Promise.race([n(),c.promise]);c.clearNetworkTimeout();const p=await u.json();if("needConfirmation"in p)throw _x(t,"account-exists-with-different-credential",p);if(u.ok&&!("errorMessage"in p))return p;{const o=u.ok?p.errorMessage:p.error.message,[w,T]=o.split(" : ");if(w==="FEDERATED_USER_ID_ALREADY_LINKED")throw _x(t,"credential-already-in-use",p);if(w==="EMAIL_EXISTS")throw _x(t,"email-already-in-use",p);if(w==="USER_DISABLED")throw _x(t,"user-disabled",p);const A=r[w]||w.toLowerCase().replace(/[_\s]+/g,"-");if(T)throw HF(t,A,T);hd(t,A)}}catch(c){if(c instanceof pd)throw c;hd(t,"network-request-failed",{message:String(c)})}}async function D0(t,e,n,r,c={}){const u=await hf(t,e,n,r,c);return"mfaPendingCredential"in u&&hd(t,"multi-factor-auth-required",{_serverResponse:u}),u}async function qF(t,e,n,r){const c=`${e}${n}?${r}`,u=t,p=u.config.emulator?zI(t.config,c):`${t.config.apiScheme}://${c}`;return the.includes(n)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(p).toString():p}function ihe(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class rhe{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(rh(this.auth,"network-request-failed")),nhe.get())})}}function _x(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const c=rh(t,e,r);return c.customData._tokenResponse=n,c}function wO(t){return t!==void 0&&t.enterprise!==void 0}class ohe{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return ihe(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function she(t,e){return hf(t,"GET","/v2/recaptchaConfig",qp(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ahe(t,e){return hf(t,"POST","/v1/accounts:delete",e)}async function Mw(t,e){return hf(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function db(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function lhe(t,e=!1){const n=Nc(t),r=await n.getIdToken(e),c=BI(r);tr(c&&c.exp&&c.auth_time&&c.iat,n.auth,"internal-error");const u=typeof c.firebase=="object"?c.firebase:void 0,p=u==null?void 0:u.sign_in_provider;return{claims:c,token:r,authTime:db(X2(c.auth_time)),issuedAtTime:db(X2(c.iat)),expirationTime:db(X2(c.exp)),signInProvider:p||null,signInSecondFactor:(u==null?void 0:u.sign_in_second_factor)||null}}function X2(t){return Number(t)*1e3}function BI(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Zx("JWT malformed, contained fewer than 3 sections"),null;try{const c=sF(n);return c?JSON.parse(c):(Zx("Failed to decode base64 JWT payload"),null)}catch(c){return Zx("Caught error parsing JWT payload as JSON",c==null?void 0:c.toString()),null}}function SO(t){const e=BI(t);return tr(e,"internal-error"),tr(typeof e.exp<"u","internal-error"),tr(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ry(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof pd&&che(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function che({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uhe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pE{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=db(this.lastLoginAt),this.creationTime=db(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dw(t){var D;const e=t.auth,n=await t.getIdToken(),r=await ry(t,Mw(e,{idToken:n}));tr(r==null?void 0:r.users.length,e,"internal-error");const c=r.users[0];t._notifyReloadListener(c);const u=(D=c.providerUserInfo)!=null&&D.length?ZF(c.providerUserInfo):[],p=hhe(t.providerData,u),o=t.isAnonymous,w=!(t.email&&c.passwordHash)&&!(p!=null&&p.length),T=o?w:!1,A={uid:c.localId,displayName:c.displayName||null,photoURL:c.photoUrl||null,email:c.email||null,emailVerified:c.emailVerified||!1,phoneNumber:c.phoneNumber||null,tenantId:c.tenantId||null,providerData:p,metadata:new pE(c.createdAt,c.lastLoginAt),isAnonymous:T};Object.assign(t,A)}async function dhe(t){const e=Nc(t);await Dw(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function hhe(t,e){return[...t.filter(r=>!e.some(c=>c.providerId===r.providerId)),...e]}function ZF(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fhe(t,e){const n=await WF(t,{},async()=>{const r=P0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:c,apiKey:u}=t.config,p=await qF(t,c,"/v1/token",`key=${u}`),o=await t._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const w={method:"POST",headers:o,body:r};return t.emulatorConfig&&R0(t.emulatorConfig.host)&&(w.credentials="include"),GF.fetch()(p,w)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function phe(t,e){return hf(t,"POST","/v2/accounts:revokeToken",qp(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G_{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){tr(e.idToken,"internal-error"),tr(typeof e.idToken<"u","internal-error"),tr(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):SO(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){tr(e.length!==0,"internal-error");const n=SO(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(tr(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:c,expiresIn:u}=await fhe(e,n);this.updateTokensAndExpiration(r,c,Number(u))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:c,expirationTime:u}=n,p=new G_;return r&&(tr(typeof r=="string","internal-error",{appName:e}),p.refreshToken=r),c&&(tr(typeof c=="string","internal-error",{appName:e}),p.accessToken=c),u&&(tr(typeof u=="number","internal-error",{appName:e}),p.expirationTime=u),p}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new G_,this.toJSON())}_performRefresh(){return Yh("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function up(t,e){tr(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class td{constructor({uid:e,auth:n,stsTokenManager:r,...c}){this.providerId="firebase",this.proactiveRefresh=new uhe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=c.displayName||null,this.email=c.email||null,this.emailVerified=c.emailVerified||!1,this.phoneNumber=c.phoneNumber||null,this.photoURL=c.photoURL||null,this.isAnonymous=c.isAnonymous||!1,this.tenantId=c.tenantId||null,this.providerData=c.providerData?[...c.providerData]:[],this.metadata=new pE(c.createdAt||void 0,c.lastLoginAt||void 0)}async getIdToken(e){const n=await ry(this,this.stsTokenManager.getToken(this.auth,e));return tr(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return lhe(this,e)}reload(){return dhe(this)}_assign(e){this!==e&&(tr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new td({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){tr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Dw(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(mu(this.auth.app))return Promise.reject(tf(this.auth));const e=await this.getIdToken();return await ry(this,ahe(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,c=n.email??void 0,u=n.phoneNumber??void 0,p=n.photoURL??void 0,o=n.tenantId??void 0,w=n._redirectEventId??void 0,T=n.createdAt??void 0,A=n.lastLoginAt??void 0,{uid:D,emailVerified:B,isAnonymous:N,providerData:ee,stsTokenManager:Q}=n;tr(D&&Q,e,"internal-error");const se=G_.fromJSON(this.name,Q);tr(typeof D=="string",e,"internal-error"),up(r,e.name),up(c,e.name),tr(typeof B=="boolean",e,"internal-error"),tr(typeof N=="boolean",e,"internal-error"),up(u,e.name),up(p,e.name),up(o,e.name),up(w,e.name),up(T,e.name),up(A,e.name);const ce=new td({uid:D,auth:e,email:c,emailVerified:B,displayName:r,isAnonymous:N,photoURL:p,phoneNumber:u,tenantId:o,stsTokenManager:se,createdAt:T,lastLoginAt:A});return ee&&Array.isArray(ee)&&(ce.providerData=ee.map(be=>({...be}))),w&&(ce._redirectEventId=w),ce}static async _fromIdTokenResponse(e,n,r=!1){const c=new G_;c.updateFromServerResponse(n);const u=new td({uid:n.localId,auth:e,stsTokenManager:c,isAnonymous:r});return await Dw(u),u}static async _fromGetAccountInfoResponse(e,n,r){const c=n.users[0];tr(c.localId!==void 0,"internal-error");const u=c.providerUserInfo!==void 0?ZF(c.providerUserInfo):[],p=!(c.email&&c.passwordHash)&&!(u!=null&&u.length),o=new G_;o.updateFromIdToken(r);const w=new td({uid:c.localId,auth:e,stsTokenManager:o,isAnonymous:p}),T={uid:c.localId,displayName:c.displayName||null,photoURL:c.photoUrl||null,email:c.email||null,emailVerified:c.emailVerified||!1,phoneNumber:c.phoneNumber||null,tenantId:c.tenantId||null,providerData:u,metadata:new pE(c.createdAt,c.lastLoginAt),isAnonymous:!(c.email&&c.passwordHash)&&!(u!=null&&u.length)};return Object.assign(w,T),w}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CO=new Map;function Jh(t){af(t instanceof Function,"Expected a class definition");let e=CO.get(t);return e?(af(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,CO.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KF{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}KF.type="NONE";const TO=KF;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kx(t,e,n){return`firebase:${t}:${e}:${n}`}class W_{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:c,name:u}=this.auth;this.fullUserKey=Kx(this.userKey,c.apiKey,u),this.fullPersistenceKey=Kx("persistence",c.apiKey,u),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Mw(this.auth,{idToken:e}).catch(()=>{});return n?td._fromGetAccountInfoResponse(this.auth,n,e):null}return td._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new W_(Jh(TO),e,r);const c=(await Promise.all(n.map(async T=>{if(await T._isAvailable())return T}))).filter(T=>T);let u=c[0]||Jh(TO);const p=Kx(r,e.config.apiKey,e.name);let o=null;for(const T of n)try{const A=await T._get(p);if(A){let D;if(typeof A=="string"){const B=await Mw(e,{idToken:A}).catch(()=>{});if(!B)break;D=await td._fromGetAccountInfoResponse(e,B,A)}else D=td._fromJSON(e,A);T!==u&&(o=D),u=T;break}}catch{}const w=c.filter(T=>T._shouldAllowMigration);return!u._shouldAllowMigration||!w.length?new W_(u,e,r):(u=w[0],o&&await u._set(p,o.toJSON()),await Promise.all(n.map(async T=>{if(T!==u)try{await T._remove(p)}catch{}})),new W_(u,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EO(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(QF(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(XF(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(t6(e))return"Blackberry";if(n6(e))return"Webos";if(YF(e))return"Safari";if((e.includes("chrome/")||JF(e))&&!e.includes("edge/"))return"Chrome";if(e6(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function XF(t=Gl()){return/firefox\//i.test(t)}function YF(t=Gl()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function JF(t=Gl()){return/crios\//i.test(t)}function QF(t=Gl()){return/iemobile/i.test(t)}function e6(t=Gl()){return/android/i.test(t)}function t6(t=Gl()){return/blackberry/i.test(t)}function n6(t=Gl()){return/webos/i.test(t)}function FI(t=Gl()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function mhe(t=Gl()){var e;return FI(t)&&!!((e=window.navigator)!=null&&e.standalone)}function ghe(){return sce()&&document.documentMode===10}function i6(t=Gl()){return FI(t)||e6(t)||n6(t)||t6(t)||/windows phone/i.test(t)||QF(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r6(t,e=[]){let n;switch(t){case"Browser":n=EO(Gl());break;case"Worker":n=`${EO(Gl())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${py}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _he{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=u=>new Promise((p,o)=>{try{const w=e(u);p(w)}catch(w){o(w)}});r.onAbort=n,this.queue.push(r);const c=this.queue.length-1;return()=>{this.queue[c]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const c of n)try{c()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yhe(t,e={}){return hf(t,"GET","/v2/passwordPolicy",qp(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vhe=6;class bhe{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??vhe,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,c=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),c&&(n.meetsMaxPasswordLength=e.length<=c)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let c=0;c<e.length;c++)r=e.charAt(c),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,c,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=c)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xhe{constructor(e,n,r,c){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=c,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new IO(this),this.idTokenSubscription=new IO(this),this.beforeStateQueue=new _he(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=UF,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=c.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Jh(n)),this._initializationPromise=this.queue(async()=>{var r,c,u;if(!this._deleted&&(this.persistenceManager=await W_.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((c=this._popupRedirectResolver)!=null&&c._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((u=this.currentUser)==null?void 0:u.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Mw(this,{idToken:e}),r=await td._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var u;if(mu(this.app)){const p=this.app.settings.authIdToken;return p?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(p).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,c=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const p=(u=this.redirectUser)==null?void 0:u._redirectEventId,o=r==null?void 0:r._redirectEventId,w=await this.tryRedirectSignIn(e);(!p||p===o)&&(w!=null&&w.user)&&(r=w.user,c=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(c)try{await this.beforeStateQueue.runMiddleware(r)}catch(p){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(p))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return tr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Dw(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Qde()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(mu(this.app))return Promise.reject(tf(this));const n=e?Nc(e):null;return n&&tr(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&tr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return mu(this.app)?Promise.reject(tf(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return mu(this.app)?Promise.reject(tf(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Jh(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await yhe(this),n=new bhe(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Sg("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await phe(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Jh(e)||this._popupRedirectResolver;tr(n,this,"argument-error"),this.redirectPersistenceManager=await W_.create(this,[Jh(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,c){if(this._deleted)return()=>{};const u=typeof n=="function"?n:n.next.bind(n);let p=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(tr(o,this,"internal-error"),o.then(()=>{p||u(this.currentUser)}),typeof n=="function"){const w=e.addObserver(n,r,c);return()=>{p=!0,w()}}else{const w=e.addObserver(n);return()=>{p=!0,w()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return tr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=r6(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var c;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((c=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:c.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(mu(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&Xde(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Tg(t){return Nc(t)}class IO{constructor(e){this.auth=e,this.observer=null,this.addObserver=hce(n=>this.observer=n)}get next(){return tr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let OS={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function whe(t){OS=t}function o6(t){return OS.loadJS(t)}function She(){return OS.recaptchaEnterpriseScript}function Che(){return OS.gapiScript}function The(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class Ehe{constructor(){this.enterprise=new Ihe}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class Ihe{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const Ahe="recaptcha-enterprise",s6="NO_RECAPTCHA";class khe{constructor(e){this.type=Ahe,this.auth=Tg(e)}async verify(e="verify",n=!1){async function r(u){if(!n){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(p,o)=>{she(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(w=>{if(w.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const T=new ohe(w);return u.tenantId==null?u._agentRecaptchaConfig=T:u._tenantRecaptchaConfigs[u.tenantId]=T,p(T.siteKey)}}).catch(w=>{o(w)})})}function c(u,p,o){const w=window.grecaptcha;wO(w)?w.enterprise.ready(()=>{w.enterprise.execute(u,{action:e}).then(T=>{p(T)}).catch(()=>{p(s6)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Ehe().execute("siteKey",{action:"verify"}):new Promise((u,p)=>{r(this.auth).then(o=>{if(!n&&wO(window.grecaptcha))c(o,u,p);else{if(typeof window>"u"){p(new Error("RecaptchaVerifier is only supported in browser"));return}let w=She();w.length!==0&&(w+=o),o6(w).then(()=>{c(o,u,p)}).catch(T=>{p(T)})}}).catch(o=>{p(o)})})}}async function AO(t,e,n,r=!1,c=!1){const u=new khe(t);let p;if(c)p=s6;else try{p=await u.verify(n)}catch{p=await u.verify(n,!0)}const o={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const w=o.phoneEnrollmentInfo.phoneNumber,T=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:w,recaptchaToken:T,captchaResponse:p,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const w=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:w,captchaResponse:p,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return r?Object.assign(o,{captchaResp:p}):Object.assign(o,{captchaResponse:p}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function mE(t,e,n,r,c){var u;if((u=t._getRecaptchaConfig())!=null&&u.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const p=await AO(t,e,n,n==="getOobCode");return r(t,p)}else return r(t,e).catch(async p=>{if(p.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await AO(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(p)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rhe(t,e){const n=Cg(t,"auth");if(n.isInitialized()){const c=n.getImmediate(),u=n.getOptions();if(Np(u,e??{}))return c;hd(c,"already-initialized")}return n.initialize({options:e})}function Phe(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Jh);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Mhe(t,e,n){const r=Tg(t);tr(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const c=!1,u=a6(e),{host:p,port:o}=Dhe(e),w=o===null?"":`:${o}`,T={url:`${u}//${p}${w}/`},A=Object.freeze({host:p,port:o,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:c})});if(!r._canInitEmulator){tr(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),tr(Np(T,r.config.emulator)&&Np(A,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=T,r.emulatorConfig=A,r.settings.appVerificationDisabledForTesting=!0,R0(p)?(uF(`${u}//${p}${w}`),dF("Auth",!0)):Ohe()}function a6(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Dhe(t){const e=a6(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",c=/^(\[[^\]]+\])(:|$)/.exec(r);if(c){const u=c[1];return{host:u,port:kO(r.substr(u.length+1))}}else{const[u,p]=r.split(":");return{host:u,port:kO(p)}}}function kO(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Ohe(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NI{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Yh("not implemented")}_getIdTokenResponse(e){return Yh("not implemented")}_linkToIdToken(e,n){return Yh("not implemented")}_getReauthenticationResolver(e){return Yh("not implemented")}}async function Lhe(t,e){return hf(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zhe(t,e){return D0(t,"POST","/v1/accounts:signInWithPassword",qp(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bhe(t,e){return D0(t,"POST","/v1/accounts:signInWithEmailLink",qp(t,e))}async function Fhe(t,e){return D0(t,"POST","/v1/accounts:signInWithEmailLink",qp(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f0 extends NI{constructor(e,n,r,c=null){super("password",r),this._email=e,this._password=n,this._tenantId=c}static _fromEmailAndPassword(e,n){return new f0(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new f0(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return mE(e,n,"signInWithPassword",zhe);case"emailLink":return Bhe(e,{email:this._email,oobCode:this._password});default:hd(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return mE(e,r,"signUpPassword",Lhe);case"emailLink":return Fhe(e,{idToken:n,email:this._email,oobCode:this._password});default:hd(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q_(t,e){return D0(t,"POST","/v1/accounts:signInWithIdp",qp(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nhe="http://localhost";class pg extends NI{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new pg(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):hd("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:c,...u}=n;if(!r||!c)return null;const p=new pg(r,c);return p.idToken=u.idToken||void 0,p.accessToken=u.accessToken||void 0,p.secret=u.secret,p.nonce=u.nonce,p.pendingToken=u.pendingToken||null,p}_getIdTokenResponse(e){const n=this.buildRequest();return q_(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,q_(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,q_(e,n)}buildRequest(){const e={requestUri:Nhe,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=P0(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vhe(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function $he(t){const e=Kv(Xv(t)).link,n=e?Kv(Xv(e)).deep_link_id:null,r=Kv(Xv(t)).deep_link_id;return(r?Kv(Xv(r)).link:null)||r||n||e||t}class VI{constructor(e){const n=Kv(Xv(e)),r=n.apiKey??null,c=n.oobCode??null,u=Vhe(n.mode??null);tr(r&&c&&u,"argument-error"),this.apiKey=r,this.operation=u,this.code=c,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=$he(e);try{return new VI(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class my{constructor(){this.providerId=my.PROVIDER_ID}static credential(e,n){return f0._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=VI.parseLink(n);return tr(r,"argument-error"),f0._fromEmailAndCode(e,r.code,r.tenantId)}}my.PROVIDER_ID="password";my.EMAIL_PASSWORD_SIGN_IN_METHOD="password";my.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l6{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0 extends l6{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp extends O0{constructor(){super("facebook.com")}static credential(e){return pg._fromParams({providerId:yp.PROVIDER_ID,signInMethod:yp.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return yp.credentialFromTaggedObject(e)}static credentialFromError(e){return yp.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return yp.credential(e.oauthAccessToken)}catch{return null}}}yp.FACEBOOK_SIGN_IN_METHOD="facebook.com";yp.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh extends O0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return pg._fromParams({providerId:Kh.PROVIDER_ID,signInMethod:Kh.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Kh.credentialFromTaggedObject(e)}static credentialFromError(e){return Kh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Kh.credential(n,r)}catch{return null}}}Kh.GOOGLE_SIGN_IN_METHOD="google.com";Kh.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp extends O0{constructor(){super("github.com")}static credential(e){return pg._fromParams({providerId:vp.PROVIDER_ID,signInMethod:vp.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vp.credentialFromTaggedObject(e)}static credentialFromError(e){return vp.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return vp.credential(e.oauthAccessToken)}catch{return null}}}vp.GITHUB_SIGN_IN_METHOD="github.com";vp.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bp extends O0{constructor(){super("twitter.com")}static credential(e,n){return pg._fromParams({providerId:bp.PROVIDER_ID,signInMethod:bp.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return bp.credentialFromTaggedObject(e)}static credentialFromError(e){return bp.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return bp.credential(n,r)}catch{return null}}}bp.TWITTER_SIGN_IN_METHOD="twitter.com";bp.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jhe(t,e){return D0(t,"POST","/v1/accounts:signUp",qp(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mg{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,c=!1){const u=await td._fromIdTokenResponse(e,r,c),p=RO(r);return new mg({user:u,providerId:p,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const c=RO(r);return new mg({user:e,providerId:c,_tokenResponse:r,operationType:n})}}function RO(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ow extends pd{constructor(e,n,r,c){super(n.code,n.message),this.operationType=r,this.user=c,Object.setPrototypeOf(this,Ow.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,c){return new Ow(e,n,r,c)}}function c6(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Ow._fromErrorAndOperation(t,u,e,r):u})}async function Uhe(t,e,n=!1){const r=await ry(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return mg._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hhe(t,e,n=!1){const{auth:r}=t;if(mu(r.app))return Promise.reject(tf(r));const c="reauthenticate";try{const u=await ry(t,c6(r,c,e,t),n);tr(u.idToken,r,"internal-error");const p=BI(u.idToken);tr(p,r,"internal-error");const{sub:o}=p;return tr(t.uid===o,r,"user-mismatch"),mg._forOperation(t,c,u)}catch(u){throw(u==null?void 0:u.code)==="auth/user-not-found"&&hd(r,"user-mismatch"),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u6(t,e,n=!1){if(mu(t.app))return Promise.reject(tf(t));const r="signIn",c=await c6(t,r,e),u=await mg._fromIdTokenResponse(t,r,c);return n||await t._updateCurrentUser(u.user),u}async function Ghe(t,e){return u6(Tg(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d6(t){const e=Tg(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Whe(t,e,n){if(mu(t.app))return Promise.reject(tf(t));const r=Tg(t),p=await mE(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",jhe).catch(w=>{throw w.code==="auth/password-does-not-meet-requirements"&&d6(t),w}),o=await mg._fromIdTokenResponse(r,"signIn",p);return await r._updateCurrentUser(o.user),o}function qhe(t,e,n){return mu(t.app)?Promise.reject(tf(t)):Ghe(Nc(t),my.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&d6(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zhe(t,e){return hf(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Khe(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=Nc(t),u={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},p=await ry(r,Zhe(r.auth,u));r.displayName=p.displayName||null,r.photoURL=p.photoUrl||null;const o=r.providerData.find(({providerId:w})=>w==="password");o&&(o.displayName=r.displayName,o.photoURL=r.photoURL),await r._updateTokensIfNecessary(p)}function Xhe(t,e,n,r){return Nc(t).onIdTokenChanged(e,n,r)}function Yhe(t,e,n){return Nc(t).beforeAuthStateChanged(e,n)}function Jhe(t,e,n,r){return Nc(t).onAuthStateChanged(e,n,r)}function Qhe(t){return Nc(t).signOut()}const Lw="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Lw,"1"),this.storage.removeItem(Lw),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const efe=1e3,tfe=10;class f6 extends h6{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=i6(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),c=this.localCache[n];r!==c&&e(n,c,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((p,o,w)=>{this.notifyListeners(p,w)});return}const r=e.key;n?this.detachListener():this.stopPolling();const c=()=>{const p=this.storage.getItem(r);!n&&this.localCache[r]===p||this.notifyListeners(r,p)},u=this.storage.getItem(r);ghe()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(c,tfe):c()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const c of Array.from(r))c(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},efe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}f6.type="LOCAL";const nfe=f6;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p6 extends h6{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}p6.type="SESSION";const m6=p6;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ife(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LS{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(c=>c.isListeningto(e));if(n)return n;const r=new LS(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:c,data:u}=n.data,p=this.handlersMap[c];if(!(p!=null&&p.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:c});const o=Array.from(p).map(async T=>T(n.origin,u)),w=await ife(o);n.ports[0].postMessage({status:"done",eventId:r,eventType:c,response:w})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}LS.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $I(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rfe{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const c=typeof MessageChannel<"u"?new MessageChannel:null;if(!c)throw new Error("connection_unavailable");let u,p;return new Promise((o,w)=>{const T=$I("",20);c.port1.start();const A=setTimeout(()=>{w(new Error("unsupported_event"))},r);p={messageChannel:c,onMessage(D){const B=D;if(B.data.eventId===T)switch(B.data.status){case"ack":clearTimeout(A),u=setTimeout(()=>{w(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),o(B.data.response);break;default:clearTimeout(A),clearTimeout(u),w(new Error("invalid_response"));break}}},this.handlers.add(p),c.port1.addEventListener("message",p.onMessage),this.target.postMessage({eventType:e,eventId:T,data:n},[c.port2])}).finally(()=>{p&&this.removeMessageHandler(p)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oh(){return window}function ofe(t){oh().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g6(){return typeof oh().WorkerGlobalScope<"u"&&typeof oh().importScripts=="function"}async function sfe(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function afe(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function lfe(){return g6()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _6="firebaseLocalStorageDb",cfe=1,zw="firebaseLocalStorage",y6="fbase_key";class L0{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function zS(t,e){return t.transaction([zw],e?"readwrite":"readonly").objectStore(zw)}function ufe(){const t=indexedDB.deleteDatabase(_6);return new L0(t).toPromise()}function gE(){const t=indexedDB.open(_6,cfe);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(zw,{keyPath:y6})}catch(c){n(c)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(zw)?e(r):(r.close(),await ufe(),e(await gE()))})})}async function PO(t,e,n){const r=zS(t,!0).put({[y6]:e,value:n});return new L0(r).toPromise()}async function dfe(t,e){const n=zS(t,!1).get(e),r=await new L0(n).toPromise();return r===void 0?null:r.value}function MO(t,e){const n=zS(t,!0).delete(e);return new L0(n).toPromise()}const hfe=800,ffe=3;class v6{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await gE(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>ffe)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return g6()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=LS._getInstance(lfe()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await sfe(),!this.activeServiceWorker)return;this.sender=new rfe(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||afe()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await gE();return await PO(e,Lw,"1"),await MO(e,Lw),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>PO(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>dfe(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>MO(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(c=>{const u=zS(c,!1).getAll();return new L0(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:c,value:u}of e)r.add(c),JSON.stringify(this.localCache[c])!==JSON.stringify(u)&&(this.notifyListeners(c,u),n.push(c));for(const c of Object.keys(this.localCache))this.localCache[c]&&!r.has(c)&&(this.notifyListeners(c,null),n.push(c));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const c of Array.from(r))c(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),hfe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}v6.type="LOCAL";const pfe=v6;new M0(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mfe(t,e){return e?Jh(e):(tr(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jI extends NI{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return q_(e,this._buildIdpRequest())}_linkToIdToken(e,n){return q_(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return q_(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function gfe(t){return u6(t.auth,new jI(t),t.bypassAuthState)}function _fe(t){const{auth:e,user:n}=t;return tr(n,e,"internal-error"),Hhe(n,new jI(t),t.bypassAuthState)}async function yfe(t){const{auth:e,user:n}=t;return tr(n,e,"internal-error"),Uhe(n,new jI(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b6{constructor(e,n,r,c,u=!1){this.auth=e,this.resolver=r,this.user=c,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:c,tenantId:u,error:p,type:o}=e;if(p){this.reject(p);return}const w={auth:this.auth,requestUri:n,sessionId:r,tenantId:u||void 0,postBody:c||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(w))}catch(T){this.reject(T)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return gfe;case"linkViaPopup":case"linkViaRedirect":return yfe;case"reauthViaPopup":case"reauthViaRedirect":return _fe;default:hd(this.auth,"internal-error")}}resolve(e){af(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){af(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vfe=new M0(2e3,1e4);class D_ extends b6{constructor(e,n,r,c,u){super(e,n,c,u),this.provider=r,this.authWindow=null,this.pollId=null,D_.currentPopupAction&&D_.currentPopupAction.cancel(),D_.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return tr(e,this.auth,"internal-error"),e}async onExecution(){af(this.filter.length===1,"Popup operations only handle one event");const e=$I();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(rh(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(rh(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,D_.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(rh(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,vfe.get())};e()}}D_.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bfe="pendingRedirect",Xx=new Map;class xfe extends b6{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Xx.get(this.auth._key());if(!e){try{const r=await wfe(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Xx.set(this.auth._key(),e)}return this.bypassAuthState||Xx.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function wfe(t,e){const n=Tfe(e),r=Cfe(t);if(!await r._isAvailable())return!1;const c=await r._get(n)==="true";return await r._remove(n),c}function Sfe(t,e){Xx.set(t._key(),e)}function Cfe(t){return Jh(t._redirectPersistence)}function Tfe(t){return Kx(bfe,t.config.apiKey,t.name)}async function Efe(t,e,n=!1){if(mu(t.app))return Promise.reject(tf(t));const r=Tg(t),c=mfe(r,e),p=await new xfe(r,c,n).execute();return p&&!n&&(delete p.user._redirectEventId,await r._persistUserIfCurrent(p.user),await r._setRedirectUser(null,e)),p}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ife=10*60*1e3;class Afe{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!kfe(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!x6(e)){const c=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(rh(this.auth,c))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Ife&&this.cachedEventUids.clear(),this.cachedEventUids.has(DO(e))}saveEventToCache(e){this.cachedEventUids.add(DO(e)),this.lastProcessedEventTime=Date.now()}}function DO(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function x6({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function kfe(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return x6(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rfe(t,e={}){return hf(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pfe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Mfe=/^https?/;async function Dfe(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Rfe(t);for(const n of e)try{if(Ofe(n))return}catch{}hd(t,"unauthorized-domain")}function Ofe(t){const e=fE(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const p=new URL(t);return p.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&p.hostname===r}if(!Mfe.test(n))return!1;if(Pfe.test(t))return r===t;const c=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+c+"|"+c+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lfe=new M0(3e4,6e4);function OO(){const t=oh().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function zfe(t){return new Promise((e,n)=>{var c,u,p;function r(){OO(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{OO(),n(rh(t,"network-request-failed"))},timeout:Lfe.get()})}if((u=(c=oh().gapi)==null?void 0:c.iframes)!=null&&u.Iframe)e(gapi.iframes.getContext());else if((p=oh().gapi)!=null&&p.load)r();else{const o=The("iframefcb");return oh()[o]=()=>{gapi.load?r():n(rh(t,"network-request-failed"))},o6(`${Che()}?onload=${o}`).catch(w=>n(w))}}).catch(e=>{throw Yx=null,e})}let Yx=null;function Bfe(t){return Yx=Yx||zfe(t),Yx}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ffe=new M0(5e3,15e3),Nfe="__/auth/iframe",Vfe="emulator/auth/iframe",$fe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},jfe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Ufe(t){const e=t.config;tr(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?zI(e,Vfe):`https://${t.config.authDomain}/${Nfe}`,r={apiKey:e.apiKey,appName:t.name,v:py},c=jfe.get(t.config.apiHost);c&&(r.eid=c);const u=t._getFrameworks();return u.length&&(r.fw=u.join(",")),`${n}?${P0(r).slice(1)}`}async function Hfe(t){const e=await Bfe(t),n=oh().gapi;return tr(n,t,"internal-error"),e.open({where:document.body,url:Ufe(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:$fe,dontclear:!0},r=>new Promise(async(c,u)=>{await r.restyle({setHideOnLeave:!1});const p=rh(t,"network-request-failed"),o=oh().setTimeout(()=>{u(p)},Ffe.get());function w(){oh().clearTimeout(o),c(r)}r.ping(w).then(w,()=>{u(p)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gfe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Wfe=500,qfe=600,Zfe="_blank",Kfe="http://localhost";class LO{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Xfe(t,e,n,r=Wfe,c=qfe){const u=Math.max((window.screen.availHeight-c)/2,0).toString(),p=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const w={...Gfe,width:r.toString(),height:c.toString(),top:u,left:p},T=Gl().toLowerCase();n&&(o=JF(T)?Zfe:n),XF(T)&&(e=e||Kfe,w.scrollbars="yes");const A=Object.entries(w).reduce((B,[N,ee])=>`${B}${N}=${ee},`,"");if(mhe(T)&&o!=="_self")return Yfe(e||"",o),new LO(null);const D=window.open(e||"",o,A);tr(D,t,"popup-blocked");try{D.focus()}catch{}return new LO(D)}function Yfe(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jfe="__/auth/handler",Qfe="emulator/auth/handler",epe=encodeURIComponent("fac");async function zO(t,e,n,r,c,u){tr(t.config.authDomain,t,"auth-domain-config-required"),tr(t.config.apiKey,t,"invalid-api-key");const p={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:py,eventId:c};if(e instanceof l6){e.setDefaultLanguage(t.languageCode),p.providerId=e.providerId||"",dce(e.getCustomParameters())||(p.customParameters=JSON.stringify(e.getCustomParameters()));for(const[A,D]of Object.entries({}))p[A]=D}if(e instanceof O0){const A=e.getScopes().filter(D=>D!=="");A.length>0&&(p.scopes=A.join(","))}t.tenantId&&(p.tid=t.tenantId);const o=p;for(const A of Object.keys(o))o[A]===void 0&&delete o[A];const w=await t._getAppCheckToken(),T=w?`#${epe}=${encodeURIComponent(w)}`:"";return`${tpe(t)}?${P0(o).slice(1)}${T}`}function tpe({config:t}){return t.emulator?zI(t,Qfe):`https://${t.authDomain}/${Jfe}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y2="webStorageSupport";class npe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=m6,this._completeRedirectFn=Efe,this._overrideRedirectResult=Sfe}async _openPopup(e,n,r,c){var p;af((p=this.eventManagers[e._key()])==null?void 0:p.manager,"_initialize() not called before _openPopup()");const u=await zO(e,n,r,fE(),c);return Xfe(e,u,$I())}async _openRedirect(e,n,r,c){await this._originValidation(e);const u=await zO(e,n,r,fE(),c);return ofe(u),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:c,promise:u}=this.eventManagers[n];return c?Promise.resolve(c):(af(u,"If manager is not set, promise should be"),u)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await Hfe(e),r=new Afe(e);return n.register("authEvent",c=>(tr(c==null?void 0:c.authEvent,e,"invalid-auth-event"),{status:r.onEvent(c.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Y2,{type:Y2},c=>{var p;const u=(p=c==null?void 0:c[0])==null?void 0:p[Y2];u!==void 0&&n(!!u),hd(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Dfe(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return i6()||YF()||FI()}}const ipe=npe;var BO="@firebase/auth",FO="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rpe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){tr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ope(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function spe(t){sh(new dd("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),c=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:p,authDomain:o}=r.options;tr(p&&!p.includes(":"),"invalid-api-key",{appName:r.name});const w={apiKey:p,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:r6(t)},T=new xhe(r,c,u,w);return Phe(T,n),T},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),sh(new dd("auth-internal",e=>{const n=Tg(e.getProvider("auth").getImmediate());return(r=>new rpe(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),vu(BO,FO,ope(t)),vu(BO,FO,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ape=5*60,lpe=cF("authIdTokenMaxAge")||ape;let NO=null;const cpe=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>lpe)return;const c=n==null?void 0:n.token;NO!==c&&(NO=c,await fetch(t,{method:c?"POST":"DELETE",headers:c?{Authorization:`Bearer ${c}`}:{}}))};function upe(t=AI()){const e=Cg(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Rhe(t,{popupRedirectResolver:ipe,persistence:[pfe,nfe,m6]}),r=cF("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(r,location.origin);if(location.origin===u.origin){const p=cpe(u.toString());Yhe(n,p,()=>p(n.currentUser)),Xhe(n,o=>p(o))}}const c=aF("auth");return c&&Mhe(n,`http://${c}`),n}function dpe(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}whe({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=c=>{const u=rh("internal-error");u.customData=c,n(u)},r.type="text/javascript",r.charset="UTF-8",dpe().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});spe("Browser");var VO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var UI;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(oe,de){function Ee(){}Ee.prototype=de.prototype,oe.F=de.prototype,oe.prototype=new Ee,oe.prototype.constructor=oe,oe.D=function($e,me,Te){for(var Re=Array(arguments.length-2),tn=2;tn<arguments.length;tn++)Re[tn-2]=arguments[tn];return de.prototype[me].apply($e,Re)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function c(oe,de,Ee){Ee||(Ee=0);const $e=Array(16);if(typeof de=="string")for(var me=0;me<16;++me)$e[me]=de.charCodeAt(Ee++)|de.charCodeAt(Ee++)<<8|de.charCodeAt(Ee++)<<16|de.charCodeAt(Ee++)<<24;else for(me=0;me<16;++me)$e[me]=de[Ee++]|de[Ee++]<<8|de[Ee++]<<16|de[Ee++]<<24;de=oe.g[0],Ee=oe.g[1],me=oe.g[2];let Te=oe.g[3],Re;Re=de+(Te^Ee&(me^Te))+$e[0]+3614090360&4294967295,de=Ee+(Re<<7&4294967295|Re>>>25),Re=Te+(me^de&(Ee^me))+$e[1]+3905402710&4294967295,Te=de+(Re<<12&4294967295|Re>>>20),Re=me+(Ee^Te&(de^Ee))+$e[2]+606105819&4294967295,me=Te+(Re<<17&4294967295|Re>>>15),Re=Ee+(de^me&(Te^de))+$e[3]+3250441966&4294967295,Ee=me+(Re<<22&4294967295|Re>>>10),Re=de+(Te^Ee&(me^Te))+$e[4]+4118548399&4294967295,de=Ee+(Re<<7&4294967295|Re>>>25),Re=Te+(me^de&(Ee^me))+$e[5]+1200080426&4294967295,Te=de+(Re<<12&4294967295|Re>>>20),Re=me+(Ee^Te&(de^Ee))+$e[6]+2821735955&4294967295,me=Te+(Re<<17&4294967295|Re>>>15),Re=Ee+(de^me&(Te^de))+$e[7]+4249261313&4294967295,Ee=me+(Re<<22&4294967295|Re>>>10),Re=de+(Te^Ee&(me^Te))+$e[8]+1770035416&4294967295,de=Ee+(Re<<7&4294967295|Re>>>25),Re=Te+(me^de&(Ee^me))+$e[9]+2336552879&4294967295,Te=de+(Re<<12&4294967295|Re>>>20),Re=me+(Ee^Te&(de^Ee))+$e[10]+4294925233&4294967295,me=Te+(Re<<17&4294967295|Re>>>15),Re=Ee+(de^me&(Te^de))+$e[11]+2304563134&4294967295,Ee=me+(Re<<22&4294967295|Re>>>10),Re=de+(Te^Ee&(me^Te))+$e[12]+1804603682&4294967295,de=Ee+(Re<<7&4294967295|Re>>>25),Re=Te+(me^de&(Ee^me))+$e[13]+4254626195&4294967295,Te=de+(Re<<12&4294967295|Re>>>20),Re=me+(Ee^Te&(de^Ee))+$e[14]+2792965006&4294967295,me=Te+(Re<<17&4294967295|Re>>>15),Re=Ee+(de^me&(Te^de))+$e[15]+1236535329&4294967295,Ee=me+(Re<<22&4294967295|Re>>>10),Re=de+(me^Te&(Ee^me))+$e[1]+4129170786&4294967295,de=Ee+(Re<<5&4294967295|Re>>>27),Re=Te+(Ee^me&(de^Ee))+$e[6]+3225465664&4294967295,Te=de+(Re<<9&4294967295|Re>>>23),Re=me+(de^Ee&(Te^de))+$e[11]+643717713&4294967295,me=Te+(Re<<14&4294967295|Re>>>18),Re=Ee+(Te^de&(me^Te))+$e[0]+3921069994&4294967295,Ee=me+(Re<<20&4294967295|Re>>>12),Re=de+(me^Te&(Ee^me))+$e[5]+3593408605&4294967295,de=Ee+(Re<<5&4294967295|Re>>>27),Re=Te+(Ee^me&(de^Ee))+$e[10]+38016083&4294967295,Te=de+(Re<<9&4294967295|Re>>>23),Re=me+(de^Ee&(Te^de))+$e[15]+3634488961&4294967295,me=Te+(Re<<14&4294967295|Re>>>18),Re=Ee+(Te^de&(me^Te))+$e[4]+3889429448&4294967295,Ee=me+(Re<<20&4294967295|Re>>>12),Re=de+(me^Te&(Ee^me))+$e[9]+568446438&4294967295,de=Ee+(Re<<5&4294967295|Re>>>27),Re=Te+(Ee^me&(de^Ee))+$e[14]+3275163606&4294967295,Te=de+(Re<<9&4294967295|Re>>>23),Re=me+(de^Ee&(Te^de))+$e[3]+4107603335&4294967295,me=Te+(Re<<14&4294967295|Re>>>18),Re=Ee+(Te^de&(me^Te))+$e[8]+1163531501&4294967295,Ee=me+(Re<<20&4294967295|Re>>>12),Re=de+(me^Te&(Ee^me))+$e[13]+2850285829&4294967295,de=Ee+(Re<<5&4294967295|Re>>>27),Re=Te+(Ee^me&(de^Ee))+$e[2]+4243563512&4294967295,Te=de+(Re<<9&4294967295|Re>>>23),Re=me+(de^Ee&(Te^de))+$e[7]+1735328473&4294967295,me=Te+(Re<<14&4294967295|Re>>>18),Re=Ee+(Te^de&(me^Te))+$e[12]+2368359562&4294967295,Ee=me+(Re<<20&4294967295|Re>>>12),Re=de+(Ee^me^Te)+$e[5]+4294588738&4294967295,de=Ee+(Re<<4&4294967295|Re>>>28),Re=Te+(de^Ee^me)+$e[8]+2272392833&4294967295,Te=de+(Re<<11&4294967295|Re>>>21),Re=me+(Te^de^Ee)+$e[11]+1839030562&4294967295,me=Te+(Re<<16&4294967295|Re>>>16),Re=Ee+(me^Te^de)+$e[14]+4259657740&4294967295,Ee=me+(Re<<23&4294967295|Re>>>9),Re=de+(Ee^me^Te)+$e[1]+2763975236&4294967295,de=Ee+(Re<<4&4294967295|Re>>>28),Re=Te+(de^Ee^me)+$e[4]+1272893353&4294967295,Te=de+(Re<<11&4294967295|Re>>>21),Re=me+(Te^de^Ee)+$e[7]+4139469664&4294967295,me=Te+(Re<<16&4294967295|Re>>>16),Re=Ee+(me^Te^de)+$e[10]+3200236656&4294967295,Ee=me+(Re<<23&4294967295|Re>>>9),Re=de+(Ee^me^Te)+$e[13]+681279174&4294967295,de=Ee+(Re<<4&4294967295|Re>>>28),Re=Te+(de^Ee^me)+$e[0]+3936430074&4294967295,Te=de+(Re<<11&4294967295|Re>>>21),Re=me+(Te^de^Ee)+$e[3]+3572445317&4294967295,me=Te+(Re<<16&4294967295|Re>>>16),Re=Ee+(me^Te^de)+$e[6]+76029189&4294967295,Ee=me+(Re<<23&4294967295|Re>>>9),Re=de+(Ee^me^Te)+$e[9]+3654602809&4294967295,de=Ee+(Re<<4&4294967295|Re>>>28),Re=Te+(de^Ee^me)+$e[12]+3873151461&4294967295,Te=de+(Re<<11&4294967295|Re>>>21),Re=me+(Te^de^Ee)+$e[15]+530742520&4294967295,me=Te+(Re<<16&4294967295|Re>>>16),Re=Ee+(me^Te^de)+$e[2]+3299628645&4294967295,Ee=me+(Re<<23&4294967295|Re>>>9),Re=de+(me^(Ee|~Te))+$e[0]+4096336452&4294967295,de=Ee+(Re<<6&4294967295|Re>>>26),Re=Te+(Ee^(de|~me))+$e[7]+1126891415&4294967295,Te=de+(Re<<10&4294967295|Re>>>22),Re=me+(de^(Te|~Ee))+$e[14]+2878612391&4294967295,me=Te+(Re<<15&4294967295|Re>>>17),Re=Ee+(Te^(me|~de))+$e[5]+4237533241&4294967295,Ee=me+(Re<<21&4294967295|Re>>>11),Re=de+(me^(Ee|~Te))+$e[12]+1700485571&4294967295,de=Ee+(Re<<6&4294967295|Re>>>26),Re=Te+(Ee^(de|~me))+$e[3]+2399980690&4294967295,Te=de+(Re<<10&4294967295|Re>>>22),Re=me+(de^(Te|~Ee))+$e[10]+4293915773&4294967295,me=Te+(Re<<15&4294967295|Re>>>17),Re=Ee+(Te^(me|~de))+$e[1]+2240044497&4294967295,Ee=me+(Re<<21&4294967295|Re>>>11),Re=de+(me^(Ee|~Te))+$e[8]+1873313359&4294967295,de=Ee+(Re<<6&4294967295|Re>>>26),Re=Te+(Ee^(de|~me))+$e[15]+4264355552&4294967295,Te=de+(Re<<10&4294967295|Re>>>22),Re=me+(de^(Te|~Ee))+$e[6]+2734768916&4294967295,me=Te+(Re<<15&4294967295|Re>>>17),Re=Ee+(Te^(me|~de))+$e[13]+1309151649&4294967295,Ee=me+(Re<<21&4294967295|Re>>>11),Re=de+(me^(Ee|~Te))+$e[4]+4149444226&4294967295,de=Ee+(Re<<6&4294967295|Re>>>26),Re=Te+(Ee^(de|~me))+$e[11]+3174756917&4294967295,Te=de+(Re<<10&4294967295|Re>>>22),Re=me+(de^(Te|~Ee))+$e[2]+718787259&4294967295,me=Te+(Re<<15&4294967295|Re>>>17),Re=Ee+(Te^(me|~de))+$e[9]+3951481745&4294967295,oe.g[0]=oe.g[0]+de&4294967295,oe.g[1]=oe.g[1]+(me+(Re<<21&4294967295|Re>>>11))&4294967295,oe.g[2]=oe.g[2]+me&4294967295,oe.g[3]=oe.g[3]+Te&4294967295}r.prototype.v=function(oe,de){de===void 0&&(de=oe.length);const Ee=de-this.blockSize,$e=this.C;let me=this.h,Te=0;for(;Te<de;){if(me==0)for(;Te<=Ee;)c(this,oe,Te),Te+=this.blockSize;if(typeof oe=="string"){for(;Te<de;)if($e[me++]=oe.charCodeAt(Te++),me==this.blockSize){c(this,$e),me=0;break}}else for(;Te<de;)if($e[me++]=oe[Te++],me==this.blockSize){c(this,$e),me=0;break}}this.h=me,this.o+=de},r.prototype.A=function(){var oe=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);oe[0]=128;for(var de=1;de<oe.length-8;++de)oe[de]=0;de=this.o*8;for(var Ee=oe.length-8;Ee<oe.length;++Ee)oe[Ee]=de&255,de/=256;for(this.v(oe),oe=Array(16),de=0,Ee=0;Ee<4;++Ee)for(let $e=0;$e<32;$e+=8)oe[de++]=this.g[Ee]>>>$e&255;return oe};function u(oe,de){var Ee=o;return Object.prototype.hasOwnProperty.call(Ee,oe)?Ee[oe]:Ee[oe]=de(oe)}function p(oe,de){this.h=de;const Ee=[];let $e=!0;for(let me=oe.length-1;me>=0;me--){const Te=oe[me]|0;$e&&Te==de||(Ee[me]=Te,$e=!1)}this.g=Ee}var o={};function w(oe){return-128<=oe&&oe<128?u(oe,function(de){return new p([de|0],de<0?-1:0)}):new p([oe|0],oe<0?-1:0)}function T(oe){if(isNaN(oe)||!isFinite(oe))return D;if(oe<0)return se(T(-oe));const de=[];let Ee=1;for(let $e=0;oe>=Ee;$e++)de[$e]=oe/Ee|0,Ee*=4294967296;return new p(de,0)}function A(oe,de){if(oe.length==0)throw Error("number format error: empty string");if(de=de||10,de<2||36<de)throw Error("radix out of range: "+de);if(oe.charAt(0)=="-")return se(A(oe.substring(1),de));if(oe.indexOf("-")>=0)throw Error('number format error: interior "-" character');const Ee=T(Math.pow(de,8));let $e=D;for(let Te=0;Te<oe.length;Te+=8){var me=Math.min(8,oe.length-Te);const Re=parseInt(oe.substring(Te,Te+me),de);me<8?(me=T(Math.pow(de,me)),$e=$e.j(me).add(T(Re))):($e=$e.j(Ee),$e=$e.add(T(Re)))}return $e}var D=w(0),B=w(1),N=w(16777216);t=p.prototype,t.m=function(){if(Q(this))return-se(this).m();let oe=0,de=1;for(let Ee=0;Ee<this.g.length;Ee++){const $e=this.i(Ee);oe+=($e>=0?$e:4294967296+$e)*de,de*=4294967296}return oe},t.toString=function(oe){if(oe=oe||10,oe<2||36<oe)throw Error("radix out of range: "+oe);if(ee(this))return"0";if(Q(this))return"-"+se(this).toString(oe);const de=T(Math.pow(oe,6));var Ee=this;let $e="";for(;;){const me=xe(Ee,de).g;Ee=ce(Ee,me.j(de));let Te=((Ee.g.length>0?Ee.g[0]:Ee.h)>>>0).toString(oe);if(Ee=me,ee(Ee))return Te+$e;for(;Te.length<6;)Te="0"+Te;$e=Te+$e}},t.i=function(oe){return oe<0?0:oe<this.g.length?this.g[oe]:this.h};function ee(oe){if(oe.h!=0)return!1;for(let de=0;de<oe.g.length;de++)if(oe.g[de]!=0)return!1;return!0}function Q(oe){return oe.h==-1}t.l=function(oe){return oe=ce(this,oe),Q(oe)?-1:ee(oe)?0:1};function se(oe){const de=oe.g.length,Ee=[];for(let $e=0;$e<de;$e++)Ee[$e]=~oe.g[$e];return new p(Ee,~oe.h).add(B)}t.abs=function(){return Q(this)?se(this):this},t.add=function(oe){const de=Math.max(this.g.length,oe.g.length),Ee=[];let $e=0;for(let me=0;me<=de;me++){let Te=$e+(this.i(me)&65535)+(oe.i(me)&65535),Re=(Te>>>16)+(this.i(me)>>>16)+(oe.i(me)>>>16);$e=Re>>>16,Te&=65535,Re&=65535,Ee[me]=Re<<16|Te}return new p(Ee,Ee[Ee.length-1]&-2147483648?-1:0)};function ce(oe,de){return oe.add(se(de))}t.j=function(oe){if(ee(this)||ee(oe))return D;if(Q(this))return Q(oe)?se(this).j(se(oe)):se(se(this).j(oe));if(Q(oe))return se(this.j(se(oe)));if(this.l(N)<0&&oe.l(N)<0)return T(this.m()*oe.m());const de=this.g.length+oe.g.length,Ee=[];for(var $e=0;$e<2*de;$e++)Ee[$e]=0;for($e=0;$e<this.g.length;$e++)for(let me=0;me<oe.g.length;me++){const Te=this.i($e)>>>16,Re=this.i($e)&65535,tn=oe.i(me)>>>16,Zt=oe.i(me)&65535;Ee[2*$e+2*me]+=Re*Zt,be(Ee,2*$e+2*me),Ee[2*$e+2*me+1]+=Te*Zt,be(Ee,2*$e+2*me+1),Ee[2*$e+2*me+1]+=Re*tn,be(Ee,2*$e+2*me+1),Ee[2*$e+2*me+2]+=Te*tn,be(Ee,2*$e+2*me+2)}for(oe=0;oe<de;oe++)Ee[oe]=Ee[2*oe+1]<<16|Ee[2*oe];for(oe=de;oe<2*de;oe++)Ee[oe]=0;return new p(Ee,0)};function be(oe,de){for(;(oe[de]&65535)!=oe[de];)oe[de+1]+=oe[de]>>>16,oe[de]&=65535,de++}function ze(oe,de){this.g=oe,this.h=de}function xe(oe,de){if(ee(de))throw Error("division by zero");if(ee(oe))return new ze(D,D);if(Q(oe))return de=xe(se(oe),de),new ze(se(de.g),se(de.h));if(Q(de))return de=xe(oe,se(de)),new ze(se(de.g),de.h);if(oe.g.length>30){if(Q(oe)||Q(de))throw Error("slowDivide_ only works with positive integers.");for(var Ee=B,$e=de;$e.l(oe)<=0;)Ee=je(Ee),$e=je($e);var me=qe(Ee,1),Te=qe($e,1);for($e=qe($e,2),Ee=qe(Ee,2);!ee($e);){var Re=Te.add($e);Re.l(oe)<=0&&(me=me.add(Ee),Te=Re),$e=qe($e,1),Ee=qe(Ee,1)}return de=ce(oe,me.j(de)),new ze(me,de)}for(me=D;oe.l(de)>=0;){for(Ee=Math.max(1,Math.floor(oe.m()/de.m())),$e=Math.ceil(Math.log(Ee)/Math.LN2),$e=$e<=48?1:Math.pow(2,$e-48),Te=T(Ee),Re=Te.j(de);Q(Re)||Re.l(oe)>0;)Ee-=$e,Te=T(Ee),Re=Te.j(de);ee(Te)&&(Te=B),me=me.add(Te),oe=ce(oe,Re)}return new ze(me,oe)}t.B=function(oe){return xe(this,oe).h},t.and=function(oe){const de=Math.max(this.g.length,oe.g.length),Ee=[];for(let $e=0;$e<de;$e++)Ee[$e]=this.i($e)&oe.i($e);return new p(Ee,this.h&oe.h)},t.or=function(oe){const de=Math.max(this.g.length,oe.g.length),Ee=[];for(let $e=0;$e<de;$e++)Ee[$e]=this.i($e)|oe.i($e);return new p(Ee,this.h|oe.h)},t.xor=function(oe){const de=Math.max(this.g.length,oe.g.length),Ee=[];for(let $e=0;$e<de;$e++)Ee[$e]=this.i($e)^oe.i($e);return new p(Ee,this.h^oe.h)};function je(oe){const de=oe.g.length+1,Ee=[];for(let $e=0;$e<de;$e++)Ee[$e]=oe.i($e)<<1|oe.i($e-1)>>>31;return new p(Ee,oe.h)}function qe(oe,de){const Ee=de>>5;de%=32;const $e=oe.g.length-Ee,me=[];for(let Te=0;Te<$e;Te++)me[Te]=de>0?oe.i(Te+Ee)>>>de|oe.i(Te+Ee+1)<<32-de:oe.i(Te+Ee);return new p(me,oe.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,p.prototype.add=p.prototype.add,p.prototype.multiply=p.prototype.j,p.prototype.modulo=p.prototype.B,p.prototype.compare=p.prototype.l,p.prototype.toNumber=p.prototype.m,p.prototype.toString=p.prototype.toString,p.prototype.getBits=p.prototype.i,p.fromNumber=T,p.fromString=A,UI=p}).apply(typeof VO<"u"?VO:typeof self<"u"?self:typeof window<"u"?window:{});var yx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};(function(){var t,e=Object.defineProperty;function n(M){M=[typeof globalThis=="object"&&globalThis,M,typeof window=="object"&&window,typeof self=="object"&&self,typeof yx=="object"&&yx];for(var J=0;J<M.length;++J){var le=M[J];if(le&&le.Math==Math)return le}throw Error("Cannot find global object")}var r=n(this);function c(M,J){if(J)e:{var le=r;M=M.split(".");for(var Ne=0;Ne<M.length-1;Ne++){var Ct=M[Ne];if(!(Ct in le))break e;le=le[Ct]}M=M[M.length-1],Ne=le[M],J=J(Ne),J!=Ne&&J!=null&&e(le,M,{configurable:!0,writable:!0,value:J})}}c("Symbol.dispose",function(M){return M||Symbol("Symbol.dispose")}),c("Array.prototype.values",function(M){return M||function(){return this[Symbol.iterator]()}}),c("Object.entries",function(M){return M||function(J){var le=[],Ne;for(Ne in J)Object.prototype.hasOwnProperty.call(J,Ne)&&le.push([Ne,J[Ne]]);return le}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var u=u||{},p=this||self;function o(M){var J=typeof M;return J=="object"&&M!=null||J=="function"}function w(M,J,le){return M.call.apply(M.bind,arguments)}function T(M,J,le){return T=w,T.apply(null,arguments)}function A(M,J){var le=Array.prototype.slice.call(arguments,1);return function(){var Ne=le.slice();return Ne.push.apply(Ne,arguments),M.apply(this,Ne)}}function D(M,J){function le(){}le.prototype=J.prototype,M.Z=J.prototype,M.prototype=new le,M.prototype.constructor=M,M.Ob=function(Ne,Ct,kt){for(var Nn=Array(arguments.length-2),Gi=2;Gi<arguments.length;Gi++)Nn[Gi-2]=arguments[Gi];return J.prototype[Ct].apply(Ne,Nn)}}var B=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?M=>M&&AsyncContext.Snapshot.wrap(M):M=>M;function N(M){const J=M.length;if(J>0){const le=Array(J);for(let Ne=0;Ne<J;Ne++)le[Ne]=M[Ne];return le}return[]}function ee(M,J){for(let Ne=1;Ne<arguments.length;Ne++){const Ct=arguments[Ne];var le=typeof Ct;if(le=le!="object"?le:Ct?Array.isArray(Ct)?"array":le:"null",le=="array"||le=="object"&&typeof Ct.length=="number"){le=M.length||0;const kt=Ct.length||0;M.length=le+kt;for(let Nn=0;Nn<kt;Nn++)M[le+Nn]=Ct[Nn]}else M.push(Ct)}}class Q{constructor(J,le){this.i=J,this.j=le,this.h=0,this.g=null}get(){let J;return this.h>0?(this.h--,J=this.g,this.g=J.next,J.next=null):J=this.i(),J}}function se(M){p.setTimeout(()=>{throw M},0)}function ce(){var M=oe;let J=null;return M.g&&(J=M.g,M.g=M.g.next,M.g||(M.h=null),J.next=null),J}class be{constructor(){this.h=this.g=null}add(J,le){const Ne=ze.get();Ne.set(J,le),this.h?this.h.next=Ne:this.g=Ne,this.h=Ne}}var ze=new Q(()=>new xe,M=>M.reset());class xe{constructor(){this.next=this.g=this.h=null}set(J,le){this.h=J,this.g=le,this.next=null}reset(){this.next=this.g=this.h=null}}let je,qe=!1,oe=new be,de=()=>{const M=Promise.resolve(void 0);je=()=>{M.then(Ee)}};function Ee(){for(var M;M=ce();){try{M.h.call(M.g)}catch(le){se(le)}var J=ze;J.j(M),J.h<100&&(J.h++,M.next=J.g,J.g=M)}qe=!1}function $e(){this.u=this.u,this.C=this.C}$e.prototype.u=!1,$e.prototype.dispose=function(){this.u||(this.u=!0,this.N())},$e.prototype[Symbol.dispose]=function(){this.dispose()},$e.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function me(M,J){this.type=M,this.g=this.target=J,this.defaultPrevented=!1}me.prototype.h=function(){this.defaultPrevented=!0};var Te=function(){if(!p.addEventListener||!Object.defineProperty)return!1;var M=!1,J=Object.defineProperty({},"passive",{get:function(){M=!0}});try{const le=()=>{};p.addEventListener("test",le,J),p.removeEventListener("test",le,J)}catch{}return M}();function Re(M){return/^[\s\xa0]*$/.test(M)}function tn(M,J){me.call(this,M?M.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,M&&this.init(M,J)}D(tn,me),tn.prototype.init=function(M,J){const le=this.type=M.type,Ne=M.changedTouches&&M.changedTouches.length?M.changedTouches[0]:null;this.target=M.target||M.srcElement,this.g=J,J=M.relatedTarget,J||(le=="mouseover"?J=M.fromElement:le=="mouseout"&&(J=M.toElement)),this.relatedTarget=J,Ne?(this.clientX=Ne.clientX!==void 0?Ne.clientX:Ne.pageX,this.clientY=Ne.clientY!==void 0?Ne.clientY:Ne.pageY,this.screenX=Ne.screenX||0,this.screenY=Ne.screenY||0):(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0),this.button=M.button,this.key=M.key||"",this.ctrlKey=M.ctrlKey,this.altKey=M.altKey,this.shiftKey=M.shiftKey,this.metaKey=M.metaKey,this.pointerId=M.pointerId||0,this.pointerType=M.pointerType,this.state=M.state,this.i=M,M.defaultPrevented&&tn.Z.h.call(this)},tn.prototype.h=function(){tn.Z.h.call(this);const M=this.i;M.preventDefault?M.preventDefault():M.returnValue=!1};var Zt="closure_listenable_"+(Math.random()*1e6|0),on=0;function hn(M,J,le,Ne,Ct){this.listener=M,this.proxy=null,this.src=J,this.type=le,this.capture=!!Ne,this.ha=Ct,this.key=++on,this.da=this.fa=!1}function Hn(M){M.da=!0,M.listener=null,M.proxy=null,M.src=null,M.ha=null}function Ri(M,J,le){for(const Ne in M)J.call(le,M[Ne],Ne,M)}function zi(M,J){for(const le in M)J.call(void 0,M[le],le,M)}function Pt(M){const J={};for(const le in M)J[le]=M[le];return J}const Di="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function wo(M,J){let le,Ne;for(let Ct=1;Ct<arguments.length;Ct++){Ne=arguments[Ct];for(le in Ne)M[le]=Ne[le];for(let kt=0;kt<Di.length;kt++)le=Di[kt],Object.prototype.hasOwnProperty.call(Ne,le)&&(M[le]=Ne[le])}}function Ur(M){this.src=M,this.g={},this.h=0}Ur.prototype.add=function(M,J,le,Ne,Ct){const kt=M.toString();M=this.g[kt],M||(M=this.g[kt]=[],this.h++);const Nn=ai(M,J,Ne,Ct);return Nn>-1?(J=M[Nn],le||(J.fa=!1)):(J=new hn(J,this.src,kt,!!Ne,Ct),J.fa=le,M.push(J)),J};function Br(M,J){const le=J.type;if(le in M.g){var Ne=M.g[le],Ct=Array.prototype.indexOf.call(Ne,J,void 0),kt;(kt=Ct>=0)&&Array.prototype.splice.call(Ne,Ct,1),kt&&(Hn(J),M.g[le].length==0&&(delete M.g[le],M.h--))}}function ai(M,J,le,Ne){for(let Ct=0;Ct<M.length;++Ct){const kt=M[Ct];if(!kt.da&&kt.listener==J&&kt.capture==!!le&&kt.ha==Ne)return Ct}return-1}var Ft="closure_lm_"+(Math.random()*1e6|0),In={};function Wt(M,J,le,Ne,Ct){if(Array.isArray(J)){for(let kt=0;kt<J.length;kt++)Wt(M,J[kt],le,Ne,Ct);return null}return le=On(le),M&&M[Zt]?M.J(J,le,o(Ne)?!!Ne.capture:!1,Ct):kn(M,J,le,!1,Ne,Ct)}function kn(M,J,le,Ne,Ct,kt){if(!J)throw Error("Invalid event type");const Nn=o(Ct)?!!Ct.capture:!!Ct;let Gi=an(M);if(Gi||(M[Ft]=Gi=new Ur(M)),le=Gi.add(J,le,Ne,Nn,kt),le.proxy)return le;if(Ne=dr(),le.proxy=Ne,Ne.src=M,Ne.listener=le,M.addEventListener)Te||(Ct=Nn),Ct===void 0&&(Ct=!1),M.addEventListener(J.toString(),Ne,Ct);else if(M.attachEvent)M.attachEvent(vt(J.toString()),Ne);else if(M.addListener&&M.removeListener)M.addListener(Ne);else throw Error("addEventListener and attachEvent are unavailable.");return le}function dr(){function M(le){return J.call(M.src,M.listener,le)}const J=Gt;return M}function Qe(M,J,le,Ne,Ct){if(Array.isArray(J))for(var kt=0;kt<J.length;kt++)Qe(M,J[kt],le,Ne,Ct);else Ne=o(Ne)?!!Ne.capture:!!Ne,le=On(le),M&&M[Zt]?(M=M.i,kt=String(J).toString(),kt in M.g&&(J=M.g[kt],le=ai(J,le,Ne,Ct),le>-1&&(Hn(J[le]),Array.prototype.splice.call(J,le,1),J.length==0&&(delete M.g[kt],M.h--)))):M&&(M=an(M))&&(J=M.g[J.toString()],M=-1,J&&(M=ai(J,le,Ne,Ct)),(le=M>-1?J[M]:null)&&at(le))}function at(M){if(typeof M!="number"&&M&&!M.da){var J=M.src;if(J&&J[Zt])Br(J.i,M);else{var le=M.type,Ne=M.proxy;J.removeEventListener?J.removeEventListener(le,Ne,M.capture):J.detachEvent?J.detachEvent(vt(le),Ne):J.addListener&&J.removeListener&&J.removeListener(Ne),(le=an(J))?(Br(le,M),le.h==0&&(le.src=null,J[Ft]=null)):Hn(M)}}}function vt(M){return M in In?In[M]:In[M]="on"+M}function Gt(M,J){if(M.da)M=!0;else{J=new tn(J,this);const le=M.listener,Ne=M.ha||M.src;M.fa&&at(M),M=le.call(Ne,J)}return M}function an(M){return M=M[Ft],M instanceof Ur?M:null}var Qt="__closure_events_fn_"+(Math.random()*1e9>>>0);function On(M){return typeof M=="function"?M:(M[Qt]||(M[Qt]=function(J){return M.handleEvent(J)}),M[Qt])}function fn(){$e.call(this),this.i=new Ur(this),this.M=this,this.G=null}D(fn,$e),fn.prototype[Zt]=!0,fn.prototype.removeEventListener=function(M,J,le,Ne){Qe(this,M,J,le,Ne)};function mn(M,J){var le,Ne=M.G;if(Ne)for(le=[];Ne;Ne=Ne.G)le.push(Ne);if(M=M.M,Ne=J.type||J,typeof J=="string")J=new me(J,M);else if(J instanceof me)J.target=J.target||M;else{var Ct=J;J=new me(Ne,M),wo(J,Ct)}Ct=!0;let kt,Nn;if(le)for(Nn=le.length-1;Nn>=0;Nn--)kt=J.g=le[Nn],Ct=dn(kt,Ne,!0,J)&&Ct;if(kt=J.g=M,Ct=dn(kt,Ne,!0,J)&&Ct,Ct=dn(kt,Ne,!1,J)&&Ct,le)for(Nn=0;Nn<le.length;Nn++)kt=J.g=le[Nn],Ct=dn(kt,Ne,!1,J)&&Ct}fn.prototype.N=function(){if(fn.Z.N.call(this),this.i){var M=this.i;for(const J in M.g){const le=M.g[J];for(let Ne=0;Ne<le.length;Ne++)Hn(le[Ne]);delete M.g[J],M.h--}}this.G=null},fn.prototype.J=function(M,J,le,Ne){return this.i.add(String(M),J,!1,le,Ne)},fn.prototype.K=function(M,J,le,Ne){return this.i.add(String(M),J,!0,le,Ne)};function dn(M,J,le,Ne){if(J=M.i.g[String(J)],!J)return!0;J=J.concat();let Ct=!0;for(let kt=0;kt<J.length;++kt){const Nn=J[kt];if(Nn&&!Nn.da&&Nn.capture==le){const Gi=Nn.listener,Jo=Nn.ha||Nn.src;Nn.fa&&Br(M.i,Nn),Ct=Gi.call(Jo,Ne)!==!1&&Ct}}return Ct&&!Ne.defaultPrevented}function pi(M,J){if(typeof M!="function")if(M&&typeof M.handleEvent=="function")M=T(M.handleEvent,M);else throw Error("Invalid listener argument");return Number(J)>2147483647?-1:p.setTimeout(M,J||0)}function Ln(M){M.g=pi(()=>{M.g=null,M.i&&(M.i=!1,Ln(M))},M.l);const J=M.h;M.h=null,M.m.apply(null,J)}class mi extends $e{constructor(J,le){super(),this.m=J,this.l=le,this.h=null,this.i=!1,this.g=null}j(J){this.h=arguments,this.g?this.i=!0:Ln(this)}N(){super.N(),this.g&&(p.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function yi(M){$e.call(this),this.h=M,this.g={}}D(yi,$e);var xi=[];function nr(M){Ri(M.g,function(J,le){this.g.hasOwnProperty(le)&&at(J)},M),M.g={}}yi.prototype.N=function(){yi.Z.N.call(this),nr(this)},yi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var yr=p.JSON.stringify,zo=p.JSON.parse,Io=class{stringify(M){return p.JSON.stringify(M,void 0)}parse(M){return p.JSON.parse(M,void 0)}};function Sr(){}function ho(){}var Cs={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ha(){me.call(this,"d")}D(ha,me);function ao(){me.call(this,"c")}D(ao,me);var Ao={},Fa=null;function vr(){return Fa=Fa||new fn}Ao.Ia="serverreachability";function ns(M){me.call(this,Ao.Ia,M)}D(ns,me);function _l(M){const J=vr();mn(J,new ns(J))}Ao.STAT_EVENT="statevent";function Wl(M,J){me.call(this,Ao.STAT_EVENT,M),this.stat=J}D(Wl,me);function So(M){const J=vr();mn(J,new Wl(J,M))}Ao.Ja="timingevent";function yl(M,J){me.call(this,Ao.Ja,M),this.size=J}D(yl,me);function Xa(M,J){if(typeof M!="function")throw Error("Fn must not be null and must be a function");return p.setTimeout(function(){M()},J)}function vl(){this.g=!0}vl.prototype.ua=function(){this.g=!1};function Dt(M,J,le,Ne,Ct,kt){M.info(function(){if(M.g)if(kt){var Nn="",Gi=kt.split("&");for(let Hr=0;Hr<Gi.length;Hr++){var Jo=Gi[Hr].split("=");if(Jo.length>1){const fo=Jo[0];Jo=Jo[1];const jo=fo.split("_");Nn=jo.length>=2&&jo[1]=="type"?Nn+(fo+"="+Jo+"&"):Nn+(fo+"=redacted&")}}}else Nn=null;else Nn=kt;return"XMLHTTP REQ ("+Ne+") [attempt "+Ct+"]: "+J+`
`+le+`
`+Nn})}function bl(M,J,le,Ne,Ct,kt,Nn){M.info(function(){return"XMLHTTP RESP ("+Ne+") [ attempt "+Ct+"]: "+J+`
`+le+`
`+kt+" "+Nn})}function ql(M,J,le,Ne){M.info(function(){return"XMLHTTP TEXT ("+J+"): "+Xe(M,le)+(Ne?" "+Ne:"")})}function $c(M,J){M.info(function(){return"TIMEOUT: "+J})}vl.prototype.info=function(){};function Xe(M,J){if(!M.g)return J;if(!J)return null;try{const kt=JSON.parse(J);if(kt){for(M=0;M<kt.length;M++)if(Array.isArray(kt[M])){var le=kt[M];if(!(le.length<2)){var Ne=le[1];if(Array.isArray(Ne)&&!(Ne.length<1)){var Ct=Ne[0];if(Ct!="noop"&&Ct!="stop"&&Ct!="close")for(let Nn=1;Nn<Ne.length;Nn++)Ne[Nn]=""}}}}return yr(kt)}catch{return J}}var Y={NO_ERROR:0,TIMEOUT:8},ie={},ve;function Fe(){}D(Fe,Sr),Fe.prototype.g=function(){return new XMLHttpRequest},ve=new Fe;function Oe(M){return encodeURIComponent(String(M))}function Le(M){var J=1;M=M.split(":");const le=[];for(;J>0&&M.length;)le.push(M.shift()),J--;return M.length&&le.push(M.join(":")),le}function it(M,J,le,Ne){this.j=M,this.i=J,this.l=le,this.S=Ne||1,this.V=new yi(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ge}function Ge(){this.i=null,this.g="",this.h=!1}var st={},Nt={};function St(M,J,le){M.M=1,M.A=wl(Zs(J)),M.u=le,M.R=!0,xn(M,null)}function xn(M,J){M.F=Date.now(),Un(M),M.B=Zs(M.A);var le=M.B,Ne=M.S;Array.isArray(Ne)||(Ne=[String(Ne)]),Zl(le.i,"t",Ne),M.C=0,le=M.j.L,M.h=new Ge,M.g=ja(M.j,le?J:null,!M.u),M.P>0&&(M.O=new mi(T(M.Y,M,M.g),M.P)),J=M.V,le=M.g,Ne=M.ba;var Ct="readystatechange";Array.isArray(Ct)||(Ct&&(xi[0]=Ct.toString()),Ct=xi);for(let kt=0;kt<Ct.length;kt++){const Nn=Wt(le,Ct[kt],Ne||J.handleEvent,!1,J.h||J);if(!Nn)break;J.g[Nn.key]=Nn}J=M.J?Pt(M.J):{},M.u?(M.v||(M.v="POST"),J["Content-Type"]="application/x-www-form-urlencoded",M.g.ea(M.B,M.v,M.u,J)):(M.v="GET",M.g.ea(M.B,M.v,null,J)),_l(),Dt(M.i,M.v,M.B,M.l,M.S,M.u)}it.prototype.ba=function(M){M=M.target;const J=this.O;J&&na(M)==3?J.j():this.Y(M)},it.prototype.Y=function(M){try{if(M==this.g)e:{const Gi=na(this.g),Jo=this.g.ya(),Hr=this.g.ca();if(!(Gi<3)&&(Gi!=3||this.g&&(this.h.h||this.g.la()||ku(this.g)))){this.K||Gi!=4||Jo==7||(Jo==8||Hr<=0?_l(3):_l(2)),Ei(this);var J=this.g.ca();this.X=J;var le=Mn(this);if(this.o=J==200,bl(this.i,this.v,this.B,this.l,this.S,Gi,J),this.o){if(this.U&&!this.L){t:{if(this.g){var Ne,Ct=this.g;if((Ne=Ct.g?Ct.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Re(Ne)){var kt=Ne;break t}}kt=null}if(M=kt)ql(this.i,this.l,M,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Fr(this,M);else{this.o=!1,this.m=3,So(12),cr(this),li(this);break e}}if(this.R){M=!0;let fo;for(;!this.K&&this.C<le.length;)if(fo=Kn(this,le),fo==Nt){Gi==4&&(this.m=4,So(14),M=!1),ql(this.i,this.l,null,"[Incomplete Response]");break}else if(fo==st){this.m=4,So(15),ql(this.i,this.l,le,"[Invalid Chunk]"),M=!1;break}else ql(this.i,this.l,fo,null),Fr(this,fo);if(zn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Gi!=4||le.length!=0||this.h.h||(this.m=1,So(16),M=!1),this.o=this.o&&M,!M)ql(this.i,this.l,le,"[Invalid Chunked Response]"),cr(this),li(this);else if(le.length>0&&!this.W){this.W=!0;var Nn=this.j;Nn.g==this&&Nn.aa&&!Nn.P&&(Nn.j.info("Great, no buffering proxy detected. Bytes received: "+le.length),Zc(Nn),Nn.P=!0,So(11))}}else ql(this.i,this.l,le,null),Fr(this,le);Gi==4&&cr(this),this.o&&!this.K&&(Gi==4?Pn(this.j,this):(this.o=!1,Un(this)))}else Ru(this.g),J==400&&le.indexOf("Unknown SID")>0?(this.m=3,So(12)):(this.m=0,So(13)),cr(this),li(this)}}}catch{}finally{}};function Mn(M){if(!zn(M))return M.g.la();const J=ku(M.g);if(J==="")return"";let le="";const Ne=J.length,Ct=na(M.g)==4;if(!M.h.i){if(typeof TextDecoder>"u")return cr(M),li(M),"";M.h.i=new p.TextDecoder}for(let kt=0;kt<Ne;kt++)M.h.h=!0,le+=M.h.i.decode(J[kt],{stream:!(Ct&&kt==Ne-1)});return J.length=0,M.h.g+=le,M.C=0,M.h.g}function zn(M){return M.g?M.v=="GET"&&M.M!=2&&M.j.Aa:!1}function Kn(M,J){var le=M.C,Ne=J.indexOf(`
`,le);return Ne==-1?Nt:(le=Number(J.substring(le,Ne)),isNaN(le)?st:(Ne+=1,Ne+le>J.length?Nt:(J=J.slice(Ne,Ne+le),M.C=Ne+le,J)))}it.prototype.cancel=function(){this.K=!0,cr(this)};function Un(M){M.T=Date.now()+M.H,ei(M,M.H)}function ei(M,J){if(M.D!=null)throw Error("WatchDog timer not null");M.D=Xa(T(M.aa,M),J)}function Ei(M){M.D&&(p.clearTimeout(M.D),M.D=null)}it.prototype.aa=function(){this.D=null;const M=Date.now();M-this.T>=0?($c(this.i,this.B),this.M!=2&&(_l(),So(17)),cr(this),this.m=2,li(this)):ei(this,this.T-M)};function li(M){M.j.I==0||M.K||Pn(M.j,M)}function cr(M){Ei(M);var J=M.O;J&&typeof J.dispose=="function"&&J.dispose(),M.O=null,nr(M.V),M.g&&(J=M.g,M.g=null,J.abort(),J.dispose())}function Fr(M,J){try{var le=M.j;if(le.I!=0&&(le.g==M||Pr(le.h,M))){if(!M.L&&Pr(le.h,M)&&le.I==3){try{var Ne=le.Ba.g.parse(J)}catch{Ne=null}if(Array.isArray(Ne)&&Ne.length==3){var Ct=Ne;if(Ct[0]==0){e:if(!le.v){if(le.g)if(le.g.F+3e3<M.F)Jl(le),el(le);else break e;Bi(le),So(18)}}else le.xa=Ct[1],0<le.xa-le.K&&Ct[2]<37500&&le.F&&le.A==0&&!le.C&&(le.C=Xa(T(le.Va,le),6e3));Cr(le.h)<=1&&le.ta&&(le.ta=void 0)}else us(le,11)}else if((M.L||le.g==M)&&Jl(le),!Re(J))for(Ct=le.Ba.g.parse(J),J=0;J<Ct.length;J++){let Hr=Ct[J];const fo=Hr[0];if(!(fo<=le.K))if(le.K=fo,Hr=Hr[1],le.I==2)if(Hr[0]=="c"){le.M=Hr[1],le.ba=Hr[2];const jo=Hr[3];jo!=null&&(le.ka=jo,le.j.info("VER="+le.ka));const tl=Hr[4];tl!=null&&(le.za=tl,le.j.info("SVER="+le.za));const Co=Hr[5];Co!=null&&typeof Co=="number"&&Co>0&&(Ne=1.5*Co,le.O=Ne,le.j.info("backChannelRequestTimeoutMs_="+Ne)),Ne=le;const As=M.g;if(As){const ks=As.g?As.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ks){var kt=Ne.h;kt.g||ks.indexOf("spdy")==-1&&ks.indexOf("quic")==-1&&ks.indexOf("h2")==-1||(kt.j=kt.l,kt.g=new Set,kt.h&&(ur(kt,kt.h),kt.h=null))}if(Ne.G){const _d=As.g?As.g.getResponseHeader("X-HTTP-Session-Id"):null;_d&&(Ne.wa=_d,Xr(Ne.J,Ne.G,_d))}}le.I=3,le.l&&le.l.ra(),le.aa&&(le.T=Date.now()-M.F,le.j.info("Handshake RTT: "+le.T+"ms")),Ne=le;var Nn=M;if(Ne.na=Ql(Ne,Ne.L?Ne.ba:null,Ne.W),Nn.L){Zo(Ne.h,Nn);var Gi=Nn,Jo=Ne.O;Jo&&(Gi.H=Jo),Gi.D&&(Ei(Gi),Un(Gi)),Ne.g=Nn}else Pu(Ne);le.i.length>0&&$s(le)}else Hr[0]!="stop"&&Hr[0]!="close"||us(le,7);else le.I==3&&(Hr[0]=="stop"||Hr[0]=="close"?Hr[0]=="stop"?us(le,7):Vs(le):Hr[0]!="noop"&&le.l&&le.l.qa(Hr),le.A=0)}}_l(4)}catch{}}var no=class{constructor(M,J){this.g=M,this.map=J}};function ir(M){this.l=M||10,p.PerformanceNavigationTiming?(M=p.performance.getEntriesByType("navigation"),M=M.length>0&&(M[0].nextHopProtocol=="hq"||M[0].nextHopProtocol=="h2")):M=!!(p.chrome&&p.chrome.loadTimes&&p.chrome.loadTimes()&&p.chrome.loadTimes().wasFetchedViaSpdy),this.j=M?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Oi(M){return M.h?!0:M.g?M.g.size>=M.j:!1}function Cr(M){return M.h?1:M.g?M.g.size:0}function Pr(M,J){return M.h?M.h==J:M.g?M.g.has(J):!1}function ur(M,J){M.g?M.g.add(J):M.h=J}function Zo(M,J){M.h&&M.h==J?M.h=null:M.g&&M.g.has(J)&&M.g.delete(J)}ir.prototype.cancel=function(){if(this.i=Ts(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const M of this.g.values())M.cancel();this.g.clear()}};function Ts(M){if(M.h!=null)return M.i.concat(M.h.G);if(M.g!=null&&M.g.size!==0){let J=M.i;for(const le of M.g.values())J=J.concat(le.G);return J}return N(M.i)}var ta=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ya(M,J){if(M){M=M.split("&");for(let le=0;le<M.length;le++){const Ne=M[le].indexOf("=");let Ct,kt=null;Ne>=0?(Ct=M[le].substring(0,Ne),kt=M[le].substring(Ne+1)):Ct=M[le],J(Ct,kt?decodeURIComponent(kt.replace(/\+/g," ")):"")}}}function ko(M){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let J;M instanceof ko?(this.l=M.l,pc(this,M.j),this.o=M.o,this.g=M.g,fa(this,M.u),this.h=M.h,xl(this,Ja(M.i)),this.m=M.m):M&&(J=String(M).match(ta))?(this.l=!1,pc(this,J[1]||"",!0),this.o=is(J[2]||""),this.g=is(J[3]||"",!0),fa(this,J[4]),this.h=is(J[5]||"",!0),xl(this,J[6]||"",!0),this.m=is(J[7]||"")):(this.l=!1,this.i=new Ks(null,this.l))}ko.prototype.toString=function(){const M=[];var J=this.j;J&&M.push(rs(J,Ko,!0),":");var le=this.g;return(le||J=="file")&&(M.push("//"),(J=this.o)&&M.push(rs(J,Ko,!0),"@"),M.push(Oe(le).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),le=this.u,le!=null&&M.push(":",String(le))),(le=this.h)&&(this.g&&le.charAt(0)!="/"&&M.push("/"),M.push(rs(le,le.charAt(0)=="/"?jc:Tu,!0))),(le=this.i.toString())&&M.push("?",le),(le=this.m)&&M.push("#",rs(le,Ns)),M.join("")},ko.prototype.resolve=function(M){const J=Zs(this);let le=!!M.j;le?pc(J,M.j):le=!!M.o,le?J.o=M.o:le=!!M.g,le?J.g=M.g:le=M.u!=null;var Ne=M.h;if(le)fa(J,M.u);else if(le=!!M.h){if(Ne.charAt(0)!="/")if(this.g&&!this.h)Ne="/"+Ne;else{var Ct=J.h.lastIndexOf("/");Ct!=-1&&(Ne=J.h.slice(0,Ct+1)+Ne)}if(Ct=Ne,Ct==".."||Ct==".")Ne="";else if(Ct.indexOf("./")!=-1||Ct.indexOf("/.")!=-1){Ne=Ct.lastIndexOf("/",0)==0,Ct=Ct.split("/");const kt=[];for(let Nn=0;Nn<Ct.length;){const Gi=Ct[Nn++];Gi=="."?Ne&&Nn==Ct.length&&kt.push(""):Gi==".."?((kt.length>1||kt.length==1&&kt[0]!="")&&kt.pop(),Ne&&Nn==Ct.length&&kt.push("")):(kt.push(Gi),Ne=!0)}Ne=kt.join("/")}else Ne=Ct}return le?J.h=Ne:le=M.i.toString()!=="",le?xl(J,Ja(M.i)):le=!!M.m,le&&(J.m=M.m),J};function Zs(M){return new ko(M)}function pc(M,J,le){M.j=le?is(J,!0):J,M.j&&(M.j=M.j.replace(/:$/,""))}function fa(M,J){if(J){if(J=Number(J),isNaN(J)||J<0)throw Error("Bad port number "+J);M.u=J}else M.u=null}function xl(M,J,le){J instanceof Ks?(M.i=J,Eu(M.i,M.l)):(le||(J=rs(J,Xo)),M.i=new Ks(J,M.l))}function Xr(M,J,le){M.i.set(J,le)}function wl(M){return Xr(M,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),M}function is(M,J){return M?J?decodeURI(M.replace(/%25/g,"%2525")):decodeURIComponent(M):""}function rs(M,J,le){return typeof M=="string"?(M=encodeURI(M).replace(J,Sl),le&&(M=M.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),M):null}function Sl(M){return M=M.charCodeAt(0),"%"+(M>>4&15).toString(16)+(M&15).toString(16)}var Ko=/[#\/\?@]/g,Tu=/[#\?:]/g,jc=/[#\?]/g,Xo=/[#\?@]/g,Ns=/#/g;function Ks(M,J){this.h=this.g=null,this.i=M||null,this.j=!!J}function Yo(M){M.g||(M.g=new Map,M.h=0,M.i&&Ya(M.i,function(J,le){M.add(decodeURIComponent(J.replace(/\+/g," ")),le)}))}t=Ks.prototype,t.add=function(M,J){Yo(this),this.i=null,M=Es(this,M);let le=this.g.get(M);return le||this.g.set(M,le=[]),le.push(J),this.h+=1,this};function vs(M,J){Yo(M),J=Es(M,J),M.g.has(J)&&(M.i=null,M.h-=M.g.get(J).length,M.g.delete(J))}function Cl(M,J){return Yo(M),J=Es(M,J),M.g.has(J)}t.forEach=function(M,J){Yo(this),this.g.forEach(function(le,Ne){le.forEach(function(Ct){M.call(J,Ct,Ne,this)},this)},this)};function Tl(M,J){Yo(M);let le=[];if(typeof J=="string")Cl(M,J)&&(le=le.concat(M.g.get(Es(M,J))));else for(M=Array.from(M.g.values()),J=0;J<M.length;J++)le=le.concat(M[J]);return le}t.set=function(M,J){return Yo(this),this.i=null,M=Es(this,M),Cl(this,M)&&(this.h-=this.g.get(M).length),this.g.set(M,[J]),this.h+=1,this},t.get=function(M,J){return M?(M=Tl(this,M),M.length>0?String(M[0]):J):J};function Zl(M,J,le){vs(M,J),le.length>0&&(M.i=null,M.g.set(Es(M,J),N(le)),M.h+=le.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const M=[],J=Array.from(this.g.keys());for(let Ne=0;Ne<J.length;Ne++){var le=J[Ne];const Ct=Oe(le);le=Tl(this,le);for(let kt=0;kt<le.length;kt++){let Nn=Ct;le[kt]!==""&&(Nn+="="+Oe(le[kt])),M.push(Nn)}}return this.i=M.join("&")};function Ja(M){const J=new Ks;return J.i=M.i,M.g&&(J.g=new Map(M.g),J.h=M.h),J}function Es(M,J){return J=String(J),M.j&&(J=J.toLowerCase()),J}function Eu(M,J){J&&!M.j&&(Yo(M),M.i=null,M.g.forEach(function(le,Ne){const Ct=Ne.toLowerCase();Ne!=Ct&&(vs(this,Ne),Zl(this,Ct,le))},M)),M.j=J}function pa(M,J){const le=new vl;if(p.Image){const Ne=new Image;Ne.onload=A(Na,le,"TestLoadImage: loaded",!0,J,Ne),Ne.onerror=A(Na,le,"TestLoadImage: error",!1,J,Ne),Ne.onabort=A(Na,le,"TestLoadImage: abort",!1,J,Ne),Ne.ontimeout=A(Na,le,"TestLoadImage: timeout",!1,J,Ne),p.setTimeout(function(){Ne.ontimeout&&Ne.ontimeout()},1e4),Ne.src=M}else J(!1)}function Xs(M,J){const le=new vl,Ne=new AbortController,Ct=setTimeout(()=>{Ne.abort(),Na(le,"TestPingServer: timeout",!1,J)},1e4);fetch(M,{signal:Ne.signal}).then(kt=>{clearTimeout(Ct),kt.ok?Na(le,"TestPingServer: ok",!0,J):Na(le,"TestPingServer: server error",!1,J)}).catch(()=>{clearTimeout(Ct),Na(le,"TestPingServer: error",!1,J)})}function Na(M,J,le,Ne,Ct){try{Ct&&(Ct.onload=null,Ct.onerror=null,Ct.onabort=null,Ct.ontimeout=null),Ne(le)}catch{}}function Kl(){this.g=new Io}function Qa(M){this.i=M.Sb||null,this.h=M.ab||!1}D(Qa,Sr),Qa.prototype.g=function(){return new Va(this.i,this.h)};function Va(M,J){fn.call(this),this.H=M,this.o=J,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}D(Va,fn),t=Va.prototype,t.open=function(M,J){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=M,this.D=J,this.readyState=1,Ci(this)},t.send=function(M){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const J={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};M&&(J.body=M),(this.H||p).fetch(new Request(this.D,J)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,El(this)),this.readyState=0},t.Pa=function(M){if(this.g&&(this.l=M,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=M.headers,this.readyState=2,Ci(this)),this.g&&(this.readyState=3,Ci(this),this.g)))if(this.responseType==="arraybuffer")M.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof p.ReadableStream<"u"&&"body"in M){if(this.j=M.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Iu(this)}else M.text().then(this.Oa.bind(this),this.ga.bind(this))};function Iu(M){M.j.read().then(M.Ma.bind(M)).catch(M.ga.bind(M))}t.Ma=function(M){if(this.g){if(this.o&&M.value)this.response.push(M.value);else if(!this.o){var J=M.value?M.value:new Uint8Array(0);(J=this.B.decode(J,{stream:!M.done}))&&(this.response=this.responseText+=J)}M.done?El(this):Ci(this),this.readyState==3&&Iu(this)}},t.Oa=function(M){this.g&&(this.response=this.responseText=M,El(this))},t.Na=function(M){this.g&&(this.response=M,El(this))},t.ga=function(){this.g&&El(this)};function El(M){M.readyState=4,M.l=null,M.j=null,M.B=null,Ci(M)}t.setRequestHeader=function(M,J){this.A.append(M,J)},t.getResponseHeader=function(M){return this.h&&this.h.get(M.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const M=[],J=this.h.entries();for(var le=J.next();!le.done;)le=le.value,M.push(le[0]+": "+le[1]),le=J.next();return M.join(`\r
`)};function Ci(M){M.onreadystatechange&&M.onreadystatechange.call(M)}Object.defineProperty(Va.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(M){this.m=M?"include":"same-origin"}});function Sa(M){let J="";return Ri(M,function(le,Ne){J+=Ne,J+=":",J+=le,J+=`\r
`}),J}function md(M,J,le){e:{for(Ne in le){var Ne=!1;break e}Ne=!0}Ne||(le=Sa(le),typeof M=="string"?le!=null&&Oe(le):Xr(M,J,le))}function $o(M){fn.call(this),this.headers=new Map,this.L=M||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}D($o,fn);var Uc=/^https?$/i,$a=["POST","PUT"];t=$o.prototype,t.Fa=function(M){this.H=M},t.ea=function(M,J,le,Ne){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+M);J=J?J.toUpperCase():"GET",this.D=M,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ve.g(),this.g.onreadystatechange=B(T(this.Ca,this));try{this.B=!0,this.g.open(J,String(M),!0),this.B=!1}catch(kt){Il(this,kt);return}if(M=le||"",le=new Map(this.headers),Ne)if(Object.getPrototypeOf(Ne)===Object.prototype)for(var Ct in Ne)le.set(Ct,Ne[Ct]);else if(typeof Ne.keys=="function"&&typeof Ne.get=="function")for(const kt of Ne.keys())le.set(kt,Ne.get(kt));else throw Error("Unknown input type for opt_headers: "+String(Ne));Ne=Array.from(le.keys()).find(kt=>kt.toLowerCase()=="content-type"),Ct=p.FormData&&M instanceof p.FormData,!(Array.prototype.indexOf.call($a,J,void 0)>=0)||Ne||Ct||le.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[kt,Nn]of le)this.g.setRequestHeader(kt,Nn);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(M),this.v=!1}catch(kt){Il(this,kt)}};function Il(M,J){M.h=!1,M.g&&(M.j=!0,M.g.abort(),M.j=!1),M.l=J,M.o=5,Hc(M),Au(M)}function Hc(M){M.A||(M.A=!0,mn(M,"complete"),mn(M,"error"))}t.abort=function(M){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=M||7,mn(this,"complete"),mn(this,"abort"),Au(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Au(this,!0)),$o.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Xl(this):this.Xa())},t.Xa=function(){Xl(this)};function Xl(M){if(M.h&&typeof u<"u"){if(M.v&&na(M)==4)setTimeout(M.Ca.bind(M),0);else if(mn(M,"readystatechange"),na(M)==4){M.h=!1;try{const kt=M.ca();e:switch(kt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var J=!0;break e;default:J=!1}var le;if(!(le=J)){var Ne;if(Ne=kt===0){let Nn=String(M.D).match(ta)[1]||null;!Nn&&p.self&&p.self.location&&(Nn=p.self.location.protocol.slice(0,-1)),Ne=!Uc.test(Nn?Nn.toLowerCase():"")}le=Ne}if(le)mn(M,"complete"),mn(M,"success");else{M.o=6;try{var Ct=na(M)>2?M.g.statusText:""}catch{Ct=""}M.l=Ct+" ["+M.ca()+"]",Hc(M)}}finally{Au(M)}}}}function Au(M,J){if(M.g){M.m&&(clearTimeout(M.m),M.m=null);const le=M.g;M.g=null,J||mn(M,"ready");try{le.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function na(M){return M.g?M.g.readyState:0}t.ca=function(){try{return na(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(M){if(this.g){var J=this.g.responseText;return M&&J.indexOf(M)==0&&(J=J.substring(M.length)),zo(J)}};function ku(M){try{if(!M.g)return null;if("response"in M.g)return M.g.response;switch(M.F){case"":case"text":return M.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in M.g)return M.g.mozResponseArrayBuffer}return null}catch{return null}}function Ru(M){const J={};M=(M.g&&na(M)>=2&&M.g.getAllResponseHeaders()||"").split(`\r
`);for(let Ne=0;Ne<M.length;Ne++){if(Re(M[Ne]))continue;var le=Le(M[Ne]);const Ct=le[0];if(le=le[1],typeof le!="string")continue;le=le.trim();const kt=J[Ct]||[];J[Ct]=kt,kt.push(le)}zi(J,function(Ne){return Ne.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ca(M,J,le){return le&&le.internalChannelParams&&le.internalChannelParams[M]||J}function Gc(M){this.za=0,this.i=[],this.j=new vl,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ca("failFast",!1,M),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ca("baseRetryDelayMs",5e3,M),this.Za=Ca("retryDelaySeedMs",1e4,M),this.Ta=Ca("forwardChannelMaxRetries",2,M),this.va=Ca("forwardChannelRequestTimeoutMs",2e4,M),this.ma=M&&M.xmlHttpFactory||void 0,this.Ua=M&&M.Rb||void 0,this.Aa=M&&M.useFetchStreams||!1,this.O=void 0,this.L=M&&M.supportsCrossDomainXhr||!1,this.M="",this.h=new ir(M&&M.concurrentRequestLimit),this.Ba=new Kl,this.S=M&&M.fastHandshake||!1,this.R=M&&M.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=M&&M.Pb||!1,M&&M.ua&&this.j.ua(),M&&M.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&M&&M.detectBufferingProxy||!1,this.ia=void 0,M&&M.longPollingTimeout&&M.longPollingTimeout>0&&(this.ia=M.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Gc.prototype,t.ka=8,t.I=1,t.connect=function(M,J,le,Ne){So(0),this.W=M,this.H=J||{},le&&Ne!==void 0&&(this.H.OSID=le,this.H.OAID=Ne),this.F=this.X,this.J=Ql(this,null,this.W),$s(this)};function Vs(M){if(Wc(M),M.I==3){var J=M.V++,le=Zs(M.J);if(Xr(le,"SID",M.M),Xr(le,"RID",J),Xr(le,"TYPE","terminate"),Yl(M,le),J=new it(M,M.j,J),J.M=2,J.A=wl(Zs(le)),le=!1,p.navigator&&p.navigator.sendBeacon)try{le=p.navigator.sendBeacon(J.A.toString(),"")}catch{}!le&&p.Image&&(new Image().src=J.A,le=!0),le||(J.g=ja(J.j,null),J.g.ea(J.A)),J.F=Date.now(),Un(J)}ma(M)}function el(M){M.g&&(Zc(M),M.g.cancel(),M.g=null)}function Wc(M){el(M),M.v&&(p.clearTimeout(M.v),M.v=null),Jl(M),M.h.cancel(),M.m&&(typeof M.m=="number"&&p.clearTimeout(M.m),M.m=null)}function $s(M){if(!Oi(M.h)&&!M.m){M.m=!0;var J=M.Ea;je||de(),qe||(je(),qe=!0),oe.add(J,M),M.D=0}}function Ta(M,J){return Cr(M.h)>=M.h.j-(M.m?1:0)?!1:M.m?(M.i=J.G.concat(M.i),!0):M.I==1||M.I==2||M.D>=(M.Sa?0:M.Ta)?!1:(M.m=Xa(T(M.Ea,M,J),gd(M,M.D)),M.D++,!0)}t.Ea=function(M){if(this.m)if(this.m=null,this.I==1){if(!M){this.V=Math.floor(Math.random()*1e5),M=this.V++;const Ct=new it(this,this.j,M);let kt=this.o;if(this.U&&(kt?(kt=Pt(kt),wo(kt,this.U)):kt=this.U),this.u!==null||this.R||(Ct.J=kt,kt=null),this.S)e:{for(var J=0,le=0;le<this.i.length;le++){t:{var Ne=this.i[le];if("__data__"in Ne.map&&(Ne=Ne.map.__data__,typeof Ne=="string")){Ne=Ne.length;break t}Ne=void 0}if(Ne===void 0)break;if(J+=Ne,J>4096){J=le;break e}if(J===4096||le===this.i.length-1){J=le+1;break e}}J=1e3}else J=1e3;J=qc(this,Ct,J),le=Zs(this.J),Xr(le,"RID",M),Xr(le,"CVER",22),this.G&&Xr(le,"X-HTTP-Session-Id",this.G),Yl(this,le),kt&&(this.R?J="headers="+Oe(Sa(kt))+"&"+J:this.u&&md(le,this.u,kt)),ur(this.h,Ct),this.Ra&&Xr(le,"TYPE","init"),this.S?(Xr(le,"$req",J),Xr(le,"SID","null"),Ct.U=!0,St(Ct,le,null)):St(Ct,le,J),this.I=2}}else this.I==3&&(M?sa(this,M):this.i.length==0||Oi(this.h)||sa(this))};function sa(M,J){var le;J?le=J.l:le=M.V++;const Ne=Zs(M.J);Xr(Ne,"SID",M.M),Xr(Ne,"RID",le),Xr(Ne,"AID",M.K),Yl(M,Ne),M.u&&M.o&&md(Ne,M.u,M.o),le=new it(M,M.j,le,M.D+1),M.u===null&&(le.J=M.o),J&&(M.i=J.G.concat(M.i)),J=qc(M,le,1e3),le.H=Math.round(M.va*.5)+Math.round(M.va*.5*Math.random()),ur(M.h,le),St(le,Ne,J)}function Yl(M,J){M.H&&Ri(M.H,function(le,Ne){Xr(J,Ne,le)}),M.l&&Ri({},function(le,Ne){Xr(J,Ne,le)})}function qc(M,J,le){le=Math.min(M.i.length,le);const Ne=M.l?T(M.l.Ka,M.l,M):null;e:{var Ct=M.i;let Gi=-1;for(;;){const Jo=["count="+le];Gi==-1?le>0?(Gi=Ct[0].g,Jo.push("ofs="+Gi)):Gi=0:Jo.push("ofs="+Gi);let Hr=!0;for(let fo=0;fo<le;fo++){var kt=Ct[fo].g;const jo=Ct[fo].map;if(kt-=Gi,kt<0)Gi=Math.max(0,Ct[fo].g-100),Hr=!1;else try{kt="req"+kt+"_"||"";try{var Nn=jo instanceof Map?jo:Object.entries(jo);for(const[tl,Co]of Nn){let As=Co;o(Co)&&(As=yr(Co)),Jo.push(kt+tl+"="+encodeURIComponent(As))}}catch(tl){throw Jo.push(kt+"type="+encodeURIComponent("_badmap")),tl}}catch{Ne&&Ne(jo)}}if(Hr){Nn=Jo.join("&");break e}}Nn=void 0}return M=M.i.splice(0,le),J.G=M,Nn}function Pu(M){if(!M.g&&!M.v){M.Y=1;var J=M.Da;je||de(),qe||(je(),qe=!0),oe.add(J,M),M.A=0}}function Bi(M){return M.g||M.v||M.A>=3?!1:(M.Y++,M.v=Xa(T(M.Da,M),gd(M,M.A)),M.A++,!0)}t.Da=function(){if(this.v=null,Mu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var M=4*this.T;this.j.info("BP detection timer enabled: "+M),this.B=Xa(T(this.Wa,this),M)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,So(10),el(this),Mu(this))};function Zc(M){M.B!=null&&(p.clearTimeout(M.B),M.B=null)}function Mu(M){M.g=new it(M,M.j,"rpc",M.Y),M.u===null&&(M.g.J=M.o),M.g.P=0;var J=Zs(M.na);Xr(J,"RID","rpc"),Xr(J,"SID",M.M),Xr(J,"AID",M.K),Xr(J,"CI",M.F?"0":"1"),!M.F&&M.ia&&Xr(J,"TO",M.ia),Xr(J,"TYPE","xmlhttp"),Yl(M,J),M.u&&M.o&&md(J,M.u,M.o),M.O&&(M.g.H=M.O);var le=M.g;M=M.ba,le.M=1,le.A=wl(Zs(J)),le.u=null,le.R=!0,xn(le,M)}t.Va=function(){this.C!=null&&(this.C=null,el(this),Bi(this),So(19))};function Jl(M){M.C!=null&&(p.clearTimeout(M.C),M.C=null)}function Pn(M,J){var le=null;if(M.g==J){Jl(M),Zc(M),M.g=null;var Ne=2}else if(Pr(M.h,J))le=J.G,Zo(M.h,J),Ne=1;else return;if(M.I!=0){if(J.o)if(Ne==1){le=J.u?J.u.length:0,J=Date.now()-J.F;var Ct=M.D;Ne=vr(),mn(Ne,new yl(Ne,le)),$s(M)}else Pu(M);else if(Ct=J.m,Ct==3||Ct==0&&J.X>0||!(Ne==1&&Ta(M,J)||Ne==2&&Bi(M)))switch(le&&le.length>0&&(J=M.h,J.i=J.i.concat(le)),Ct){case 1:us(M,5);break;case 4:us(M,10);break;case 3:us(M,6);break;default:us(M,2)}}}function gd(M,J){let le=M.Qa+Math.floor(Math.random()*M.Za);return M.isActive()||(le*=2),le*J}function us(M,J){if(M.j.info("Error code "+J),J==2){var le=T(M.bb,M),Ne=M.Ua;const Ct=!Ne;Ne=new ko(Ne||"//www.google.com/images/cleardot.gif"),p.location&&p.location.protocol=="http"||pc(Ne,"https"),wl(Ne),Ct?pa(Ne.toString(),le):Xs(Ne.toString(),le)}else So(2);M.I=0,M.l&&M.l.pa(J),ma(M),Wc(M)}t.bb=function(M){M?(this.j.info("Successfully pinged google.com"),So(2)):(this.j.info("Failed to ping google.com"),So(1))};function ma(M){if(M.I=0,M.ja=[],M.l){const J=Ts(M.h);(J.length!=0||M.i.length!=0)&&(ee(M.ja,J),ee(M.ja,M.i),M.h.i.length=0,N(M.i),M.i.length=0),M.l.oa()}}function Ql(M,J,le){var Ne=le instanceof ko?Zs(le):new ko(le);if(Ne.g!="")J&&(Ne.g=J+"."+Ne.g),fa(Ne,Ne.u);else{var Ct=p.location;Ne=Ct.protocol,J=J?J+"."+Ct.hostname:Ct.hostname,Ct=+Ct.port;const kt=new ko(null);Ne&&pc(kt,Ne),J&&(kt.g=J),Ct&&fa(kt,Ct),le&&(kt.h=le),Ne=kt}return le=M.G,J=M.wa,le&&J&&Xr(Ne,le,J),Xr(Ne,"VER",M.ka),Yl(M,Ne),Ne}function ja(M,J,le){if(J&&!M.L)throw Error("Can't create secondary domain capable XhrIo object.");return J=M.Aa&&!M.ma?new $o(new Qa({ab:le})):new $o(M.ma),J.Fa(M.L),J}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function bn(){}t=bn.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function wi(M,J){fn.call(this),this.g=new Gc(J),this.l=M,this.h=J&&J.messageUrlParams||null,M=J&&J.messageHeaders||null,J&&J.clientProtocolHeaderRequired&&(M?M["X-Client-Protocol"]="webchannel":M={"X-Client-Protocol":"webchannel"}),this.g.o=M,M=J&&J.initMessageHeaders||null,J&&J.messageContentType&&(M?M["X-WebChannel-Content-Type"]=J.messageContentType:M={"X-WebChannel-Content-Type":J.messageContentType}),J&&J.sa&&(M?M["X-WebChannel-Client-Profile"]=J.sa:M={"X-WebChannel-Client-Profile":J.sa}),this.g.U=M,(M=J&&J.Qb)&&!Re(M)&&(this.g.u=M),this.A=J&&J.supportsCrossDomainXhr||!1,this.v=J&&J.sendRawJson||!1,(J=J&&J.httpSessionIdParam)&&!Re(J)&&(this.g.G=J,M=this.h,M!==null&&J in M&&(M=this.h,J in M&&delete M[J])),this.j=new Is(this)}D(wi,fn),wi.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},wi.prototype.close=function(){Vs(this.g)},wi.prototype.o=function(M){var J=this.g;if(typeof M=="string"){var le={};le.__data__=M,M=le}else this.v&&(le={},le.__data__=yr(M),M=le);J.i.push(new no(J.Ya++,M)),J.I==3&&$s(J)},wi.prototype.N=function(){this.g.l=null,delete this.j,Vs(this.g),delete this.g,wi.Z.N.call(this)};function Ni(M){ha.call(this),M.__headers__&&(this.headers=M.__headers__,this.statusCode=M.__status__,delete M.__headers__,delete M.__status__);var J=M.__sm__;if(J){e:{for(const le in J){M=le;break e}M=void 0}(this.i=M)&&(M=this.i,J=J!==null&&M in J?J[M]:void 0),this.data=J}else this.data=M}D(Ni,ha);function Ys(){ao.call(this),this.status=1}D(Ys,ao);function Is(M){this.g=M}D(Is,bn),Is.prototype.ra=function(){mn(this.g,"a")},Is.prototype.qa=function(M){mn(this.g,new Ni(M))},Is.prototype.pa=function(M){mn(this.g,new Ys)},Is.prototype.oa=function(){mn(this.g,"b")},wi.prototype.send=wi.prototype.o,wi.prototype.open=wi.prototype.m,wi.prototype.close=wi.prototype.close,Y.NO_ERROR=0,Y.TIMEOUT=8,Y.HTTP_ERROR=6,ie.COMPLETE="complete",ho.EventType=Cs,Cs.OPEN="a",Cs.CLOSE="b",Cs.ERROR="c",Cs.MESSAGE="d",fn.prototype.listen=fn.prototype.J,$o.prototype.listenOnce=$o.prototype.K,$o.prototype.getLastError=$o.prototype.Ha,$o.prototype.getLastErrorCode=$o.prototype.ya,$o.prototype.getStatus=$o.prototype.ca,$o.prototype.getResponseJson=$o.prototype.La,$o.prototype.getResponseText=$o.prototype.la,$o.prototype.send=$o.prototype.ea,$o.prototype.setWithCredentials=$o.prototype.Fa}).apply(typeof yx<"u"?yx:typeof self<"u"?self:typeof window<"u"?window:{});const $O="@firebase/firestore",jO="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Vl.UNAUTHENTICATED=new Vl(null),Vl.GOOGLE_CREDENTIALS=new Vl("google-credentials-uid"),Vl.FIRST_PARTY=new Vl("first-party-uid"),Vl.MOCK_USER=new Vl("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let z0="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oy=new PS("@firebase/firestore");function nd(t,...e){if(oy.logLevel<=No.DEBUG){const n=e.map(HI);oy.debug(`Firestore (${z0}): ${t}`,...n)}}function w6(t,...e){if(oy.logLevel<=No.ERROR){const n=e.map(HI);oy.error(`Firestore (${z0}): ${t}`,...n)}}function hpe(t,...e){if(oy.logLevel<=No.WARN){const n=e.map(HI);oy.warn(`Firestore (${z0}): ${t}`,...n)}}function HI(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p0(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,S6(t,r,n)}function S6(t,e,n){let r=`FIRESTORE (${z0}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw w6(r),new Error(r)}function hb(t,e,n,r){let c="Unexpected state";typeof n=="string"?c=n:r=n,t||S6(e,c,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const co={CANCELLED:"cancelled",INVALID_ARGUMENT:"invalid-argument",FAILED_PRECONDITION:"failed-precondition"};class uo extends pd{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fb{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C6{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class fpe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Vl.UNAUTHENTICATED))}shutdown(){}}class ppe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class mpe{constructor(e){this.t=e,this.currentUser=Vl.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){hb(this.o===void 0,42304);let r=this.i;const c=w=>this.i!==r?(r=this.i,n(w)):Promise.resolve();let u=new fb;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new fb,e.enqueueRetryable(()=>c(this.currentUser))};const p=()=>{const w=u;e.enqueueRetryable(async()=>{await w.promise,await c(this.currentUser)})},o=w=>{nd("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=w,this.o&&(this.auth.addAuthTokenListener(this.o),p())};this.t.onInit(w=>o(w)),setTimeout(()=>{if(!this.auth){const w=this.t.getImmediate({optional:!0});w?o(w):(nd("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new fb)}},0),p()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(nd("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(hb(typeof r.accessToken=="string",31837,{l:r}),new C6(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return hb(e===null||typeof e=="string",2055,{h:e}),new Vl(e)}}class gpe{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Vl.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class _pe{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new gpe(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Vl.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class UO{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ype{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,mu(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){hb(this.o===void 0,3512);const r=u=>{u.error!=null&&nd("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const p=u.token!==this.m;return this.m=u.token,nd("FirebaseAppCheckTokenProvider",`Received ${p?"new":"existing"} token.`),p?n(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable(()=>r(u))};const c=u=>{nd("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(u=>c(u)),setTimeout(()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?c(u):nd("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new UO(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(hb(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new UO(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vpe(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bpe{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const c=vpe(40);for(let u=0;u<c.length;++u)r.length<20&&c[u]<n&&(r+=e.charAt(c[u]%62))}return r}}function Vp(t,e){return t<e?-1:t>e?1:0}function xpe(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const c=t.charAt(r),u=e.charAt(r);if(c!==u)return J2(c)===J2(u)?Vp(c,u):J2(c)?1:-1}return Vp(t.length,e.length)}const wpe=55296,Spe=57343;function J2(t){const e=t.charCodeAt(0);return e>=wpe&&e<=Spe}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HO="__name__";class Zd{constructor(e,n,r){n===void 0?n=0:n>e.length&&p0(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&p0(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Zd.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Zd?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let c=0;c<r;c++){const u=Zd.compareSegments(e.get(c),n.get(c));if(u!==0)return u}return Vp(e.length,n.length)}static compareSegments(e,n){const r=Zd.isNumericId(e),c=Zd.isNumericId(n);return r&&!c?-1:!r&&c?1:r&&c?Zd.extractNumericId(e).compare(Zd.extractNumericId(n)):xpe(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return UI.fromString(e.substring(4,e.length-2))}}class ed extends Zd{construct(e,n,r){return new ed(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new uo(co.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(c=>c.length>0))}return new ed(n)}static emptyPath(){return new ed([])}}const Cpe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Qm extends Zd{construct(e,n,r){return new Qm(e,n,r)}static isValidIdentifier(e){return Cpe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Qm.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===HO}static keyField(){return new Qm([HO])}static fromServerFormat(e){const n=[];let r="",c=0;const u=()=>{if(r.length===0)throw new uo(co.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let p=!1;for(;c<e.length;){const o=e[c];if(o==="\\"){if(c+1===e.length)throw new uo(co.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const w=e[c+1];if(w!=="\\"&&w!=="."&&w!=="`")throw new uo(co.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=w,c+=2}else o==="`"?(p=!p,c++):o!=="."||p?(r+=o,c++):(u(),c++)}if(u(),p)throw new uo(co.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Qm(n)}static emptyPath(){return new Qm([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(e){this.path=e}static fromPath(e){return new ng(ed.fromString(e))}static fromName(e){return new ng(ed.fromString(e).popFirst(5))}static empty(){return new ng(ed.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ed.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ed.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ng(new ed(e.slice()))}}function Tpe(t,e,n,r){if(e===!0&&r===!0)throw new uo(co.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Epe(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Ipe(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":p0(12329,{type:typeof t})}function Ape(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new uo(co.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ipe(t);throw new uo(co.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function da(t,e){const n={typeString:t};return e&&(n.value=e),n}function B0(t,e){if(!Epe(t))throw new uo(co.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const c=e[r].typeString,u="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const p=t[r];if(c&&typeof p!==c){n=`JSON field '${r}' must be a ${c}.`;break}if(u!==void 0&&p!==u.value){n=`Expected '${r}' field to equal '${u.value}'`;break}}if(n)throw new uo(co.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GO=-62135596800,WO=1e6;class Xd{static now(){return Xd.fromMillis(Date.now())}static fromDate(e){return Xd.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*WO);return new Xd(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new uo(co.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new uo(co.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<GO)throw new uo(co.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new uo(co.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/WO}_compareTo(e){return this.seconds===e.seconds?Vp(this.nanoseconds,e.nanoseconds):Vp(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Xd._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(B0(e,Xd._jsonSchema))return new Xd(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-GO;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Xd._jsonSchemaVersion="firestore/timestamp/1.0",Xd._jsonSchema={type:da("string",Xd._jsonSchemaVersion),seconds:da("number"),nanoseconds:da("number")};function kpe(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rpe extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gg{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(c){try{return atob(c)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new Rpe("Invalid base64 string: "+u):u}}(e);return new gg(n)}static fromUint8Array(e){const n=function(c){let u="";for(let p=0;p<c.length;++p)u+=String.fromCharCode(c[p]);return u}(e);return new gg(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let c=0;c<n.length;c++)r[c]=n.charCodeAt(c);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Vp(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}gg.EMPTY_BYTE_STRING=new gg("");const _E="(default)";class Bw{constructor(e,n){this.projectId=e,this.database=n||_E}static empty(){return new Bw("","")}get isDefaultDatabase(){return this.database===_E}isEqual(e){return e instanceof Bw&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ppe{constructor(e,n=null,r=[],c=[],u=null,p="F",o=null,w=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=c,this.limit=u,this.limitType=p,this.startAt=o,this.endAt=w,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Mpe(t){return new Ppe(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qO,lo;(lo=qO||(qO={}))[lo.OK=0]="OK",lo[lo.CANCELLED=1]="CANCELLED",lo[lo.UNKNOWN=2]="UNKNOWN",lo[lo.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",lo[lo.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",lo[lo.NOT_FOUND=5]="NOT_FOUND",lo[lo.ALREADY_EXISTS=6]="ALREADY_EXISTS",lo[lo.PERMISSION_DENIED=7]="PERMISSION_DENIED",lo[lo.UNAUTHENTICATED=16]="UNAUTHENTICATED",lo[lo.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",lo[lo.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",lo[lo.ABORTED=10]="ABORTED",lo[lo.OUT_OF_RANGE=11]="OUT_OF_RANGE",lo[lo.UNIMPLEMENTED=12]="UNIMPLEMENTED",lo[lo.INTERNAL=13]="INTERNAL",lo[lo.UNAVAILABLE=14]="UNAVAILABLE",lo[lo.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new UI([4294967295,4294967295],0);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dpe=41943040;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ope=1048576;function Q2(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lpe{constructor(e,n,r=1e3,c=1.5,u=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=c,this.R_=u,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),c=Math.max(0,n-r);c>0&&nd("ExponentialBackoff",`Backing off for ${c} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,c,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GI{constructor(e,n,r,c,u){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=c,this.removalCallback=u,this.deferred=new fb,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(p=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,c,u){const p=Date.now()+r,o=new GI(e,n,p,c,u);return o.start(r),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new uo(co.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}var ZO,KO;(KO=ZO||(ZO={})).Ma="default",KO.Cache="cache";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zpe(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XO=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T6="firestore.googleapis.com",YO=!0;class JO{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new uo(co.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=T6,this.ssl=YO}else this.host=e.host,this.ssl=e.ssl??YO;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Dpe;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Ope)throw new uo(co.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Tpe("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=zpe(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new uo(co.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new uo(co.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new uo(co.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,c){return r.timeoutSeconds===c.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class E6{constructor(e,n,r,c){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=c,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new JO({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new uo(co.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new uo(co.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new JO(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new fpe;switch(r.type){case"firstParty":return new _pe(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new uo(co.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=XO.get(n);r&&(nd("ComponentProvider","Removing Datastore"),XO.delete(n),r.terminate())}(this),Promise.resolve()}}function Bpe(t,e,n,r={}){var T;t=Ape(t,E6);const c=R0(e),u=t._getSettings(),p={...u,emulatorOptions:t._getEmulatorOptions()},o=`${e}:${n}`;c&&(uF(`https://${o}`),dF("Firestore",!0)),u.host!==T6&&u.host!==o&&hpe("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const w={...u,host:o,ssl:c,emulatorOptions:r};if(!Np(w,p)&&(t._setSettings(w),r.mockUserToken)){let A,D;if(typeof r.mockUserToken=="string")A=r.mockUserToken,D=Vl.MOCK_USER;else{A=ece(r.mockUserToken,(T=t._app)==null?void 0:T.options.projectId);const B=r.mockUserToken.sub||r.mockUserToken.user_id;if(!B)throw new uo(co.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");D=new Vl(B)}t._authCredentials=new ppe(new C6(A,D))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WI{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new WI(this.firestore,e,this._query)}}class th{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new qI(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new th(this.firestore,e,this._key)}toJSON(){return{type:th._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(B0(n,th._jsonSchema))return new th(e,r||null,new ng(ed.fromString(n.referencePath)))}}th._jsonSchemaVersion="firestore/documentReference/1.0",th._jsonSchema={type:da("string",th._jsonSchemaVersion),referencePath:da("string")};class qI extends WI{constructor(e,n,r){super(e,n,Mpe(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new th(this.firestore,null,new ng(e))}withConverter(e){return new qI(this.firestore,e,this._path)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QO="AsyncQueue";class e5{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Lpe(this,"async_queue_retry"),this._c=()=>{const r=Q2();r&&nd(QO,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Q2();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Q2();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new fb;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!kpe(e))throw e;nd(QO,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,w6("INTERNAL UNHANDLED ERROR: ",t5(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const c=GI.createAndSchedule(this,e,n,r,u=>this.hc(u));return this.tc.push(c),c}uc(){this.nc&&p0(47125,{Pc:t5(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function t5(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Fpe extends E6{constructor(e,n,r,c){super(e,n,r,c),this.type="firestore",this._queue=new e5,this._persistenceKey=(c==null?void 0:c.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new e5(e),this._firestoreClient=void 0,await e}}}function Npe(t,e){const n=typeof t=="object"?t:AI(),r=typeof t=="string"?t:_E,c=Cg(n,"firestore").getImmediate({identifier:r});if(!c._initialized){const u=Jle("firestore");u&&Bpe(c,...u)}return c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Xh(gg.fromBase64String(e))}catch(n){throw new uo(co.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Xh(gg.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Xh._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(B0(e,Xh._jsonSchema))return Xh.fromBase64String(e.bytes)}}Xh._jsonSchemaVersion="firestore/bytes/1.0",Xh._jsonSchema={type:da("string",Xh._jsonSchemaVersion),bytes:da("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I6{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new uo(co.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Qm(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ag{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new uo(co.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new uo(co.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Vp(this._lat,e._lat)||Vp(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ag._jsonSchemaVersion}}static fromJSON(e){if(B0(e,ag._jsonSchema))return new ag(e.latitude,e.longitude)}}ag._jsonSchemaVersion="firestore/geoPoint/1.0",ag._jsonSchema={type:da("string",ag._jsonSchemaVersion),latitude:da("number"),longitude:da("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lg{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,c){if(r.length!==c.length)return!1;for(let u=0;u<r.length;++u)if(r[u]!==c[u])return!1;return!0}(this._values,e._values)}toJSON(){return{type:lg._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(B0(e,lg._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new lg(e.vectorValues);throw new uo(co.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}lg._jsonSchemaVersion="firestore/vectorValue/1.0",lg._jsonSchema={type:da("string",lg._jsonSchemaVersion),vectorValues:da("object")};const Vpe=new RegExp("[~\\*/\\[\\]]");function $pe(t,e,n){if(e.search(Vpe)>=0)throw n5(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t);try{return new I6(...e.split("."))._internalPath}catch{throw n5(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t)}}function n5(t,e,n,r,c){let u=`Function ${e}() called with invalid data`;u+=". ";let p="";return new uo(co.INVALID_ARGUMENT,u+t+p)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A6{constructor(e,n,r,c,u){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=c,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new th(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new jpe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(k6("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class jpe extends A6{data(){return super.data()}}function k6(t,e){return typeof e=="string"?$pe(t,e):e instanceof I6?e._internalPath:e._delegate._internalPath}class vx{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Z_ extends A6{constructor(e,n,r,c,u,p){super(e,n,r,c,p),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Jx(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(k6("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new uo(co.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Z_._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Z_._jsonSchemaVersion="firestore/documentSnapshot/1.0",Z_._jsonSchema={type:da("string",Z_._jsonSchemaVersion),bundleSource:da("string","DocumentSnapshot"),bundleName:da("string"),bundle:da("string")};class Jx extends Z_{data(e={}){return super.data(e)}}class pb{constructor(e,n,r,c){this._firestore=e,this._userDataWriter=n,this._snapshot=c,this.metadata=new vx(c.hasPendingWrites,c.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Jx(this._firestore,this._userDataWriter,r.key,r,new vx(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new uo(co.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(c,u){if(c._snapshot.oldDocs.isEmpty()){let p=0;return c._snapshot.docChanges.map(o=>{const w=new Jx(c._firestore,c._userDataWriter,o.doc.key,o.doc,new vx(c._snapshot.mutatedKeys.has(o.doc.key),c._snapshot.fromCache),c.query.converter);return o.doc,{type:"added",doc:w,oldIndex:-1,newIndex:p++}})}{let p=c._snapshot.oldDocs;return c._snapshot.docChanges.filter(o=>u||o.type!==3).map(o=>{const w=new Jx(c._firestore,c._userDataWriter,o.doc.key,o.doc,new vx(c._snapshot.mutatedKeys.has(o.doc.key),c._snapshot.fromCache),c.query.converter);let T=-1,A=-1;return o.type!==0&&(T=p.indexOf(o.doc.key),p=p.delete(o.doc.key)),o.type!==1&&(p=p.add(o.doc),A=p.indexOf(o.doc.key)),{type:Upe(o.type),doc:w,oldIndex:T,newIndex:A}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new uo(co.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=pb._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=bpe.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],c=[];return this.docs.forEach(u=>{u._document!==null&&(n.push(u._document),r.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),c.push(u.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Upe(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return p0(61501,{type:t})}}pb._jsonSchemaVersion="firestore/querySnapshot/1.0",pb._jsonSchema={type:da("string",pb._jsonSchemaVersion),bundleSource:da("string","QuerySnapshot"),bundleName:da("string"),bundle:da("string")};(function(e,n=!0){(function(c){z0=c})(py),sh(new dd("firestore",(r,{instanceIdentifier:c,options:u})=>{const p=r.getProvider("app").getImmediate(),o=new Fpe(new mpe(r.getProvider("auth-internal")),new ype(p,r.getProvider("app-check-internal")),function(T,A){if(!Object.prototype.hasOwnProperty.apply(T.options,["projectId"]))throw new uo(co.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Bw(T.options.projectId,A)}(p,c),p);return u={useFetchStreams:n,...u},o._setSettings(u),o},"PUBLIC").setMultipleInstances(!0)),vu($O,jO,e),vu($O,jO,"esm2020")})();const Hpe={apiKey:"AIzaSyBWoq2VI4POUcN8YVkEAVs331Kr7vrK3dc",authDomain:"youth-wellbeing-platform.firebaseapp.com",projectId:"youth-wellbeing-platform",storageBucket:"youth-wellbeing-platform.firebasestorage.app",messagingSenderId:"372624617513",appId:"1:372624617513:web:ac0a5f671b5439e3cdec38",measurementId:"G-08YPNB98LS"},ZI=yF(Hpe);Hde(ZI);const BS=upe(ZI);new Kh;Npe(ZI);const R6="userProfiles",sy="session";function FS(){try{const t=JSON.parse(localStorage.getItem(R6)||"[]");return Array.isArray(t)?t:[]}catch{return[]}}function Gpe(t){localStorage.setItem(R6,JSON.stringify(t))}function P6(t){const e=FS(),n=e.findIndex(r=>r.uid===t.uid);return n>=0?e[n]={...e[n],...t}:e.push(t),Gpe(e),t}function M6(t){return FS().find(e=>e.uid===t)||null}function Wpe(t){const e=(t||"").trim().toLowerCase();return FS().find(n=>(n.email||"").toLowerCase()===e)||null}const Qx={registerUser:qpe,login:D6,logout:Zpe,currentUser:NS,isAuthed:Kpe,hasRole:Xpe,getProfiles:FS};async function qpe({name:t,email:e,role:n,password:r}){const c=await Whe(BS,e,r);if(t)try{await Khe(c.user,{displayName:ef(t)})}catch{}P6({uid:c.user.uid,email:c.user.email,name:ef(t||c.user.displayName||""),role:n||"youth"});const u={uid:c.user.uid,email:c.user.email,name:ef(t||c.user.displayName||""),role:n||"youth"};return localStorage.setItem(sy,JSON.stringify(u)),u}async function D6({email:t,password:e}){const n=await qhe(BS,t,e);let r=M6(n.user.uid)||Wpe(n.user.email);r||(r=P6({uid:n.user.uid,email:n.user.email,name:ef(n.user.displayName||""),role:"youth"}));const c={uid:n.user.uid,email:n.user.email,name:r.name||ef(n.user.displayName||""),role:r.role||"youth"};return localStorage.setItem(sy,JSON.stringify(c)),c}async function Zpe(){await Qhe(BS),localStorage.removeItem(sy)}function NS(){try{return JSON.parse(localStorage.getItem(sy)||"null")}catch{return null}}function Kpe(){return!!NS()}function Xpe(t){const e=NS();return!!e&&e.role===t}Jhe(BS,t=>{if(!t)localStorage.removeItem(sy);else if(!NS()){const e=M6(t.uid)||{uid:t.uid,email:t.email,name:ef(t.displayName||""),role:"youth"},n={uid:t.uid,email:t.email,name:e.name,role:e.role};localStorage.setItem(sy,JSON.stringify(n))}});const Ype={class:"mb-3"},Jpe={class:"mb-3"},Qpe={class:"mb-3"},eme={class:"mb-3"},tme={class:"d-flex flex-wrap align-items-center gap-2 mt-5 mb-2"},nme={class:"ms-lg-auto d-flex flex-wrap gap-2"},ime={class:"input-group",style:{"max-width":"420px"}},rme={class:"table-responsive-fluid"},ome=["onUpdate:modelValue"],sme=["onUpdate:modelValue"],ame=["onUpdate:modelValue"],lme={__name:"RegisterForm",setup(t){const{registerUser:e,getProfiles:n}=Qx,r=Si(""),c=Si(""),u=Si(""),p=Si(""),o=Si([]);lh(()=>{o.value=n()});const w=Si({global:{value:null,matchMode:"contains"},name:{value:null,matchMode:"contains"},email:{value:null,matchMode:"contains"},role:{value:null,matchMode:"contains"}});function T(){Object.keys(w.value).forEach(se=>{w.value[se].value=null})}async function A(){try{if(!p.value||p.value.length<6){alert("Password must be at least 6 characters.");return}await e({name:r.value,email:c.value,role:u.value,password:p.value}),o.value=n(),r.value="",c.value="",u.value="",p.value="",alert("✅ Registered successfully (via Firebase)!")}catch(se){alert((se==null?void 0:se.message)||"Registration failed.")}}function D(){localStorage.setItem("userProfiles","[]"),o.value=[]}function B(){const se=["Name","Email","Role"],ce=o.value.map(qe=>[Q(qe.name),Q(qe.email),Q(qe.role)]),be=[se,...ce].map(qe=>qe.map(oe=>`"${String(oe).replace(/"/g,'""')}"`).join(",")).join(`\r
`),ze=new Blob([be],{type:"text/csv;charset=utf-8;"}),xe=URL.createObjectURL(ze),je=document.createElement("a");je.href=xe,je.download="users.csv",je.click(),URL.revokeObjectURL(xe)}function N(){const se=`
    <style>
      body { font-family: Arial, sans-serif; padding: 16px; }
      h1 { margin-bottom: 12px; }
      table { width: 100%; border-collapse: collapse; }
      th, td { border: 1px solid #ccc; padding: 8px; }
      th { background: #f2f2f2; text-align: left; }
    </style>
  `,ce=o.value.map(xe=>`
    <tr>
      <td>${ee(xe.name)}</td>
      <td>${ee(xe.email)}</td>
      <td>${ee(xe.role)}</td>
    </tr>
  `).join(""),be=`
    <!doctype html>
    <html>
      <head>${se}</head>
      <body onload="window.print()">
        <h1>Registered Users</h1>
        <table>
          <thead>
            <tr><th>Name</th><th>Email</th><th>Role</th></tr>
          </thead>
          <tbody>${ce}</tbody>
        </table>
      </body>
    </html>
  `,ze=window.open("","_blank");ze&&(ze.document.open(),ze.document.write(be),ze.document.close())}function ee(se=""){return String(se).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function Q(se=""){return String(se??"").trim()}return(se,ce)=>(We(),wt("div",null,[Pe("form",{id:"register-form",class:"form mt-4",onSubmit:df(A,["prevent"])},[ce[12]||(ce[12]=Pe("h2",null,"Register",-1)),Pe("div",Ype,[ce[7]||(ce[7]=Pe("label",{for:"name",class:"form-label"},"Full Name",-1)),Ki(Pe("input",{"onUpdate:modelValue":ce[0]||(ce[0]=be=>r.value=be),type:"text",id:"name",class:"form-control",required:""},null,512),[[to,r.value]])]),Pe("div",Jpe,[ce[8]||(ce[8]=Pe("label",{for:"email",class:"form-label"},"Email",-1)),Ki(Pe("input",{"onUpdate:modelValue":ce[1]||(ce[1]=be=>c.value=be),type:"email",id:"email",class:"form-control",required:""},null,512),[[to,c.value,void 0,{trim:!0}]])]),Pe("div",Qpe,[ce[10]||(ce[10]=Pe("label",{class:"form-label"},"Role",-1)),Ki(Pe("select",{"onUpdate:modelValue":ce[2]||(ce[2]=be=>u.value=be),class:"form-select",required:""},[...ce[9]||(ce[9]=[Pe("option",{disabled:"",value:""},"Select role",-1),Pe("option",{value:"youth"},"Youth (13–25)",-1),Pe("option",{value:"caregiver"},"Caregiver / Parent",-1),Pe("option",{value:"admin"},"Admin",-1)])],512),[[ey,u.value]])]),Pe("div",eme,[ce[11]||(ce[11]=Pe("label",{for:"password",class:"form-label"},"Password",-1)),Ki(Pe("input",{"onUpdate:modelValue":ce[3]||(ce[3]=be=>p.value=be),type:"password",id:"password",class:"form-control",required:""},null,512),[[to,p.value]])]),ce[13]||(ce[13]=Pe("button",{type:"submit",class:"btn btn-custom"},"Register",-1)),Pe("button",{type:"button",class:"btn btn-custom ms-2",onClick:D},"Clear Users")],32),Pe("div",tme,[ce[15]||(ce[15]=Pe("h3",{class:"m-0"},"Registered Users",-1)),Pe("div",nme,[Pe("div",ime,[ce[14]||(ce[14]=Pe("span",{class:"input-group-text"},"Search all",-1)),Ki(Pe("input",{"onUpdate:modelValue":ce[4]||(ce[4]=be=>w.value.global.value=be),type:"text",class:"form-control",placeholder:"Search by name, email, role…"},null,512),[[to,w.value.global.value]]),Pe("button",{class:"btn btn-custom",onClick:T},"Clear")]),Pe("button",{class:"btn btn-custom",onClick:ce[5]||(ce[5]=be=>B())},"Export CSV"),Pe("button",{class:"btn btn-custom",onClick:ce[6]||(ce[6]=be=>N())},"Export PDF")])]),Pe("div",rme,[hi(ss(RS),{value:o.value,dataKey:"id",paginator:!0,rows:10,rowsPerPageOptions:[10,20,50],responsiveLayout:"stack",breakpoint:"992px",class:"p-datatable-sm shadow-sm",filters:w.value,globalFilterFields:["name","email","role"],sortMode:"multiple"},{default:si(()=>[hi(ss($l),{field:"name",header:"Name",sortable:"",filter:"",showFilterMenu:!1},{filter:si(({filterModel:be})=>[Ki(Pe("input",{"onUpdate:modelValue":ze=>be.value=ze,type:"text",class:"form-control",placeholder:"Search name"},null,8,ome),[[to,be.value]])]),_:1}),hi(ss($l),{field:"email",header:"Email",sortable:"",filter:"",showFilterMenu:!1},{filter:si(({filterModel:be})=>[Ki(Pe("input",{"onUpdate:modelValue":ze=>be.value=ze,type:"text",class:"form-control",placeholder:"Search email"},null,8,sme),[[to,be.value]])]),_:1}),hi(ss($l),{field:"role",header:"Role",sortable:"",filter:"",showFilterMenu:!1},{filter:si(({filterModel:be})=>[Ki(Pe("select",{"onUpdate:modelValue":ze=>be.value=ze,class:"form-select"},[...ce[16]||(ce[16]=[Pe("option",{value:""},"All",-1),Pe("option",{value:"youth"},"youth",-1),Pe("option",{value:"caregiver"},"caregiver",-1),Pe("option",{value:"admin"},"admin",-1)])],8,ame),[[ey,be.value]])]),_:1})]),_:1},8,["value","filters"])])]))}},cme=Cu(lme,[["__scopeId","data-v-fece98b1"]]),ume={class:"mb-3"},dme={class:"mb-3"},hme={__name:"LoginForm",setup(t){const e=Si(""),n=Si(""),r=Ene();async function c(){try{const u=await D6({email:e.value,password:n.value});if(!u){alert("Invalid credentials.");return}alert(`Welcome, ${u.name||u.email}!`),r.push({name:"home"})}catch(u){alert((u==null?void 0:u.message)||"Login failed.")}}return(u,p)=>(We(),wt("form",{onSubmit:df(c,["prevent"]),class:"mt-4"},[p[4]||(p[4]=Pe("h3",null,"Login",-1)),Pe("div",ume,[p[2]||(p[2]=Pe("label",{class:"form-label"},"Email",-1)),Ki(Pe("input",{"onUpdate:modelValue":p[0]||(p[0]=o=>e.value=o),type:"email",class:"form-control",required:""},null,512),[[to,e.value,void 0,{trim:!0}]])]),Pe("div",dme,[p[3]||(p[3]=Pe("label",{class:"form-label"},"Password",-1)),Ki(Pe("input",{"onUpdate:modelValue":p[1]||(p[1]=o=>n.value=o),type:"password",class:"form-control",required:""},null,512),[[to,n.value]])]),p[5]||(p[5]=Pe("button",{type:"submit",class:"btn btn-custom"},"Login",-1))],32))}},fme=Cu(hme,[["__scopeId","data-v-b065aa4e"]]),pme={class:"container py-5"},mme={class:"row"},gme={class:"col-md-6"},_me={class:"col-md-6"},yme={__name:"Auth",setup(t){const e=Si([]);function n(c){e.value=c}function r(){e.value=[]}return(c,u)=>(We(),wt("div",pme,[u[0]||(u[0]=Pe("h1",{class:"text-center"},"User Authentication",-1)),Pe("div",mme,[Pe("div",gme,[hi(cme,{users:e.value,onUpdateUsers:n,onClearUsers:r},null,8,["users"])]),Pe("div",_me,[hi(fme,{users:e.value},null,8,["users"])])])]))}},vme=Cu(yme,[["__scopeId","data-v-46bb12a7"]]);function bme(){function t(e=""){const n=document.getElementById("sr-announcer");n&&(n.textContent="",requestAnimationFrame(()=>{n.textContent=e}))}return{announce:t}}const xme={class:"container py-4"},wme={class:"row g-2"},Sme={class:"col-md-4"},Cme=["value"],Tme={class:"col-md-4"},Eme={class:"d-flex align-items-center"},Ime={class:"ms-2","aria-live":"polite"},Ame={class:"col-12 mt-2"},kme={class:"d-flex flex-wrap align-items-center gap-2 mb-3"},Rme={class:"input-group",style:{"max-width":"480px"}},Pme={class:"ms-lg-auto d-flex gap-2"},Mme={class:"table-responsive-fluid"},Dme=["onUpdate:modelValue"],Ome={class:"d-flex align-items-center gap-2"},Lme=["onUpdate:modelValue"],zme=["onUpdate:modelValue"],Bme=["onUpdate:modelValue"],Fme=["onUpdate:modelValue"],Nme="https://moderatereview-6rwlj53o6q-ts.a.run.app",Vme={__name:"Reviews",setup(t){const{announce:e}=bme(),n=Ine(),r=Si([]),c=Si([]),u=Si(""),p=Si(0),o=Si(""),w=Si({global:{value:null,matchMode:"contains"},programTitle:{value:null,matchMode:"contains"},rating:{value:null,matchMode:"gte"},comment:{value:null,matchMode:"contains"},userEmail:{value:null,matchMode:"contains"},createdAt:{value:null,matchMode:"contains"}});function T(){Object.keys(w.value).forEach(be=>{w.value[be].value=null})}const A=[{id:1,title:"Managing Anxiety",topic:"Anxiety",date:"2025-09-10",mode:"Online",seats:12,isDefault:!0},{id:2,title:"Sleep and Mindfulness",topic:"Sleep",date:"2025-09-15",mode:"In-person",seats:8,isDefault:!0},{id:3,title:"Healthy Friendships",topic:"Relationships",date:"2025-09-18",mode:"Online",seats:0,isDefault:!0}];lh(()=>{hy(()=>{var ze;return(ze=document.getElementById("page-title"))==null?void 0:ze.focus()});try{const ze=JSON.parse(localStorage.getItem("programs")||"[]");r.value=Array.isArray(ze)&&ze.length?ze:A}catch{r.value=A}c.value=D();const be=Number(n.query.programId||"");be?u.value=be:r.value.length&&(u.value=r.value[0].id)});function D(){try{return JSON.parse(localStorage.getItem("reviews")||"[]")}catch{return[]}}function B(be){localStorage.setItem("reviews",JSON.stringify(be))}async function N(){var de,Ee;if(!Qx.isAuthed()){e("Please log in to submit a review."),alert("Please log in to submit a review.");return}if(!u.value||!p.value)return;let be=o.value||"";try{const $e=await fetch(Nme,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:be})});if($e.ok){const me=await $e.json();if(!me.allowed){const Te=`Your comment was blocked by moderation: ${(me.reasons||[]).join(", ")}`;e(Te),alert(Te);return}be=me.cleaned||be}else console.warn("Moderation function returned non-200",$e.status)}catch($e){console.warn("Moderation function error",$e),e("Unable to verify your comment right now. Please try again in a moment."),alert("Unable to verify your comment right now. Please try again in a moment.");return}const ze=r.value.find($e=>$e.id===Number(u.value));if(!ze)return;const xe=D(),je=(((de=Qx.currentUser())==null?void 0:de.email)||"unknown").trim().toLowerCase(),qe=xe.findIndex($e=>Number($e.programId)===Number(u.value)&&($e.userEmail||"").trim().toLowerCase()===je),oe={id:Date.now(),programId:Number(u.value),programTitle:ze.title,rating:Number(p.value),comment:ef(be||"").slice(0,300),userEmail:((Ee=Qx.currentUser())==null?void 0:Ee.email)||"unknown",createdAt:new Date().toLocaleString()};qe>=0?xe[qe]={...xe[qe],rating:oe.rating,comment:oe.comment,createdAt:oe.createdAt}:xe.unshift(oe),B(xe),c.value=xe,p.value=0,o.value="",e("Review saved successfully."),alert("Review saved!")}function ee(){const be=["Program","Rating","Comment","By","When"],ze=c.value.map(de=>[ce(de.programTitle),String(de.rating??""),ce(de.comment),ce(de.userEmail),ce(de.createdAt)]),xe=[be,...ze].map(de=>de.map(Ee=>`"${String(Ee).replace(/"/g,'""')}"`).join(",")).join(`\r
`),je=new Blob([xe],{type:"text/csv;charset=utf-8;"}),qe=URL.createObjectURL(je),oe=document.createElement("a");oe.href=qe,oe.download="reviews.csv",oe.click(),URL.revokeObjectURL(qe)}function Q(){const be=`
    <style>
      body { font-family: Arial, sans-serif; padding: 16px; }
      h1 { margin-bottom: 12px; }
      table { width: 100%; border-collapse: collapse; }
      th, td { border: 1px solid #ccc; padding: 8px; vertical-align: top; }
      th { background: #f2f2f2; text-align: left; }
    </style>
  `,ze=c.value.map(qe=>`
    <tr>
      <td>${se(qe.programTitle)}</td>
      <td>${String(qe.rating??"")}</td>
      <td>${se(qe.comment||"")}</td>
      <td>${se(qe.userEmail||"")}</td>
      <td>${se(qe.createdAt||"")}</td>
    </tr>
  `).join(""),xe=`
    <!doctype html>
    <html>
      <head>${be}</head>
      <body onload="window.print()">
        <h1>Program Reviews</h1>
        <table>
          <thead>
            <tr>
              <th>Program</th>
              <th>Rating</th>
              <th>Comment</th>
              <th>By</th>
              <th>When</th>
            </tr>
          </thead>
          <tbody>${ze}</tbody>
        </table>
      </body>
    </html>
  `,je=window.open("","_blank");je&&(je.document.open(),je.document.write(xe),je.document.close())}function se(be=""){return String(be).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function ce(be=""){return String(be??"").trim()}return(be,ze)=>(We(),wt("section",xme,[ze[14]||(ze[14]=Pe("h1",{id:"page-title",class:"mb-3",tabindex:"-1"},"Program Reviews",-1)),Pe("form",{onSubmit:df(N,["prevent"]),class:"mb-4"},[Pe("div",wme,[Pe("div",Sme,[ze[7]||(ze[7]=Pe("label",{class:"form-label",for:"rv-program"},"Program",-1)),Ki(Pe("select",{id:"rv-program","onUpdate:modelValue":ze[0]||(ze[0]=xe=>u.value=xe),class:"form-select",required:""},[ze[6]||(ze[6]=Pe("option",{disabled:"",value:""},"Select a program",-1)),(We(!0),wt(Mi,null,ea(r.value,xe=>(We(),wt("option",{key:xe.id,value:xe.id},wr(xe.title)+" ("+wr(xe.date)+") ",9,Cme))),128))],512),[[ey,u.value,void 0,{number:!0}]])]),Pe("div",Tme,[ze[8]||(ze[8]=Pe("label",{class:"form-label",for:"rv-rating"},"Rating",-1)),Pe("div",Eme,[hi(ss(Ew),{id:"rv-rating",modelValue:p.value,"onUpdate:modelValue":ze[1]||(ze[1]=xe=>p.value=xe),cancel:!1,"aria-label":"Star rating from 1 to 5"},null,8,["modelValue"]),Pe("span",Ime,wr(p.value),1)])]),Pe("div",Ame,[ze[9]||(ze[9]=Pe("label",{class:"form-label",for:"rv-comment"},"Comment (optional)",-1)),Ki(Pe("textarea",{id:"rv-comment","onUpdate:modelValue":ze[2]||(ze[2]=xe=>o.value=xe),class:"form-control",rows:"3",maxlength:"300","aria-describedby":"rv-comment-help",placeholder:"Share your thoughts (max 300 chars)"},null,512),[[to,o.value]]),ze[10]||(ze[10]=Pe("small",{id:"rv-comment-help",class:"text-muted"},"Max 300 characters.",-1))])]),ze[11]||(ze[11]=Pe("button",{type:"submit",class:"btn btn-custom mt-3"},"Submit Review",-1))],32),ze[15]||(ze[15]=Pe("h4",{class:"mb-2"},"Recent Reviews",-1)),Pe("div",kme,[Pe("div",Rme,[ze[12]||(ze[12]=Pe("span",{class:"input-group-text"},"Search all",-1)),Ki(Pe("input",{"onUpdate:modelValue":ze[3]||(ze[3]=xe=>w.value.global.value=xe),type:"text",class:"form-control",placeholder:"Type to search program, comment, user, date…"},null,512),[[to,w.value.global.value]]),Pe("button",{class:"btn btn-custom",onClick:T},"Clear")]),Pe("div",Pme,[Pe("button",{class:"btn btn-custom",onClick:ze[4]||(ze[4]=xe=>ee())},"Export CSV"),Pe("button",{class:"btn btn-custom",onClick:ze[5]||(ze[5]=xe=>Q())},"Export PDF")])]),ze[16]||(ze[16]=Pe("p",{id:"reviews-caption",class:"sr-only"}," List of recent reviews with program, rating, comment, author and time. ",-1)),Pe("div",Mme,[hi(ss(RS),{value:c.value,paginator:!0,rows:10,rowsPerPageOptions:[10,20,50],responsiveLayout:"stack",breakpoint:"992px",class:"p-datatable-sm shadow-sm",sortMode:"multiple",filters:w.value,globalFilterFields:["programTitle","comment","userEmail","createdAt"],"aria-describedby":"reviews-caption"},{empty:si(()=>[...ze[13]||(ze[13]=[Pe("div",{class:"py-4 text-center text-muted"},"No reviews yet.",-1)])]),default:si(()=>[hi(ss($l),{field:"programTitle",header:"Program",sortable:"",filter:"",showFilterMenu:!1},{filter:si(({filterModel:xe})=>[Ki(Pe("input",{"onUpdate:modelValue":je=>xe.value=je,type:"text",class:"form-control",placeholder:"Search program"},null,8,Dme),[[to,xe.value]])]),_:1}),hi(ss($l),{header:"Rating",sortable:"",field:"rating",filter:"",showFilterMenu:!1},{body:si(xe=>[Pe("div",Ome,[hi(ss(Ew),{modelValue:xe.data.rating,cancel:!1,readonly:""},null,8,["modelValue"]),Pe("small",null,"("+wr(Number(xe.data.rating||0).toFixed(1))+")",1)])]),filter:si(({filterModel:xe})=>[Ki(Pe("input",{"onUpdate:modelValue":je=>xe.value=je,type:"number",min:"1",max:"5",step:"1",class:"form-control",placeholder:"≥ stars"},null,8,Lme),[[to,xe.value,void 0,{number:!0}]])]),_:1}),hi(ss($l),{field:"comment",header:"Comment",sortable:"",filter:"",showFilterMenu:!1},{filter:si(({filterModel:xe})=>[Ki(Pe("input",{"onUpdate:modelValue":je=>xe.value=je,type:"text",class:"form-control",placeholder:"Search comment"},null,8,zme),[[to,xe.value]])]),_:1}),hi(ss($l),{field:"userEmail",header:"By",sortable:"",filter:"",showFilterMenu:!1},{filter:si(({filterModel:xe})=>[Ki(Pe("input",{"onUpdate:modelValue":je=>xe.value=je,type:"text",class:"form-control",placeholder:"Search email"},null,8,Bme),[[to,xe.value]])]),_:1}),hi(ss($l),{field:"createdAt",header:"When",sortable:"",filter:"",showFilterMenu:!1},{filter:si(({filterModel:xe})=>[Ki(Pe("input",{"onUpdate:modelValue":je=>xe.value=je,type:"text",class:"form-control",placeholder:"yyyy-mm-dd or time"},null,8,Fme),[[to,xe.value]])]),_:1})]),_:1},8,["value","filters"])])]))}},$me={class:"container py-4"},jme={class:"col-md-6"},Ume={class:"col-md-6"},Hme={class:"col-12"},Gme={class:"col-md-6"},Wme={key:0,class:"text-muted"},qme={class:"col-12"},Zme=["disabled"],Kme="https://sendemail-6rwlj53o6q-ts.a.run.app",Xme={__name:"EmailComposer",setup(t){const e=Si(""),n=Si(""),r=Si("<p>Hello from Youth Wellbeing Platform!</p>"),c=Si(null),u=Si(""),p=Si(null),o=Si(!1),w=Si(null);function T(D){var ee;w.value=null;const B=(ee=D.target.files)==null?void 0:ee[0];if(!B){p.value=null,u.value="";return}u.value=B.name;const N=new FileReader;N.onload=()=>{const Q=String(N.result).split(",")[1];p.value={filename:B.name,type:B.type||"application/octet-stream",content:Q}},N.readAsDataURL(B)}async function A(){w.value=null,o.value=!0;try{const D={to:e.value,subject:n.value,html:r.value,attachment:p.value||void 0},B=await fetch(Kme,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(D)}),N=await B.json();B.ok&&N.ok?(w.value={ok:!0,message:"Email sent successfully!"},c.value&&(c.value.value=null),u.value="",p.value=null):w.value={ok:!1,message:N.error||"Failed to send email"}}catch{w.value={ok:!1,message:"Network or server error"}}finally{o.value=!1}}return(D,B)=>(We(),wt("section",$me,[B[7]||(B[7]=Pe("h2",{class:"mb-3"},"Send Test Email",-1)),Pe("form",{onSubmit:df(A,["prevent"]),class:"row g-3"},[Pe("div",jme,[B[3]||(B[3]=Pe("label",{class:"form-label"},"To (email)",-1)),Ki(Pe("input",{"onUpdate:modelValue":B[0]||(B[0]=N=>e.value=N),type:"email",class:"form-control",required:""},null,512),[[to,e.value,void 0,{trim:!0}]])]),Pe("div",Ume,[B[4]||(B[4]=Pe("label",{class:"form-label"},"Subject",-1)),Ki(Pe("input",{"onUpdate:modelValue":B[1]||(B[1]=N=>n.value=N),type:"text",class:"form-control",required:""},null,512),[[to,n.value,void 0,{trim:!0}]])]),Pe("div",Hme,[B[5]||(B[5]=Pe("label",{class:"form-label"},"Message (HTML allowed)",-1)),Ki(Pe("textarea",{"onUpdate:modelValue":B[2]||(B[2]=N=>r.value=N),rows:"4",class:"form-control",placeholder:"<p>Hello!</p>"},null,512),[[to,r.value]])]),Pe("div",Gme,[B[6]||(B[6]=Pe("label",{class:"form-label"},"Attachment (optional)",-1)),Pe("input",{ref_key:"fileInput",ref:c,type:"file",class:"form-control",onChange:T},null,544),u.value?(We(),wt("small",Wme,"Selected: "+wr(u.value),1)):Zn("",!0)]),Pe("div",qme,[Pe("button",{class:"btn btn-custom",disabled:o.value},wr(o.value?"Sending…":"Send Email"),9,Zme)])],32),w.value?(We(),wt("div",{key:0,class:pr(["alert mt-3",w.value.ok?"alert-success":"alert-danger"])},wr(w.value.message),3)):Zn("",!0)]))}},Yme={class:"container py-4"},Jme={__name:"Email",setup(t){return(e,n)=>(We(),wt("section",Yme,[n[0]||(n[0]=Pe("h1",{class:"mb-3 text-center"},"Send Email",-1)),n[1]||(n[1]=Pe("h2",{class:"page-title text-center mb-2"}," Use this form to send an email (with optional attachment) via our secure backend.",-1)),hi(Xme)]))}},Qme=Cu(Jme,[["__scopeId","data-v-2e5f1d69"]]);var O6={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(Az,function(){var n,r,c;function u(o,w){if(!n)n=w;else if(!r)r=w;else{var T="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk); self.onerror = null;",A={};n(A),c=w(A),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(c.workerUrl=window.URL.createObjectURL(new Blob([T],{type:"text/javascript"})))}}u(["exports"],function(o){var w=1e-6,T=typeof Float32Array<"u"?Float32Array:Array;function A(l,i){var a=i[0],h=i[1],f=i[2],_=i[3],y=a*_-f*h;return y?(l[0]=_*(y=1/y),l[1]=-h*y,l[2]=-f*y,l[3]=a*y,l):null}function D(){var l=new T(9);return T!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[5]=0,l[6]=0,l[7]=0),l[0]=1,l[4]=1,l[8]=1,l}function B(l,i){var a=i[0],h=i[1],f=i[2],_=i[3],y=i[4],x=i[5],C=i[6],I=i[7],R=i[8];return l[0]=y*R-x*I,l[1]=f*I-h*R,l[2]=h*x-f*y,l[3]=x*C-_*R,l[4]=a*R-f*C,l[5]=f*_-a*x,l[6]=_*I-y*C,l[7]=h*C-a*I,l[8]=a*y-h*_,l}function N(l,i,a){var h=i[0],f=i[1],_=i[2],y=i[3],x=i[4],C=i[5],I=i[6],R=i[7],P=i[8],L=a[0],$=a[1],j=a[2],q=a[3],Z=a[4],K=a[5],ae=a[6],ue=a[7],fe=a[8];return l[0]=L*h+$*y+j*I,l[1]=L*f+$*x+j*R,l[2]=L*_+$*C+j*P,l[3]=q*h+Z*y+K*I,l[4]=q*f+Z*x+K*R,l[5]=q*_+Z*C+K*P,l[6]=ae*h+ue*y+fe*I,l[7]=ae*f+ue*x+fe*R,l[8]=ae*_+ue*C+fe*P,l}function ee(){var l=new T(16);return T!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0),l[0]=1,l[5]=1,l[10]=1,l[15]=1,l}function Q(l){return l[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function se(l,i){var a=i[0],h=i[1],f=i[2],_=i[3],y=i[4],x=i[5],C=i[6],I=i[7],R=i[8],P=i[9],L=i[10],$=i[11],j=i[12],q=i[13],Z=i[14],K=i[15],ae=a*x-h*y,ue=a*C-f*y,fe=a*I-_*y,Me=h*C-f*x,De=h*I-_*x,Ve=f*I-_*C,He=R*q-P*j,Ze=R*Z-L*j,_t=R*K-$*j,Je=P*Z-L*q,bt=P*K-$*q,Mt=L*K-$*Z,Tt=ae*Mt-ue*bt+fe*Je+Me*_t-De*Ze+Ve*He;return Tt?(l[0]=(x*Mt-C*bt+I*Je)*(Tt=1/Tt),l[1]=(f*bt-h*Mt-_*Je)*Tt,l[2]=(q*Ve-Z*De+K*Me)*Tt,l[3]=(L*De-P*Ve-$*Me)*Tt,l[4]=(C*_t-y*Mt-I*Ze)*Tt,l[5]=(a*Mt-f*_t+_*Ze)*Tt,l[6]=(Z*fe-j*Ve-K*ue)*Tt,l[7]=(R*Ve-L*fe+$*ue)*Tt,l[8]=(y*bt-x*_t+I*He)*Tt,l[9]=(h*_t-a*bt-_*He)*Tt,l[10]=(j*De-q*fe+K*ae)*Tt,l[11]=(P*fe-R*De-$*ae)*Tt,l[12]=(x*Ze-y*Je-C*He)*Tt,l[13]=(a*Je-h*Ze+f*He)*Tt,l[14]=(q*ue-j*Me-Z*ae)*Tt,l[15]=(R*Me-P*ue+L*ae)*Tt,l):null}function ce(l,i,a){var h=i[0],f=i[1],_=i[2],y=i[3],x=i[4],C=i[5],I=i[6],R=i[7],P=i[8],L=i[9],$=i[10],j=i[11],q=i[12],Z=i[13],K=i[14],ae=i[15],ue=a[0],fe=a[1],Me=a[2],De=a[3];return l[0]=ue*h+fe*x+Me*P+De*q,l[1]=ue*f+fe*C+Me*L+De*Z,l[2]=ue*_+fe*I+Me*$+De*K,l[3]=ue*y+fe*R+Me*j+De*ae,l[4]=(ue=a[4])*h+(fe=a[5])*x+(Me=a[6])*P+(De=a[7])*q,l[5]=ue*f+fe*C+Me*L+De*Z,l[6]=ue*_+fe*I+Me*$+De*K,l[7]=ue*y+fe*R+Me*j+De*ae,l[8]=(ue=a[8])*h+(fe=a[9])*x+(Me=a[10])*P+(De=a[11])*q,l[9]=ue*f+fe*C+Me*L+De*Z,l[10]=ue*_+fe*I+Me*$+De*K,l[11]=ue*y+fe*R+Me*j+De*ae,l[12]=(ue=a[12])*h+(fe=a[13])*x+(Me=a[14])*P+(De=a[15])*q,l[13]=ue*f+fe*C+Me*L+De*Z,l[14]=ue*_+fe*I+Me*$+De*K,l[15]=ue*y+fe*R+Me*j+De*ae,l}function be(l,i,a){var h,f,_,y,x,C,I,R,P,L,$,j,q=a[0],Z=a[1],K=a[2];return i===l?(l[12]=i[0]*q+i[4]*Z+i[8]*K+i[12],l[13]=i[1]*q+i[5]*Z+i[9]*K+i[13],l[14]=i[2]*q+i[6]*Z+i[10]*K+i[14],l[15]=i[3]*q+i[7]*Z+i[11]*K+i[15]):(f=i[1],_=i[2],y=i[3],x=i[4],C=i[5],I=i[6],R=i[7],P=i[8],L=i[9],$=i[10],j=i[11],l[0]=h=i[0],l[1]=f,l[2]=_,l[3]=y,l[4]=x,l[5]=C,l[6]=I,l[7]=R,l[8]=P,l[9]=L,l[10]=$,l[11]=j,l[12]=h*q+x*Z+P*K+i[12],l[13]=f*q+C*Z+L*K+i[13],l[14]=_*q+I*Z+$*K+i[14],l[15]=y*q+R*Z+j*K+i[15]),l}function ze(l,i,a){var h=a[0],f=a[1],_=a[2];return l[0]=i[0]*h,l[1]=i[1]*h,l[2]=i[2]*h,l[3]=i[3]*h,l[4]=i[4]*f,l[5]=i[5]*f,l[6]=i[6]*f,l[7]=i[7]*f,l[8]=i[8]*_,l[9]=i[9]*_,l[10]=i[10]*_,l[11]=i[11]*_,l[12]=i[12],l[13]=i[13],l[14]=i[14],l[15]=i[15],l}function xe(l,i,a){var h=Math.sin(a),f=Math.cos(a),_=i[4],y=i[5],x=i[6],C=i[7],I=i[8],R=i[9],P=i[10],L=i[11];return i!==l&&(l[0]=i[0],l[1]=i[1],l[2]=i[2],l[3]=i[3],l[12]=i[12],l[13]=i[13],l[14]=i[14],l[15]=i[15]),l[4]=_*f+I*h,l[5]=y*f+R*h,l[6]=x*f+P*h,l[7]=C*f+L*h,l[8]=I*f-_*h,l[9]=R*f-y*h,l[10]=P*f-x*h,l[11]=L*f-C*h,l}function je(l,i,a){var h=Math.sin(a),f=Math.cos(a),_=i[0],y=i[1],x=i[2],C=i[3],I=i[8],R=i[9],P=i[10],L=i[11];return i!==l&&(l[4]=i[4],l[5]=i[5],l[6]=i[6],l[7]=i[7],l[12]=i[12],l[13]=i[13],l[14]=i[14],l[15]=i[15]),l[0]=_*f-I*h,l[1]=y*f-R*h,l[2]=x*f-P*h,l[3]=C*f-L*h,l[8]=_*h+I*f,l[9]=y*h+R*f,l[10]=x*h+P*f,l[11]=C*h+L*f,l}function qe(l,i,a){var h=Math.sin(a),f=Math.cos(a),_=i[0],y=i[1],x=i[2],C=i[3],I=i[4],R=i[5],P=i[6],L=i[7];return i!==l&&(l[8]=i[8],l[9]=i[9],l[10]=i[10],l[11]=i[11],l[12]=i[12],l[13]=i[13],l[14]=i[14],l[15]=i[15]),l[0]=_*f+I*h,l[1]=y*f+R*h,l[2]=x*f+P*h,l[3]=C*f+L*h,l[4]=I*f-_*h,l[5]=R*f-y*h,l[6]=P*f-x*h,l[7]=L*f-C*h,l}function oe(l,i){return l[0]=i[0],l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=i[1],l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=i[2],l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function de(l,i,a){var h,f,_,y=a[0],x=a[1],C=a[2],I=Math.sqrt(y*y+x*x+C*C);return I<w?null:(y*=I=1/I,x*=I,C*=I,h=Math.sin(i),f=Math.cos(i),l[0]=y*y*(_=1-f)+f,l[1]=x*y*_+C*h,l[2]=C*y*_-x*h,l[3]=0,l[4]=y*x*_-C*h,l[5]=x*x*_+f,l[6]=C*x*_+y*h,l[7]=0,l[8]=y*C*_+x*h,l[9]=x*C*_-y*h,l[10]=C*C*_+f,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l)}function Ee(l,i){var a=i[0],h=i[1],f=i[2],_=i[3],y=a+a,x=h+h,C=f+f,I=a*y,R=h*y,P=h*x,L=f*y,$=f*x,j=f*C,q=_*y,Z=_*x,K=_*C;return l[0]=1-P-j,l[1]=R+K,l[2]=L-Z,l[3]=0,l[4]=R-K,l[5]=1-I-j,l[6]=$+q,l[7]=0,l[8]=L+Z,l[9]=$-q,l[10]=1-I-P,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}var $e=ce;function me(){var l=new T(3);return T!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l}function Te(l){var i=new T(3);return i[0]=l[0],i[1]=l[1],i[2]=l[2],i}function Re(l){var i=l[0],a=l[1],h=l[2];return Math.sqrt(i*i+a*a+h*h)}function tn(l,i,a){var h=new T(3);return h[0]=l,h[1]=i,h[2]=a,h}function Zt(l,i,a,h){return l[0]=i,l[1]=a,l[2]=h,l}function on(l,i,a){return l[0]=i[0]+a[0],l[1]=i[1]+a[1],l[2]=i[2]+a[2],l}function hn(l,i,a){return l[0]=i[0]-a[0],l[1]=i[1]-a[1],l[2]=i[2]-a[2],l}function Hn(l,i,a){return l[0]=i[0]*a[0],l[1]=i[1]*a[1],l[2]=i[2]*a[2],l}function Ri(l,i,a){return l[0]=Math.min(i[0],a[0]),l[1]=Math.min(i[1],a[1]),l[2]=Math.min(i[2],a[2]),l}function zi(l,i,a){return l[0]=Math.max(i[0],a[0]),l[1]=Math.max(i[1],a[1]),l[2]=Math.max(i[2],a[2]),l}function Pt(l,i,a){return l[0]=i[0]*a,l[1]=i[1]*a,l[2]=i[2]*a,l}function Di(l,i,a,h){return l[0]=i[0]+a[0]*h,l[1]=i[1]+a[1]*h,l[2]=i[2]+a[2]*h,l}function wo(l,i){var a=i[0]-l[0],h=i[1]-l[1],f=i[2]-l[2];return a*a+h*h+f*f}function Ur(l){var i=l[0],a=l[1],h=l[2];return i*i+a*a+h*h}function Br(l,i){return l[0]=-i[0],l[1]=-i[1],l[2]=-i[2],l}function ai(l,i){var a=i[0],h=i[1],f=i[2],_=a*a+h*h+f*f;return _>0&&(_=1/Math.sqrt(_)),l[0]=i[0]*_,l[1]=i[1]*_,l[2]=i[2]*_,l}function Ft(l,i){return l[0]*i[0]+l[1]*i[1]+l[2]*i[2]}function In(l,i,a){var h=i[0],f=i[1],_=i[2],y=a[0],x=a[1],C=a[2];return l[0]=f*C-_*x,l[1]=_*y-h*C,l[2]=h*x-f*y,l}function Wt(l,i,a,h){var f=i[0],_=i[1],y=i[2];return l[0]=f+h*(a[0]-f),l[1]=_+h*(a[1]-_),l[2]=y+h*(a[2]-y),l}function kn(l,i,a){var h=i[0],f=i[1],_=i[2],y=a[3]*h+a[7]*f+a[11]*_+a[15];return l[0]=(a[0]*h+a[4]*f+a[8]*_+a[12])/(y=y||1),l[1]=(a[1]*h+a[5]*f+a[9]*_+a[13])/y,l[2]=(a[2]*h+a[6]*f+a[10]*_+a[14])/y,l}function dr(l,i,a){var h=i[0],f=i[1],_=i[2];return l[0]=h*a[0]+f*a[3]+_*a[6],l[1]=h*a[1]+f*a[4]+_*a[7],l[2]=h*a[2]+f*a[5]+_*a[8],l}function Qe(l,i,a){var h=a[0],f=a[1],_=a[2],y=a[3],x=i[0],C=i[1],I=i[2],R=f*I-_*C,P=_*x-h*I,L=h*C-f*x;return l[0]=x+y*(R+=R)+f*(L+=L)-_*(P+=P),l[1]=C+y*P+_*R-h*L,l[2]=I+y*L+h*P-f*R,l}function at(l){return l[0]=0,l[1]=0,l[2]=0,l}function vt(l,i){return l[0]===i[0]&&l[1]===i[1]&&l[2]===i[2]}var Gt=hn,an=Hn,Qt=Re;function On(){var l=new T(4);return T!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0,l[3]=0),l}function fn(l,i,a){return l[0]=i[0]*a,l[1]=i[1]*a,l[2]=i[2]*a,l[3]=i[3]*a,l}function mn(l,i){var a=i[0],h=i[1],f=i[2],_=i[3],y=a*a+h*h+f*f+_*_;return y>0&&(y=1/Math.sqrt(y)),l[0]=a*y,l[1]=h*y,l[2]=f*y,l[3]=_*y,l}function dn(l,i,a){var h=i[0],f=i[1],_=i[2],y=i[3];return l[0]=a[0]*h+a[4]*f+a[8]*_+a[12]*y,l[1]=a[1]*h+a[5]*f+a[9]*_+a[13]*y,l[2]=a[2]*h+a[6]*f+a[10]*_+a[14]*y,l[3]=a[3]*h+a[7]*f+a[11]*_+a[15]*y,l}function pi(){var l=new T(4);return T!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l[3]=1,l}function Ln(l){return l[0]=0,l[1]=0,l[2]=0,l[3]=1,l}function mi(l,i,a){a*=.5;var h=i[0],f=i[1],_=i[2],y=i[3],x=Math.sin(a),C=Math.cos(a);return l[0]=h*C+y*x,l[1]=f*C+_*x,l[2]=_*C-f*x,l[3]=y*C-h*x,l}function yi(l,i,a){a*=.5;var h=i[0],f=i[1],_=i[2],y=i[3],x=Math.sin(a),C=Math.cos(a);return l[0]=h*C-_*x,l[1]=f*C+y*x,l[2]=_*C+h*x,l[3]=y*C-f*x,l}me(),On();var xi,nr,yr,zo=mn,Io=(xi=me(),nr=tn(1,0,0),yr=tn(0,1,0),function(l,i,a){var h=Ft(i,a);return h<-.999999?(In(xi,nr,i),Qt(xi)<1e-6&&In(xi,yr,i),ai(xi,xi),function(f,_,y){y*=.5;var x=Math.sin(y);f[0]=x*_[0],f[1]=x*_[1],f[2]=x*_[2],f[3]=Math.cos(y)}(l,xi,Math.PI),l):h>.999999?(l[0]=0,l[1]=0,l[2]=0,l[3]=1,l):(In(xi,i,a),l[0]=xi[0],l[1]=xi[1],l[2]=xi[2],l[3]=1+h,zo(l,l))});function Sr(){var l=new T(2);return T!=Float32Array&&(l[0]=0,l[1]=0),l}function ho(l,i){var a=new T(2);return a[0]=l,a[1]=i,a}function Cs(l,i,a){return l[0]=i,l[1]=a,l}function ha(l,i,a){return l[0]=i[0]+a[0],l[1]=i[1]+a[1],l}function ao(l,i,a){return l[0]=i[0]-a[0],l[1]=i[1]-a[1],l}function Ao(l,i,a){return l[0]=i[0]*a,l[1]=i[1]*a,l}function Fa(l){var i=l[0],a=l[1];return Math.sqrt(i*i+a*a)}function vr(l,i){var a=i[0],h=i[1],f=a*a+h*h;return f>0&&(f=1/Math.sqrt(f)),l[0]=i[0]*f,l[1]=i[1]*f,l}function ns(l,i){return l[0]*i[0]+l[1]*i[1]}pi(),pi(),D();var _l,Wl,So=ao;function yl(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}Sr();var Xa=function(){if(Wl)return _l;function l(i,a,h,f){this.cx=3*i,this.bx=3*(h-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(f-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=a,this.p2x=h,this.p2y=f}return Wl=1,_l=l,l.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,a){if(a===void 0&&(a=1e-6),i<0)return 0;if(i>1)return 1;for(var h=i,f=0;f<8;f++){var _=this.sampleCurveX(h)-i;if(Math.abs(_)<a)return h;var y=this.sampleCurveDerivativeX(h);if(Math.abs(y)<1e-6)break;h-=_/y}var x=0,C=1;for(h=i,f=0;f<20&&(_=this.sampleCurveX(h),!(Math.abs(_-i)<a));f++)i>_?x=h:C=h,h=.5*(C-x)+x;return h},solve:function(i,a){return this.sampleCurveY(this.solveCurveX(i,a))}},_l}(),vl=yl(Xa);function Dt(l,i){this.x=l,this.y=i}function bl(l,i){if(Array.isArray(l)){if(!Array.isArray(i)||l.length!==i.length)return!1;for(let a=0;a<l.length;a++)if(!bl(l[a],i[a]))return!1;return!0}if(typeof l=="object"&&l!==null&&i!==null){if(typeof i!="object"||Object.keys(l).length!==Object.keys(i).length)return!1;for(const a in l)if(!bl(l[a],i[a]))return!1;return!0}return l===i}Dt.prototype={clone(){return new Dt(this.x,this.y)},add(l){return this.clone()._add(l)},sub(l){return this.clone()._sub(l)},multByPoint(l){return this.clone()._multByPoint(l)},divByPoint(l){return this.clone()._divByPoint(l)},mult(l){return this.clone()._mult(l)},div(l){return this.clone()._div(l)},rotate(l){return this.clone()._rotate(l)},rotateAround(l,i){return this.clone()._rotateAround(l,i)},matMult(l){return this.clone()._matMult(l)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(l){return this.x===l.x&&this.y===l.y},dist(l){return Math.sqrt(this.distSqr(l))},distSqr(l){const i=l.x-this.x,a=l.y-this.y;return i*i+a*a},angle(){return Math.atan2(this.y,this.x)},angleTo(l){return Math.atan2(this.y-l.y,this.x-l.x)},angleWith(l){return this.angleWithSep(l.x,l.y)},angleWithSep(l,i){return Math.atan2(this.x*i-this.y*l,this.x*l+this.y*i)},_matMult(l){const i=l[2]*this.x+l[3]*this.y;return this.x=l[0]*this.x+l[1]*this.y,this.y=i,this},_add(l){return this.x+=l.x,this.y+=l.y,this},_sub(l){return this.x-=l.x,this.y-=l.y,this},_mult(l){return this.x*=l,this.y*=l,this},_div(l){return this.x/=l,this.y/=l,this},_multByPoint(l){return this.x*=l.x,this.y*=l.y,this},_divByPoint(l){return this.x/=l.x,this.y/=l.y,this},_unit(){return this._div(this.mag()),this},_perp(){const l=this.y;return this.y=this.x,this.x=-l,this},_rotate(l){const i=Math.cos(l),a=Math.sin(l),h=a*this.x+i*this.y;return this.x=i*this.x-a*this.y,this.y=h,this},_rotateAround(l,i){const a=Math.cos(l),h=Math.sin(l),f=i.y+h*(this.x-i.x)+a*(this.y-i.y);return this.x=i.x+a*(this.x-i.x)-h*(this.y-i.y),this.y=f,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:Dt},Dt.convert=function(l){if(l instanceof Dt)return l;if(Array.isArray(l))return new Dt(+l[0],+l[1]);if(l.x!==void 0&&l.y!==void 0)return new Dt(+l.x,+l.y);throw new Error("Expected [x, y] or {x, y} point format")};const ql=Math.PI/180,$c=180/Math.PI;function Xe(l){return l*ql}function Y(l){return l*$c}const ie=[[0,0],[1,0],[1,1],[0,1]];function ve(l){if(l<=0)return 0;if(l>=1)return 1;const i=l*l,a=i*l;return 4*(l<.5?a:3*(l-i)+a-.75)}function Fe(l,i,a,h){const f=new vl(l,i,a,h);return function(_){return f.solve(_)}}const Oe=Fe(.25,.1,.25,1);function Le(l,i,a){return Math.min(a,Math.max(i,l))}function it(l,i,a){return(a=Le((a-l)/(i-l),0,1))*a*(3-2*a)}function Ge(l,i,a){const h=a-i,f=((l-i)%h+h)%h+i;return f===i?a:f}function st(l,i,a){if(!l.length)return a(null,[]);let h=l.length;const f=new Array(l.length);let _=null;l.forEach((y,x)=>{i(y,(C,I)=>{C&&(_=C),f[x]=I,--h==0&&a(_,f)})})}let Nt=1;function St(){return Nt++}function xn(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log2(l)))}function Mn(l,i){l.forEach(a=>{i[a]&&(i[a]=i[a].bind(i))})}function zn(l,i,a){const h={};for(const f in l)h[f]=i.call(this,l[f],f,l);return h}function Kn(l,i,a){const h={};for(const f in l)i.call(this,l[f],f,l)&&(h[f]=l[f]);return h}function Un(l){return Array.isArray(l)?l.map(Un):typeof l=="object"&&l?zn(l,Un):l}function ei(l,i){for(let a=0;a<l.length;a++)if(i.indexOf(l[a])>=0)return!0;return!1}const Ei={};function li(l){Ei[l]||(typeof console<"u"&&console.warn(l),Ei[l]=!0)}function cr(l,i,a){return(a.y-l.y)*(i.x-l.x)>(i.y-l.y)*(a.x-l.x)}function Fr(l){let i=0;for(let a,h,f=0,_=l.length,y=_-1;f<_;y=f++)a=l[f],h=l[y],i+=(h.x-a.x)*(a.y+h.y);return i}function no([l,i,a]){const h=Xe(i+90),f=Xe(a);return{x:l*Math.cos(h)*Math.sin(f),y:l*Math.sin(h)*Math.sin(f),z:l*Math.cos(f),azimuthal:i,polar:a}}function ir(l){return(typeof self<"u"||l!==void 0)&&typeof WorkerGlobalScope<"u"&&(l!==void 0?l:self)instanceof WorkerGlobalScope}function Oi(l){const i={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,h,f,_)=>{const y=f||_;return i[h]=!y||y.toLowerCase(),""}),i["max-age"]){const a=parseInt(i["max-age"],10);isNaN(a)?delete i["max-age"]:i["max-age"]=a}return i}let Cr=null;function Pr(l,i){return[l[4*i],l[4*i+1],l[4*i+2],l[4*i+3]]}function ur(l,i,a,h){for(;i<a;){const f=i+a>>1;l[f]<h?i=f+1:a=f}return i}function Zo(l,i,a,h){for(;i<a;){const f=i+a>>1;l[f]<=h?i=f+1:a=f}return i}function Ts(l){return l>0?1/(1.001-l):1+l}function ta(l){return l>0?1-1/(1.001-l):-l}function Ya(l,i,a){return(l-i.min)*(a.max-a.min)/(i.max-i.min)+a.min}const ko={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!ko.API_URL)return null;try{const l=new URL(ko.API_URL);return l.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":l.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",BUILDING_GEN_URL:"https://api.mapbox.com/mapbox-gl-js/building-gen/building_gen_v1.2.3.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function Zs(l){return ko.API_URL_REGEX.test(l)}function pc(l){return ko.API_SPRITE_REGEX.test(l)}let fa,xl,Xr,wl,is,rs;function Sl(){return fa==null&&(fa=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),fa}const Ko={now:()=>wl!==void 0?wl:performance.now(),setNow(l){wl=l},restoreNow(){wl=void 0},frame(l){const i=requestAnimationFrame(l);return{cancel:()=>cancelAnimationFrame(i)}},getImageData(l,i=0){const{width:a,height:h}=l;is||(is=document.createElement("canvas"));const f=is.getContext("2d",{willReadFrequently:!0});if(!f)throw new Error("failed to create canvas 2d context");return(a>is.width||h>is.height)&&(is.width=a,is.height=h),f.clearRect(-i,-i,a+2*i,h+2*i),f.drawImage(l,0,0,a,h),f.getImageData(-i,-i,a+2*i,h+2*i)},resolveURL:l=>(xl||(xl=document.createElement("a")),xl.href=l,xl.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Xr==null&&(Xr=window.matchMedia("(prefers-reduced-motion: reduce)")),Xr.matches)},hasCanvasFingerprintNoise(){if(rs!==void 0)return rs;if(!Sl())return rs=!1,!1;const l=new OffscreenCanvas(85,1),i=l.getContext("2d",{willReadFrequently:!0});let a=0;for(let f=0;f<l.width;++f)i.fillStyle=`rgba(${a++},${a++},${a++}, 255)`,i.fillRect(f,0,1,1);const h=i.getImageData(0,0,l.width,l.height);a=0;for(let f=0;f<h.data.length;++f)if(f%4!=3&&a++!==h.data[f])return rs=!0,!0;return rs=!1,!1}};function Tu(l,i){const a=l.indexOf("?");if(a<0)return`${l}?${new URLSearchParams(i).toString()}`;const h=new URLSearchParams(l.slice(a));for(const f in i)h.set(f,i[f]);return`${l.slice(0,a)}?${h.toString()}`}function jc(l,i={persistentParams:[]}){const a=l.indexOf("?");if(a<0)return l;const h=new URLSearchParams,f=new URLSearchParams(l.slice(a));for(const y of i.persistentParams){const x=f.get(y);x&&h.set(y,x)}const _=h.toString();return`${l.slice(0,a)}${_.length>0?`?${_}`:""}`}const Xo="mapbox-tiles";let Ns=500,Ks=50;const Yo=["language","worldview","jobid"];let vs,Cl;function Tl(){try{return caches}catch{}}function Zl(){const l=Tl();l&&vs==null&&(vs=l.open(Xo))}let Ja=1/0;const Es={supported:!1,testSupport:function(l){!Xs&&pa&&(Na?Qa(l):Eu=l)}};let Eu,pa,Xs=!1,Na=!1;const Kl=typeof self<"u"?self:{};function Qa(l){const i=l.createTexture();l.bindTexture(l.TEXTURE_2D,i);try{if(l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,pa),l.isContextLost())return;Es.supported=!0}catch{}l.deleteTexture(i),Xs=!0}Kl.document&&(pa=Kl.document.createElement("img"),pa.onload=function(){Eu&&Qa(Eu),Eu=null,Na=!0},pa.onerror=function(){Xs=!0,Eu=null},pa.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Va={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Va);class Iu extends Error{constructor(i,a,h){a===401&&Zs(h)&&(i+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(i),this.status=a,this.url=h}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const El=ir()?()=>self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Ci=function(l,i){if(!(/^file:/.test(a=l.url)||/^file:/.test(El())&&!/^\w+:/.test(a))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(h,f){const _=new AbortController,y=new Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,referrer:El(),referrerPolicy:h.referrerPolicy,signal:_.signal});let x=!1,C=!1;const I=(R=y.url).indexOf("sku=")>0&&Zs(R);var R;h.type==="json"&&y.headers.set("Accept","application/json");const P=($,j,q)=>{if(C)return;if($&&$.message!=="SecurityError"&&li($.toString()),j&&q)return L(j);const Z=Date.now();fetch(y).then(K=>{if(K.ok){const ae=I?K.clone():null;return L(K,ae,Z)}return f(new Iu(K.statusText,K.status,h.url))}).catch(K=>{K.name!=="AbortError"&&f(new Error(`${K.message} ${h.url}`))})},L=($,j,q)=>{(h.type==="arrayBuffer"?$.arrayBuffer():h.type==="json"?$.json():$.text()).then(Z=>{C||(j&&q&&function(K,ae,ue){if(Zl(),vs==null)return;const fe=Oi(ae.headers.get("Cache-Control")||"");if(fe["no-store"])return;const Me={status:ae.status,statusText:ae.statusText,headers:new Headers};ae.headers.forEach((He,Ze)=>Me.headers.set(Ze,He)),fe["max-age"]&&Me.headers.set("Expires",new Date(ue+1e3*fe["max-age"]).toUTCString());const De=Me.headers.get("Expires");if(!De||new Date(De).getTime()-ue<42e4)return;let Ve=jc(K.url,{persistentParams:Yo});if(ae.status===206){const He=K.headers.get("Range");if(!He)return;Me.status=200,Ve=Tu(Ve,{range:He})}(function(He,Ze){if(Cl===void 0)try{new Response(new ReadableStream),Cl=!0}catch{Cl=!1}Cl?Ze(He.body):He.blob().then(Ze).catch(_t=>li(_t.message))})(ae,He=>{const Ze=new Response((_t=ae.status)!==200&&_t!==404&&[101,103,204,205,304].includes(_t)?null:He,Me);var _t;Zl(),vs!=null&&vs.then(Je=>Je.put(Ve,Ze)).catch(Je=>li(Je.message))})}(y,j,q),x=!0,f(null,Z,$.headers.get("Cache-Control"),$.headers.get("Expires")))}).catch(Z=>{C||f(new Error(Z.message))})};return I?function($,j){if(Zl(),vs==null)return j(null);vs.then(q=>{let Z=jc($.url,{persistentParams:Yo});const K=$.headers.get("Range");K&&(Z=Tu(Z,{range:K})),q.match(Z).then(ae=>{const ue=function(fe){if(!fe)return!1;const Me=new Date(fe.headers.get("Expires")||0),De=Oi(fe.headers.get("Cache-Control")||"");return Number(Me)>Date.now()&&!De["no-cache"]}(ae);q.delete(Z).catch(j),ue&&q.put(Z,ae.clone()).catch(j),j(null,ae,ue)}).catch(j)}).catch(j)}(y,P):P(null,null),{cancel:()=>{C=!0,x||_.abort()}}}(l,i);if(ir(self)&&self.worker.actor)return self.worker.actor.send("getResource",l,i,void 0,!0)}var a;return function(h,f){const _=new XMLHttpRequest;_.open(h.method||"GET",h.url,!0),h.type==="arrayBuffer"&&(_.responseType="arraybuffer");for(const y in h.headers)_.setRequestHeader(y,h.headers[y]);return h.type==="json"&&(_.responseType="text",_.setRequestHeader("Accept","application/json")),_.withCredentials=h.credentials==="include",_.onerror=()=>{f(new Error(_.statusText))},_.onload=()=>{if((_.status>=200&&_.status<300||_.status===0)&&_.response!==null){let y=_.response;if(h.type==="json")try{y=JSON.parse(_.response)}catch(x){return f(x)}f(null,y,_.getResponseHeader("Cache-Control"),_.getResponseHeader("Expires"))}else f(new Iu(_.statusText,_.status,h.url))},_.send(h.body),{cancel:()=>_.abort()}}(l,i)},Sa=function(l,i){return Ci(Object.assign(l,{type:"arrayBuffer"}),i)};function md(l){const i=document.createElement("a");return i.href=l,i.protocol===location.protocol&&i.host===location.host}const $o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Uc,$a;Uc=[],$a=0;const Il=function(l,i){if(Es.supported&&(l.headers||(l.headers={}),l.headers.accept="image/webp,*/*"),$a>=ko.MAX_PARALLEL_IMAGE_REQUESTS){const _={requestParameters:l,callback:i,cancelled:!1,cancel(){this.cancelled=!0}};return Uc.push(_),_}$a++;let a=!1;const h=()=>{if(!a)for(a=!0,$a--;Uc.length&&$a<ko.MAX_PARALLEL_IMAGE_REQUESTS;){const _=Uc.shift(),{requestParameters:y,callback:x,cancelled:C}=_;C||(_.cancel=Il(y,x).cancel)}},f=Sa(l,(_,y,x,C)=>{h(),_?i(_):y&&(self.createImageBitmap?function(I,R){const P=new Blob([new Uint8Array(I)],{type:"image/png"});createImageBitmap(P).then(L=>{R(null,L)}).catch(L=>{R(new Error(`Could not load image because of ${L.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(y,(I,R)=>i(I,R,x,C)):function(I,R){const P=new Image;P.onload=()=>{R(null,P),URL.revokeObjectURL(P.src),P.onload=null,requestAnimationFrame(()=>{P.src=$o})},P.onerror=()=>R(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const L=new Blob([new Uint8Array(I)],{type:"image/png"});P.src=I.byteLength?URL.createObjectURL(L):$o}(y,(I,R)=>i(I,R,x,C)))});return{cancel:()=>{f.cancel(),h()}}};var Hc,Xl,Au,na={exports:{}},ku={exports:{}},Ru={exports:{}},Ca=function(){if(Au)return na.exports;Au=1;var l=(Hc||(Hc=1,ku.exports=function(a,h){var f,_,y,x,C,I,R,P;for(_=a.length-(f=3&a.length),y=h,C=3432918353,I=461845907,P=0;P<_;)R=255&a.charCodeAt(P)|(255&a.charCodeAt(++P))<<8|(255&a.charCodeAt(++P))<<16|(255&a.charCodeAt(++P))<<24,++P,y=27492+(65535&(x=5*(65535&(y=(y^=R=(65535&(R=(R=(65535&R)*C+(((R>>>16)*C&65535)<<16)&4294967295)<<15|R>>>17))*I+(((R>>>16)*I&65535)<<16)&4294967295)<<13|y>>>19))+((5*(y>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(R=0,f){case 3:R^=(255&a.charCodeAt(P+2))<<16;case 2:R^=(255&a.charCodeAt(P+1))<<8;case 1:y^=R=(65535&(R=(R=(65535&(R^=255&a.charCodeAt(P)))*C+(((R>>>16)*C&65535)<<16)&4294967295)<<15|R>>>17))*I+(((R>>>16)*I&65535)<<16)&4294967295}return y^=a.length,y=2246822507*(65535&(y^=y>>>16))+((2246822507*(y>>>16)&65535)<<16)&4294967295,y=3266489909*(65535&(y^=y>>>13))+((3266489909*(y>>>16)&65535)<<16)&4294967295,(y^=y>>>16)>>>0}),ku.exports),i=(Xl||(Xl=1,Ru.exports=function(a,h){for(var f,_=a.length,y=h^_,x=0;_>=4;)f=1540483477*(65535&(f=255&a.charCodeAt(x)|(255&a.charCodeAt(++x))<<8|(255&a.charCodeAt(++x))<<16|(255&a.charCodeAt(++x))<<24))+((1540483477*(f>>>16)&65535)<<16),y=1540483477*(65535&y)+((1540483477*(y>>>16)&65535)<<16)^(f=1540483477*(65535&(f^=f>>>24))+((1540483477*(f>>>16)&65535)<<16)),_-=4,++x;switch(_){case 3:y^=(255&a.charCodeAt(x+2))<<16;case 2:y^=(255&a.charCodeAt(x+1))<<8;case 1:y=1540483477*(65535&(y^=255&a.charCodeAt(x)))+((1540483477*(y>>>16)&65535)<<16)}return y=1540483477*(65535&(y^=y>>>13))+((1540483477*(y>>>16)&65535)<<16),(y^=y>>>15)>>>0}),Ru.exports);return na.exports=l,na.exports.murmur3=l,na.exports.murmur2=i,na.exports}(),Gc=yl(Ca);class Vs{constructor(i,...a){Object.assign(this,a[0]||{}),this.type=i}}class el extends Vs{constructor(i,a={}){super("error",Object.assign({error:i},a))}}function Wc(l,i,a){a[l]&&a[l].indexOf(i)!==-1||(a[l]=a[l]||[],a[l].push(i))}function $s(l,i,a){if(a&&a[l]){const h=a[l].indexOf(i);h!==-1&&a[l].splice(h,1)}}class Ta{on(i,a){return this._listeners=this._listeners||{},Wc(i,a,this._listeners),this}off(i,a){return $s(i,a,this._listeners),$s(i,a,this._oneTimeListeners),this}once(i,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},Wc(i,a,this._oneTimeListeners),this):new Promise(h=>{this.once(i,h)})}fire(i,a){const h=typeof i=="string"?new Vs(i,a):i,f=h.type;if(this.listens(f)){h.target=this;const _=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const C of _)C.call(this,h);const y=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const C of y)$s(f,C,this._oneTimeListeners),C.call(this,h);const x=this._eventedParent;if(x){const C=typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData;Object.assign(h,C),x.fire(h)}}else h instanceof el&&console.error(h.error);return this}listens(i){return!!(this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i))}setEventedParent(i,a){return this._eventedParent=i,this._eventedParentData=a,this}}class sa{constructor(i){typeof i=="string"?this.name=i:(this.name=i.name,this.iconsetId=i.iconsetId)}static from(i){return new sa(i)}static toString(i){return i.iconsetId?`${i.name}${i.iconsetId}`:i.name}static parse(i){const[a,h]=i.split("");return new sa({name:a,iconsetId:h})}static isEqual(i,a){return i.name===a.name&&i.iconsetId===a.iconsetId}toString(){return sa.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var Yl,qc={},Pu=function(){if(Yl)return qc;Yl=1;var l={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function i(_){return(_=Math.round(_))<0?0:_>255?255:_}function a(_){return i(_[_.length-1]==="%"?parseFloat(_)/100*255:parseInt(_))}function h(_){return(y=_[_.length-1]==="%"?parseFloat(_)/100:parseFloat(_))<0?0:y>1?1:y;var y}function f(_,y,x){return x<0?x+=1:x>1&&(x-=1),6*x<1?_+(y-_)*x*6:2*x<1?y:3*x<2?_+(y-_)*(2/3-x)*6:_}try{qc.parseCSSColor=function(_){var y,x=_.replace(/ /g,"").toLowerCase();if(x in l)return l[x].slice();if(x[0]==="#")return x.length===4?(y=parseInt(x.substr(1),16))>=0&&y<=4095?[(3840&y)>>4|(3840&y)>>8,240&y|(240&y)>>4,15&y|(15&y)<<4,1]:null:x.length===7&&(y=parseInt(x.substr(1),16))>=0&&y<=16777215?[(16711680&y)>>16,(65280&y)>>8,255&y,1]:null;var C=x.indexOf("("),I=x.indexOf(")");if(C!==-1&&I+1===x.length){var R=x.substr(0,C),P=x.substr(C+1,I-(C+1)).split(","),L=1;switch(R){case"rgba":if(P.length!==4)return null;L=h(P.pop());case"rgb":return P.length!==3?null:[a(P[0]),a(P[1]),a(P[2]),L];case"hsla":if(P.length!==4)return null;L=h(P.pop());case"hsl":if(P.length!==3)return null;var $=(parseFloat(P[0])%360+360)%360/360,j=h(P[1]),q=h(P[2]),Z=q<=.5?q*(j+1):q+j-q*j,K=2*q-Z;return[i(255*f(K,Z,$+1/3)),i(255*f(K,Z,$)),i(255*f(K,Z,$-1/3)),L];default:return null}}return null}}catch{}return qc}();class Bi{constructor(i,a,h,f=1){this.r=i,this.g=a,this.b=h,this.a=f}static parse(i){if(!i)return;if(i instanceof Bi)return i;if(typeof i!="string")return;const a=Pu.parseCSSColor(i);return a?new Bi(a[0]/255,a[1]/255,a[2]/255,a[3]):void 0}toString(){const[i,a,h,f]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*i)},${Math.round(255*a)},${Math.round(255*h)},${f})`}toNonPremultipliedRenderColor(i){const{r:a,g:h,b:f,a:_}=this;return new Mu(i,a,h,f,_)}toPremultipliedRenderColor(i){const{r:a,g:h,b:f,a:_}=this;return new Jl(i,a*_,h*_,f*_,_)}clone(){return new Bi(this.r,this.g,this.b,this.a)}}class Zc{constructor(i,a,h,f,_,y=!1){if(this.premultiplied=!1,this.premultiplied=y,i){const x=i.image.height,C=x*x;this.premultiplied?(a=_===0?0:a/_*(x-1),h=_===0?0:h/_*(x-1),f=_===0?0:f/_*(x-1)):(a*=x-1,h*=x-1,f*=x-1);const I=Math.floor(a),R=Math.floor(h),P=Math.floor(f),L=Math.ceil(a),$=Math.ceil(h),j=Math.ceil(f),q=a-I,Z=h-R,K=f-P,ae=i.image.data,ue=4*(I+R*C+P*x),fe=4*(I+R*C+j*x),Me=4*(I+$*C+P*x),De=4*(I+$*C+j*x),Ve=4*(L+R*C+P*x),He=4*(L+R*C+j*x),Ze=4*(L+$*C+P*x),_t=4*(L+$*C+j*x);if(ue<0||_t>=ae.length)throw new Error("out of range");this.r=Pn(Pn(Pn(ae[ue],ae[fe],K),Pn(ae[Me],ae[De],K),Z),Pn(Pn(ae[Ve],ae[He],K),Pn(ae[Ze],ae[_t],K),Z),q)/255*(this.premultiplied?_:1),this.g=Pn(Pn(Pn(ae[ue+1],ae[fe+1],K),Pn(ae[Me+1],ae[De+1],K),Z),Pn(Pn(ae[Ve+1],ae[He+1],K),Pn(ae[Ze+1],ae[_t+1],K),Z),q)/255*(this.premultiplied?_:1),this.b=Pn(Pn(Pn(ae[ue+2],ae[fe+2],K),Pn(ae[Me+2],ae[De+2],K),Z),Pn(Pn(ae[Ve+2],ae[He+2],K),Pn(ae[Ze+2],ae[_t+2],K),Z),q)/255*(this.premultiplied?_:1),this.a=_}else this.r=a,this.g=h,this.b=f,this.a=_}toArray(){const{r:i,g:a,b:h,a:f}=this;return[255*i,255*a,255*h,f]}toHslaArray(){let{r:i,g:a,b:h,a:f}=this;if(this.premultiplied){if(f===0)return[0,0,0,0];const j=1/f;i*=j,a*=j,h*=j}const _=Math.min(Math.max(i,0),1),y=Math.min(Math.max(a,0),1),x=Math.min(Math.max(h,0),1),C=Math.min(_,y,x),I=Math.max(_,y,x),R=I-C,P=.5*(C+I);if(R===0)return[0,0,100*P,f];const L=P>.5?R/(2-I-C):R/(I+C);let $;switch(I){case _:$=60*((y-x)/R+(y<x?6:0));break;case y:$=60*((x-_)/R+2);break;default:$=60*((_-y)/R+4)}return[$,100*L,100*P,f]}toArray01(){const{r:i,g:a,b:h,a:f}=this;return[i,a,h,f]}toArray01Scaled(i){const{r:a,g:h,b:f}=this;return[a*i,h*i,f*i]}toArray01Linear(){const{r:i,g:a,b:h,a:f}=this;return[Math.pow(i,2.2),Math.pow(a,2.2),Math.pow(h,2.2),f]}}class Mu extends Zc{constructor(i,a,h,f,_){super(i,a,h,f,_,!1)}}class Jl extends Zc{constructor(i,a,h,f,_){super(i,a,h,f,_,!0)}}function Pn(l,i,a){return l*(1-a)+i*a}function gd(l,i,a){return l.map((h,f)=>Pn(h,i[f],a))}Bi.black=new Bi(0,0,0,1),Bi.white=new Bi(1,1,1,1),Bi.transparent=new Bi(0,0,0,0),Bi.red=new Bi(1,0,0,1),Bi.blue=new Bi(0,0,1,1);var us=Object.freeze({__proto__:null,array:gd,color:function(l,i,a){return new Bi(Pn(l.r,i.r,a),Pn(l.g,i.g,a),Pn(l.b,i.b,a),Pn(l.a,i.a,a))},number:Pn});class ma extends Error{constructor(i,a){super(a),this.message=a,this.key=i}}class Ql{constructor(i,a=[]){this.parent=i,this.bindings={};for(const[h,f]of a)this.bindings[h]=f}concat(i){return new Ql(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}const ja={kind:"null"},bn={kind:"number"},wi={kind:"string"},Ni={kind:"boolean"},Ys={kind:"color"},Is={kind:"object"},M={kind:"value"},J={kind:"collator"},le={kind:"formatted"},Ne={kind:"resolvedImage"};function Ct(l,i){return{kind:"array",itemType:l,N:i}}function kt(l){if(l.kind==="array"){const i=kt(l.itemType);return typeof l.N=="number"?`array<${i}, ${l.N}>`:l.itemType.kind==="value"?"array":`array<${i}>`}return l.kind}const Nn=[ja,bn,wi,Ni,Ys,le,Is,Ct(M),Ne];function Gi(l,i){if(i.kind==="error")return null;if(l.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!Gi(l.itemType,i.itemType))&&(typeof l.N!="number"||l.N===i.N))return null}else{if(l.kind===i.kind)return null;if(l.kind==="value"){for(const a of Nn)if(!Gi(a,i))return null}}return`Expected ${kt(l)} but found ${kt(i)} instead.`}function Jo(l,i){return i.some(a=>a.kind===l.kind)}function Hr(l,i){return i.some(a=>a==="null"?l===null:a==="array"?Array.isArray(l):a==="object"?l&&!Array.isArray(l)&&typeof l=="object":a===typeof l)}function fo(l,i){return l.kind==="array"&&i.kind==="array"?l.N===i.N&&fo(l.itemType,i.itemType):l.kind===i.kind}class jo{constructor(i,a,h){this.sensitivity=i?a?"variant":"case":a?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,a){return this.collator.compare(i,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class tl{constructor(i,a,h,f,_){this.text=i.normalize?i.normalize():i,this.image=a,this.scale=h,this.fontStack=f,this.textColor=_}}class Co{constructor(i){this.sections=i}static fromString(i){return new Co([new tl(i,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(i=>i.text.length!==0||!!i.image&&i.image.hasPrimary())}static factory(i){return i instanceof Co?i:Co.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map(i=>i.text).join("")}serialize(){const i=["format"];for(const a of this.sections){if(a.image){const f=a.image.getPrimary().id.toString();i.push(["image",f]);continue}i.push(a.text);const h={};a.fontStack&&(h["text-font"]=["literal",a.fontStack.split(",")]),a.scale&&(h["font-scale"]=a.scale),a.textColor&&(h["text-color"]=["rgba"].concat(a.textColor.toNonPremultipliedRenderColor(null).toArray())),i.push(h)}return i}}class As{constructor(i,a={}){if(this.id=sa.from(i),this.options=Object.assign({},a),a.transform){const{a:h,b:f,c:_,d:y,e:x,f:C}=a.transform;this.options.transform=new DOMMatrix([h,f,_,y,x,C])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){const{a:i,b:a,c:h,d:f,e:_,f:y}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a:i,b:a,c:h,d:f,e:_,f:y}})}static parse(i){let a,h,f,_;try{({name:a,iconsetId:h,params:f,transform:_}=JSON.parse(i)||{})}catch{return null}if(!a)return null;const{a:y,b:x,c:C,d:I,e:R,f:P}=_||{};return new As({name:a,iconsetId:h},{params:f,transform:new DOMMatrix([y,x,C,I,R,P])})}scaleSelf(i,a){return this.options.transform.scaleSelf(i,a),this}}class ks{constructor(i,a,h,f,_=!1){this.primaryId=sa.from(i),this.primaryOptions=a,h&&(this.secondaryId=sa.from(h)),this.secondaryOptions=f,this.available=_}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new As(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new As(this.secondaryId,this.secondaryOptions):null}static from(i){return typeof i=="string"?ks.build({name:i}):i}static build(i,a,h,f){return!i||typeof i=="object"&&!("name"in i)?null:new ks(i,h,a,f)}}function _d(l,i,a,h){return typeof l=="number"&&l>=0&&l<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof a=="number"&&a>=0&&a<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[l,i,a,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[l,i,a,h]:[l,i,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function yd(l){if(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number"||l instanceof Bi||l instanceof jo||l instanceof Co||l instanceof ks)return!0;if(Array.isArray(l)){for(const i of l)if(!yd(i))return!1;return!0}if(typeof l=="object"){for(const i in l)if(!yd(l[i]))return!1;return!0}return!1}function ds(l){if(l===null)return ja;if(typeof l=="string")return wi;if(typeof l=="boolean")return Ni;if(typeof l=="number")return bn;if(l instanceof Bi)return Ys;if(l instanceof jo)return J;if(l instanceof Co)return le;if(l instanceof ks)return Ne;if(Array.isArray(l)){const i=l.length;let a;for(const h of l){const f=ds(h);if(a){if(a===f)continue;a=M;break}a=f}return Ct(a||M,i)}return Is}function ga(l){const i=typeof l;return l===null?"":i==="string"||i==="number"||i==="boolean"?String(l):l instanceof Co||l instanceof ks||l instanceof Bi?l.toString():JSON.stringify(l)}class ti{constructor(i,a){this.type=i,this.value=a}static parse(i,a){if(i.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!yd(i[1]))return a.error("invalid value");const h=i[1];let f=ds(h);const _=a.expectedType;return f.kind!=="array"||f.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(f=_),new ti(f,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Bi?["rgba"].concat(this.value.toNonPremultipliedRenderColor(null).toArray()):this.value instanceof Co?this.value.serialize():this.value}}class sn{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}}const _a={string:wi,number:bn,boolean:Ni,object:Is};class Dn{constructor(i,a){this.type=i,this.args=a}static parse(i,a){if(i.length<2)return a.error("Expected at least one argument.");let h,f=1;const _=i[0];if(_==="array"){let x,C;if(i.length>2){const I=i[1];if(typeof I!="string"||!(I in _a)||I==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);x=_a[I],f++}else x=M;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return a.error('The length argument to "array" must be a positive integer literal',2);C=i[2],f++}h=Ct(x,C)}else h=_a[_];const y=[];for(;f<i.length;f++){const x=a.parse(i[f],f,M);if(!x)return null;y.push(x)}return new Dn(h,y)}evaluate(i){for(let a=0;a<this.args.length;a++){const h=this.args[a].evaluate(i);if(!Gi(this.type,ds(h)))return h;if(a===this.args.length-1)throw new sn(`The expression ${JSON.stringify(this.args[a].serialize())} evaluated to ${kt(ds(h))} but was expected to be of type ${kt(this.type)}.`)}return null}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=this.type,a=[i.kind];if(i.kind==="array"){const h=i.itemType;if(h.kind==="string"||h.kind==="number"||h.kind==="boolean"){a.push(h.kind);const f=i.N;(typeof f=="number"||this.args.length>1)&&a.push(f)}}return a.concat(this.args.map(h=>h.serialize()))}}class Kc{constructor(i){this.type=le,this.sections=i}static parse(i,a){if(i.length<2)return a.error("Expected at least one argument.");const h=i[1];if(!Array.isArray(h)&&typeof h=="object")return a.error("First argument must be an image or text section.");const f=[];let _=!1;for(let y=1;y<=i.length-1;++y){const x=i[y];if(_&&typeof x=="object"&&!Array.isArray(x)){_=!1;let C=null;if(x["font-scale"]&&(C=a.parseObjectValue(x["font-scale"],y,"font-scale",bn),!C))return null;let I=null;if(x["text-font"]&&(I=a.parseObjectValue(x["text-font"],y,"text-font",Ct(wi)),!I))return null;let R=null;if(x["text-color"]&&(R=a.parseObjectValue(x["text-color"],y,"text-color",Ys),!R))return null;const P=f[f.length-1];P.scale=C,P.font=I,P.textColor=R}else{const C=a.parse(i[y],y,M);if(!C)return null;const I=C.type.kind;if(I!=="string"&&I!=="value"&&I!=="null"&&I!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,f.push({content:C,scale:null,font:null,textColor:null})}}return new Kc(f)}evaluate(i){return new Co(this.sections.map(a=>{const h=a.content.evaluate(i);return fo(ds(h),Ne)?new tl("",h,null,null,null):new tl(ga(h),null,a.scale?a.scale.evaluate(i):null,a.font?a.font.evaluate(i).join(","):null,a.textColor?a.textColor.evaluate(i):null)}))}eachChild(i){for(const a of this.sections)i(a.content),a.scale&&i(a.scale),a.font&&i(a.font),a.textColor&&i(a.textColor)}outputDefined(){return!1}serialize(){const i=["format"];for(const a of this.sections){i.push(a.content.serialize());const h={};a.scale&&(h["font-scale"]=a.scale.serialize()),a.font&&(h["text-font"]=a.font.serialize()),a.textColor&&(h["text-color"]=a.textColor.serialize()),i.push(h)}return i}}class Du{constructor(i,a,h,f){this._imageWarnHistory={},this.type=Ne,this.namePrimary=i,this.nameSecondary=a,h&&(this.paramsPrimary=h.params,this.iconsetIdPrimary=h.iconset?h.iconset.id:void 0),f&&(this.paramsSecondary=f.params,this.iconsetIdSecondary=f.iconset?f.iconset.id:void 0)}static parse(i,a){if(i.length<2)return a.error("Expected two or more arguments.");let h=1;const f=[];function _(){if(h<i.length){const x=a.parse(i[h],h++,wi);return x?(f.push({image:x,options:{}}),!0):(a.error(f.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function y(){if(h<i.length){const C=i[h];if((x=C)===null||typeof x!="object"||Array.isArray(x))return!0;const I=C.params,R=C.iconset,P=a.concat(h);if(!I&&!R)return h++,!0;if(I){if(typeof I!="object"||I.constructor!==Object)return P.error('Image options "params" should be an object'),!1;const L={},$=P.concat(void 0,"params");for(const j in I){if(!j)return $.error("Image parameter name should be non-empty"),!1;const q=$.concat(void 0,j).parse(I[j],void 0,Ys,void 0,{typeAnnotation:"coerce"});if(!q)return!1;L[j]=q}f[f.length-1].options.params=L}if(R){if(typeof R!="object"||R.constructor!==Object)return P.error('Image options "iconset" should be an object'),!1;if(!R.id)return P.error('Image options "iconset" should have an "id" property'),!1;f[f.length-1].options.iconset=R}return h++,!0}var x;return!0}for(let x=0;x<2;x++)if(!_()||!y())return;return new Du(f[0].image,f[1]?f[1].image:void 0,f[0].options,f[1]?f[1].options:void 0)}evaluateParams(i,a){const h={};if(a){for(const f in a)if(a[f])try{h[f]=a[f].evaluate(i)}catch{continue}if(Object.keys(h).length!==0)return{params:h}}}evaluate(i){const a={name:this.namePrimary.evaluate(i),iconsetId:this.iconsetIdPrimary},h=this.nameSecondary?{name:this.nameSecondary.evaluate(i),iconsetId:this.iconsetIdSecondary}:void 0,f=ks.build(a,h,this.paramsPrimary?this.evaluateParams(i,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(i,this.paramsSecondary):void 0);if(f&&i.availableImages){const _=f.getPrimary().id;if(f.available=i.availableImages.some(y=>sa.isEqual(y,_)),f.available){const y=f.getSecondary()?f.getSecondary().id:null;y&&(f.available=i.availableImages.some(x=>sa.isEqual(x,y)))}}return f}eachChild(i){if(i(this.namePrimary),this.paramsPrimary)for(const a in this.paramsPrimary)this.paramsPrimary[a]&&i(this.paramsPrimary[a]);if(this.nameSecondary&&(i(this.nameSecondary),this.paramsSecondary))for(const a in this.paramsSecondary)this.paramsSecondary[a]&&i(this.paramsSecondary[a])}outputDefined(){return!1}serializeOptions(i,a){const h={};if(a&&(h.iconset={id:a}),i){h.params={};for(const f in i)i[f]&&(h.params[f]=i[f].serialize())}return Object.keys(h).length>0?h:void 0}serialize(){const i=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){const a=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);a&&i.push(a)}if(this.nameSecondary&&(i.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){const a=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);a&&i.push(a)}return i}}function jn(l){return vd(l)?"string":Xc(l)?"number":Xp(l)?"boolean":Array.isArray(l)?"array":l===null?"null":Kp(l)?"object":typeof l}function Kp(l){return l!=null&&!Array.isArray(l)&&typeof l!="function"&&!(l instanceof String||l instanceof Number||l instanceof Boolean)&&typeof l=="object"}function vd(l){return typeof l=="string"||l instanceof String}function Xc(l){return typeof l=="number"||l instanceof Number}function Xp(l){return typeof l=="boolean"||l instanceof Boolean}const mf={"to-boolean":Ni,"to-color":Ys,"to-number":bn,"to-string":wi};class Ro{constructor(i,a){this.type=i,this.args=a}static parse(i,a){if(i.length<2)return a.error("Expected at least one argument.");const h=i[0],f=[];let _=ja;if(h==="to-array"){if(!Array.isArray(i[1]))return null;const y=i[1].length;if(a.expectedType){if(a.expectedType.kind!=="array")return a.error(`Expected ${a.expectedType.kind} but found array.`);_=Ct(a.expectedType.itemType,y)}else{if(!(y>0&&yd(i[1][0])))return null;_=Ct(ds(i[1][0]),y)}for(let x=0;x<y;x++){const C=i[1][x];let I;if(Array.isArray(C))I=a.parse(C,void 0,_.itemType);else{const R=jn(C);if(R!==_.itemType.kind)return a.error(`Expected ${_.itemType.kind} but found ${R}.`);I=a.registry.literal.parse(["literal",C===void 0?null:C],a)}if(!I)return null;f.push(I)}}else{if((h==="to-boolean"||h==="to-string")&&i.length!==2)return a.error("Expected one argument.");_=mf[h];for(let y=1;y<i.length;y++){const x=a.parse(i[y],y,M);if(!x)return null;f.push(x)}}return new Ro(_,f)}evaluate(i){if(this.type.kind==="boolean")return!!this.args[0].evaluate(i);if(this.type.kind==="color"){let a,h;for(const f of this.args){if(a=f.evaluate(i),h=null,a instanceof Bi)return a;if(typeof a=="string"){const _=i.parseColor(a);if(_)return _}else if(Array.isArray(a)&&(h=a.length<3||a.length>4?`Invalid rbga value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:_d(a[0],a[1],a[2],a[3]),!h))return new Bi(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new sn(h||`Could not parse color from value '${typeof a=="string"?a:String(JSON.stringify(a))}'`)}if(this.type.kind==="number"){let a=null;for(const h of this.args){if(a=h.evaluate(i),a===null)return 0;const f=Number(a);if(!isNaN(f))return f}throw new sn(`Could not convert ${JSON.stringify(a)} to number.`)}return this.type.kind==="formatted"?Co.fromString(ga(this.args[0].evaluate(i))):this.type.kind==="resolvedImage"?ks.build(ga(this.args[0].evaluate(i))):this.type.kind==="array"?this.args.map(a=>a.evaluate(i)):ga(this.args[0].evaluate(i))}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Kc([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Du(this.args[0]).serialize();const i=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(a=>{i.push(a.serialize())}),i}}const Yp=["Unknown","Point","LineString","Polygon"];class mc{constructor(i,a,h){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=i,this.options=a,this.iconImageUseTheme=h}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Yp[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(i){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const i=this.featureDistanceData.center,a=this.featureDistanceData.scale,{x:h,y:f}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(h*a-i[0])+this.featureDistanceData.bearing[1]*(f*a-i[1])}return 0}parseColor(i){let a=this._parseColorCache[i];return a||(a=this._parseColorCache[i]=Bi.parse(i)),a}getConfig(i){return this.options?this.options.get(i):null}}class ia{constructor(i,a,h,f,_){this.name=i,this.type=a,this._evaluate=h,this.args=f,this._overloadIndex=_}evaluate(i){if(!this._evaluate){const a=ia.definitions[this.name];this._evaluate=Array.isArray(a)?a[2]:a.overloads[this._overloadIndex][1]}return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(i=>i.serialize()))}static parse(i,a){const h=i[0],f=ia.definitions[h];if(!f)return a.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(f)?f[0]:f.type,y=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,x=[];let C=null,I=-1;for(const[R,P]of y){if(Array.isArray(R)&&R.length!==i.length-1)continue;x.push(R),I++,C=new Pf(a.registry,a.path,null,a.scope,void 0,a._scope,a.options,a.iconImageUseTheme);const L=[];let $=!1;for(let j=1;j<i.length;j++){const q=i[j],Z=Array.isArray(R)?R[j-1]:R.type,K=C.parse(q,1+L.length,Z);if(!K){$=!0;break}L.push(K)}if(!$)if(Array.isArray(R)&&R.length!==L.length)C.error(`Expected ${R.length} arguments, but found ${L.length} instead.`);else{for(let j=0;j<L.length;j++){const q=Array.isArray(R)?R[j]:R.type,Z=L[j];C.concat(j+1).checkSubtype(q,Z.type)}if(C.errors.length===0)return new ia(h,_,P,L,I)}}if(x.length===1)a.errors.push(...C.errors);else{const R=(x.length?x:y.map(([L])=>L)).map(gc).join(" | "),P=[];for(let L=1;L<i.length;L++){const $=a.parse(i[L],1+P.length);if(!$)return null;P.push(kt($.type))}a.error(`Expected arguments of type ${R}, but found (${P.join(", ")}) instead.`)}return null}static register(i,a){ia.definitions=a;for(const h in a)i[h]=ia}}function gc(l){return Array.isArray(l)?`(${l.map(kt).join(", ")})`:`(${kt(l.type)}...)`}class Rs{constructor(i,a,h){this.type=J,this.locale=h,this.caseSensitive=i,this.diacriticSensitive=a}static parse(i,a){if(i.length!==2)return a.error("Expected one argument.");const h=i[1];if(typeof h!="object"||Array.isArray(h))return a.error("Collator options argument must be an object.");const f=h["case-sensitive"]===void 0?a.parse(!1,1,Ni):a.parseObjectValue(h["case-sensitive"],1,"case-sensitive",Ni);if(!f)return null;const _=h["diacritic-sensitive"]===void 0?a.parse(!1,1,Ni):a.parseObjectValue(h["diacritic-sensitive"],1,"diacritic-sensitive",Ni);if(!_)return null;let y=null;return h.locale&&(y=a.parseObjectValue(h.locale,1,"locale",wi),!y)?null:new Rs(f,_,y)}evaluate(i){return new jo(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}serialize(){const i={};return i["case-sensitive"]=this.caseSensitive.serialize(),i["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(i.locale=this.locale.serialize()),["collator",i]}}function uh(l,i,a=0,h=l.length-1,f=Jp){for(;h>a;){if(h-a>600){const C=h-a+1,I=i-a+1,R=Math.log(C),P=.5*Math.exp(2*R/3),L=.5*Math.sqrt(R*P*(C-P)/C)*(I-C/2<0?-1:1);uh(l,i,Math.max(a,Math.floor(i-I*P/C+L)),Math.min(h,Math.floor(i+(C-I)*P/C+L)),f)}const _=l[i];let y=a,x=h;for(bd(l,a,i),f(l[h],_)>0&&bd(l,a,h);y<x;){for(bd(l,y,x),y++,x--;f(l[y],_)<0;)y++;for(;f(l[x],_)>0;)x--}f(l[a],_)===0?bd(l,a,x):(x++,bd(l,x,h)),x<=i&&(a=x+1),i<=x&&(h=x-1)}}function bd(l,i,a){const h=l[i];l[i]=l[a],l[a]=h}function Jp(l,i){return l<i?-1:l>i?1:0}function ya(l){let i=0;for(let a,h,f=0,_=l.length,y=_-1;f<_;y=f++)a=l[f],h=l[y],i+=(h.x-a.x)*(a.y+h.y);return i}function xd(l,i){l[0]=Math.min(l[0],i[0]),l[1]=Math.min(l[1],i[1]),l[2]=Math.max(l[2],i[0]),l[3]=Math.max(l[3],i[1])}function Al(l,i){return!(l[0]<=i[0]||l[2]>=i[2]||l[1]<=i[1]||l[3]>=i[3])}function kg(l,i,a){const h=l[0]-i[0],f=l[1]-i[1],_=l[0]-a[0],y=l[1]-a[1];return h*y-_*f==0&&h*_<=0&&f*y<=0}function Ou(l,i,a=!1){let h=!1;for(let x=0,C=i.length;x<C;x++){const I=i[x];for(let R=0,P=I.length,L=P-1;R<P;L=R++){const $=I[L],j=I[R];if(kg(l,$,j))return a;(_=$)[1]>(f=l)[1]!=(y=j)[1]>f[1]&&f[0]<(y[0]-_[0])*(f[1]-_[1])/(y[1]-_[1])+_[0]&&(h=!h)}}var f,_,y;return h}function Rg(l,i,a,h){const f=h[0]-a[0],_=h[1]-a[1],y=(l[0]-a[0])*_-f*(l[1]-a[1]),x=(i[0]-a[0])*_-f*(i[1]-a[1]);return y>0&&x<0||y<0&&x>0}function gf(l,i,a,h){return(f=[h[0]-a[0],h[1]-a[1]])[0]*(_=[i[0]-l[0],i[1]-l[1]])[1]-f[1]*_[0]!=0&&!(!Rg(l,i,a,h)||!Rg(a,h,l,i));var f,_}function _f(l){const i=new Dt(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),a=new Dt(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const h of l[0])i.x>h.x&&(i.x=h.x),i.y>h.y&&(i.y=h.y),a.x<h.x&&(a.x=h.x),a.y<h.y&&(a.y=h.y);return{min:i,max:a}}const Yc=8192;function Lu(l,i){const a=(180+l[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,f=Math.pow(2,i.z);return[Math.round(a*f*Yc),Math.round(h*f*Yc)]}function xy(l,i){for(let a=0;a<i.length;a++)if(Ou(l,i[a]))return!0;return!1}function Pg(l,i,a){for(const h of a)for(let f=0,_=h.length,y=_-1;f<_;y=f++)if(gf(l,i,h[y],h[f]))return!0;return!1}function dh(l,i){for(let a=0;a<l.length;++a)if(!Ou(l[a],i))return!1;for(let a=0;a<l.length-1;++a)if(Pg(l[a],l[a+1],i))return!1;return!0}function yf(l,i){for(let a=0;a<i.length;a++)if(dh(l,i[a]))return!0;return!1}function vf(l,i,a){const h=[];for(let f=0;f<l.length;f++){const _=[];for(let y=0;y<l[f].length;y++){const x=Lu(l[f][y],a);xd(i,x),_.push(x)}h.push(_)}return h}function nl(l,i,a){const h=[];for(let f=0;f<l.length;f++){const _=vf(l[f],i,a);h.push(_)}return h}function Jc(l,i,a,h){if(l[0]<a[0]||l[0]>a[2]){const f=.5*h;let _=l[0]-a[0]>f?-h:a[0]-l[0]>f?h:0;_===0&&(_=l[0]-a[2]>f?-h:a[2]-l[0]>f?h:0),l[0]+=_}xd(i,l)}function ec(l,i,a,h){const f=Math.pow(2,h.z)*Yc,_=[h.x*Yc,h.y*Yc],y=[];if(!l)return y;for(const x of l)for(const C of x){const I=[C.x+_[0],C.y+_[1]];Jc(I,i,a,f),y.push(I)}return y}function Qp(l,i,a,h){const f=Math.pow(2,h.z)*Yc,_=[h.x*Yc,h.y*Yc],y=[];if(!l)return y;for(const C of l){const I=[];for(const R of C){const P=[R.x+_[0],R.y+_[1]];xd(i,P),I.push(P)}y.push(I)}if(i[2]-i[0]<=f/2){(x=i)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(const C of y)for(const I of C)Jc(I,i,a,f)}var x;return y}class zu{constructor(i,a){this.type=Ni,this.geojson=i,this.geometries=a}static parse(i,a){if(i.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(yd(i[1])){const h=i[1];if(h.type==="FeatureCollection")for(let f=0;f<h.features.length;++f){const _=h.features[f].geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new zu(h,h.features[f].geometry)}else if(h.type==="Feature"){const f=h.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new zu(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new zu(h,h)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(a,h){const f=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],y=a.canonicalID();if(!y)return!1;if(h.type==="Polygon"){const x=vf(h.coordinates,_,y),C=ec(a.geometry(),f,_,y);if(!Al(f,_))return!1;for(const I of C)if(!Ou(I,x))return!1}if(h.type==="MultiPolygon"){const x=nl(h.coordinates,_,y),C=ec(a.geometry(),f,_,y);if(!Al(f,_))return!1;for(const I of C)if(!xy(I,x))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(a,h){const f=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],y=a.canonicalID();if(!y)return!1;if(h.type==="Polygon"){const x=vf(h.coordinates,_,y),C=Qp(a.geometry(),f,_,y);if(!Al(f,_))return!1;for(const I of C)if(!dh(I,x))return!1}if(h.type==="MultiPolygon"){const x=nl(h.coordinates,_,y),C=Qp(a.geometry(),f,_,y);if(!Al(f,_))return!1;for(const I of C)if(!yf(I,x))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const wd={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},bf=1/298.257223563,xf=bf*(2-bf),Bu=Math.PI/180;class Sd{static fromTile(i,a,h){const f=Math.PI*(1-2*(i+.5)/Math.pow(2,a)),_=Math.atan(.5*(Math.exp(f)-Math.exp(-f)))/Bu;return new Sd(_,h)}static get units(){return wd}constructor(i,a){if(i===void 0)throw new Error("No latitude given.");if(a&&!wd[a])throw new Error(`Unknown unit ${a}. Use one of: ${Object.keys(wd).join(", ")}`);const h=6378.137*Bu*(a?wd[a]:1),f=Math.cos(i*Bu),_=1/(1-xf*(1-f*f)),y=Math.sqrt(_);this.kx=h*y*f,this.ky=h*y*_*(1-xf)}distance(i,a){const h=Ea(i[0]-a[0])*this.kx,f=(i[1]-a[1])*this.ky;return Math.sqrt(h*h+f*f)}bearing(i,a){const h=Ea(a[0]-i[0])*this.kx;return Math.atan2(h,(a[1]-i[1])*this.ky)/Bu}destination(i,a,h){const f=h*Bu;return this.offset(i,Math.sin(f)*a,Math.cos(f)*a)}offset(i,a,h){return[i[0]+a/this.kx,i[1]+h/this.ky]}lineDistance(i){let a=0;for(let h=0;h<i.length-1;h++)a+=this.distance(i[h],i[h+1]);return a}area(i){let a=0;for(let h=0;h<i.length;h++){const f=i[h];for(let _=0,y=f.length,x=y-1;_<y;x=_++)a+=Ea(f[_][0]-f[x][0])*(f[_][1]+f[x][1])*(h?-1:1)}return Math.abs(a)/2*this.kx*this.ky}along(i,a){let h=0;if(a<=0)return i[0];for(let f=0;f<i.length-1;f++){const _=i[f],y=i[f+1],x=this.distance(_,y);if(h+=x,h>a)return wf(_,y,(a-(h-x))/x)}return i[i.length-1]}pointToSegmentDistance(i,a,h){let[f,_]=a,y=Ea(h[0]-f)*this.kx,x=(h[1]-_)*this.ky;if(y!==0||x!==0){const C=(Ea(i[0]-f)*this.kx*y+(i[1]-_)*this.ky*x)/(y*y+x*x);C>1?(f=h[0],_=h[1]):C>0&&(f+=y/this.kx*C,_+=x/this.ky*C)}return y=Ea(i[0]-f)*this.kx,x=(i[1]-_)*this.ky,Math.sqrt(y*y+x*x)}pointOnLine(i,a){let h=1/0,f=i[0][0],_=i[0][1],y=0,x=0;for(let C=0;C<i.length-1;C++){let I=i[C][0],R=i[C][1],P=Ea(i[C+1][0]-I)*this.kx,L=(i[C+1][1]-R)*this.ky,$=0;P===0&&L===0||($=(Ea(a[0]-I)*this.kx*P+(a[1]-R)*this.ky*L)/(P*P+L*L),$>1?(I=i[C+1][0],R=i[C+1][1]):$>0&&(I+=P/this.kx*$,R+=L/this.ky*$)),P=Ea(a[0]-I)*this.kx,L=(a[1]-R)*this.ky;const j=P*P+L*L;j<h&&(h=j,f=I,_=R,y=C,x=$)}return{point:[f,_],index:y,t:Math.max(0,Math.min(1,x))}}lineSlice(i,a,h){let f=this.pointOnLine(h,i),_=this.pointOnLine(h,a);if(f.index>_.index||f.index===_.index&&f.t>_.t){const I=f;f=_,_=I}const y=[f.point],x=f.index+1,C=_.index;!em(h[x],y[0])&&x<=C&&y.push(h[x]);for(let I=x+1;I<=C;I++)y.push(h[I]);return em(h[C],_.point)||y.push(_.point),y}lineSliceAlong(i,a,h){let f=0;const _=[];for(let y=0;y<h.length-1;y++){const x=h[y],C=h[y+1],I=this.distance(x,C);if(f+=I,f>i&&_.length===0&&_.push(wf(x,C,(i-(f-I))/I)),f>=a)return _.push(wf(x,C,(a-(f-I))/I)),_;f>i&&_.push(C)}return _}bufferPoint(i,a){const h=a/this.ky,f=a/this.kx;return[i[0]-f,i[1]-h,i[0]+f,i[1]+h]}bufferBBox(i,a){const h=a/this.ky,f=a/this.kx;return[i[0]-f,i[1]-h,i[2]+f,i[3]+h]}insideBBox(i,a){return Ea(i[0]-a[0])>=0&&Ea(i[0]-a[2])<=0&&i[1]>=a[1]&&i[1]<=a[3]}}function em(l,i){return l[0]===i[0]&&l[1]===i[1]}function wf(l,i,a){const h=Ea(i[0]-l[0]);return[l[0]+h*a,l[1]+(i[1]-l[1])*a]}function Ea(l){for(;l<-180;)l+=360;for(;l>180;)l-=360;return l}class hh{constructor(i=[],a=(h,f)=>h<f?-1:h>f?1:0){if(this.data=i,this.length=this.data.length,this.compare=a,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:a,compare:h}=this,f=a[i];for(;i>0;){const _=i-1>>1,y=a[_];if(h(f,y)>=0)break;a[i]=y,i=_}a[i]=f}_down(i){const{data:a,compare:h}=this,f=this.length>>1,_=a[i];for(;i<f;){let y=1+(i<<1);const x=y+1;if(x<this.length&&h(a[x],a[y])<0&&(y=x),h(a[y],_)>=0)break;a[i]=a[y],i=y}a[i]=_}}var Ut=8192;function tm(l,i){return i.dist-l.dist}const Cd=100,Td=50;function fh(l){const i=[1/0,1/0,-1/0,-1/0];if(i.length!==l.length)return!1;for(let a=0;a<i.length;a++)if(i[a]!==l[a])return!1;return!0}function Ua(l){return l[1]-l[0]+1}function kl(l,i){const a=l[1]>=l[0]&&l[1]<i;return a||console.warn("Distance Expression: Index is out of range"),a}function Sf(l,i){if(l[0]>l[1])return[null,null];const a=Ua(l);if(i){if(a===2)return[l,null];const h=Math.floor(a/2);return[[l[0],l[0]+h],[l[0]+h,l[1]]]}{if(a===1)return[l,null];const h=Math.floor(a/2)-1;return[[l[0],l[0]+h],[l[0]+h+1,l[1]]]}}function il(l,i){const a=[1/0,1/0,-1/0,-1/0];if(!kl(i,l.length))return a;for(let h=i[0];h<=i[1];++h)xd(a,l[h]);return a}function Ii(l){const i=[1/0,1/0,-1/0,-1/0];for(let a=0;a<l.length;++a)for(let h=0;h<l[a].length;++h)xd(i,l[a][h]);return i}function Ed(l,i,a){if(fh(l)||fh(i))return NaN;let h=0,f=0;return l[2]<i[0]&&(h=i[0]-l[2]),l[0]>i[2]&&(h=l[0]-i[2]),l[1]>i[3]&&(f=l[1]-i[3]),l[3]<i[1]&&(f=i[1]-l[3]),a.distance([0,0],[h,f])}function wy(l){return 360*l-180}function Sy(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function Cf(l,i){const a=Math.pow(2,i.z),h=(l.y/Ut+i.y)/a;return[wy((l.x/Ut+i.x)/a),Sy(h)]}function Cy(l,i){const a=[];for(let h=0;h<l.length;++h)a.push(Cf(l[h],i));return a}function Mr(l,i,a){const h=a.pointOnLine(i,l).point;return a.distance(l,h)}function ph(l,i,a,h,f){const _=a.slice(h[0],h[1]+1);let y=1/0;for(let x=i[0];x<=i[1];++x)if((y=Math.min(y,Mr(l[x],_,f)))===0)return 0;return y}function nm(l,i,a,h,f){const _=Math.min(f.pointToSegmentDistance(l,a,h),f.pointToSegmentDistance(i,a,h)),y=Math.min(f.pointToSegmentDistance(a,l,i),f.pointToSegmentDistance(h,l,i));return Math.min(_,y)}function Mg(l,i,a,h,f){if(!kl(i,l.length)||!kl(h,a.length))return NaN;let _=1/0;for(let y=i[0];y<i[1];++y)for(let x=h[0];x<h[1];++x){if(gf(l[y],l[y+1],a[x],a[x+1]))return 0;_=Math.min(_,nm(l[y],l[y+1],a[x],a[x+1],f))}return _}function Dg(l,i,a,h,f){if(!kl(i,l.length)||!kl(h,a.length))return NaN;let _=1/0;for(let y=i[0];y<=i[1];++y)for(let x=h[0];x<=h[1];++x)if((_=Math.min(_,f.distance(l[y],a[x])))===0)return _;return _}function mh(l,i,a){if(Ou(l,i,!0))return 0;let h=1/0;for(const f of i){const _=f.length;if(_<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(f[0]!==f[_-1]&&(h=Math.min(h,a.pointToSegmentDistance(l,f[_-1],f[0])))===0||(h=Math.min(h,Mr(l,f,a)))===0)return h}return h}function im(l,i,a,h){if(!kl(i,l.length))return NaN;for(let _=i[0];_<=i[1];++_)if(Ou(l[_],a,!0))return 0;let f=1/0;for(let _=i[0];_<i[1];++_)for(const y of a)for(let x=0,C=y.length,I=C-1;x<C;I=x++){if(gf(l[_],l[_+1],y[I],y[x]))return 0;f=Math.min(f,nm(l[_],l[_+1],y[I],y[x],h))}return f}function Tf(l,i){for(const a of l)for(let h=0;h<=a.length-1;++h)if(Ou(a[h],i,!0))return!0;return!1}function Ty(l,i,a,h=1/0){const f=Ii(l),_=Ii(i);if(h!==1/0&&Ed(f,_,a)>=h)return h;if(Al(f,_)){if(Tf(l,i))return 0}else if(Tf(i,l))return 0;let y=h;for(const x of l)for(let C=0,I=x.length,R=I-1;C<I;R=C++)for(const P of i)for(let L=0,$=P.length,j=$-1;L<$;j=L++){if(gf(x[R],x[C],P[j],P[L]))return 0;y=Math.min(y,nm(x[R],x[C],P[j],P[L],a))}return y}function Ef(l,i,a,h,f,_,y){if(_===null||y===null)return;const x=Ed(il(h,_),il(f,y),a);x<i&&l.push({dist:x,range1:_,range2:y})}function Ey(l,i,a,h,f=1/0){let _=Math.min(h.distance(l[0],a[0][0]),f);if(_===0)return _;const y=new hh([{dist:0,range1:[0,l.length-1],range2:[0,0]}],tm),x=i?Td:Cd,C=Ii(a);for(;y.length;){const I=y.pop();if(I.dist>=_)continue;const R=I.range1;if(Ua(R)<=x){if(!kl(R,l.length))return NaN;if(i){const P=im(l,R,a,h);if((_=Math.min(_,P))===0)return _}else for(let P=R[0];P<=R[1];++P){const L=mh(l[P],a,h);if((_=Math.min(_,L))===0)return _}}else{const P=Sf(R,i);if(P[0]!==null){const L=Ed(il(l,P[0]),C,h);L<_&&y.push({dist:L,range1:P[0],range2:[0,0]})}if(P[1]!==null){const L=Ed(il(l,P[1]),C,h);L<_&&y.push({dist:L,range1:P[1],range2:[0,0]})}}}return _}function Qc(l,i,a,h,f,_=1/0){let y=Math.min(_,f.distance(l[0],a[0]));if(y===0)return y;const x=new hh([{dist:0,range1:[0,l.length-1],range2:[0,a.length-1]}],tm),C=i?Td:Cd,I=h?Td:Cd;for(;x.length;){const R=x.pop();if(R.dist>=y)continue;const P=R.range1,L=R.range2;if(Ua(P)<=C&&Ua(L)<=I){if(!kl(P,l.length)||!kl(L,a.length))return NaN;if(i&&h?y=Math.min(y,Mg(l,P,a,L,f)):i||h?i&&!h?y=Math.min(y,ph(a,L,l,P,f)):!i&&h&&(y=Math.min(y,ph(l,P,a,L,f))):y=Math.min(y,Dg(l,P,a,L,f)),y===0)return y}else{const $=Sf(P,i),j=Sf(L,h);Ef(x,y,f,l,a,$[0],j[0]),Ef(x,y,f,l,a,$[0],j[1]),Ef(x,y,f,l,a,$[1],j[0]),Ef(x,y,f,l,a,$[1],j[1])}}return y}function rm(l,i,a,h,f=1/0){let _=f;const y=il(l,[0,l.length-1]);for(const x of a)if(!(_!==1/0&&Ed(y,il(x,[0,x.length-1]),h)>=_)&&(_=Math.min(_,Qc(l,i,x,!0,h,_)),_===0))return _;return _}function If(l,i,a,h,f=1/0){let _=f;const y=il(l,[0,l.length-1]);for(const x of a){if(_!==1/0&&Ed(y,Ii(x),h)>=_)continue;const C=Ey(l,i,x,h,_);if(isNaN(C))return C;if((_=Math.min(_,C))===0)return _}return _}function om(l){return l==="Point"||l==="MultiPoint"||l==="LineString"||l==="MultiLineString"||l==="Polygon"||l==="MultiPolygon"}class Fu{constructor(i,a){this.type=bn,this.geojson=i,this.geometries=a}static parse(i,a){if(i.length!==2)return a.error(`'distance' expression requires either one argument, but found ' ${i.length-1} instead.`);if(yd(i[1])){const h=i[1];if(h.type==="FeatureCollection"){for(let f=0;f<h.features.length;++f)if(om(h.features[f].geometry.type))return new Fu(h,h.features[f].geometry)}else if(h.type==="Feature"){if(om(h.geometry.type))return new Fu(h,h.geometry)}else if(om(h.type))return new Fu(h,h)}return a.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(i){const a=i.geometry(),h=i.canonicalID();if(a!=null&&h!=null){if(i.geometryType()==="Point")return function(f,_,y){const x=[];for(const I of f)for(const R of I)x.push(Cf(R,_));const C=new Sd(x[0][1],"meters");return y.type==="Point"||y.type==="MultiPoint"||y.type==="LineString"?Qc(x,!1,y.type==="Point"?[y.coordinates]:y.coordinates,y.type==="LineString",C):y.type==="MultiLineString"?rm(x,!1,y.coordinates,C):y.type==="Polygon"||y.type==="MultiPolygon"?If(x,!1,y.type==="Polygon"?[y.coordinates]:y.coordinates,C):null}(a,h,this.geometries);if(i.geometryType()==="LineString")return function(f,_,y){const x=[];for(const I of f){const R=[];for(const P of I)R.push(Cf(P,_));x.push(R)}const C=new Sd(x[0][0][1],"meters");if(y.type==="Point"||y.type==="MultiPoint"||y.type==="LineString")return rm(y.type==="Point"?[y.coordinates]:y.coordinates,y.type==="LineString",x,C);if(y.type==="MultiLineString"){let I=1/0;for(let R=0;R<y.coordinates.length;R++){const P=rm(y.coordinates[R],!0,x,C,I);if(isNaN(P))return P;if((I=Math.min(I,P))===0)return I}return I}if(y.type==="Polygon"||y.type==="MultiPolygon"){let I=1/0;for(let R=0;R<x.length;R++){const P=If(x[R],!0,y.type==="Polygon"?[y.coordinates]:y.coordinates,C,I);if(isNaN(P))return P;if((I=Math.min(I,P))===0)return I}return I}return null}(a,h,this.geometries);if(i.geometryType()==="Polygon")return function(f,_,y){const x=[];for(const I of function(R,P){const L=R.length;if(L<=1)return[R];const $=[];let j,q;for(let Z=0;Z<L;Z++){const K=ya(R[Z]);K!==0&&(R[Z].area=Math.abs(K),q===void 0&&(q=K<0),q===K<0?(j&&$.push(j),j=[R[Z]]):j.push(R[Z]))}return j&&$.push(j),$}(f)){const R=[];for(let P=0;P<I.length;++P)R.push(Cy(I[P],_));x.push(R)}const C=new Sd(x[0][0][0][1],"meters");if(y.type==="Point"||y.type==="MultiPoint"||y.type==="LineString")return If(y.type==="Point"?[y.coordinates]:y.coordinates,y.type==="LineString",x,C);if(y.type==="MultiLineString"){let I=1/0;for(let R=0;R<y.coordinates.length;R++){const P=If(y.coordinates[R],!0,x,C,I);if(isNaN(P))return P;if((I=Math.min(I,P))===0)return I}return I}return y.type==="Polygon"||y.type==="MultiPolygon"?function(I,R,P){let L=1/0;for(const $ of I)for(const j of R){const q=Ty($,j,P,L);if(isNaN(q))return q;if((L=Math.min(L,q))===0)return L}return L}(y.type==="Polygon"?[y.coordinates]:y.coordinates,x,C):null}(a,h,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function _c(l){if(l instanceof ia&&(l.name==="get"&&l.args.length===1||l.name==="feature-state"||l.name==="has"&&l.args.length===1||l.name==="properties"||l.name==="geometry-type"||l.name==="id"||/^filter-/.test(l.name))||l instanceof zu||l instanceof Fu)return!1;if(l instanceof Vu)return l.featureConstant;let i=!0;return l.eachChild(a=>{i&&!_c(a)&&(i=!1)}),i}function Id(l){if(l instanceof ia&&l.name==="feature-state")return!1;let i=!0;return l.eachChild(a=>{i&&!Id(a)&&(i=!1)}),i}function Af(l){if(l instanceof Vu)return new Set([l.key]);let i=new Set;return l.eachChild(a=>{i=new Set([...i,...Af(a)])}),i}function Nu(l,i){if(l instanceof ia&&i.indexOf(l.name)>=0)return!1;let a=!0;return l.eachChild(h=>{a&&!Nu(h,i)&&(a=!1)}),a}function Og(l,i,a){return[l,i,a].filter(Boolean).join("")}function eu(l,i){switch(l){case"string":return ga(i);case"number":return+i;case"boolean":return!!i;case"color":return Bi.parse(i);case"formatted":return Co.fromString(ga(i));case"resolvedImage":return ks.build(ga(i))}return i}function kf(l,i,a,h){return h!==void 0&&(l=h*Math.round(l/h)),i!==void 0&&l<i&&(l=i),a!==void 0&&l>a&&(l=a),l}class Vu{constructor(i,a,h,f=!1){this.type=i,this.key=a,this.scope=h,this.featureConstant=f}static parse(i,a){let h=a.expectedType;if(h==null&&(h=M),i.length<2||i.length>3)return a.error("Invalid number of arguments for 'config' expression.");const f=a.parse(i[1],1);if(!(f instanceof ti))return a.error("Key name of 'config' expression must be a string literal.");let _,y=!0;const x=ga(f.value);if(i.length>=3){const C=a.parse(i[2],2);if(!(C instanceof ti))return a.error("Scope of 'config' expression must be a string literal.");_=ga(C.value)}if(a.options){const C=Og(x,_,a._scope),I=a.options.get(C);I&&(y=_c(I.value||I.default))}return new Vu(h,x,_,y)}evaluate(i){const a=Og(this.key,this.scope,i.scope),h=i.getConfig(a);if(!h)return null;const{type:f,value:_,values:y,minValue:x,maxValue:C,stepValue:I}=h,R=h.default.evaluate(i);let P=R;if(_){const L=i.scope;i.scope=(L||"").split("").slice(1).join(""),P=_.evaluate(i),i.scope=L}return f&&(P=eu(f,P)),P===void 0||x===void 0&&C===void 0&&I===void 0||(typeof P=="number"?P=kf(P,x,C,I):Array.isArray(P)&&(P=P.map(L=>typeof L=="number"?kf(L,x,C,I):L))),_!==void 0&&P!==void 0&&y&&!y.includes(P)&&(P=R,f&&(P=eu(f,P))),(f&&f!==this.type||P!==void 0&&!fo(ds(P),this.type))&&(P=eu(this.type.kind,P)),P}eachChild(){}outputDefined(){return!1}serialize(){const i=["config",this.key];return this.scope&&i.concat(this.scope),i}}class Rf{constructor(i,a){this.type=a.type,this.name=i,this.boundExpression=a}static parse(i,a){if(i.length!==2||typeof i[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const h=i[1];return a.scope.has(h)?new Rf(h,a.scope.get(h)):a.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Pf{constructor(i,a=[],h,f=new Ql,_=[],y,x,C){this.registry=i,this.path=a,this.key=a.map(I=>typeof I=="string"?`['${I}']`:`[${I}]`).join(""),this.scope=f,this.errors=_,this.expectedType=h,this._scope=y,this.options=x,this.iconImageUseTheme=C}parse(i,a,h,f,_={}){return a||h?this.concat(a,null,h,f)._parse(i,_):this._parse(i,_)}parseObjectValue(i,a,h,f,_,y={}){return this.concat(a,h,f,_)._parse(i,y)}_parse(i,a){function h(f,_,y){return y==="assert"?new Dn(_,[f]):y==="coerce"?new Ro(_,[f]):f}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=typeof i[0]=="string"?this.registry[i[0]]:void 0;if(f){let _=f.parse(i,this);if(!_)return null;if(this.expectedType){const y=this.expectedType,x=_.type;if(y.kind!=="string"&&y.kind!=="number"&&y.kind!=="boolean"&&y.kind!=="object"&&y.kind!=="array"||x.kind!=="value")if(y.kind!=="color"&&y.kind!=="formatted"&&y.kind!=="resolvedImage"||x.kind!=="value"&&x.kind!=="string"){if(this.checkSubtype(y,x))return null}else _=h(_,y,a.typeAnnotation||"coerce");else _=h(_,y,a.typeAnnotation||"assert")}if(!(_ instanceof ti)&&_.type.kind!=="resolvedImage"&&sm(_)){const y=new mc(this._scope,this.options,this.iconImageUseTheme);try{_=new ti(_.type,_.evaluate(y))}catch(x){return this.error(x.message),null}}return _}return Ro.parse(["to-array",i],this)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,a,h,f){let _=typeof i=="number"?this.path.concat(i):this.path;_=typeof a=="string"?_.concat(a):_;const y=f?this.scope.concat(f):this.scope;return new Pf(this.registry,_,h||null,y,this.errors,this._scope,this.options,this.iconImageUseTheme)}error(i,...a){const h=`${this.key}${a.map(f=>`[${f}]`).join("")}`;this.errors.push(new ma(h,i))}checkSubtype(i,a){const h=Gi(i,a);return h&&this.error(h),h}}function sm(l){if(l instanceof Rf)return sm(l.boundExpression);if(l instanceof ia&&l.name==="error"||l instanceof Rs||l instanceof zu||l instanceof Fu||l instanceof Vu)return!1;const i=l instanceof Ro||l instanceof Dn;let a=!0;return l.eachChild(h=>{a=i?a&&sm(h):a&&h instanceof ti}),!!a&&_c(l)&&Nu(l,["zoom","heatmap-density","worldview","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function tu(l,i){const a=l.length-1;let h,f,_=0,y=a,x=0;for(;_<=y;)if(x=Math.floor((_+y)/2),h=l[x],f=l[x+1],h<=i){if(x===a||i<f)return x;_=x+1}else{if(!(h>i))throw new sn("Input is not a number.");y=x-1}return 0}class Rl{constructor(i,a,h){this.type=i,this.input=a,this.labels=[],this.outputs=[];for(const[f,_]of h)this.labels.push(f),this.outputs.push(_)}static parse(i,a){if(i.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return a.error("Expected an even number of arguments.");const h=a.parse(i[1],1,bn);if(!h)return null;const f=[];let _=null;a.expectedType&&a.expectedType.kind!=="value"&&(_=a.expectedType);for(let y=1;y<i.length;y+=2){const x=y===1?-1/0:i[y],C=i[y+1],I=y,R=y+1;if(typeof x!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(f.length&&f[f.length-1][0]>=x)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);const P=a.parse(C,R,_);if(!P)return null;_=_||P.type,f.push([x,P])}return new Rl(_,h,f)}evaluate(i){const a=this.labels,h=this.outputs;if(a.length===1)return h[0].evaluate(i);const f=this.input.evaluate(i);if(f<=a[0])return h[0].evaluate(i);const _=a.length;return f>=a[_-1]?h[_-1].evaluate(i):h[tu(a,f)].evaluate(i)}eachChild(i){i(this.input);for(const a of this.outputs)i(a)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){const i=["step",this.input.serialize()];for(let a=0;a<this.labels.length;a++)a>0&&i.push(this.labels[a]),i.push(this.outputs[a].serialize());return i}}const Lg=.95047,zg=1.08883,Bg=4/29,nu=6/29,Fg=3*nu*nu,Ng=nu*nu*nu,Iy=Math.PI/180,Ay=180/Math.PI;function Mf(l){return l>Ng?Math.pow(l,1/3):l/Fg+Bg}function Df(l){return l>nu?l*l*l:Fg*(l-Bg)}function gh(l){return 255*(l<=.0031308?12.92*l:1.055*Math.pow(l,1/2.4)-.055)}function tc(l){return(l/=255)<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function Of(l){const i=tc(l.r),a=tc(l.g),h=tc(l.b),f=Mf((.4124564*i+.3575761*a+.1804375*h)/Lg),_=Mf((.2126729*i+.7151522*a+.072175*h)/1);return{l:116*_-16,a:500*(f-_),b:200*(_-Mf((.0193339*i+.119192*a+.9503041*h)/zg)),alpha:l.a}}function yc(l){let i=(l.l+16)/116,a=isNaN(l.a)?i:i+l.a/500,h=isNaN(l.b)?i:i-l.b/200;return i=1*Df(i),a=Lg*Df(a),h=zg*Df(h),new Bi(gh(3.2404542*a-1.5371385*i-.4985314*h),gh(-.969266*a+1.8760108*i+.041556*h),gh(.0556434*a-.2040259*i+1.0572252*h),l.alpha)}function Vg(l,i,a){const h=i-l;return l+a*(h>180||h<-180?h-360*Math.round(h/360):h)}const vc={forward:Of,reverse:yc,interpolate:function(l,i,a){return{l:Pn(l.l,i.l,a),a:Pn(l.a,i.a,a),b:Pn(l.b,i.b,a),alpha:Pn(l.alpha,i.alpha,a)}}},iu={forward:function(l){const{l:i,a,b:h}=Of(l),f=Math.atan2(h,a)*Ay;return{h:f<0?f+360:f,c:Math.sqrt(a*a+h*h),l:i,alpha:l.a}},reverse:function(l){const i=l.h*Iy,a=l.c;return yc({l:l.l,a:Math.cos(i)*a,b:Math.sin(i)*a,alpha:l.alpha})},interpolate:function(l,i,a){return{h:Vg(l.h,i.h,a),c:Pn(l.c,i.c,a),l:Pn(l.l,i.l,a),alpha:Pn(l.alpha,i.alpha,a)}}};var Lf=Object.freeze({__proto__:null,hcl:iu,lab:vc});class Ia{constructor(i,a,h,f,_){this.type=i,this.operator=a,this.interpolation=h,this.input=f,this.labels=[],this.outputs=[];for(const[y,x]of _)this.labels.push(y),this.outputs.push(x)}static interpolationFactor(i,a,h,f){let _=0;if(i.name==="exponential")_=Ad(a,i.base,h,f);else if(i.name==="linear")_=Ad(a,1,h,f);else if(i.name==="cubic-bezier"){const y=i.controlPoints;_=new vl(y[0],y[1],y[2],y[3]).solve(Ad(a,1,h,f))}return _}static parse(i,a){let[h,f,_,...y]=i;if(!Array.isArray(f)||f.length===0)return a.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const I=f[1];if(typeof I!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:I}}else{if(f[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const I=f.slice(1);if(I.length!==4||I.some(R=>typeof R!="number"||R<0||R>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:I}}}if(i.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length-1>3&&(i.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(_=a.parse(_,2,bn),!_)return null;const x=[];let C=null;h==="interpolate-hcl"||h==="interpolate-lab"?C=Ys:a.expectedType&&a.expectedType.kind!=="value"&&(C=a.expectedType);for(let I=0;I<y.length;I+=2){const R=y[I],P=y[I+1],L=I+3,$=I+4;if(typeof R!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(x.length&&x[x.length-1][0]>=R)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',L);const j=a.parse(P,$,C);if(!j)return null;C=C||j.type,x.push([R,j])}return C.kind==="number"||C.kind==="color"||C.kind==="array"&&C.itemType.kind==="number"&&typeof C.N=="number"?new Ia(C,h,f,_,x):a.error(`Type ${kt(C)} is not interpolatable.`)}evaluate(i){const a=this.labels,h=this.outputs;if(a.length===1)return h[0].evaluate(i);const f=this.input.evaluate(i);if(f<=a[0])return h[0].evaluate(i);const _=a.length;if(f>=a[_-1])return h[_-1].evaluate(i);const y=tu(a,f),x=Ia.interpolationFactor(this.interpolation,f,a[y],a[y+1]),C=h[y].evaluate(i),I=h[y+1].evaluate(i);return this.operator==="interpolate"?us[this.type.kind.toLowerCase()](C,I,x):this.operator==="interpolate-hcl"?iu.reverse(iu.interpolate(iu.forward(C),iu.forward(I),x)):vc.reverse(vc.interpolate(vc.forward(C),vc.forward(I),x))}eachChild(i){i(this.input);for(const a of this.outputs)i(a)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){let i;i=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];const a=[this.operator,i,this.input.serialize()];for(let h=0;h<this.labels.length;h++)a.push(this.labels[h],this.outputs[h].serialize());return a}}function Ad(l,i,a,h){const f=h-a,_=l-a;return f===0?0:i===1?_/f:(Math.pow(i,_)-1)/(Math.pow(i,f)-1)}class _h{constructor(i,a){this.type=i,this.args=a}static parse(i,a){if(i.length<2)return a.error("Expectected at least one argument.");let h=null;const f=a.expectedType;f&&f.kind!=="value"&&(h=f);const _=[];for(const x of i.slice(1)){const C=a.parse(x,1+_.length,h,void 0,{typeAnnotation:"omit"});if(!C)return null;h=h||C.type,_.push(C)}const y=f&&_.some(x=>Gi(f,x.type));return new _h(y?M:h,_)}evaluate(i){let a,h=null,f=0;for(const _ of this.args){if(f++,h=_.evaluate(i),h&&h instanceof ks&&!h.available&&(a||(a=h),h=null,f===this.args.length))return a;if(h!==null)break}return h}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=["coalesce"];return this.eachChild(a=>{i.push(a.serialize())}),i}}class nc{constructor(i,a){this.type=a.type,this.bindings=[].concat(i),this.result=a}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const a of this.bindings)i(a[1]);i(this.result)}static parse(i,a){if(i.length<4)return a.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const h=[];for(let _=1;_<i.length-1;_+=2){const y=i[_];if(typeof y!="string")return a.error(`Expected string, but found ${typeof y} instead.`,_);if(/[^a-zA-Z0-9_]/.test(y))return a.error("Variable names must contain only alphanumeric characters or '_'.",_);const x=a.parse(i[_+1],_+1);if(!x)return null;h.push([y,x])}const f=a.parse(i[i.length-1],i.length-1,a.expectedType,h);return f?new nc(h,f):null}outputDefined(){return this.result.outputDefined()}serialize(){const i=["let"];for(const[a,h]of this.bindings)i.push(a,h.serialize());return i.push(this.result.serialize()),i}}class ic{constructor(i,a,h){this.type=i,this.index=a,this.input=h}static parse(i,a){if(i.length!==3)return a.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const h=a.parse(i[1],1,bn),f=a.parse(i[2],2,Ct(a.expectedType||M));return h&&f?new ic(f.type.itemType,h,f):null}evaluate(i){const a=this.index.evaluate(i),h=this.input.evaluate(i);if(a<0)throw new sn("Array index out of bounds: negative index");if(a>=h.length)throw new sn("Array index out of bounds: index exceeds array size");if(a!==Math.floor(a))throw new sn("Array index must be an integer. Use at-interpolated for fractional indices");return h[a]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class am{constructor(i,a,h){this.type=i,this.index=a,this.input=h}static parse(i,a){if(i.length!==3)return a.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const h=a.parse(i[1],1,bn),f=a.parse(i[2],2,Ct(a.expectedType||M));return h&&f?new am(f.type.itemType,h,f):null}evaluate(i){const a=this.index.evaluate(i),h=this.input.evaluate(i);if(a<0)throw new sn(`Array index out of bounds: ${a} < 0.`);if(a>h.length-1)throw new sn(`Array index out of bounds: ${a} > ${h.length-1}.`);if(a===Math.floor(a))return h[a];const f=Math.floor(a),_=Math.ceil(a),y=h[f],x=h[_];if(typeof y!="number"||typeof x!="number")throw new sn(`Cannot interpolate between non-number values at index ${a}.`);const C=a-f;return y*(1-C)+x*C}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class zf{constructor(i,a){this.type=Ni,this.needle=i,this.haystack=a}static parse(i,a){if(i.length!==3)return a.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const h=a.parse(i[1],1,M),f=a.parse(i[2],2,M);return h&&f?Jo(h.type,[Ni,wi,bn,ja,M])?new zf(h,f):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${kt(h.type)} instead`):null}evaluate(i){const a=this.needle.evaluate(i),h=this.haystack.evaluate(i);if(h==null)return!1;if(!Hr(a,["boolean","string","number","null"]))throw new sn(`Expected first argument to be of type boolean, string, number or null, but found ${kt(ds(a))} instead.`);if(!Hr(h,["string","array"]))throw new sn(`Expected second argument to be of type array or string, but found ${kt(ds(h))} instead.`);return h.indexOf(a)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class yh{constructor(i,a,h){this.type=bn,this.needle=i,this.haystack=a,this.fromIndex=h}static parse(i,a){if(i.length<=2||i.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const h=a.parse(i[1],1,M),f=a.parse(i[2],2,M);if(!h||!f)return null;if(!Jo(h.type,[Ni,wi,bn,ja,M]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${kt(h.type)} instead`);if(i.length===4){const _=a.parse(i[3],3,bn);return _?new yh(h,f,_):null}return new yh(h,f)}evaluate(i){const a=this.needle.evaluate(i),h=this.haystack.evaluate(i);if(!Hr(a,["boolean","string","number","null"]))throw new sn(`Expected first argument to be of type boolean, string, number or null, but found ${kt(ds(a))} instead.`);if(!Hr(h,["string","array"]))throw new sn(`Expected second argument to be of type array or string, but found ${kt(ds(h))} instead.`);if(this.fromIndex){const f=this.fromIndex.evaluate(i);return h.indexOf(a,f)}return h.indexOf(a)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const i=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),i]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class kd{constructor(i,a,h,f,_,y){this.inputType=i,this.type=a,this.input=h,this.cases=f,this.outputs=_,this.otherwise=y}static parse(i,a){if(i.length<5)return a.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return a.error("Expected an even number of arguments.");let h,f;a.expectedType&&a.expectedType.kind!=="value"&&(f=a.expectedType);const _={},y=[];for(let I=2;I<i.length-1;I+=2){let R=i[I];const P=i[I+1];Array.isArray(R)||(R=[R]);const L=a.concat(I);if(R.length===0)return L.error("Expected at least one branch label.");for(const j of R){if(typeof j!="number"&&typeof j!="string")return L.error("Branch labels must be numbers or strings.");if(typeof j=="number"&&Math.abs(j)>Number.MAX_SAFE_INTEGER)return L.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof j=="number"&&Math.floor(j)!==j)return L.error("Numeric branch labels must be integer values.");if(h){if(L.checkSubtype(h,ds(j)))return null}else h=ds(j);if(_[String(j)]!==void 0)return L.error("Branch labels must be unique.");_[String(j)]=y.length}const $=a.parse(P,I,f);if(!$)return null;f=f||$.type,y.push($)}const x=a.parse(i[1],1,M);if(!x)return null;const C=a.parse(i[i.length-1],i.length-1,f);return C?x.type.kind!=="value"&&a.concat(1).checkSubtype(h,x.type)?null:new kd(h,f,x,_,y,C):null}evaluate(i){const a=this.input.evaluate(i);return(fo(ds(a),this.inputType)&&this.outputs[this.cases[a]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["match",this.input.serialize()],a=Object.keys(this.cases).sort(),h=[],f={};for(const y of a){const x=f[this.cases[y]];x===void 0?(f[this.cases[y]]=h.length,h.push([this.cases[y],[y]])):h[x][1].push(y)}const _=y=>this.inputType.kind==="number"?Number(y):y;for(const[y,x]of h)i.push(x.length===1?_(x[0]):x.map(_)),i.push(this.outputs[y].serialize());return i.push(this.otherwise.serialize()),i}}class lm{constructor(i,a,h){this.type=i,this.branches=a,this.otherwise=h}static parse(i,a){if(i.length<4)return a.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return a.error("Expected an odd number of arguments.");let h;a.expectedType&&a.expectedType.kind!=="value"&&(h=a.expectedType);const f=[];for(let y=1;y<i.length-1;y+=2){const x=a.parse(i[y],y,Ni);if(!x)return null;const C=a.parse(i[y+1],y+1,h);if(!C)return null;f.push([x,C]),h=h||C.type}const _=a.parse(i[i.length-1],i.length-1,h);return _?new lm(h,f,_):null}evaluate(i){for(const[a,h]of this.branches)if(a.evaluate(i))return h.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[a,h]of this.branches)i(a),i(h);i(this.otherwise)}outputDefined(){return this.branches.every(([i,a])=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["case"];return this.eachChild(a=>{i.push(a.serialize())}),i}}class vh{constructor(i,a,h,f){this.type=i,this.input=a,this.beginIndex=h,this.endIndex=f}static parse(i,a){if(i.length<=2||i.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const h=a.parse(i[1],1,M),f=a.parse(i[2],2,bn);if(!h||!f)return null;if(!Jo(h.type,[Ct(M),wi,M]))return a.error(`Expected first argument to be of type array or string, but found ${kt(h.type)} instead`);if(i.length===4){const _=a.parse(i[3],3,bn);return _?new vh(h.type,h,f,_):null}return new vh(h.type,h,f)}evaluate(i){const a=this.input.evaluate(i),h=this.beginIndex.evaluate(i);if(!Hr(a,["string","array"]))throw new sn(`Expected first argument to be of type array or string, but found ${kt(ds(a))} instead.`);if(this.endIndex){const f=this.endIndex.evaluate(i);return a.slice(h,f)}return a.slice(h)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const i=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),i]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}class cm{constructor(i,a){this.type=Ct(wi),this.str=i,this.delimiter=a}static parse(i,a){if(i.length!==3)return a.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const h=a.parse(i[1],1,wi),f=a.parse(i[2],2,wi);return h&&f?new cm(h,f):void 0}evaluate(i){const a=this.str.evaluate(i),h=this.delimiter.evaluate(i);return a.split(h)}eachChild(i){i(this.str),i(this.delimiter)}outputDefined(){return!1}serialize(){return["split",this.str.serialize(),this.delimiter.serialize()]}}function $g(l,i){return l==="=="||l==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function Bf(l,i,a,h){return h.compare(i,a)===0}function rc(l,i,a){const h=l!=="=="&&l!=="!=";return class L6{constructor(_,y,x){this.type=Ni,this.lhs=_,this.rhs=y,this.collator=x,this.hasUntypedArgument=_.type.kind==="value"||y.type.kind==="value"}static parse(_,y){if(_.length!==3&&_.length!==4)return y.error("Expected two or three arguments.");const x=_[0];let C=y.parse(_[1],1,M);if(!C)return null;if(!$g(x,C.type))return y.concat(1).error(`"${x}" comparisons are not supported for type '${kt(C.type)}'.`);let I=y.parse(_[2],2,M);if(!I)return null;if(!$g(x,I.type))return y.concat(2).error(`"${x}" comparisons are not supported for type '${kt(I.type)}'.`);if(C.type.kind!==I.type.kind&&C.type.kind!=="value"&&I.type.kind!=="value")return y.error(`Cannot compare types '${kt(C.type)}' and '${kt(I.type)}'.`);h&&(C.type.kind==="value"&&I.type.kind!=="value"?C=new Dn(I.type,[C]):C.type.kind!=="value"&&I.type.kind==="value"&&(I=new Dn(C.type,[I])));let R=null;if(_.length===4){if(C.type.kind!=="string"&&I.type.kind!=="string"&&C.type.kind!=="value"&&I.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(R=y.parse(_[3],3,J),!R)return null}return new L6(C,I,R)}evaluate(_){const y=this.lhs.evaluate(_),x=this.rhs.evaluate(_);if(h&&this.hasUntypedArgument){const C=ds(y),I=ds(x);if(C.kind!==I.kind||C.kind!=="string"&&C.kind!=="number")throw new sn(`Expected arguments for "${l}" to be (string, string) or (number, number), but found (${C.kind}, ${I.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const C=ds(y),I=ds(x);if(C.kind!=="string"||I.kind!=="string")return i(_,y,x)}return this.collator?a(_,y,x,this.collator.evaluate(_)):i(_,y,x)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}serialize(){const _=[l];return this.eachChild(y=>{_.push(y.serialize())}),_}}}const Ff=rc("==",function(l,i,a){return i===a},Bf),ky=rc("!=",function(l,i,a){return i!==a},function(l,i,a,h){return!Bf(0,i,a,h)}),Ry=rc("<",function(l,i,a){return i<a},function(l,i,a,h){return h.compare(i,a)<0}),ru=rc(">",function(l,i,a){return i>a},function(l,i,a,h){return h.compare(i,a)>0}),_e=rc("<=",function(l,i,a){return i<=a},function(l,i,a,h){return h.compare(i,a)<=0}),V=rc(">=",function(l,i,a){return i>=a},function(l,i,a,h){return h.compare(i,a)>=0});class te{constructor(i,a,h,f,_,y){this.type=wi,this.number=i,this.locale=a,this.currency=h,this.unit=f,this.minFractionDigits=_,this.maxFractionDigits=y}static parse(i,a){if(i.length!==3)return a.error("Expected two arguments.");const h=a.parse(i[1],1,bn);if(!h)return null;const f=i[2];if(typeof f!="object"||Array.isArray(f))return a.error("NumberFormat options argument must be an object.");let _=null;if(f.locale&&(_=a.parseObjectValue(f.locale,2,"locale",wi),!_))return null;let y=null;if(f.currency&&(y=a.parseObjectValue(f.currency,2,"currency",wi),!y))return null;let x=null;if(f.unit&&(x=a.parseObjectValue(f.unit,2,"unit",wi),!x))return null;let C=null;if(f["min-fraction-digits"]&&(C=a.parseObjectValue(f["min-fraction-digits"],2,"min-fraction-digits",bn),!C))return null;let I=null;return f["max-fraction-digits"]&&(I=a.parseObjectValue(f["max-fraction-digits"],2,"max-fraction-digits",bn),!I)?null:new te(h,_,y,x,C,I)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(i):void 0,unit:this.unit?this.unit.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.unit&&i(this.unit),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const i={};return this.locale&&(i.locale=this.locale.serialize()),this.currency&&(i.currency=this.currency.serialize()),this.unit&&(i.unit=this.unit.serialize()),this.minFractionDigits&&(i["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(i["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),i]}}class Be{constructor(i){this.type=bn,this.input=i}static parse(i,a){if(i.length!==2)return a.error(`Expected 1 argument, but found ${i.length-1} instead.`);const h=a.parse(i[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${kt(h.type)} instead.`):new Be(h):null}evaluate(i){const a=this.input.evaluate(i);if(typeof a=="string"||Array.isArray(a))return a.length;throw new sn(`Expected value to be of type string or array, but found ${kt(ds(a))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){const i=["length"];return this.eachChild(a=>{i.push(a.serialize())}),i}}function yt(l){return function(){l=1831565813+(l|=0)|0;let i=Math.imul(l^l>>>15,1|l);return i=i+Math.imul(i^i>>>7,61|i)^i,((i^i>>>14)>>>0)/4294967296}}const xt={"==":Ff,"!=":ky,">":ru,"<":Ry,">=":V,"<=":_e,array:Dn,at:ic,"at-interpolated":am,boolean:Dn,case:lm,coalesce:_h,collator:Rs,format:Kc,image:Du,in:zf,"index-of":yh,interpolate:Ia,"interpolate-hcl":Ia,"interpolate-lab":Ia,length:Be,let:nc,literal:ti,match:kd,number:Dn,"number-format":te,object:Dn,slice:vh,step:Rl,string:Dn,"to-boolean":Ro,"to-color":Ro,"to-number":Ro,"to-string":Ro,var:Rf,within:zu,distance:Fu,config:Vu,split:cm};function Yt(l,[i,a,h,f]){i=i.evaluate(l),a=a.evaluate(l),h=h.evaluate(l);const _=f?f.evaluate(l):1,y=_d(i,a,h,_);if(y)throw new sn(y);return new Bi(i/255,a/255,h/255,_)}function _n(l,[i,a,h,f]){i=i.evaluate(l),a=a.evaluate(l),h=h.evaluate(l);const _=f?f.evaluate(l):1,y=function(I,R,P,L){return typeof I=="number"&&I>=0&&I<=360?typeof R=="number"&&R>=0&&R<=100&&typeof P=="number"&&P>=0&&P<=100?L===void 0||typeof L=="number"&&L>=0&&L<=1?null:`Invalid hsla value [${[I,R,P,L].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof L=="number"?[I,R,P,L]:[I,R,P]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof L=="number"?[I,R,P,L]:[I,R,P]).join(", ")}]: 'h' must be between 0 and 360.`}(i,a,h,_);if(y)throw new sn(y);const x=`hsla(${i}, ${a}%, ${h}%, ${_})`,C=Bi.parse(x);if(!C)throw new sn(`Failed to parse HSLA color: ${x}`);return C}function Bn(l,i){return l in i}function ni(l,i){const a=i[l];return a===void 0?null:a}function Jn(l){return{type:l}}function Gn(l){return{result:"success",value:l}}function Vi(l){return{result:"error",value:l}}function Li(l,i){return!!l&&!!l.parameters&&l.parameters.indexOf(i)>-1}function Wi(l){return l["property-type"]==="data-driven"}function $i(l){return Li(l.expression,"measure-light")}function Yi(l){return Li(l.expression,"zoom")}function io(l){return!!l.expression&&l.expression.interpolated}function po(l){return typeof l=="object"&&l!==null&&!Array.isArray(l)}function mr(l){return l}function Nr(l,i){const a=i.type==="color",h=l.stops&&typeof l.stops[0][0]=="object",f=h||!(h||l.property!==void 0),_=l.type||(io(i)?"exponential":"interval");if(a&&((l=Object.assign({},l)).stops&&(l.stops=l.stops.map(I=>[I[0],Bi.parse(I[1])])),l.default=Bi.parse(l.default?l.default:i.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!Lf[l.colorSpace])throw new Error(`Unknown color space: ${l.colorSpace}`);let y,x,C;if(_==="exponential")y=mo;else if(_==="interval")y=Ar;else if(_==="categorical"){y=Dr,x=Object.create(null);for(const I of l.stops)x[I[0]]=I[1];C=typeof l.stops[0][0]}else{if(_!=="identity")throw new Error(`Unknown function type "${_}"`);y=go}if(h){const I={},R=[];for(let $=0;$<l.stops.length;$++){const j=l.stops[$],q=j[0].zoom;I[q]===void 0&&(I[q]={zoom:q,type:l.type,property:l.property,default:l.default,stops:[]},R.push(q)),I[q].stops.push([j[0].value,j[1]])}const P=[];for(const $ of R)P.push([I[$].zoom,Nr(I[$],i)]);const L={name:"linear"};return{kind:"composite",interpolationType:L,interpolationFactor:Ia.interpolationFactor.bind(void 0,L),zoomStops:P.map($=>$[0]),evaluate:({zoom:$},j)=>mo({stops:P,base:l.base},i,$).evaluate($,j)}}if(f){const I=_==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:I,interpolationFactor:Ia.interpolationFactor.bind(void 0,I),zoomStops:l.stops.map(R=>R[0]),evaluate:({zoom:R})=>y(l,i,R,x,C)}}return{kind:"source",evaluate(I,R){const P=R&&R.properties?R.properties[l.property]:void 0;return P===void 0?Qi(l.default,i.default):y(l,i,P,x,C)}}}function Qi(l,i,a){return l!==void 0?l:i!==void 0?i:a!==void 0?a:void 0}function Dr(l,i,a,h,f){return Qi(typeof a===f?h[a]:void 0,l.default,i.default)}function Ar(l,i,a){if(!Xc(a))return Qi(l.default,i.default);const h=l.stops.length;if(h===1||a<=l.stops[0][0])return l.stops[0][1];if(a>=l.stops[h-1][0])return l.stops[h-1][1];const f=tu(l.stops.map(_=>_[0]),a);return l.stops[f][1]}function mo(l,i,a){const h=l.base!==void 0?l.base:1;if(!Xc(a))return Qi(l.default,i.default);const f=l.stops.length;if(f===1||a<=l.stops[0][0])return l.stops[0][1];if(a>=l.stops[f-1][0])return l.stops[f-1][1];const _=tu(l.stops.map(R=>R[0]),a),y=function(R,P,L,$){const j=$-L,q=R-L;return j===0?0:P===1?q/j:(Math.pow(P,q)-1)/(Math.pow(P,j)-1)}(a,h,l.stops[_][0],l.stops[_+1][0]),x=l.stops[_][1],C=l.stops[_+1][1];let I=us[i.type]||mr;if(l.colorSpace&&l.colorSpace!=="rgb"){const R=Lf[l.colorSpace];I=(P,L)=>R.reverse(R.interpolate(R.forward(P),R.forward(L),y))}return typeof x.evaluate=="function"?{evaluate(...R){const P=x.evaluate.apply(void 0,R),L=C.evaluate.apply(void 0,R);if(P!==void 0&&L!==void 0)return I(P,L,y)}}:I(x,C,y)}function go(l,i,a){return i.type==="color"?a=Bi.parse(a):i.type==="formatted"?a=Co.fromString(a.toString()):i.type==="resolvedImage"?a=ks.build(a.toString()):jn(a)===i.type||i.type==="enum"&&i.values[a]||(a=void 0),Qi(a,l.default,i.default)}ia.register(xt,{error:[{kind:"error"},[wi],(l,[i])=>{throw new sn(i.evaluate(l))}],typeof:[wi,[M],(l,[i])=>kt(ds(i.evaluate(l)))],"to-rgba":[Ct(bn,4),[Ys],(l,[i])=>i.evaluate(l).toNonPremultipliedRenderColor(null).toArray()],"to-hsla":[Ct(bn,4),[Ys],(l,[i])=>i.evaluate(l).toNonPremultipliedRenderColor(null).toHslaArray()],rgb:[Ys,[bn,bn,bn],Yt],rgba:[Ys,[bn,bn,bn,bn],Yt],hsl:[Ys,[bn,bn,bn],_n],hsla:[Ys,[bn,bn,bn,bn],_n],has:{type:Ni,overloads:[[[wi],(l,[i])=>Bn(i.evaluate(l),l.properties())],[[wi,Is],(l,[i,a])=>Bn(i.evaluate(l),a.evaluate(l))]]},get:{type:M,overloads:[[[wi],(l,[i])=>ni(i.evaluate(l),l.properties())],[[wi,Is],(l,[i,a])=>ni(i.evaluate(l),a.evaluate(l))]]},"feature-state":[M,[wi],(l,[i])=>ni(i.evaluate(l),l.featureState||{})],properties:[Is,[],l=>l.properties()],"geometry-type":[wi,[],l=>l.geometryType()],worldview:[wi,[],l=>l.globals.worldview||""],id:[M,[],l=>l.id()],zoom:[bn,[],l=>l.globals.zoom],pitch:[bn,[],l=>l.globals.pitch||0],"distance-from-center":[bn,[],l=>l.distanceFromCenter()],"measure-light":[bn,[wi],(l,[i])=>l.measureLight(i.evaluate(l))],"heatmap-density":[bn,[],l=>l.globals.heatmapDensity||0],"line-progress":[bn,[],l=>l.globals.lineProgress||0],"raster-value":[bn,[],l=>l.globals.rasterValue||0],"raster-particle-speed":[bn,[],l=>l.globals.rasterParticleSpeed||0],"sky-radial-progress":[bn,[],l=>l.globals.skyRadialProgress||0],accumulated:[M,[],l=>l.globals.accumulated===void 0?null:l.globals.accumulated],"+":[bn,Jn(bn),(l,i)=>{let a=0;for(const h of i)a+=h.evaluate(l);return a}],"*":[bn,Jn(bn),(l,i)=>{let a=1;for(const h of i)a*=h.evaluate(l);return a}],"-":{type:bn,overloads:[[[bn,bn],(l,[i,a])=>i.evaluate(l)-a.evaluate(l)],[[bn],(l,[i])=>-i.evaluate(l)]]},"/":[bn,[bn,bn],(l,[i,a])=>i.evaluate(l)/a.evaluate(l)],"%":[bn,[bn,bn],(l,[i,a])=>i.evaluate(l)%a.evaluate(l)],ln2:[bn,[],()=>Math.LN2],pi:[bn,[],()=>Math.PI],e:[bn,[],()=>Math.E],"^":[bn,[bn,bn],(l,[i,a])=>Math.pow(i.evaluate(l),a.evaluate(l))],sqrt:[bn,[bn],(l,[i])=>Math.sqrt(i.evaluate(l))],log10:[bn,[bn],(l,[i])=>Math.log(i.evaluate(l))/Math.LN10],ln:[bn,[bn],(l,[i])=>Math.log(i.evaluate(l))],log2:[bn,[bn],(l,[i])=>Math.log2(i.evaluate(l))],sin:[bn,[bn],(l,[i])=>Math.sin(i.evaluate(l))],cos:[bn,[bn],(l,[i])=>Math.cos(i.evaluate(l))],tan:[bn,[bn],(l,[i])=>Math.tan(i.evaluate(l))],asin:[bn,[bn],(l,[i])=>Math.asin(i.evaluate(l))],acos:[bn,[bn],(l,[i])=>Math.acos(i.evaluate(l))],atan:[bn,[bn],(l,[i])=>Math.atan(i.evaluate(l))],min:[bn,Jn(bn),(l,i)=>Math.min(...i.map(a=>a.evaluate(l)))],max:[bn,Jn(bn),(l,i)=>Math.max(...i.map(a=>a.evaluate(l)))],abs:[bn,[bn],(l,[i])=>Math.abs(i.evaluate(l))],round:[bn,[bn],(l,[i])=>{const a=i.evaluate(l);return a<0?-Math.round(-a):Math.round(a)}],floor:[bn,[bn],(l,[i])=>Math.floor(i.evaluate(l))],ceil:[bn,[bn],(l,[i])=>Math.ceil(i.evaluate(l))],"filter-==":[Ni,[wi,M],(l,[i,a])=>l.properties()[i.value]===a.value],"filter-id-==":[Ni,[M],(l,[i])=>l.id()===i.value],"filter-type-==":[Ni,[wi],(l,[i])=>l.geometryType()===i.value],"filter-<":[Ni,[wi,M],(l,[i,a])=>{const h=l.properties()[i.value],f=a.value;return typeof h==typeof f&&h<f}],"filter-id-<":[Ni,[M],(l,[i])=>{const a=l.id(),h=i.value;return typeof a==typeof h&&a<h}],"filter->":[Ni,[wi,M],(l,[i,a])=>{const h=l.properties()[i.value],f=a.value;return typeof h==typeof f&&h>f}],"filter-id->":[Ni,[M],(l,[i])=>{const a=l.id(),h=i.value;return typeof a==typeof h&&a>h}],"filter-<=":[Ni,[wi,M],(l,[i,a])=>{const h=l.properties()[i.value],f=a.value;return typeof h==typeof f&&h<=f}],"filter-id-<=":[Ni,[M],(l,[i])=>{const a=l.id(),h=i.value;return typeof a==typeof h&&a<=h}],"filter->=":[Ni,[wi,M],(l,[i,a])=>{const h=l.properties()[i.value],f=a.value;return typeof h==typeof f&&h>=f}],"filter-id->=":[Ni,[M],(l,[i])=>{const a=l.id(),h=i.value;return typeof a==typeof h&&a>=h}],"filter-has":[Ni,[M],(l,[i])=>i.value in l.properties()],"filter-has-id":[Ni,[],l=>l.id()!==null&&l.id()!==void 0],"filter-type-in":[Ni,[Ct(wi)],(l,[i])=>i.value.indexOf(l.geometryType())>=0],"filter-id-in":[Ni,[Ct(M)],(l,[i])=>i.value.indexOf(l.id())>=0],"filter-in-small":[Ni,[wi,Ct(M)],(l,[i,a])=>a.value.indexOf(l.properties()[i.value])>=0],"filter-in-large":[Ni,[wi,Ct(M)],(l,[i,a])=>function(h,f,_,y){for(;_<=y;){const x=_+y>>1;if(f[x]===h)return!0;f[x]>h?y=x-1:_=x+1}return!1}(l.properties()[i.value],a.value,0,a.value.length-1)],all:{type:Ni,overloads:[[[Ni,Ni],(l,[i,a])=>i.evaluate(l)&&a.evaluate(l)],[Jn(Ni),(l,i)=>{for(const a of i)if(!a.evaluate(l))return!1;return!0}]]},any:{type:Ni,overloads:[[[Ni,Ni],(l,[i,a])=>i.evaluate(l)||a.evaluate(l)],[Jn(Ni),(l,i)=>{for(const a of i)if(a.evaluate(l))return!0;return!1}]]},"!":[Ni,[Ni],(l,[i])=>!i.evaluate(l)],"is-supported-script":[Ni,[wi],(l,[i])=>{const a=l.globals&&l.globals.isSupportedScript;return!a||a(i.evaluate(l))}],upcase:[wi,[wi],(l,[i])=>i.evaluate(l).toUpperCase()],downcase:[wi,[wi],(l,[i])=>i.evaluate(l).toLowerCase()],concat:[wi,Jn(M),(l,i)=>i.map(a=>ga(a.evaluate(l))).join("")],"resolved-locale":[wi,[J],(l,[i])=>i.evaluate(l).resolvedLocale()],random:[bn,[bn,bn,M],(l,i)=>{const[a,h,f]=i.map(y=>y.evaluate(l));if(a>h||a===h)return a;let _;if(typeof f=="string")_=function(y){let x=0;if(y.length===0)return x;for(let C=0;C<y.length;C++)x=(x<<5)-x+y.charCodeAt(C),x|=0;return x}(f);else{if(typeof f!="number")throw new sn(`Invalid seed input: ${f}`);_=f}return a+yt(_)()*(h-a)}]});class Qo{constructor(i,a,h,f,_){this.expression=i,this._warningHistory={},this._evaluator=new mc(h,f,_),this._defaultValue=a?function(y){return y.type==="color"&&(po(y.default)||Array.isArray(y.default))?new Bi(0,0,0,0):y.type==="color"?Bi.parse(y.default)||null:y.default===void 0?null:y.default}(a):null,this._enumValues=a&&a.type==="enum"?a.values:null,this.configDependencies=Af(i)}evaluateWithoutErrorHandling(i,a,h,f,_,y,x,C){return this._evaluator.globals=i,this._evaluator.feature=a,this._evaluator.featureState=h,this._evaluator.canonical=f||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=y,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=C||null,this.expression.evaluate(this._evaluator)}evaluate(i,a,h,f,_,y,x,C,I){this._evaluator.globals=i,this._evaluator.feature=a||null,this._evaluator.featureState=h||null,this._evaluator.canonical=f||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=y||null,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=C||null,this._evaluator.iconImageUseTheme=I||null;try{const R=this.expression.evaluate(this._evaluator);if(R==null||typeof R=="number"&&R!=R)return this._defaultValue;if(this._enumValues&&!(R in this._enumValues))throw new sn(`Expected value to be one of ${Object.keys(this._enumValues).map(P=>JSON.stringify(P)).join(", ")}, but found ${JSON.stringify(R)} instead.`);return R}catch(R){return this._warningHistory[R.message]||(this._warningHistory[R.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${R.message}`)),this._defaultValue}}}function va(l){return Array.isArray(l)&&l.length>0&&typeof l[0]=="string"&&l[0]in xt}function Ps(l,i,a,h,f){const _=new Pf(xt,[],i?function(x){const C={color:Ys,string:wi,number:bn,enum:wi,boolean:Ni,formatted:le,resolvedImage:Ne};return x.type==="array"?Ct(C[x.value]||M,x.length):C[x.type]}(i):void 0,void 0,void 0,a,h,f),y=_.parse(l,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return y?Gn(new Qo(y,i,a,h,f)):Vi(_.errors)}class js{constructor(i,a,h,f){this.kind=i,this._styleExpression=a,this.isLightConstant=h,this.isLineProgressConstant=f,this.isStateDependent=i!=="constant"&&!Id(a.expression),this.configDependencies=Af(a.expression)}evaluateWithoutErrorHandling(i,a,h,f,_,y){return this._styleExpression.evaluateWithoutErrorHandling(i,a,h,f,_,y)}evaluate(i,a,h,f,_,y,x){return this._styleExpression.evaluate(i,a,h,f,_,y,void 0,void 0,x)}}class Us{constructor(i,a,h,f,_,y){this.kind=i,this.zoomStops=h,this._styleExpression=a,this.isStateDependent=i!=="camera"&&!Id(a.expression),this.isLightConstant=_,this.isLineProgressConstant=y,this.configDependencies=Af(a.expression),this.interpolationType=f}evaluateWithoutErrorHandling(i,a,h,f,_,y){return this._styleExpression.evaluateWithoutErrorHandling(i,a,h,f,_,y)}evaluate(i,a,h,f,_,y){return this._styleExpression.evaluate(i,a,h,f,_,y)}interpolationFactor(i,a,h){return this.interpolationType?Ia.interpolationFactor(this.interpolationType,i,a,h):0}}function Aa(l,i,a,h,f){if((l=Ps(l,i,a,h,f)).result==="error")return l;const _=l.value.expression,y=_c(_);if(!y&&!Wi(i))return Vi([new ma("","data expressions not supported")]);const x=Nu(_,["zoom","pitch","distance-from-center"]);if(!x&&!Yi(i))return Vi([new ma("","zoom expressions not supported")]);const C=Nu(_,["measure-light"]);if(!C&&!$i(i))return Vi([new ma("","measure-light expression not supported")]);const I=Nu(_,["line-progress"]);if(!I&&!function(L){return Li(L.expression,"line-progress")}(i))return Vi([new ma("","line-progress expression not supported")]);const R=i.expression&&i.expression.relaxZoomRestriction,P=Ha(_);return P||x||R?P instanceof ma?Vi([P]):P instanceof Ia&&!io(i)?Vi([new ma("",'"interpolate" expressions cannot be used with this property')]):Gn(P?new Us(y&&I?"camera":"composite",l.value,P.labels,P instanceof Ia?P.interpolation:void 0,C,I):new js(y&&I?"constant":"source",l.value,C,I)):Vi([new ma("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Uo{constructor(i,a){this._parameters=i,this._specification=a,Object.assign(this,Nr(this._parameters,this._specification))}static deserialize(i){return new Uo(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function Ha(l){let i=null;if(l instanceof nc)i=Ha(l.result);else if(l instanceof _h){for(const a of l.args)if(i=Ha(a),i)break}else(l instanceof Rl||l instanceof Ia)&&l.input instanceof ia&&l.input.name==="zoom"&&(i=l);return i instanceof ma||l.eachChild(a=>{const h=Ha(a);h instanceof ma?i=h:i&&h&&i!==h&&(i=new ma("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}var ka,bc,Hs=function(){if(bc)return ka;bc=1,ka=i;var l=3;function i(a,h,f){var _=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var y=new Int32Array(this.arrayBuffer);a=y[0],this.d=(h=y[1])+2*(f=y[2]);for(var x=0;x<this.d*this.d;x++){var C=y[l+x],I=y[l+x+1];_.push(C===I?null:y.subarray(C,I))}var R=y[l+_.length+1];this.keys=y.subarray(y[l+_.length],R),this.bboxes=y.subarray(R),this.insert=this._insertReadonly}else{this.d=h+2*f;for(var P=0;P<this.d*this.d;P++)_.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=a,this.padding=f,this.scale=h/a,this.uid=0;var L=f/h*a;this.min=-L,this.max=a+L}return i.prototype.insert=function(a,h,f,_,y){this._forEachCell(h,f,_,y,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(h),this.bboxes.push(f),this.bboxes.push(_),this.bboxes.push(y)},i.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},i.prototype._insertCell=function(a,h,f,_,y,x){this.cells[y].push(x)},i.prototype.query=function(a,h,f,_,y){var x=this.min,C=this.max;if(a<=x&&h<=x&&C<=f&&C<=_&&!y)return Array.prototype.slice.call(this.keys);var I=[];return this._forEachCell(a,h,f,_,this._queryCell,I,{},y),I},i.prototype._queryCell=function(a,h,f,_,y,x,C,I){var R=this.cells[y];if(R!==null)for(var P=this.keys,L=this.bboxes,$=0;$<R.length;$++){var j=R[$];if(C[j]===void 0){var q=4*j;(I?I(L[q+0],L[q+1],L[q+2],L[q+3]):a<=L[q+2]&&h<=L[q+3]&&f>=L[q+0]&&_>=L[q+1])?(C[j]=!0,x.push(P[j])):C[j]=!1}}},i.prototype._forEachCell=function(a,h,f,_,y,x,C,I){for(var R=this._convertToCellCoord(a),P=this._convertToCellCoord(h),L=this._convertToCellCoord(f),$=this._convertToCellCoord(_),j=R;j<=L;j++)for(var q=P;q<=$;q++){var Z=this.d*q+j;if((!I||I(this._convertFromCellCoord(j),this._convertFromCellCoord(q),this._convertFromCellCoord(j+1),this._convertFromCellCoord(q+1)))&&y.call(this,a,h,f,_,Z,x,C,I))return}},i.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},i.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},i.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,h=l+this.cells.length+1+1,f=0,_=0;_<this.cells.length;_++)f+=this.cells[_].length;var y=new Int32Array(h+f+this.keys.length+this.bboxes.length);y[0]=this.extent,y[1]=this.n,y[2]=this.padding;for(var x=h,C=0;C<a.length;C++){var I=a[C];y[l+C]=x,y.set(I,x),x+=I.length}return y[l+a.length]=x,y.set(this.keys,x),y[l+a.length+1]=x+=this.keys.length,y.set(this.bboxes,x),x+=this.bboxes.length,y.buffer},ka}(),Gr=yl(Hs);const Ms={};function en(l,i,a={}){Object.defineProperty(l,"_classRegistryKey",{value:i,writable:!1}),Ms[i]={klass:l,omit:a.omit||[]}}en(Object,"Object"),Gr.serialize=function(l,i){const a=l.toArrayBuffer();return i&&i.add(a),{buffer:a}},Gr.deserialize=function(l){return new Gr(l.buffer)},Object.defineProperty(Gr,"name",{value:"Grid"}),en(Gr,"Grid"),delete Dt.prototype.constructor,typeof DOMMatrix<"u"&&en(DOMMatrix,"DOMMatrix"),en(Bi,"Color"),en(Error,"Error"),en(Co,"Formatted"),en(tl,"FormattedSection"),en(Iu,"AJAXError"),en(ks,"ResolvedImage"),en(Uo,"StylePropertyFunction"),en(Qo,"StyleExpression",{omit:["_evaluator"]}),en(sa,"ImageId"),en(As,"ImageVariant"),en(Us,"ZoomDependentExpression"),en(js,"ZoomConstantExpression"),en(ia,"CompoundExpression",{omit:["_evaluate"]});for(const l in xt)Ms[xt[l]._classRegistryKey]||en(xt[l],`Expression${l}`);function oc(l){return l&&typeof ArrayBuffer<"u"&&(l instanceof ArrayBuffer||l.constructor&&l.constructor.name==="ArrayBuffer")}function rl(l){return self.ImageBitmap&&l instanceof ImageBitmap}function xc(l,i){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp)return l;if(oc(l)||rl(l))return i&&i.add(l),l;if(ArrayBuffer.isView(l))return i&&i.add(l.buffer),l;if(l instanceof ImageData)return i&&i.add(l.data.buffer),l;if(Array.isArray(l)){const a=[];for(const h of l)a.push(xc(h,i));return a}if(l instanceof Map){const a={$name:"Map",entries:[]};for(const[h,f]of l.entries())a.entries.push(xc(h),xc(f,i));return a}if(l instanceof Set){const a={$name:"Set"};let h=0;for(const f of l.values())a[++h]=xc(f);return a}if(l instanceof DOMMatrix){const a={$name:"DOMMatrix"},h=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(const f of h)a[f]=l[f];return a}if(typeof l=="bigint")return{$name:"BigInt",value:l.toString()};if(typeof l=="object"){const a=l.constructor,h=a._classRegistryKey;if(!h)throw new Error(`Can't serialize object of unregistered class "${a.name}".`);const f=a.serialize?a.serialize(l,i):{};if(!a.serialize){for(const _ in l)l.hasOwnProperty(_)&&(Ms[h].omit.indexOf(_)>=0||(f[_]=xc(l[_],i)));l instanceof Error&&(f.message=l.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(f.$name=h),f}throw new Error("can't serialize object of type "+typeof l)}function wc(l){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||oc(l)||rl(l)||ArrayBuffer.isView(l)||l instanceof ImageData)return l;if(Array.isArray(l))return l.map(wc);if(typeof l=="object"){const i=l.$name||"Object";if(i==="Map"){const f=l.entries||[],_=new Map;for(let y=0;y<f.length;y+=2)_.set(wc(f[y]),wc(f[y+1]));return _}if(i==="Set"){const f=new Set;for(const _ of Object.keys(l))_!=="$name"&&f.add(wc(l[_]));return f}if(i==="DOMMatrix"){let f;return f=l.is2D?[l.a,l.b,l.c,l.d,l.e,l.f]:[l.m11,l.m12,l.m13,l.m14,l.m21,l.m22,l.m23,l.m24,l.m31,l.m32,l.m33,l.m34,l.m41,l.m42,l.m43,l.m44],new DOMMatrix(f)}if(i==="BigInt")return BigInt(l.value);const{klass:a}=Ms[i];if(!a)throw new Error(`Can't deserialize unregistered class "${i}".`);if(a.deserialize)return a.deserialize(l);const h=Object.create(a.prototype);for(const f of Object.keys(l))f!=="$name"&&(h[f]=wc(l[f]));return h}throw new Error("can't deserialize object of type "+typeof l)}const Rn={"Latin-1 Supplement":l=>l>=128&&l<=255,Arabic:l=>l>=1536&&l<=1791,"Arabic Supplement":l=>l>=1872&&l<=1919,"Arabic Extended-A":l=>l>=2208&&l<=2303,"Hangul Jamo":l=>l>=4352&&l<=4607,"Unified Canadian Aboriginal Syllabics":l=>l>=5120&&l<=5759,Khmer:l=>l>=6016&&l<=6143,"Unified Canadian Aboriginal Syllabics Extended":l=>l>=6320&&l<=6399,"General Punctuation":l=>l>=8192&&l<=8303,"Letterlike Symbols":l=>l>=8448&&l<=8527,"Number Forms":l=>l>=8528&&l<=8591,"Miscellaneous Technical":l=>l>=8960&&l<=9215,"Control Pictures":l=>l>=9216&&l<=9279,"Optical Character Recognition":l=>l>=9280&&l<=9311,"Enclosed Alphanumerics":l=>l>=9312&&l<=9471,"Geometric Shapes":l=>l>=9632&&l<=9727,"Miscellaneous Symbols":l=>l>=9728&&l<=9983,"Miscellaneous Symbols and Arrows":l=>l>=11008&&l<=11263,"CJK Radicals Supplement":l=>l>=11904&&l<=12031,"Kangxi Radicals":l=>l>=12032&&l<=12255,"Ideographic Description Characters":l=>l>=12272&&l<=12287,"CJK Symbols and Punctuation":l=>l>=12288&&l<=12351,Hiragana:l=>l>=12352&&l<=12447,Katakana:l=>l>=12448&&l<=12543,Bopomofo:l=>l>=12544&&l<=12591,"Hangul Compatibility Jamo":l=>l>=12592&&l<=12687,Kanbun:l=>l>=12688&&l<=12703,"Bopomofo Extended":l=>l>=12704&&l<=12735,"CJK Strokes":l=>l>=12736&&l<=12783,"Katakana Phonetic Extensions":l=>l>=12784&&l<=12799,"Enclosed CJK Letters and Months":l=>l>=12800&&l<=13055,"CJK Compatibility":l=>l>=13056&&l<=13311,"CJK Unified Ideographs Extension A":l=>l>=13312&&l<=19903,"Yijing Hexagram Symbols":l=>l>=19904&&l<=19967,"CJK Unified Ideographs":l=>l>=19968&&l<=40959,"Yi Syllables":l=>l>=40960&&l<=42127,"Yi Radicals":l=>l>=42128&&l<=42191,"Hangul Jamo Extended-A":l=>l>=43360&&l<=43391,"Hangul Syllables":l=>l>=44032&&l<=55215,"Hangul Jamo Extended-B":l=>l>=55216&&l<=55295,"Private Use Area":l=>l>=57344&&l<=63743,"CJK Compatibility Ideographs":l=>l>=63744&&l<=64255,"Arabic Presentation Forms-A":l=>l>=64336&&l<=65023,"Vertical Forms":l=>l>=65040&&l<=65055,"CJK Compatibility Forms":l=>l>=65072&&l<=65103,"Small Form Variants":l=>l>=65104&&l<=65135,"Arabic Presentation Forms-B":l=>l>=65136&&l<=65279,"Halfwidth and Fullwidth Forms":l=>l>=65280&&l<=65519,Osage:l=>l>=66736&&l<=66815,"CJK Unified Ideographs Extension B":l=>l>=131072&&l<=173791};function um(l){for(const i of l)if(Nf(i.charCodeAt(0)))return!0;return!1}function jg(l){for(const i of l)if(!Rd(i.charCodeAt(0)))return!1;return!0}function Rd(l){return!(Rn.Arabic(l)||Rn["Arabic Supplement"](l)||Rn["Arabic Extended-A"](l)||Rn["Arabic Presentation Forms-A"](l)||Rn["Arabic Presentation Forms-B"](l))}function Nf(l){return!(l!==746&&l!==747&&(l<4352||!(Rn["Bopomofo Extended"](l)||Rn.Bopomofo(l)||Rn["CJK Compatibility Forms"](l)&&!(l>=65097&&l<=65103)||Rn["CJK Compatibility Ideographs"](l)||Rn["CJK Compatibility"](l)||Rn["CJK Radicals Supplement"](l)||Rn["CJK Strokes"](l)||!(!Rn["CJK Symbols and Punctuation"](l)||l>=12296&&l<=12305||l>=12308&&l<=12319||l===12336)||Rn["CJK Unified Ideographs Extension A"](l)||Rn["CJK Unified Ideographs"](l)||Rn["Enclosed CJK Letters and Months"](l)||Rn["Hangul Compatibility Jamo"](l)||Rn["Hangul Jamo Extended-A"](l)||Rn["Hangul Jamo Extended-B"](l)||Rn["Hangul Jamo"](l)||Rn["Hangul Syllables"](l)||Rn.Hiragana(l)||Rn["Ideographic Description Characters"](l)||Rn.Kanbun(l)||Rn["Kangxi Radicals"](l)||Rn["Katakana Phonetic Extensions"](l)||Rn.Katakana(l)&&l!==12540||!(!Rn["Halfwidth and Fullwidth Forms"](l)||l===65288||l===65289||l===65293||l>=65306&&l<=65310||l===65339||l===65341||l===65343||l>=65371&&l<=65503||l===65507||l>=65512&&l<=65519)||!(!Rn["Small Form Variants"](l)||l>=65112&&l<=65118||l>=65123&&l<=65126)||Rn["Unified Canadian Aboriginal Syllabics"](l)||Rn["Unified Canadian Aboriginal Syllabics Extended"](l)||Rn["Vertical Forms"](l)||Rn["Yijing Hexagram Symbols"](l)||Rn["Yi Syllables"](l)||Rn["Yi Radicals"](l))))}function bh(l){return!(Nf(l)||function(i){return!!(Rn["Latin-1 Supplement"](i)&&(i===167||i===169||i===174||i===177||i===188||i===189||i===190||i===215||i===247)||Rn["General Punctuation"](i)&&(i===8214||i===8224||i===8225||i===8240||i===8241||i===8251||i===8252||i===8258||i===8263||i===8264||i===8265||i===8273)||Rn["Letterlike Symbols"](i)||Rn["Number Forms"](i)||Rn["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||i===9003||i>=9085&&i<=9114||i>=9150&&i<=9165||i===9167||i>=9169&&i<=9179||i>=9186&&i<=9215)||Rn["Control Pictures"](i)&&i!==9251||Rn["Optical Character Recognition"](i)||Rn["Enclosed Alphanumerics"](i)||Rn["Geometric Shapes"](i)||Rn["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||Rn["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||Rn["CJK Symbols and Punctuation"](i)||Rn.Katakana(i)||Rn["Private Use Area"](i)||Rn["CJK Compatibility Forms"](i)||Rn["Small Form Variants"](i)||Rn["Halfwidth and Fullwidth Forms"](i)||i===8734||i===8756||i===8757||i>=9984&&i<=10087||i>=10102&&i<=10131||i===65532||i===65533)}(l))}function Py(l){return Rn.Arabic(l)||Rn["Arabic Supplement"](l)||Rn["Arabic Extended-A"](l)||Rn["Arabic Presentation Forms-A"](l)||Rn["Arabic Presentation Forms-B"](l)}function dm(l){return l>=1424&&l<=2303||Rn["Arabic Presentation Forms-A"](l)||Rn["Arabic Presentation Forms-B"](l)}function Ug(l,i){return!(!i&&dm(l)||l>=2304&&l<=3583||l>=3840&&l<=4255||Rn.Khmer(l))}function My(l){for(const i of l)if(dm(i.charCodeAt(0)))return!0;return!1}const Ra={unavailable:"unavailable",deferred:"deferred",loading:"loading",parsing:"parsing",parsed:"parsed",loaded:"loaded",error:"error"};let Sc=null,Gs=Ra.unavailable,Cc=null;const hm=function(l){l&&typeof l=="string"&&l.indexOf("NetworkError")>-1&&(Gs=Ra.error),Sc&&Sc(l)};function xh(){Vf.fire(new Vs("pluginStateChange",{pluginStatus:Gs,pluginURL:Cc}))}const Vf=new Ta,wh=function(){return Gs},ou=function(){if(Gs!==Ra.deferred||!Cc)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Gs=Ra.loading,xh(),Cc&&Sa({url:Cc},l=>{l?hm(l):(Gs=Ra.loaded,xh())})},Pl={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Gs===Ra.loaded||Pl.applyArabicShaping!=null,isLoading:()=>Gs===Ra.loading,setState(l){Gs=l.pluginStatus,Cc=l.pluginURL},isParsing:()=>Gs===Ra.parsing,isParsed:()=>Gs===Ra.parsed,getPluginURL:()=>Cc};class Tr{constructor(i,a){this.zoom=i,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.transition=a.transition,this.pitch=a.pitch,this.brightness=a.brightness,this.worldview=a.worldview):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(i){return function(a,h){for(const f of a)if(!Ug(f.charCodeAt(0),h))return!1;return!0}(i,Pl.isLoaded())}}class $u{constructor(i,a,h,f,_){this.property=i,this.value=a,this.expression=function(y,x,C,I,R){if(po(y))return new Uo(y,x);if(va(y)||Array.isArray(y)&&y.length>0){const P=Aa(y,x,C,I,R);if(P.result==="error")throw new Error(P.value.map(L=>`${L.key}: ${L.message}`).join(", "));return P.value}{let P=y;return typeof y=="string"&&x.type==="color"&&(P=Bi.parse(y)),{kind:"constant",configDependencies:new Set,evaluate:()=>P}}}(a===void 0?i.specification.default:a,i.specification,h,f,_)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(i,a,h,f){return this.property.possiblyEvaluate(this,i,a,h,f)}}class Sh{constructor(i,a,h,f){this.property=i,this.value=new $u(i,void 0,a,h,f)}transitioned(i,a){return new ju(this.property,this.value,a,Object.assign({},i.transition,this.transition),i.now)}untransitioned(){return new ju(this.property,this.value,null,{},0)}}class fm{constructor(i,a,h,f){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues),this._scope=a,this._options=h,this._iconImageUseTheme=f,this.configDependencies=new Set}getValue(i){return Un(this._values[i].value.value)}setValue(i,a){this._values.hasOwnProperty(i)||(this._values[i]=new Sh(this._values[i].property,this._scope,this._options,this._iconImageUseTheme)),this._values[i].value=new $u(this._values[i].property,a===null?void 0:Un(a),this._scope,this._options,this._iconImageUseTheme),this._values[i].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[i].value.expression.configDependencies]))}setTransitionOrValue(i,a){a&&(this._options=a);const h=this._properties.properties;if(i)for(const f in i){const _=i[f];if(f.endsWith("-transition")){const y=f.slice(0,-11);h[y]&&this.setTransition(y,_)}else h.hasOwnProperty(f)&&this.setValue(f,_)}}getTransition(i){return Un(this._values[i].transition)}setTransition(i,a){this._values.hasOwnProperty(i)||(this._values[i]=new Sh(this._values[i].property)),this._values[i].transition=Un(a)||void 0}serialize(){const i={};for(const a of Object.keys(this._values)){const h=this.getValue(a);h!==void 0&&(i[a]=h);const f=this.getTransition(a);f!==void 0&&(i[`${a}-transition`]=f)}return i}transitioned(i,a){const h=new Dy(this._properties);for(const f of Object.keys(this._values))h._values[f]=this._values[f].transitioned(i,a._values[f]);return h}untransitioned(){const i=new Dy(this._properties);for(const a of Object.keys(this._values))i._values[a]=this._values[a].untransitioned();return i}}class ju{constructor(i,a,h,f,_){const y=f.delay||0,x=f.duration||0;_=_||0,this.property=i,this.value=a,this.begin=_+y,this.end=this.begin+x,i.specification.transition&&(f.delay||f.duration)&&(this.prior=h)}possiblyEvaluate(i,a,h){const f=i.now||0,_=this.value.possiblyEvaluate(i,a,h),y=this.prior;if(y){if(f>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(f<this.begin)return y.possiblyEvaluate(i,a,h);{const x=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(i,a,h),_,ve(x))}}return _}}class Dy{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,a,h){const f=new Eh(this._properties);for(const _ of Object.keys(this._values))f._values[_]=this._values[_].possiblyEvaluate(i,a,h);return f}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class Ch{constructor(i,a,h,f){this._properties=i,this._values=Object.create(i.defaultPropertyValues),this._scope=a,this._options=h,this._iconImageUseTheme=f,this.configDependencies=new Set}getValue(i){return Un(this._values[i].value)}setValue(i,a){this._values[i]=new $u(this._values[i].property,a===null?void 0:Un(a),this._scope,this._options,this._iconImageUseTheme),this._values[i].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[i].expression.configDependencies]))}serialize(){const i={};for(const a of Object.keys(this._values)){const h=this.getValue(a);h!==void 0&&(i[a]=h)}return i}possiblyEvaluate(i,a,h,f){const _=new Eh(this._properties);for(const y of Object.keys(this._values))_._values[y]=this._values[y].possiblyEvaluate(i,a,h,f);return _}}class Th{constructor(i,a,h,f){this.property=i,this.value=a,this.parameters=h,this.iconImageUseTheme=f}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,a,h,f){return this.property.evaluate(this.value,this.parameters,i,a,h,f,this.iconImageUseTheme)}}class Eh{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class Vt{constructor(i){this.specification=i}possiblyEvaluate(i,a){return i.expression.evaluate(a)}interpolate(i,a,h){const f=us[this.specification.type];return f?f(i,a,h):i}}class nn{constructor(i,a){this.specification=i,this.overrides=a}possiblyEvaluate(i,a,h,f,_){return i.expression.kind==="constant"||i.expression.kind==="camera"?new Th(this,{kind:"constant",value:i.expression.evaluate(a,null,{},h,f,void 0,_)},a):new Th(this,i.expression,a,_)}interpolate(i,a,h){if(i.value.kind!=="constant"||a.value.kind!=="constant")return i;if(i.value.value===void 0||a.value.value===void 0)return new Th(this,{kind:"constant",value:void 0},i.parameters);const f=us[this.specification.type];return f?new Th(this,{kind:"constant",value:f(i.value.value,a.value.value,h)},i.parameters):i}evaluate(i,a,h,f,_,y,x){return i.kind==="constant"?i.value:i.evaluate(a,h,f,_,y,void 0,x)}}class $f{constructor(i){this.specification=i}possiblyEvaluate(i,a,h,f){return!!i.expression.evaluate(a,null,{},h,f)}interpolate(){return!1}}class _o{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const a=new Tr(0,{});for(const h in i){const f=i[h];f.specification.overridable&&this.overridableProperties.push(h);const _=this.defaultPropertyValues[h]=new $u(f,void 0),y=this.defaultTransitionablePropertyValues[h]=new Sh(f);this.defaultTransitioningPropertyValues[h]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=_.possiblyEvaluate(a)}}}en(nn,"DataDrivenProperty"),en(Vt,"DataConstantProperty"),en($f,"ColorRampProperty");var Ye=JSON.parse('{"$version":8,"$root":{"version":{"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow"},"rain":{"type":"rain"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor"},"imports":{"type":"array","value":"import"},"iconsets":{"type":"iconsets"},"schema":{"type":"schema"},"sources":{"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"type":"featuresets"}},"featuresets":{"*":{"type":"featureset"}},"featureset":{"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"layer":{"type":"string"},"properties":{"type":"selectorProperty"},"featureNamespace":{"type":"string"},"_uniqueFeatureID":{"type":"boolean"}},"selectorProperty":{"*":{"type":"*"}},"model":{"type":"string"},"import":{"id":{"type":"string"},"url":{"type":"string"},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","expression":{}},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string"},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false},"shadow-quality":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]}},"shadow-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"type":"enum","values":{"sprite":1}},"url":{"type":"string"}},"iconset_source":{"type":{"type":"enum","values":{"source":1}},"source":{"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"type":"enum","values":{"video":1}},"urls":{"type":"array","value":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"type":"enum","values":{"image":1}},"url":{"type":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"modelNodeOverride":{"orientation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360}},"modelNodeOverrides":{"*":{"type":"modelNodeOverride"}},"modelMaterialOverride":{"model-color":{"type":"color"},"model-color-mix-intensity":{"type":"number"},"model-opacity":{"type":"number"},"model-emissive-strength":{"type":"number"}},"modelMaterialOverrides":{"*":{"type":"modelMaterialOverride"}},"modelSourceModel":{"uri":{"type":"string"},"position":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[-180,-90],"maximum":[180,90]},"orientation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360},"nodeOverrides":{"type":"modelNodeOverrides"},"materialOverrides":{"type":"modelMaterialOverrides"},"nodeOverrideNames":{"type":"array","value":"string"},"materialOverrideNames":{"type":"array","value":"string"},"featureProperties":{"type":"*"}},"modelSourceModels":{"*":{"type":"modelSourceModel"}},"source_model":{"type":{"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"},"models":{"type":"modelSourceModels"}},"layer":{"id":{"type":"string"},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"building":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{},"clip":{}}},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"},"appearances":{"type":"array","value":"appearance","supported-layer-types":["symbol"]}},"appearance":{"condition":{"type":"boolean","expression":{"parameters":["zoom","pitch","feature","feature-state","measure-light","distance-from-center"]},"property-type":"data-driven"},"name":{"type":"string"},"properties":{"type":"*"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_building","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{}},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","expression":{}},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-extrusion-edge-radius":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}}},"layout_building":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"building-facade":{"type":"boolean","default":false,"expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-facade-floors":{"type":"number","minimum":1,"maximum":200,"default":3,"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-facade-unit-width":{"type":"number","minimum":1,"maximum":20,"default":3.1,"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-facade-window":{"type":"array","length":2,"value":"number","minimum":0.1,"maximum":1,"default":[0.9,0.9],"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-roof-shape":{"type":"enum","values":{"flat":1,"hipped":1,"gabled":1,"parapet":1,"mansard":1,"skillion":1,"pyramidal":1},"default":"flat","expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"building-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"building-flip-roof-orientation":{"property-type":"data-driven","type":"boolean","default":false,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","expression":{}},"line-cross-slope":{"type":"number","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","expression":{"parameters":["zoom"]}}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]}},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]}},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]}},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{"parameters":["zoom"]}},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"icon-size":{"type":"number","default":1,"minimum":0,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"appearance":true,"use-theme":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]}},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]}},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_building":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*"}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"high-color":{"type":"color","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"space-color":{"type":"color","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"horizon-blend":{"type":"number","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.4,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","default":0.71,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.57,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","default":0.7,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective"}},"colorTheme":{"data":{"type":"string","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","expression":{}},"buildingFeaturesetId":{"type":"string","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator"},"center":{"type":"array","length":2,"value":"number","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string"},"exaggeration":{"type":"number","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_building","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"flat"},"fill-extrusion-base-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"terrain"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true}},"paint_building":{"building-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"parameters":[]},"transition":true},"building-ambient-occlusion-ground-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-cast-shadows":{"type":"boolean","default":true},"building-color":{"type":"color","default":"rgba(193, 154, 127, 1)","use-theme":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"},"building-emissive-strength":{"type":"number","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"},"building-facade-emissive-chance":{"type":"number","default":0.35,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["measure-light","zoom"]}},"building-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"building-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"building-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"building-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-gradient":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["line-progress"]}},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1]},"line-trim-fade-range":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-trim-color":{"type":"color","default":"transparent","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-border-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"use-theme":true,"expression":{"interpolated":true,"parameters":["heatmap-density"]}},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-image-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{}},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-value"]}},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]}},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"raster-array-band":{"type":"string"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string"},"raster-particle-count":{"type":"number","default":512,"minimum":1},"raster-particle-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-particle-speed"]}},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-shadow-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-accent-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]}},"background-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]}},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]}},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]}},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"use-theme":true,"expression":{"interpolated":true,"parameters":["sky-radial-progress"]}},"sky-atmosphere-halo-color":{"type":"color","default":"white","use-theme":true},"sky-atmosphere-color":{"type":"color","default":"white","use-theme":true},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"use-theme":true,"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d"},"model-cast-shadows":{"type":"boolean","default":true},"model-receive-shadows":{"type":"boolean","default":true},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"model-front-cutoff":{"type":"array","value":"number","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]},"model-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{}}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"promoteId":{"*":{"type":"*"}}}');function Hg(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function Ih(l){if(Array.isArray(l))return l.map(Ih);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){const i={};for(const a in l)i[a]=Ih(l[a]);return i}return Hg(l)}function Gg(l){if(l===!0||l===!1)return!0;if(!Array.isArray(l)||l.length===0)return!1;switch(l[0]){case"has":return l.length>=2&&l[1]!=="$id"&&l[1]!=="$type";case"in":return l.length>=3&&(typeof l[1]!="string"||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return l.length!==3||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(const i of l.slice(1))if(!Gg(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}function pm(l,i="",a=null,h="fill"){if(l==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Gg(l)||(l=Wg(l));const f=l;let _=!0;try{_=function(R){if(!jf(R))return R;let P=Ih(R);return Tc(P),P=j0(P),P}(f)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(f,null,2)}
        `)}let y=null,x=null;if(h!=="background"&&h!=="sky"&&h!=="slot"){x=Ye[`filter_${h}`];const R=Ps(_,x,i,a);if(R.result==="error")throw new Error(R.value.map(P=>`${P.key}: ${P.message}`).join(", "));y=(P,L,$)=>R.value.evaluate(P,L,{},$)}let C=null,I=null;if(_!==f){const R=Ps(f,x,i,a);if(R.result==="error")throw new Error(R.value.map(P=>`${P.key}: ${P.message}`).join(", "));C=(P,L,$,j,q)=>R.value.evaluate(P,L,{},$,void 0,void 0,j,q),I=!_c(R.value.expression)}return{filter:y,dynamicFilter:C||void 0,needGeometry:H0(_),needFeature:!!I}}function j0(l){if(!Array.isArray(l))return l;const i=function(a){if(U0.has(a[0])){for(let h=1;h<a.length;h++)if(jf(a[h]))return!0}return a}(l);return i===!0?i:i.map(a=>j0(a))}function Tc(l){let i=!1;const a=[];if(l[0]==="case"){for(let h=1;h<l.length-1;h+=2)i=i||jf(l[h]),a.push(l[h+1]);a.push(l[l.length-1])}else if(l[0]==="match"){i=i||jf(l[1]);for(let h=2;h<l.length-1;h+=2)a.push(l[h+1]);a.push(l[l.length-1])}else if(l[0]==="step"){i=i||jf(l[1]);for(let h=1;h<l.length-1;h+=2)a.push(l[h+1])}i&&(l.length=0,l.push("any",...a));for(let h=1;h<l.length;h++)Tc(l[h])}function jf(l){if(!Array.isArray(l))return!1;if((i=l[0])==="pitch"||i==="distance-from-center")return!0;var i;for(let a=1;a<l.length;a++)if(jf(l[a]))return!0;return!1}const U0=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function YS(l,i){return l<i?-1:l>i?1:0}function H0(l){if(!Array.isArray(l))return!1;if(l[0]==="within"||l[0]==="distance")return!0;for(let i=1;i<l.length;i++)if(H0(l[i]))return!0;return!1}function Wg(l){if(!l)return!0;const i=l[0];return l.length<=1?i!=="any":i==="=="?Oy(l[1],l[2],"=="):i==="!="?qg(Oy(l[1],l[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Oy(l[1],l[2],i):i==="any"?(a=l.slice(1),["any"].concat(a.map(Wg))):i==="all"?["all"].concat(l.slice(1).map(Wg)):i==="none"?["all"].concat(l.slice(1).map(Wg).map(qg)):i==="in"?G0(l[1],l.slice(2)):i==="!in"?qg(G0(l[1],l.slice(2))):i==="has"?W0(l[1]):i!=="!has"||qg(W0(l[1]));var a}function Oy(l,i,a){switch(l){case"$type":return[`filter-type-${a}`,i];case"$id":return[`filter-id-${a}`,i];default:return[`filter-${a}`,l,i]}}function G0(l,i){if(i.length===0)return!1;switch(l){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(a=>typeof a!=typeof i[0])?["filter-in-large",l,["literal",i.sort(YS)]]:["filter-in-small",l,["literal",i]]}}function W0(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function qg(l){return["!",l]}const mm="";function Uf(l,i){return i?`${l}${mm}${i}`:l}let Ly;const q0=()=>Ly||(Ly=new _o({"icon-size":new nn(Ye.layout_symbol["icon-size"]),"icon-image":new nn(Ye.layout_symbol["icon-image"]),"icon-rotate":new nn(Ye.layout_symbol["icon-rotate"]),"icon-offset":new nn(Ye.layout_symbol["icon-offset"])}));class JS{constructor(i,a,h,f,_,y){const x=Ps(i,Ye.appearance.condition);if(x.result==="success"&&(this.condition=x.value),this.name=a,h){this.properties=new Eh(q0()),this.unevaluatedLayout=new Ch(q0(),f,_,y);for(const C in h)this.unevaluatedLayout.setValue(C,h[C])}}isActive(i){return!(this.condition||!i.isHidden||this.name!=="hidden")||this.condition.evaluate(i.globals,i.feature,i.featureState,i.canonical)}getCondition(){return this.condition}getName(){return this.name}getProperty(i){return this.properties.get(i)}getUnevaluatedProperties(){return this.unevaluatedLayout}serialize(){const i={};return i.condition=this.condition.expression.serialize(),this.name&&(i.name=this.name),this.properties&&(i.properties=this.properties),i}}const Z0="-transition",K0=new Set(["fill","line","background","hillshade","raster"]);class ba extends Ta{constructor(i,a,h,f,_,y){if(super(),this.id=i.id,this.fqid=Uf(this.id,h),this.type=i.type,this.scope=h,this.lut=f,this.options=_,this.iconImageUseTheme=y,this.appearances=new Array,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,i.type!=="custom"){if(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type&&i.type!=="background"&&i.type!=="sky"&&i.type!=="slot"){this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter;const x=Ps(this.filter,Ye[`filter_${i.type}`]);x.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...x.value.configDependencies]))}if(i.slot&&(this.slot=i.slot),i.appearances&&i.appearances.forEach(x=>{this.appearances.push(new JS(x.condition,x.name,x.properties,this.scope,_,this.iconImageUseTheme))}),a.layout&&(this._unevaluatedLayout=new Ch(a.layout,this.scope,_,this.iconImageUseTheme),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),a.paint){this._transitionablePaint=new fm(a.paint,this.scope,_);for(const x in i.paint)this.setPaintProperty(x,i.paint[x]);for(const x in i.layout)this.setLayoutProperty(x,i.layout[x]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Eh(a.paint)}}}onAdd(i){}onRemove(i){}isDraped(i){return!this.is3D(!0)&&K0.has(this.type)}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,a){if(this.type==="custom"&&i==="visibility")return void(this.visibility=a);const h=this._unevaluatedLayout;h._properties.properties[i]&&(h.setValue(i,a),this.configDependencies=new Set([...this.configDependencies,...h.configDependencies]),i==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(i){return i.endsWith(Z0)?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)}setPaintProperty(i,a){const h=this._transitionablePaint,f=h._properties.properties;if(i.endsWith(Z0)){const P=i.slice(0,-11);return f[P]&&h.setTransition(P,a||void 0),!1}if(!f[i])return!1;const _=h._values[i],y=_.value.isDataDriven(),x=_.value;h.setValue(i,a),this.configDependencies=new Set([...this.configDependencies,...h.configDependencies]),this._handleSpecialPaintPropertyUpdate(i);const C=h._values[i].value,I=C.isDataDriven(),R=i.endsWith("pattern")||i==="line-dasharray";return I||y||R||this._handleOverridablePaintPropertyUpdate(i,x,C)}_handleSpecialPaintPropertyUpdate(i){}getProgramIds(){return null}getDefaultProgramParams(i,a,h){return null}_handleOverridablePaintPropertyUpdate(i,a,h){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,a){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,a,this.iconImageUseTheme)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,a)}serialize(){const i={id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.appearances.length!==0&&(i.appearances=this.appearances.map(a=>a.serialize())),Kn(i,(a,h)=>!(a===void 0||h==="layout"&&!Object.keys(a).length||h==="paint"&&!Object.keys(a).length))}is3D(i){return!1}hasElevation(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}_clear(){}isStateDependent(){for(const i in this.paint._values){const a=this.paint.get(i);if(a instanceof Th&&Wi(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}compileFilter(i){this._filterCompiled||(this._featureFilter=pm(this.filter,this.scope,i),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(i){this._stats&&(i.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}getAppearances(){return this.appearances}queryRadius(i){}queryIntersectsFeature(i,a,h,f,_,y,x,C,I){}}const Pd={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Hf{constructor(i,a){this._structArray=i,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Vr{constructor(){this.capacity=-1,this.resize(0)}static serialize(i,a){return i._trim(),a&&a.add(i.arrayBuffer),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const a=Object.create(this.prototype);return a.arrayBuffer=i.arrayBuffer,a.length=i.length,a.capacity=i.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...i){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...i){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function ki(l,i=1){let a=0,h=0;return{members:l.map(f=>{const _=Pd[f.type].BYTES_PER_ELEMENT,y=a=X0(a,Math.max(i,_)),x=f.components||1;return h=Math.max(h,_),a+=_*x,{name:f.name,type:f.type,components:x,offset:y}}),size:X0(a,Math.max(h,i)),alignment:i}}function X0(l,i){return Math.ceil(l/i)*i}class Md extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a){const h=this.length;return this.resize(h+1),this.emplace(h,i,a)}emplace(i,a,h){const f=2*i;return this.int16[f+0]=a,this.int16[f+1]=h,i}}Md.prototype.bytesPerElement=4,en(Md,"StructArrayLayout2i4");class Ah extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,h){const f=this.length;return this.resize(f+1),this.emplace(f,i,a,h)}emplace(i,a,h,f){const _=3*i;return this.int16[_+0]=a,this.int16[_+1]=h,this.int16[_+2]=f,i}}Ah.prototype.bytesPerElement=6,en(Ah,"StructArrayLayout3i6");class kh extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,h,f){const _=this.length;return this.resize(_+1),this.emplace(_,i,a,h,f)}emplace(i,a,h,f,_){const y=4*i;return this.int16[y+0]=a,this.int16[y+1]=h,this.int16[y+2]=f,this.int16[y+3]=_,i}}kh.prototype.bytesPerElement=8,en(kh,"StructArrayLayout4i8");class Dd extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const a=this.length;return this.resize(a+1),this.emplace(a,i)}emplace(i,a){return this.float32[1*i+0]=a,i}}Dd.prototype.bytesPerElement=4,en(Dd,"StructArrayLayout1f4");class zy extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h){const f=this.length;return this.resize(f+1),this.emplace(f,i,a,h)}emplace(i,a,h,f){const _=4*i,y=2*i;return this.int16[_+0]=a,this.int16[_+1]=h,this.float32[y+1]=f,i}}zy.prototype.bytesPerElement=8,en(zy,"StructArrayLayout2i1f8");class Zg extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,h){const f=this.length;return this.resize(f+1),this.emplace(f,i,a,h)}emplace(i,a,h,f){const _=4*i;return this.int16[_+0]=a,this.int16[_+1]=h,this.int16[_+2]=f,i}}Zg.prototype.bytesPerElement=8,en(Zg,"StructArrayLayout3i8");class By extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,h,f,_){const y=this.length;return this.resize(y+1),this.emplace(y,i,a,h,f,_)}emplace(i,a,h,f,_,y){const x=5*i;return this.int16[x+0]=a,this.int16[x+1]=h,this.int16[x+2]=f,this.int16[x+3]=_,this.int16[x+4]=y,i}}By.prototype.bytesPerElement=10,en(By,"StructArrayLayout5i10");class Kg extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h,f,_,y,x){const C=this.length;return this.resize(C+1),this.emplace(C,i,a,h,f,_,y,x)}emplace(i,a,h,f,_,y,x,C){const I=6*i,R=12*i,P=3*i;return this.int16[I+0]=a,this.int16[I+1]=h,this.uint8[R+4]=f,this.uint8[R+5]=_,this.uint8[R+6]=y,this.uint8[R+7]=x,this.float32[P+2]=C,i}}Kg.prototype.bytesPerElement=12,en(Kg,"StructArrayLayout2i4ub1f12");class Ga extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h){const f=this.length;return this.resize(f+1),this.emplace(f,i,a,h)}emplace(i,a,h,f){const _=3*i;return this.float32[_+0]=a,this.float32[_+1]=h,this.float32[_+2]=f,i}}Ga.prototype.bytesPerElement=12,en(Ga,"StructArrayLayout3f12");class Od extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h,f,_){const y=this.length;return this.resize(y+1),this.emplace(y,i,a,h,f,_)}emplace(i,a,h,f,_,y){const x=6*i,C=3*i;return this.uint16[x+0]=a,this.uint16[x+1]=h,this.uint16[x+2]=f,this.uint16[x+3]=_,this.float32[C+2]=y,i}}Od.prototype.bytesPerElement=12,en(Od,"StructArrayLayout4ui1f12");class Gf extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a,h,f){const _=this.length;return this.resize(_+1),this.emplace(_,i,a,h,f)}emplace(i,a,h,f,_){const y=4*i;return this.uint16[y+0]=a,this.uint16[y+1]=h,this.uint16[y+2]=f,this.uint16[y+3]=_,i}}Gf.prototype.bytesPerElement=8,en(Gf,"StructArrayLayout4ui8");class Xg extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,h,f,_,y){const x=this.length;return this.resize(x+1),this.emplace(x,i,a,h,f,_,y)}emplace(i,a,h,f,_,y,x){const C=6*i;return this.int16[C+0]=a,this.int16[C+1]=h,this.int16[C+2]=f,this.int16[C+3]=_,this.int16[C+4]=y,this.int16[C+5]=x,i}}Xg.prototype.bytesPerElement=12,en(Xg,"StructArrayLayout6i12");class Fy extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a,h,f,_,y,x,C,I,R,P,L){const $=this.length;return this.resize($+1),this.emplace($,i,a,h,f,_,y,x,C,I,R,P,L)}emplace(i,a,h,f,_,y,x,C,I,R,P,L,$){const j=12*i;return this.int16[j+0]=a,this.int16[j+1]=h,this.int16[j+2]=f,this.int16[j+3]=_,this.uint16[j+4]=y,this.uint16[j+5]=x,this.uint16[j+6]=C,this.uint16[j+7]=I,this.int16[j+8]=R,this.int16[j+9]=P,this.int16[j+10]=L,this.int16[j+11]=$,i}}Fy.prototype.bytesPerElement=24,en(Fy,"StructArrayLayout4i4ui4i24");class Ny extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h,f,_,y){const x=this.length;return this.resize(x+1),this.emplace(x,i,a,h,f,_,y)}emplace(i,a,h,f,_,y,x){const C=10*i,I=5*i;return this.int16[C+0]=a,this.int16[C+1]=h,this.int16[C+2]=f,this.float32[I+2]=_,this.float32[I+3]=y,this.float32[I+4]=x,i}}Ny.prototype.bytesPerElement=20,en(Ny,"StructArrayLayout3i3f20");class Ec extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h,f){const _=this.length;return this.resize(_+1),this.emplace(_,i,a,h,f)}emplace(i,a,h,f,_){const y=4*i;return this.float32[y+0]=a,this.float32[y+1]=h,this.float32[y+2]=f,this.float32[y+3]=_,i}}Ec.prototype.bytesPerElement=16,en(Ec,"StructArrayLayout4f16");class Wf extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const a=this.length;return this.resize(a+1),this.emplace(a,i)}emplace(i,a){return this.uint32[1*i+0]=a,i}}Wf.prototype.bytesPerElement=4,en(Wf,"StructArrayLayout1ul4");class hs extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a){const h=this.length;return this.resize(h+1),this.emplace(h,i,a)}emplace(i,a,h){const f=2*i;return this.uint16[f+0]=a,this.uint16[f+1]=h,i}}hs.prototype.bytesPerElement=4,en(hs,"StructArrayLayout2ui4");class qf extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a,h,f,_,y,x,C,I,R,P,L,$){const j=this.length;return this.resize(j+1),this.emplace(j,i,a,h,f,_,y,x,C,I,R,P,L,$)}emplace(i,a,h,f,_,y,x,C,I,R,P,L,$,j){const q=20*i,Z=10*i;return this.int16[q+0]=a,this.int16[q+1]=h,this.int16[q+2]=f,this.int16[q+3]=_,this.int16[q+4]=y,this.float32[Z+3]=x,this.float32[Z+4]=C,this.float32[Z+5]=I,this.float32[Z+6]=R,this.int16[q+14]=P,this.uint32[Z+8]=L,this.uint16[q+18]=$,this.uint16[q+19]=j,i}}qf.prototype.bytesPerElement=40,en(qf,"StructArrayLayout5i4f1i1ul2ui40");class Yg extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,h,f,_,y,x){const C=this.length;return this.resize(C+1),this.emplace(C,i,a,h,f,_,y,x)}emplace(i,a,h,f,_,y,x,C){const I=8*i;return this.int16[I+0]=a,this.int16[I+1]=h,this.int16[I+2]=f,this.int16[I+4]=_,this.int16[I+5]=y,this.int16[I+6]=x,this.int16[I+7]=C,i}}Yg.prototype.bytesPerElement=16,en(Yg,"StructArrayLayout3i2i2i16");class Vy extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,h,f,_){const y=this.length;return this.resize(y+1),this.emplace(y,i,a,h,f,_)}emplace(i,a,h,f,_,y){const x=4*i,C=8*i;return this.float32[x+0]=a,this.float32[x+1]=h,this.float32[x+2]=f,this.int16[C+6]=_,this.int16[C+7]=y,i}}Vy.prototype.bytesPerElement=16,en(Vy,"StructArrayLayout2f1f2i16");class $y extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h,f,_,y){const x=this.length;return this.resize(x+1),this.emplace(x,i,a,h,f,_,y)}emplace(i,a,h,f,_,y,x){const C=20*i,I=5*i;return this.uint8[C+0]=a,this.uint8[C+1]=h,this.float32[I+1]=f,this.float32[I+2]=_,this.float32[I+3]=y,this.float32[I+4]=x,i}}$y.prototype.bytesPerElement=20,en($y,"StructArrayLayout2ub4f20");class bs extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a,h){const f=this.length;return this.resize(f+1),this.emplace(f,i,a,h)}emplace(i,a,h,f){const _=3*i;return this.uint16[_+0]=a,this.uint16[_+1]=h,this.uint16[_+2]=f,i}}bs.prototype.bytesPerElement=6,en(bs,"StructArrayLayout3ui6");class gm extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,a,h,f,_,y,x,C,I,R,P,L,$,j,q,Z,K,ae,ue,fe,Me){const De=this.length;return this.resize(De+1),this.emplace(De,i,a,h,f,_,y,x,C,I,R,P,L,$,j,q,Z,K,ae,ue,fe,Me)}emplace(i,a,h,f,_,y,x,C,I,R,P,L,$,j,q,Z,K,ae,ue,fe,Me,De){const Ve=30*i,He=15*i,Ze=60*i;return this.int16[Ve+0]=a,this.int16[Ve+1]=h,this.int16[Ve+2]=f,this.float32[He+2]=_,this.float32[He+3]=y,this.uint16[Ve+8]=x,this.uint16[Ve+9]=C,this.uint32[He+5]=I,this.uint32[He+6]=R,this.uint32[He+7]=P,this.uint16[Ve+16]=L,this.uint16[Ve+17]=$,this.uint16[Ve+18]=j,this.float32[He+10]=q,this.float32[He+11]=Z,this.uint8[Ze+48]=K,this.uint8[Ze+49]=ae,this.uint8[Ze+50]=ue,this.uint32[He+13]=fe,this.int16[Ve+28]=Me,this.uint8[Ze+58]=De,i}}gm.prototype.bytesPerElement=60,en(gm,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class jy extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,a,h,f,_,y,x,C,I,R,P,L,$,j,q,Z,K,ae,ue,fe,Me,De,Ve,He,Ze,_t,Je,bt,Mt,Tt,It,zt,mt){const At=this.length;return this.resize(At+1),this.emplace(At,i,a,h,f,_,y,x,C,I,R,P,L,$,j,q,Z,K,ae,ue,fe,Me,De,Ve,He,Ze,_t,Je,bt,Mt,Tt,It,zt,mt)}emplace(i,a,h,f,_,y,x,C,I,R,P,L,$,j,q,Z,K,ae,ue,fe,Me,De,Ve,He,Ze,_t,Je,bt,Mt,Tt,It,zt,mt,At){const ct=20*i,rt=40*i,Bt=80*i;return this.float32[ct+0]=a,this.float32[ct+1]=h,this.int16[rt+4]=f,this.int16[rt+5]=_,this.int16[rt+6]=y,this.int16[rt+7]=x,this.int16[rt+8]=C,this.int16[rt+9]=I,this.int16[rt+10]=R,this.int16[rt+11]=P,this.int16[rt+12]=L,this.uint16[rt+13]=$,this.uint16[rt+14]=j,this.uint16[rt+15]=q,this.uint16[rt+16]=Z,this.uint16[rt+17]=K,this.uint16[rt+18]=ae,this.uint16[rt+19]=ue,this.uint16[rt+20]=fe,this.uint16[rt+21]=Me,this.uint16[rt+22]=De,this.uint16[rt+23]=Ve,this.uint16[rt+24]=He,this.uint16[rt+25]=Ze,this.uint16[rt+26]=_t,this.uint16[rt+27]=Je,this.uint32[ct+14]=bt,this.float32[ct+15]=Mt,this.float32[ct+16]=Tt,this.float32[ct+17]=It,this.float32[ct+18]=zt,this.uint8[Bt+76]=mt,this.uint16[rt+39]=At,i}}jy.prototype.bytesPerElement=80,en(jy,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class _m extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h,f,_,y){const x=this.length;return this.resize(x+1),this.emplace(x,i,a,h,f,_,y)}emplace(i,a,h,f,_,y,x){const C=6*i;return this.float32[C+0]=a,this.float32[C+1]=h,this.float32[C+2]=f,this.float32[C+3]=_,this.float32[C+4]=y,this.float32[C+5]=x,i}}_m.prototype.bytesPerElement=24,en(_m,"StructArrayLayout6f24");class Rh extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h,f,_){const y=this.length;return this.resize(y+1),this.emplace(y,i,a,h,f,_)}emplace(i,a,h,f,_,y){const x=5*i;return this.float32[x+0]=a,this.float32[x+1]=h,this.float32[x+2]=f,this.float32[x+3]=_,this.float32[x+4]=y,i}}Rh.prototype.bytesPerElement=20,en(Rh,"StructArrayLayout5f20");class Uy extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h,f,_,y,x){const C=this.length;return this.resize(C+1),this.emplace(C,i,a,h,f,_,y,x)}emplace(i,a,h,f,_,y,x,C){const I=7*i;return this.float32[I+0]=a,this.float32[I+1]=h,this.float32[I+2]=f,this.float32[I+3]=_,this.float32[I+4]=y,this.float32[I+5]=x,this.float32[I+6]=C,i}}Uy.prototype.bytesPerElement=28,en(Uy,"StructArrayLayout7f28");class Jg extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h,f,_,y,x,C,I,R,P){const L=this.length;return this.resize(L+1),this.emplace(L,i,a,h,f,_,y,x,C,I,R,P)}emplace(i,a,h,f,_,y,x,C,I,R,P,L){const $=11*i;return this.float32[$+0]=a,this.float32[$+1]=h,this.float32[$+2]=f,this.float32[$+3]=_,this.float32[$+4]=y,this.float32[$+5]=x,this.float32[$+6]=C,this.float32[$+7]=I,this.float32[$+8]=R,this.float32[$+9]=P,this.float32[$+10]=L,i}}Jg.prototype.bytesPerElement=44,en(Jg,"StructArrayLayout11f44");class ym extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h,f,_,y,x,C,I){const R=this.length;return this.resize(R+1),this.emplace(R,i,a,h,f,_,y,x,C,I)}emplace(i,a,h,f,_,y,x,C,I,R){const P=9*i;return this.float32[P+0]=a,this.float32[P+1]=h,this.float32[P+2]=f,this.float32[P+3]=_,this.float32[P+4]=y,this.float32[P+5]=x,this.float32[P+6]=C,this.float32[P+7]=I,this.float32[P+8]=R,i}}ym.prototype.bytesPerElement=36,en(ym,"StructArrayLayout9f36");class Zf extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a){const h=this.length;return this.resize(h+1),this.emplace(h,i,a)}emplace(i,a,h){const f=2*i;return this.float32[f+0]=a,this.float32[f+1]=h,i}}Zf.prototype.bytesPerElement=8,en(Zf,"StructArrayLayout2f8");class Qg extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a,h,f){const _=this.length;return this.resize(_+1),this.emplace(_,i,a,h,f)}emplace(i,a,h,f,_){const y=6*i;return this.uint32[3*i+0]=a,this.uint16[y+2]=h,this.uint16[y+3]=f,this.uint16[y+4]=_,i}}Qg.prototype.bytesPerElement=12,en(Qg,"StructArrayLayout1ul3ui12");class e_ extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const a=this.length;return this.resize(a+1),this.emplace(a,i)}emplace(i,a){return this.uint16[1*i+0]=a,i}}e_.prototype.bytesPerElement=2,en(e_,"StructArrayLayout1ui2");class Hy extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h,f,_,y,x,C,I,R,P,L,$,j,q,Z){const K=this.length;return this.resize(K+1),this.emplace(K,i,a,h,f,_,y,x,C,I,R,P,L,$,j,q,Z)}emplace(i,a,h,f,_,y,x,C,I,R,P,L,$,j,q,Z,K){const ae=16*i;return this.float32[ae+0]=a,this.float32[ae+1]=h,this.float32[ae+2]=f,this.float32[ae+3]=_,this.float32[ae+4]=y,this.float32[ae+5]=x,this.float32[ae+6]=C,this.float32[ae+7]=I,this.float32[ae+8]=R,this.float32[ae+9]=P,this.float32[ae+10]=L,this.float32[ae+11]=$,this.float32[ae+12]=j,this.float32[ae+13]=q,this.float32[ae+14]=Z,this.float32[ae+15]=K,i}}Hy.prototype.bytesPerElement=64,en(Hy,"StructArrayLayout16f64");class Kf extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h,f,_,y,x){const C=this.length;return this.resize(C+1),this.emplace(C,i,a,h,f,_,y,x)}emplace(i,a,h,f,_,y,x,C){const I=10*i,R=5*i;return this.uint16[I+0]=a,this.uint16[I+1]=h,this.uint16[I+2]=f,this.uint16[I+3]=_,this.float32[R+2]=y,this.float32[R+3]=x,this.float32[R+4]=C,i}}Kf.prototype.bytesPerElement=20,en(Kf,"StructArrayLayout4ui3f20");class Xf extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i){const a=this.length;return this.resize(a+1),this.emplace(a,i)}emplace(i,a){return this.int16[1*i+0]=a,i}}Xf.prototype.bytesPerElement=2,en(Xf,"StructArrayLayout1i2");class t_ extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(i){const a=this.length;return this.resize(a+1),this.emplace(a,i)}emplace(i,a){return this.uint8[1*i+0]=a,i}}t_.prototype.bytesPerElement=1,en(t_,"StructArrayLayout1ub1");class Y0 extends Hf{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Y0.prototype.size=40;class Gy extends qf{get(i){return new Y0(this,i)}}en(Gy,"CollisionBoxArray");class J0 extends Hf{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(i){this._structArray.uint8[this._pos1+49]=i}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(i){this._structArray.uint8[this._pos1+50]=i}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(i){this._structArray.uint32[this._pos4+13]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(i){this._structArray.uint8[this._pos1+58]=i}}J0.prototype.size=60;class n_ extends gm{get(i){return new J0(this,i)}}en(n_,"PlacedSymbolArray");class Q0 extends Hf{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(i){this._structArray.uint32[this._pos4+14]=i}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(i){this._structArray.float32[this._pos4+18]=i}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}Q0.prototype.size=80;class e1 extends jy{get(i){return new Q0(this,i)}}en(e1,"SymbolInstanceArray");class t1 extends Dd{getoffsetX(i){return this.float32[1*i+0]}}en(t1,"GlyphOffsetArray");class n1 extends Md{getx(i){return this.int16[2*i+0]}gety(i){return this.int16[2*i+1]}}en(n1,"SymbolLineVertexArray");class Wy extends Hf{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Wy.prototype.size=12;class i1 extends Qg{get(i){return new Wy(this,i)}}en(i1,"FeatureIndexArray");class r1 extends hs{geta_centroid_pos0(i){return this.uint16[2*i+0]}geta_centroid_pos1(i){return this.uint16[2*i+1]}}en(r1,"FillExtrusionCentroidArray");class o1 extends Hf{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}o1.prototype.size=6;class s1 extends Ah{get(i){return new o1(this,i)}}en(s1,"FillExtrusionWallArray");const QS=ki([{name:"a_pos",components:2,type:"Int16"}],4),eC=ki([{name:"a_circle_z_offset",components:1,type:"Float32"}],4),tC=ki([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ro{constructor(i=[]){this.segments=i}_prepareSegment(i,a,h,f){let _=this.segments[this.segments.length-1];return i>ro.MAX_VERTEX_ARRAY_LENGTH&&li(`Max vertices per segment is ${ro.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!_||_.vertexLength+i>ro.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==f)&&(_={vertexOffset:a,primitiveOffset:h,vertexLength:0,primitiveLength:0},f!==void 0&&(_.sortKey=f),this.segments.push(_)),_}prepareSegment(i,a,h,f){return this._prepareSegment(i,a.length,h.length,f)}get(){return this.segments}destroy(){for(const i of this.segments)for(const a in i.vaos)i.vaos[a].destroy()}static simpleSegment(i,a,h,f){return new ro([{vertexOffset:i,primitiveOffset:a,vertexLength:h,primitiveLength:f,vaos:{},sortKey:0}])}}function vm(l,i){return 256*(l=Le(Math.floor(l),0,255))+Le(Math.floor(i),0,255)}ro.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,en(ro,"SegmentVector");const nC=ki([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),iC=ki([{name:"a_pattern_b",components:4,type:"Uint16"}]),i_=ki([{name:"a_dash",components:4,type:"Uint16"}]);class bm{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(i,a,h,f){this.ids.push(qy(i)),this.positions.push(a,h,f)}eachPosition(i,a){const h=qy(i);let f=0,_=this.ids.length-1;for(;f<_;){const y=f+_>>1;this.ids[y]>=h?_=y:f=y+1}for(;this.ids[f]===h;)a(this.positions[3*f],this.positions[3*f+1],this.positions[3*f+2]),f++}static serialize(i,a){const h=new Float64Array(i.ids),f=new Uint32Array(i.positions);return Zy(h,f,0,h.length-1),a&&(a.add(h.buffer),a.add(f.buffer)),{ids:h,positions:f}}static deserialize(i){const a=new bm;let h;a.ids=i.ids,a.positions=i.positions;for(const f of a.ids)f!==h&&a.uniqueIds.push(f),h=f;return a.indexed=!0,a}}function qy(l){const i=+l;return Number.isSafeInteger(i)?i:Gc(String(l))}function Zy(l,i,a,h){for(;a<h;){const f=l[a+h>>1];let _=a-1,y=h+1;for(;;){do _++;while(l[_]<f);do y--;while(l[y]>f);if(_>=y)break;xm(l,_,y),xm(i,3*_,3*y),xm(i,3*_+1,3*y+1),xm(i,3*_+2,3*y+2)}y-a<h-y?(Zy(l,i,a,y),a=y+1):(Zy(l,i,y+1,h),h=y)}}function xm(l,i,a){const h=l[i];l[i]=l[a],l[a]=h}en(bm,"FeaturePositionMap");class su{constructor(i){this.gl=i.gl,this.initialized=!1}fetchUniformLocation(i,a){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(i,a),this.initialized=!0),!!this.location}set(i,a,h){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class wm extends su{constructor(i){super(i),this.current=0}set(i,a,h){this.fetchUniformLocation(i,a)&&this.current!==h&&(this.current=h,this.gl.uniform1i(this.location,h))}}class Ho extends su{constructor(i){super(i),this.current=0}set(i,a,h){this.fetchUniformLocation(i,a)&&this.current!==h&&(this.current=h,this.gl.uniform1f(this.location,h))}}class au extends su{constructor(i){super(i),this.current=[0,0]}set(i,a,h){this.fetchUniformLocation(i,a)&&(h[0]===this.current[0]&&h[1]===this.current[1]||(this.current=h,this.gl.uniform2f(this.location,h[0],h[1])))}}class Sm extends su{constructor(i){super(i),this.current=[0,0,0]}set(i,a,h){this.fetchUniformLocation(i,a)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]||(this.current=h,this.gl.uniform3f(this.location,h[0],h[1],h[2])))}}class Cm extends su{constructor(i){super(i),this.current=[0,0,0,0]}set(i,a,h){this.fetchUniformLocation(i,a)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]&&h[3]===this.current[3]||(this.current=h,this.gl.uniform4f(this.location,h[0],h[1],h[2],h[3])))}}class a1 extends su{constructor(i){super(i),this.current=Bi.transparent.toPremultipliedRenderColor(null)}set(i,a,h){this.fetchUniformLocation(i,a)&&(h.r===this.current.r&&h.g===this.current.g&&h.b===this.current.b&&h.a===this.current.a||(this.current=h,this.gl.uniform4f(this.location,h.r,h.g,h.b,h.a)))}}const rC=new Float32Array(16);class Tm extends su{constructor(i){super(i),this.current=rC}set(i,a,h){if(this.fetchUniformLocation(i,a)){if(h[12]!==this.current[12]||h[0]!==this.current[0])return this.current=h,void this.gl.uniformMatrix4fv(this.location,!1,h);for(let f=1;f<16;f++)if(h[f]!==this.current[f]){this.current=h,this.gl.uniformMatrix4fv(this.location,!1,h);break}}}}const oC=new Float32Array(9),sC=new Float32Array(4);class r_ extends su{constructor(i){super(i),this.current=sC}set(i,a,h){if(this.fetchUniformLocation(i,a)){for(let f=0;f<4;f++)if(h[f]!==this.current[f]){this.current=h,this.gl.uniformMatrix2fv(this.location,!1,h);break}}}}function Em(l){return[vm(255*l.r,255*l.g),vm(255*l.b,255*l.a)]}class Ml{constructor(i,a,h,f){this.value=i,this.uniformNames=a.map(_=>`u_${_}`),this.type=h,this.context=f}setUniform(i,a,h,f,_){const y=f.constantOr(this.value);a.set(i,_,y instanceof Bi?y.toPremultipliedRenderColor(this.lutExpression&&this.lutExpression.kind==="constant"&&this.lutExpression.value==="none"?null:this.context.lut):y)}getBinding(i,a){return this.type==="color"?new a1(i):new Ho(i)}}class Ph{constructor(i,a){this.uniformNames=a.map(h=>`u_${h}`),this.pattern=null,this.patternTransition=null,this.pixelRatio=1}setConstantPatternPositions(i,a){this.pixelRatio=i.pixelRatio||1,this.pattern=i.tl.concat(i.br),this.patternTransition=a?a.tl.concat(a.br):this.pattern}setUniform(i,a,h,f,_){let y=null;_!=="u_pattern"&&_!=="u_dash"||(y=this.pattern),_==="u_pattern_b"&&(y=this.patternTransition),_==="u_pixel_ratio"&&(y=this.pixelRatio),y&&a.set(i,_,y)}getBinding(i,a){return a==="u_pattern"||a==="u_pattern_b"||a==="u_dash"?new Cm(i):new Ho(i)}}class Ld{constructor(i,a,h,f){this.expression=i,this.type=h,this.maxValue=0,this.paintVertexAttributes=a.map(_=>({name:`a_${_}`,type:"Float32",components:h==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(i,a,h,f,_,y,x,C){const I=this.paintVertexArray.length,R=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new Tr(0,{brightness:y,worldview:C}),a,{},_,f,x):this.expression.kind==="constant"&&this.expression.value,P=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Tr(0,{brightness:y,worldview:C}),a,{},_,f,x):this.lutExpression.value)==="none";this.paintVertexArray.resize(i),this._setPaintValue(I,i,R,P?null:this.context.lut)}updatePaintArray(i,a,h,f,_,y,x,C){const I=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:x,worldview:C},h,f,void 0,_):this.expression.kind==="constant"&&this.expression.value,R=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Tr(0,{brightness:x,worldview:C}),h,f,void 0,_):this.lutExpression.value)==="none";this._setPaintValue(i,a,I,R?null:this.context.lut)}_setPaintValue(i,a,h,f){if(this.type==="color"){const _=Em(h.toPremultipliedRenderColor(f));for(let y=i;y<a;y++)this.paintVertexArray.emplace(y,_[0],_[1])}else{for(let _=i;_<a;_++)this.paintVertexArray.emplace(_,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Uu{constructor(i,a,h,f,_,y){this.expression=i,this.uniformNames=a.map(x=>`u_${x}_t`),this.type=h,this.useIntegerZoom=f,this.context=_,this.maxValue=0,this.paintVertexAttributes=a.map(x=>({name:`a_${x}`,type:"Float32",components:h==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(i,a,h,f,_,y,x,C){const I=this.expression.evaluate(new Tr(this.context.zoom,{brightness:y,worldview:C}),a,{},_,f,x),R=this.expression.evaluate(new Tr(this.context.zoom+1,{brightness:y,worldview:C}),a,{},_,f,x),P=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Tr(0,{brightness:y,worldview:C}),a,{},_,f,x):this.lutExpression.value)==="none",L=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(L,i,I,R,P?null:this.context.lut)}updatePaintArray(i,a,h,f,_,y,x,C){const I=this.expression.evaluate({zoom:this.context.zoom,brightness:x,worldview:C},h,f,void 0,_),R=this.expression.evaluate({zoom:this.context.zoom+1,brightness:x,worldview:C},h,f,void 0,_),P=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Tr(0,{brightness:x,worldview:C}),h,f,void 0,_):this.lutExpression.value)==="none";this._setPaintValue(i,a,I,R,P?null:this.context.lut)}_setPaintValue(i,a,h,f,_){if(this.type==="color"){const y=Em(h.toPremultipliedRenderColor(_)),x=Em(h.toPremultipliedRenderColor(_));for(let C=i;C<a;C++)this.paintVertexArray.emplace(C,y[0],y[1],x[0],x[1])}else{for(let y=i;y<a;y++)this.paintVertexArray.emplace(y,h,f);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(f))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,a,h,f,_){const y=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,x=Le(this.expression.interpolationFactor(y,this.context.zoom,this.context.zoom+1),0,1);a.set(i,_,x)}getBinding(i,a){return new Ho(i)}}class Hu{constructor(i,a,h,f,_){this.expression=i,this.layerId=_,this.paintVertexAttributes=(h==="array"?i_:nC).members;for(let y=0;y<a.length;++y);this.paintVertexArray=new f,this.paintTransitionVertexArray=new Gf}populatePaintArray(i,a,h,f){const _=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValues(_,i,a.patterns&&a.patterns[this.layerId],h)}updatePaintArray(i,a,h,f,_,y,x){this._setPaintValues(i,a,h.patterns&&h.patterns[this.layerId],y)}_setPaintValues(i,a,h,f){if(!f||!h)return;const _=f[h[0]],y=f[h[1]];if(_){if(_){const{tl:x,br:C,pixelRatio:I}=_;for(let R=i;R<a;R++)this.paintVertexArray.emplace(R,x[0],x[1],C[0],C[1],I)}if(y){this.paintTransitionVertexArray.resize(this.paintVertexArray.length);const{tl:x,br:C}=y;for(let I=i;I<a;I++)this.paintTransitionVertexArray.emplace(I,x[0],x[1],C[0],C[1])}}}upload(i){const a=this.expression.isStateDependent||!this.expression.isLightConstant;this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,a)),this.paintTransitionVertexArray&&this.paintTransitionVertexArray.length&&(this.paintTransitionVertexBuffer=i.createVertexBuffer(this.paintTransitionVertexArray,iC.members,a))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy(),this.paintTransitionVertexBuffer&&this.paintTransitionVertexBuffer.destroy()}}class Mh{constructor(i,a,h=()=>!0){this.binders={},this._buffers=[],this.context=a;const f=[];for(const _ in i.paint._values){const y=i.paint.get(_);if(_.endsWith("-use-theme")||!h(_)||!(y instanceof Th&&Wi(y.property.specification)))continue;const x=HA(_,i.type),C=y.value,I=y.property.specification.type,R=!!y.property.useIntegerZoom,P=_==="line-dasharray"||_.endsWith("pattern"),L=i.paint.get(`${_}-use-theme`),$=_==="line-dasharray"&&i.layout.get("line-cap").value.kind!=="constant"||L&&L.value.kind!=="constant";if(C.kind!=="constant"||$)if(C.kind==="source"||$||P){const j=d(_,I,"source");this.binders[_]=P?new Hu(C,x,I,j,i.id):new Ld(C,x,I,j),f.push(`/a_${_}`)}else{const j=d(_,I,"composite");this.binders[_]=new Uu(C,x,I,R,a,j),f.push(`/z_${_}`)}else this.binders[_]=P?new Ph(C.value,x):new Ml(C.value,x,I,a),f.push(`/u_${_}`);L&&(this.binders[_].lutExpression=L.value)}this.cacheKey=f.sort().join("")}getMaxValue(i){const a=this.binders[i];return a instanceof Ld||a instanceof Uu?a.maxValue:0}populatePaintArrays(i,a,h,f,_,y,x,C){for(const I in this.binders){const R=this.binders[I];R.context=this.context,(R instanceof Ld||R instanceof Uu||R instanceof Hu)&&R.populatePaintArray(i,a,h,f,_,y,x,C)}}setConstantPatternPositions(i,a){for(const h in this.binders){const f=this.binders[h];f instanceof Ph&&f.setConstantPatternPositions(i,a)}}getPatternTransitionVertexBuffer(i){const a=this.binders[i];return a instanceof Hu?a.paintTransitionVertexBuffer:null}updatePaintArrays(i,a,h,f,_,y,x,C,I,R){let P=!1;const L=Object.keys(i),$=L.length!==0&&!C,j=$?L:a.uniqueIds;this.context.lut=_.lut;for(const q in this.binders){const Z=this.binders[q];if(Z.context=this.context,(Z instanceof Ld||Z instanceof Uu||Z instanceof Hu)&&Z.expression&&Z.expression.kind&&Z.expression.kind!=="constant"&&(Z.expression.isStateDependent===!0||Z.expression.isLightConstant===!1)){const K=_.paint.get(q);Z.expression=K.value;for(const ae of j){const ue=i[ae.toString()];a.eachPosition(ae,(fe,Me,De)=>{const Ve=f.feature(fe);Z.updatePaintArray(Me,De,Ve,ue,y,x,I,R)})}if(!$)for(const ae of h.uniqueIds){const ue=i[ae.toString()];h.eachPosition(ae,(fe,Me,De)=>{const Ve=f.feature(fe);Z.updatePaintArray(Me,De,Ve,ue,y,x,I,R)})}P=!0}}return P}defines(){const i=[];for(const a in this.binders){const h=this.binders[a];(h instanceof Ml||h instanceof Ph)&&i.push(...h.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i){const a=[];for(const h in this.binders){const f=this.binders[h];if(f instanceof Ml||f instanceof Ph||f instanceof Uu)for(const _ of f.uniformNames)a.push({name:_,property:h,binding:f.getBinding(i,_)})}return a}setUniforms(i,a,h,f,_){for(const{name:y,property:x,binding:C}of h)this.binders[x].setUniform(i,C,_,f.get(x),y)}updatePaintBuffers(){this._buffers=[];for(const i in this.binders){const a=this.binders[i];(a instanceof Ld||a instanceof Uu||a instanceof Hu)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer),a instanceof Hu&&a.paintTransitionVertexBuffer&&this._buffers.push(a.paintTransitionVertexBuffer)}}upload(i){for(const a in this.binders){const h=this.binders[a];(h instanceof Ld||h instanceof Uu||h instanceof Hu)&&h.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const a=this.binders[i];(a instanceof Ld||a instanceof Uu||a instanceof Hu)&&a.destroy()}}}class Ic{constructor(i,a,h=()=>!0){this.programConfigurations={};for(const f of i)this.programConfigurations[f.id]=new Mh(f,a,h);this.needsUpload=!1,this._featureMap=new bm,this._featureMapWithoutIds=new bm,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(i,a,h,f,_,y,x,C,I){for(const R in this.programConfigurations)this.programConfigurations[R].populatePaintArrays(i,a,f,_,y,x,C,I);a.id!==void 0?this._featureMap.add(a.id,h,this._bufferOffset,i):(this._featureMapWithoutIds.add(this._idlessCounter,h,this._bufferOffset,i),this._idlessCounter+=1),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,a,h,f,_,y,x,C){for(const I of h)this.needsUpload=this.programConfigurations[I.id].updatePaintArrays(i,this._featureMap,this._featureMapWithoutIds,a,I,f,_,y,x||0,C)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}const l1={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio","pattern_b"],"fill-pattern":["pattern","pixel_ratio","pattern_b"],"fill-extrusion-pattern":["pattern","pixel_ratio","pattern_b"],"line-dasharray":["dash"],"fill-bridge-guard-rail-color":["structure_color"],"fill-tunnel-structure-color":["structure_color"]};function HA(l,i){return l1[l]||[l.replace(`${i}-`,"").replace(/-/g,"_")]}const g={"line-pattern":{source:Od,composite:Od},"fill-pattern":{source:Od,composite:Od},"fill-extrusion-pattern":{source:Od,composite:Od},"line-dasharray":{source:Gf,composite:Gf}},s={color:{source:Zf,composite:Ec},number:{source:Dd,composite:Zf}};function d(l,i,a){const h=g[l];return h&&h[a]||s[i][a]}en(Ml,"ConstantBinder"),en(Ph,"PatternConstantBinder"),en(Ld,"SourceExpressionBinder"),en(Hu,"PatternCompositeBinder"),en(Uu,"CompositeExpressionBinder"),en(Mh,"ProgramConfiguration",{omit:["_buffers"]}),en(Ic,"ProgramConfigurationSet");const m=Ut/Math.PI/2,v=5,b=6,S=16383,E=64,k=[E,32,16],O=-m,z=m;function U(l,i,a,h=m){return a=Xe(a),[l*Math.sin(a)*h,-i*h,l*Math.cos(a)*h]}function F(l,i,a){return U(Math.cos(Xe(l)),Math.sin(Xe(l)),i,a)}const H=63710088e-1,G=2*Math.PI*H;class W{constructor(i,a){if(isNaN(i)||isNaN(a))throw new Error(`Invalid LngLat object: (${i}, ${a})`);if(this.lng=+i,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new W(Ge(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const a=Math.PI/180,h=this.lat*a,f=i.lat*a,_=Math.sin(h)*Math.sin(f)+Math.cos(h)*Math.cos(f)*Math.cos((i.lng-this.lng)*a);return H*Math.acos(Math.min(_,1))}toBounds(i=0){const a=360*i/40075017,h=a/Math.cos(Math.PI/180*this.lat);return new ne({lng:this.lng-h,lat:this.lat-a},{lng:this.lng+h,lat:this.lat+a})}toEcef(i){return F(this.lat,this.lng,m+i*m/H)}static convert(i){if(i instanceof W)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new W(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new W(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class ne{constructor(i,a){i&&(a?this.setSouthWest(i).setNorthEast(a):Array.isArray(i)&&i.length===4?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1]))}setNorthEast(i){return this._ne=i instanceof W?new W(i.lng,i.lat):W.convert(i),this}setSouthWest(i){return this._sw=i instanceof W?new W(i.lng,i.lat):W.convert(i),this}extend(i){const a=this._sw,h=this._ne;let f,_;if(i instanceof W)f=i,_=i;else{if(!(i instanceof ne))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(ne.convert(i)):this.extend(W.convert(i)):typeof i=="object"&&i!==null&&i.hasOwnProperty("lat")&&(i.hasOwnProperty("lon")||i.hasOwnProperty("lng"))?this.extend(W.convert(i)):this;if(f=i._sw,_=i._ne,!f||!_)return this}return a||h?(a.lng=Math.min(f.lng,a.lng),a.lat=Math.min(f.lat,a.lat),h.lng=Math.max(_.lng,h.lng),h.lat=Math.max(_.lat,h.lat)):(this._sw=new W(f.lng,f.lat),this._ne=new W(_.lng,_.lat)),this}getCenter(){return new W((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new W(this.getWest(),this.getNorth())}getSouthEast(){return new W(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:a,lat:h}=W.convert(i);let f=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&f}static convert(i){if(i)return i instanceof ne?i:new ne(i)}}const X=0,re=25.5;function he(l){return G*Math.cos(l*Math.PI/180)}function pe(l){return(180+l)/360}function Ie(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function Se(l,i){return l/he(i)}function Ae(l){return 360*l-180}function Ce(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function we(l,i){return l*he(Ce(i))}const ke=85.051129;function nt(l){return Math.cos(Xe(Le(l,-ke,ke)))}function Ke(l,i){const a=Le(i,X,re),h=Math.pow(2,a);return nt(l)*G/(512*h)}function ht(l){return 1/Math.cos(l*Math.PI/180)}function et(l,i=0){const a=Math.exp(Math.PI*(1-(l.y+i/Ut)/(1<<l.z)*2));return 80150034*a/(a*a+1)/Ut/(1<<l.z)}class ut{constructor(i,a,h=0){this.x=+i,this.y=+a,this.z=+h}static fromLngLat(i,a=0){const h=W.convert(i);return new ut(pe(h.lng),Ie(h.lat),Se(a,h.lat))}toLngLat(){return new W(Ae(this.x),Ce(this.y))}toAltitude(){return we(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/G*ht(Ce(this.y))}}function jt(l,i,a,h,f,_,y,x,C){const I=(i+h)/2,R=(a+f)/2,P=new Dt(I,R);x(P),function(L,$,j,q,Z,K){const ae=j-Z,ue=q-K;return Math.abs((q-$)*ae-(j-L)*ue)/Math.hypot(ae,ue)}(P.x,P.y,_.x,_.y,y.x,y.y)>=C?(jt(l,i,a,I,R,_,P,x,C),jt(l,I,R,h,f,P,y,x,C)):l.push(y)}function tt(l,i,a){let h=l[0],f=h.x,_=h.y;i(h);const y=[h];for(let x=1;x<l.length;x++){const C=l[x],{x:I,y:R}=C;i(C),jt(y,f,_,I,R,h,C,i,a),f=I,_=R,h=C}return y}function Ue(l,i,a,h){if(h(i,a)){const f=i.add(a)._mult(.5);Ue(l,i,f,h),Ue(l,f,a,h)}else l.push(a)}function pt(l,i){let a=l[0];const h=[a];for(let f=1;f<l.length;f++){const _=l[f];Ue(h,a,_,i),a=_}return h}const ot=Math.pow(2,14)-1,Et=-ot-1;function $t(l,i){const a=Math.round(l.x*i),h=Math.round(l.y*i);return l.x=Le(a,Et,ot),l.y=Le(h,Et,ot),(a<l.x||a>l.x+1||h<l.y||h>l.y+1)&&li("Geometry exceeds allowed extent, reduce your vector tile buffer size"),l}function rn(l,i,a){const h=l.loadGeometry(),f=l.extent,_=Ut/f;if(i&&a&&a.projection.isReprojectedInTileSpace){const y=1<<i.z,{scale:x,x:C,y:I,projection:R}=a,P=L=>{const $=Ae((i.x+L.x/f)/y),j=Ce((i.y+L.y/f)/y),q=R.project($,j);L.x=(q.x*x-C)*f,L.y=(q.y*x-I)*f};for(let L=0;L<h.length;L++)if(l.type!==1)h[L]=tt(h[L],P,1);else{const $=[];for(const j of h[L])j.x<0||j.x>=f||j.y<0||j.y>=f||(P(j),$.push(j));h[L]=$}}for(const y of h)for(const x of y)$t(x,_);return h}function Lt(l,i){return{type:l.type,id:l.id,properties:l.properties,geometry:i?rn(l):[]}}class Rt{constructor(i,a,h,f,_){this.properties={},this.extent=h,this.type=0,this.id=void 0,this._pbf=i,this._geometry=-1,this._keys=f,this._values=_,i.readFields(Cn,this,a)}loadGeometry(){const i=this._pbf;i.pos=this._geometry;const a=i.readVarint()+i.pos,h=[];let f,_=1,y=0,x=0,C=0;for(;i.pos<a;){if(y<=0){const I=i.readVarint();_=7&I,y=I>>3}if(y--,_===1||_===2)x+=i.readSVarint(),C+=i.readSVarint(),_===1&&(f&&h.push(f),f=[]),f&&f.push(new Dt(x,C));else{if(_!==7)throw new Error(`unknown command ${_}`);f&&f.push(f[0].clone())}}return f&&h.push(f),h}bbox(){const i=this._pbf;i.pos=this._geometry;const a=i.readVarint()+i.pos;let h=1,f=0,_=0,y=0,x=1/0,C=-1/0,I=1/0,R=-1/0;for(;i.pos<a;){if(f<=0){const P=i.readVarint();h=7&P,f=P>>3}if(f--,h===1||h===2)_+=i.readSVarint(),y+=i.readSVarint(),_<x&&(x=_),_>C&&(C=_),y<I&&(I=y),y>R&&(R=y);else if(h!==7)throw new Error(`unknown command ${h}`)}return[x,I,C,R]}toGeoJSON(i,a,h){const f=this.extent*Math.pow(2,h),_=this.extent*i,y=this.extent*a,x=this.loadGeometry();function C(L){return[360*(L.x+_)/f-180,360/Math.PI*Math.atan(Math.exp((1-2*(L.y+y)/f)*Math.PI))-90]}function I(L){return L.map(C)}let R;if(this.type===1){const L=[];for(const j of x)L.push(j[0]);const $=I(L);R=L.length===1?{type:"Point",coordinates:$[0]}:{type:"MultiPoint",coordinates:$}}else if(this.type===2){const L=x.map(I);R=L.length===1?{type:"LineString",coordinates:L[0]}:{type:"MultiLineString",coordinates:L}}else{if(this.type!==3)throw new Error("unknown feature type");{const L=function(j){const q=j.length;if(q<=1)return[j];const Z=[];let K,ae;for(let ue=0;ue<q;ue++){const fe=yn(j[ue]);fe!==0&&(ae===void 0&&(ae=fe<0),ae===fe<0?(K&&Z.push(K),K=[j[ue]]):K&&K.push(j[ue]))}return K&&Z.push(K),Z}(x),$=[];for(const j of L)$.push(j.map(I));R=$.length===1?{type:"Polygon",coordinates:$[0]}:{type:"MultiPolygon",coordinates:$}}}const P={type:"Feature",geometry:R,properties:this.properties};return this.id!=null&&(P.id=this.id),P}}function Cn(l,i,a){l===1?i.id=a.readVarint():l===2?function(h,f){const _=h.readVarint()+h.pos;for(;h.pos<_;){const y=f._keys[h.readVarint()],x=f._values[h.readVarint()];f.properties[y]=x}}(a,i):l===3?i.type=a.readVarint():l===4&&(i._geometry=a.pos)}function yn(l){let i=0;for(let a,h,f=0,_=l.length,y=_-1;f<_;y=f++)a=l[f],h=l[y],i+=(h.x-a.x)*(a.y+h.y);return i}Rt.types=["Unknown","Point","LineString","Polygon"];class wn{constructor(i,a){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(gn,this,a),this.length=this._features.length}feature(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];const a=this._pbf.readVarint()+this._pbf.pos;return new Rt(this._pbf,a,this.extent,this._keys,this._values)}}function gn(l,i,a){l===15?i.version=a.readVarint():l===1?i.name=a.readString():l===5?i.extent=a.readVarint():l===2?i._features.push(a.pos):l===3?i._keys.push(a.readString()):l===4&&i._values.push(function(h){let f=null;const _=h.readVarint()+h.pos;for(;h.pos<_;){const y=h.readVarint()>>3;f=y===1?h.readString():y===2?h.readFloat():y===3?h.readDouble():y===4?h.readVarint64():y===5?h.readVarint():y===6?h.readSVarint():y===7?h.readBoolean():null}if(f==null)throw new Error("unknown feature value");return f}(a))}class Wn{constructor(i,a){this.layers=i.readFields(ri,{},a)}}function ri(l,i,a){if(l===3){const h=new wn(a,a.readVarint()+a.pos);h.length&&(i[h.name]=h)}}const ci="3d_elevation_id",or="level";class Xn{constructor(){this._valid=!1}reset(i){return this.feature=i,this._valid=!0,this._geometry=i.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(i,a){return this._valid&&i(a(this._geometry)),this}require(i,a,h){return this.get(i,!0,a,h)}optional(i,a,h){return this.get(i,!1,a,h)}success(){return this._valid}get(i,a,h,f){const _=this.feature.properties.hasOwnProperty(i)?+this.feature.properties[i]:void 0;return this._valid&&_!==void 0&&!Number.isNaN(_)?h(f?f(_):_):a&&(this._valid=!1),this}}class ji{constructor(i,a){this.featureFunc=i,this.vertexFunc=a}parseFeature(i,a,h){return this.featureFunc(i,a,h)}parseVertex(i,a,h){return this.vertexFunc(i,a,h)}}const rr=new ji((l,i,a)=>l.reset(i).require(ci,h=>{a.id=h}).optional("fixed_height_relative",h=>{a.constantHeight=h},oi.decodeRelativeHeight).geometry(h=>{a.bounds=h},_f).success(),(l,i,a)=>l.reset(i).require(ci,h=>{a.id=h}).require("elevation_idx",h=>{a.idx=h}).require("extent",h=>{a.extent=h}).require("height_relative",h=>{a.height=h},oi.decodeRelativeHeight).geometry(h=>{a.position=h},oi.getPoint).success()),$r=new ji((l,i,a)=>l.reset(i).require(ci,h=>{a.id=h}).optional("fixed_height",h=>{a.constantHeight=h},oi.decodeMetricHeight).geometry(h=>{a.bounds=h},_f).success(),(l,i,a)=>l.reset(i).require(ci,h=>{a.id=h}).require("elevation_idx",h=>{a.idx=h}).require("extent",h=>{a.extent=h}).require("height",h=>{a.height=h},oi.decodeMetricHeight).geometry(h=>{a.position=h},oi.getPoint).success());class oi{static getPoint(i){return ho(i[0][0].x,i[0][0].y)}static decodeRelativeHeight(i){return 1e-4*i*5}static decodeMetricHeight(i){return 1e-4*i}static getVersionSchema(i){return i?i==="1.0.1"?$r:void 0:rr}static parse(i){const a=[],h=[],f=i.length,_=new Xn;for(let y=0;y<f;y++){const x=i.feature(y),C=x.properties.version,I=oi.getVersionSchema(C);if(I===void 0){li(`Unknown elevation feature version number ${C||"(unknown)"}`);continue}const R=x.properties.type;if(!R)continue;const P=Rt.types[x.type];if(P==="Point"&&R==="curve_point"){const L={};I.parseVertex(_,x,L)&&a.push(L)}else if(P==="Polygon"&&R==="curve_meta"){const L={};I.parseFeature(_,x,L)&&h.push(L)}}return{vertices:a,features:h}}}class Ji{constructor(i,a){this.pos=i,this.dir=a}intersectsPlane(i,a,h){const f=ns(a,this.dir);if(Math.abs(f)<1e-6)return!1;const _=((i[0]-this.pos[0])*a[0]+(i[1]-this.pos[1])*a[1])/f;return h[0]=this.pos[0]+this.dir[0]*_,h[1]=this.pos[1]+this.dir[1]*_,!0}}class qi{constructor(i,a){this.pos=i,this.dir=a}intersectsPlane(i,a,h){const f=Ft(a,this.dir);if(Math.abs(f)<1e-6)return!1;const _=((i[0]-this.pos[0])*a[0]+(i[1]-this.pos[1])*a[1]+(i[2]-this.pos[2])*a[2])/f;return h[0]=this.pos[0]+this.dir[0]*_,h[1]=this.pos[1]+this.dir[1]*_,h[2]=this.pos[2]+this.dir[2]*_,!0}closestPointOnSphere(i,a,h){if(function($,j){var q=$[0],Z=$[1],K=$[2],ae=j[0],ue=j[1],fe=j[2];return Math.abs(q-ae)<=w*Math.max(1,Math.abs(q),Math.abs(ae))&&Math.abs(Z-ue)<=w*Math.max(1,Math.abs(Z),Math.abs(ue))&&Math.abs(K-fe)<=w*Math.max(1,Math.abs(K),Math.abs(fe))}(this.pos,i)||a===0)return h[0]=h[1]=h[2]=0,!1;const[f,_,y]=this.dir,x=this.pos[0]-i[0],C=this.pos[1]-i[1],I=this.pos[2]-i[2],R=f*f+_*_+y*y,P=2*(x*f+C*_+I*y),L=P*P-4*R*(x*x+C*C+I*I-a*a);if(L<0){const $=Math.max(-P/2,0),j=x+f*$,q=C+_*$,Z=I+y*$,K=Math.hypot(j,q,Z);return h[0]=j*a/K,h[1]=q*a/K,h[2]=Z*a/K,!1}{const $=(-P-Math.sqrt(L))/(2*R);if($<0){const j=Math.hypot(x,C,I);return h[0]=x*a/j,h[1]=C*a/j,h[2]=I*a/j,!1}return h[0]=x+f*$,h[1]=C+_*$,h[2]=I+y*$,!0}}}class er{constructor(i,a,h,f,_){this.TL=i,this.TR=a,this.BR=h,this.BL=f,this.horizon=_}static fromInvProjectionMatrix(i,a,h){const f=[-1,1,1],_=[1,1,1],y=[1,-1,1],x=[-1,-1,1],C=kn(f,f,i),I=kn(_,_,i),R=kn(y,y,i),P=kn(x,x,i);return new er(C,I,R,P,a/h)}}function Wr(l,i,a){let h=1/0,f=-1/0;const _=[];for(const y of l){Gt(_,y,i);const x=Ft(_,a);h=Math.min(h,x),f=Math.max(f,x)}return[h,f]}function Po(l,i){let a=!0;for(let h=0;h<l.planes.length;h++){const f=l.planes[h];let _=0;for(let y=0;y<i.length;y++)_+=+(Ft(f,i[y])+f[3]>=0);if(_===0)return 0;_!==i.length&&(a=!1)}return a?2:1}function Ds(l,i){for(const a of l.projections){const h=Wr(i,l.points[0],a.axis);if(a.projection[1]<h[0]||a.projection[0]>h[1])return 0}return 1}function qr(l,i){let a=0;const h=[0,0,0,0];for(let y=0;y<l.length;y++)h[0]=l[y][0],h[1]=l[y][1],h[2]=l[y][2],h[3]=1,(f=h)[0]*(_=i)[0]+f[1]*_[1]+f[2]*_[2]+f[3]*_[3]>=0&&a++;var f,_;return a}class ui{constructor(i,a){this.points=i||new Array(8).fill([0,0,0]),this.planes=a||new Array(6).fill([0,0,0,0]),this.bounds=Vn.fromPoints(this.points),this.projections=[],this.frustumEdges=[Gt([],this.points[2],this.points[3]),Gt([],this.points[0],this.points[3]),Gt([],this.points[4],this.points[0]),Gt([],this.points[5],this.points[1]),Gt([],this.points[6],this.points[2]),Gt([],this.points[7],this.points[3])];for(const h of this.frustumEdges){const f=[0,-h[2],h[1]],_=[h[2],0,-h[0]];this.projections.push({axis:f,projection:Wr(this.points,this.points[0],f)}),this.projections.push({axis:_,projection:Wr(this.points,this.points[0],_)})}}static fromInvProjectionMatrix(i,a,h,f){const _=Math.pow(2,h),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(I=>{const R=dn([],I,i),P=1/R[3]/a*_;return(L=R)[0]=($=R)[0]*(j=[P,P,f?1/R[3]:P,P])[0],L[1]=$[1]*j[1],L[2]=$[2]*j[2],L[3]=$[3]*j[3],L;var L,$,j}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(I=>{const R=ai([],In([],Gt([],y[I[0]],y[I[1]]),Gt([],y[I[2]],y[I[1]]))),P=-Ft(R,y[I[1]]);return R.concat(P)}),C=[];for(let I=0;I<y.length;I++)C.push([y[I][0],y[I][1],y[I][2]]);return new ui(C,x)}intersectsPrecise(i,a,h){for(let f=0;f<a.length;f++)if(!qr(i,a[f]))return 0;for(let f=0;f<this.planes.length;f++)if(!qr(i,this.planes[f]))return 0;for(const f of h)for(const _ of this.frustumEdges){const y=In([],f,_),x=Re(y);if(x===0)continue;Pt(y,y,1/x);const C=Wr(this.points,this.points[0],y),I=Wr(i,this.points[0],y);if(C[0]>I[1]||I[0]>C[1])return 0}return 1}containsPoint(i){for(const a of this.planes){const h=a[3];if(Ft([a[0],a[1],a[2]],i)+h<0)return!1}return!0}}class Vn{static fromPoints(i){const a=[1/0,1/0,1/0],h=[-1/0,-1/0,-1/0];for(const f of i)Ri(a,a,f),zi(h,h,f);return new Vn(a,h)}static fromTileIdAndHeight(i,a,h){const f=1<<i.canonical.z,_=i.canonical.x,y=i.canonical.y;return new Vn([_/f,y/f,a],[(_+1)/f,(y+1)/f,h])}static applyTransform(i,a){const h=i.getCorners();for(let f=0;f<h.length;++f)kn(h[f],h[f],a);return Vn.fromPoints(h)}static applyTransformFast(i,a){const h=[a[12],a[13],a[14]],f=[...h];for(let _=0;_<3;_++)for(let y=0;y<3;y++){const x=a[4*y+_],C=x*i.min[y],I=x*i.max[y];h[_]+=Math.min(C,I),f[_]+=Math.max(C,I)}return new Vn(h,f)}static projectAabbCorners(i,a){const h=i.getCorners();for(let f=0;f<h.length;++f)kn(h[f],h[f],a);return h}constructor(i,a){this.min=i,this.max=a,this.center=Pt([],on([],this.min,this.max),.5)}quadrant(i){const a=[i%2==0,i<2],h=Te(this.min),f=Te(this.max);for(let _=0;_<a.length;_++)h[_]=a[_]?this.min[_]:this.center[_],f[_]=a[_]?this.center[_]:this.max[_];return f[2]=this.max[2],new Vn(h,f)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}distanceZ(i){return Math.max(Math.min(this.max[2],i[2]),this.min[2])-i[2]}getCorners(){const i=this.min,a=this.max;return[[i[0],i[1],i[2]],[a[0],i[1],i[2]],[a[0],a[1],i[2]],[i[0],a[1],i[2]],[i[0],i[1],a[2]],[a[0],i[1],a[2]],[a[0],a[1],a[2]],[i[0],a[1],a[2]]]}intersects(i){return this.intersectsAabb(i.bounds)?Po(i,this.getCorners()):0}intersectsFlat(i){return this.intersectsAabb(i.bounds)?Po(i,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(i,a){return a||this.intersects(i)?Ds(i,this.getCorners()):0}intersectsPreciseFlat(i,a){return a||this.intersectsFlat(i)?Ds(i,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(i){for(let a=0;a<3;++a)if(this.min[a]>i.max[a]||i.min[a]>this.max[a])return!1;return!0}intersectsAabbXY(i){return!(this.min[0]>i.max[0]||i.min[0]>this.max[0]||this.min[1]>i.max[1]||i.min[1]>this.max[1])}encapsulate(i){for(let a=0;a<3;a++)this.min[a]=Math.min(this.min[a],i.min[a]),this.max[a]=Math.max(this.max[a],i.max[a])}encapsulatePoint(i){for(let a=0;a<3;a++)this.min[a]=Math.min(this.min[a],i[a]),this.max[a]=Math.max(this.max[a],i[a])}closestPoint(i){return[Math.max(Math.min(this.max[0],i[0]),this.min[0]),Math.max(Math.min(this.max[1],i[1]),this.min[1]),Math.max(Math.min(this.max[2],i[2]),this.min[2])]}}en(Vn,"Aabb");class sr{constructor(i,a){this.feature=i,this.metersToTile=a,this.index=0}get(){const i=this.feature.vertices[this.index],a=this.feature.vertexProps[this.index].dir,h=a[1],f=-a[0],_=(i.extent+1)*this.metersToTile;return[new Dt(Math.trunc(i.position[0]+h*_),Math.trunc(i.position[1]+f*_)),new Dt(Math.trunc(i.position[0]-h*_),Math.trunc(i.position[1]-f*_))]}next(){this.index++}valid(){return this.index<this.feature.vertices.length}}class yo{constructor(i,a,h,f,_,y){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this._tmpVec2=[Sr(),Sr(),Sr(),Sr(),Sr(),Sr(),Sr()],this.id=i,this.heightRange={min:h,max:h},this.safeArea=a,this.constantHeight=h,this.constantHeight==null&&(this.constantHeight!=null||f.length!==0)){this.vertices=f,this.edges=_,this.edges=this.edges.filter(x=>{return x.a<this.vertices.length&&x.b<this.vertices.length&&!((C=this.vertices[x.a].position)[0]===(I=this.vertices[x.b].position)[0]&&C[1]===I[1]);var C,I}),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const x of this.vertices)this.vertexProps.push({dir:ho(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,x.height),this.heightRange.max=Math.max(this.heightRange.max,x.height);for(const x of this.edges){const C=this.vertices[x.a].position,I=this.vertices[x.b].position,R=ao(Sr(),I,C),P=Fa(R),L=Ao(Sr(),R,1/P);this.edgeProps.push({vec:R,dir:L,len:P});const $=this.vertexProps[x.a].dir,j=this.vertexProps[x.b].dir;ha($,$,L),ha(j,j,L)}for(const x of this.vertexProps)x.dir[0]===0&&x.dir[1]===0||vr(x.dir,x.dir);this.tessellate(y)}}pointElevation(i){if(this.constantHeight!=null)return this.constantHeight;const a=this.getClosestEdge(i);if(a==null)return 0;const[h,f]=a;return Pn(this.vertices[this.edges[h].a].height,this.vertices[this.edges[h].b].height,f)}computeSlopeNormal(i,a){const h=this.getClosestEdge(i);if(!h)return tn(0,0,1);const f=h[0],_=this.edges[f],y=this.edgeProps[f].vec,x=tn(y[0],y[1],(this.vertices[_.b].height-this.vertices[_.a].height)*a),C=tn(x[1],-x[0],0);In(C,C,x);const I=Re(C);return I>0?Pt(C,C,1/I):Zt(C,0,0,1)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(i){if(this.edges.length===0)return;let a=0,h=Number.POSITIVE_INFINITY,f=0;const[_,y,x,C,I,R,P]=this._tmpVec2;Cs(P,i.x,i.y);const L=new Ji(P,null);for(let $=0;$<this.edges.length;$++){const j=this.edges[$],q=this.edgeProps[$].dir;L.dir=q;const Z=this.vertices[j.a].position,K=this.vertices[j.b].position,ae=L.intersectsPlane(Z,this.vertexProps[j.a].dir,_),ue=L.intersectsPlane(K,this.vertexProps[j.b].dir,y);if(!ae||!ue)continue;ao(x,y,_),ao(C,P,_);const fe=ns(x,x),Me=fe>0?ns(C,x)/fe:0,De=Le(Me,0,1),Ve=Math.abs((Me-De)*this.edgeProps[$].len);ao(I,P,Z),Cs(R,q[1],-q[0]);const He=Ve+Math.abs(ns(I,R));He<h&&(a=$,h=He,f=De)}return[a,f]}tessellate(i){const a=me(),h=me(),f=me(),_=me();for(let y=this.edges.length-1;y>=0;--y){const x=this.edges[y].a,C=this.edges[y].b,{position:I,height:R,extent:P}=this.vertices[x],{position:L,height:$,extent:j}=this.vertices[C],q=this.vertexProps[x].dir,Z=this.vertexProps[C].dir;if(Zt(a,I[0]/i,I[1]/i,R),Zt(h,L[0]/i,L[1]/i,$),Zt(f,q[1],-q[0],0),Pt(f,f,P),Zt(_,Z[1],-Z[0],0),Pt(_,_,j),this.distSqLines(tn(a[0]+.5*f[0],a[1]+.5*f[1],a[2]+.5*f[2]),tn(h[0]-.5*_[0],h[1]-.5*_[1],h[2]-.5*_[2]),tn(a[0]-.5*f[0],a[1]-.5*f[1],a[2]-.5*f[2]),tn(h[0]+.5*_[0],h[1]+.5*_[1],h[2]+.5*_[2]))<=.0025000000000000005)continue;const K=this.vertices.length,ae=ha(Sr(),I,L);this.vertices.push({position:Ao(ae,ae,.5),height:.5*(R+$),extent:.5*(P+j)});const ue=ha(Sr(),q,Z);this.vertexProps.push({dir:vr(ue,ue)}),this.edges.splice(y,1),this.edgeProps.splice(y,1),this.edges.push({a:x,b:K}),this.edges.push({a:K,b:C});const fe=ao(Sr(),this.vertices[K].position,I),Me=Fa(fe),De={vec:fe,dir:Ao(Sr(),fe,1/Me),len:Me};this.edgeProps.push(De),this.edgeProps.push(De)}}distSqLines(i,a,h,f){const _=hn(me(),a,i),y=hn(me(),f,h),x=hn(me(),i,h),C=Ft(_,_),I=Ft(_,y),R=Ft(_,x),P=Ft(y,y),L=Ft(y,x),$=C*P-I*I;if($===0)return wo(Wt(_,h,f,Ft(x,y)/Ft(y,y)),i);const j=(C*L-I*R)/$;return wo(Wt(_,i,a,(I*L-R*P)/$),Wt(y,h,f,j))}}class Yr{static parseFrom(i,a){const h=oi.parse(i);if(!h)return[];let{vertices:f,features:_}=h;const y=1/et(a);_.sort((R,P)=>R.id-P.id),f.sort((R,P)=>R.id-P.id||R.idx-P.idx),f=f.filter((R,P,L)=>P===L.findIndex($=>$.id===R.id&&$.idx===R.idx));const x=new Array;let C=0;const I=f.length;for(const R of _){if(R.constantHeight){x.push(new yo(R.id,R.bounds,R.constantHeight));continue}for(;C!==I&&f[C].id<R.id;)C++;if(C===I||f[C].id!==R.id)continue;const P=new Array,L=new Array,$=C;for(;C!==I&&f[C].id===R.id;){const j=f[C];if(P.push({position:j.position,height:j.height,extent:j.extent}),C!==$&&f[C-1].idx===j.idx-1){const q=C-$;L.push({a:q-1,b:q})}C++}x.push(new yo(R.id,R.bounds,void 0,P,L,y))}return x}static getElevationFeature(i,a){if(!a)return;const h=+i.properties[ci];return Number.isNaN(h)?void 0:a.find(f=>f.id===h)}}class es{constructor(i,a){this.zScale=1,this.xOffset=0,this.yOffset=0,i.equals(a)||(this.zScale=Math.pow(2,a.z-i.z),this.xOffset=(i.x*this.zScale-a.x)*Ut,this.yOffset=(i.y*this.zScale-a.y)*Ut)}constantElevation(i,a){if(i.constantHeight!=null)return this.computeBiasedHeight(i.constantHeight,a)}pointElevation(i,a,h){const f=this.constantElevation(a,h);return f??(i.x=i.x*this.zScale+this.xOffset,i.y=i.y*this.zScale+this.yOffset,this.computeBiasedHeight(a.pointElevation(i),h))}computeBiasedHeight(i,a){return a<=0?i:i+a*it(0,a,i>=0?i:Math.abs(.5*i))}}en(yo,"ElevationFeature");class Js{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=i.index,this.hasPattern=!1,this.projection=i.projection,this.layoutVertexArray=new Md,this.indexArray=new bs,this.segments=new ro,this.programConfigurations=new Ic(i.layers,{zoom:i.zoom,lut:i.lut}),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.elevationMode=this.layers[0].layout.get("circle-elevation-reference"),this.hasElevation=!1,this.elevationMode!=="none"&&(this.elevatedLayoutVertexArray=new Dd),this.worldview=i.worldview}updateFootprints(i,a){}populate(i,a,h,f){const _=this.layers[0],y=[];let x=null;_.type==="circle"&&(x=_.layout.get("circle-sort-key"));for(const{feature:I,id:R,index:P,sourceLayerIndex:L}of i){const $=this.layers[0]._featureFilter.needGeometry,j=Lt(I,$);if(!this.layers[0]._featureFilter.filter(new Tr(this.zoom,{worldview:this.worldview}),j,h))continue;const q=x?x.evaluate(j,{},h):void 0,Z={id:R,properties:I.properties,type:I.type,sourceLayerIndex:L,index:P,geometry:$?j.geometry:rn(I,h,f),patterns:{},sortKey:q};y.push(Z)}x&&y.sort((I,R)=>I.sortKey-R.sortKey);let C=null;f.projection.name==="globe"&&(this.globeExtVertexArray=new Xg,C=f.projection);for(const I of y){const{geometry:R,index:P,sourceLayerIndex:L}=I,$=i[P].feature;this.addFeature(I,R,P,a.availableImages,h,C,a.brightness,a.elevationFeatures),a.featureIndex.insert($,R,P,L,this.index)}this.hasElevation||(this.elevatedLayoutVertexArray=void 0)}update(i,a,h,f,_,y,x){this.programConfigurations.updatePaintArrays(i,a,_,h,f,y,x,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,QS.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,tC.members)),this.elevatedLayoutVertexArray&&(this.elevatedLayoutVertexBuffer=i.createVertexBuffer(this.elevatedLayoutVertexArray,eC.members))),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy())}addFeature(i,a,h,f,_,y,x,C){let I;this.elevationMode!=="none"&&(I=Yr.getElevationFeature(i,C));for(const R of a)for(const P of R){const L=P.x,$=P.y;if(L<0||L>=Ut||$<0||$>=Ut)continue;if(y){const Z=y.projectTilePoint(L,$,_),K=y.upVector(_,L,$);this.addGlobeExtVertex(Z,K),this.addGlobeExtVertex(Z,K),this.addGlobeExtVertex(Z,K),this.addGlobeExtVertex(Z,K)}const j=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),q=j.vertexLength;if(this.addCircleVertex(L,$,-1,-1),this.addCircleVertex(L,$,1,-1),this.addCircleVertex(L,$,1,1),this.addCircleVertex(L,$,-1,1),this.elevationMode!=="none"){const Z=I?I.pointElevation(new Dt(L,$)):0;this.hasElevation=this.hasElevation||Z!==0;for(let K=0;K<4;K++)this.elevatedLayoutVertexArray.emplaceBack(Z)}this.indexArray.emplaceBack(q,q+1,q+2),this.indexArray.emplaceBack(q,q+2,q+3),j.vertexLength+=4,j.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,{},f,_,x,void 0,this.worldview)}addCircleVertex(i,a,h,f){this.layoutVertexArray.emplaceBack(2*i+(h+1)/2,2*a+(f+1)/2)}addGlobeExtVertex(i,a){this.globeExtVertexArray.emplaceBack(i.x,i.y,i.z,a[0]*16384,a[1]*16384,a[2]*16384)}}function Dl(l,i){for(let a=0;a<l.length;a++)if(Os(i,l[a]))return!0;for(let a=0;a<i.length;a++)if(Os(l,i[a]))return!0;return!!Pa(l,i)}function Ol(l,i,a){return!!Os(l,i)||!!Mo(i,l,a)}function ol(l,i){if(l.length===1)return fs(i,l[0]);for(let a=0;a<i.length;a++){const h=i[a];for(let f=0;f<h.length;f++)if(Os(l,h[f]))return!0}for(let a=0;a<l.length;a++)if(fs(i,l[a]))return!0;for(let a=0;a<i.length;a++)if(Pa(l,i[a]))return!0;return!1}function sl(l,i,a){if(l.length>1){if(Pa(l,i))return!0;for(let h=0;h<i.length;h++)if(Mo(i[h],l,a))return!0}for(let h=0;h<l.length;h++)if(Mo(l[h],i,a))return!0;return!1}function Pa(l,i){if(l.length===0||i.length===0)return!1;for(let a=0;a<l.length-1;a++){const h=l[a],f=l[a+1];for(let _=0;_<i.length-1;_++)if(sc(h,f,i[_],i[_+1]))return!0}return!1}function sc(l,i,a,h){return cr(l,a,h)!==cr(i,a,h)&&cr(l,i,a)!==cr(l,i,h)}function Ac(l,i,a){return(l.x-a.x)*(i.y-a.y)-(l.y-a.y)*(i.x-a.x)}function To(l,i,a,h){const f=Ac(l,i,h),_=Ac(l,i,a);if(Math.sign(f)===Math.sign(_))return;const y=Ac(a,h,l),x=y+_-f;return Math.sign(y)!==Math.sign(x)?[y/(y-x),_/(_-f)]:void 0}function Mo(l,i,a){const h=a*a;if(i.length===1)return l.distSqr(i[0])<h;for(let f=1;f<i.length;f++)if(Jr(l,i[f-1],i[f])<h)return!0;return!1}function Jr(l,i,a){const h=i.distSqr(a);if(h===0)return l.distSqr(i);const f=((l.x-i.x)*(a.x-i.x)+(l.y-i.y)*(a.y-i.y))/h;return l.distSqr(f<0?i:f>1?a:a.sub(i)._mult(f)._add(i))}function fs(l,i){let a,h,f,_=!1;for(let y=0;y<l.length;y++){a=l[y];for(let x=0,C=a.length-1;x<a.length;C=x++)h=a[x],f=a[C],h.y>i.y!=f.y>i.y&&i.x<(f.x-h.x)*(i.y-h.y)/(f.y-h.y)+h.x&&(_=!_)}return _}function Os(l,i){let a=!1;for(let h=0,f=l.length-1;h<l.length;f=h++){const _=l[h],y=l[f];_.y>i.y!=y.y>i.y&&i.x<(y.x-_.x)*(i.y-_.y)/(y.y-_.y)+_.x&&(a=!a)}return a}function Go(l,i,a,h,f){for(const y of l)if(i<=y.x&&a<=y.y&&h>=y.x&&f>=y.y)return!0;const _=[new Dt(i,a),new Dt(i,f),new Dt(h,f),new Dt(h,a)];if(l.length>2){for(const y of _)if(Os(l,y))return!0}for(let y=0;y<l.length-1;y++)if(aa(l[y],l[y+1],_))return!0;return!1}function aa(l,i,a){const h=a[0],f=a[2];if(l.x<h.x&&i.x<h.x||l.x>f.x&&i.x>f.x||l.y<h.y&&i.y<h.y||l.y>f.y&&i.y>f.y)return!1;const _=cr(l,i,a[0]);return _!==cr(l,i,a[1])||_!==cr(l,i,a[2])||_!==cr(l,i,a[3])}function lu(l,i,a,h,f,_){let y=i.y-l.y,x=l.x-i.x;if(_=_||0){const C=y*y+x*x;if(C===0)return!0;const I=Math.sqrt(C);y/=I,x/=I}return!((a.x-l.x)*y+(a.y-l.y)*x-_<0||(h.x-l.x)*y+(h.y-l.y)*x-_<0||(f.x-l.x)*y+(f.y-l.y)*x-_<0)}function Gu(l,i,a,h,f,_,y){return!(lu(l,i,h,f,_,y)||lu(i,a,h,f,_,y)||lu(a,l,h,f,_,y)||lu(h,f,l,i,a,y)||lu(f,_,l,i,a,y)||lu(_,h,l,i,a,y))}function kc(l,i,a){const h=i.paint.get(l).value;return h.kind==="constant"?h.value:a.programConfigurations.get(i.id).getMaxValue(l)}function zd(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function Bd(l,i,a,h,f){if(!i[0]&&!i[1])return l;const _=Dt.convert(i)._mult(f);a==="viewport"&&_._rotate(-h);const y=[];for(let x=0;x<l.length;x++)y.push(l[x].sub(_));return y}function cu(l,i,a,h){const f=Dt.convert(l)._mult(h);return i==="viewport"&&f._rotate(-a),f}let Yf,Wu;function uu(l,i,a){var h=2*Math.PI*6378137/256/Math.pow(2,a);return[l*h-2*Math.PI*6378137/2,i*h-2*Math.PI*6378137/2]}en(Js,"CircleBucket",{omit:["layers"]});class qu{constructor(i,a,h){this.z=i,this.x=a,this.y=h,this.key=s_(0,i,i,a,h)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}isChildOf(i){const a=this.z-i.z;return i.z===0||i.z<this.z&&i.x===this.x>>a&&i.y===this.y>>a}url(i,a){const h=function(_,y,x){var C=uu(256*_,256*(y=Math.pow(2,x)-y-1),x),I=uu(256*(_+1),256*(y+1),x);return C[0]+","+C[1]+","+I[0]+","+I[1]}(this.x,this.y,this.z),f=function(_,y,x){let C,I="";for(let R=_;R>0;R--)C=1<<R-1,I+=(y&C?1:0)+(x&C?2:0);return I}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(a==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",f).replace("{bbox-epsg-3857}",h)}toString(){return`${this.z}/${this.x}/${this.y}`}}class o_{constructor(i,a){this.wrap=i,this.canonical=a,this.key=s_(i,a.z,a.z,a.x,a.y)}}class Ma{constructor(i,a,h,f,_){this.overscaledZ=i,this.wrap=a,this.canonical=new qu(h,+f,+_),this.key=a===0&&i===h?this.canonical.key:s_(a,i,h,f,_)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){const a=this.canonical.z-i;return i>this.canonical.z?new Ma(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ma(i,this.wrap,i,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(i,a=!0){if(this.overscaledZ===i&&a)return this.key;if(i>this.canonical.z)return s_(this.wrap*+a,i,this.canonical.z,this.canonical.x,this.canonical.y);{const h=this.canonical.z-i;return s_(this.wrap*+a,i,i,this.canonical.x>>h,this.canonical.y>>h)}}isChildOf(i){if(i.wrap!==this.wrap)return!1;const a=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.z<this.canonical.z&&i.canonical.x===this.canonical.x>>a&&i.canonical.y===this.canonical.y>>a}children(i){if(this.overscaledZ>=i)return[new Ma(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,h=2*this.canonical.x,f=2*this.canonical.y;return[new Ma(a,this.wrap,a,h,f),new Ma(a,this.wrap,a,h+1,f),new Ma(a,this.wrap,a,h,f+1),new Ma(a,this.wrap,a,h+1,f+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new Ma(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new Ma(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new o_(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function s_(l,i,a,h,f){const _=1<<Math.min(a,22);let y=_*(f%_)+h%_;return l&&a<22&&(y+=_*_*((l<0?-2*l-1:2*l)%(1<<2*(22-a)))),16*(32*y+a)+(i-a)}const p7=[l=>{let i=l.canonical.x-1,a=l.wrap;return i<0&&(i=(1<<l.canonical.z)-1,a--),new Ma(l.overscaledZ,a,l.canonical.z,i,l.canonical.y)},l=>{let i=l.canonical.x+1,a=l.wrap;return i===1<<l.canonical.z&&(i=0,a++),new Ma(l.overscaledZ,a,l.canonical.z,i,l.canonical.y)},l=>new Ma(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,(l.canonical.y===0?1<<l.canonical.z:l.canonical.y)-1),l=>new Ma(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,l.canonical.y===(1<<l.canonical.z)-1?0:l.canonical.y+1)];en(qu,"CanonicalTileID"),en(Ma,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const m7=ki([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:c1}=m7,g7=ki([{name:"a_pos_3",components:3,type:"Int16"}]);var GA=ki([{name:"a_pos",type:"Int16",components:2}]);function u1(l){return l*m/H}const _7=[new Vn([O,O,O],[z,z,z]),new Vn([O,O,O],[0,0,z]),new Vn([0,O,O],[z,0,z]),new Vn([O,0,O],[0,z,z]),new Vn([0,0,O],[z,z,z])];function WA(l,i,a,h=!0){const f=Pt([],l._camera.position,l.worldSize),_=[i,a,1,1];dn(_,_,l.pixelMatrixInverse),fn(_,_,1/_[3]);const y=ai([],Gt([],_,f)),x=l.globeMatrix,C=[x[12],x[13],x[14]],I=Gt([],C,f),R=Re(I),P=ai([],I),L=l.worldSize/(2*Math.PI),$=Ft(P,y),j=Math.asin(L/R);if(j<Math.acos($)){if(!h)return null;const _t=[],Je=[];Pt(_t,y,R/$),ai(Je,Gt(Je,_t,I)),ai(y,on(y,I,Pt(y,Je,Math.tan(j)*R)))}const q=[];new qi(f,y).closestPointOnSphere(C,L,q);const Z=ai([],Pr(x,0)),K=ai([],Pr(x,1)),ae=ai([],Pr(x,2)),ue=Ft(Z,q),fe=Ft(K,q),Me=Ft(ae,q),De=Y(Math.asin(-fe/L));let Ve=Y(Math.atan2(ue,Me));Ve=l.center.lng+function(_t,Je){const bt=(Je-_t+180)%360-180;return bt<-180?bt+360:bt}(l.center.lng,Ve);const He=pe(Ve),Ze=Le(Ie(De),0,1);return new ut(He,Ze)}class y7{constructor(i,a,h){this.a=Gt([],i,h),this.b=Gt([],a,h),this.center=h;const f=ai([],this.a),_=ai([],this.b);this.angle=Math.acos(Ft(f,_))}}function aC(l,i){if(l.angle===0)return null;let a;return a=l.a[i]===0?1/l.angle*.5*Math.PI:1/l.angle*Math.atan(l.b[i]/l.a[i]/Math.sin(l.angle)-1/Math.tan(l.angle)),a<0||a>1?null:function(h,f,_,y){const x=Math.sin(_);return h*(Math.sin((1-y)*_)/x)+f*(Math.sin(y*_)/x)}(l.a[i],l.b[i],l.angle,Le(a,0,1))+l.center[i]}function Fd(l){if(l.z<=1)return _7[l.z+2*l.y+l.x];const i=lC(d1(l));return Vn.fromPoints(i)}function Dh(l,i,a){return Pt(l,l,1-a),Di(l,l,i,a)}function qA(l,i,a){for(const h of l)kn(h,h,i),Pt(h,h,a)}function ZA(l,i,a,h){const f=i/l.worldSize,_=l.globeMatrix;if(a.z<=1){const Ze=Fd(a).getCorners();return qA(Ze,_,f),Vn.fromPoints(Ze)}const y=d1(a,h),x=lC(y,m+u1(l._tileCoverLift));qA(x,_,f);const C=Number.MAX_VALUE,I=[-C,-C,-C],R=[C,C,C];if(y.contains(l.center)){for(const Je of x)Ri(R,R,Je),zi(I,I,Je);I[2]=0;const Ze=l.point,_t=[Ze.x*f,Ze.y*f,0];return Ri(R,R,_t),zi(I,I,_t),new Vn(R,I)}if(l._tileCoverLift>0){for(const Ze of x)Ri(R,R,Ze),zi(I,I,Ze);return new Vn(R,I)}const P=[_[12]*f,_[13]*f,_[14]*f],L=y.getCenter(),$=Le(l.center.lat,-ke,ke),j=Le(L.lat,-ke,ke),q=pe(l.center.lng),Z=Ie($);let K=q-pe(L.lng);const ae=Z-Ie(j);K>.5?K-=1:K<-.5&&(K+=1);let ue=0;Math.abs(K)>Math.abs(ae)?ue=K>=0?1:3:(ue=ae>=0?0:2,Di(P,P,[_[4]*f,_[5]*f,_[6]*f],-Math.sin(Xe(ae>=0?y.getSouth():y.getNorth()))*m));const fe=x[ue],Me=x[(ue+1)%4],De=new y7(fe,Me,P),Ve=[aC(De,0)||fe[0],aC(De,1)||fe[1],aC(De,2)||fe[2]],He=Jf(l.zoom);if(He>0){const Ze=function({x:Je,y:bt,z:Mt},Tt,It,zt,mt){const At=1/(1<<Mt);let ct=Je*At,rt=ct+At,Bt=bt*At,Ot=Bt+At,En=0;const ln=(ct+rt)/2-zt;return ln>.5?En=-1:ln<-.5&&(En=1),ct=((ct+En)*Tt-(zt*=Tt))*It+zt,rt=((rt+En)*Tt-zt)*It+zt,Bt=(Bt*Tt-(mt*=Tt))*It+mt,Ot=(Ot*Tt-mt)*It+mt,[[ct,Ot,0],[rt,Ot,0],[rt,Bt,0],[ct,Bt,0]]}(a,i,l._pixelsPerMercatorPixel,q,Z);for(let Je=0;Je<x.length;Je++)Dh(x[Je],Ze[Je],He);const _t=on([],Ze[ue],Ze[(ue+1)%4]);Pt(_t,_t,.5),Dh(Ve,_t,He)}for(const Ze of x)Ri(R,R,Ze),zi(I,I,Ze);return R[2]=Math.min(fe[2],Me[2]),Ri(R,R,Ve),zi(I,I,Ve),new Vn(R,I)}function d1({x:l,y:i,z:a},h=!1){const f=1/(1<<a),_=new W(Ae(l*f),i===(1<<a)-1&&h?-90:Ce((i+1)*f)),y=new W(Ae((l+1)*f),i===0&&h?90:Ce(i*f));return new ne(_,y)}function lC(l,i=m){const a=Xe(l.getNorth()),h=Xe(l.getSouth()),f=Math.cos(a),_=Math.cos(h),y=Math.sin(a),x=Math.sin(h),C=l.getWest(),I=l.getEast();return[U(_,x,C,i),U(_,x,I,i),U(f,y,I,i),U(f,y,C,i)]}function Ky(l,i,a,h){const f=1<<a.z,_=(l/Ut+a.x)/f;return F(Ce((i/Ut+a.y)/f),Ae(_),h)}function h1({min:l,max:i}){return S/Math.max(i[0]-l[0],i[1]-l[1],i[2]-l[2])}const KA=new Float64Array(16);function f1(l){const i=h1(l),a=oe(KA,[i,i,i]);return be(a,a,Br([],l.min))}function cC(l){const i=(h=l.min,(a=KA)[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=h[0],a[13]=h[1],a[14]=h[2],a[15]=1,a);var a,h;const f=1/h1(l);return ze(i,i,[f,f,f])}function uC(l){const i=Ut/(2*Math.PI);return l/(2*Math.PI)/i}function XA(l,i){return Ut/(512*Math.pow(2,l))*h1(Fd(i))}function YA(l,i,a,h,f){const _=uC(a),y=[l,i,-a/(2*Math.PI)],x=Q(new Float64Array(16));return be(x,x,y),ze(x,x,[_,_,_]),xe(x,x,Xe(-f)),je(x,x,Xe(-h)),x}function Jf(l){return it(v,b,l)}function JA(l,i){const a=F(i.lat,i.lng),h=function(j){const q=F(j._center.lat,j._center.lng);let Z=In([],tn(0,1,0),q);const K=de([],-j.angle,q);Z=kn(Z,Z,K),de(K,-j._pitch,Z);const ae=ai([],q);return Pt(ae,ae,u1(j.cameraToCenterDistance/j.pixelsPerMeter)),kn(ae,ae,K),on([],q,ae)}(l);return y=(f=hn([],h,a))[0],x=f[1],C=f[2],I=(_=a)[0],R=_[1],P=_[2],$=(L=Math.sqrt((y*y+x*x+C*C)*(I*I+R*R+P*P)))&&Ft(f,_)/L,Math.acos(Math.min(Math.max($,-1),1));var f,_,y,x,C,I,R,P,L,$}function dC(l,i){return JA(l,i)>Math.PI/2*1.01}const QA=Xe(85),v7=Math.cos(QA),b7=Math.sin(QA),x7=ee(),ek=l=>{const i=[];return l.paint.get("circle-pitch-alignment")==="map"&&i.push("PITCH_WITH_MAP"),l.paint.get("circle-pitch-scale")==="map"&&i.push("SCALE_WITH_MAP"),i};function tk(l,i,a,h,f,_,y,x,C){if(_&&l.queryGeometry.isAboveHorizon)return!1;_&&(C*=l.pixelToTileUnitsFactor);const I=l.tileID.canonical,R=a.projection.upVectorScale(I,a.center.lat,a.worldSize).metersToTile;for(const P of i)for(const L of P){const $=L.add(x),j=f&&a.elevation?a.elevation.exaggeration()*f.getElevationAt($.x,$.y,!0):0,q=a.projection.projectTilePoint($.x,$.y,I);if(j>0){const ue=a.projection.upVector(I,$.x,$.y);q.x+=ue[0]*R*j,q.y+=ue[1]*R*j,q.z+=ue[2]*R*j}const Z=_?$:w7(q.x,q.y,q.z,h),K=_?l.tilespaceRays.map(ue=>C7(ue,j)):l.queryGeometry.screenGeometry,ae=dn([],[q.x,q.y,q.z,1],h);if(!y&&_?C*=ae[3]/a.cameraToCenterDistance:y&&!_&&(C*=a.cameraToCenterDistance/ae[3]),_){const ue=Ce((L.y/Ut+I.y)/(1<<I.z));C/=a.projection.pixelsPerMeter(ue,1)/Se(1,ue)}if(Ol(K,Z,C))return!0}return!1}function w7(l,i,a,h){const f=dn([],[l,i,a,1],h);return new Dt(f[0]/f[3],f[1]/f[3])}const nk=tn(0,0,0),S7=tn(0,0,1);function C7(l,i){const a=me();return nk[2]=i,l.intersectsPlane(nk,S7,a),new Dt(a[0],a[1])}class ik extends Js{}let rk,ok,sk,ak;function lk(l,{width:i,height:a},h,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==i*a*h)throw new RangeError("mismatched image size")}else f=new Uint8Array(i*a*h);return l.width=i,l.height=a,l.data=f,l}function ck(l,i,a){const{width:h,height:f}=i;h===l.width&&f===l.height||(hC(l,i,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,h),height:Math.min(l.height,f)},a,null),l.width=h,l.height=f,l.data=i.data)}function hC(l,i,a,h,f,_,y,x){if(f.width===0||f.height===0)return i;if(f.width>l.width||f.height>l.height||a.x>l.width-f.width||a.y>l.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>i.width||f.height>i.height||h.x>i.width-f.width||h.y>i.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const C=l.data,I=i.data,R=_===4&&x;for(let P=0;P<f.height;P++){const L=((a.y+P)*l.width+a.x)*_,$=((h.y+P)*i.width+h.x)*_;if(R)for(let j=0;j<f.width;j++){const q=L+j*_+3,Z=$+j*_;I[Z+0]=255,I[Z+1]=255,I[Z+2]=255,I[Z+3]=C[q]}else if(y)for(let j=0;j<f.width;j++){const q=L+j*_,Z=$+j*_,K=new Bi(C[q+0]/255,C[q+1]/255,C[q+2]/255,C[q+3]).toNonPremultipliedRenderColor(y).toArray();I[Z+0]=K[0],I[Z+1]=K[1],I[Z+2]=K[2],I[Z+3]=K[3]}else for(let j=0;j<f.width*_;j++)I[$+j]=C[L+j]}return i}en(ik,"HeatmapBucket",{omit:["layers"]});class Qf{constructor(i,a){lk(this,i,1,a)}resize(i){ck(this,new Qf(i),1)}clone(){return new Qf({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,a,h,f,_){hC(i,a,h,f,_,1,null)}}class la{constructor(i,a){lk(this,i,4,a)}resize(i){ck(this,new la(i),4)}replace(i,a){a?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new la({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,a,h,f,_,y,x){hC(i,a,h,f,_,4,y,x)}}class uk{constructor(i,a){this.width=i.width,this.height=i.height,this.data=a instanceof Uint8Array?new Float32Array(a.buffer):a}}function Xy(l){const i={},a=l.resolution||256,h=l.clips?l.clips.length:1,f=l.image||new la({width:a,height:h}),_=(y,x,C)=>{i[l.evaluationKey]=C;const I=l.expression.evaluate(i),R=I?I.toNonPremultipliedRenderColor(null):null;R&&(f.data[y+x+0]=Math.floor(255*R.r),f.data[y+x+1]=Math.floor(255*R.g),f.data[y+x+2]=Math.floor(255*R.b),f.data[y+x+3]=Math.floor(255*R.a))};if(l.clips)for(let y=0,x=0;y<h;++y,x+=4*a)for(let C=0,I=0;C<a;C++,I+=4){const R=C/(a-1),{start:P,end:L}=l.clips[y];_(x,I,P*(1-R)+L*R)}else for(let y=0,x=0;y<a;y++,x+=4)_(0,x,y/(a-1));return f}en(Qf,"AlphaImage"),en(la,"RGBAImage");const T7=ki([{name:"a_pos",components:2,type:"Int16"}],4),E7=ki([{name:"a_road_z_offset",components:1,type:"Float32"}],4),I7=ki([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),A7=ki([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function a_(l,i,a=2){const h=i&&i.length,f=h?i[0]*a:l.length;let _=dk(l,0,f,a,!0);const y=[];if(!_||_.next===_.prev)return y;let x,C,I;if(h&&(_=function(R,P,L,$){const j=[];for(let q=0,Z=P.length;q<Z;q++){const K=dk(R,P[q]*$,q<Z-1?P[q+1]*$:R.length,$,!1);K===K.next&&(K.steiner=!0),j.push(z7(K))}j.sort(D7);for(let q=0;q<j.length;q++)L=O7(j[q],L);return L}(l,i,_,a)),l.length>80*a){x=l[0],C=l[1];let R=x,P=C;for(let L=a;L<f;L+=a){const $=l[L],j=l[L+1];$<x&&(x=$),j<C&&(C=j),$>R&&(R=$),j>P&&(P=j)}I=Math.max(R-x,P-C),I=I!==0?32767/I:0}return Yy(_,y,a,x,C,I,0),y}function dk(l,i,a,h,f){let _;if(f===function(y,x,C,I){let R=0;for(let P=x,L=C-I;P<C;P+=I)R+=(y[L]-y[P])*(y[P+1]+y[L+1]),L=P;return R}(l,i,a,h)>0)for(let y=i;y<a;y+=h)_=mk(y/h|0,l[y],l[y+1],_);else for(let y=a-h;y>=i;y-=h)_=mk(y/h|0,l[y],l[y+1],_);return _&&l_(_,_.next)&&(ev(_),_=_.next),_}function Im(l,i){if(!l)return l;i||(i=l);let a,h=l;do if(a=!1,h.steiner||!l_(h,h.next)&&Ws(h.prev,h,h.next)!==0)h=h.next;else{if(ev(h),h=i=h.prev,h===h.next)break;a=!0}while(a||h!==i);return i}function Yy(l,i,a,h,f,_,y){if(!l)return;!y&&_&&function(C,I,R,P){let L=C;do L.z===0&&(L.z=fC(L.x,L.y,I,R,P)),L.prevZ=L.prev,L.nextZ=L.next,L=L.next;while(L!==C);L.prevZ.nextZ=null,L.prevZ=null,function($){let j,q=1;do{let Z,K=$;$=null;let ae=null;for(j=0;K;){j++;let ue=K,fe=0;for(let De=0;De<q&&(fe++,ue=ue.nextZ,ue);De++);let Me=q;for(;fe>0||Me>0&&ue;)fe!==0&&(Me===0||!ue||K.z<=ue.z)?(Z=K,K=K.nextZ,fe--):(Z=ue,ue=ue.nextZ,Me--),ae?ae.nextZ=Z:$=Z,Z.prevZ=ae,ae=Z;K=ue}ae.nextZ=null,q*=2}while(j>1)}(L)}(l,h,f,_);let x=l;for(;l.prev!==l.next;){const C=l.prev,I=l.next;if(_?R7(l,h,f,_):k7(l))i.push(C.i,l.i,I.i),ev(l),l=I.next,x=I.next;else if((l=I)===x){y?y===1?Yy(l=P7(Im(l),i),i,a,h,f,_,2):y===2&&M7(l,i,a,h,f,_):Yy(Im(l),i,a,h,f,_,1);break}}}function k7(l){const i=l.prev,a=l,h=l.next;if(Ws(i,a,h)>=0)return!1;const f=i.x,_=a.x,y=h.x,x=i.y,C=a.y,I=h.y,R=Math.min(f,_,y),P=Math.min(x,C,I),L=Math.max(f,_,y),$=Math.max(x,C,I);let j=h.next;for(;j!==i;){if(j.x>=R&&j.x<=L&&j.y>=P&&j.y<=$&&Jy(f,x,_,C,y,I,j.x,j.y)&&Ws(j.prev,j,j.next)>=0)return!1;j=j.next}return!0}function R7(l,i,a,h){const f=l.prev,_=l,y=l.next;if(Ws(f,_,y)>=0)return!1;const x=f.x,C=_.x,I=y.x,R=f.y,P=_.y,L=y.y,$=Math.min(x,C,I),j=Math.min(R,P,L),q=Math.max(x,C,I),Z=Math.max(R,P,L),K=fC($,j,i,a,h),ae=fC(q,Z,i,a,h);let ue=l.prevZ,fe=l.nextZ;for(;ue&&ue.z>=K&&fe&&fe.z<=ae;){if(ue.x>=$&&ue.x<=q&&ue.y>=j&&ue.y<=Z&&ue!==f&&ue!==y&&Jy(x,R,C,P,I,L,ue.x,ue.y)&&Ws(ue.prev,ue,ue.next)>=0||(ue=ue.prevZ,fe.x>=$&&fe.x<=q&&fe.y>=j&&fe.y<=Z&&fe!==f&&fe!==y&&Jy(x,R,C,P,I,L,fe.x,fe.y)&&Ws(fe.prev,fe,fe.next)>=0))return!1;fe=fe.nextZ}for(;ue&&ue.z>=K;){if(ue.x>=$&&ue.x<=q&&ue.y>=j&&ue.y<=Z&&ue!==f&&ue!==y&&Jy(x,R,C,P,I,L,ue.x,ue.y)&&Ws(ue.prev,ue,ue.next)>=0)return!1;ue=ue.prevZ}for(;fe&&fe.z<=ae;){if(fe.x>=$&&fe.x<=q&&fe.y>=j&&fe.y<=Z&&fe!==f&&fe!==y&&Jy(x,R,C,P,I,L,fe.x,fe.y)&&Ws(fe.prev,fe,fe.next)>=0)return!1;fe=fe.nextZ}return!0}function P7(l,i){let a=l;do{const h=a.prev,f=a.next.next;!l_(h,f)&&fk(h,a,a.next,f)&&Qy(h,f)&&Qy(f,h)&&(i.push(h.i,a.i,f.i),ev(a),ev(a.next),a=l=f),a=a.next}while(a!==l);return Im(a)}function M7(l,i,a,h,f,_){let y=l;do{let x=y.next.next;for(;x!==y.prev;){if(y.i!==x.i&&B7(y,x)){let C=pk(y,x);return y=Im(y,y.next),C=Im(C,C.next),Yy(y,i,a,h,f,_,0),void Yy(C,i,a,h,f,_,0)}x=x.next}y=y.next}while(y!==l)}function D7(l,i){let a=l.x-i.x;return a===0&&(a=l.y-i.y,a===0)&&(a=(l.next.y-l.y)/(l.next.x-l.x)-(i.next.y-i.y)/(i.next.x-i.x)),a}function O7(l,i){const a=function(f,_){let y=_;const x=f.x,C=f.y;let I,R=-1/0;if(l_(f,y))return y;do{if(l_(f,y.next))return y.next;if(C<=y.y&&C>=y.next.y&&y.next.y!==y.y){const q=y.x+(C-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if(q<=x&&q>R&&(R=q,I=y.x<y.next.x?y:y.next,q===x))return I}y=y.next}while(y!==_);if(!I)return null;const P=I,L=I.x,$=I.y;let j=1/0;y=I;do{if(x>=y.x&&y.x>=L&&x!==y.x&&hk(C<$?x:R,C,L,$,C<$?R:x,C,y.x,y.y)){const q=Math.abs(C-y.y)/(x-y.x);Qy(y,f)&&(q<j||q===j&&(y.x>I.x||y.x===I.x&&L7(I,y)))&&(I=y,j=q)}y=y.next}while(y!==P);return I}(l,i);if(!a)return i;const h=pk(a,l);return Im(h,h.next),Im(a,a.next)}function L7(l,i){return Ws(l.prev,l,i.prev)<0&&Ws(i.next,l,l.next)<0}function fC(l,i,a,h,f){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-a)*f|0)|l<<8))|l<<4))|l<<2))|l<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-h)*f|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function z7(l){let i=l,a=l;do(i.x<a.x||i.x===a.x&&i.y<a.y)&&(a=i),i=i.next;while(i!==l);return a}function hk(l,i,a,h,f,_,y,x){return(f-y)*(i-x)>=(l-y)*(_-x)&&(l-y)*(h-x)>=(a-y)*(i-x)&&(a-y)*(_-x)>=(f-y)*(h-x)}function Jy(l,i,a,h,f,_,y,x){return!(l===y&&i===x)&&hk(l,i,a,h,f,_,y,x)}function B7(l,i){return l.next.i!==i.i&&l.prev.i!==i.i&&!function(a,h){let f=a;do{if(f.i!==a.i&&f.next.i!==a.i&&f.i!==h.i&&f.next.i!==h.i&&fk(f,f.next,a,h))return!0;f=f.next}while(f!==a);return!1}(l,i)&&(Qy(l,i)&&Qy(i,l)&&function(a,h){let f=a,_=!1;const y=(a.x+h.x)/2,x=(a.y+h.y)/2;do f.y>x!=f.next.y>x&&f.next.y!==f.y&&y<(f.next.x-f.x)*(x-f.y)/(f.next.y-f.y)+f.x&&(_=!_),f=f.next;while(f!==a);return _}(l,i)&&(Ws(l.prev,l,i.prev)||Ws(l,i.prev,i))||l_(l,i)&&Ws(l.prev,l,l.next)>0&&Ws(i.prev,i,i.next)>0)}function Ws(l,i,a){return(i.y-l.y)*(a.x-i.x)-(i.x-l.x)*(a.y-i.y)}function l_(l,i){return l.x===i.x&&l.y===i.y}function fk(l,i,a,h){const f=m1(Ws(l,i,a)),_=m1(Ws(l,i,h)),y=m1(Ws(a,h,l)),x=m1(Ws(a,h,i));return f!==_&&y!==x||!(f!==0||!p1(l,a,i))||!(_!==0||!p1(l,h,i))||!(y!==0||!p1(a,l,h))||!(x!==0||!p1(a,i,h))}function p1(l,i,a){return i.x<=Math.max(l.x,a.x)&&i.x>=Math.min(l.x,a.x)&&i.y<=Math.max(l.y,a.y)&&i.y>=Math.min(l.y,a.y)}function m1(l){return l>0?1:l<0?-1:0}function Qy(l,i){return Ws(l.prev,l,l.next)<0?Ws(l,i,l.next)>=0&&Ws(l,l.prev,i)>=0:Ws(l,i,l.prev)<0||Ws(l,l.next,i)<0}function pk(l,i){const a=pC(l.i,l.x,l.y),h=pC(i.i,i.x,i.y),f=l.next,_=i.prev;return l.next=i,i.prev=l,a.next=f,f.prev=a,h.next=a,a.prev=h,_.next=h,h.prev=_,h}function mk(l,i,a,h){const f=pC(l,i,a);return h?(f.next=h.next,f.prev=h,h.next.prev=f,h.next=f):(f.prev=f,f.next=f),f}function ev(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function pC(l,i,a){return{i:l,x:i,y:a,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function tv(l,i){const a=l.length;if(a<=1)return[l];const h=[];let f,_;for(let y=0;y<a;y++){const x=Fr(l[y]);x!==0&&(l[y].area=Math.abs(x),_===void 0&&(_=x<0),_===x<0?(f&&h.push(f),f=[l[y]]):f.push(l[y]))}if(f&&h.push(f),i>1)for(let y=0;y<h.length;y++)h[y].length<=i||(uh(h[y],i,1,h[y].length-1,F7),h[y]=h[y].slice(0,i));return h}function F7(l,i){return i.area-l.area}function gk(l,i,a=1){if(!l)return null;const h=typeof l=="string"?ks.from(l).getPrimary():l.getPrimary(),f=typeof l=="string"?null:l.getSecondary();for(const _ of[h,f]){if(!_)continue;const y=_.id.toString();i.has(y)||i.set(y,[]),_.scaleSelf(a),i.get(y).push(_)}return{primary:h.toString(),secondary:f?f.toString():null}}function mC(l,i,a,h){const f=h.patternDependencies;let _=!1;for(const y of i){const x=y.paint.get(`${l}-pattern`);x.isConstant()||(_=!0),gk(x.constantOr(null),f,a)&&(_=!0)}return _}function gC(l,i,a,h,f,_){const y=_.patternDependencies;for(const x of i){const C=x.paint.get(`${l}-pattern`).value;if(C.kind!=="constant"){let I=C.evaluate({zoom:h},a,{},_.availableImages);I=I&&I.name?I.name:I;const R=gk(I,y,f);if(!R)continue;const{primary:P,secondary:L}=R;P&&(a.patterns[x.id]=[P,L].filter(Boolean))}}return a}class _k{constructor(){this.polygons=new Map}add(i,...a){const h=this.polygons.get(i);h?h.push(...a):this.polygons.set(i,a)}merge(i){for(const[a,h]of i.polygons)this.add(a,...h)}}class Oh{constructor(){this.portals=[]}static isOnBorder(i,a){return i<=0&&a<=0||i>=Ut&&a>=Ut}static evaluate(i){if(i.length===0)return new Oh;let a=[];for(const C of i)a.push(...C.portals);if(a.length===0)return new Oh;for(const C of a){const I=C.va,R=C.vb;(Oh.isOnBorder(I.x,R.x)||Oh.isOnBorder(I.y,R.y))&&(C.type="border")}const h=a.filter(C=>C.type!=="unevaluated"),f=a.filter(C=>C.type==="unevaluated");if(f.length===0)return new Oh;f.sort((C,I)=>C.hash===I.hash?C.isTunnel===I.isTunnel?0:C.isTunnel?-1:1:C.hash<I.hash?1:-1),a=h.concat(f);let _=h.length,y=_,x=_;do if(y++,y===a.length||a[_].hash!==a[y].hash){if(y-_==2){x<_&&(a[x]=a[_],a[_]=null);const C=a[x],I=a[y-1];C.type=C.isTunnel!==I.isTunnel?"tunnel":"polygon",C.connection={a:C.connection.a,b:I.connection.a},x++}_=y}while(_!==a.length);return a.splice(x),a.sort((C,I)=>C.hash<I.hash?1:-1),{portals:a}}}en(Oh,"ElevationPortalGraph"),en(_k,"ElevationPolygons");class N7{constructor(i,a,h){this.outPositions=i,this.outNormals=a,this.outIndices=h,this.vertexLookup=new Map}addVertex(i,a,h){let f=i[2];h!=null&&(f*=h);const _=`${i[0]},${i[1]},${i[2]},${a[0]},${a[1]},${a[2]}`,y=this.vertexLookup.get(_);if(y!=null)return y;const x=this.outPositions.length;this.vertexLookup.set(_,x);const C=Math.trunc(16384*a[0]),I=Math.trunc(16384*a[1]),R=Math.trunc(16384*a[2]);return this.outPositions.emplaceBack(i[0],i[1],f),this.outNormals.emplaceBack(C,I,R),x}addTriangle(i,a,h){this.outIndices.emplaceBack(i,a,h)}addTriangles(i,a,h){if(i.length===0)return;const f=h.length===1,_=me(),y=me();for(let x=0;x<i.length;x+=3){const C=a[i[x+0]],I=a[i[x+1]],R=a[i[x+2]],P=f?h[0]:h[i[x+1]],L=f?h[0]:h[i[x+2]];Zt(_,C.x,C.y,f?h[0]:h[i[x+0]]);const $=this.addVertex(_,y);Zt(_,I.x,I.y,P);const j=this.addVertex(_,y);Zt(_,R.x,R.y,L);const q=this.addVertex(_,y);this.outIndices.emplaceBack($,j,q)}}addQuad(i,a,h,f,_,y){const x=this.addVertex(i,_,y),C=this.addVertex(a,_,y),I=this.addVertex(h,_,y),R=this.addVertex(f,_,y);this.addTriangle(x,C,I),this.addTriangle(I,R,x)}getVertexCount(){return this.outPositions.length}clearVertexLookup(){this.vertexLookup.clear()}}class Ll{constructor(i,a,h,f){this.unevaluatedPortals=new Oh,this.portalPolygons=new _k,this.bridgeFeatureSections=[],this.tunnelFeatureSections=[],this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new zy,this.vertexNormals=new Zg,this.indexArray=new bs,this.tileToMeters=et(i),this.bridgeProgramConfigurations=new Ic(a,{zoom:h,lut:f},_=>_!=="fill-tunnel-structure-color"),this.tunnelProgramConfigurations=new Ic(a,{zoom:h,lut:f},_=>_!=="fill-bridge-guard-rail-color")}addVertices(i,a){const h=this.unevalVertices.length;for(let f=0;f<i.length;f++)this.unevalVertices.push(i[f]),this.unevalHeights.push(a[f]);return h}addTriangles(i,a,h){const f=h?this.unevalTunnelTriangles:this.unevalTriangles;for(const _ of i)f.push(_+a)}addRenderableRing(i,a,h,f,_,y){const x=[new Dt(_.min.x,_.min.y),new Dt(_.max.x,_.min.y),new Dt(_.max.x,_.max.y),new Dt(_.min.x,_.max.y)];for(let C=0;C<h-1;C++){const I=a+C,R=I+1,P=this.unevalVertices[I],L=this.unevalVertices[R];if(!(P.x>=_.min.x&&P.x<=_.max.x&&P.y>=_.min.y&&P.y<=_.max.y||L.x>=_.min.x&&L.x<=_.max.x&&L.y>=_.min.y&&L.y<=_.max.y||aa(P,L,x))||this.isOnBorder(P.x,L.x)||this.isOnBorder(P.y,L.y))continue;const $=Ll.computeEdgeHash(this.unevalVertices[I],this.unevalVertices[R]);let j,q=this.vertexHashLookup.get(Ll.computePosHash(P));q!=null?j=q.next:(q=this.vertexHashLookup.get(Ll.computePosHash(L)),j=q!=null?q.prev:$),this.unevalEdges.push({polygonIdx:i,a:I,b:R,hash:$,portalHash:j,isTunnel:f,type:"unevaluated",featureInfo:y})}}addPortalCandidates(i,a,h,f,_){if(a.length===0)return;this.portalPolygons.add(i,{geometry:a,zLevel:_});const y=a[0];this.vertexHashLookup.clear();let x=Ll.computeEdgeHash(y[y.length-2],y[y.length-1]);for(let C=0;C<y.length-1;C++){const I=y[C+0],R=y[C+1],P=ho(R.x-I.x,R.y-I.y),L=Fa(P);if(L===0)continue;let $="unevaluated";const j=f.pointElevation(I),q=f.pointElevation(R);Math.abs(j)<.01&&Math.abs(q)<.01?$="entrance":(this.isOnBorder(I.x,R.x)||this.isOnBorder(I.y,R.y))&&($="border");const Z=Ll.computeEdgeHash(I,R);this.unevaluatedPortals.portals.push({connection:{a:i,b:void 0},va:I,vb:R,vab:P,length:L,hash:Z,isTunnel:h,type:$});const K=Ll.computePosHash(I);this.vertexHashLookup.set(K,{prev:x,next:Z}),x=Z}}construct(i){if(this.unevalVertices.length===0)return;const a=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),h=L=>{L.primitiveLength=this.indexArray.length-L.primitiveOffset},f=new N7(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(i.portals,this.unevalEdges);const _=a(),y=a(),x=a(),C=(L,$)=>{L.sort((q,Z)=>q.type===$&&Z.type!==$?-1:q.type!==$&&Z.type===$?1:0);const j=L.findIndex(q=>q.type!==$);return j>=0?j:L.length};let I=0;this.unevalEdges.length>0&&(I=C(this.unevalEdges,"none"),this.constructBridgeStructures(f,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:I},this.tileToMeters)),h(x);const R=a(),P=a();if(this.unevalEdges.length>0){const L=this.unevalEdges.splice(I),$=C(L,"tunnel")+I;this.unevalEdges.push(...L),this.constructTunnelStructures(f,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:I},{min:I,max:$})}h(R),f.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),h(P),f.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),h(y),f.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),h(_),this.maskSegments=ro.simpleSegment(0,P.primitiveOffset,0,P.primitiveLength),this.depthSegments=ro.simpleSegment(0,y.primitiveOffset,0,y.primitiveLength),this.renderableBridgeSegments=ro.simpleSegment(0,x.primitiveOffset,0,x.primitiveLength),this.renderableTunnelSegments=ro.simpleSegment(0,R.primitiveOffset,0,R.primitiveLength),this.shadowCasterSegments=ro.simpleSegment(0,_.primitiveOffset,0,_.primitiveLength)}update(i,a,h,f,_,y,x,C){this.bridgeProgramConfigurations.updatePaintArrays(i,a,_,h,f,y,x,C),this.tunnelProgramConfigurations.updatePaintArrays(i,a,_,h,f,y,x,C)}upload(i){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=i.createVertexBuffer(this.vertexPositions,I7.members),this.vertexBufferNormal=i.createVertexBuffer(this.vertexNormals,A7.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.bridgeProgramConfigurations.upload(i),this.tunnelProgramConfigurations.upload(i))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableBridgeSegments.destroy(),this.renderableTunnelSegments.destroy(),this.shadowCasterSegments.destroy()),this.bridgeProgramConfigurations.destroy(),this.tunnelProgramConfigurations.destroy()}populatePaintArrays(i,a,h,f,_){const y=(x,C)=>{for(let I=0;I<C.length-1;I++){const R=C[I].featureIndex,P=C[I+1].vertexStart,L=i.feature(R);x.populatePaintArrays(P,L,R,{},h,a,f,void 0,_)}};y(this.bridgeProgramConfigurations,this.bridgeFeatureSections),y(this.tunnelProgramConfigurations,this.tunnelFeatureSections)}computeVertexConnections(i,a,h,f,_){const y=new Map;for(let x=f;x<_;x++){const C=h[x],I=C.a,R=C.b,P=Ll.computePosHash(i[I]),L=Ll.computePosHash(i[R]);let $=y.get(P);$||($={},y.set(P,$));let j=y.get(L);j||(j={},y.set(L,j)),a[I]<=0&&a[R]<=0||($.to=R,j.from=I)}return y}isTerminalVertex(i,a){const h=Ll.computePosHash(this.unevalVertices[i]),f=a.get(h);return!f||!f.from||!f.to}constructBridgeStructures(i,a,h,f,_,y){i.clearVertexLookup();const x=this.computeVertexConnections(a,h,f,_.min,_.max),C=1/y,I=.5*C,R=(It,zt)=>Zt(It,a[zt].x,a[zt].y,h[zt]*C),P=me(),L=me(),$=me(),j=me(),q=me(),Z=(It,zt)=>{const mt=x.get(Ll.computePosHash(a[zt])),At=mt.from,ct=mt.to;if(!At||!ct)return;R(P,At),R(L,zt),R($,ct),at(j),vt(P,L)||(Gt(q,L,P),ai(j,q)),vt($,L)||(Gt(q,$,L),on(j,j,ai(q,q)));const rt=Qt(j);return rt>0?Pt(It,j,1/rt):void 0};let K=Number.POSITIVE_INFINITY;this.sortSubarray(f,_.min,_.max,(It,zt)=>It.featureInfo.featureIndex-zt.featureInfo.featureIndex);const ae=me(),ue=me(),fe=me(),Me=me(),De=me(),Ve=me(),He=me(),Ze=me(),_t=me(),Je=[me(),me(),me(),me()],bt=[me(),me(),me(),me()],Mt=[{coord:new Dt(0,0),height:0},{coord:new Dt(0,0),height:0}],Tt=(It,zt)=>It>zt;for(let It=_.min;It<_.max;It++){const zt=f[It];if(!zt.featureInfo.guardRailEnabled||!this.prepareEdgePoints(Mt,a,h,zt,Tt))continue;const[mt,At]=Mt;if(Zt(ae,mt.coord.x,mt.coord.y,C*mt.height),Zt(ue,At.coord.x,At.coord.y,C*At.height),vt(ae,ue))continue;Gt(fe,ue,ae),ai(fe,fe);const ct=Z(Ze,zt.a)||fe,rt=Z(_t,zt.b)||fe;Zt(Me,ct[1],-ct[0],0),ai(Me,Me),Zt(De,rt[1],-rt[0],0),ai(De,De),In(Ze,Me,ct),ai(Ve,Ze),In(Ze,De,rt),ai(He,Ze),on(Je[0],ae,Pt(Ze,Gt(Ze,Me,Ve),I)),on(Je[1],ae,Pt(Ze,on(Ze,Me,Ve),I)),on(Je[2],ae,Pt(Ze,Ve,I)),Je[3]=ae,on(bt[0],ue,Pt(Ze,Gt(Ze,De,He),I)),on(bt[1],ue,Pt(Ze,on(Ze,De,He),I)),on(bt[2],ue,Pt(Ze,He,I)),bt[3]=ue,K=this.addFeatureSection(zt.featureInfo.featureIndex,K,this.bridgeFeatureSections,i);const Bt=i.addVertex(Je[0],Me,y),Ot=i.addVertex(Je[1],Me,y),En=i.addVertex(bt[0],De,y),ln=i.addVertex(bt[1],De,y);i.addTriangle(Bt,Ot,En),i.addTriangle(Ot,ln,En);const pn=i.addVertex(Je[1],Ve,y),Ht=i.addVertex(Je[2],Ve,y),Tn=i.addVertex(bt[1],He,y),qn=i.addVertex(bt[2],He,y);i.addTriangle(pn,Ht,Tn),i.addTriangle(Ht,qn,Tn),Br(Me,Me),Br(De,De);const Jt=i.addVertex(Je[2],Me,y),vn=i.addVertex(Je[3],Me,y),Fn=i.addVertex(bt[2],De,y),Yn=i.addVertex(bt[3],De,y);i.addTriangle(Jt,vn,Fn),i.addTriangle(vn,Yn,Fn);const gi=this.isTerminalVertex(zt.a,x),ii=this.isTerminalVertex(zt.b,x);mt.height<.01&&gi&&i.addQuad(Je[3],Je[2],Je[1],Je[0],Br(ct,ct),y),At.height<.01&&ii&&i.addQuad(bt[0],bt[1],bt[2],bt[3],rt,y)}this.bridgeFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:i.getVertexCount()})}constructTunnelStructures(i,a,h,f,_,y){i.clearVertexLookup();let x=Number.POSITIVE_INFINITY;const C=(K,ae)=>K.featureInfo.featureIndex-ae.featureInfo.featureIndex;this.sortSubarray(f,_.min,_.max,C),this.sortSubarray(f,y.min,y.max,C);const I=K=>ai(K,K),R=[{coord:new Dt(0,0),height:0},{coord:new Dt(0,0),height:0}],P=(K,ae)=>K<ae,L=me(),$=me(),j=me(),q=me(),Z=me();for(let K=_.min;K<_.max;K++){if(!this.prepareEdgePoints(R,a,h,f[K],P))continue;const[ae,ue]=R,fe=I(Zt(Z,-(ue.coord.y-ae.coord.y),ue.coord.x-ae.coord.x,0));x=this.addFeatureSection(f[K].featureInfo.featureIndex,x,this.tunnelFeatureSections,i),i.addQuad(Zt(L,ae.coord.x,ae.coord.y,ae.height),Zt($,ue.coord.x,ue.coord.y,ue.height),Zt(j,ue.coord.x,ue.coord.y,f[K].isTunnel?-.1:0),Zt(q,ae.coord.x,ae.coord.y,f[K].isTunnel?-.1:0),fe)}for(let K=y.min;K<y.max;K++){const ae=f[K];ae.isTunnel&&([ae.a,ae.b]=[ae.b,ae.a]);const ue=a[ae.a],fe=a[ae.b],Me=I(Zt(Z,-(fe.y-ue.y),fe.x-ue.x,0));x=this.addFeatureSection(ae.featureInfo.featureIndex,x,this.tunnelFeatureSections,i),i.addQuad(Zt(L,fe.x,fe.y,0),Zt($,ue.x,ue.y,0),Zt(j,ue.x,ue.y,h[ae.a]+4),Zt(q,fe.x,fe.y,h[ae.b]+4),Me),i.addQuad(Zt(L,ue.x,ue.y,0),Zt($,fe.x,fe.y,0),Zt(j,fe.x,fe.y,h[ae.b]+4),Zt(q,ue.x,ue.y,h[ae.a]+4),Me)}this.tunnelFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:i.getVertexCount()})}setElevatedPoint(i,a,h,f){i.coord.x=a,i.coord.y=h,i.height=f}prepareEdgePoints(i,a,h,f,_){let y=a[f.a].x,x=a[f.a].y,C=a[f.b].x,I=a[f.b].y,R=h[f.a],P=h[f.b];const L=_(R,0),$=_(P,0);if(L&&$)return this.setElevatedPoint(i[0],y,x,R),this.setElevatedPoint(i[1],C,I,P),!0;if(!L&&!$)return!1;if(L){if(!$){const j=P/(P-R);C=Pn(C,y,j),I=Pn(I,x,j),P=Pn(P,R,j)}}else{const j=R/(R-P);y=Pn(y,C,j),x=Pn(x,I,j),R=Pn(R,P,j)}return this.setElevatedPoint(i[0],y,x,R),this.setElevatedPoint(i[1],C,I,P),!0}prepareEdges(i,a){if(a.length===0)return;a.sort((x,C)=>x.hash===C.hash?C.polygonIdx-x.polygonIdx:C.hash>x.hash?1:-1);let h=0,f=0,_=0,y=a[h].polygonIdx;do f++,(f===a.length||a[h].hash!==a[f].hash)&&((f-h==1||a[f-1].polygonIdx!==y)&&(_<h&&(a[_]=a[h],a[h]=null),a[_].type="none",_++),h=f,h!==a.length&&(y=a[h].polygonIdx));while(h!==a.length);if(a.splice(_),a.length!==0&&i.length!==0){a.sort((I,R)=>I.portalHash<R.portalHash?1:-1);let x=0,C=0;for(;x!==a.length&&C!==i.length;){const I=a[x],R=i[C];I.portalHash>R.hash?x++:R.hash>I.portalHash?C++:(I.type=R.type,x++)}}}isOnBorder(i,a){return i<=0&&a<=0||i>=Ut&&a>=Ut}addFeatureSection(i,a,h,f){return i!==a&&(a=i,h.push({featureIndex:i,vertexStart:f.getVertexCount()}),f.clearVertexLookup()),a}sortSubarray(i,a,h,f){const _=i.slice(a,h);_.sort(f),i.splice(a,_.length,..._)}static computeEdgeHash(i,a){return(i.y===a.y&&i.x>a.x||i.y>a.y)&&([i,a]=[a,i]),BigInt(Ll.computePosHash(i))<<32n|BigInt(Ll.computePosHash(a))}static computePosHash(i){return((65535&i.x)<<16|65535&i.y)>>>0}}var yk,vk={exports:{}},bk=(yk||(yk=1,function(l,i){(function(a){function h(ge,ye){return ge>ye?1:ge<ye?-1:0}var f=function(ge,ye){ge===void 0&&(ge=h),ye===void 0&&(ye=!1),this._compare=ge,this._root=null,this._size=0,this._noDuplicates=!!ye},_={size:{configurable:!0}};function y(ge,ye,lt,gt,Xt){var Kt=Xt-gt;if(Kt>0){var cn=gt+Math.floor(Kt/2),An={key:ye[cn],data:lt[cn],parent:ge};return An.left=y(An,ye,lt,gt,cn),An.right=y(An,ye,lt,cn+1,Xt),An}return null}function x(ge,ye,lt,gt,Xt){if(!(lt>=gt)){for(var Kt=ge[lt+gt>>1],cn=lt-1,An=gt+1;;){do cn++;while(Xt(ge[cn],Kt)<0);do An--;while(Xt(ge[An],Kt)>0);if(cn>=An)break;var _i=ge[cn];ge[cn]=ge[An],ge[An]=_i,_i=ye[cn],ye[cn]=ye[An],ye[An]=_i}x(ge,ye,lt,An,Xt),x(ge,ye,An+1,gt,Xt)}}f.prototype.rotateLeft=function(ge){var ye=ge.right;ye&&(ge.right=ye.left,ye.left&&(ye.left.parent=ge),ye.parent=ge.parent),ge.parent?ge===ge.parent.left?ge.parent.left=ye:ge.parent.right=ye:this._root=ye,ye&&(ye.left=ge),ge.parent=ye},f.prototype.rotateRight=function(ge){var ye=ge.left;ye&&(ge.left=ye.right,ye.right&&(ye.right.parent=ge),ye.parent=ge.parent),ge.parent?ge===ge.parent.left?ge.parent.left=ye:ge.parent.right=ye:this._root=ye,ye&&(ye.right=ge),ge.parent=ye},f.prototype._splay=function(ge){for(;ge.parent;){var ye=ge.parent;ye.parent?ye.left===ge&&ye.parent.left===ye?(this.rotateRight(ye.parent),this.rotateRight(ye)):ye.right===ge&&ye.parent.right===ye?(this.rotateLeft(ye.parent),this.rotateLeft(ye)):ye.left===ge&&ye.parent.right===ye?(this.rotateRight(ye),this.rotateLeft(ye)):(this.rotateLeft(ye),this.rotateRight(ye)):ye.left===ge?this.rotateRight(ye):this.rotateLeft(ye)}},f.prototype.splay=function(ge){for(var ye,lt,gt,Xt,Kt;ge.parent;)(lt=(ye=ge.parent).parent)&&lt.parent?((gt=lt.parent).left===lt?gt.left=ge:gt.right=ge,ge.parent=gt):(ge.parent=null,this._root=ge),Xt=ge.left,Kt=ge.right,ge===ye.left?(lt&&(lt.left===ye?(ye.right?(lt.left=ye.right,lt.left.parent=lt):lt.left=null,ye.right=lt,lt.parent=ye):(Xt?(lt.right=Xt,Xt.parent=lt):lt.right=null,ge.left=lt,lt.parent=ge)),Kt?(ye.left=Kt,Kt.parent=ye):ye.left=null,ge.right=ye,ye.parent=ge):(lt&&(lt.right===ye?(ye.left?(lt.right=ye.left,lt.right.parent=lt):lt.right=null,ye.left=lt,lt.parent=ye):(Kt?(lt.left=Kt,Kt.parent=lt):lt.left=null,ge.right=lt,lt.parent=ge)),Xt?(ye.right=Xt,Xt.parent=ye):ye.right=null,ge.left=ye,ye.parent=ge)},f.prototype.replace=function(ge,ye){ge.parent?ge===ge.parent.left?ge.parent.left=ye:ge.parent.right=ye:this._root=ye,ye&&(ye.parent=ge.parent)},f.prototype.minNode=function(ge){if(ge===void 0&&(ge=this._root),ge)for(;ge.left;)ge=ge.left;return ge},f.prototype.maxNode=function(ge){if(ge===void 0&&(ge=this._root),ge)for(;ge.right;)ge=ge.right;return ge},f.prototype.insert=function(ge,ye){var lt=this._root,gt=null,Xt=this._compare;if(this._noDuplicates)for(;lt;){if(gt=lt,Xt(lt.key,ge)===0)return;lt=Xt(lt.key,ge)<0?lt.right:lt.left}else for(;lt;)gt=lt,lt=Xt(lt.key,ge)<0?lt.right:lt.left;return lt={key:ge,data:ye,left:null,right:null,parent:gt},gt?Xt(gt.key,lt.key)<0?gt.right=lt:gt.left=lt:this._root=lt,this.splay(lt),this._size++,lt},f.prototype.find=function(ge){for(var ye=this._root,lt=this._compare;ye;){var gt=lt(ye.key,ge);if(gt<0)ye=ye.right;else{if(!(gt>0))return ye;ye=ye.left}}return null},f.prototype.contains=function(ge){for(var ye=this._root,lt=this._compare;ye;){var gt=lt(ge,ye.key);if(gt===0)return!0;ye=gt<0?ye.left:ye.right}return!1},f.prototype.remove=function(ge){var ye=this.find(ge);if(!ye)return!1;if(this.splay(ye),ye.left)if(ye.right){var lt=this.minNode(ye.right);lt.parent!==ye&&(this.replace(lt,lt.right),lt.right=ye.right,lt.right.parent=lt),this.replace(ye,lt),lt.left=ye.left,lt.left.parent=lt}else this.replace(ye,ye.left);else this.replace(ye,ye.right);return this._size--,!0},f.prototype.removeNode=function(ge){if(!ge)return!1;if(this.splay(ge),ge.left)if(ge.right){var ye=this.minNode(ge.right);ye.parent!==ge&&(this.replace(ye,ye.right),ye.right=ge.right,ye.right.parent=ye),this.replace(ge,ye),ye.left=ge.left,ye.left.parent=ye}else this.replace(ge,ge.left);else this.replace(ge,ge.right);return this._size--,!0},f.prototype.erase=function(ge){var ye=this.find(ge);if(ye){this.splay(ye);var lt=ye.left,gt=ye.right,Xt=null;lt&&(lt.parent=null,Xt=this.maxNode(lt),this.splay(Xt),this._root=Xt),gt&&(lt?Xt.right=gt:this._root=gt,gt.parent=Xt),this._size--}},f.prototype.pop=function(){var ge=this._root,ye=null;if(ge){for(;ge.left;)ge=ge.left;ye={key:ge.key,data:ge.data},this.remove(ge.key)}return ye},f.prototype.next=function(ge){var ye=ge;if(ye)if(ye.right)for(ye=ye.right;ye&&ye.left;)ye=ye.left;else for(ye=ge.parent;ye&&ye.right===ge;)ge=ye,ye=ye.parent;return ye},f.prototype.prev=function(ge){var ye=ge;if(ye)if(ye.left)for(ye=ye.left;ye&&ye.right;)ye=ye.right;else for(ye=ge.parent;ye&&ye.left===ge;)ge=ye,ye=ye.parent;return ye},f.prototype.forEach=function(ge){for(var ye=this._root,lt=[],gt=!1,Xt=0;!gt;)ye?(lt.push(ye),ye=ye.left):lt.length>0?(ge(ye=lt.pop(),Xt++),ye=ye.right):gt=!0;return this},f.prototype.range=function(ge,ye,lt,gt){for(var Xt=[],Kt=this._compare,cn=this._root;Xt.length!==0||cn;)if(cn)Xt.push(cn),cn=cn.left;else{if(Kt((cn=Xt.pop()).key,ye)>0)break;if(Kt(cn.key,ge)>=0&&lt.call(gt,cn))return this;cn=cn.right}return this},f.prototype.keys=function(){for(var ge=this._root,ye=[],lt=[],gt=!1;!gt;)ge?(ye.push(ge),ge=ge.left):ye.length>0?(ge=ye.pop(),lt.push(ge.key),ge=ge.right):gt=!0;return lt},f.prototype.values=function(){for(var ge=this._root,ye=[],lt=[],gt=!1;!gt;)ge?(ye.push(ge),ge=ge.left):ye.length>0?(ge=ye.pop(),lt.push(ge.data),ge=ge.right):gt=!0;return lt},f.prototype.at=function(ge){for(var ye=this._root,lt=[],gt=!1,Xt=0;!gt;)if(ye)lt.push(ye),ye=ye.left;else if(lt.length>0){if(ye=lt.pop(),Xt===ge)return ye;Xt++,ye=ye.right}else gt=!0;return null},f.prototype.load=function(ge,ye,lt){if(ge===void 0&&(ge=[]),ye===void 0&&(ye=[]),lt===void 0&&(lt=!1),this._size!==0)throw new Error("bulk-load: tree is not empty");var gt=ge.length;return lt&&x(ge,ye,0,gt-1,this._compare),this._root=y(null,ge,ye,0,gt),this._size=gt,this},f.prototype.min=function(){var ge=this.minNode(this._root);return ge?ge.key:null},f.prototype.max=function(){var ge=this.maxNode(this._root);return ge?ge.key:null},f.prototype.isEmpty=function(){return this._root===null},_.size.get=function(){return this._size},f.createTree=function(ge,ye,lt,gt,Xt){return new f(lt,Xt).load(ge,ye,gt)},Object.defineProperties(f.prototype,_);var C=0,I=1,R=2,P=3,L=0,$=1,j=2,q=3;function Z(ge,ye,lt){ye===null?(ge.inOut=!1,ge.otherInOut=!0):(ge.isSubject===ye.isSubject?(ge.inOut=!ye.inOut,ge.otherInOut=ye.otherInOut):(ge.inOut=!ye.otherInOut,ge.otherInOut=ye.isVertical()?!ye.inOut:ye.inOut),ye&&(ge.prevInResult=!K(ye,lt)||ye.isVertical()?ye.prevInResult:ye));var gt=K(ge,lt);ge.resultTransition=gt?function(Xt,Kt){var cn,An=!Xt.inOut,_i=!Xt.otherInOut;switch(Kt){case L:cn=An&&_i;break;case $:cn=An||_i;break;case q:cn=An^_i;break;case j:cn=Xt.isSubject?An&&!_i:_i&&!An}return cn?1:-1}(ge,lt):0}function K(ge,ye){switch(ge.type){case C:switch(ye){case L:return!ge.otherInOut;case $:return ge.otherInOut;case j:return ge.isSubject&&ge.otherInOut||!ge.isSubject&&!ge.otherInOut;case q:return!0}break;case R:return ye===L||ye===$;case P:return ye===j;case I:return!1}return!1}var ae=function(ge,ye,lt,gt,Xt){this.left=ye,this.point=ge,this.otherEvent=lt,this.isSubject=gt,this.type=Xt||C,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0},ue={inResult:{configurable:!0}};function fe(ge,ye){return ge[0]===ye[0]&&ge[1]===ye[1]}ae.prototype.isBelow=function(ge){var ye=this.point,lt=this.otherEvent.point;return this.left?(ye[0]-ge[0])*(lt[1]-ge[1])-(lt[0]-ge[0])*(ye[1]-ge[1])>0:(lt[0]-ge[0])*(ye[1]-ge[1])-(ye[0]-ge[0])*(lt[1]-ge[1])>0},ae.prototype.isAbove=function(ge){return!this.isBelow(ge)},ae.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},ue.inResult.get=function(){return this.resultTransition!==0},ae.prototype.clone=function(){var ge=new ae(this.point,this.left,this.otherEvent,this.isSubject,this.type);return ge.contourId=this.contourId,ge.resultTransition=this.resultTransition,ge.prevInResult=this.prevInResult,ge.isExteriorRing=this.isExteriorRing,ge.inOut=this.inOut,ge.otherInOut=this.otherInOut,ge},Object.defineProperties(ae.prototype,ue);var Me=11102230246251565e-32,De=134217729,Ve=(3+8*Me)*Me;function He(ge,ye,lt,gt,Xt){var Kt,cn,An,_i,vi=ye[0],fi=gt[0],ar=0,Zr=0;fi>vi==fi>-vi?(Kt=vi,vi=ye[++ar]):(Kt=fi,fi=gt[++Zr]);var di=0;if(ar<ge&&Zr<lt)for(fi>vi==fi>-vi?(An=Kt-((cn=vi+Kt)-vi),vi=ye[++ar]):(An=Kt-((cn=fi+Kt)-fi),fi=gt[++Zr]),Kt=cn,An!==0&&(Xt[di++]=An);ar<ge&&Zr<lt;)fi>vi==fi>-vi?(An=Kt-((cn=Kt+vi)-(_i=cn-Kt))+(vi-_i),vi=ye[++ar]):(An=Kt-((cn=Kt+fi)-(_i=cn-Kt))+(fi-_i),fi=gt[++Zr]),Kt=cn,An!==0&&(Xt[di++]=An);for(;ar<ge;)An=Kt-((cn=Kt+vi)-(_i=cn-Kt))+(vi-_i),vi=ye[++ar],Kt=cn,An!==0&&(Xt[di++]=An);for(;Zr<lt;)An=Kt-((cn=Kt+fi)-(_i=cn-Kt))+(fi-_i),fi=gt[++Zr],Kt=cn,An!==0&&(Xt[di++]=An);return Kt===0&&di!==0||(Xt[di++]=Kt),di}function Ze(ge){return new Float64Array(ge)}var _t=33306690738754716e-32,Je=22204460492503146e-32,bt=11093356479670487e-47,Mt=Ze(4),Tt=Ze(8),It=Ze(12),zt=Ze(16),mt=Ze(4);function At(ge,ye,lt){var gt=function(Xt,Kt,cn,An,_i,vi){var fi=(Kt-vi)*(cn-_i),ar=(Xt-_i)*(An-vi),Zr=fi-ar;if(fi===0||ar===0||fi>0!=ar>0)return Zr;var di=Math.abs(fi+ar);return Math.abs(Zr)>=_t*di?Zr:-function(kr,hr,Zi,Or,Lr,Er,Rr){var fr,bi,gr,oo,$n,Fi,zr,vo,jr,ps,br,os,al,ca,ra,ll,$d,ms,Ls=kr-Lr,ua=Zi-Lr,Da=hr-Er,xa=Or-Er;Mt[0]=(ra=(vo=Ls-(zr=(Fi=De*Ls)-(Fi-Ls)))*(ps=xa-(jr=(Fi=De*xa)-(Fi-xa)))-((ca=Ls*xa)-zr*jr-vo*jr-zr*ps))-((br=ra-($d=(vo=Da-(zr=(Fi=De*Da)-(Fi-Da)))*(ps=ua-(jr=(Fi=De*ua)-(Fi-ua)))-((ll=Da*ua)-zr*jr-vo*jr-zr*ps)))+($n=ra-br))+($n-$d),Mt[1]=(al=ca-((os=ca+br)-($n=os-ca))+(br-$n))-((br=al-ll)+($n=al-br))+($n-ll),Mt[2]=os-((ms=os+br)-($n=ms-os))+(br-$n),Mt[3]=ms;var sp=function(P2e,OM){for(var LM=OM[0],w2=1;w2<4;w2++)LM+=OM[w2];return LM}(0,Mt),Mv=Je*Rr;if(sp>=Mv||-sp>=Mv||(fr=kr-(Ls+($n=kr-Ls))+($n-Lr),gr=Zi-(ua+($n=Zi-ua))+($n-Lr),bi=hr-(Da+($n=hr-Da))+($n-Er),oo=Or-(xa+($n=Or-xa))+($n-Er),fr===0&&bi===0&&gr===0&&oo===0)||(Mv=bt*Rr+Ve*Math.abs(sp),(sp+=Ls*oo+xa*fr-(Da*gr+ua*bi))>=Mv||-sp>=Mv))return sp;mt[0]=(ra=(vo=fr-(zr=(Fi=De*fr)-(Fi-fr)))*(ps=xa-(jr=(Fi=De*xa)-(Fi-xa)))-((ca=fr*xa)-zr*jr-vo*jr-zr*ps))-((br=ra-($d=(vo=bi-(zr=(Fi=De*bi)-(Fi-bi)))*(ps=ua-(jr=(Fi=De*ua)-(Fi-ua)))-((ll=bi*ua)-zr*jr-vo*jr-zr*ps)))+($n=ra-br))+($n-$d),mt[1]=(al=ca-((os=ca+br)-($n=os-ca))+(br-$n))-((br=al-ll)+($n=al-br))+($n-ll),mt[2]=os-((ms=os+br)-($n=ms-os))+(br-$n),mt[3]=ms;var U$=He(4,Mt,4,mt,Tt);mt[0]=(ra=(vo=Ls-(zr=(Fi=De*Ls)-(Fi-Ls)))*(ps=oo-(jr=(Fi=De*oo)-(Fi-oo)))-((ca=Ls*oo)-zr*jr-vo*jr-zr*ps))-((br=ra-($d=(vo=Da-(zr=(Fi=De*Da)-(Fi-Da)))*(ps=gr-(jr=(Fi=De*gr)-(Fi-gr)))-((ll=Da*gr)-zr*jr-vo*jr-zr*ps)))+($n=ra-br))+($n-$d),mt[1]=(al=ca-((os=ca+br)-($n=os-ca))+(br-$n))-((br=al-ll)+($n=al-br))+($n-ll),mt[2]=os-((ms=os+br)-($n=ms-os))+(br-$n),mt[3]=ms;var H$=He(U$,Tt,4,mt,It);mt[0]=(ra=(vo=fr-(zr=(Fi=De*fr)-(Fi-fr)))*(ps=oo-(jr=(Fi=De*oo)-(Fi-oo)))-((ca=fr*oo)-zr*jr-vo*jr-zr*ps))-((br=ra-($d=(vo=bi-(zr=(Fi=De*bi)-(Fi-bi)))*(ps=gr-(jr=(Fi=De*gr)-(Fi-gr)))-((ll=bi*gr)-zr*jr-vo*jr-zr*ps)))+($n=ra-br))+($n-$d),mt[1]=(al=ca-((os=ca+br)-($n=os-ca))+(br-$n))-((br=al-ll)+($n=al-br))+($n-ll),mt[2]=os-((ms=os+br)-($n=ms-os))+(br-$n),mt[3]=ms;var G$=He(H$,It,4,mt,zt);return zt[G$-1]}(Xt,Kt,cn,An,_i,vi,di)}(ge[0],ge[1],ye[0],ye[1],lt[0],lt[1]);return gt>0?-1:gt<0?1:0}function ct(ge,ye){var lt=ge.point,gt=ye.point;return lt[0]>gt[0]?1:lt[0]<gt[0]?-1:lt[1]!==gt[1]?lt[1]>gt[1]?1:-1:function(Xt,Kt,cn,An){return Xt.left!==Kt.left?Xt.left?1:-1:At(cn,Xt.otherEvent.point,Kt.otherEvent.point)!==0?Xt.isBelow(Kt.otherEvent.point)?-1:1:!Xt.isSubject&&Kt.isSubject?1:-1}(ge,ye,lt)}function rt(ge,ye,lt){var gt=new ae(ye,!1,ge,ge.isSubject),Xt=new ae(ye,!0,ge.otherEvent,ge.isSubject);return fe(ge.point,ge.otherEvent.point)&&console.warn("what is that, a collapsed segment?",ge),gt.contourId=Xt.contourId=ge.contourId,ct(Xt,ge.otherEvent)>0&&(ge.otherEvent.left=!0,Xt.left=!1),ge.otherEvent.otherEvent=Xt,ge.otherEvent=gt,lt.push(Xt),lt.push(gt),lt}function Bt(ge,ye){return ge[0]*ye[1]-ge[1]*ye[0]}function Ot(ge,ye){return ge[0]*ye[0]+ge[1]*ye[1]}function En(ge,ye,lt){var gt=function(_i,vi,fi,ar,Zr){var di=[vi[0]-_i[0],vi[1]-_i[1]],kr=[ar[0]-fi[0],ar[1]-fi[1]];function hr(Fi,zr,vo){return[Fi[0]+zr*vo[0],Fi[1]+zr*vo[1]]}var Zi=[fi[0]-_i[0],fi[1]-_i[1]],Or=Bt(di,kr),Lr=Or*Or,Er=Ot(di,di);if(Lr>0){var Rr=Bt(Zi,kr)/Or;if(Rr<0||Rr>1)return null;var fr=Bt(Zi,di)/Or;return fr<0||fr>1?null:Rr===0||Rr===1?[hr(_i,Rr,di)]:fr===0||fr===1?[hr(fi,fr,kr)]:[hr(_i,Rr,di)]}if((Lr=(Or=Bt(Zi,di))*Or)>0)return null;var bi=Ot(di,Zi)/Er,gr=bi+Ot(di,kr)/Er,oo=Math.min(bi,gr),$n=Math.max(bi,gr);return oo<=1&&$n>=0?oo===1?[hr(_i,oo>0?oo:0,di)]:$n===0?[hr(_i,$n<1?$n:1,di)]:[hr(_i,oo>0?oo:0,di),hr(_i,$n<1?$n:1,di)]:null}(ge.point,ge.otherEvent.point,ye.point,ye.otherEvent.point),Xt=gt?gt.length:0;if(Xt===0||Xt===1&&(fe(ge.point,ye.point)||fe(ge.otherEvent.point,ye.otherEvent.point))||Xt===2&&ge.isSubject===ye.isSubject)return 0;if(Xt===1)return fe(ge.point,gt[0])||fe(ge.otherEvent.point,gt[0])||rt(ge,gt[0],lt),fe(ye.point,gt[0])||fe(ye.otherEvent.point,gt[0])||rt(ye,gt[0],lt),1;var Kt=[],cn=!1,An=!1;return fe(ge.point,ye.point)?cn=!0:ct(ge,ye)===1?Kt.push(ye,ge):Kt.push(ge,ye),fe(ge.otherEvent.point,ye.otherEvent.point)?An=!0:ct(ge.otherEvent,ye.otherEvent)===1?Kt.push(ye.otherEvent,ge.otherEvent):Kt.push(ge.otherEvent,ye.otherEvent),cn&&An||cn?(ye.type=I,ge.type=ye.inOut===ge.inOut?R:P,cn&&!An&&rt(Kt[1].otherEvent,Kt[0].point,lt),2):An?(rt(Kt[0],Kt[1].point,lt),3):Kt[0]!==Kt[3].otherEvent?(rt(Kt[0],Kt[1].point,lt),rt(Kt[1],Kt[2].point,lt),3):(rt(Kt[0],Kt[1].point,lt),rt(Kt[3].otherEvent,Kt[2].point,lt),3)}function ln(ge,ye){if(ge===ye)return 0;if(At(ge.point,ge.otherEvent.point,ye.point)!==0||At(ge.point,ge.otherEvent.point,ye.otherEvent.point)!==0)return fe(ge.point,ye.point)?ge.isBelow(ye.otherEvent.point)?-1:1:ge.point[0]===ye.point[0]?ge.point[1]<ye.point[1]?-1:1:ct(ge,ye)===1?ye.isAbove(ge.point)?-1:1:ge.isBelow(ye.point)?-1:1;if(ge.isSubject!==ye.isSubject)return ge.isSubject?-1:1;var lt=ge.point,gt=ye.point;return lt[0]===gt[0]&&lt[1]===gt[1]?(lt=ge.otherEvent.point)[0]===(gt=ye.otherEvent.point)[0]&&lt[1]===gt[1]?0:ge.contourId>ye.contourId?1:-1:ct(ge,ye)===1?1:-1}var pn=function(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null};function Ht(ge,ye,lt,gt){var Xt,Kt=ge+1,cn=ye[ge].point,An=ye.length;for(Kt<An&&(Xt=ye[Kt].point);Kt<An&&Xt[0]===cn[0]&&Xt[1]===cn[1];){if(!lt[Kt])return Kt;++Kt<An&&(Xt=ye[Kt].point)}for(Kt=ge-1;lt[Kt]&&Kt>gt;)Kt--;return Kt}pn.prototype.isExterior=function(){return this.holeOf==null};var Tn=Jt,qn=Jt;function Jt(ge,ye){if(!(this instanceof Jt))return new Jt(ge,ye);if(this.data=ge||[],this.length=this.data.length,this.compare=ye||vn,this.length>0)for(var lt=(this.length>>1)-1;lt>=0;lt--)this._down(lt)}function vn(ge,ye){return ge<ye?-1:ge>ye?1:0}Jt.prototype={push:function(ge){this.data.push(ge),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var ge=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),ge}},peek:function(){return this.data[0]},_up:function(ge){for(var ye=this.data,lt=this.compare,gt=ye[ge];ge>0;){var Xt=ge-1>>1,Kt=ye[Xt];if(lt(gt,Kt)>=0)break;ye[ge]=Kt,ge=Xt}ye[ge]=gt},_down:function(ge){for(var ye=this.data,lt=this.compare,gt=this.length>>1,Xt=ye[ge];ge<gt;){var Kt=1+(ge<<1),cn=Kt+1,An=ye[Kt];if(cn<this.length&&lt(ye[cn],An)<0&&(Kt=cn,An=ye[cn]),lt(An,Xt)>=0)break;ye[ge]=An,ge=Kt}ye[ge]=Xt}},Tn.default=qn;var Fn=Math.max,Yn=Math.min,gi=0;function ii(ge,ye,lt,gt,Xt,Kt){var cn,An,_i,vi,fi,ar;for(cn=0,An=ge.length-1;cn<An;cn++)if(vi=ge[cn+1],fi=new ae(_i=ge[cn],!1,void 0,ye),ar=new ae(vi,!1,fi,ye),fi.otherEvent=ar,_i[0]!==vi[0]||_i[1]!==vi[1]){fi.contourId=ar.contourId=lt,Kt||(fi.isExteriorRing=!1,ar.isExteriorRing=!1),ct(fi,ar)>0?ar.left=!0:fi.left=!0;var Zr=_i[0],di=_i[1];Xt[0]=Yn(Xt[0],Zr),Xt[1]=Yn(Xt[1],di),Xt[2]=Fn(Xt[2],Zr),Xt[3]=Fn(Xt[3],di),gt.push(fi),gt.push(ar)}}var un=[];function Qn(ge,ye,lt){typeof ge[0][0][0]=="number"&&(ge=[ge]),typeof ye[0][0][0]=="number"&&(ye=[ye]);var gt=function(di,kr,hr){var Zi=null;return di.length*kr.length==0&&(hr===L?Zi=un:hr===j?Zi=di:hr!==$&&hr!==q||(Zi=di.length===0?kr:di)),Zi}(ge,ye,lt);if(gt)return gt===un?null:gt;var Xt=[1/0,1/0,-1/0,-1/0],Kt=[1/0,1/0,-1/0,-1/0],cn=function(di,kr,hr,Zi,Or){var Lr,Er,Rr,fr,bi,gr,oo=new Tn(null,ct);for(Rr=0,fr=di.length;Rr<fr;Rr++)for(bi=0,gr=(Lr=di[Rr]).length;bi<gr;bi++)(Er=bi===0)&&gi++,ii(Lr[bi],!0,gi,oo,hr,Er);for(Rr=0,fr=kr.length;Rr<fr;Rr++)for(bi=0,gr=(Lr=kr[Rr]).length;bi<gr;bi++)Er=bi===0,Or===j&&(Er=!1),Er&&gi++,ii(Lr[bi],!1,gi,oo,Zi,Er);return oo}(ge,ye,Xt,Kt,lt);if(gt=function(di,kr,hr,Zi,Or){var Lr=null;return(hr[0]>Zi[2]||Zi[0]>hr[2]||hr[1]>Zi[3]||Zi[1]>hr[3])&&(Or===L?Lr=un:Or===j?Lr=di:Or!==$&&Or!==q||(Lr=di.concat(kr))),Lr}(ge,ye,Xt,Kt,lt))return gt===un?null:gt;for(var An=function(di){var kr,hr,Zi=function(Rr){var fr,bi,gr,oo,$n=[];for(bi=0,gr=Rr.length;bi<gr;bi++)((fr=Rr[bi]).left&&fr.inResult||!fr.left&&fr.otherEvent.inResult)&&$n.push(fr);for(var Fi=!1;!Fi;)for(Fi=!0,bi=0,gr=$n.length;bi<gr;bi++)bi+1<gr&&ct($n[bi],$n[bi+1])===1&&(oo=$n[bi],$n[bi]=$n[bi+1],$n[bi+1]=oo,Fi=!1);for(bi=0,gr=$n.length;bi<gr;bi++)(fr=$n[bi]).otherPos=bi;for(bi=0,gr=$n.length;bi<gr;bi++)(fr=$n[bi]).left||(oo=fr.otherPos,fr.otherPos=fr.otherEvent.otherPos,fr.otherEvent.otherPos=oo);return $n}(di),Or={},Lr=[],Er=function(){if(!Or[kr]){var Rr=Lr.length,fr=function($n,Fi,zr){var vo=new pn;if($n.prevInResult!=null){var jr=$n.prevInResult,ps=jr.outputContourId;if(jr.resultTransition>0){var br=Fi[ps];if(br.holeOf!=null){var os=br.holeOf;Fi[os].holeIds.push(zr),vo.holeOf=os,vo.depth=Fi[ps].depth}else Fi[ps].holeIds.push(zr),vo.holeOf=ps,vo.depth=Fi[ps].depth+1}else vo.holeOf=null,vo.depth=Fi[ps].depth}else vo.holeOf=null,vo.depth=0;return vo}(Zi[kr],Lr,Rr),bi=function($n){Or[$n]=!0,$n<Zi.length&&Zi[$n]&&(Zi[$n].outputContourId=Rr)},gr=kr,oo=kr;for(fr.points.push(Zi[kr].point);bi(gr),bi(gr=Zi[gr].otherPos),fr.points.push(Zi[gr].point),!((gr=Ht(gr,Zi,Or,oo))==oo||gr>=Zi.length)&&Zi[gr];);Lr.push(fr)}};for(kr=0,hr=Zi.length;kr<hr;kr++)Er();return Lr}(function(di,kr,hr,Zi,Or,Lr){for(var Er,Rr,fr,bi=new f(ln),gr=[],oo=Math.min(Zi[2],Or[2]);di.length!==0;){var $n=di.pop();if(gr.push($n),Lr===L&&$n.point[0]>oo||Lr===j&&$n.point[0]>Zi[2])break;if($n.left){Rr=Er=bi.insert($n),Er=Er!==(fr=bi.minNode())?bi.prev(Er):null,Rr=bi.next(Rr);var Fi=Er?Er.key:null;if(Z($n,Fi,Lr),Rr&&En($n,Rr.key,di)===2&&(Z($n,Fi,Lr),Z(Rr.key,$n,Lr)),Er&&En(Er.key,$n,di)===2){var zr=Er;Z(Fi,(zr=zr!==fr?bi.prev(zr):null)?zr.key:null,Lr),Z($n,Fi,Lr)}}else Rr=Er=bi.find($n=$n.otherEvent),Er&&Rr&&(Er=Er!==fr?bi.prev(Er):null,Rr=bi.next(Rr),bi.remove($n),Rr&&Er&&En(Er.key,Rr.key,di))}return gr}(cn,0,0,Xt,Kt,lt)),_i=[],vi=0;vi<An.length;vi++){var fi=An[vi];if(fi.isExterior()){for(var ar=[fi.points],Zr=0;Zr<fi.holeIds.length;Zr++)ar.push(An[fi.holeIds[Zr]].points);_i.push(ar)}}return _i}var Pi={UNION:$,DIFFERENCE:j,INTERSECTION:L,XOR:q};a.diff=function(ge,ye){return Qn(ge,ye,j)},a.intersection=function(ge,ye){return Qn(ge,ye,L)},a.operations=Pi,a.union=function(ge,ye){return Qn(ge,ye,$)},a.xor=function(ge,ye){return Qn(ge,ye,q)},Object.defineProperty(a,"__esModule",{value:!0})})(i)}(0,vk.exports)),vk.exports);/**
 * martinez v0.7.4
 * Martinez polygon clipping algorithm, does boolean operation on polygons (multipolygons, polygons with holes etc): intersection, union, difference, xor
 *
 * @author Alex Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */function g1(l,i,a,h){const f=[],_=h===0?(y,x,C,I,R,P)=>{y.push(new Dt(P,C+(P-x)/(I-x)*(R-C)))}:(y,x,C,I,R,P)=>{y.push(new Dt(x+(P-C)/(R-C)*(I-x),P))};for(const y of l){const x=[];for(const C of y){if(C.length<=2)continue;const I=[];for(let L=0;L<C.length-1;L++){const $=C[L].x,j=C[L].y,q=C[L+1].x,Z=C[L+1].y,K=h===0?$:j,ae=h===0?q:Z;K<i?ae>i&&_(I,$,j,q,Z,i):K>a?ae<a&&_(I,$,j,q,Z,a):I.push(C[L]),ae<i&&K>=i&&_(I,$,j,q,Z,i),ae>a&&K<=a&&_(I,$,j,q,Z,a)}let R=C[C.length-1];const P=h===0?R.x:R.y;P>=i&&P<=a&&I.push(R),I.length&&(R=I[I.length-1],I[0].x===R.x&&I[0].y===R.y||I.push(I[0]),x.push(I))}x.length&&f.push(x)}return f}function V7(l,i){const a=_C(l),h=_C([i]),f=bk.intersection(a,h);return f==null?[]:xk(f)}function $7(l,i){let h=_C(l,65536);const f=[];for(;i.valid();i.next()){const[_,y]=i.get(),x=_.x*65536,C=_.y*65536,I=y.x*65536,R=y.y*65536,P=I-x,L=R-C,$=Math.hypot(P,L);if($===0)continue;const j=Math.trunc(L/$*3),q=-Math.trunc(P/$*3);f.push([[[x,C],[I,R],[I+j,R+q],[x+j,C+q],[x,C]]])}return f.length>0&&(h=bk.diff(h,f)),xk(h,1/65536)}function _C(l,i=1){return[l.map(a=>a.map(h=>[h.x*i,h.y*i]))]}function xk(l,i=1){return l.map(a=>a.map((h,f)=>{const _=h.map(y=>new Dt(y[0]*i,y[1]*i).round());return f>0&&_.reverse(),_}))}class yC{constructor(i,a){this.layoutVertexArray=new Md,this.indexArray=new bs,this.lineIndexArray=new hs,this.triangleSegments=new ro,this.lineSegments=new ro,this.programConfigurations=new Ic(i.layers,{zoom:i.zoom,lut:i.lut}),this.uploaded=!1,a&&(this.elevatedLayoutVertexArray=new Dd)}update(i,a,h,f,_,y,x,C){this.programConfigurations.updatePaintArrays(i,a,_,h,f,y,x,C)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,T7.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.lineIndexBuffer=i.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=i.createVertexBuffer(this.elevatedLayoutVertexArray,E7.members))),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(i,a,h,f,_,y,x){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,a,h,f,_,y,void 0,x)}}class vC{constructor(i){this.zoom=i.zoom,this.pixelRatio=i.pixelRatio,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.lut=i.lut,this.bufferData=new yC(i,!1),this.elevationBufferData=new yC(i,!0),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.projection=i.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference"),this.sourceLayerIndex=i.sourceLayerIndex,this.worldview=i.worldview}updateFootprints(i,a){}populate(i,a,h,f){this.hasPattern=mC("fill",this.layers,this.pixelRatio,a);const _=this.layers[0].layout.get("fill-sort-key"),y=[];for(const{feature:x,id:C,index:I,sourceLayerIndex:R}of i){const P=this.layers[0]._featureFilter.needGeometry,L=Lt(x,P);if(!this.layers[0]._featureFilter.filter(new Tr(this.zoom,{worldview:this.worldview}),L,h))continue;const $=_?_.evaluate(L,{},h,a.availableImages):void 0,j={id:C,properties:x.properties,type:x.type,sourceLayerIndex:R,index:I,geometry:P?L.geometry:rn(x,h,f),patterns:{},sortKey:$};y.push(j)}_&&y.sort((x,C)=>x.sortKey-C.sortKey);for(const x of y){const{geometry:C,index:I,sourceLayerIndex:R}=x;if(this.hasPattern){const P=gC("fill",this.layers,x,this.zoom,this.pixelRatio,a);this.patternFeatures.push(P)}else this.addFeature(x,C,I,h,{},a.availableImages,a.brightness,a.elevationFeatures);a.featureIndex.insert(i[I].feature,C,I,R,this.index)}}update(i,a,h,f,_,y,x){this.bufferData.update(i,a,h,f,_,y,x,this.worldview),this.elevationBufferData.update(i,a,h,f,_,y,x,this.worldview),this.elevatedStructures&&this.elevatedStructures.update(i,a,h,f,_,y,x,this.worldview)}addFeatures(i,a,h,f,_,y){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,a,h,f,y,i.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(i){this.bufferData.upload(i),this.elevationBufferData.upload(i),this.elevatedStructures&&this.elevatedStructures.upload(i)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(i,a,h,f,_,y=[],x,C){const I=tv(a,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(i,I,f,h,C):this.addGeometry(I,this.bufferData),this.bufferData.populatePaintArrays(i,h,_,y,f,x,this.worldview),this.elevationBufferData.populatePaintArrays(i,h,_,y,f,x,this.worldview)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(i,a,h,f,_){this.elevatedStructures&&(this.elevatedStructures.construct(i),this.elevatedStructures.populatePaintArrays(a,h,f,_,this.worldview))}addElevatedRoadFeature(i,a,h,f,_){const y=new Array,x=Yr.getElevationFeature(i,_);if(!x)return void this.addGeometry(a,this.bufferData);{const I=this.clipPolygonsToTile(a,1);I.length>0&&y.push({polygons:I,elevationFeature:x,elevationTileID:h})}const C={guardRailEnabled:this.layers[0].layout.get("fill-construct-bridge-guard-rail").evaluate(i,{},h),featureIndex:f};for(const I of y)if(I.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new Ll(I.elevationTileID,this.layers,this.zoom,this.lut));const P=I.elevationFeature.isTunnel();let L=0;i.properties.hasOwnProperty(or)&&(L=+i.properties[or]);for(const $ of I.polygons)this.elevatedStructures.addPortalCandidates(I.elevationFeature.id,$,P,I.elevationFeature,L)}I.elevationFeature.constantHeight==null&&(I.polygons=this.prepareElevatedPolygons(I.polygons,I.elevationFeature,I.elevationTileID));const R=new es(h,I.elevationTileID);this.addElevatedGeometry(I.polygons,R,I.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,f,C)}}addElevatedGeometry(i,a,h,f,_,y){const x={elevation:h,elevationSampler:a,bias:f,index:_,featureInfo:y},[C,I]=this.addGeometry(i,this.elevationBufferData,x);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:C,max:I}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,C),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,I))}addGeometry(i,a,h){let f=Number.POSITIVE_INFINITY,_=Number.NEGATIVE_INFINITY,y=null;h&&(y=h.elevationSampler.constantElevation(h.elevation,h.bias),y!=null&&(f=y,_=y));const x=(C,I,R)=>{if(h!=null)if(I.push(C),y!=null)a.elevatedLayoutVertexArray.emplaceBack(y),R.push(y);else{const P=h.elevationSampler.pointElevation(C,h.elevation,h.bias);a.elevatedLayoutVertexArray.emplaceBack(P),R.push(P),f=Math.min(f,P),_=Math.max(_,P)}};for(const C of i){let I=0;for(const ue of C)I+=ue.length;const R=a.triangleSegments.prepareSegment(I,a.layoutVertexArray,a.indexArray),P=R.vertexLength,L=[],$=[],j=[],q=[],Z=[],K=a.layoutVertexArray.length;for(const ue of C){if(ue.length===0)continue;ue!==C[0]&&$.push(L.length/2);const fe=a.lineSegments.prepareSegment(ue.length,a.layoutVertexArray,a.lineIndexArray),Me=fe.vertexLength;h&&Z.push(a.layoutVertexArray.length-K),x(ue[0],j,q),a.layoutVertexArray.emplaceBack(ue[0].x,ue[0].y),a.lineIndexArray.emplaceBack(Me+ue.length-1,Me),L.push(ue[0].x),L.push(ue[0].y);for(let De=1;De<ue.length;De++)x(ue[De],j,q),a.layoutVertexArray.emplaceBack(ue[De].x,ue[De].y),a.lineIndexArray.emplaceBack(Me+De-1,Me+De),L.push(ue[De].x),L.push(ue[De].y);fe.vertexLength+=ue.length,fe.primitiveLength+=ue.length}const ae=a_(L,$);for(let ue=0;ue<ae.length;ue+=3)a.indexArray.emplaceBack(P+ae[ue],P+ae[ue+1],P+ae[ue+2]);if(ae.length>0&&h&&this.elevationMode==="hd-road-base"){const ue=h.elevation.isTunnel(),fe=h.elevation.safeArea,Me=this.elevatedStructures.addVertices(j,q);this.elevatedStructures.addTriangles(ae,Me,ue);const De=Z.length;if(De>0){for(let Ve=0;Ve<De-1;Ve++)this.elevatedStructures.addRenderableRing(h.index,Z[Ve]+Me,Z[Ve+1]-Z[Ve],ue,fe,h.featureInfo);this.elevatedStructures.addRenderableRing(h.index,Z[De-1]+Me,j.length-Z[De-1],ue,fe,h.featureInfo)}}R.vertexLength+=I,R.primitiveLength+=ae.length/3}return[f,_]}prepareElevatedPolygons(i,a,h){const f=1/et(h),_=[];for(const y of i){const x=$7(y,new sr(a,f));_.push(...x)}return _}clipPolygonsToTile(i,a){const h=-a,f=-a,_=Ut+a,y=Ut+a;let x=0;const C=[],I=[];for(;x<i.length;x++){const L=i[x],$=_f(L);($.min.x>=h&&$.max.x<=_&&$.min.y>=f&&$.max.y<=y?C:I).push(L)}if(C.length===i.length)return i;const R=[new Dt(h,f),new Dt(_,f),new Dt(_,y),new Dt(h,y),new Dt(h,f)],P=C;for(const L of I)P.push(...V7(L,R));return P}}let wk,Sk,Ck,Tk;en(vC,"FillBucket",{omit:["layers","patternFeatures"]}),en(yC,"FillBufferData"),en(Ll,"ElevatedStructures");class _1{constructor(i,a,h,f){if(this.triangleCount=a.length/3,this.min=new Dt(0,0),this.max=new Dt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||i.length===0)return;const[_,y]=[i[0].clone(),i[0].clone()];for(let P=1;P<i.length;++P){const L=i[P];_.x=Math.min(_.x,L.x),_.y=Math.min(_.y,L.y),y.x=Math.max(y.x,L.x),y.y=Math.max(y.y,L.y)}if(f){const P=Math.ceil(Math.max(y.x-_.x,y.y-_.y)/f);h=Math.max(h,P)}if(h===0)return;this.min=_,this.max=y;const x=this.max.sub(this.min);x.x=Math.max(x.x,1),x.y=Math.max(x.y,1);const C=Math.max(x.x,x.y)/h;this.cellsX=Math.max(1,Math.ceil(x.x/C)),this.cellsY=Math.max(1,Math.ceil(x.y/C)),this.xScale=1/C,this.yScale=1/C;const I=[];for(let P=0;P<this.triangleCount;P++){const L=i[a[3*P+0]].sub(this.min),$=i[a[3*P+1]].sub(this.min),j=i[a[3*P+2]].sub(this.min),q=Nd(Math.floor(Math.min(L.x,$.x,j.x)),this.xScale,this.cellsX),Z=Nd(Math.floor(Math.max(L.x,$.x,j.x)),this.xScale,this.cellsX),K=Nd(Math.floor(Math.min(L.y,$.y,j.y)),this.yScale,this.cellsY),ae=Nd(Math.floor(Math.max(L.y,$.y,j.y)),this.yScale,this.cellsY),ue=new Dt(0,0),fe=new Dt(0,0),Me=new Dt(0,0),De=new Dt(0,0);for(let Ve=K;Ve<=ae;++Ve){ue.y=fe.y=Ve*C,Me.y=De.y=(Ve+1)*C;for(let He=q;He<=Z;++He)ue.x=Me.x=He*C,fe.x=De.x=(He+1)*C,(Gu(L,$,j,ue,fe,De)||Gu(L,$,j,ue,De,Me))&&I.push({cellIdx:Ve*this.cellsX+He,triIdx:P})}}if(I.length===0)return;I.sort((P,L)=>P.cellIdx-L.cellIdx||P.triIdx-L.triIdx);let R=0;for(;R<I.length;){const P=I[R].cellIdx,L={start:this.payload.length,len:0};for(;R<I.length&&I[R].cellIdx===P;)++L.len,this.payload.push(I[R++].triIdx);this.cells[P]=L}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(i,a){if(this.triangleCount===0||this.cells.length===0||i.x>this.max.x||this.min.x>i.x||i.y>this.max.y||this.min.y>i.y)return;const h=Nd(i.x-this.min.x,this.xScale,this.cellsX),f=Nd(i.y-this.min.y,this.yScale,this.cellsY),_=this.cells[f*this.cellsX+h];if(_){this._lazyInitLookup();for(let y=0;y<_.len;y++){const x=this.payload[_.start+y],C=Math.floor(x/8),I=1<<x%8;if(!(this.lookup[C]&I)&&(this.lookup[C]|=I,a.push(x),a.length===this.triangleCount))return}}}query(i,a,h){if(this.triangleCount===0||this.cells.length===0||i.x>this.max.x||this.min.x>a.x||i.y>this.max.y||this.min.y>a.y)return;this._lazyInitLookup();const f=Nd(i.x-this.min.x,this.xScale,this.cellsX),_=Nd(a.x-this.min.x,this.xScale,this.cellsX),y=Nd(i.y-this.min.y,this.yScale,this.cellsY),x=Nd(a.y-this.min.y,this.yScale,this.cellsY);for(let C=y;C<=x;C++)for(let I=f;I<=_;I++){const R=this.cells[C*this.cellsX+I];if(R)for(let P=0;P<R.len;P++){const L=this.payload[R.start+P],$=Math.floor(L/8),j=1<<L%8;if(!(this.lookup[$]&j)&&(this.lookup[$]|=j,h.push(L),h.length===this.triangleCount))return}}}}function Nd(l,i,a){return Math.max(0,Math.min(a-1,Math.floor(l*i)))}en(_1,"TriangleGridIndex");class Ek{constructor(i){this.zoom=i.zoom,this.layers=i.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=i.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.footprints=[],this.worldview=i.worldview}updateFootprints(i,a){for(const h of this.footprints)a.push({footprint:h,id:i})}populate(i,a,h,f){const _=[];for(const{feature:y,id:x,index:C,sourceLayerIndex:I}of i){const R=this.layers[0]._featureFilter.needGeometry,P=Lt(y,R);if(!this.layers[0]._featureFilter.filter(new Tr(this.zoom,{worldview:this.worldview}),P,h))continue;const L={id:x,properties:y.properties,type:y.type,sourceLayerIndex:I,index:C,geometry:R?P.geometry:rn(y,h,f),patterns:{}};_.push(L)}for(const y of _){const{geometry:x,index:C,sourceLayerIndex:I}=y;this.addFeature(y,x,C,h,{},a.availableImages,a.brightness),a.featureIndex.insert(i[C].feature,x,C,I,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(i){}update(i,a,h,f,_,y,x){}destroy(){}addFeature(i,a,h,f,_,y=[],x){for(const C of tv(a,2)){const I=[],R=[],P=[],L=new Dt(1/0,1/0),$=new Dt(-1/0,-1/0);for(const Z of C)if(Z.length!==0){Z!==C[0]&&P.push(R.length/2);for(let K=0;K<Z.length;K++)R.push(Z[K].x),R.push(Z[K].y),I.push(Z[K]),L.x=Math.min(L.x,Z[K].x),L.y=Math.min(L.y,Z[K].y),$.x=Math.max($.x,Z[K].x),$.y=Math.max($.y,Z[K].y)}const j=a_(R,P),q=new _1(I,j,8,256);this.footprints.push({vertices:I,indices:j,grid:q,min:L,max:$})}}}en(Ek,"ClipBucket",{omit:["layers"]});const j7=ki([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),U7=ki([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),H7=ki([{name:"a_centroid_pos",components:2,type:"Uint16"}]),G7=ki([{name:"a_join_normal_inside",components:3,type:"Int16"}]),W7=ki([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),q7=ki([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Z7}=j7,nv=Number.MAX_SAFE_INTEGER,Ik=nv-1;function Ak(l,i,a,h){return l.order<i||l.order===nv||!(l.clipMask&a)||function(f,_){return _.length!==0&&_.find(y=>y===f)===void 0}(h,l.clipScope)}function y1(l,i){return l.x-i.x||l.y-i.y}function kk(l,i){return y1(l.min,i.min)===0&&y1(l.max,i.max)===0}function bC(l,i){return!(l.min.x>i.max.x||l.max.x<i.min.x||l.min.y>i.max.y||l.max.y<i.min.y)}function v1(l,i){if(l.length!==i.length)return!1;for(let a=0;a<l.length;a++)if(l[a].sourceId!==i[a].sourceId||!kk(l[a],i[a])||l[a].order!==i[a].order||l[a].clipMask!==i[a].clipMask||!bl(l[a].clipScope,i[a].clipScope))return!1;return!0}function Rk(l,i,a){const h=1/Ut,f=1/(1<<a.canonical.z),_=(i.x*h+a.canonical.x)*f+a.wrap,y=(i.y*h+a.canonical.y)*f;return{min:new Dt((l.x*h+a.canonical.x)*f+a.wrap,(l.y*h+a.canonical.y)*f),max:new Dt(_,y)}}function K7(l,i,a){const h=1<<a.canonical.z,f=((i.x-a.wrap)*h-a.canonical.x)*Ut,_=(i.y*h-a.canonical.y)*Ut;return{min:new Dt(((l.x-a.wrap)*h-a.canonical.x)*Ut,(l.y*h-a.canonical.y)*Ut),max:new Dt(f,_)}}function xC(l,i,a,h,f,_,y){const x=l.indices,C=l.vertices,I=[];for(let R=h;R<h+f;R+=3){const P=i[a[R+0]+_],L=i[a[R+1]+_],$=i[a[R+2]+_],j=Math.min(P.x,L.x,$.x),q=Math.max(P.x,L.x,$.x),Z=Math.min(P.y,L.y,$.y),K=Math.max(P.y,L.y,$.y);I.length=0,l.grid.query(new Dt(j,Z),new Dt(q,K),I);for(let ae=0;ae<I.length;ae++){const ue=I[ae];if(Gu(C[x[3*ue+0]],C[x[3*ue+1]],C[x[3*ue+2]],P,L,$,y))return!0}}return!1}function Pk(l,i,a,h){if(!l||!a)return!1;let f=l.vertices;if(!i.canonical.equals(h.canonical)||i.wrap!==h.wrap){if(a.vertices.length<l.vertices.length)return Pk(a,h,l,i);const _=i.canonical,y=h.canonical,x=Math.pow(2,y.z-_.z);f=l.vertices.map(C=>new Dt((C.x+_.x*Ut)*x-y.x*Ut,(C.y+_.y*Ut)*x-y.y*Ut))}return xC(a,f,l.indices,0,l.indices.length,0,0)}function Mk(l,i,a,h){const f=Math.pow(2,h.z-a.z);return new Dt((l+a.x*Ut)*f-h.x*Ut,(i+a.y*Ut)*f-h.y*Ut)}function wC(l,i){const a=[];i.grid.queryPoint(l,a);const h=i.indices,f=i.vertices;for(let _=0;_<a.length;_++){const y=a[_];if(Os([f[h[3*y+0]],f[h[3*y+1]],f[h[3*y+2]]],l))return!0}return!1}const SC=[new Dt(0,0),new Dt(Ut,0),new Dt(Ut,Ut),new Dt(0,Ut)];function Dk(l,i){const a=[];let h=[];if(!i||l.length<2)return[l];if(l.length===2)return aa(l[0],l[1],SC)?[l]:[];for(let f=0;f<l.length+2;f++){const _=l[f%l.length],y=l[(f+1)%l.length],x=aa(f===0?l[l.length-1]:l[(f-1)%l.length],_,SC),C=aa(_,y,SC),I=x||C;I&&h.push(_),I&&C||h.length>0&&(h.length>1&&a.push(h),h=[])}return h.length>1&&a.push(h),a}const CC=Rt.types,X7=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],Y7=["fill-extrusion-flood-light-ground-radius"],J7=Math.pow(2,13),Q7=Math.pow(2,15)-1,Ok=new Dt(0,1),ep=2147483648;function iv(l,i,a,h,f,_,y,x){l.emplaceBack((i<<1)+y,(a<<1)+_,(Math.floor(h*J7)<<1)+f,Math.round(x))}function rv(l,i,a){l.emplaceBack(i.x*Ut,i.y*Ut,a?1:0)}function b1(l,i,a,h,f,_){l.emplaceBack(i.x,i.y,(a.x<<1)+h,(a.y<<1)+f,_)}function ov(l,i,a){l.emplaceBack(i.x,i.y,i.z,a[0]*16384,a[1]*16384,a[2]*16384)}class Lk{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class zk{constructor(){this.centroidXY=new Dt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Dt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Dt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0,this.buildingId=0}span(){return new Dt(this.max.x-this.min.x,this.max.y-this.min.y)}}class Bk{constructor(){this.acc=new Dt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(i,a){i.min.x===Number.MAX_VALUE&&(i.min.x=i.max.x=a.x,i.min.y=i.max.y=a.y)}appendEdge(i,a,h){this.accCount++,this.acc._add(a);let f=!!this.borders;a.x<i.min.x?(i.min.x=a.x,f=!0):a.x>i.max.x&&(i.max.x=a.x,f=!0),a.y<i.min.y?(i.min.y=a.y,f=!0):a.y>i.max.y&&(i.max.y=a.y,f=!0),((a.x===0||a.x===Ut)&&a.x===h.x)!=((a.y===0||a.y===Ut)&&a.y===h.y)&&this.processBorderOverlap(a,h),f&&this.checkBorderIntersection(a,h)}checkBorderIntersection(i,a){a.x<0!=i.x<0&&this.addBorderIntersection(0,Pn(a.y,i.y,(0-a.x)/(i.x-a.x))),a.x>Ut!=i.x>Ut&&this.addBorderIntersection(1,Pn(a.y,i.y,(Ut-a.x)/(i.x-a.x))),a.y<0!=i.y<0&&this.addBorderIntersection(2,Pn(a.x,i.x,(0-a.y)/(i.y-a.y))),a.y>Ut!=i.y>Ut&&this.addBorderIntersection(3,Pn(a.x,i.x,(Ut-a.y)/(i.y-a.y)))}addBorderIntersection(i,a){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const h=this.borders[i];a<h[0]&&(h[0]=a),a>h[1]&&(h[1]=a)}processBorderOverlap(i,a){if(i.x===a.x){if(i.y===a.y)return;const h=i.x===0?0:1;this.addBorderIntersection(h,a.y),this.addBorderIntersection(h,i.y)}else{const h=i.y===0?2:3;this.addBorderIntersection(h,a.x),this.addBorderIntersection(h,i.x)}}centroid(){return this.accCount===0?new Dt(0,0):new Dt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((i,a)=>i+ +(a[0]!==Number.MAX_VALUE),0):0}}function Fk(l,i){const a=l.add(i)._unit(),h=Le(l.x*a.x+l.y*a.y,-1,1);var f,_,y;return f=Math.acos(h),Math.min(4,Math.max(-4,Math.tan(f)))/4*Q7*((_=l).x*(y=i).y-_.y*y.x<0?-1:1)}const e9=[l=>l.x<0,l=>l.x>Ut,l=>l.y<0,l=>l.y>Ut];function t9(l,i,a,h){const f=[4];if(h===0)return f;a._mult(h);const _=l.sub(a),y=i.sub(a),x=[l,i,_,y];for(let C=0;C<4;C++)for(const I of x)if(e9[C](I)){f.push(C);break}return f}class TC{constructor(i){this.vertexArray=new By,this.indexArray=new bs,this.programConfigurations=new Ic(i.layers,{zoom:i.zoom,lut:i.lut},a=>Y7.includes(a)),this._segments=new ro,this.hiddenByLandmarkVertexArray=new t_,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new ro}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(i,a,h,f=!1){const _=i.length;if(_>2){let y=Math.max(0,this._segments.get().length-1);const x=this._segments._prepareSegment(4*_,this.vertexArray.length,2*this._segmentToGroundQuads[y].length);let C;y!==this._segments.get().length-1&&(y++,this._segmentToGroundQuads[y]=[],this._segmentToRegionTriCounts[y]=[0,0,0,0,0]);{const I=i[0],R=i[1];C=Fk(I.sub(i[_-1])._perp()._unit(),R.sub(I)._perp()._unit())}for(let I=0;I<_;I++){const R=I===_-1?0:I+1,P=i[I],L=i[R],$=i[R===_-1?0:R+1],j=L.sub(P)._perp()._unit(),q=Fk(j,$.sub(L)._perp()._unit()),Z=C,K=q;if(EC(P,L,a)||f&&$k(P,a)&&$k(L,a)){C=q;continue}const ae=x.vertexLength;b1(this.vertexArray,P,L,1,1,Z),b1(this.vertexArray,P,L,1,0,Z),b1(this.vertexArray,P,L,0,1,K),b1(this.vertexArray,P,L,0,0,K),x.vertexLength+=4;const ue=t9(P,L,j,h);for(const fe of ue)this._segmentToGroundQuads[y].push({id:ae,region:fe}),this._segmentToRegionTriCounts[y][fe]+=2,x.primitiveLength+=2;C=q}}}prepareBorderSegments(){if(!this.hasData())return;const i=this._segments.get(),a=i.length;for(let h=0;h<a;h++)this._segmentToGroundQuads[h].sort((f,_)=>f.region-_.region);for(let h=0;h<a;h++){const f=this._segmentToGroundQuads[h],_=i[h],y=this._segmentToRegionTriCounts[h];y.reduce((C,I)=>C+I,0);let x=0;for(let C=0;C<=4;C++){const I=y[C];if(I!==0){let R=this.regionSegments[C];R||(R=this.regionSegments[C]=new ro);const P={vertexOffset:_.vertexOffset,primitiveOffset:_.primitiveOffset+x,vertexLength:_.vertexLength,primitiveLength:I};R.get().push(P)}x+=I}for(let C=0;C<f.length;C++){const I=f[C].id;this.indexArray.emplaceBack(I,I+1,I+3),this.indexArray.emplaceBack(I,I+3,I+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(i,a,h,f,_,y,x){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,i,a,h,f,_,y,void 0,x)}upload(i){this.hasData()&&(this.vertexBuffer=i.createVertexBuffer(this.vertexArray,U7.members),this.indexBuffer=i.createIndexBuffer(this.indexArray))}uploadPaintProperties(i){this.hasData()&&this.programConfigurations.upload(i)}update(i,a,h,f,_,y,x,C){this.hasData()&&this.programConfigurations.updatePaintArrays(i,a,h,f,_,y,x,C)}updateHiddenByLandmark(i){this.updateHiddenByLandmarkRange(i.groundVertexArrayOffset,i.groundVertexCount,!!(i.flags&ep))}updateHiddenByLandmarkRange(i,a,h){if(!this.hasData())return;const f=a+i;if(a!==0){for(let _=i;_<f;++_)this.hiddenByLandmarkVertexArray.emplace(_,h?1:0);this._needsHiddenByLandmarkUpdate=!0}}uploadHiddenByLandmark(i){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=i.createVertexBuffer(this.hiddenByLandmarkVertexArray,W7.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let i=0;i<=4;i++){const a=this.regionSegments[i];a&&a.destroy()}}}}class x1{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.overscaling=i.overscaling,this.layers=i.layers,this.pixelRatio=i.pixelRatio,this.layerIds=this.layers.map(a=>a.fqid),this.index=i.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=i.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new bs,this.footprintVertices=new Md,this.footprintSegments=[],this.layoutVertexArray=new kh,this.centroidVertexArray=new r1,this.wallVertexArray=new s1,this.indexArray=new bs,this.programConfigurations=new Ic(i.layers,{zoom:i.zoom,lut:i.lut},a=>X7.includes(a)),this.segments=new ro,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.groundEffect=new TC(i),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[],this.worldview=i.worldview}updateFootprints(i,a){}populate(i,a,h,f){this.features=[],this.hasPattern=mC("fill-extrusion",this.layers,this.pixelRatio,a),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=et(h),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:_,id:y,index:x,sourceLayerIndex:C}of i){const I=this.layers[0]._featureFilter.needGeometry,R=Lt(_,I);if(!this.layers[0]._featureFilter.filter(new Tr(this.zoom,{worldview:this.worldview}),R,h))continue;const P={id:y,sourceLayerIndex:C,index:x,geometry:I?R.geometry:rn(_,h,f),properties:_.properties,type:_.type,patterns:{}},L=this.layoutVertexArray.length,$=CC[P.type]==="Polygon";if(this.hasPattern)this.features.push({featureId:_.id,feature:gC("fill-extrusion",this.layers,P,this.zoom,this.pixelRatio,a)});else if(this.wallMode)for(const j of P.geometry)for(const q of Dk(j,$))this.addFeature(_.id,P,[q],x,h,{},a.availableImages,f,a.brightness);else this.addFeature(_.id,P,P.geometry,x,h,{},a.availableImages,f,a.brightness);a.featureIndex.insert(_,P.geometry,x,C,this.index,L)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(i,a,h,f,_,y){for(const{featureId:x,feature:C}of this.features){const I=CC[C.type]==="Polygon",{geometry:R}=C;if(this.wallMode)for(const P of R)for(const L of Dk(P,I))this.addFeature(x,C,[L],C.index,a,h,f,_,y);else this.addFeature(x,C,R,C.index,a,h,f,_,y)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(i,a,h,f,_,y,x){this.programConfigurations.updatePaintArrays(i,a,_,h,f,y,x,this.worldview),this.groundEffect.update(i,a,_,h,f,y,x,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Z7),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.wallVertexBuffer=i.createVertexBuffer(this.wallVertexArray,G7.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=i.createVertexBuffer(this.layoutVertexExtArray,q7.members,!0)),this.groundEffect.upload(i)),this.groundEffect.uploadPaintProperties(i),this.programConfigurations.upload(i),this.uploaded=!0}uploadCentroid(i){this.groundEffect.uploadHiddenByLandmark(i),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,H7.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,a,h,f,_,y,x,C,I){const R=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(a,{})/this.tileToMeter,P=[new Dt(0,0),new Dt(Ut,Ut)],L=C.projection,$=L.name==="globe",j=this.wallMode||CC[a.type]==="Polygon",q=new Bk;q.centroidDataIndex=this.centroidData.length;const Z=new zk;Z.buildingId=i,a.properties&&a.properties.hasOwnProperty("building_id")&&(Z.buildingId=a.properties.building_id);const K=this.layers[0].paint.get("fill-extrusion-base").evaluate(a,{},_)<=0,ae=this.layers[0].paint.get("fill-extrusion-height").evaluate(a,{},_);let ue;if(Z.height=ae,Z.vertexArrayOffset=this.layoutVertexArray.length,Z.groundVertexArrayOffset=this.groundEffect.vertexArray.length,$&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Xg),this.wallMode){if($)return void li("Non zero fill-extrusion-line-width is not yet supported on globe.");if(h.length!==1)return;ue=function(Je){const bt=Je[0].x===Je[Je.length-1].x&&Je[0].y===Je[Je.length-1].y;(function(Ht){let Tn=0;const qn=Ht.length;for(let Jt=0;Jt<qn;Jt++)Tn+=(Ht[(Jt+1)%qn].x-Ht[Jt].x)*(Ht[(Jt+1)%qn].y+Ht[Jt].y);return Tn>=0})(Je)||(Je=Je.reverse());const Tt={geometry:[],joinNormals:[],indices:[]},It=[],zt=[],mt=[];let At=Je.length;for(;At>=2&&Je[At-1].equals(Je[At-2]);)At--;if(At<(bt?3:2))return Tt;let ct,rt,Bt,Ot,En,ln=0;for(;ln<At-1&&Je[ln].equals(Je[ln+1]);)ln++;bt&&(ct=Je[At-2],En=Je[ln].sub(ct)._unit()._perp());for(let Ht=ln;Ht<At;Ht++){if(Bt=Ht===At-1?bt?Je[ln+1]:void 0:Je[Ht+1],Bt&&Je[Ht].equals(Bt))continue;En&&(Ot=En),ct&&(rt=ct),ct=Je[Ht],En=Bt?Bt.sub(ct)._unit()._perp():Ot,Ot=Ot||En;let Tn=Ot.add(En);Tn.x===0&&Tn.y===0||Tn._unit();const qn=Tn.x*En.x+Tn.y*En.y,Jt=qn!==0?1/qn:1/0,vn=Ot.x*En.y-Ot.y*En.x>0;let Fn="miter";const Yn=2;Fn==="miter"&&Jt>Yn&&(Fn="bevel"),Fn==="bevel"&&(Jt>100&&(Fn="flipbevel"),Jt<Yn&&(Fn="miter"));const gi=(ii,un,Qn,Pi)=>{const ge=new Dt(ii.x,ii.y),ye=new Dt(ii.x,ii.y);ge.x+=un.x*Pi,ge.y+=un.y*Pi,ye.x-=un.x*Math.max(Qn,1),ye.y-=un.y*Math.max(Qn,1),mt.push(un),It.push(ge),zt.push(ye)};if(Fn==="miter")Tn._mult(Jt),gi(ct,Tn,0,0);else if(Fn==="flipbevel")Tn=En.mult(-1),gi(ct,Tn,0,0),gi(ct,Tn.mult(-1),0,0);else{const ii=-Math.sqrt(Jt*Jt-1),un=vn?ii:0,Qn=vn?0:ii;rt&&gi(ct,Ot,un,Qn),Bt&&gi(ct,En,un,Qn)}}Tt.geometry=[...It,...zt.reverse(),It[0]],Tt.joinNormals=[...mt,...mt.reverse(),mt[mt.length-1]];const pn=Tt.geometry.length-1;for(let Ht=0;Ht<pn/2;Ht++)if(Ht+1<pn/2){let Tn=Ht,qn=Ht+1,Jt=pn-1-Ht,vn=pn-2-Ht;Tn=Tn===0?pn-1:Tn-1,qn=qn===0?pn-1:qn-1,Jt=Jt===0?pn-1:Jt-1,vn=vn===0?pn-1:vn-1,Tt.indices.push(Jt),Tt.indices.push(qn),Tt.indices.push(Tn),Tt.indices.push(Jt),Tt.indices.push(vn),Tt.indices.push(qn)}return Tt}(h[0]),h=[ue.geometry]}const fe=(Je,bt)=>Je<(bt.length-1)/2||Je===bt.length-1,Me=this.wallMode?[h]:tv(h,500);for(let Je=Me.length-1;Je>=0;Je--){const bt=Me[Je];(bt.length===0||(De=bt[0]).every(Mt=>Mt.x<=0)||De.every(Mt=>Mt.x>=Ut)||De.every(Mt=>Mt.y<=0)||De.every(Mt=>Mt.y>=Ut))&&Me.splice(Je,1)}var De;let Ve;if($)Ve=Gk(Me,P,_);else{Ve=[];for(const Je of Me)Ve.push({polygon:Je,bounds:P})}const He=j?this.edgeRadius:0,Ze=He>0&&this.zoom<17,_t=(Je,bt)=>{if(Je.length===0)return!1;const Mt=Je[Je.length-1];return bt.x===Mt.x&&bt.y===Mt.y};for(const{polygon:Je,bounds:bt}of Ve){let Mt=0,Tt=0;for(const At of Je)j&&!At[0].equals(At[At.length-1])&&At.push(At[0]),Tt+=j?At.length-1:At.length;const It=this.segments.prepareSegment((j?5:4)*Tt,this.layoutVertexArray,this.indexArray);Z.footprintSegIdx<0&&(Z.footprintSegIdx=this.footprintSegments.length),Z.polygonSegIdx<0&&(Z.polygonSegIdx=this.polygonSegments.length);const zt={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},mt=new Lk;if(mt.vertexOffset=this.footprintVertices.length,mt.indexOffset=3*this.footprintIndices.length,mt.ringIndices=[],j){const At=[],ct=[];Mt=It.vertexLength;for(let Bt=0;Bt<Je.length;Bt++){const Ot=Je[Bt];Ot.length&&Bt!==0&&ct.push(At.length/2);const En=[];let ln,pn;ln=Ot[1].sub(Ot[0])._perp()._unit(),mt.ringIndices.push(Ot.length-1);for(let Ht=1;Ht<Ot.length;Ht++){const Tn=Ot[Ht],qn=Ot[Ht===Ot.length-1?1:Ht+1],Jt=Tn.clone();if(He){pn=qn.sub(Tn)._perp()._unit();const vn=ln.add(pn)._unit(),Fn=He*Math.min(4,1/(ln.x*vn.x+ln.y*vn.y));Jt.x+=Fn*vn.x,Jt.y+=Fn*vn.y,Jt.x=Math.round(Jt.x),Jt.y=Math.round(Jt.y),ln=pn}if(!K||He!==0&&!Ze||_t(En,Jt)||En.push(Jt),iv(this.layoutVertexArray,Jt.x,Jt.y,0,0,1,1,0),this.wallMode){const vn=fe(Ht,Ot);rv(this.wallVertexArray,ue.joinNormals[Ht],!vn)}It.vertexLength++,this.footprintVertices.emplaceBack(Tn.x,Tn.y),At.push(Tn.x,Tn.y),$&&ov(this.layoutVertexExtArray,L.projectTilePoint(Jt.x,Jt.y,_),L.upVector(_,Jt.x,Jt.y))}K&&(He===0||Ze)&&(En.length!==0&&_t(En,En[0])&&En.pop(),this.groundEffect.addData(En,bt,R))}const rt=this.wallMode?ue.indices:a_(At,ct);for(let Bt=0;Bt<rt.length;Bt+=3)this.footprintIndices.emplaceBack(mt.vertexOffset+rt[Bt+0],mt.vertexOffset+rt[Bt+1],mt.vertexOffset+rt[Bt+2]),this.indexArray.emplaceBack(Mt+rt[Bt],Mt+rt[Bt+2],Mt+rt[Bt+1]),It.primitiveLength++;mt.indexCount+=rt.length,mt.vertexCount+=this.footprintVertices.length-mt.vertexOffset}for(let At=0;At<Je.length;At++){const ct=Je[At];q.startRing(Z,ct[0]);let rt=ct.length>4&&jk(ct[ct.length-2],ct[0],ct[1]),Bt=He?n9(ct[ct.length-2],ct[0],ct[1],He):0;const Ot=[];let En,ln,pn;ln=ct[1].sub(ct[0])._perp()._unit();let Ht=!0;for(let Tn=1,qn=0;Tn<ct.length;Tn++){let Jt=ct[Tn-1],vn=ct[Tn];const Fn=ct[Tn===ct.length-1?1:Tn+1];if(q.appendEdge(Z,vn,Jt),EC(vn,Jt,bt)){He&&(ln=Fn.sub(vn)._perp()._unit(),Ht=!Ht);continue}const Yn=vn.sub(Jt)._perp(),gi=Yn.x/(Math.abs(Yn.x)+Math.abs(Yn.y)),ii=Yn.y>0?1:0,un=Jt.dist(vn);if(qn+un>32768&&(qn=0),He){pn=Fn.sub(vn)._perp()._unit();let ye=Vk(Jt,vn,Fn,Nk(ln,pn),He);isNaN(ye)&&(ye=0);const lt=vn.sub(Jt)._unit();Jt=Jt.add(lt.mult(Bt))._round(),vn=vn.add(lt.mult(-ye))._round(),Bt=ye,ln=pn,K&&this.zoom>=17&&(_t(Ot,Jt)||Ot.push(Jt),_t(Ot,vn)||Ot.push(vn))}const Qn=It.vertexLength,Pi=ct.length>4&&jk(Jt,vn,Fn);let ge=Uk(qn,rt,Ht);if(iv(this.layoutVertexArray,Jt.x,Jt.y,gi,ii,0,0,ge),iv(this.layoutVertexArray,Jt.x,Jt.y,gi,ii,0,1,ge),this.wallMode){const ye=fe(Tn-1,ct),lt=ue.joinNormals[Tn-1];rv(this.wallVertexArray,lt,ye),rv(this.wallVertexArray,lt,ye)}if(qn+=un,ge=Uk(qn,Pi,!Ht),rt=Pi,iv(this.layoutVertexArray,vn.x,vn.y,gi,ii,0,0,ge),iv(this.layoutVertexArray,vn.x,vn.y,gi,ii,0,1,ge),this.wallMode){const ye=fe(Tn,ct),lt=ue.joinNormals[Tn];rv(this.wallVertexArray,lt,ye),rv(this.wallVertexArray,lt,ye)}if(It.vertexLength+=4,this.indexArray.emplaceBack(Qn+0,Qn+1,Qn+2),this.indexArray.emplaceBack(Qn+1,Qn+3,Qn+2),It.primitiveLength+=2,He){const ye=Mt+(Tn===1?ct.length-2:Tn-2),lt=Tn===1?Mt:ye+1;if(this.indexArray.emplaceBack(Qn+1,ye,Qn+3),this.indexArray.emplaceBack(ye,lt,Qn+3),It.primitiveLength+=2,En===void 0&&(En=Qn),!EC(Fn,ct[Tn],bt)){const gt=Tn===ct.length-1?En:It.vertexLength;this.indexArray.emplaceBack(Qn+2,Qn+3,gt),this.indexArray.emplaceBack(Qn+3,gt+1,gt),this.indexArray.emplaceBack(Qn+3,lt,gt+1),It.primitiveLength+=3}Ht=!Ht}if($){const ye=this.layoutVertexExtArray,lt=L.projectTilePoint(Jt.x,Jt.y,_),gt=L.projectTilePoint(vn.x,vn.y,_),Xt=L.upVector(_,Jt.x,Jt.y),Kt=L.upVector(_,vn.x,vn.y);ov(ye,lt,Xt),ov(ye,lt,Xt),ov(ye,gt,Kt),ov(ye,gt,Kt)}}j&&(Mt+=ct.length-1),K&&He&&this.zoom>=17&&(Ot.length!==0&&_t(Ot,Ot[0])&&Ot.pop(),this.groundEffect.addData(Ot,bt,R,He>0))}this.footprintSegments.push(mt),zt.triangleCount=this.indexArray.length-zt.triangleArrayOffset,this.polygonSegments.push(zt),++Z.footprintSegLen,++Z.polygonSegLen}if(Z.vertexCount=this.layoutVertexArray.length-Z.vertexArrayOffset,Z.groundVertexCount=this.groundEffect.vertexArray.length-Z.groundVertexArrayOffset,Z.vertexCount!==0){if(Z.centroidXY=q.borders?Ok:this.encodeCentroid(q,Z),this.centroidData.push(Z),q.borders){this.featuresOnBorder.push(q);const Je=this.featuresOnBorder.length-1;for(let bt=0;bt<q.borders.length;bt++)q.borders[bt][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[bt].push(Je)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,y,x,_,I,void 0,this.worldview),this.groundEffect.addPaintPropertiesData(a,f,y,x,_,I,this.worldview),this.maxHeight=Math.max(this.maxHeight,ae)}}sortBorders(){for(let i=0;i<this.borderFeatureIndices.length;i++)this.borderFeatureIndices[i].sort((a,h)=>this.featuresOnBorder[a].borders[i][0]-this.featuresOnBorder[h].borders[i][0])}splitToSubtiles(){const i=[];for(let x=0;x<this.centroidData.length;x++){const C=this.centroidData[x],I=+(C.min.y+C.max.y>Ut),R=2*I+(+(C.min.x+C.max.x>Ut)^I);for(let P=0;P<C.polygonSegLen;P++){const L=C.polygonSegIdx+P;i.push({centroidIdx:x,subtile:R,polygonSegmentIdx:L,triangleSegmentIdx:this.polygonSegments[L].triangleSegIdx})}}const a=new bs;i.sort((x,C)=>x.triangleSegmentIdx===C.triangleSegmentIdx?x.subtile-C.subtile:x.triangleSegmentIdx-C.triangleSegmentIdx);let h=0,f=0,_=0;for(const x of i){if(x.triangleSegmentIdx!==h)break;_++}const y=i.length;for(;f!==i.length;){h=i[f].triangleSegmentIdx;let x=0,C=f,I=f;for(let R=C;R<_&&i[R].subtile===x;R++)I++;for(;C!==_;){const R=i[C];x=R.subtile;const P=this.centroidData[R.centroidIdx].min.clone(),L=this.centroidData[R.centroidIdx].max.clone(),$={vertexOffset:this.segments.segments[h].vertexOffset,primitiveOffset:a.length,vertexLength:this.segments.segments[h].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let j=C;j<I;j++){const q=i[j],Z=this.polygonSegments[q.polygonSegmentIdx],K=this.centroidData[q.centroidIdx].min,ae=this.centroidData[q.centroidIdx].max,ue=this.indexArray.uint16;for(let fe=Z.triangleArrayOffset;fe<Z.triangleArrayOffset+Z.triangleCount;fe++)a.emplaceBack(ue[3*fe],ue[3*fe+1],ue[3*fe+2]);$.primitiveLength+=Z.triangleCount,P.x=Math.min(P.x,K.x),P.y=Math.min(P.y,K.y),L.x=Math.max(L.x,ae.x),L.y=Math.max(L.y,ae.y)}$.primitiveLength>0&&this.triangleSubSegments.push({segment:$,min:P,max:L}),C=I;for(let j=C;j<_&&i[j].subtile===i[C].subtile;j++)I++}f=_;for(let R=f;R<y&&i[R].triangleSegmentIdx===i[f].triangleSegmentIdx;R++)_++}a._trim(),this.indexArray=a}getVisibleSegments(i,a,h){const f=new ro;if(this.wallMode){for(const q of this.triangleSubSegments)f.segments.push(q.segment);return f}let _=0,y=0;const x=1<<i.canonical.z;if(a){const q=a.getMinMaxForTile(i);q&&(_=q.min,y=q.max)}y+=this.maxHeight;const C=i.toUnwrapped();let I;const R=[C.canonical.x/x+C.wrap,C.canonical.y/x],P=[(C.canonical.x+1)/x+C.wrap,(C.canonical.y+1)/x],L=(q,Z,K)=>[q[0]*(1-K[0])+Z[0]*K[0],q[1]*(1-K[1])+Z[1]*K[1]],$=[],j=[];for(const q of this.triangleSubSegments){$[0]=q.min.x/Ut,$[1]=q.min.y/Ut,j[0]=q.max.x/Ut,j[1]=q.max.y/Ut;const Z=L(R,P,$),K=L(R,P,j);if(new Vn([Z[0],Z[1],_],[K[0],K[1],y]).intersectsPrecise(h)===0){I&&(f.segments.push(I),I=void 0);continue}const ae=q.segment;I&&I.vertexOffset!==ae.vertexOffset&&(f.segments.push(I),I=void 0),I?(I.vertexLength+=ae.vertexLength,I.primitiveLength+=ae.primitiveLength):I={vertexOffset:ae.vertexOffset,primitiveLength:ae.primitiveLength,vertexLength:ae.vertexLength,primitiveOffset:ae.primitiveOffset,sortKey:void 0,vaos:{}}}return I&&f.segments.push(I),f}encodeCentroid(i,a){const h=i.centroid(),f=a.span(),_=Math.min(7,Math.round(f.x*this.tileToMeter/10)),y=Math.min(7,Math.round(f.y*this.tileToMeter/10));return new Dt(Le(h.x,1,Ut-1)<<3|_,Le(h.y,1,Ut-1)<<3|y)}encodeBorderCentroid(i){if(!i.borders)return new Dt(0,0);const a=i.borders,h=Number.MAX_VALUE;if(a[0][0]!==h||a[1][0]!==h){const f=a[0][0]!==h?0:1;return new Dt(6|(a[0][0]!==h?0:65528),(a[f][0]+a[f][1])/2<<3|6)}{const f=a[2][0]!==h?2:3;return new Dt((a[f][0]+a[f][1])/2<<3|6,6|(a[2][0]!==h?0:65528))}}showCentroid(i){const a=this.centroidData[i.centroidDataIndex];a.flags&=2147483647,a.centroidXY.x=0,a.centroidXY.y=0,this.writeCentroidToBuffer(a)}writeCentroidToBuffer(i){this.groundEffect.updateHiddenByLandmark(i);const a=i.vertexArrayOffset,h=i.vertexCount+i.vertexArrayOffset,f=i.flags&ep?Ok:i.centroidXY,_=this.centroidVertexArray.geta_centroid_pos0(a);if(this.centroidVertexArray.geta_centroid_pos1(a)!==f.y||_!==f.x){for(let y=a;y<h;++y)this.centroidVertexArray.emplace(y,f.x,f.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const i of this.centroidData)this.writeCentroidToBuffer(i)}updateReplacement(i,a,h){if(a.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=a.updateTime;const f=a.getReplacementRegionsForTile(i.toUnwrapped());if(v1(this.activeReplacements,f))return;if(this.activeReplacements=f,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const y of this.centroidData)y.flags&=2147483647;const _=[];for(const y of this.activeReplacements){if(y.order<h)continue;const x=Math.max(1,Math.pow(2,y.footprintTileId.canonical.z-i.canonical.z));if(y.footprint.buildingId){const C=y.footprint.buildingId;for(const I of this.centroidData)I.buildingId===C&&(I.flags|=ep)}else for(const C of this.centroidData)if(!(C.flags&ep||y.min.x>C.max.x||C.min.x>y.max.x||y.min.y>C.max.y||C.min.y>y.max.y))for(let I=0;I<C.footprintSegLen;I++){const R=this.footprintSegments[C.footprintSegIdx+I];if(_.length=0,i9(this.footprintVertices,R.vertexOffset,R.vertexCount,y.footprintTileId.canonical,i.canonical,_),xC(y.footprint,_,this.footprintIndices.uint16,R.indexOffset,R.indexCount,-R.vertexOffset,-x)){C.flags|=ep;break}}}for(const y of this.centroidData)this.writeCentroidToBuffer(y);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(i,a,h){let f=!1;for(let _=0;_<h.footprintSegLen;_++){const y=this.footprintSegments[h.footprintSegIdx+_];let x=0;for(const C of y.ringIndices){for(let I=x,R=C+x-1;I<C+x;R=I++){const P=this.footprintVertices.int16[2*(I+y.vertexOffset)+0],L=this.footprintVertices.int16[2*(I+y.vertexOffset)+1],$=this.footprintVertices.int16[2*(R+y.vertexOffset)+1];L>a!=$>a&&i<(this.footprintVertices.int16[2*(R+y.vertexOffset)+0]-P)*(a-L)/($-L)+P&&(f=!f)}x=C}}return f}getHeightAtTileCoord(i,a){let h=Number.NEGATIVE_INFINITY,f=!0;const _=4*(i+Ut)*Ut+(a+Ut);if(this.partLookup.hasOwnProperty(_)){const y=this.partLookup[_];return y?{height:y.height,hidden:!!(y.flags&ep)}:void 0}for(const y of this.centroidData)i>y.max.x||y.min.x>i||a>y.max.y||y.min.y>a||y.height<=h||this.footprintContainsPoint(i,a,y)&&(h=y.height,this.partLookup[_]=y,f=!!(y.flags&ep));if(h!==Number.NEGATIVE_INFINITY)return{height:h,hidden:f};this.partLookup[_]=void 0}}function Nk(l,i){const a=l.add(i)._unit();return l.x*a.x+l.y*a.y}function n9(l,i,a,h){const f=i.sub(l)._perp()._unit(),_=a.sub(i)._perp()._unit();return Vk(l,i,a,Nk(f,_),h)}function Vk(l,i,a,h,f){const _=Math.sqrt(1-h*h);return Math.min(l.dist(i)/3,i.dist(a)/3,f*_/h)}function EC(l,i,a){return l.x<a[0].x&&i.x<a[0].x||l.x>a[1].x&&i.x>a[1].x||l.y<a[0].y&&i.y<a[0].y||l.y>a[1].y&&i.y>a[1].y}function $k(l,i){return l.x<i[0].x||l.x>i[1].x||l.y<i[0].y||l.y>i[1].y}function jk(l,i,a){if(l.x<0||l.x>=Ut||i.x<0||i.x>=Ut||a.x<0||a.x>=Ut)return!1;const h=a.sub(i),f=h.perp(),_=l.sub(i);return(h.x*_.x+h.y*_.y)/Math.sqrt((h.x*h.x+h.y*h.y)*(_.x*_.x+_.y*_.y))>-.866&&f.x*_.x+f.y*_.y<0}function Uk(l,i,a){const h=i?2|l:-3&l;return a?1|h:-2&h}function Hk(){const l=Math.PI/32,i=Math.tan(l),a=H;return a*Math.sqrt(1+2*i*i)-a}function Gk(l,i,a){const h=1<<a.z,f=Ae(a.x/h),_=Ae((a.x+1)/h),y=Ce(a.y/h),x=Ce((a.y+1)/h);return function(C,I,R,P,L=0,$){const j=[];if(!C.length||!R||!P)return j;const q=(De,Ve)=>{for(const He of De)j.push({polygon:He,bounds:Ve})},Z=Math.ceil(Math.log2(R)),K=Math.ceil(Math.log2(P)),ae=Z-K,ue=[];for(let De=0;De<Math.abs(ae);De++)ue.push(ae>0?0:1);for(let De=0;De<Math.min(Z,K);De++)ue.push(0),ue.push(1);let fe=C;if(fe=g1(fe,I[0].y-L,I[1].y+L,1),fe=g1(fe,I[0].x-L,I[1].x+L,0),!fe.length)return j;const Me=[];for(ue.length?Me.push({polygons:fe,bounds:I,depth:0}):q(fe,I);Me.length;){const De=Me.pop(),Ve=De.depth,He=ue[Ve],Ze=De.bounds[0],_t=De.bounds[1],Je=He===0?Ze.x:Ze.y,bt=He===0?_t.x:_t.y,Mt=$?$(He,Je,bt):.5*(Je+bt),Tt=g1(De.polygons,Je-L,Mt+L,He),It=g1(De.polygons,Mt-L,bt+L,He);if(Tt.length){const zt=[Ze,new Dt(He===0?Mt:_t.x,He===1?Mt:_t.y)];ue.length>Ve+1?Me.push({polygons:Tt,bounds:zt,depth:Ve+1}):q(Tt,zt)}if(It.length){const zt=[new Dt(He===0?Mt:Ze.x,He===1?Mt:Ze.y),_t];ue.length>Ve+1?Me.push({polygons:It,bounds:zt,depth:Ve+1}):q(It,zt)}}return j}(l,i,Math.ceil((_-f)/11.25),Math.ceil((y-x)/11.25),1,(C,I,R)=>{if(C===0)return .5*(I+R);{const P=Ce((a.y+I/Ut)/h);return(Ie(.5*(Ce((a.y+R/Ut)/h)+P))*h-a.y)*Ut}})}function i9(l,i,a,h,f,_){const y=Math.pow(2,h.z-f.z);for(let x=0;x<a;x++){let C=l.int16[2*(x+i)+0],I=l.int16[2*(x+i)+1];C=(C+f.x*Ut)*y-h.x*Ut,I=(I+f.y*Ut)*y-h.y*Ut,_.push(new Dt(C,I))}}let Wk,qk;en(x1,"FillExtrusionBucket",{omit:["layers","features"]}),en(zk,"PartData"),en(Lk,"FootprintSegment"),en(Bk,"BorderCentroidData"),en(TC,"GroundEffect");class Am extends Dt{constructor(i,a,h){super(i,a),this.z=h}}class Zk extends Am{constructor(i,a,h,f){super(i,a,h),this.w=f}}function Kk(l,i,a,h){const f=a==="x"?"y":"x",_=(h-l[a])/(i[a]-l[a]);l[f]=Math.round(l[f]+(i[f]-l[f])*_),l[a]=h,l.hasOwnProperty("z")&&(l.z=Pn(l.z,i.z,_)),l.hasOwnProperty("w")&&(l.w=Pn(l.w,i.w,_))}function Xk(l,i,a,h){const f=a,_=h;for(const y of["x","y"]){let x=l,C=i;x[y]>=C[y]&&(x=i,C=l),x[y]<f&&C[y]>f&&Kk(x,C,y,f),x[y]<_&&C[y]>_&&Kk(C,x,y,_)}}function w1(l,i,a,h,f,_){const y=[];for(let x=0;x<l.length;x++){const C=l[x];let I;const R=y.length;let P=0;for(let L=0;L<C.length-1;L++){let $=C[L],j=C[L+1],q=0;const Z=P;let K,ae;_&&(q=Math.hypot(j.x-$.x,j.y-$.y),P+=q,K=$,ae=j),$.x<i&&j.x<i||($.x<i?$=new Dt(i,$.y+(i-$.x)/(j.x-$.x)*(j.y-$.y))._round():j.x<i&&(j=new Dt(i,$.y+(i-$.x)/(j.x-$.x)*(j.y-$.y))._round()),$.y<a&&j.y<a||($.y<a?$=new Dt($.x+(a-$.y)/(j.y-$.y)*(j.x-$.x),a)._round():j.y<a&&(j=new Dt($.x+(a-$.y)/(j.y-$.y)*(j.x-$.x),a)._round()),$.x>=h&&j.x>=h||($.x>=h?$=new Dt(h,$.y+(h-$.x)/(j.x-$.x)*(j.y-$.y))._round():j.x>=h&&(j=new Dt(h,$.y+(h-$.x)/(j.x-$.x)*(j.y-$.y))._round()),$.y>=f&&j.y>=f||($.y>=f?$=new Dt($.x+(f-$.y)/(j.y-$.y)*(j.x-$.x),f)._round():j.y>=f&&(j=new Dt($.x+(f-$.y)/(j.y-$.y)*(j.x-$.x),f)._round()),I&&$.equals(I[I.length-1])||(I=[$],y.push(I),_&&_.push({progress:{min:Z+Yk(K,ae,$)*q,max:1},parentIndex:x,prevPoint:K,nextPoint:ae})),I.push(j),_&&(_[_.length-1].progress.max=Z+Yk(K,ae,j)*q,_[_.length-1].nextPoint=ae)))))}if(_&&P>0)for(let L=R;L<y.length;L++)_[L].progress.min/=P,_[L].progress.max/=P}return y}function r9(l,i,a,h,f){if(l.length<2)return void h.push(l);const _=[];for(;i.valid();){const[I,R]=i.get();for(let P=0;P<l.length-1;P++){const L=l[P],$=l[P+1],j=To(L,$,I,R);if(j){const[q]=j,Z=new Dt(Pn(L.x,$.x,q),Pn(L.y,$.y,q));_.push({t:P+q,distance:0,point:Z})}}i.next()}if(_.length===0)return void h.push(l);_.sort((I,R)=>I.t-R.t);let y=0,x=0,C=[];for(h.push(C);y!==l.length;){if(x===_.length){for(;y!==l.length;)C.length!==0&&C[C.length-1].equals(l[y])||C.push(l[y]),y++;break}_[x].t<=y?(C.length!==0&&C[C.length-1].equals(_[x].point)||C.push(_[x].point),Math.trunc(_[x].t),x++):(C.length!==0&&C[C.length-1].equals(l[y])||C.push(l[y]),y++)}}function Yk(l,i,a){return l.x!==i.x?(a.x-l.x)/(i.x-l.x):l.y!==i.y?(a.y-l.y)/(i.y-l.y):0}function sv(l,i){return l.x*i.x+l.y*i.y}function Jk(l,i){if(l.length===1){let a=0;const h=i[a++];let f;for(;!f||h.equals(f);)if(f=i[a++],!f)return 1/0;for(;a<i.length;a++){const _=i[a],y=l[0],x=f.sub(h),C=_.sub(h),I=y.sub(h),R=sv(x,x),P=sv(x,C),L=sv(C,C),$=sv(I,x),j=sv(I,C),q=R*L-P*P,Z=(L*$-P*j)/q,K=(R*j-P*$)/q,ae=h.z*(1-Z-K)+f.z*Z+_.z*K;if(isFinite(ae))return ae}return 1/0}{let a=1/0;for(const h of i)a=Math.min(a,h.z);return a}}function Qk(l,i,a,h,f,_,y,x){const C=y*f.getElevationAt(l,i,!0,!0),I=_[0]!==0,R=I?_[1]===0?y*(_[0]/7-450):y*function(P,L,$){const j=Math.floor(L[0]/8),q=Math.floor(L[1]/8),Z=10*(L[0]-8*j),K=10*(L[1]-8*q),ae=P.getElevationAt(j,q,!0,!0),ue=P.getMeterToDEM($),fe=Math.floor(.5*(Z*ue-1)),Me=Math.floor(.5*(K*ue-1)),De=P.tileCoordToPixel(j,q),Ve=2*fe+1,He=2*Me+1,Ze=function(It,zt,mt,At,ct){return[It.getElevationAtPixel(zt,mt,!0),It.getElevationAtPixel(zt+ct,mt,!0),It.getElevationAtPixel(zt,mt+ct,!0),It.getElevationAtPixel(zt+At,mt+ct,!0)]}(P,De.x-fe,De.y-Me,Ve,He),_t=Math.abs(Ze[0]-Ze[1]),Je=Math.abs(Ze[2]-Ze[3]),bt=Math.abs(Ze[0]-Ze[2])+Math.abs(Ze[1]-Ze[3]),Mt=Math.min(.25,.5*ue*(_t+Je)/Ve),Tt=Math.min(.25,.5*ue*bt/He);return ae+Math.max(Mt*Z,Tt*K)}(f,_,x):C;return{base:C+(a===0?-1:a),top:I?Math.max(R+h,C+a+2):C+h}}class o9{constructor(i){this._callback=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class s9{constructor(){this.tasks={},this.taskQueue=[],Mn(["process"],this),this.invoker=new o9(this.process),this.nextId=0}add(i,a){const h=this.nextId++,f=function({type:_,isSymbolTile:y,zoom:x}){return x=x||0,_==="message"?0:_!=="maybePrepare"||y?_!=="parseTile"||y?_==="parseTile"&&y?300-x:_==="maybePrepare"&&y?400-x:500:200-x:100-x}(a);if(f===0){try{i()}finally{}return null}return this.tasks[h]={fn:i,metadata:a,priority:f,id:h},this.taskQueue.push(h),this.invoker.trigger(),{cancel:()=>{delete this.tasks[h]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(h=>!!this.tasks[h]),!this.taskQueue.length)return;const i=this.pick();if(i===null)return;const a=this.tasks[i];if(delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),!a)return;a.fn()}finally{}}pick(){let i=null,a=1/0;for(let f=0;f<this.taskQueue.length;f++){const _=this.tasks[this.taskQueue[f]];_.priority<a&&(a=_.priority,i=f)}if(i===null)return null;const h=this.taskQueue[i];return this.taskQueue.splice(i,1),h}remove(){this.invoker.remove()}}class eR{constructor(i,a,h){this.target=i,this.parent=a,this.mapId=h,this.callbacks={},this.cancelCallbacks={},Mn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new s9}send(i,a,h,f,_=!1,y){const x=Math.round(1e18*Math.random()).toString(36).substring(0,10);h&&(h.metadata=y,this.callbacks[x]=h);const C=new Set;return this.target.postMessage({id:x,type:i,hasCallback:!!h,targetMapId:f,mustQueue:_,sourceMapId:this.mapId,data:xc(a,C)},C),{cancel:()=>{h&&delete this.callbacks[x],this.target.postMessage({id:x,type:"<cancel>",targetMapId:f,sourceMapId:this.mapId})}}}receive(i){const a=i.data;if(!a)return;const h=a.id;if(h&&(!a.targetMapId||this.mapId===a.targetMapId))if(a.type==="<cancel>"){const f=this.cancelCallbacks[h];delete this.cancelCallbacks[h],f&&f.cancel()}else if(a.mustQueue||ir(self)){const f=this.callbacks[h],_=this.scheduler.add(()=>this.processTask(h,a),f&&f.metadata||{type:"message"});_&&(this.cancelCallbacks[h]=_)}else this.processTask(h,a)}processTask(i,a){if(delete this.cancelCallbacks[i],a.type==="<response>"){const h=this.callbacks[i];delete this.callbacks[i],h&&(a.error?h(wc(a.error)):h(null,wc(a.data)))}else{const h=new Set,f=a.hasCallback?(y,x)=>{this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:y?xc(y):null,data:xc(x,h)},h)}:()=>{},_=wc(a.data);if(this.parent[a.type])this.parent[a.type](a.sourceMapId,_,f);else if(this.parent.getWorkerSource){const y=a.type.split("."),{source:x,scope:C}=_;this.parent.getWorkerSource(a.sourceMapId,y[0],x,C)[y[1]](_,f)}else f(new Error(`Could not find function ${a.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var av={workerUrl:"",workerClass:null,workerParams:void 0};const IC="mapboxgl_preloaded_worker_pool";class km{constructor(){this.active={}}acquire(i,a=km.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<a;)this.workers.push(av.workerClass!=null?new av.workerClass:new self.Worker(av.workerUrl,av.workerParams));return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.workers&&this.numActive()===0&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[IC]}numActive(){return Object.keys(this.active).length}}km.workerCount=2;class c_{constructor(i,a,h="Worker",f=km.workerCount){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=St();const _=this.workerPool.acquire(this.id,f);for(let y=0;y<_.length;y++){const x=new c_.Actor(_[y],a,this.id);x.name=`${h} ${y}`,this.actors.push(x)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(i,a,h){st(this.actors,(f,_)=>{f.send(i,a,_)},h=h||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(i=>{i.remove()}),this.actors=[],this.workerPool.release(this.id)}}let lv,AC;function S1(){return lv||(lv=new km),lv}c_.Actor=eR;class a9{constructor(i){this.module=i}createIntArray(i){const a=new Int32Array(i),h=this.module.malloc(a.length*a.BYTES_PER_ELEMENT);return this.module.heap32.set(a,h/a.BYTES_PER_ELEMENT),h}createFloatArray(i){const a=new Float32Array(i),h=this.module.malloc(a.length*a.BYTES_PER_ELEMENT);return this.module.heapF32.set(a,h/a.BYTES_PER_ELEMENT),h}createStringBuffer(i){const a=this.module.malloc(i.length+1);for(let h=0;h<i.length;++h)this.module.heapU8[a+h]=i.charCodeAt(h);return this.module.heapU8[a+i.length]=0,a}readStringBuffer(i){let a="";for(;this.module.heapU8[i]!==0;)a+=String.fromCharCode(this.module.heapU8[i]),++i;return a}setStyle(i){const a=i.entranceColorRgb,h=i.facadeGlazingColorRgb,f=i.roofColorRgb,_=i.wallColorRgb,y=i.normalScale;this.module.setStyle(a[0],a[1],a[2],h[0],h[1],h[2],f[0],f[1],f[2],_[0],_[1],_[2],y[0],y[1],y[2],i.tileToMeters)}setAOOptions(i,a){this.module.setAOOptions(i?1:0,a)}setMetricOptions(i,a){this.module.setMetricOptions(i?1:0,a)}setStructuralOptions(i){this.module.setStructuralOptions(i?1:0)}setFacadeOptions(i,a){this.module.setFacadeOptions(i,a?1:0)}setFauxFacadeOptions(i,a,h){this.module.setFauxFacadeOptions(i?1:0,a?1:0,h)}setFacadeClassifierOptions(i){this.module.setFacadeClassifierOptions(i)}generateMesh(i,a){for(const x of i){const C=this.createStringBuffer(x.roofType),I=[0],R=[];for(const $ of x.coordinates)if(Array.isArray($)){for(const j of $)R.push(j.x),R.push(j.y);I.push(R.length)}const P=this.createIntArray(I),L=this.createFloatArray(R);this.module.addFeature(x.id,x.sourceId,x.minHeight,x.height,C,x.roofType.length,L,P,I.length-1),this.module.free(C),this.module.free(P),this.module.free(L)}for(const x of a){let C;C=x.entrances?JSON.parse(x.entrances):[];const I=this.createFloatArray(C),R=[];for(const L of x.coordinates)R.push(L.x),R.push(L.y);const P=this.createFloatArray(R);this.module.addFacade(x.sourceId,x.crossPerc,x.distanceToRoad,I,C.length,P,R.length),this.module.free(I),this.module.free(P)}if(!this.module.generateMesh()){const x=this.module.getLastError();return this.readStringBuffer(x)}const h=this.module.getMeshCount(),f=new Array(h);for(let x=0;x<h;x++){const C=this.module.getPositionsPtr(x),I=this.module.getPositionsLength(x),R=new Float32Array(this.module.heapF32.buffer,C,I),P=this.module.getNormalsPtr(x),L=this.module.getNormalsLength(x),$=new Float32Array(this.module.heapF32.buffer,P,L),j=this.module.getColorsPtr(x),q=this.module.getColorsLength(x),Z=new Uint8Array(this.module.heapU8.buffer,j,q),K=this.module.getAOPtr(x),ae=this.module.getAOLength(x),ue=new Float32Array(this.module.heapF32.buffer,K,ae),fe=this.module.getUVPtr(x),Me=this.module.getUVLength(x),De=new Float32Array(this.module.heapF32.buffer,fe,Me),Ve=this.module.getFauxFacadePtr(x),He=this.module.getFauxFacadeLength(x),Ze=new Uint8Array(this.module.heapU8.buffer,Ve,He),_t=this.module.getIndicesPtr(x),Je=this.module.getIndicesLength(x),bt=new Int32Array(this.module.heap32.buffer,_t,Je),Mt=this.module.getBuildingPart(x),Tt=this.readStringBuffer(Mt);f[x]={positions:R,normals:$,colors:Z,ao:ue,uv:De,isFauxFacade:Ze,indices:bt,buildingPart:Tt}}const _=this.module.getRingCount(),y=[];for(let x=0;x<_;x++){const C=this.module.getRingPtr(x),I=this.module.getRingLength(x),R=new Float32Array(this.module.heapF32.buffer,C,I);y.push(R)}return{meshes:f,outerRingLength:this.module.getOuterRingLength(),modifiedPolygonRings:y}}}let cv,kC,Zu,u_,RC,d_=null,h_=null,tR=null,C1=null;function nR(){return ir(self)&&self.worker.dracoUrl?self.worker.dracoUrl:kC||ko.DRACO_URL}function iR(){if(ir(self)&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(u_)return u_;const l=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return u_=WebAssembly.validate(l)?ko.MESHOPT_SIMD_URL:ko.MESHOPT_URL,u_}function l9(){return C1}const T1={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},c9={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},uv={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function rR(l,i,a){const h=a.json.bufferViews.length,f=a.buffers.length;i.bufferView=h,a.json.bufferViews[h]={buffer:f,byteLength:l.byteLength},a.buffers[f]=l}const PC="KHR_draco_mesh_compression";function u9(l,i){const a=l.extensions&&l.extensions[PC];if(!a)return;const h=new Zu.Decoder,f=lR(i,a.bufferView),_=new Zu.Mesh;if(!h.DecodeArrayToMesh(f,f.byteLength,_))throw new Error("Failed to decode Draco mesh");const y=i.json.accessors[l.indices],x=T1[y.componentType],C=y.count*x.BYTES_PER_ELEMENT,I=Zu._malloc(C);x===Uint16Array?h.GetTrianglesUInt16Array(_,C,I):h.GetTrianglesUInt32Array(_,C,I),rR(Zu.memory.buffer.slice(I,I+C),y,i),Zu._free(I);for(const R of Object.keys(a.attributes)){const P=h.GetAttributeByUniqueId(_,a.attributes[R]),L=i.json.accessors[l.attributes[R]],$=c9[L.componentType],j=L.count*uv[L.type]*T1[L.componentType].BYTES_PER_ELEMENT,q=Zu._malloc(j);h.GetAttributeDataArrayForAllPoints(_,P,Zu[$],j,q),rR(Zu.memory.buffer.slice(q,q+j),L,i),Zu._free(q)}h.destroy(),_.destroy(),delete l.extensions[PC]}const E1="EXT_meshopt_compression";function d9(l,i){if(!l.extensions||!l.extensions[E1])return;const a=l.extensions[E1],h=new Uint8Array(i.buffers[a.buffer],a.byteOffset||0,a.byteLength||0),f=new Uint8Array(a.count*a.byteStride);RC.decodeGltfBuffer(f,a.count,a.byteStride,h,a.mode,a.filter),l.buffer=i.buffers.length,l.byteOffset=0,i.buffers[l.buffer]=f.buffer,delete l.extensions[E1]}const oR=1179937895,sR=new TextDecoder("utf8");function aR(l,i){return new URL(l,i).href}function h9(l,i,a,h){return fetch(aR(l.uri,h)).then(f=>f.arrayBuffer()).then(f=>{i.buffers[a]=f})}function lR(l,i){const a=l.json.bufferViews[i];return new Uint8Array(l.buffers[a.buffer],a.byteOffset||0,a.byteLength)}function f9(l,i,a,h){if(l.uri){const f=aR(l.uri,h);return fetch(f).then(_=>_.blob()).then(_=>createImageBitmap(_)).then(_=>{i.images[a]=_})}if(l.bufferView!==void 0){const f=lR(i,l.bufferView),_=new Blob([f],{type:l.mimeType});return createImageBitmap(_).then(y=>{i.images[a]=y})}}function cR(l,i=0,a){const h={json:null,images:[],buffers:[]};if(new Uint32Array(l,i,1)[0]===oR){const R=new Uint32Array(l,i);let P=2;const L=(R[P++]>>2)-3,$=R[P++]>>2;if(P++,h.json=JSON.parse(sR.decode(R.subarray(P,P+$))),P+=$,P<L){const j=R[P++];P++;const q=i+(P<<2);h.buffers[0]=l.slice(q,q+j)}}else h.json=JSON.parse(sR.decode(new Uint8Array(l,i)));const{buffers:f,images:_,meshes:y,extensionsUsed:x,bufferViews:C}=h.json;let I=Promise.resolve();if(f){const R=[];for(let P=0;P<f.length;P++){const L=f[P];L.uri?R.push(h9(L,h,P,a)):h.buffers[P]||(h.buffers[P]=null)}I=Promise.all(R)}return I.then(()=>{const R=[],P=x&&x.includes(PC),L=x&&x.includes(E1);if(P&&R.push(function(){if(!Zu)return cv??(cv=function($){let j,q=null;function Z(){j=new Uint8Array(q.buffer)}function K(){throw new Error("Unexpected Draco error.")}const ae={a:{a:K,d:function(ue,fe,Me){return j.copyWithin(ue,fe,fe+Me)},c:function(ue){const fe=j.length,Me=Math.max(ue>>>0,Math.ceil(1.2*fe)),De=Math.ceil((Me-fe)/65536);try{return q.grow(De),Z(),!0}catch{return!1}},b:K}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming($,ae):$.then(ue=>ue.arrayBuffer()).then(ue=>WebAssembly.instantiate(ue,ae))).then(ue=>{const{Rb:fe,Qb:Me,P:De,T:Ve,X:He,Ja:Ze,La:_t,Qa:Je,Va:bt,Wa:Mt,eb:Tt,jb:It,f:zt,e:mt,yb:At,zb:ct,Ab:rt,Bb:Bt,Db:Ot,Gb:En}=ue.instance.exports;q=mt;const ln=(()=>{let pn=0,Ht=0,Tn=0,qn=0;return Jt=>{Tn&&(fe(qn),fe(pn),Ht+=Tn,Tn=pn=0),pn||(Ht+=128,pn=Me(Ht));const vn=Jt.length+7&-8;let Fn=pn;vn>=Ht&&(Tn=vn,Fn=qn=Me(vn));for(let Yn=0;Yn<Jt.length;Yn++)j[Fn+Yn]=Jt[Yn];return Fn}})();return Z(),zt(),{memory:mt,_free:fe,_malloc:Me,Mesh:class{constructor(){this.ptr=De()}destroy(){Ve(this.ptr)}},Decoder:class{constructor(){this.ptr=Ze()}destroy(){It(this.ptr)}DecodeArrayToMesh(pn,Ht,Tn){const qn=ln(pn),Jt=_t(this.ptr,qn,Ht,Tn.ptr);return!!He(Jt)}GetAttributeByUniqueId(pn,Ht){return{ptr:Je(this.ptr,pn.ptr,Ht)}}GetTrianglesUInt16Array(pn,Ht,Tn){bt(this.ptr,pn.ptr,Ht,Tn)}GetTrianglesUInt32Array(pn,Ht,Tn){Mt(this.ptr,pn.ptr,Ht,Tn)}GetAttributeDataArrayForAllPoints(pn,Ht,Tn,qn,Jt){Tt(this.ptr,pn.ptr,Ht.ptr,Tn,qn,Jt)}},DT_INT8:At(),DT_UINT8:ct(),DT_INT16:rt(),DT_UINT16:Bt(),DT_UINT32:Ot(),DT_FLOAT32:En()}})}(fetch(nR())),cv.then($=>{Zu=$,cv=void 0}))}()),L&&R.push(function(){if(RC)return;const $=function(j){let q;const Z=WebAssembly.instantiateStreaming(j,{}).then(ue=>{q=ue.instance,q.exports.__wasm_call_ctors()}),K={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},ae={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:Z,supported:!0,decodeGltfBuffer(ue,fe,Me,De,Ve,He){(function(Ze,_t,Je,bt,Mt,Tt,It){const zt=Ze.exports.sbrk,mt=bt+3&-4,At=zt(mt*Mt),ct=zt(Tt.length),rt=new Uint8Array(Ze.exports.memory.buffer);rt.set(Tt,ct);const Bt=_t(At,bt,Mt,ct,Tt.length);if(Bt===0&&It&&It(At,mt,Mt),Je.set(rt.subarray(At,At+bt*Mt)),zt(At-zt(0)),Bt!==0)throw new Error(`Malformed buffer data: ${Bt}`)})(q,q.exports[ae[Ve]],ue,fe,Me,De,q.exports[K[He]])}}}(fetch(iR()));return $.ready.then(()=>{RC=$})}()),_)for(let $=0;$<_.length;$++)R.push(f9(_[$],h,$,a));return(R.length?Promise.all(R):Promise.resolve()).then(()=>{if(P&&y)for(const{primitives:$}of y)for(const j of $)u9(j,h);if(L&&y&&C)for(const $ of C)d9($,h);return h})})}function MC(l){switch(l){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function DC(l){switch(l){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class OC{constructor(i,a,h,f){this.context=i,this.format=h,this.useMipmap=f&&f.useMipmap,this.texture=i.gl.createTexture(),this.update(a,{premultiply:f&&f.premultiply})}update(i,a){const h=i&&i instanceof HTMLVideoElement&&i.width===0?i.videoWidth:i.width,f=i&&i instanceof HTMLVideoElement&&i.height===0?i.videoHeight:i.height,{context:_}=this,{gl:y}=_,{x,y:C}=a&&a.position?a.position:{x:0,y:0},I=x+h,R=C+f;!this.size||this.size[0]===I&&this.size[1]===R||(y.bindTexture(y.TEXTURE_2D,null),y.deleteTexture(this.texture),this.texture=y.createTexture(),this.size=null),y.bindTexture(y.TEXTURE_2D,this.texture),_.pixelStoreUnpackFlipY.set(!1),_.pixelStoreUnpack.set(1),_.pixelStoreUnpackPremultiplyAlpha.set(this.format===y.RGBA8&&(!a||a.premultiply!==!1));const P=i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||ImageBitmap&&i instanceof ImageBitmap;if(!this.size&&I>0&&R>0){const L=this.useMipmap?Math.floor(Math.log2(Math.max(I,R)))+1:1;y.texStorage2D(y.TEXTURE_2D,L,this.format,I,R),this.size=[I,R]}this.size&&(P?y.texSubImage2D(y.TEXTURE_2D,0,x,C,MC(this.format),DC(this.format),i):"data"in i&&i.data&&y.texSubImage2D(y.TEXTURE_2D,0,x,C,h,f,MC(this.format),DC(this.format),i.data)),this.useMipmap&&y.generateMipmap(y.TEXTURE_2D)}bind(i,a,h=!1){const{context:f}=this,{gl:_}=f;_.bindTexture(_.TEXTURE_2D,this.texture),i!==this.minFilter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,i),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,this.useMipmap&&!h?i===_.NEAREST?_.NEAREST_MIPMAP_NEAREST:_.LINEAR_MIPMAP_LINEAR:i),this.minFilter=i),a!==this.wrapS&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,a),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,a),this.wrapS=a)}bindExtraParam(i,a,h,f,_){const{context:y}=this,{gl:x}=y;x.bindTexture(x.TEXTURE_2D,this.texture),a!==this.magFilter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,a),this.magFilter=a),i!==this.minFilter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,this.useMipmap?i===x.NEAREST?x.NEAREST_MIPMAP_NEAREST:x.LINEAR_MIPMAP_LINEAR:i),this.minFilter=i),h!==this.wrapS&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,h),this.wrapS=h),f!==this.wrapT&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,f),this.wrapT=f),_!==this.compareMode&&(_?(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_COMPARE_MODE,x.COMPARE_REF_TO_TEXTURE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_COMPARE_FUNC,_)):x.texParameteri(x.TEXTURE_2D,x.TEXTURE_COMPARE_MODE,x.NONE),this.compareMode=_)}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class dv{constructor(i,a){this.context=i,this.texture=a}bind(i,a){const{context:h}=this,{gl:f}=h;f.bindTexture(f.TEXTURE_2D,this.texture),i!==this.minFilter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,i),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,i),this.minFilter=i),a!==this.wrapS&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,a),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,a),this.wrapS=a)}}const p9=ki([{name:"a_pos_3f",components:3,type:"Float32"}]),m9=ki([{name:"a_color_3f",components:3,type:"Float32"}]),g9=ki([{name:"a_color_4f",components:4,type:"Float32"}]),_9=ki([{name:"a_uv_2f",components:2,type:"Float32"}]),y9=ki([{name:"a_normal_3f",components:3,type:"Float32"}]),v9=ki([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),b9=ki([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);function uR(l,i){const a=I1(l.projection,l.zoom,l.width,l.height),h=function(_,y,x,C,I){const R=new W(x.lng-180*tp,x.lat),P=new W(x.lng+180*tp,x.lat),L=_.project(R.lng,R.lat),$=_.project(P.lng,P.lat),j=-Math.atan2($.y-L.y,$.x-L.x),q=ut.fromLngLat(x);q.y=Le(q.y,-1+tp,1-tp);const Z=q.toLngLat(),K=_.project(Z.lng,Z.lat),ae=ut.fromLngLat(Z);ae.x+=tp;const ue=ae.toLngLat(),fe=_.project(ue.lng,ue.lat),Me=hR(fe.x-K.x,fe.y-K.y,j),De=ut.fromLngLat(Z);De.y+=tp;const Ve=De.toLngLat(),He=_.project(Ve.lng,Ve.lat),Ze=hR(He.x-K.x,He.y-K.y,j),_t=Math.abs(Me.x)/Math.abs(Ze.y),Je=Q([]);qe(Je,Je,-j*(1-(I?0:C)));const bt=Q([]);return ze(bt,bt,[1,1-(1-_t)*C,1]),bt[4]=-Ze.x/Ze.y*C,qe(bt,bt,j),ce(bt,Je,bt),bt}(l.projection,0,l.center,a,i),f=dR(l);return ze(h,h,[f,f,1]),h}function dR(l){const i=l.projection,a=I1(l.projection,l.zoom,l.width,l.height),h=LC(i,l.center),f=LC(i,W.convert(i.center));return Math.pow(2,h*a+(1-a)*f)}function I1(l,i,a,h,f=1/0){const _=l.range;if(!_)return 0;const y=Math.min(f,Math.max(a,h)),x=Math.log2(y/1024);return it(_[0]+x,_[1]+x,i)}const tp=1/4e4;function LC(l,i){const a=Le(i.lat,-ke,ke),h=new W(i.lng-180*tp,a),f=new W(i.lng+180*tp,a),_=l.project(h.lng,a),y=l.project(f.lng,a),x=ut.fromLngLat(h),C=ut.fromLngLat(f),I=y.x-_.x,R=y.y-_.y,P=C.x-x.x,L=C.y-x.y,$=Math.sqrt((P*P+L*L)/(I*I+R*R));return Math.log2($)}function hR(l,i,a){const h=Math.cos(a),f=Math.sin(a);return{x:l*h-i*f,y:l*f+i*h}}function fR(l,i,a){Q(l),qe(l,l,Xe(i[2])),xe(l,l,Xe(i[0])),je(l,l,Xe(i[1])),ze(l,l,a),ce(l,l,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function A1(l,i,a,h,f,_,y,x){const C=[a[0]-i[0],a[1]-i[1],0],I=[h[0]-i[0],h[1]-i[1],0];if(Re(C)<1e-12||Re(I)<1e-12)return Ln(l);const R=In([],C,I);ai(R,R),hn(I,h,i),C[2]=(_-f)*x,I[2]=(y-f)*x;const P=C;return In(P,C,I),ai(P,P),Io(l,R,P)}function zC(l,i,a=!1){const h=Jf(i.zoom),f=function(_,y,x){const C=y.worldSize,I=[_[12],_[13],_[14]],R=Ce(I[1]/C),P=Ae(I[0]/C),L=Q([]),$=Se(1,R)*C,j=Se(1,0)*C*Ke(R,y.zoom),q=1/uC(C);let Z=j*q;if(x){const fe=I1(y.projection,y.zoom,y.width,y.height,1024);Z=q*y.projection.pixelSpaceConversion(y.center.lat,C,fe)}const K=F(R,P);on(K,K,Pt([],ai([],K),$*Z*I[2]));const ae=function(fe){const Me=[fe[0],fe[1],fe[2]];let De=[0,1,0];const Ve=In([],De,Me);return In(De,Me,Ve),Ur(De)===0&&(De=[0,1,0],In(Ve,Me,De)),ai(Ve,Ve),ai(De,De),ai(Me,Me),[Ve[0],Ve[1],Ve[2],0,De[0],De[1],De[2],0,Me[0],Me[1],Me[2],0,fe[0],fe[1],fe[2],1]}(K);ze(L,L,[Z,Z,Z*$]),be(L,L,[-I[0],-I[1],-I[2]]);const ue=ce([],y.globeMatrix,ae);return ce(ue,ue,L),ce(ue,ue,_),ue}(l,i,a);if(h>0){const _=function(y,x){const C=x.worldSize,I=Se(1,0)*C*Ke(x.center.lat,x.zoom)/uC(C),R=Se(1,x.center.lat)*C,P=Q([]);je(P,P,Xe(x.center.lng)),xe(P,P,Xe(x.center.lat)),be(P,P,[0,0,m]),ze(P,P,[I,I,I*R]);const L=x.point;return be(P,P,[-L.x,-L.y,0]),ce(P,P,y),ce(P,x.globeMatrix,P)}(l,i);return function(y,x,C){const I=(j,q,Z)=>{const K=Re(j),ae=Re(q),ue=Dh(j,q,Z);return Pt(ue,ue,1/Re(ue)*Pn(K,ae,Z))},R=I([y[0],y[1],y[2]],[x[0],x[1],x[2]],C),P=I([y[4],y[5],y[6]],[x[4],x[5],x[6]],C),L=I([y[8],y[9],y[10]],[x[8],x[9],x[10]],C),$=Dh([y[12],y[13],y[14]],[x[12],x[13],x[14]],C);return[R[0],R[1],R[2],0,P[0],P[1],P[2],0,L[0],L[1],L[2],0,$[0],$[1],$[2],1]}(f,_,h)}return f}function pR(l,i,a,h){const f=Vn.projectAabbCorners(h,a);let _=Number.MAX_VALUE,y=-1;for(let I=0;I<f.length;++I){const R=f[I];R[0]=(.5*R[0]+.5)*i.width,R[1]=(.5-.5*R[1])*i.height,R[2]<_&&(y=I,_=R[2])}const x=I=>new Dt(f[I][0],f[I][1]);let C;switch(y){case 0:case 6:C=[x(1),x(5),x(4),x(7),x(3),x(2),x(1)];break;case 1:case 7:C=[x(0),x(4),x(5),x(6),x(2),x(3),x(0)];break;case 3:case 5:C=[x(1),x(0),x(4),x(7),x(6),x(2),x(1)];break;default:C=[x(1),x(5),x(6),x(7),x(3),x(0),x(1)]}if(Dl(l,C))return _}const Rm=64,f_={CoordinateSpaceTile:1,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function mR(l,i,a,h,f,_,y,x,C,I=!1){const R=a.zoom,P=a.project(h),L=Ke(h.lat,R),$=1/L;Q(l),be(l,l,[P.x+y[0]*$,P.y+y[1]*$,y[2]]);let j=1,q=1;const Z=a.worldSize;if(I){if(a.projection.name==="mercator"){let fe=0;a.elevation&&(fe=a.elevation.getAtPointOrZero(new ut(P.x/Z,P.y/Z),0));const Me=dn([],[P.x,P.y,fe,1],a.projMatrix)[3]/a.cameraToCenterDistance;j=Me,q=Me*Ke(a.center.lat,R)}else if(a.projection.name==="globe"){const fe=zC(l,a),Me=[0,0,0,1];dn(Me,Me,ce([],a.projMatrix,fe));const De=Me[3]/a.cameraToCenterDistance,Ve=Jf(R),He=a.projection.pixelsPerMeter(h.lat,Z)*Ke(h.lat,R),Ze=a.projection.pixelsPerMeter(a.center.lat,Z)*Ke(a.center.lat,R);j=De/Pn(He,nt(a.center.lat),Ve),q=De*L/He,j*=Ze,q*=Ze}}else j=$;ze(l,l,[j,j,q]);const K=[...l],ae=i.orientation,ue=[];if(fR(ue,[ae[0]+f[0],ae[1]+f[1],ae[2]+f[2]],_),ce(l,K,ue),x&&a.elevation){let fe=0;const Me=[];if(C&&a.elevation){fe=function(Ve,He,Ze,_t,Je){const bt=He.elevation;if(!bt)return 0;const Mt=Vn.projectAabbCorners(Ze,_t),Tt=Se(1,Je.lat)*He.worldSize,It=function(Ht,Tn){const qn=[0,0,1],Jt=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const vn of Jt){const Fn=Ht[vn.corners[0]],Yn=Ht[vn.corners[1]],gi=Ht[vn.corners[2]],ii=[Yn[0]-Fn[0],Yn[1]-Fn[1],Tn*(Yn[2]-Fn[2])],un=In(ii,ii,[gi[0]-Fn[0],gi[1]-Fn[1],Tn*(gi[2]-Fn[2])]);ai(un,un),vn.dotProductWithUp=Ft(un,qn)}return Jt.sort((vn,Fn)=>vn.dotProductWithUp-Fn.dotProductWithUp),Jt[0].corners}(Mt,Tt),zt=Mt[It[0]],mt=Mt[It[1]],At=Mt[It[2]],ct=Mt[It[3]],rt=bt.getAtPointOrZero(new ut(zt[0]/He.worldSize,zt[1]/He.worldSize),0),Bt=bt.getAtPointOrZero(new ut(mt[0]/He.worldSize,mt[1]/He.worldSize),0),Ot=bt.getAtPointOrZero(new ut(At[0]/He.worldSize,At[1]/He.worldSize),0),En=bt.getAtPointOrZero(new ut(ct[0]/He.worldSize,ct[1]/He.worldSize),0),ln=(rt+En)/2,pn=(Bt+Ot)/2;return ln>pn?Bt<Ot?A1(Ve,mt,ct,zt,Bt,En,rt,Tt):A1(Ve,At,zt,ct,Ot,rt,En,Tt):rt<En?A1(Ve,zt,mt,At,rt,Bt,Ot,Tt):A1(Ve,ct,At,mt,En,Ot,Bt,Tt),Math.max(ln,pn)}(Me,a,i.aabb,l,h);const De=ce([],Ee([],Me),ue);ce(l,K,De)}else fe=a.elevation.getAtPointOrZero(new ut(P.x/Z,P.y/Z),0);fe!==0&&(l[14]+=fe)}}function hv(l,i,a=!1){l.uploaded||(l.gfxTexture=new OC(i,l.image,a?i.gl.R8:i.gl.RGBA8,{useMipmap:l.sampler.minFilter>=i.gl.NEAREST_MIPMAP_NEAREST}),l.uploaded=!0,l.image=null)}function x9(l,i,a){l.indexBuffer=i.createIndexBuffer(l.indexArray,!1,!0),l.vertexBuffer=i.createVertexBuffer(l.vertexArray,p9.members,!1,!0),l.normalArray&&(l.normalBuffer=i.createVertexBuffer(l.normalArray,y9.members,!1,!0)),l.texcoordArray&&(l.texcoordBuffer=i.createVertexBuffer(l.texcoordArray,_9.members,!1,!0)),l.colorArray&&(l.colorBuffer=i.createVertexBuffer(l.colorArray,(l.colorArray.bytesPerElement===12?m9:g9).members,!1,!0)),l.featureArray&&(l.pbrBuffer=i.createVertexBuffer(l.featureArray,b9.members,!0)),l.segments=ro.simpleSegment(0,0,l.vertexArray.length,l.indexArray.length);const h=l.material;h.pbrMetallicRoughness.baseColorTexture&&hv(h.pbrMetallicRoughness.baseColorTexture,i),h.pbrMetallicRoughness.metallicRoughnessTexture&&hv(h.pbrMetallicRoughness.metallicRoughnessTexture,i),h.normalTexture&&hv(h.normalTexture,i),h.occlusionTexture&&hv(h.occlusionTexture,i,a),h.emissionTexture&&hv(h.emissionTexture,i)}function BC(l,i,a){if(l.meshes)for(const h of l.meshes)x9(h,i,a);if(l.children)for(const h of l.children)BC(h,i,a)}function k1(l){if(l.meshes)for(const i of l.meshes)i.indexArray.destroy(),i.vertexArray.destroy(),i.colorArray&&i.colorArray.destroy(),i.normalArray&&i.normalArray.destroy(),i.texcoordArray&&i.texcoordArray.destroy(),i.featureArray&&i.featureArray.destroy();if(l.children)for(const i of l.children)k1(i)}function FC(l){if(l.meshes)for(const a of l.meshes)a.vertexBuffer&&(a.vertexBuffer.destroy(),a.indexBuffer.destroy(),a.normalBuffer&&a.normalBuffer.destroy(),a.texcoordBuffer&&a.texcoordBuffer.destroy(),a.colorBuffer&&a.colorBuffer.destroy(),a.pbrBuffer&&a.pbrBuffer.destroy(),a.segments.destroy(),a.material&&((i=a.material).pbrMetallicRoughness.baseColorTexture&&i.pbrMetallicRoughness.baseColorTexture.gfxTexture&&i.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),i.pbrMetallicRoughness.metallicRoughnessTexture&&i.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&i.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),i.normalTexture&&i.normalTexture.gfxTexture&&i.normalTexture.gfxTexture.destroy(),i.emissionTexture&&i.emissionTexture.gfxTexture&&i.emissionTexture.gfxTexture.destroy(),i.occlusionTexture&&i.occlusionTexture.gfxTexture&&i.occlusionTexture.gfxTexture.destroy()));var i;if(l.children)for(const a of l.children)FC(a)}function Pm(l,i){const a=l.json.bufferViews[i.bufferView],h=T1[i.componentType];return new h(l.buffers[a.buffer],(i.byteOffset||0)+(a.byteOffset||0),i.count*(a.byteStride&&a.byteStride!==uv[i.type]*h.BYTES_PER_ELEMENT?a.byteStride/h.BYTES_PER_ELEMENT:uv[i.type]))}function NC(l,i,a,h){const f=T1[i.componentType],_=function(R){switch(R){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(f),y=l.json.bufferViews[i.bufferView],x=y.byteStride?y.byteStride/f.BYTES_PER_ELEMENT:uv[i.type],C=a.float32,I=C.length/a.capacity;for(let R=0,P=0;R<i.count*x;R+=x,P+=I)for(let L=0;L<I;L++)C[P+L]=h[R+L]*_;a._trim()}function w9(l,i,a){const h=l.indices,f=l.attributes,_={};_.indexArray=new bs;const y=i.json.accessors[h],x=y.count/3;_.indexArray.reserve(x);const C=Pm(i,y);for(let L=0;L<x;L++)_.indexArray.emplaceBack(C[3*L],C[3*L+1],C[3*L+2]);_.indexArray._trim(),_.vertexArray=new Ga;const I=i.json.accessors[f.POSITION];_.vertexArray.reserve(I.count);const R=Pm(i,I);for(let L=0;L<I.count;L++)_.vertexArray.emplaceBack(R[3*L],R[3*L+1],R[3*L+2]);if(_.vertexArray._trim(),_.aabb=new Vn(I.min,I.max),_.centroid=function(L,$){const j=[0,0,0],q=L.length;if(q>0){for(let Z=0;Z<q;Z++){const K=3*L[Z];j[0]+=$[K],j[1]+=$[K+1],j[2]+=$[K+2]}j[0]/=q,j[1]/=q,j[2]/=q}return j}(C,R),f.COLOR_0!==void 0){const L=i.json.accessors[f.COLOR_0],$=uv[L.type],j=Pm(i,L);_.colorArray=$===3?new Ga:new Ec,_.colorArray.resize(L.count),NC(i,L,_.colorArray,j)}if(f.NORMAL!==void 0){_.normalArray=new Ga;const L=i.json.accessors[f.NORMAL];_.normalArray.resize(L.count);const $=Pm(i,L);NC(i,L,_.normalArray,$)}if(f.TEXCOORD_0!==void 0&&a.length>0){_.texcoordArray=new Zf;const L=i.json.accessors[f.TEXCOORD_0];_.texcoordArray.resize(L.count);const $=Pm(i,L);NC(i,L,_.texcoordArray,$)}if(f._FEATURE_ID_RGBA4444!==void 0){const L=i.json.accessors[f._FEATURE_ID_RGBA4444];i.json.extensionsUsed&&i.json.extensionsUsed.includes("EXT_meshopt_compression")&&(_.featureData=Pm(i,L))}f._FEATURE_RGBA4444!==void 0&&(_.featureData=new Uint32Array(Pm(i,i.json.accessors[f._FEATURE_RGBA4444]).buffer));const P=l.material;return _.material=function(L,$){const{emissiveFactor:j=[0,0,0],alphaMode:q="OPAQUE",alphaCutoff:Z=.5,normalTexture:K,occlusionTexture:ae,emissiveTexture:ue,doubleSided:fe}=L,{baseColorFactor:Me=[1,1,1,1],metallicFactor:De=1,roughnessFactor:Ve=1,baseColorTexture:He,metallicRoughnessTexture:Ze}=L.pbrMetallicRoughness||{},_t=ae?$[ae.index]:void 0;if(ae&&ae.extensions&&ae.extensions.KHR_texture_transform&&_t){const Je=ae.extensions.KHR_texture_transform;_t.offsetScale=[Je.offset[0],Je.offset[1],Je.scale[0],Je.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Bi(...Me),metallicFactor:De,roughnessFactor:Ve,baseColorTexture:He?$[He.index]:void 0,metallicRoughnessTexture:Ze?$[Ze.index]:void 0},doubleSided:fe,emissiveFactor:new Bi(...j),alphaMode:q,alphaCutoff:Z,normalTexture:K?$[K.index]:void 0,occlusionTexture:_t,emissionTexture:ue?$[ue.index]:void 0,defined:L.defined===void 0}}(P!==void 0?i.json.materials[P]:{defined:!1},a),_}function gR(l,i,a){const{matrix:h,rotation:f,translation:_,scale:y,mesh:x,extras:C,children:I}=l,R={};if(R.matrix=h||function(P,L,$,j){var q=L[0],Z=L[1],K=L[2],ae=L[3],ue=q+q,fe=Z+Z,Me=K+K,De=q*ue,Ve=q*fe,He=q*Me,Ze=Z*fe,_t=Z*Me,Je=K*Me,bt=ae*ue,Mt=ae*fe,Tt=ae*Me,It=j[0],zt=j[1],mt=j[2];return P[0]=(1-(Ze+Je))*It,P[1]=(Ve+Tt)*It,P[2]=(He-Mt)*It,P[3]=0,P[4]=(Ve-Tt)*zt,P[5]=(1-(De+Je))*zt,P[6]=(_t+bt)*zt,P[7]=0,P[8]=(He+Mt)*mt,P[9]=(_t-bt)*mt,P[10]=(1-(De+Ze))*mt,P[11]=0,P[12]=$[0],P[13]=$[1],P[14]=$[2],P[15]=1,P}([],f||[0,0,0,1],_||[0,0,0],y||[1,1,1]),x!==void 0){R.meshes=a[x];const P=R.anchor=[0,0];for(const L of R.meshes){const{min:$,max:j}=L.aabb;P[0]+=$[0]+j[0],P[1]+=$[1]+j[1]}P[0]=Math.floor(P[0]/R.meshes.length/2),P[1]=Math.floor(P[1]/R.meshes.length/2)}if(C&&(C.id&&(R.id=C.id),C.lights&&(R.lights=function(P){if(!P.length)return[];const L=function(K){const ae=atob(K),ue=new Uint8Array(ae.length);for(let fe=0;fe<ae.length;fe++)ue[fe]=ae.codePointAt(fe);return ue}(P),$=[],j=L.length/24,q=new Uint16Array(L.buffer),Z=new Float32Array(L.buffer);for(let K=0;K<j;K++){const ae=q[2*K*6]/30,ue=q[2*K*6+1]/30,fe=q[2*K*6+10]/100,Me=Z[6*K+1],De=Z[6*K+2],Ve=Z[6*K+3],He=Z[6*K+4],Ze=Ve-Me,_t=He-De,Je=Math.hypot(Ze,_t);$.push({pos:[Me+.5*Ze,De+.5*_t,ue],normal:[_t/Je,-Ze/Je,0],width:Je,height:ae,depth:fe,points:[Me,De,Ve,He]})}return $}(C.lights))),I){const P=[];for(const L of I)P.push(gR(i.json.nodes[L],i,a));R.children=P}return R}function S9(l){if(l.vertices.length===0||l.indices.length===0)return null;const i=new _1(l.vertices,l.indices,8,256),[a,h]=[i.min.clone(),i.max.clone()];return{vertices:l.vertices,indices:l.indices,grid:i,min:a,max:h}}function C9(l){if(!l.extras||!l.extras.ground)return null;const i=l.extras.ground;if(!i||!Array.isArray(i)||i.length===0)return null;const a=i[0];if(!a||!Array.isArray(a)||a.length===0)return null;const h=[];for(const y of a){if(!Array.isArray(y)||y.length!==2)continue;const x=y[0],C=y[1];typeof x=="number"&&typeof C=="number"&&h.push(new Dt(x,C))}if(h.length<3)return null;h.length>1&&h[h.length-1].equals(h[0])&&h.pop();let f=0;for(let y=0;y<h.length;y++){const x=h[y],C=h[(y+1)%h.length],I=h[(y+2)%h.length];f+=(x.x-C.x)*(I.y-C.y)-(I.x-C.x)*(x.y-C.y)}f>0&&h.reverse();const _=a_(h.flatMap(y=>[y.x,y.y]),[]);return _.length===0?null:{vertices:h,indices:_}}function T9(l,i){const a=[],h=[];let f=0;const _=[];for(const y of l){f=a.length;const x=y.vertexArray.float32,C=y.indexArray.uint16;for(let I=0;I<y.vertexArray.length;I++)_[0]=x[3*I+0],_[1]=x[3*I+1],_[2]=x[3*I+2],kn(_,_,i),a.push(new Dt(_[0],_[1]));for(let I=0;I<3*y.indexArray.length;I++)h.push(C[I]+f)}if(h.length%3!=0)return null;for(let y=0;y<h.length;y+=3){const x=a[h[y+0]],C=a[h[y+1]],I=a[h[y+2]];(x.x-C.x)*(I.y-C.y)-(I.x-C.x)*(x.y-C.y)>0&&([h[y+1],h[y+2]]=[h[y+2],h[y+1]])}return{vertices:a,indices:h}}function _R(l){const i=function(C,I){const R=[],P=WebGL2RenderingContext;if(C.json.textures)for(const L of C.json.textures){const $={magFilter:P.LINEAR,minFilter:P.NEAREST,wrapS:P.REPEAT,wrapT:P.REPEAT};L.sampler!==void 0&&Object.assign($,C.json.samplers[L.sampler]),R.push({image:I[L.source],sampler:$,uploaded:!1})}return R}(l,l.images),a=function(C,I){const R=[];for(const P of C.json.meshes){const L=[];for(const $ of P.primitives)L.push(w9($,C,I));R.push(L)}return R}(l,i),{scenes:h,scene:f,nodes:_}=l.json,y=h?h[f||0].nodes:[..._.keys()],x=[];for(const C of y)x.push(gR(_[C],l,a));return function(C,I,R){const P={},L=new Set;for(let $=0;$<C.length;$++){const j=R[I[$]];if(!j.extras)continue;const q=j.extras["mapbox:footprint:version"],Z=j.extras["mapbox:footprint:id"];(q||Z)&&L.add($),q==="1.0.0"&&Z&&(P[Z]=$)}for(let $=0;$<C.length;$++){if(L.has($))continue;const j=C[$],q=R[I[$]];if(!q.extras)continue;let Z=null;j.id in P&&(Z=T9(C[P[j.id]].meshes,j.matrix)),Z||(Z=C9(q)),Z&&(j.footprint=S9(Z))}if(L.size>0){const $=Array.from(L.values()).sort((j,q)=>j-q);for(let j=$.length-1;j>=0;j--)C.splice($[j],1)}}(x,y,l.json.nodes),x}function E9(l){l.heightmap=new Float32Array(4096),l.heightmap.fill(-1);const i=l.vertexArray.float32,a=l.aabb.min[0]-1,h=l.aabb.min[1]-1,f=Rm/(l.aabb.max[0]-a+2),_=Rm/(l.aabb.max[1]-h+2);for(let y=0;y<i.length;y+=3){const x=i[y+2],C=(i[y+0]-a)*f|0,I=(i[y+1]-h)*_|0;x>l.heightmap[I*Rm+C]&&(l.heightmap[I*Rm+C]=x)}}function yR(l,i,a,h,f){a.reserve(a.length+4*l.length),h.reserve(h.length+10*l.length),f.reserve(f.length+10*l.length);let _=h.length;for(const y of l){const x=Math.min(10,Math.max(4,1.3*y.height))*i,C=[-y.normal[1],y.normal[0],0],I=Math.min(.29,.1*y.width/y.depth),R=y.width-2*y.depth*i*(I+.01),P=Di([],y.pos,C,R/2),L=Di([],y.pos,C,-R/2),$=[P[0],P[1],P[2]+y.height],j=[L[0],L[1],L[2]+y.height],q=Di([],y.normal,C,I);Pt(q,q,x);const Z=Di([],y.normal,C,-I);Pt(Z,Z,x),on(q,P,q),on(Z,L,Z),P[2]+=.1,L[2]+=.1,h.emplaceBack(q[0],q[1],q[2]),h.emplaceBack(Z[0],Z[1],Z[2]),h.emplaceBack(P[0],P[1],P[2]),h.emplaceBack(L[0],L[1],L[2]),h.emplaceBack($[0],$[1],$[2]),h.emplaceBack(j[0],j[1],j[2]),h.emplaceBack(P[0],P[1],P[2]),h.emplaceBack(L[0],L[1],L[2]),h.emplaceBack(q[0],q[1],q[2]),h.emplaceBack(Z[0],Z[1],Z[2]);const K=R/x/2;f.emplaceBack(-K-I,-1,K,.8),f.emplaceBack(K+I,-1,K,.8),f.emplaceBack(-K,0,K,1.3),f.emplaceBack(K,0,K,1.3),f.emplaceBack(K+I,-.8,K,.7),f.emplaceBack(K+I,-.8,K,.7),f.emplaceBack(0,0,K,1.3),f.emplaceBack(0,0,K,1.3),f.emplaceBack(K+I,-1.2,K,.8),f.emplaceBack(K+I,-1.2,K,.8),a.emplaceBack(6+_,4+_,8+_),a.emplaceBack(7+_,9+_,5+_),a.emplaceBack(0+_,1+_,2+_),a.emplaceBack(1+_,3+_,2+_),_+=10}}function I9(l,i){const a={};a.indexArray=new bs,a.vertexArray=new Ga,a.colorArray=new Ec,yR(l,i,a.indexArray,a.vertexArray,a.colorArray);const h={defined:!0};h.emissiveFactor=Bi.black;const f={};return f.baseColorFactor=Bi.white,h.pbrMetallicRoughness=f,a.material=h,a.aabb=new Vn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),a}const vR=ki([{name:"a_pos_3f",components:3,type:"Float32"}]),A9=ki([{name:"a_normal_3",components:3,type:"Int16"}]),k9=ki([{name:"a_centroid_3",components:3,type:"Int16"}]),bR=ki([{name:"a_part_color_emissive",components:2,type:"Uint16"}]),R9=ki([{name:"a_faux_facade_color_emissive",components:2,type:"Uint16"}]),P9=ki([{name:"a_faux_facade_data",components:4,type:"Uint16"}]),M9=ki([{name:"a_faux_facade_vertical_range",components:2,type:"Uint16"}]),D9=ki([{name:"a_bloom_attenuation",components:4,type:"Float32"}]),xR=Rt.types,VC=32767;function O9(l,i){const a=Ut+i;for(const h of l)for(const f of h)if(f.x<-i||f.x>a||f.y<-i||f.y>a)return!1;return!0}class wR{constructor(){this.layoutVertexArray=new Ga,this.layoutAttenuationArray=new Ec,this.layoutColorArray=new hs,this.indexArray=new bs,this.indexArrayForConflation=new bs,this.segmentsBucket=new ro}}class $C{constructor(){this.layoutVertexArray=new Ga,this.layoutNormalArray=new Ah,this.layoutCentroidArray=new Ah,this.layoutColorArray=new hs,this.layoutFacadePaintArray=null,this.layoutFacadeDataArray=null,this.layoutFacadeVerticalRangeArray=null,this.layoutAOArray=[],this.indexArray=new bs,this.indexArrayForConflation=new bs,this.segmentsBucket=new ro,this.entranceBloom=new wR}}class SR{constructor(i){this.colorBufferUploaded=!1,this.maxHeight=0,this.replacementUpdateTime=0,this.activeReplacements=[],this.footprints=[],this.featuresOnBorder=[],this.buildingFeatures=[],this.buildingWithoutFacade=new $C,this.buildingWithFacade=new $C,this.indexArrayForConflationUploaded=!1,this.footprintLookup={},this.zoom=i.zoom,this.canonical=i.canonical,this.layers=i.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=i.index,this.hasPattern=!1,this.worldview=i.worldview,this.lut=i.lut,this.buildingWithFacade.layoutFacadePaintArray=new hs,this.buildingWithFacade.layoutFacadeDataArray=new Gf,this.buildingWithFacade.layoutFacadeVerticalRangeArray=new hs,this.programConfigurations=new Ic(i.layers,{zoom:i.zoom,lut:i.lut}),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.projection=i.projection,this.groundEffect=new TC(i)}updateFootprints(i,a){for(const h of this.footprints)a.push({footprint:h,id:i})}prepare(){return function(){if(C1!=null||tR!=null)return null;if(h_!=null)return h_;const i=fetch(ko.BUILDING_GEN_URL);return h_=function(a){let h,f,_,y;function x(){h=new Uint8Array(y.buffer),f=new Int32Array(y.buffer),_=new Float32Array(y.buffer)}function C(){throw new Error("Unexpected BuildingGen error.")}const I=()=>{},R={a:{a:C,f:function(P){const L=h.length,$=Math.max(P>>>0,Math.ceil(1.2*L)),j=Math.ceil(($-L)/65536);try{return y.grow(j),x(),!0}catch{return!1}},g:C,b:I,c:I,d:I,e:I}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(a,R):a.then(P=>P.arrayBuffer()).then(P=>WebAssembly.instantiate(P,R))).then(P=>{const L=P.instance.exports;return(0,L.g)(),y=L.f,x(),new a9({setStyle:L.h,setAOOptions:L.i,setMetricOptions:L.j,setStructuralOptions:L.k,setFacadeOptions:L.l,setFauxFacadeOptions:L.m,setFacadeClassifierOptions:L.n,addFeature:L.o,addFacade:L.p,generateMesh:L.q,getLastError:L.r,getOuterRingLength:L.s,getMeshCount:L.t,getPositionsPtr:L.u,getPositionsLength:L.v,getNormalsPtr:L.w,getNormalsLength:L.x,getColorsPtr:L.y,getColorsLength:L.z,getAOPtr:L.A,getAOLength:L.B,getUVPtr:L.C,getUVLength:L.D,getFauxFacadePtr:L.E,getFauxFacadeLength:L.F,getIndicesPtr:L.G,getIndicesLength:L.H,getBuildingPart:L.I,getRingCount:L.J,getRingPtr:L.K,getRingLength:L.L,free:L.M,malloc:L.N,heapU8:h,heap32:f,heapF32:_})})}(i).then(a=>(h_=null,C1=a,C1)).catch(a=>{li("Could not load building-gen"),h_=null,tR=a}),h_}()}populate(i,a,h,f){const _=l9();if(!_)return;const y=et(h);this.tileToMeter=y,this.brightness=a.brightness,_.setStyle({convertToMeters:!1,entranceColorRgb:[1,1,1],facadeGlazingColorRgb:[.5607843137254902,.6745098039215687,.7215686274509804],normalScale:[1,-1,y],ridgeHeight:3,roofColorRgb:[.886274516,.784313738,.713725507],tileToMeters:y,tileZoom:16,wallColorRgb:[.988235294,.933333337,.811764717]}),_.setAOOptions(!1,.3),_.setMetricOptions(!1,16),_.setStructuralOptions(!0),_.setFacadeClassifierOptions(3);const x=new Map;for(const{feature:C}of i){if(xR[C.type]!=="LineString")continue;const I=this.layers[0]._featureFilter.needGeometry,R=Lt(C,I);if(!this.layers[0]._featureFilter.filter(new Tr(this.zoom),R,h))continue;const P=I?R.geometry:rn(C,h,f),L=[];for(const Z of P)for(const K of Z)L.push({x:K.x,y:K.y});const $={coordinates:L,crossPerc:C.properties.cross_perc,distanceToRoad:C.properties.distance_to_road,entrances:C.properties.entrances,sourceId:0},j=C.properties.source_id;let q=x.get(j);q||(q=[],x.set(j,q)),q.push($)}this.maxHeight=0;for(const{feature:C,index:I}of i){if(xR[C.type]==="LineString")continue;const R=this.layers[0]._featureFilter.needGeometry,P=Lt(C,R);if(!this.layers[0]._featureFilter.filter(new Tr(this.zoom),P,h))continue;const L=R?P.geometry:rn(C,h,f),$=tv(L,500);if(!O9(L,163))continue;const j=this.layers[0],q=j.layout.get("building-base").evaluate(C,{},h),Z=j.layout.get("building-height").evaluate(C,{},h),K=j.layout.get("building-roof-shape").evaluate(C,{},h),ae=j.paint.get("building-ambient-occlusion-intensity"),ue=j.paint.get("building-ambient-occlusion-ground-radius")/this.tileToMeter;if(K==="flat")continue;const fe=j.layout.get("building-facade").evaluate(C,{},h);_.setFacadeOptions(4,!0),_.setFauxFacadeOptions(fe,!1,1);const Me=C.properties.source_id;let De;De=x.has(Me)?x.get(Me):[];let Ve=0,He=0,Ze=0,_t=0,Je=0,bt=0;if(fe){let un=Math.round(j.layout.get("building-facade-floors").evaluate(C,{},h));if(q===0){un=Math.max(1,un-(De.length>0?1:0));let Pi=4;if(Z>100){const ge=[10,13,15];Pi=ge[C.id?C.id%ge.length:0],_.setFacadeOptions(Pi,!0)}Je=1.6803*Pi/y}else Je=q/y;bt=Z/y,Je=Math.min(Je,bt),Ze=j.layout.get("building-facade-unit-width").evaluate(C,{},h)/y,_t=(bt-Je)/un,_.setFauxFacadeOptions(!0,!0,Ze);const Qn=j.layout.get("building-facade-window").evaluate(C,{},h);Ve=Qn[0],He=Qn[1]}const Mt=[],Tt=new Dt(1/0,1/0),It=new Dt(-1/0,-1/0),zt=new Dt(0,0);let mt=0;for(const un of $)if(un.length>0){const Qn=[];for(const Pi of un){const ge=[];for(let ye=Pi.length-1;ye>=0;ye--){const lt=Pi[ye];ge.push({x:lt.x,y:lt.y}),Tt.x=Math.min(Tt.x,lt.x),Tt.y=Math.min(Tt.y,lt.y),It.x=Math.max(It.x,lt.x),It.y=Math.max(It.y,lt.y),zt.x+=lt.x,zt.y+=lt.y,mt++}Qn.push(ge)}Mt.push({id:C.id?C.id:0,height:Z,minHeight:q,sourceId:0,roofType:K,coordinates:Qn})}zt.x/=mt||1,zt.y/=mt||1;const At=_.generateMesh(Mt,De);if(typeof At=="string"){li(`Unable to generate building ${C.id}: ${At}`);continue}if(At.meshes.length===0||At.modifiedPolygonRings.length===0)continue;let ct=0;for(const un of At.meshes)ct+=un.positions.length/3;const rt=fe?this.buildingWithFacade:this.buildingWithoutFacade,Bt=rt.segmentsBucket.prepareSegment(ct,rt.layoutVertexArray,rt.indexArray),Ot=[];let En=null,ln=0,pn=-1;const Ht=rt.indexArray.length;let Tn=0;for(const un of At.meshes){const Qn=rt.layoutVertexArray.length;if(un.buildingPart==="entrance"){const gt=new Array;for(let An=0;An<un.indices.length;An+=12){const _i=un.positions[An+0],vi=un.positions[An+1],fi=un.positions[An+3],ar=un.positions[An+4],Zr=un.positions[An+2],di=un.positions[An+8]-Zr,kr=1,hr=fi-_i,Zi=ar-vi,Or=Math.hypot(hr,Zi);gt.push({pos:[_i+.5*hr,vi+.5*Zi,Zr],normal:[Zi/Or,-hr/Or,0],width:Or,height:di,depth:kr,points:[_i,vi,fi,ar]})}const Xt=rt.entranceBloom.segmentsBucket.prepareSegment(10*gt.length,rt.entranceBloom.layoutVertexArray,rt.entranceBloom.indexArray),Kt=rt.entranceBloom.layoutVertexArray.length;ln=rt.entranceBloom.indexArray.length,yR(gt,.5/this.tileToMeter,rt.entranceBloom.indexArray,rt.entranceBloom.layoutVertexArray,rt.entranceBloom.layoutAttenuationArray);const cn=rt.entranceBloom.layoutVertexArray.length-Kt;pn=rt.entranceBloom.indexArray.length-ln;for(let An=0;An<cn;An++)rt.entranceBloom.layoutColorArray.emplaceBack(65535,65535);Xt.vertexLength+=cn,Xt.primitiveLength+=pn,En={part:un.buildingPart,vertexOffset:Kt,vertexLength:cn}}for(let gt=0;gt<un.positions.length;gt+=3)Tn=Math.max(Tn,un.positions[gt+2]),rt.layoutVertexArray.emplaceBack(un.positions[gt],un.positions[gt+1],un.positions[gt+2]);const Pi=Math.floor(zt.x),ge=Math.floor(zt.y),ye=Math.floor(Tn);for(let gt=0;gt<un.positions.length;gt+=3)rt.layoutCentroidArray.emplaceBack(Pi,ge,ye);for(let gt=0;gt<un.normals.length;gt+=3)rt.layoutNormalArray.emplaceBack(un.normals[gt+0]*VC,un.normals[gt+1]*VC,un.normals[gt+2]*VC);for(let gt=0;gt<un.ao.length;gt++)rt.layoutAOArray.push(un.ao[gt]);for(let gt=0;gt<un.colors.length;gt+=3){const Xt=1+(un.ao[gt/3]-1)*ae;rt.layoutColorArray.emplaceBack(un.colors[gt]*Xt<<8|un.colors[gt+1]*Xt,un.colors[gt+2]*Xt<<8)}if(fe){for(let gt=0;gt<un.positions.length;gt+=3)rt.layoutFacadePaintArray.emplaceBack(65535,255);for(let gt=0;gt<un.isFauxFacade.length;gt++)if(un.isFauxFacade[gt]){const Xt=1|Math.min(65535,Math.floor(un.uv[2*gt]*At.outerRingLength)),Kt=Math.floor(255*Ve)<<8|Math.floor(255*He),cn=Math.floor(65535*Math.min(1,Ze/Ut)),An=Math.floor(65535*Math.min(1,_t/Ut));rt.layoutFacadeDataArray.emplaceBack(Xt,Kt,cn,An);const _i=Math.floor(65535*Math.min(1,Je/Ut)),vi=Math.floor(65535*Math.min(1,bt/Ut));rt.layoutFacadeVerticalRangeArray.emplaceBack(_i,vi)}else rt.layoutFacadeDataArray.emplaceBack(0,0,0,0),rt.layoutFacadeVerticalRangeArray.emplaceBack(0,0)}const lt=Bt.vertexLength;for(let gt=0;gt<un.indices.length;gt+=3)rt.indexArray.emplaceBack(lt+un.indices[gt],lt+un.indices[gt+1],lt+un.indices[gt+2]);Bt.vertexLength+=un.positions.length/3,Bt.primitiveLength+=un.indices.length/3,(un.buildingPart==="roof"||un.buildingPart==="wall"||un.buildingPart==="facade_glazing"||un.buildingPart==="entrance")&&Ot.push({part:un.buildingPart,vertexOffset:Qn,vertexLength:un.positions.length/3})}this.maxHeight=Math.max(this.maxHeight,Tn),this.buildingFeatures.push({feature:P,hasFauxFacade:fe,segment:Bt,parts:Ot,buildingBloom:En});const qn=rt.indexArray.length-Ht,Jt=[],vn=[],Fn=new Dt(1/0,1/0),Yn=new Dt(-1/0,-1/0),gi=this.groundEffect.vertexArray.length;for(const un of At.modifiedPolygonRings){const Qn=[],Pi=new Dt(1/0,1/0),ge=new Dt(-1/0,-1/0);for(let ye=0;ye<un.length;ye+=2){const lt=un.length-ye-2;Pi.x=Math.min(Pi.x,un[lt]),Pi.y=Math.min(Pi.y,un[lt+1]),ge.x=Math.max(ge.x,un[lt]),ge.y=Math.max(ge.y,un[lt+1]);const gt=new Dt(un[lt],un[lt+1]);Qn.push(gt),Jt.push(gt.x,gt.y),vn.push(gt.clone())}Fn.x=Math.min(Fn.x,Pi.x),Fn.y=Math.min(Fn.y,Pi.y),Yn.x=Math.max(Yn.x,ge.x),Yn.y=Math.max(Yn.y,ge.y),this.groundEffect.addData(Qn,[Pi,ge],ue)}const ii=this.groundEffect.vertexArray.length-gi;(Tt.x<0||It.x>Ut||Tt.y<0||It.y>Ut)&&this.featuresOnBorder.push({featureId:C.id,footprintIndex:this.footprints.length});{const un=a_(Jt,null,2),Qn=new _1(vn,un,8,256);let Pi=C.id;C.properties&&C.properties.hasOwnProperty("building_id")&&(Pi=C.properties.building_id),this.footprints.push({vertices:vn,indices:un,grid:Qn,min:Fn,max:Yn,buildingId:Pi,hiddenFlags:0,indicesOffset:Ht,indicesLength:qn,bloomIndicesOffset:ln,bloomIndicesLength:pn,groundEffectVertexOffset:gi,groundEffectVertexLength:ii,hasFauxFacade:fe,segment:Bt,height:Tn})}this.programConfigurations.populatePaintArrays(rt.layoutVertexArray.length,C,I,{},a.availableImages,h,a.brightness),this.groundEffect.addPaintPropertiesData(C,I,{},a.availableImages,h,a.brightness)}this.groundEffect.prepareBorderSegments(),this.evaluate(this.layers[0],{})}update(i,a,h,f,_,y,x){this.programConfigurations.updatePaintArrays(i,a,_,h,f,y,x),this.groundEffect.update(i,a,_,h,f,y,x),this.evaluate(this.layers[0],i),this.colorBufferUploaded=!1}isEmpty(){return this.buildingWithoutFacade.layoutVertexArray.length===0&&this.buildingWithFacade.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(i){const a=h=>{h.layoutVertexBuffer=i.createVertexBuffer(h.layoutVertexArray,vR.members),h.layoutNormalBuffer=i.createVertexBuffer(h.layoutNormalArray,A9.members),h.layoutCentroidBuffer=i.createVertexBuffer(h.layoutCentroidArray,k9.members),h.layoutFacadeDataArray&&h.layoutFacadeDataArray.length&&(h.layoutFacadeDataBuffer=i.createVertexBuffer(h.layoutFacadeDataArray,P9.members)),h.layoutFacadeVerticalRangeArray&&h.layoutFacadeVerticalRangeArray.length&&(h.layoutFacadeVerticalRangeBuffer=i.createVertexBuffer(h.layoutFacadeVerticalRangeArray,M9.members)),h.entranceBloom.layoutVertexArray.length&&(h.entranceBloom.layoutVertexBuffer=i.createVertexBuffer(h.entranceBloom.layoutVertexArray,vR.members),h.entranceBloom.layoutAttenuationBuffer=i.createVertexBuffer(h.entranceBloom.layoutAttenuationArray,D9.members)),this.uploadUpdatedColorBuffer(i),this.uploadUpdatedIndexBuffer(i)};this.uploaded||(a(this.buildingWithoutFacade),a(this.buildingWithFacade),this.groundEffect.upload(i)),this.groundEffect.uploadPaintProperties(i),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){const i=a=>{a.layoutVertexBuffer&&(a.layoutVertexBuffer.destroy(),a.layoutNormalBuffer.destroy(),a.layoutColorBuffer.destroy(),a.segmentsBucket.destroy(),a.indexBuffer&&a.indexBuffer.destroy(),a.entranceBloom.layoutVertexBuffer&&(a.entranceBloom.layoutVertexBuffer.destroy(),a.entranceBloom.layoutColorBuffer.destroy(),a.entranceBloom.layoutAttenuationBuffer.destroy(),a.entranceBloom.indexBuffer.destroy(),a.entranceBloom.segmentsBucket.destroy()))};i(this.buildingWithoutFacade),i(this.buildingWithFacade),this.groundEffect.destroy(),this.programConfigurations.destroy()}updateFootprintHiddenFlags(i,a,h=!0){let f=!1;const _=h?a:0,y=0|(h?-1:~a);this.groundEffect.hiddenByLandmarkVertexArray.length===0&&this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const x of i){const C=this.footprints[x],I=C.hiddenFlags&y|_;C.hiddenFlags!==I&&(C.hiddenFlags=I,f=!0,this.groundEffect.updateHiddenByLandmarkRange(C.groundEffectVertexOffset,C.groundEffectVertexLength,C.hiddenFlags!==0))}return f&&(this.indexArrayForConflationUploaded=!1),f}uploadUpdatedIndexBuffer(i){if(this.groundEffect.uploadHiddenByLandmark(i),this.indexArrayForConflationUploaded)return;const a=f=>{f.indexArray.length!==0&&(f.indexArrayForConflation.resize(f.indexArray.length),f.indexArrayForConflation.uint16.set(f.indexArray.uint16),f.entranceBloom.indexArrayForConflation.resize(f.entranceBloom.indexArray.length),f.entranceBloom.indexArrayForConflation.uint16.set(f.entranceBloom.indexArray.uint16))};a(this.buildingWithoutFacade),a(this.buildingWithFacade);for(const f of this.footprints){const _=f.hasFauxFacade?this.buildingWithFacade:this.buildingWithoutFacade,y=f.indicesOffset+f.indicesLength;if(f.hiddenFlags!==0){for(let C=f.indicesOffset;C<y;C++)_.indexArrayForConflation.uint16[3*C+0]=0,_.indexArrayForConflation.uint16[3*C+1]=0,_.indexArrayForConflation.uint16[3*C+2]=0;const x=f.bloomIndicesOffset+f.bloomIndicesLength;for(let C=f.bloomIndicesOffset;C<x;C++)_.entranceBloom.indexArrayForConflation.uint16[3*C+0]=0,_.entranceBloom.indexArrayForConflation.uint16[3*C+1]=0,_.entranceBloom.indexArrayForConflation.uint16[3*C+2]=0}}const h=f=>{f.indexArray.length!==0&&(f.indexBuffer?f.indexBuffer.updateData(f.indexArrayForConflation):f.indexBuffer=i.createIndexBuffer(f.indexArrayForConflation,!0),f.entranceBloom.indexBuffer?f.entranceBloom.indexBuffer.updateData(f.entranceBloom.indexArrayForConflation):f.entranceBloom.indexBuffer=i.createIndexBuffer(f.entranceBloom.indexArrayForConflation,!0))};h(this.buildingWithoutFacade),h(this.buildingWithFacade),this.indexArrayForConflationUploaded=!0}uploadUpdatedColorBuffer(i){const a=h=>{h.layoutColorBuffer?h.layoutColorBuffer.updateData(h.layoutColorArray):h.layoutColorBuffer=i.createVertexBuffer(h.layoutColorArray,bR.members,!0),h.layoutFacadePaintArray&&(h.layoutFacadePaintBuffer?h.layoutFacadePaintBuffer.updateData(h.layoutFacadePaintArray):h.layoutFacadePaintBuffer=i.createVertexBuffer(h.layoutFacadePaintArray,R9.members,!0)),h.entranceBloom.layoutColorBuffer?h.entranceBloom.layoutColorBuffer.updateData(h.entranceBloom.layoutColorArray):h.entranceBloom.layoutColorBuffer=i.createVertexBuffer(h.entranceBloom.layoutColorArray,bR.members,!0)};a(this.buildingWithoutFacade),a(this.buildingWithFacade),this.colorBufferUploaded=!0}evaluate(i,a){const h=i.paint.get("building-ambient-occlusion-intensity");for(const f of this.buildingFeatures){const _=a[f.feature.id],y=f.feature;y.properties["building-part"]="roof";const x=i.paint.get("building-color").evaluate(y,_,this.canonical).toPremultipliedRenderColor(this.lut),C=i.paint.get("building-emissive-strength").evaluate(y,_,this.canonical);y.properties["building-part"]="wall";const I=i.paint.get("building-color").evaluate(y,_,this.canonical).toPremultipliedRenderColor(this.lut),R=i.paint.get("building-emissive-strength").evaluate(y,_,this.canonical);y.properties["building-part"]="window";const P=i.paint.get("building-color").evaluate(y,_,this.canonical).toPremultipliedRenderColor(this.lut),L=i.paint.get("building-emissive-strength").evaluate(y,_,this.canonical);y.properties["building-part"]="door";const $=i.paint.get("building-color").evaluate(y,_,this.canonical).toPremultipliedRenderColor(this.lut),j=i.paint.get("building-emissive-strength").evaluate(y,_,this.canonical),q=f.hasFauxFacade?this.buildingWithFacade:this.buildingWithoutFacade;for(const K of f.parts){let ae,ue=x;K.part==="roof"?(ue=x,ae=C):K.part==="wall"?(ue=I,ae=R):K.part==="facade_glazing"?(ue=P,ae=L):K.part==="entrance"&&(ue=$,ae=j),ae=Le(ae,0,1);for(let fe=0;fe<K.vertexLength;fe++){const Me=K.vertexOffset+fe,De=1+(q.layoutAOArray[Me]-1)*h;q.layoutColorArray.emplace(Me,ue.r*De*255<<8|ue.g*De*255,ue.b*De*255<<8|255*ae),f.hasFauxFacade&&q.layoutFacadePaintArray.emplace(Me,255*P.r<<8|255*P.g,255*P.b<<8|255*L)}}const Z=f.buildingBloom;if(Z)for(let K=0;K<Z.vertexLength;K++)q.entranceBloom.layoutColorArray.emplace(Z.vertexOffset+K,255*$.r<<8|255*$.g,255*$.b<<8|51*j)}}needsEvaluation(){return!this.colorBufferUploaded}updateReplacement(i,a,h){if(a.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=a.updateTime;const f=a.getReplacementRegionsForTile(i.toUnwrapped());if(v1(this.activeReplacements,f))return;this.activeReplacements=f;for(const y of this.footprints)y.hiddenFlags&=-2;const _=[];for(const y of this.activeReplacements){if(y.order<=Ik)continue;const x=Math.max(1,Math.pow(2,y.footprintTileId.canonical.z-i.canonical.z));for(const C of this.footprints)C.min.x>y.max.x||C.max.x<y.min.x||C.min.y>y.max.y||C.max.y<y.min.y||(_.length=0,L9(C.vertices,0,C.vertices.length,y.footprintTileId.canonical,i.canonical,_),xC(y.footprint,_,C.indices,0,C.indices.length,0,-x)&&(C.hiddenFlags|=1))}this.groundEffect.hiddenByLandmarkVertexArray.length===0&&this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const y of this.footprints)this.groundEffect.updateHiddenByLandmarkRange(y.groundEffectVertexOffset,y.groundEffectVertexLength,y.hiddenFlags!==0);this.indexArrayForConflationUploaded=!1}getHeightAtTileCoord(i,a){let h=Number.NEGATIVE_INFINITY,f=!0;const _=4*(i+Ut)*Ut+(a+Ut);if(this.footprintLookup.hasOwnProperty(_)){const x=this.footprintLookup[_];return x?{height:x.height,hidden:x.hiddenFlags!==0}:void 0}const y=new Dt(i,a);for(const x of this.footprints)i>x.max.x||x.min.x>i||a>x.max.y||x.min.y>a||x.height<=h||wC(y,x)&&(h=x.height,this.footprintLookup[_]=x,f=x.hiddenFlags!==0);if(h!==Number.NEGATIVE_INFINITY)return{height:h,hidden:f};this.footprintLookup[_]=void 0}}function L9(l,i,a,h,f,_){const y=Math.pow(2,h.z-f.z);for(let x=0;x<a;x++){let C=l[x+i].x,I=l[x+i].y;C=(C+f.x*Ut)*y-h.x*Ut,I=(I+f.y*Ut)*y-h.y*Ut,_.push(new Dt(C,I))}}let CR,TR;en(SR,"BuildingBucket",{omit:["layers"]}),en($C,"BuildingGeometry"),en(wR,"BuildingBloomGeometry");const z9=ki([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),B9=ki([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:F9}=z9,N9=ki([{name:"a_packed",components:3,type:"Float32"}]),{members:V9}=N9,$9=ki([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:j9}=$9;class ER{constructor(i,a){this.width=i,this.height=a,this.nextRow=0,this.image=new Qf({width:i,height:a}),this.positions={},this.uploaded=!1}getDash(i,a){const h=this.getKey(i,a);return this.positions[h]}trim(){const i=this.width,a=this.height=xn(this.nextRow);this.image.resize({width:i,height:a})}getKey(i,a){return i.join(",")+a}getDashRanges(i,a,h){const f=[];let _=i.length%2==1?-i[i.length-1]*h:0,y=i[0]*h,x=!0;f.push({left:_,right:y,isDash:x,zeroLength:i[0]===0});let C=i[0];for(let I=1;I<i.length;I++){x=!x;const R=i[I];_=C*h,C+=R,y=C*h,f.push({left:_,right:y,isDash:x,zeroLength:R===0})}return f}addRoundDash(i,a,h){const f=a/2;for(let _=-h;_<=h;_++){const y=this.width*(this.nextRow+h+_);let x=0,C=i[x];for(let I=0;I<this.width;I++){I/C.right>1&&(C=i[++x]);const R=Math.abs(I-C.left),P=Math.abs(I-C.right),L=Math.min(R,P);let $;const j=_/h*(f+1);if(C.isDash){const q=f-Math.abs(j);$=Math.sqrt(L*L+q*q)}else $=f-Math.sqrt(L*L+j*j);this.image.data[y+I]=Math.max(0,Math.min(255,$+128))}}}addRegularDash(i,a){for(let C=i.length-1;C>=0;--C){const I=i[C],R=i[C+1];I.zeroLength?i.splice(C,1):R&&R.isDash===I.isDash&&(R.left=I.left,i.splice(C,1))}const h=i[0],f=i[i.length-1];h.isDash===f.isDash&&(h.left=f.left-this.width,f.right=h.right+this.width);const _=this.width*this.nextRow;let y=0,x=i[y];for(let C=0;C<this.width;C++){C/x.right>1&&(x=i[++y]);const I=Math.abs(C-x.left),R=Math.abs(C-x.right),P=Math.min(I,R);this.image.data[_+C]=Math.max(0,Math.min(255,(x.isDash?P:-P)+a+128))}}addDash(i,a){const h=this.getKey(i,a);if(this.positions[h])return this.positions[h];const f=a==="round",_=f?7:0,y=2*_+1;if(this.nextRow+y>this.height)return li("LineAtlas out of space"),null;i.length===0&&i.push(1);let x=0;for(let R=0;R<i.length;R++)i[R]<0&&(li("Negative value is found in line dasharray, replacing values with 0"),i[R]=0),x+=i[R];if(x!==0){const R=this.width/x,P=this.getDashRanges(i,this.width,R);f?this.addRoundDash(P,R,_):this.addRegularDash(P,a==="square"?.5*R:0)}const C=this.nextRow+_;this.nextRow+=y;const I={tl:[C,_],br:[x,0]};return this.positions[h]=I,I}}en(ER,"LineAtlas");const U9=Rt.types,H9=Math.cos(Math.PI/180*37.5),G9=Math.cos(Math.PI/180*5);class jC{constructor(i){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.elevationType="none",this.zoom=i.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=i.overscaling,this.pixelRatio=i.pixelRatio,this.layers=i.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=i.index,this.projection=i.projection,this.hasPattern=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new Kg,this.layoutVertexArray2=new Ga,this.patternVertexArray=new Ga,this.indexArray=new bs,this.programConfigurations=new Ic(i.layers,{zoom:i.zoom,lut:i.lut}),this.segments=new ro,this.maxLineLength=0,this.zOffsetVertexArray=new Ga,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.tessellationStep=i.tessellationStep?i.tessellationStep:Ut/64,this.worldview=i.worldview}updateFootprints(i,a){}populate(i,a,h,f){this.hasPattern=mC("line",this.layers,this.pixelRatio,a);const _=this.layers[0].layout.get("line-sort-key");this.tileToMeter=et(h);const y=this.layers[0].layout.get("line-elevation-reference");if(y==="hd-road-markup")this.elevationType="road";else{const L=this.layers[0].layout.get("line-z-offset"),$=L.isConstant()&&!L.constantOr(0);this.elevationType=y!=="sea"&&y!=="ground"&&$?"none":"offset",this.elevationType==="offset"&&y==="none"&&li(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`)}const x=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.elevationType==="offset"&&x!==void 0;const C=[];for(const{feature:L,id:$,index:j,sourceLayerIndex:q}of i){const Z=this.layers[0]._featureFilter.needGeometry,K=Lt(L,Z);if(!this.layers[0]._featureFilter.filter(new Tr(this.zoom,{worldview:this.worldview}),K,h))continue;const ae=_?_.evaluate(K,{},h):void 0,ue={id:$,properties:L.properties,type:L.type,sourceLayerIndex:q,index:j,geometry:Z?K.geometry:rn(L,h,f),patterns:{},sortKey:ae};C.push(ue)}_&&C.sort((L,$)=>L.sortKey-$.sortKey);const{lineAtlas:I,featureIndex:R}=a,P=this.addConstantDashes(I);for(const L of C){const{geometry:$,index:j,sourceLayerIndex:q}=L;if(P&&this.addFeatureDashes(L,I),this.hasPattern){const Z=gC("line",this.layers,L,this.zoom,this.pixelRatio,a);this.patternFeatures.push(Z)}else this.addFeature(L,$,j,h,I.positions,a.availableImages,a.brightness,a.elevationFeatures);R.insert(i[j].feature,$,j,q,this.index)}}addConstantDashes(i){let a=!1;for(const h of this.layers){const f=h.paint.get("line-dasharray").value,_=h.layout.get("line-cap").value;if(f.kind!=="constant"||_.kind!=="constant")a=!0;else{const y=_.value,x=f.value;if(!x)continue;i.addDash(x,y)}}return a}addFeatureDashes(i,a){const h=this.zoom;for(const f of this.layers){const _=f.paint.get("line-dasharray").value,y=f.layout.get("line-cap").value;if(_.kind==="constant"&&y.kind==="constant")continue;let x,C;if(_.kind==="constant"){if(x=_.value,!x)continue}else x=_.evaluate({zoom:h},i);C=y.kind==="constant"?y.value:y.evaluate({zoom:h},i),a.addDash(x,C),i.patterns[f.id]=[a.getKey(x,C)]}}update(i,a,h,f,_,y,x,C){this.programConfigurations.updatePaintArrays(i,a,_,h,f,y,x,C)}addFeatures(i,a,h,f,_,y){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,a,h,f,y)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,V9)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=i.createVertexBuffer(this.patternVertexArray,j9)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=i.createVertexBuffer(this.zOffsetVertexArray,B9.members,!0)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,F9),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i,a){let h,f;if(a&&a>0?(h=`mapbox_clip_start_${a}`,f=`mapbox_clip_end_${a}`):(h="mapbox_clip_start",f="mapbox_clip_end"),i.properties&&i.properties.hasOwnProperty(h)&&i.properties.hasOwnProperty(f))return{start:+i.properties[h],end:+i.properties[f]}}addFeature(i,a,h,f,_,y,x,C){const I=this.layers[0].layout,R=I.get("line-join").evaluate(i,{}),P=I.get("line-cap").evaluate(i,{}),L=I.get("line-miter-limit"),$=I.get("line-round-limit");this.lineClips=this.lineFeatureClips(i),this.lineFeature=i;const j=!(!i.properties||!i.properties.hasOwnProperty("mapbox_line_metrics"))&&i.properties.mapbox_line_metrics;this.zOffsetValue=I.get("line-z-offset").value;const q=this.layers[0].paint.get("line-width").value;if(q.kind!=="constant"&&q.isLineProgressConstant===!1&&(this.variableWidthValue=q),this.elevationType==="road"){const Z=this.layoutVertexArray.length;if(!this.addElevatedRoadFeature(i,a,f,C,R,P,L,$)){const[K,ae]=this.clipRuntimeLinesToTile(a,1);for(let ue=0;ue<K.length;ue++){const fe=K[ue],Me=ae[ue],De={progress:{min:Me.progress.min,max:Me.progress.max},nextDir:this.computeSegNextDir(Me,fe),prevDir:this.computeSegPrevDir(Me,fe)};this.addLine(fe,i,f,R,P,L,$,De,j&&Me.parentIndex>0?Me.parentIndex:null)}this.fillNonElevatedRoadSegment(Z)}}else for(let Z=0;Z<a.length;Z++)this.addLine(a[Z],i,f,R,P,L,$,void 0,j&&Z>0?Z:null);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,_,y,f,x,void 0,this.worldview)}computeSegNextDir(i,a){return i.nextPoint.sub(a.at(-2)).unit()}computeSegPrevDir(i,a){return a[1].sub(i.prevPoint).unit()}clipLinesToTile(i,a){return w1(i,-a,-a,Ut+a,Ut+a)}clipRuntimeLinesToTile(i,a){const h=[];return[w1(i,-a,-a,Ut+a,Ut+a,h),h]}addElevatedRoadFeature(i,a,h,f,_,y,x,C){const I=[],R=Yr.getElevationFeature(i,f);if(R){const P=this.clipLinesToTile(a,1),L=this.prepareElevatedLines(P,R,h);for(const $ of L)I.push({geometry:$,elevation:R,elevationTileID:h,segment:{progress:{min:0,max:1},nextDir:void 0,prevDir:void 0}})}if(I.length===0)return!1;for(const P of I){const L=this.layoutVertexArray.length;this.addLine(P.geometry,i,h,_,y,x,C);const $=new es(h,P.elevationTileID);if(P.elevation)for(let j=L;j<this.layoutVertexArray.length;j++){const q=new Dt(this.layoutVertexArray.int16[6*j]>>1,this.layoutVertexArray.int16[6*j+1]>>1),Z=$.pointElevation(q,P.elevation,.05);this.updateHeightRange(Z),this.zOffsetVertexArray.emplaceBack(Z,0,0)}else this.fillNonElevatedRoadSegment(L)}return!0}prepareElevatedLines(i,a,h){if(a.constantHeight!=null)return i;const f=[],_=1/et(h);for(const y of i)r9(y,new sr(a,_),0,f);return f}fillNonElevatedRoadSegment(i){for(let a=i;a<this.layoutVertexArray.length;a++)this.zOffsetVertexArray.emplaceBack(0,0,0)}updateHeightRange(i){this.heightRange?(this.heightRange.min=Math.min(this.heightRange.min,i),this.heightRange.max=Math.max(this.heightRange.max,i)):this.heightRange={min:i,max:i}}addLine(i,a,h,f,_,y,x,C,I){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0,this.lineClips=I?this.lineFeatureClips(a,I):this.lineClips;const R=f==="none";this.patternJoinNone=this.hasPattern&&R,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[];const P=C&&C.progress.min>0,L=C&&C.progress.max<1;if(this.lineClips){let Ze={min:this.lineClips.start,max:this.lineClips.end},_t=1;if(C){const Mt=this.lineClips.end-this.lineClips.start;Ze=function(Tt,It,zt){return{min:Ya(Tt.min,It,zt),max:Ya(Tt.max,It,zt)}}(C.progress,{min:0,max:1},Ze),Mt>0&&(_t=(Ze.max-Ze.min)/Mt)}const Je=+a.properties.mapbox_clip_feature_len,bt=+a.properties.mapbox_clip_seg_len;if(Number.isNaN(Je)||Number.isNaN(bt)){for(let Tt=0;Tt<i.length-1;Tt++)this.totalDistance+=i[Tt].dist(i[Tt+1]);const Mt=this.totalDistance/(Ze.max-Ze.min);this.totalFeatureLength=Number.isFinite(Mt)?Mt:0,this.lineClips.start=Ze.min,this.lineClips.end=Ze.max,this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}else this.totalFeatureLength=Je,this.distance=bt*_t,this.lineClips.start=Ze.min,this.lineClips.end=Ze.max,this.maxLineLength=Math.max(this.maxLineLength,this.distance);this.lineClipsArray.push(this.lineClips),this.updateScaledDistance()}const $=U9[a.type]==="Polygon";let j=i.length;for(;j>=2&&i[j-1].equals(i[j-2]);)j--;let q=0;for(;q<j-1&&i[q].equals(i[q+1]);)q++;if(j<($?3:2))return;f==="bevel"&&(y=1.05);const Z=this.segments.prepareSegment(10*j,this.layoutVertexArray,this.indexArray);let K,ae,ue,fe,Me,De,Ve,He;C&&C.prevDir&&(De=C.prevDir.perp()),C&&C.nextDir&&(Ve=C.nextDir.perp()),this.e1=this.e2=-1,$&&(K=i[j-2],Me=i[q].sub(K)._unit()._perp());for(let Ze=q;Ze<j;Ze++){if(ue=Ze===j-1?$?i[q+1]:void 0:i[Ze+1],ue&&i[Ze].equals(ue))continue;Me&&(fe=Me),K&&(ae=K),K=i[Ze],He=this.evaluateLineProgressFeatures(ae?ae.dist(K):0),Me=ue?ue.sub(K)._unit()._perp():fe,fe=fe||Me;const _t=ae&&ue;let Je=_t?f:$||R?"butt":_;const bt=fe.x*Me.x+fe.y*Me.y;if(R){const rt=function(Bt){if(Bt.patternJoinNone){const Ot=Bt.segmentPoints.length/2,En=Bt.lineSoFar-Bt.segmentStart;for(let ln=0;ln<Ot;++ln){const pn=Bt.segmentPoints[2*ln+1],Ht=Math.round(Bt.segmentPoints[2*ln])+.5+.25*pn;Bt.patternVertexArray.emplaceBack(Ht,En,Bt.segmentStart),Bt.patternVertexArray.emplaceBack(Ht,En,Bt.segmentStart)}Bt.segmentPoints.length=0}Bt.e1=Bt.e2=-1};if(_t&&bt<G9){this.updateDistance(ae,K),this.addCurrentVertex(K,fe,1,1,Z,He),rt(this),this.addCurrentVertex(K,Me,-1,-1,Z,He);continue}if(ae){if(!ue){this.updateDistance(ae,K),this.addCurrentVertex(K,fe,1,1,Z,He),rt(this);continue}Je="miter"}}let Mt=fe.add(Me);Mt.x===0&&Mt.y===0||Mt._unit();const Tt=Mt.x*Me.x+Mt.y*Me.y,It=Tt!==0?1/Tt:1/0,zt=2*Math.sqrt(2-2*Tt),mt=Tt<H9&&ae&&ue,At=fe.x*Me.y-fe.y*Me.x>0,ct=this.overscaling<=16?15*Ut/(512*this.overscaling):0;if(_t&&Je==="round"){if(It<x)Je="miter";else if(It<=2){const rt=UC(K,-10,Ut+10);Je=this.elevationType==="offset"&&(rt||this.hasCrossSlope)?"miter":"fakeround"}}if(Je==="miter"&&It>y&&(Je="bevel"),Je==="bevel"&&(It>2&&(Je="flipbevel"),It<y&&(Je="miter")),ae&&!(Je==="miter"&&mt)&&this.updateDistance(ae,K),Je==="miter")if(mt){const rt=K.dist(ae);if(rt>2*ct){const Ot=K.sub(K.sub(ae)._mult(ct/rt)._round());this.updateDistance(ae,Ot),this.addCurrentVertex(Ot,fe,0,0,Z,He),ae=Ot}this.updateDistance(ae,K),Mt._mult(It),this.addCurrentVertex(K,Mt,0,0,Z,He);const Bt=K.dist(ue);if(Bt>2*ct){const Ot=K.add(ue.sub(K)._mult(ct/Bt)._round());this.updateDistance(K,Ot),this.addCurrentVertex(Ot,Me,0,0,Z,He),K=Ot}}else Mt._mult(It),this.addCurrentVertex(K,Mt,0,0,Z,He);else if(Je==="flipbevel"){if(It>100)Mt=Me.mult(-1);else{const rt=It*fe.add(Me).mag()/fe.sub(Me).mag();Mt._perp()._mult(rt*(At?-1:1))}this.addCurrentVertex(K,Mt,0,0,Z,He),this.addCurrentVertex(K,Mt.mult(-1),0,0,Z,He)}else if(Je==="bevel"||Je==="fakeround"){He!=null&&ae&&this.addCurrentVertex(K,Ve||fe,-1,-1,Z,He);const rt=K.dist(ae)<=2*ct&&Je!=="bevel",Bt=Mt.mult(At?1:-1);Bt._mult(It);const Ot=Me.mult(At?-1:1),En=fe.mult(At?-1:1),ln=this.evaluateLineProgressFeatures(this.distance);if(He==null&&(this.addHalfVertex(K,Bt.x,Bt.y,!1,!At,0,Z,ln),rt||this.addHalfVertex(K,Bt.x+2*En.x,Bt.y+2*En.y,!1,At,0,Z,ln)),Je==="fakeround"){const pn=Math.round(180*zt/Math.PI/20);this.addHalfVertex(K,En.x,En.y,!1,At,0,Z,ln);for(let Ht=0;Ht<pn;Ht++){let Tn=Ht/pn;if(Tn!==.5){const Jt=Tn-.5;Tn+=Tn*Jt*(Tn-1)*((1.0904+bt*(bt*(3.55645-1.43519*bt)-3.2452))*Jt*Jt+(.848013+bt*(.215638*bt-1.06021)))}const qn=Ot.sub(En)._mult(Tn)._add(En)._unit();this.addHalfVertex(K,qn.x,qn.y,!1,At,0,Z,ln)}this.addHalfVertex(K,Ot.x,Ot.y,!1,At,0,Z,ln)}rt||He!=null||this.addHalfVertex(K,Bt.x+2*Ot.x,Bt.y+2*Ot.y,!1,At,0,Z,ln),He!=null&&ue&&this.addCurrentVertex(K,De||Me,1,1,Z,He)}else if(Je==="butt")this.addCurrentVertex(K,Mt,0,0,Z,He);else if(Je==="square"){if(!ae){const rt=P?0:-1;this.addCurrentVertex(K,Mt,rt,rt,Z,He)}if(this.addCurrentVertex(K,Mt,0,0,Z,He),ae){const rt=L?0:1;this.addCurrentVertex(K,Mt,rt,rt,Z,He)}}else if(Je==="round"){if(ae){const rt=!_t&&Ve?Ve:fe;this.addCurrentVertex(K,rt,0,0,Z,He),!_t&&L||this.addCurrentVertex(K,rt,1,1,Z,He,!0)}if(ue){const rt=!_t&&De?De:Me;!_t&&P||this.addCurrentVertex(K,rt,-1,-1,Z,He,!0),this.addCurrentVertex(K,rt,0,0,Z,He)}}}}addVerticesTo(i,a,h,f,_,y,x,C,I,R){const P=(a.w-i.w)/this.tessellationStep|0;let L=0;const $=this.scaledDistance;if(P>1){this.lineSoFar=i.w;const q=(a.x-i.x)/P,Z=(a.y-i.y)/P,K=(a.z-i.z)/P,ae=(a.w-i.w)/P;for(let ue=1;ue<P;++ue){i.x+=q,i.y+=Z,i.z+=K,this.lineSoFar+=ae,L+=ae;const fe=this.evaluateLineProgressFeatures(this.prevDistance+L);this.scaledDistance=(this.prevDistance+L)/this.totalDistance,this.addHalfVertex(i,h,f,R,!1,x,I,fe),this.addHalfVertex(i,_,y,R,!0,-C,I,fe)}}this.lineSoFar=a.w,this.scaledDistance=$;const j=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(a,h,f,R,!1,x,I,j),this.addHalfVertex(a,_,y,R,!0,-C,I,j)}evaluateLineProgressFeatures(i){if(!this.variableWidthValue&&this.elevationType!=="offset")return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+i)/this.totalFeatureLength):li(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let a=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(a=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.elevationType!=="offset"?{zOffset:0,variableWidth:a}:this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:a}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:a}}addCurrentVertex(i,a,h,f,_,y,x=!1){const C=a.x+a.y*h,I=a.y-a.x*h,R=a.y*f-a.x,P=-a.y-a.x*f;if(y!=null){const L=this.elevationType==="offset",$=-10,j=Ut+10,q=y.zOffset,Z=new Zk(i.x,i.y,q,this.lineSoFar),K=!!L&&UC(i,$,j),ae=this.lineSoFar,ue=this.distance;if(this.currentVertex)if(K){const fe=this.currentVertexIsOutside,Me=this.currentVertex,De=new Zk(i.x,i.y,q,this.lineSoFar);if(Xk(Me,De,$,j),!UC(De,$,j)){if(fe){this.e1=this.e2=-1,this.distance-=Me.dist(Z),this.lineSoFar=Me.w;const Ve=this.evaluateLineProgressFeatures(Me.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(Me,C,I,x,!1,h,_,Ve),this.addHalfVertex(Me,R,P,x,!0,-f,_,Ve),this.prevDistance=this.distance}this.distance=this.prevDistance+Me.dist(De),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(Me,De,C,I,R,P,h,f,_,x),this.distance=ue,this.scaledDistance=this.distance/this.totalDistance}}else{const fe=this.currentVertex;if(this.currentVertexIsOutside){Xk(fe,Z,$,j),this.e1=this.e2=-1,this.distance-=fe.dist(Z),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=fe.w;const Me=this.evaluateLineProgressFeatures(fe.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(fe,C,I,x,!1,h,_,Me),this.addHalfVertex(fe,R,P,x,!0,-f,_,Me),this.prevDistance=this.distance,this.distance=ue,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(fe,Z,C,I,R,P,h,f,_,x)}else K||(this.addHalfVertex(i,C,I,x,!1,h,_,y),this.addHalfVertex(i,R,P,x,!0,-f,_,y));this.currentVertex=Z,this.currentVertexIsOutside=K,this.lineSoFar=ae}else this.addHalfVertex(i,C,I,x,!1,h,_,y),this.addHalfVertex(i,R,P,x,!0,-f,_,y)}addHalfVertex({x:i,y:a},h,f,_,y,x,C,I){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),y||this.segmentPoints.push(this.lineSoFar-this.segmentStart,x)),this.layoutVertexArray.emplaceBack((i<<1)+(_?1:0),(a<<1)+(y?1:0),Math.round(63*h)+128,Math.round(63*f)+128,1+(x===0?0:x<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const P=Pn(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,P)}const R=C.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,R),C.primitiveLength++),y?this.e2=R:this.e1=R,I!=null&&this.zOffsetVertexArray.emplaceBack(I.zOffset,I.variableWidth,I.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(i,a){this.prevDistance=this.distance,this.distance+=i.dist(a),this.updateScaledDistance()}}function UC(l,i,a){return l.x<i||l.x>a||l.y<i||l.y>a}let IR,AR;function kR(l,i,a){return i*(Ut/(l.tileSize*Math.pow(2,a-l.tileID.overscaledZ)))}en(jC,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const RR=(l,i,a)=>(1-a)*l+a*i;function PR(l,i){return 1/kR(l,1,i.tileZoom)}function MR(l,i,a,h){return l.translatePosMatrix(h||i.tileID.projMatrix,i,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const DR=l=>{const i=[];OR(l)&&i.push("RENDER_LINE_DASH"),l.paint.get("line-gradient")&&i.push("RENDER_LINE_GRADIENT");const a=l.paint.get("line-trim-offset");a[0]===0&&a[1]===0||i.push("RENDER_LINE_TRIM_OFFSET"),l.paint.get("line-border-width").constantOr(1)!==0&&i.push("RENDER_LINE_BORDER");const h=l.layout.get("line-join").constantOr("miter")==="none",f=!!l.paint.get("line-pattern").constantOr(1);return h&&f&&i.push("LINE_JOIN_NONE"),i};function OR(l){const i=l.paint.get("line-dasharray").value;return i.kind!=="constant"||i.value}let HC;const LR=()=>HC||(HC={layout:IR||(IR=new _o({"line-cap":new nn(Ye.layout_line["line-cap"]),"line-join":new nn(Ye.layout_line["line-join"]),"line-miter-limit":new Vt(Ye.layout_line["line-miter-limit"]),"line-round-limit":new Vt(Ye.layout_line["line-round-limit"]),"line-sort-key":new nn(Ye.layout_line["line-sort-key"]),"line-z-offset":new nn(Ye.layout_line["line-z-offset"]),"line-elevation-reference":new Vt(Ye.layout_line["line-elevation-reference"]),"line-cross-slope":new Vt(Ye.layout_line["line-cross-slope"]),visibility:new Vt(Ye.layout_line.visibility),"line-width-unit":new Vt(Ye.layout_line["line-width-unit"])})),paint:AR||(AR=new _o({"line-opacity":new nn(Ye.paint_line["line-opacity"]),"line-color":new nn(Ye.paint_line["line-color"]),"line-translate":new Vt(Ye.paint_line["line-translate"]),"line-translate-anchor":new Vt(Ye.paint_line["line-translate-anchor"]),"line-width":new nn(Ye.paint_line["line-width"]),"line-gap-width":new nn(Ye.paint_line["line-gap-width"]),"line-offset":new nn(Ye.paint_line["line-offset"]),"line-blur":new nn(Ye.paint_line["line-blur"]),"line-dasharray":new nn(Ye.paint_line["line-dasharray"]),"line-pattern":new nn(Ye.paint_line["line-pattern"]),"line-pattern-cross-fade":new Vt(Ye.paint_line["line-pattern-cross-fade"]),"line-gradient":new $f(Ye.paint_line["line-gradient"]),"line-trim-offset":new Vt(Ye.paint_line["line-trim-offset"]),"line-trim-fade-range":new Vt(Ye.paint_line["line-trim-fade-range"]),"line-trim-color":new Vt(Ye.paint_line["line-trim-color"]),"line-emissive-strength":new Vt(Ye.paint_line["line-emissive-strength"]),"line-border-width":new nn(Ye.paint_line["line-border-width"]),"line-border-color":new nn(Ye.paint_line["line-border-color"]),"line-occlusion-opacity":new Vt(Ye.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},HC);class W9 extends nn{possiblyEvaluate(i,a){return a=new Tr(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,transition:a.transition,worldview:a.worldview}),super.possiblyEvaluate(i,a)}evaluate(i,a,h,f){return a=Object.assign({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(i,a,h,f)}}let fv;function zR(l,i){return i>0?i+2*l:l}const q9=ki([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Z9=ki([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),K9=ki([{name:"a_projected_pos",components:4,type:"Float32"}],4);ki([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const X9=ki([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),Y9=ki([{name:"a_x_axis",components:3,type:"Float32"},{name:"a_y_axis",components:3,type:"Float32"}]),J9=ki([{name:"a_texb",components:2,type:"Uint16"}]),Q9=ki([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),eV=ki([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);ki([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const BR=ki([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),tV=ki([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ki([{name:"triangle",components:3,type:"Uint16"}]),ki([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ki([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),ki([{type:"Float32",name:"offsetX"}]),ki([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Qs=24;function nV(l,i,a){return l.sections.forEach(h=>{h.text=function(f,_,y){const x=_.layout.get("text-transform").evaluate(y,{});return x==="uppercase"?f=f.toLocaleUpperCase():x==="lowercase"&&(f=f.toLocaleLowerCase()),Pl.applyArabicShaping&&(f=Pl.applyArabicShaping(f)),f}(h.text,i,a)}),l}const pv={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function iV(l){return l==="︶"||l==="﹈"||l==="︸"||l==="﹄"||l==="﹂"||l==="︾"||l==="︼"||l==="︺"||l==="︘"||l==="﹀"||l==="︐"||l==="︓"||l==="︔"||l==="｀"||l==="￣"||l==="︑"||l==="︒"}function rV(l){return l==="︵"||l==="﹇"||l==="︷"||l==="﹃"||l==="﹁"||l==="︽"||l==="︻"||l==="︹"||l==="︗"||l==="︿"}const GC=4294967296,FR=1/GC,NR=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");let R1=class{constructor(l=new Uint8Array(16)){this.buf=ArrayBuffer.isView(l)?l:new Uint8Array(l),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(l,i,a=this.length){for(;this.pos<a;){const h=this.readVarint(),f=h>>3,_=this.pos;this.type=7&h,l(f,i,this),this.pos===_&&this.skip(h)}return i}readMessage(l,i){return this.readFields(l,i,this.readVarint()+this.pos)}readFixed32(){const l=this.dataView.getUint32(this.pos,!0);return this.pos+=4,l}readSFixed32(){const l=this.dataView.getInt32(this.pos,!0);return this.pos+=4,l}readFixed64(){const l=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*GC;return this.pos+=8,l}readSFixed64(){const l=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*GC;return this.pos+=8,l}readFloat(){const l=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,l}readDouble(){const l=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,l}readVarint(l){const i=this.buf;let a,h;return h=i[this.pos++],a=127&h,h<128?a:(h=i[this.pos++],a|=(127&h)<<7,h<128?a:(h=i[this.pos++],a|=(127&h)<<14,h<128?a:(h=i[this.pos++],a|=(127&h)<<21,h<128?a:(h=i[this.pos],a|=(15&h)<<28,function(f,_,y){const x=y.buf;let C,I;if(I=x[y.pos++],C=(112&I)>>4,I<128||(I=x[y.pos++],C|=(127&I)<<3,I<128)||(I=x[y.pos++],C|=(127&I)<<10,I<128)||(I=x[y.pos++],C|=(127&I)<<17,I<128)||(I=x[y.pos++],C|=(127&I)<<24,I<128)||(I=x[y.pos++],C|=(1&I)<<31,I<128))return p_(f,C,_);throw new Error("Expected varint not more than 10 bytes")}(a,l,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const l=this.readVarint();return l%2==1?(l+1)/-2:l/2}readBoolean(){return!!this.readVarint()}readString(){const l=this.readVarint()+this.pos,i=this.pos;return this.pos=l,l-i>=12&&NR?NR.decode(this.buf.subarray(i,l)):function(a,h,f){let _="",y=h;for(;y<f;){const x=a[y];let C,I,R,P=null,L=x>239?4:x>223?3:x>191?2:1;if(y+L>f)break;L===1?x<128&&(P=x):L===2?(C=a[y+1],(192&C)==128&&(P=(31&x)<<6|63&C,P<=127&&(P=null))):L===3?(C=a[y+1],I=a[y+2],(192&C)==128&&(192&I)==128&&(P=(15&x)<<12|(63&C)<<6|63&I,(P<=2047||P>=55296&&P<=57343)&&(P=null))):L===4&&(C=a[y+1],I=a[y+2],R=a[y+3],(192&C)==128&&(192&I)==128&&(192&R)==128&&(P=(15&x)<<18|(63&C)<<12|(63&I)<<6|63&R,(P<=65535||P>=1114112)&&(P=null))),P===null?(P=65533,L=1):P>65535&&(P-=65536,_+=String.fromCharCode(P>>>10&1023|55296),P=56320|1023&P),_+=String.fromCharCode(P),y+=L}return _}(this.buf,i,l)}readBytes(){const l=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,l);return this.pos=l,i}readPackedVarint(l=[],i){const a=this.readPackedEnd();for(;this.pos<a;)l.push(this.readVarint(i));return l}readPackedSVarint(l=[]){const i=this.readPackedEnd();for(;this.pos<i;)l.push(this.readSVarint());return l}readPackedBoolean(l=[]){const i=this.readPackedEnd();for(;this.pos<i;)l.push(this.readBoolean());return l}readPackedFloat(l=[]){const i=this.readPackedEnd();for(;this.pos<i;)l.push(this.readFloat());return l}readPackedDouble(l=[]){const i=this.readPackedEnd();for(;this.pos<i;)l.push(this.readDouble());return l}readPackedFixed32(l=[]){const i=this.readPackedEnd();for(;this.pos<i;)l.push(this.readFixed32());return l}readPackedSFixed32(l=[]){const i=this.readPackedEnd();for(;this.pos<i;)l.push(this.readSFixed32());return l}readPackedFixed64(l=[]){const i=this.readPackedEnd();for(;this.pos<i;)l.push(this.readFixed64());return l}readPackedSFixed64(l=[]){const i=this.readPackedEnd();for(;this.pos<i;)l.push(this.readSFixed64());return l}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(l){const i=7&l;if(i===0)for(;this.buf[this.pos++]>127;);else if(i===2)this.pos=this.readVarint()+this.pos;else if(i===5)this.pos+=4;else{if(i!==1)throw new Error(`Unimplemented type: ${i}`);this.pos+=8}}writeTag(l,i){this.writeVarint(l<<3|i)}realloc(l){let i=this.length||16;for(;i<this.pos+l;)i*=2;if(i!==this.length){const a=new Uint8Array(i);a.set(this.buf),this.buf=a,this.dataView=new DataView(a.buffer),this.length=i}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(l){this.realloc(4),this.dataView.setInt32(this.pos,l,!0),this.pos+=4}writeSFixed32(l){this.realloc(4),this.dataView.setInt32(this.pos,l,!0),this.pos+=4}writeFixed64(l){this.realloc(8),this.dataView.setInt32(this.pos,-1&l,!0),this.dataView.setInt32(this.pos+4,Math.floor(l*FR),!0),this.pos+=8}writeSFixed64(l){this.realloc(8),this.dataView.setInt32(this.pos,-1&l,!0),this.dataView.setInt32(this.pos+4,Math.floor(l*FR),!0),this.pos+=8}writeVarint(l){(l=+l||0)>268435455||l<0?function(i,a){let h,f;if(i>=0?(h=i%4294967296|0,f=i/4294967296|0):(h=~(-i%4294967296),f=~(-i/4294967296),4294967295^h?h=h+1|0:(h=0,f=f+1|0)),i>=18446744073709552e3||i<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");a.realloc(10),function(_,y,x){x.buf[x.pos++]=127&_|128,_>>>=7,x.buf[x.pos++]=127&_|128,_>>>=7,x.buf[x.pos++]=127&_|128,_>>>=7,x.buf[x.pos++]=127&_|128,x.buf[x.pos]=127&(_>>>=7)}(h,0,a),function(_,y){const x=(7&_)<<4;y.buf[y.pos++]|=x|((_>>>=3)?128:0),_&&(y.buf[y.pos++]=127&_|((_>>>=7)?128:0),_&&(y.buf[y.pos++]=127&_|((_>>>=7)?128:0),_&&(y.buf[y.pos++]=127&_|((_>>>=7)?128:0),_&&(y.buf[y.pos++]=127&_|((_>>>=7)?128:0),_&&(y.buf[y.pos++]=127&_)))))}(f,a)}(l,this):(this.realloc(4),this.buf[this.pos++]=127&l|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=l>>>7&127))))}writeSVarint(l){this.writeVarint(l<0?2*-l-1:2*l)}writeBoolean(l){this.writeVarint(+l)}writeString(l){l=String(l),this.realloc(4*l.length),this.pos++;const i=this.pos;this.pos=function(h,f,_){for(let y,x,C=0;C<f.length;C++){if(y=f.charCodeAt(C),y>55295&&y<57344){if(!x){y>56319||C+1===f.length?(h[_++]=239,h[_++]=191,h[_++]=189):x=y;continue}if(y<56320){h[_++]=239,h[_++]=191,h[_++]=189,x=y;continue}y=x-55296<<10|y-56320|65536,x=null}else x&&(h[_++]=239,h[_++]=191,h[_++]=189,x=null);y<128?h[_++]=y:(y<2048?h[_++]=y>>6|192:(y<65536?h[_++]=y>>12|224:(h[_++]=y>>18|240,h[_++]=y>>12&63|128),h[_++]=y>>6&63|128),h[_++]=63&y|128)}return _}(this.buf,l,this.pos);const a=this.pos-i;a>=128&&VR(i,a,this),this.pos=i-1,this.writeVarint(a),this.pos+=a}writeFloat(l){this.realloc(4),this.dataView.setFloat32(this.pos,l,!0),this.pos+=4}writeDouble(l){this.realloc(8),this.dataView.setFloat64(this.pos,l,!0),this.pos+=8}writeBytes(l){const i=l.length;this.writeVarint(i),this.realloc(i);for(let a=0;a<i;a++)this.buf[this.pos++]=l[a]}writeRawMessage(l,i){this.pos++;const a=this.pos;l(i,this);const h=this.pos-a;h>=128&&VR(a,h,this),this.pos=a-1,this.writeVarint(h),this.pos+=h}writeMessage(l,i,a){this.writeTag(l,2),this.writeRawMessage(i,a)}writePackedVarint(l,i){i.length&&this.writeMessage(l,oV,i)}writePackedSVarint(l,i){i.length&&this.writeMessage(l,sV,i)}writePackedBoolean(l,i){i.length&&this.writeMessage(l,cV,i)}writePackedFloat(l,i){i.length&&this.writeMessage(l,aV,i)}writePackedDouble(l,i){i.length&&this.writeMessage(l,lV,i)}writePackedFixed32(l,i){i.length&&this.writeMessage(l,uV,i)}writePackedSFixed32(l,i){i.length&&this.writeMessage(l,dV,i)}writePackedFixed64(l,i){i.length&&this.writeMessage(l,hV,i)}writePackedSFixed64(l,i){i.length&&this.writeMessage(l,fV,i)}writeBytesField(l,i){this.writeTag(l,2),this.writeBytes(i)}writeFixed32Field(l,i){this.writeTag(l,5),this.writeFixed32(i)}writeSFixed32Field(l,i){this.writeTag(l,5),this.writeSFixed32(i)}writeFixed64Field(l,i){this.writeTag(l,1),this.writeFixed64(i)}writeSFixed64Field(l,i){this.writeTag(l,1),this.writeSFixed64(i)}writeVarintField(l,i){this.writeTag(l,0),this.writeVarint(i)}writeSVarintField(l,i){this.writeTag(l,0),this.writeSVarint(i)}writeStringField(l,i){this.writeTag(l,2),this.writeString(i)}writeFloatField(l,i){this.writeTag(l,5),this.writeFloat(i)}writeDoubleField(l,i){this.writeTag(l,1),this.writeDouble(i)}writeBooleanField(l,i){this.writeVarintField(l,+i)}};function p_(l,i,a){return a?4294967296*i+(l>>>0):4294967296*(i>>>0)+(l>>>0)}function VR(l,i,a){const h=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));a.realloc(h);for(let f=a.pos-1;f>=l;f--)a.buf[f+h]=a.buf[f]}function oV(l,i){for(let a=0;a<l.length;a++)i.writeVarint(l[a])}function sV(l,i){for(let a=0;a<l.length;a++)i.writeSVarint(l[a])}function aV(l,i){for(let a=0;a<l.length;a++)i.writeFloat(l[a])}function lV(l,i){for(let a=0;a<l.length;a++)i.writeDouble(l[a])}function cV(l,i){for(let a=0;a<l.length;a++)i.writeBoolean(l[a])}function uV(l,i){for(let a=0;a<l.length;a++)i.writeFixed32(l[a])}function dV(l,i){for(let a=0;a<l.length;a++)i.writeSFixed32(l[a])}function hV(l,i){for(let a=0;a<l.length;a++)i.writeFixed64(l[a])}function fV(l,i){for(let a=0;a<l.length;a++)i.writeSFixed64(l[a])}const WC=3;function pV(l,i,a){i.glyphs=[],l===1&&a.readMessage(mV,i)}function mV(l,i,a){if(l===3){const{id:h,bitmap:f,width:_,height:y,left:x,top:C,advance:I}=a.readMessage(gV,{});i.glyphs.push({id:h,bitmap:new Qf({width:_+2*WC,height:y+2*WC},f),metrics:{width:_,height:y,left:x,top:C,advance:I}})}else l===4?i.ascender=a.readSVarint():l===5&&(i.descender=a.readSVarint())}function gV(l,i,a){l===1?i.id=a.readVarint():l===2?i.bitmap=a.readBytes():l===3?i.width=a.readVarint():l===4?i.height=a.readVarint():l===5?i.left=a.readSVarint():l===6?i.top=a.readSVarint():l===7&&(i.advance=a.readVarint())}const $R=WC,zl={horizontal:1,vertical:2,horizontalOnly:3};class mv{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(i,a){const h=new mv;return h.scale=i||1,h.fontStack=a,h}static forImage(i){const a=new mv;return a.image=i,a}}class m_{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,a,h){const f=new m_;for(let _=0;_<i.sections.length;_++){const y=i.sections[_];y.image?f.addImageSection(y,h):f.addTextSection(y,a)}return f}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSections(){return this.sections}getSectionIndex(i){return this.sectionIndex[i]}getCodePoint(i){return this.text.codePointAt(i)}verticalizePunctuation(i){this.text=function(a,h){let f="";for(let _=0;_<a.length;_++){const y=a.charCodeAt(_+1)||null,x=a.charCodeAt(_-1)||null;f+=!h&&(y&&bh(y)&&!pv[a[_+1]]||x&&bh(x)&&!pv[a[_-1]])||!pv[a[_]]?a[_]:pv[a[_]]}return f}(this.text,i)}trim(){let i=0;for(let h=0;h<this.text.length&&P1[this.text.charCodeAt(h)];h++)i++;let a=this.text.length;for(let h=this.text.length-1;h>=0&&h>=i&&P1[this.text.charCodeAt(h)];h--)a--;this.text=this.text.substring(i,a),this.sectionIndex=this.sectionIndex.slice(i,a)}substring(i,a){const h=new m_;return h.text=this.text.substring(i,a),h.sectionIndex=this.sectionIndex.slice(i,a),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,a)=>Math.max(i,this.sections[a].scale),0)}addTextSection(i,a){this.text+=i.text,this.sections.push(mv.forText(i.scale,i.fontStack||a));const h=this.sections.length-1;for(let f=0;f<i.text.length;++f)this.sectionIndex.push(h)}addImageSection(i,a){const h=i.image?i.image.getPrimary():null;if(!h)return void li("Can't add FormattedSection with an empty image.");h.scaleSelf(a);const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCodePoint(f),this.sections.push(mv.forImage(h)),this.sectionIndex.push(this.sections.length-1)):li("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function qC(l,i,a,h,f,_,y,x,C,I,R,P,L,$,j,q=1){const Z=m_.fromFeature(l,f,q);P===zl.vertical&&Z.verticalizePunctuation(L);let K=[];const ae=function(Ve,He,Ze,_t,Je,bt){if(!Ve)return[];const Mt=[],Tt=function(At,ct,rt,Bt,Ot,En){let ln=0;for(let pn=0;pn<At.length();pn++){const Ht=At.getSection(pn);ln+=jR(At.getCodePoint(pn),Ht,Bt,Ot,ct,En)}return ln/Math.max(1,Math.ceil(ln/rt))}(Ve,He,Ze,_t,Je,bt),It=Ve.text.indexOf("​")>=0;let zt=0;for(let At=0;At<Ve.length();At++){const ct=Ve.getSection(At),rt=Ve.getCodePoint(At);if(P1[rt]||(zt+=jR(rt,ct,_t,Je,He,bt)),At<Ve.length()-1){const Bt=!((mt=rt)<11904||!(Rn["Bopomofo Extended"](mt)||Rn.Bopomofo(mt)||Rn["CJK Compatibility Forms"](mt)||Rn["CJK Compatibility Ideographs"](mt)||Rn["CJK Compatibility"](mt)||Rn["CJK Radicals Supplement"](mt)||Rn["CJK Strokes"](mt)||Rn["CJK Symbols and Punctuation"](mt)||Rn["CJK Unified Ideographs Extension A"](mt)||Rn["CJK Unified Ideographs"](mt)||Rn["Enclosed CJK Letters and Months"](mt)||Rn["Halfwidth and Fullwidth Forms"](mt)||Rn.Hiragana(mt)||Rn["Ideographic Description Characters"](mt)||Rn["Kangxi Radicals"](mt)||Rn["Katakana Phonetic Extensions"](mt)||Rn.Katakana(mt)||Rn["Vertical Forms"](mt)||Rn["Yi Radicals"](mt)||Rn["Yi Syllables"](mt)));(_V[rt]||Bt||ct.image)&&Mt.push(HR(At+1,zt,Tt,Mt,yV(rt,Ve.getCodePoint(At+1),Bt&&It),!1))}}var mt;return GR(HR(Ve.length(),zt,Tt,Mt,0,!0))}(Z,I,_,i,h,$),{processBidirectionalText:ue,processStyledBidirectionalText:fe}=Pl;if(ue&&Z.sections.length===1){const Ve=ue(Z.toString(),ae);for(const He of Ve){const Ze=new m_;Ze.text=He,Ze.sections=Z.sections;for(let _t=0;_t<He.length;_t++)Ze.sectionIndex.push(0);K.push(Ze)}}else if(fe){const Ve=fe(Z.text,Z.sectionIndex,ae);for(const He of Ve){const Ze=new m_;Ze.text=He[0],Ze.sectionIndex=He[1],Ze.sections=Z.sections,K.push(Ze)}}else K=function(Ve,He){const Ze=[],_t=Ve.text;let Je=0;for(const bt of He)Ze.push(Ve.substring(Je,bt)),Je=bt;return Je<_t.length&&Ze.push(Ve.substring(Je,_t.length)),Ze}(Z,ae);const Me=[],De={positionedLines:Me,text:Z.toString(),top:R[1],bottom:R[1],left:R[0],right:R[0],writingMode:P,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if(function(Ve,He,Ze,_t,Je,bt,Mt,Tt,It,zt,mt,At){let ct=0,rt=0,Bt=0;const Ot=Tt==="right"?1:Tt==="left"?0:.5;let En=!1;for(const Jt of Je){const vn=Jt.getSections();for(const Fn of vn){if(Fn.image)continue;const Yn=He[Fn.fontStack];if(Yn&&(En=Yn.ascender!==void 0&&Yn.descender!==void 0,!En))break}if(!En)break}let ln=0;for(const Jt of Je){Jt.trim();const vn=Jt.getMaxScale(),Fn=(vn-1)*Qs,Yn={positionedGlyphs:[],lineOffset:0};Ve.positionedLines[ln]=Yn;const gi=Yn.positionedGlyphs;let ii=0;if(!Jt.length()){rt+=bt,++ln;continue}let un=0,Qn=0;for(let ge=0;ge<Jt.length();ge++){const ye=Jt.getSection(ge),lt=Jt.getSectionIndex(ge),gt=Jt.getCodePoint(ge);let Xt=ye.scale,Kt=null,cn=null,An=null,_i=Qs,vi=0,fi=It;fi===zl.vertical&&((pn=gt)===12312||pn===12313||pn===12316||pn===12540||pn===12448)&&(fi=zl.horizontal);const ar=!(fi===zl.horizontal||!mt&&!Nf(gt)||mt&&(P1[gt]||Py(gt)));if(ye.image){const Zr=_t.get(ye.image.toString());if(!Zr)continue;An=ye.image,Ve.iconsInText=Ve.iconsInText||!0,cn=Zr.paddedRect;const di=Zr.displaySize;Xt=Xt*Qs/At,Kt={width:di[0],height:di[1],left:0,top:-$R,advance:ar?di[1]:di[0],localGlyph:!1},vi=En?-Kt.height*Xt:vn*Qs-17-di[1]*Xt,_i=Kt.advance;const kr=(ar?di[0]:di[1])*Xt-Qs*vn;kr>0&&kr>ii&&(ii=kr)}else{const Zr=Ze[ye.fontStack];if(!Zr)continue;Zr[gt]&&(cn=Zr[gt]);const di=He[ye.fontStack];if(!di)continue;const kr=di.glyphs[gt];if(!kr)continue;if(Kt=kr.metrics,_i=gt!==8203?Qs:0,En){const hr=di.ascender!==void 0?Math.abs(di.ascender):0,Zi=di.descender!==void 0?Math.abs(di.descender):0,Or=(hr+Zi)*Xt;un<Or&&(un=Or,Qn=(hr-Zi)/2*Xt),vi=-hr*Xt}else vi=(vn-Xt)*Qs-17}ar?(Ve.verticalizable=!0,gi.push({glyph:gt,image:An,x:ct,y:rt+vi,vertical:ar,scale:Xt,localGlyph:Kt.localGlyph,fontStack:ye.fontStack,sectionIndex:lt,metrics:Kt,rect:cn}),ct+=_i*Xt+zt):(gi.push({glyph:gt,image:An,x:ct,y:rt+vi,vertical:ar,scale:Xt,localGlyph:Kt.localGlyph,fontStack:ye.fontStack,sectionIndex:lt,metrics:Kt,rect:cn}),ct+=Kt.advance*Xt+zt)}gi.length!==0&&(Bt=Math.max(ct-zt,Bt),En?WR(gi,Ot,ii,Qn,bt*vn/2):WR(gi,Ot,ii,0,bt/2)),ct=0;const Pi=bt*vn+ii;Yn.lineOffset=Math.max(ii,Fn),rt+=Pi,++ln}var pn;const Ht=rt,{horizontalAlign:Tn,verticalAlign:qn}=ZC(Mt);(function(Jt,vn,Fn,Yn,gi,ii){const un=(vn-Fn)*gi,Qn=-ii*Yn;for(const Pi of Jt)for(const ge of Pi.positionedGlyphs)ge.x+=un,ge.y+=Qn})(Ve.positionedLines,Ot,Tn,qn,Bt,Ht),Ve.top+=-qn*Ht,Ve.bottom=Ve.top+Ht,Ve.left+=-Tn*Bt,Ve.right=Ve.left+Bt,Ve.hasBaseline=En}(De,i,a,h,K,y,x,C,P,I,L,j),!function(Ve){for(const He of Ve)if(He.positionedGlyphs.length!==0)return!1;return!0}(Me))return De}const P1={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},_V={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function jR(l,i,a,h,f,_){if(i.image){const y=h.get(i.image.toString());return y?y.displaySize[0]*i.scale*Qs/_+f:0}{const y=a[i.fontStack],x=y&&y.glyphs[l];return x?x.metrics.advance*i.scale+f:0}}function UR(l,i,a,h){const f=Math.pow(l-i,2);return h?l<i?f/2:2*f:f+Math.abs(a)*a}function yV(l,i,a){let h=0;return l===10&&(h-=1e4),a&&(h+=150),l!==40&&l!==65288||(h+=50),i!==41&&i!==65289||(h+=50),h}function HR(l,i,a,h,f,_){let y=null,x=UR(i,a,f,_);for(const C of h){const I=UR(i-C.x,a,f,_)+C.badness;I<=x&&(y=C,x=I)}return{index:l,x:i,priorBreak:y,badness:x}}function GR(l){return l?GR(l.priorBreak).concat(l.index):[]}function ZC(l){let i=.5,a=.5;switch(l){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:i,verticalAlign:a}}function WR(l,i,a,h,f){if(!(i||a||h||f))return;const _=l.length-1,y=l[_],x=(y.x+y.metrics.advance*y.scale)*i;for(let C=0;C<=_;C++)l[C].x-=x,l[C].y+=a+h+f}function qR(l){return l.imagePrimary!==void 0&&l.top!==void 0&&l.bottom!==void 0&&l.left!==void 0&&l.right!==void 0}function vV(l,i,a,h){const{horizontalAlign:f,verticalAlign:_}=ZC(h),y=a[0]-l.displaySize[0]*f,x=a[1]-l.displaySize[1]*_;return{imagePrimary:l,imageSecondary:i,top:x,bottom:x+l.displaySize[1],left:y,right:y+l.displaySize[0]}}function ZR(l,i,a,h,f,_){const y=l.imagePrimary;let x;if(y.content){const Z=y.content,K=y.pixelRatio||1;x=[Z[0]/K,Z[1]/K,y.displaySize[0]-Z[2]/K,y.displaySize[1]-Z[3]/K]}const C=i.left*_,I=i.right*_;let R,P,L,$;a==="width"||a==="both"?($=f[0]+C-h[3],P=f[0]+I+h[1]):($=f[0]+(C+I-y.displaySize[0])/2,P=$+y.displaySize[0]);const j=i.top*_,q=i.bottom*_;return a==="height"||a==="both"?(R=f[1]+j-h[0],L=f[1]+q+h[2]):(R=f[1]+(j+q-y.displaySize[1])/2,L=R+y.displaySize[1]),{imagePrimary:y,imageSecondary:void 0,top:R,right:P,bottom:L,left:$,collisionPadding:x}}function KR(l){return!l.imagePrimary.stretchX}function XR(l){return!l.imagePrimary.stretchY}function YR(l){return{width:l.right-l.left,height:l.bottom-l.top}}const Vd=128;function JR(l,i,a){const{expression:h}=i;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new Tr(l+1,{worldview:a}))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:_}=h;let y=0;for(;y<f.length&&f[y]<=l;)y++;y=Math.max(0,y-1);let x=y;for(;x<f.length&&f[x]<l+1;)x++;x=Math.min(f.length-1,x);const C=f[y],I=f[x];return h.kind==="composite"?{kind:"composite",minZoom:C,maxZoom:I,interpolationType:_}:{kind:"camera",minZoom:C,maxZoom:I,minSize:h.evaluate(new Tr(C,{worldview:a})),maxSize:h.evaluate(new Tr(I,{worldview:a})),interpolationType:_}}}function KC(l,{uSize:i,uSizeT:a},{lowerSize:h,upperSize:f}){return l.kind==="source"?h/Vd:l.kind==="composite"?Pn(h/Vd,f/Vd,a):i}function gv(l,i,a=1){let h=0,f=0;if(l.kind==="constant")f=l.layoutSize*a;else if(l.kind!=="source"){const{interpolationType:_,minZoom:y,maxZoom:x}=l,C=_?Le(Ia.interpolationFactor(_,i,y,x),0,1):0;l.kind==="camera"?f=Pn(l.minSize,l.maxSize,C)*a:h=C*a}return{uSizeT:h,uSize:f}}class Lh extends Dt{constructor(i,a,h,f,_){super(i,a),this.angle=f,this.z=h,_!==void 0&&(this.segment=_)}clone(){return new Lh(this.x,this.y,this.z,this.angle,this.segment)}}function QR(l,i,a,h,f){if(i.segment===void 0)return!0;let _=i,y=i.segment+1,x=0;for(;x>-a/2;){if(y--,y<0)return!1;x-=l[y].dist(_),_=l[y]}x+=l[y].dist(l[y+1]),y++;const C=[];let I=0;for(;x<a/2;){const R=l[y],P=l[y+1];if(!P)return!1;let L=l[y-1].angleTo(R)-R.angleTo(P);for(L=Math.abs((L+3*Math.PI)%(2*Math.PI)-Math.PI),C.push({distance:x,angleDelta:L}),I+=L;x-C[0].distance>h;)I-=C.shift().angleDelta;if(I>f)return!1;y++,x+=R.dist(P)}return!0}function eP(l){let i=0;for(let a=0;a<l.length-1;a++)i+=l[a].dist(l[a+1]);return i}function tP(l,i,a){return l?.6*i*a:0}function nP(l,i){return Math.max(l?l.right-l.left:0,i?i.right-i.left:0)}function bV(l,i,a,h,f,_){const y=tP(a,f,_),x=nP(a,h)*_;let C=0;const I=eP(l)/2;for(let R=0;R<l.length-1;R++){const P=l[R],L=l[R+1],$=P.dist(L);if(C+$>I){const j=(I-C)/$,q=Pn(P.x,L.x,j),Z=Pn(P.y,L.y,j),K=new Lh(q,Z,0,L.angleTo(P),R);return!y||QR(l,K,x,y,i)?K:void 0}C+=$}}function xV(l,i,a,h,f,_,y,x,C){const I=tP(h,_,y),R=nP(h,f),P=R*y,L=l[0].x===0||l[0].x===C||l[0].y===0||l[0].y===C;return i-P<i/4&&(i=P+i/4),iP(l,L?i/2*x%i:(R/2+2*_)*y*x%i,i,I,a,P,L,!1,C)}function iP(l,i,a,h,f,_,y,x,C){const I=_/2,R=eP(l);let P=0,L=i-a,$=[];for(let j=0;j<l.length-1;j++){const q=l[j],Z=l[j+1],K=q.dist(Z),ae=Z.angleTo(q);for(;L+a<P+K;){L+=a;const ue=(L-P)/K,fe=Pn(q.x,Z.x,ue),Me=Pn(q.y,Z.y,ue);if(fe>=0&&fe<C&&Me>=0&&Me<C&&L-I>=0&&L+I<=R){const De=new Lh(fe,Me,0,ae,j);h&&!QR(l,De,_,h,f)||$.push(De)}}P+=K}return x||$.length||y||($=iP(l,P/2,a,h,f,_,y,!0,C)),$}function rP(l){let i=0,a=0;for(const y of l)i+=y.w*y.h,a=Math.max(a,y.w);l.sort((y,x)=>x.h-y.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),a),h:1/0}];let f=0,_=0;for(const y of l)for(let x=h.length-1;x>=0;x--){const C=h[x];if(!(y.w>C.w||y.h>C.h)){if(y.x=C.x,y.y=C.y,_=Math.max(_,y.y+y.h),f=Math.max(f,y.x+y.w),y.w===C.w&&y.h===C.h){const I=h.pop();I&&x<h.length&&(h[x]=I)}else y.h===C.h?(C.x+=y.w,C.w-=y.w):y.w===C.w?(C.y+=y.h,C.h-=y.h):(h.push({x:C.x+y.w,y:C.y,w:C.w-y.w,h:y.h}),C.y+=y.h,C.h-=y.h);break}}return{w:f,h:_,fill:i/(f*_)||0}}en(Lh,"Anchor");const Mm=1;class _v{static getImagePositionScale(i,a,h){if(a&&i&&i.options&&i.options.transform){const f=i.options.transform;return{x:f.a,y:f.d}}return{x:h,y:h}}constructor(i,a,h,f){this.paddedRect=i;const{pixelRatio:_,version:y,stretchX:x,stretchY:C,content:I,sdf:R,usvg:P}=a;this.pixelRatio=_,this.stretchX=x,this.stretchY=C,this.content=I,this.version=y,this.padding=h,this.sdf=R,this.usvg=P,this.scale=_v.getImagePositionScale(f,P,_)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function XC(l,i,a){const h=As.parse(l),f=function(_,y,x=[1,1]){return{x:0,y:0,w:(_.data?_.data.width:_.width*x[0])+2*y,h:(_.data?_.data.height:_.height*x[1])+2*y}}(i,a,[h.options.transform.a,h.options.transform.d]);return{bin:f,imagePosition:new _v(f,i,a,h),imageVariant:h}}class oP{constructor(i,a,h){const f=new Map,_=new Map;this.haveRenderCallbacks=[];const y=[];this.addImages(i,f,Mm,y),this.addImages(a,_,2,y);const{w:x,h:C}=rP(y),I=new la({width:x||1,height:C||1});for(const[R,P]of i.entries()){const L=f.get(R).paddedRect;la.copy(P.data,I,{x:0,y:0},{x:L.x+Mm,y:L.y+Mm},P.data,null,P.sdf)}for(const[R,P]of a.entries()){const L=_.get(R),$=L.paddedRect;let j=L.padding;const q=$.x+j,Z=$.y+j,K=P.data.width,ae=P.data.height;j=j>1?j-1:j,la.copy(P.data,I,{x:0,y:0},{x:q,y:Z},P.data,h),la.copy(P.data,I,{x:0,y:ae-j},{x:q,y:Z-j},{width:K,height:j},h),la.copy(P.data,I,{x:0,y:0},{x:q,y:Z+ae},{width:K,height:j},h),la.copy(P.data,I,{x:K-j,y:0},{x:q-j,y:Z},{width:j,height:ae},h),la.copy(P.data,I,{x:0,y:0},{x:q+K,y:Z},{width:j,height:ae},h),la.copy(P.data,I,{x:K-j,y:ae-j},{x:q-j,y:Z-j},{width:j,height:j},h),la.copy(P.data,I,{x:0,y:ae-j},{x:q+K,y:Z-j},{width:j,height:j},h),la.copy(P.data,I,{x:0,y:0},{x:q+K,y:Z+ae},{width:j,height:j},h),la.copy(P.data,I,{x:K-j,y:0},{x:q-j,y:Z+ae},{width:j,height:j},h)}this.lut=h,this.image=I,this.iconPositions=f,this.patternPositions=_}addImages(i,a,h,f){for(const[_,y]of i.entries()){const{bin:x,imagePosition:C,imageVariant:I}=XC(_,y,h);a.set(_,C),f.push(x),y.hasRenderCallback&&this.haveRenderCallbacks.push(I.id)}}patchUpdatedImages(i,a,h){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(f=>i.hasImage(f,h)),i.dispatchRenderCallbacks(this.haveRenderCallbacks,h);for(const f of i.getUpdatedImages(h)){for(const _ of this.iconPositions.keys()){const y=As.parse(_);if(sa.isEqual(y.id,f)){const x=i.getImage(f,h);this.patchUpdatedImage(this.iconPositions.get(_),x,a,null)}}for(const _ of this.patternPositions.keys()){const y=As.parse(_);if(sa.isEqual(y.id,f)){const x=i.getImage(f,h);this.patchUpdatedImage(this.patternPositions.get(_),x,a,this.lut)}}}}patchUpdatedImage(i,a,h,f=null){if(!i||!a||i.version===a.version)return;i.version=a.version;const[_,y]=i.tl,x=i.sdf;if(this.lut||x){const C={width:a.data.width,height:a.data.height},I=new la(C);la.copy(a.data,I,{x:0,y:0},{x:0,y:0},C,f,x),h.update(I,{position:{x:_,y}})}else h.update(a.data,{position:{x:_,y}})}}en(_v,"ImagePosition"),en(oP,"ImageAtlas");const yv=1e20;function sP(l,i,a,h,f,_,y,x,C){for(let I=i;I<i+h;I++)aP(l,a*_+I,_,f,y,x,C);for(let I=a;I<a+f;I++)aP(l,I*_+i,1,h,y,x,C)}function aP(l,i,a,h,f,_,y){_[0]=0,y[0]=-yv,y[1]=yv,f[0]=l[i];for(let x=1,C=0,I=0;x<h;x++){f[x]=l[i+x*a];const R=x*x;do{const P=_[C];I=(f[x]-f[P]+R-P*P)/(x-P)/2}while(I<=y[C]&&--C>-1);C++,_[C]=x,y[C]=I,y[C+1]=yv}for(let x=0,C=0;x<h;x++){for(;y[C+1]<x;)C++;const I=_[C],R=x-I;l[i+x*a]=f[I]+R*R}}const Ku=2,YC={none:0,ideographs:1,all:2};class g_{constructor(i,a,h){this.requestManager=i,this.localGlyphMode=a,this.localFontFamily=h,this.url="",this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(i){this.url=i}getGlyphs(i,a){const h=[],f=this.url||ko.GLYPHS_URL;for(const _ in i)for(const y of i[_])h.push({stack:_,id:y});st(h,({stack:_,id:y},x)=>{let C=this.entries[_];C||(C=this.entries[_]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let I=C.glyphs[y];if(I!==void 0)return void x(null,{stack:_,id:y,glyph:I});if(I=this._tinySDF(C,_,y),I)return C.glyphs[y]=I,void x(null,{stack:_,id:y,glyph:I});const R=Math.floor(y/256);if(256*R>65535)return li("glyphs > 65535 not supported"),void x(null,{stack:_,id:y,glyph:I});if(C.ranges[R])return void x(null,{stack:_,id:y,glyph:I});let P=C.requests[R];P||(P=C.requests[R]=[],g_.loadGlyphRange(_,R,f,this.requestManager,(L,$)=>{if($){C.ascender=$.ascender,C.descender=$.descender;for(const j in $.glyphs)this._doesCharSupportLocalGlyph(+j)||(C.glyphs[+j]=$.glyphs[+j]);C.ranges[R]=!0}for(const j of P)j(L,$);delete C.requests[R]})),P.push((L,$)=>{L?x(L):$&&x(null,{stack:_,id:y,glyph:$.glyphs[y]||null})})},(_,y)=>{if(_)a(_);else if(y){const x={};for(const{stack:C,id:I,glyph:R}of y)x[C]===void 0&&(x[C]={}),x[C].glyphs===void 0&&(x[C].glyphs={}),x[C].glyphs[I]=R&&{id:R.id,bitmap:R.bitmap.clone(),metrics:R.metrics},x[C].ascender=this.entries[C].ascender,x[C].descender=this.entries[C].descender;a(null,x)}})}_doesCharSupportLocalGlyph(i){return this.localGlyphMode!==YC.none&&(this.localGlyphMode===YC.all?!!this.localFontFamily:!!this.localFontFamily&&(Rn["CJK Unified Ideographs"](i)||Rn["Hangul Syllables"](i)||Rn.Hiragana(i)||Rn.Katakana(i)||Rn["CJK Symbols and Punctuation"](i)||Rn["CJK Unified Ideographs Extension A"](i)||Rn["CJK Unified Ideographs Extension B"](i)||Rn.Osage(i)))}_tinySDF(i,a,h){const f=this.localFontFamily;if(!f||!this._doesCharSupportLocalGlyph(h))return;let _=i.tinySDF;if(!_){let q="400";/bold/i.test(a)?q="900":/medium/i.test(a)?q="500":/light/i.test(a)&&(q="200"),_=i.tinySDF=new g_.TinySDF({fontFamily:f,fontWeight:q,fontSize:24*Ku,buffer:3*Ku,radius:8*Ku}),_.fontWeight=q}if(this.localGlyphs[_.fontWeight][h])return this.localGlyphs[_.fontWeight][h];const y=String.fromCodePoint(h),{data:x,width:C,height:I,glyphWidth:R,glyphHeight:P,glyphLeft:L,glyphTop:$,glyphAdvance:j}=_.draw(y);return this.localGlyphs[_.fontWeight][h]={id:h,bitmap:new Qf({width:C,height:I},x),metrics:{width:R/Ku,height:P/Ku,left:L/Ku,top:$/Ku-27,advance:j/Ku,localGlyph:!0}}}}g_.loadGlyphRange=function(l,i,a,h,f){const _=256*i,y=_+255,x=h.transformRequest(h.normalizeGlyphsURL(a).replace("{fontstack}",l).replace("{range}",`${_}-${y}`),Va.Glyphs);Sa(x,(C,I)=>{if(C)f(C);else if(I){const R={},P=function(L){return new R1(L).readFields(pV,{})}(I);for(const L of P.glyphs)R[L.id]=L;f(null,{glyphs:R,ascender:P.ascender,descender:P.descender})}})},g_.TinySDF=class{constructor({fontSize:l=24,buffer:i=3,radius:a=8,cutoff:h=.25,fontFamily:f="sans-serif",fontWeight:_="normal",fontStyle:y="normal",lang:x=null}={}){this.buffer=i,this.cutoff=h,this.radius=a,this.lang=x;const C=this.size=l+4*i,I=this._createCanvas(C),R=this.ctx=I.getContext("2d",{willReadFrequently:!0});R.font=`${y} ${_} ${l}px ${f}`,R.textBaseline="alphabetic",R.textAlign="left",R.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(l){const i=document.createElement("canvas");return i.width=i.height=l,i}draw(l){const{width:i,actualBoundingBoxAscent:a,actualBoundingBoxDescent:h,actualBoundingBoxLeft:f,actualBoundingBoxRight:_}=this.ctx.measureText(l),y=Math.ceil(a),x=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-f))),C=Math.min(this.size-this.buffer,y+Math.ceil(h)),I=x+2*this.buffer,R=C+2*this.buffer,P=Math.max(I*R,0),L=new Uint8ClampedArray(P),$={data:L,width:I,height:R,glyphWidth:x,glyphHeight:C,glyphTop:y,glyphLeft:0,glyphAdvance:i};if(x===0||C===0)return $;const{ctx:j,buffer:q,gridInner:Z,gridOuter:K}=this;this.lang&&(j.lang=this.lang),j.clearRect(q,q,x,C),j.fillText(l,q,q+y);const ae=j.getImageData(q,q,x,C);K.fill(yv,0,P),Z.fill(0,0,P);for(let ue=0;ue<C;ue++)for(let fe=0;fe<x;fe++){const Me=ae.data[4*(ue*x+fe)+3]/255;if(Me===0)continue;const De=(ue+q)*I+fe+q;if(Me===1)K[De]=0,Z[De]=yv;else{const Ve=.5-Me;K[De]=Ve>0?Ve*Ve:0,Z[De]=Ve<0?Ve*Ve:0}}sP(K,0,0,I,R,I,this.f,this.v,this.z),sP(Z,q,q,x,C,I,this.f,this.v,this.z);for(let ue=0;ue<P;ue++){const fe=Math.sqrt(K[ue])-Math.sqrt(Z[ue]);L[ue]=Math.round(255-255*(fe/this.radius+this.cutoff))}return $}};const np=Mm;function lP(l,i){return l+i[1]-i[0]}function cP(l,i,a,h,f=1){const _=[],y=l.imagePrimary,x=y.pixelRatio,C=y.paddedRect.w-2*np,I=y.paddedRect.h-2*np,R=(l.right-l.left)*f,P=(l.bottom-l.top)*f,L=y.stretchX||[[0,C]],$=y.stretchY||[[0,I]],j=L.reduce(lP,0),q=$.reduce(lP,0),Z=C-j,K=I-q;let ae=0,ue=j,fe=0,Me=q,De=0,Ve=Z,He=0,Ze=K;if(y.content&&h){const Je=y.content;ae=M1(L,0,Je[0]),fe=M1($,0,Je[1]),ue=M1(L,Je[0],Je[2]),Me=M1($,Je[1],Je[3]),De=Je[0]-ae,He=Je[1]-fe,Ve=Je[2]-Je[0]-ue,Ze=Je[3]-Je[1]-Me}const _t=(Je,bt,Mt,Tt)=>{const It=D1(Je.stretch-ae,ue,R,l.left*f),zt=O1(Je.fixed-De,Ve,Je.stretch,j),mt=D1(bt.stretch-fe,Me,P,l.top*f),At=O1(bt.fixed-He,Ze,bt.stretch,q),ct=D1(Mt.stretch-ae,ue,R,l.left*f),rt=O1(Mt.fixed-De,Ve,Mt.stretch,j),Bt=D1(Tt.stretch-fe,Me,P,l.top*f),Ot=O1(Tt.fixed-He,Ze,Tt.stretch,q),En=new Dt(It,mt),ln=new Dt(ct,mt),pn=new Dt(ct,Bt),Ht=new Dt(It,Bt),Tn=new Dt(zt/x,At/x),qn=new Dt(rt/x,Ot/x),Jt=i*Math.PI/180;if(Jt){const un=Math.sin(Jt),Qn=Math.cos(Jt),Pi=[Qn,-un,un,Qn];En._matMult(Pi),ln._matMult(Pi),Ht._matMult(Pi),pn._matMult(Pi)}const vn=Je.stretch+Je.fixed,Fn=Mt.stretch+Mt.fixed,Yn=bt.stretch+bt.fixed,gi=Tt.stretch+Tt.fixed,ii=l.imageSecondary;return{tl:En,tr:ln,bl:Ht,br:pn,texPrimary:{x:y.paddedRect.x+np+vn,y:y.paddedRect.y+np+Yn,w:Fn-vn,h:gi-Yn},texSecondary:ii?{x:ii.paddedRect.x+np+vn,y:ii.paddedRect.y+np+Yn,w:Fn-vn,h:gi-Yn}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Tn,pixelOffsetBR:qn,minFontScaleX:Ve/x/R,minFontScaleY:Ze/x/P,isSDF:a}};if(h&&(y.stretchX||y.stretchY)){const Je=uP(L,Z,j),bt=uP($,K,q);for(let Mt=0;Mt<Je.length-1;Mt++){const Tt=Je[Mt],It=Je[Mt+1];for(let zt=0;zt<bt.length-1;zt++)_.push(_t(Tt,bt[zt],It,bt[zt+1]))}}else _.push(_t({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:I+1}));return _}function M1(l,i,a){let h=0;for(const f of l)h+=Math.max(i,Math.min(a,f[1]))-Math.max(i,Math.min(a,f[0]));return h}function uP(l,i,a){const h=[{fixed:-np,stretch:0}];for(const[f,_]of l){const y=h[h.length-1];h.push({fixed:f-y.stretch,stretch:y.stretch}),h.push({fixed:f-y.stretch,stretch:y.stretch+(_-f)})}return h.push({fixed:i+np,stretch:a}),h}function D1(l,i,a,h){return l/i*a+h}function O1(l,i,a,h){return l-i*a/h}function wV(l,i,a,h){const f=i+l.positionedLines[h].lineOffset;return h===0?a+f/2:a+(f+(i+l.positionedLines[h-1].lineOffset))/2}function SV(l,i=1,a=!1){let h=1/0,f=1/0,_=-1/0,y=-1/0;const x=l[0];for(let $=0;$<x.length;$++){const j=x[$];(!$||j.x<h)&&(h=j.x),(!$||j.y<f)&&(f=j.y),(!$||j.x>_)&&(_=j.x),(!$||j.y>y)&&(y=j.y)}const C=Math.min(_-h,y-f);let I=C/2;const R=new hh([],CV);if(C===0)return new Dt(h,f);for(let $=h;$<_;$+=C)for(let j=f;j<y;j+=C)R.push(new __($+I,j+I,I,l));let P=function($){let j=0,q=0,Z=0;const K=$[0];for(let ae=0,ue=K.length,fe=ue-1;ae<ue;fe=ae++){const Me=K[ae],De=K[fe],Ve=Me.x*De.y-De.x*Me.y;q+=(Me.x+De.x)*Ve,Z+=(Me.y+De.y)*Ve,j+=3*Ve}return new __(q/j,Z/j,0,$)}(l),L=R.length;for(;R.length;){const $=R.pop();($.d>P.d||!P.d)&&(P=$,a&&console.log("found best %d after %d probes",Math.round(1e4*$.d)/1e4,L)),$.max-P.d<=i||(I=$.h/2,R.push(new __($.p.x-I,$.p.y-I,I,l)),R.push(new __($.p.x+I,$.p.y-I,I,l)),R.push(new __($.p.x-I,$.p.y+I,I,l)),R.push(new __($.p.x+I,$.p.y+I,I,l)),L+=4)}return a&&(console.log(`num probes: ${L}`),console.log(`best distance: ${P.d}`)),P.p}function CV(l,i){return i.max-l.max}class __{constructor(i,a,h,f){this.p=new Dt(i,a),this.h=h,this.d=function(_,y){let x=!1,C=1/0;for(let I=0;I<y.length;I++){const R=y[I];for(let P=0,L=R.length,$=L-1;P<L;$=P++){const j=R[P],q=R[$];j.y>_.y!=q.y>_.y&&_.x<(q.x-j.x)*(_.y-j.y)/(q.y-j.y)+j.x&&(x=!x),C=Math.min(C,Jr(_,j,q))}}return(x?1:-1)*Math.sqrt(C)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}}const TV=Object.keys,JC=Number.POSITIVE_INFINITY,EV=Math.sqrt(2);function dP(l,[i,a]){let h=0,f=0;if(a===JC){i<0&&(i=0);const _=i/EV;switch(l){case"top-right":case"top-left":f=_-7;break;case"bottom-right":case"bottom-left":f=7-_;break;case"bottom":f=7-i;break;case"top":f=i-7}switch(l){case"top-right":case"bottom-right":h=-_;break;case"top-left":case"bottom-left":h=_;break;case"left":h=i;break;case"right":h=-i}}else{switch(i=Math.abs(i),a=Math.abs(a),l){case"top-right":case"top-left":case"top":f=a-7;break;case"bottom-right":case"bottom-left":case"bottom":f=7-a}switch(l){case"top-right":case"bottom-right":case"right":h=-i;break;case"top-left":case"bottom-left":case"left":h=i}}return[h,f]}function L1(l,i,a,h,f,_,y,x,C){if(!i||!i.usvg)return;const I=YR(h),R=YR(f),P=_!=="both"&&_!=="width"||!KR(h)?1:R.width/I.width,L=_!=="both"&&_!=="height"||!XR(h)?1:R.height/I.height;a.scaleSelf(P,L);const $=a.toString();y.set($,a),x.set($,i);const{imagePosition:j}=XC($,i,Mm);C.set($,j)}function hP(l,i,a,h,f,_,y,x,C){if(!l)return;const I=function(R,P,L,$,j,q){if(R.kind==="camera")return R.maxSize;if(R.kind==="composite"){const Z=P.possiblyEvaluate(new Tr(R.maxZoom,{worldview:q}),L).evaluate(j,{},L),K=P.possiblyEvaluate(new Tr(R.minZoom,{worldview:q}),L).evaluate(j,{},L);return Math.max(Z,K)}return P.possiblyEvaluate(new Tr($,{worldview:q})).evaluate(j,{},L)}(i,a,h,f,_,C);return l.scaleSelf(I*x*y)}function fP(l,i,a,h,f,_,y,x,C){return{iconPrimary:hP(l.getPrimary(),i,a,h,f,_,y,x,C),iconSecondary:hP(l.getSecondary(),i,a,h,f,_,y,x,C)}}function IV(l,i,a){if(!i)return;const h=a.get(l.toString()),f=a.get(i.toString());h&&f&&(h.paddedRect.w===f.paddedRect.w&&h.paddedRect.h===f.paddedRect.h||li(`Mismatch in icon variant sizes: ${l.toString()} and ${i.toString()}`),h.usvg!==f.usvg&&li(`Mismatch in icon variant image types: ${l.id} and ${i.id}`))}function pP(l,i,a,h){if(!l)return;const f=i.get(a.toString());if(l.imagePrimary=f,h){const _=i.get(h.toString());l.imageSecondary=_}}function AV(l,i){for(const a in l.horizontal)mP(l.horizontal[a],i);mP(l.vertical,i)}function mP(l,i){if(l){for(const a of l.positionedLines)for(const h of a.positionedGlyphs)if(h.image!==null){const f=h.image.toString();h.rect=i.get(f).paddedRect}}}function QC(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function kV(l,i,a,h,f,_,y,x,C){const I=e2(_.horizontal)||_.vertical,R=a.get("icon-text-fit-padding").evaluate(h,{},f);let P,L=i;return i&&C!=="none"&&(l.allowVerticalPlacement&&_.vertical&&(P=ZR(i,_.vertical,C,R,x,y)),I&&(L=ZR(i,I,C,R,x,y))),{defaultShapedIcon:L,verticallyShapedIcon:P}}function RV(l,i,a,h,f,_,y,x,C,I,R,P,L,$,j,q,Z,K,ae,ue){let fe=y.textMaxSize.evaluate(i,{},L);fe===void 0?fe=x*y.textScaleFactor:fe*=y.textScaleFactor;const Me=l.layers[0].layout,De=e2(a.horizontal)||a.vertical,Ve=$.name==="globe",He=Qs,Ze=l.tilePixelRatio*fe/He,_t=(zt=l.overscaling,l.zoom>18&&zt>2&&(zt>>=1),Math.max(Ut/(512*zt),1)*Me.get("symbol-spacing")),Je=Me.get("text-padding")*l.tilePixelRatio,bt=Me.get("icon-padding")*l.tilePixelRatio,Mt=Xe(Me.get("text-max-angle")),Tt=Me.get("icon-rotation-alignment")==="map"&&ue!=="point",It=_t/2;var zt;l.hasAnyIconTextFit===!1&&Z!=="none"&&(l.hasAnyIconTextFit=!0);const mt=i.properties?+i.properties[ci]:null,At=mt&&l.elevationFeatureIdToIndex?l.elevationFeatureIdToIndex.get(mt):65535,ct=(rt,Bt,Ot)=>{if(Bt.x<0||Bt.x>=Ut||Bt.y<0||Bt.y>=Ut)return;let En=null;if(Ve){const{x:ln,y:pn,z:Ht}=$.projectTilePoint(Bt.x,Bt.y,Ot);En={anchor:new Lh(ln,pn,Ht,0,void 0),up:$.upVector(Ot,Bt.x,Bt.y)}}(function(ln,pn,Ht,Tn,qn,Jt,vn,Fn,Yn,gi,ii,un,Qn,Pi,ge,ye,lt,gt,Xt,Kt,cn,An,_i,vi,fi,ar,Zr,di,kr){const hr=ln.addToLineVertexArray(pn,Tn);let Zi,Or,Lr,Er,Rr,fr,bi,gr=0,oo=0,$n=0,Fi=0,zr=-1,vo=-1;const jr={};let ps=Gc("");const br=Ht?Ht.anchor:pn,os=di!=="none";let al=0,ca=0;if(Yn._unevaluatedLayout.getValue("text-radial-offset")===void 0){const ms=Yn.layout.get("text-offset").evaluate(cn,{},fi);al=ms[0]*Qs,ca=ms[1]*Qs}else al=Yn.layout.get("text-radial-offset").evaluate(cn,{},fi)*Qs,ca=JC;if(ln.allowVerticalPlacement&&qn.vertical){const ms=qn.vertical;if(ge)fr=t2(ms),Fn&&(bi=t2(Fn));else{const Ls=Yn.layout.get("text-rotate").evaluate(cn,{},fi)+90;Lr=z1(gi,br,pn,ii,un,Qn,ms,Pi,Ls,ye),Fn&&(Er=z1(gi,br,pn,ii,un,Qn,Fn,gt,Ls))}}if(Jt){const ms=ln.iconSizeData,Ls=Yn.layout.get("icon-rotate").evaluate(cn,{},fi),ua=cP(Jt,Ls,_i,os,An.iconScaleFactor),Da=Fn?cP(Fn,Ls,_i,os,An.iconScaleFactor):void 0;Or=z1(gi,br,pn,ii,un,Qn,Jt,gt,Ls,null),gr=4*ua.length;let xa=null;ms.kind==="source"?(xa=[Vd*Yn.layout.get("icon-size").evaluate(cn,{},fi)*An.iconScaleFactor],xa[0]>ip&&li(`${ln.layerIds[0]}: Value for "icon-size" is >= ${vv}. Reduce your "icon-size".`)):ms.kind==="composite"&&(xa=[Vd*An.compositeIconSizes[0].evaluate(cn,{},fi)*An.iconScaleFactor,Vd*An.compositeIconSizes[1].evaluate(cn,{},fi)*An.iconScaleFactor],(xa[0]>ip||xa[1]>ip)&&li(`${ln.layerIds[0]}: Value for "icon-size" is >= ${vv}. Reduce your "icon-size".`)),ln.addSymbols(ln.icon,ua,xa,Kt,Xt,cn,void 0,Ht,pn,hr.lineStartIndex,hr.lineLength,-1,vi,fi,ar,Zr),zr=ln.icon.placedSymbolArray.length-1,Da&&(oo=4*Da.length,ln.addSymbols(ln.icon,Da,xa,Kt,Xt,cn,zl.vertical,Ht,pn,hr.lineStartIndex,hr.lineLength,-1,vi,fi,ar,Zr),vo=ln.icon.placedSymbolArray.length-1)}for(const ms in qn.horizontal){const Ls=ms,ua=qn.horizontal[Ls];Zi||(ps=Gc(ua.text),ge?Rr=t2(ua):Zi=z1(gi,br,pn,ii,un,Qn,ua,Pi,Yn.layout.get("text-rotate").evaluate(cn,{},fi),ye));const Da=ua.positionedLines.length===1;if($n+=gP(ln,Ht,pn,ua,vn,Yn,ge,cn,ye,hr,qn.vertical?zl.horizontal:zl.horizontalOnly,Da?TV(qn.horizontal):[Ls],jr,zr,An,vi,fi,ar),Da)break}qn.vertical&&(Fi+=gP(ln,Ht,pn,qn.vertical,vn,Yn,ge,cn,ye,hr,zl.vertical,["vertical"],jr,vo,An,vi,fi,ar));let ra=-1;const ll=(ms,Ls)=>ms?Math.max(ms,Ls):Ls;ra=ll(Rr,ra),ra=ll(fr,ra),ra=ll(bi,ra);const $d=ra>-1?1:0;ln.glyphOffsetArray.length>=65535&&li("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),cn.sortKey!==void 0&&ln.addToSortKeyRanges(ln.symbolInstances.length,cn.sortKey),ln.symbolInstances.emplaceBack(pn.x,pn.y,br.x,br.y,br.z,jr.right>=0?jr.right:-1,jr.center>=0?jr.center:-1,jr.left>=0?jr.left:-1,jr.vertical>=0?jr.vertical:-1,zr,vo,ps,Zi!==void 0?Zi:ln.collisionBoxArray.length,Zi!==void 0?Zi+1:ln.collisionBoxArray.length,Lr!==void 0?Lr:ln.collisionBoxArray.length,Lr!==void 0?Lr+1:ln.collisionBoxArray.length,Or!==void 0?Or:ln.collisionBoxArray.length,Or!==void 0?Or+1:ln.collisionBoxArray.length,Er||ln.collisionBoxArray.length,Er?Er+1:ln.collisionBoxArray.length,ii,$n,Fi,gr,oo,$d,0,al,ca,ra,0,os?1:0,kr)})(l,Bt,En,rt,a,h,_,f,l.layers[0],l.collisionBoxArray,i.index,i.sourceLayerIndex,l.index,Je,ae,I,0,bt,Tt,K,i,y,R,P,L,j,q,Z,At)};if(ue==="line")for(const rt of w1(i.geometry,0,0,Ut,Ut)){const Bt=xV(rt,_t,Mt,a.vertical||De,h,He,Ze,l.overscaling,Ut);for(const Ot of Bt)De&&PV(l,De.text,It,Ot)||ct(rt,Ot,L)}else if(ue==="line-center"){for(const rt of i.geometry)if(rt.length>1){const Bt=bV(rt,Mt,a.vertical||De,h,He,Ze);Bt&&ct(rt,Bt,L)}}else if(i.type==="Polygon")for(const rt of tv(i.geometry,0)){const Bt=SV(rt,16);ct(rt[0],new Lh(Bt.x,Bt.y,0,0,void 0),L)}else if(i.type==="LineString")for(const rt of i.geometry)ct(rt,new Lh(rt[0].x,rt[0].y,0,0,void 0),L);else if(i.type==="Point")for(const rt of i.geometry)for(const Bt of rt)ct([Bt],new Lh(Bt.x,Bt.y,0,0,void 0),L)}const vv=255,ip=vv*Vd;function gP(l,i,a,h,f,_,y,x,C,I,R,P,L,$,j,q,Z,K){const ae=function(Me,De,Ve,He,Ze,_t,Je,bt){const Mt=[];if(De.positionedLines.length===0)return Mt;const Tt=He.layout.get("text-rotate").evaluate(_t,{})*Math.PI/180,It=function(rt){const Bt=rt[0],Ot=rt[1],En=Bt*Ot;return En>0?[Bt,-Ot]:En<0?[-Bt,Ot]:Bt===0?[Ot,Bt]:[Ot,-Bt]}(Ve);let zt=Math.abs(De.top-De.bottom);for(const rt of De.positionedLines)zt-=rt.lineOffset;const mt=De.positionedLines.length,At=zt/mt;let ct=De.top-Ve[1];for(let rt=0;rt<mt;++rt){const Bt=De.positionedLines[rt];ct=wV(De,At,ct,rt);for(const Ot of Bt.positionedGlyphs){if(!Ot.rect)continue;const En=Ot.rect||{};let ln=$R+1,pn=!0,Ht=1,Tn=0;if(Ot.image){const cn=Je.get(Ot.image.toString());if(!cn)continue;if(cn.sdf){li("SDF images are not supported in formatted text and will be ignored.");continue}pn=!1,Ht=cn.pixelRatio,ln=Mm/Ht}const qn=(Ze||bt)&&Ot.vertical,Jt=Ot.metrics.advance*Ot.scale/2,vn=Ot.metrics,Fn=Ot.rect;if(Fn===null)continue;bt&&De.verticalizable&&(Tn=Ot.image?Jt-Ot.metrics.width*Ot.scale/2:0);const Yn=Ze?[Ot.x+Jt,Ot.y]:[0,0];let gi=[0,0],ii=[0,0],un=!1;Ze||(qn?(ii=[Ot.x+Jt+It[0],Ot.y+It[1]-Tn],un=!0):gi=[Ot.x+Jt+Ve[0],Ot.y+Ve[1]-Tn]);const Qn=Fn.w*Ot.scale/(Ht*(Ot.localGlyph?Ku:1)),Pi=Fn.h*Ot.scale/(Ht*(Ot.localGlyph?Ku:1));let ge,ye,lt,gt;if(qn){const cn=Ot.y-ct,An=new Dt(-Jt,Jt-cn),_i=-Math.PI/2,vi=new Dt(...ii);ge=new Dt(-Jt+gi[0],gi[1]),ge._rotateAround(_i,An)._add(vi),ge.x+=-cn+Jt,ge.y-=(vn.left-ln)*Ot.scale;const fi=Ot.image?vn.advance*Ot.scale:Qs*Ot.scale,ar=String.fromCodePoint(Ot.glyph);iV(ar)?ge.x+=(1-ln)*Ot.scale:rV(ar)?ge.x+=fi-vn.height*Ot.scale+(-ln-1)*Ot.scale:ge.x+=Ot.image||vn.width+2*ln===Fn.w&&vn.height+2*ln===Fn.h?(fi-Pi)/2:(fi-(vn.height+2*ln)*Ot.scale)/2,ye=new Dt(ge.x,ge.y-Qn),lt=new Dt(ge.x+Pi,ge.y),gt=new Dt(ge.x+Pi,ge.y-Qn)}else{const cn=(vn.left-ln)*Ot.scale-Jt+gi[0],An=(-vn.top-ln)*Ot.scale+gi[1],_i=cn+Qn,vi=An+Pi;ge=new Dt(cn,An),ye=new Dt(_i,An),lt=new Dt(cn,vi),gt=new Dt(_i,vi)}if(Tt){let cn;cn=Ze?new Dt(0,0):un?new Dt(It[0],It[1]):new Dt(Ve[0],Ve[1]),ge._rotateAround(Tt,cn),ye._rotateAround(Tt,cn),lt._rotateAround(Tt,cn),gt._rotateAround(Tt,cn)}const Xt=new Dt(0,0),Kt=new Dt(0,0);Mt.push({tl:ge,tr:ye,bl:lt,br:gt,texPrimary:En,texSecondary:void 0,writingMode:De.writingMode,glyphOffset:Yn,sectionIndex:Ot.sectionIndex,isSDF:pn,pixelOffsetTL:Xt,pixelOffsetBR:Kt,minFontScaleX:0,minFontScaleY:0})}}return Mt}(0,h,C,_,y,x,f,l.allowVerticalPlacement),ue=l.textSizeData;let fe=null;ue.kind==="source"?(fe=[Vd*_.layout.get("text-size").evaluate(x,{},Z)*j.textScaleFactor],fe[0]>ip&&li(`${l.layerIds[0]}: Value for "text-size" is >= ${vv}. Reduce your "text-size".`)):ue.kind==="composite"&&(fe=[Vd*j.compositeTextSizes[0].evaluate(x,{},Z)*j.textScaleFactor,Vd*j.compositeTextSizes[1].evaluate(x,{},Z)*j.textScaleFactor],(fe[0]>ip||fe[1]>ip)&&li(`${l.layerIds[0]}: Value for "text-size" is >= ${vv}. Reduce your "text-size".`)),l.addSymbols(l.text,ae,fe,C,y,x,R,i,a,I.lineStartIndex,I.lineLength,$,q,Z,K,!1);for(const Me of P)L[Me]=l.text.placedSymbolArray.length-1;return 4*ae.length}function e2(l){for(const i in l)return l[i];return null}function z1(l,i,a,h,f,_,y,x,C,I){let R=y.top,P=y.bottom,L=y.left,$=y.right;if(qR(y)&&y.collisionPadding){const j=y.collisionPadding;L-=j[0],R-=j[1],$+=j[2],P+=j[3]}if(C){const j=new Dt(L,R),q=new Dt($,R),Z=new Dt(L,P),K=new Dt($,P),ae=Xe(C);let ue=new Dt(0,0);I&&(ue=new Dt(I[0],I[1])),j._rotateAround(ae,ue),q._rotateAround(ae,ue),Z._rotateAround(ae,ue),K._rotateAround(ae,ue),L=Math.min(j.x,q.x,Z.x,K.x),$=Math.max(j.x,q.x,Z.x,K.x),R=Math.min(j.y,q.y,Z.y,K.y),P=Math.max(j.y,q.y,Z.y,K.y)}return l.emplaceBack(i.x,i.y,i.z,a.x,a.y,L,R,$,P,x,h,f,_),l.length-1}function t2(l){qR(l)&&l.collisionPadding&&(l.top-=l.collisionPadding[1],l.bottom+=l.collisionPadding[3]);const i=l.bottom-l.top;return i>0?Math.max(10,i):null}function PV(l,i,a,h){const f=l.compareText;if(i in f){const _=f[i];for(let y=_.length-1;y>=0;y--)if(h.dist(_[y])<a)return!0}else f[i]=[];return f[i].push(h),!1}function _P(l,i){const a=l.fovAboveCenter,h=l.elevation?l.elevation.getMinElevationBelowMSL()*i:0,f=(l._camera.position[2]*l.worldSize-h)/Math.cos(l._pitch),_=Math.sin(a)*f/Math.sin(Math.max(Math.PI/2-l._pitch-a,.01));let y=Math.sin(l._pitch)*_+f;const x=f*(1/l._horizonShift);if(!l.elevation||l.elevation.exaggeration()===0){let C=Math.max(l.zoom-17,0);l.isOrthographic&&(C/=10),y*=1+C}return Math.min(1.01*y,x)}function bv(l,i){if(!i.isReprojectedInTileSpace)return{scale:1<<l.z,x:l.x,y:l.y,x2:l.x+1,y2:l.y+1,projection:i};const a=Math.pow(2,-l.z),h=l.x*a,f=(l.x+1)*a,_=l.y*a,y=(l.y+1)*a,x=Ae(h),C=Ae(f),I=Ce(_),R=Ce(y),P=i.project(x,I),L=i.project(C,I),$=i.project(C,R),j=i.project(x,R);let q=Math.min(P.x,L.x,$.x,j.x),Z=Math.min(P.y,L.y,$.y,j.y),K=Math.max(P.x,L.x,$.x,j.x),ae=Math.max(P.y,L.y,$.y,j.y);const ue=a/16;function fe(De,Ve,He,Ze,_t,Je){const bt=(He+_t)/2,Mt=(Ze+Je)/2,Tt=i.project(Ae(bt),Ce(Mt)),It=Math.max(0,q-Tt.x,Z-Tt.y,Tt.x-K,Tt.y-ae);q=Math.min(q,Tt.x),K=Math.max(K,Tt.x),Z=Math.min(Z,Tt.y),ae=Math.max(ae,Tt.y),It>ue&&(fe(De,Tt,He,Ze,bt,Mt),fe(Tt,Ve,bt,Mt,_t,Je))}fe(P,L,h,_,f,_),fe(L,$,f,_,f,y),fe($,j,f,y,h,y),fe(j,P,h,y,h,_),q-=ue,Z-=ue,K+=ue,ae+=ue;const Me=1/Math.max(K-q,ae-Z);return{scale:Me,x:q*Me,y:Z*Me,x2:K*Me,y2:ae*Me,projection:i}}function yP(l,{x:i,y:a},h=0){return new Dt(((i-h)*l.scale-l.x)*Ut,(a*l.scale-l.y)*Ut)}const MV=Q(new Float32Array(16));class rp{constructor(i){this.spec=i,this.name=i.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(i,a){return{x:0,y:0,z:0}}unproject(i,a){return new W(0,0)}projectTilePoint(i,a,h){return{x:i,y:a,z:0}}locationPoint(i,a,h,f=!0){return i._coordinatePoint(i.locationCoordinate(a,h),f)}pixelsPerMeter(i,a){return Se(1,i)*a}pixelSpaceConversion(i,a,h){return 1}farthestPixelDistance(i){return _P(i,i.pixelsPerMeter)}pointCoordinate(i,a,h,f){const _=i.horizonLineFromTop(!1),y=new Dt(a,Math.max(_,h));return i.rayIntersectionCoordinate(i.pointRayIntersection(y,f))}pointCoordinate3D(i,a,h){const f=new Dt(a,h);if(i.elevation)return i.elevation.pointCoordinate(f);{const _=this.pointCoordinate(i,f.x,f.y,0);return[_.x,_.y,_.z]}}isPointAboveHorizon(i,a){if(i.elevation&&i.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(i,a.x,a.y);const h=i.horizonLineFromTop();return a.y<h}createInversionMatrix(i,a){return MV}createTileMatrix(i,a,h){let f,_,y;const x=h.canonical,C=Q(new Float64Array(16));if(this.isReprojectedInTileSpace){const I=bv(x,this);f=1,_=I.x+h.wrap*I.scale,y=I.y,ze(C,C,[f/I.scale,f/I.scale,i.pixelsPerMeter/a])}else f=a/i.zoomScale(x.z),_=(x.x+Math.pow(2,x.z)*h.wrap)*f,y=x.y*f;return be(C,C,[_,y,0]),ze(C,C,[f/Ut,f/Ut,1]),C}upVector(i,a,h){return[0,0,1]}upVectorScale(i,a,h){return{metersToTile:1}}}class DV extends rp{constructor(i){super(i),this.range=[4,7],this.center=i.center||[-96,37.5];const[a,h]=this.parallels=i.parallels||[29.5,45.5],f=Math.sin(Xe(a));this.n=(f+Math.sin(Xe(h)))/2,this.c=1+f*(2*this.n-f),this.r0=Math.sqrt(this.c)/this.n}project(i,a){const{n:h,c:f,r0:_}=this,y=Xe(i-this.center[0]),x=Xe(a),C=Math.sqrt(f-2*h*Math.sin(x))/h;return{x:C*Math.sin(y*h),y:C*Math.cos(y*h)-_,z:0}}unproject(i,a){const{n:h,c:f,r0:_}=this,y=_+a;let x=Math.atan2(i,Math.abs(y))*Math.sign(y);y*h<0&&(x-=Math.PI*Math.sign(i)*Math.sign(y));const C=Xe(this.center[0])*h;x=Ge(x,-Math.PI-C,Math.PI-C);const I=Le(Y(x/h)+this.center[0],-180,180),R=Math.asin(Le((f-(i*i+y*y)*h*h)/(2*h),-1,1)),P=Le(Y(R),-ke,ke);return new W(I,P)}}const xv=1.340264,wv=-.081106,Sv=893e-6,Cv=.003796,B1=Math.sqrt(3)/2;class OV extends rp{project(i,a){a=a/180*Math.PI,i=i/180*Math.PI;const h=Math.asin(B1*Math.sin(a)),f=h*h,_=f*f*f;return{x:.5*(i*Math.cos(h)/(B1*(xv+3*wv*f+_*(7*Sv+9*Cv*f)))/Math.PI+.5),y:1-.5*(h*(xv+wv*f+_*(Sv+Cv*f))/Math.PI+1),z:0}}unproject(i,a){i=(2*i-.5)*Math.PI;let h=a=(2*(1-a)-1)*Math.PI,f=h*h,_=f*f*f;for(let R,P,L,$=0;$<12&&(P=h*(xv+wv*f+_*(Sv+Cv*f))-a,L=xv+3*wv*f+_*(7*Sv+9*Cv*f),R=P/L,h=Le(h-R,-Math.PI/3,Math.PI/3),f=h*h,_=f*f*f,!(Math.abs(R)<1e-12));++$);const y=B1*i*(xv+3*wv*f+_*(7*Sv+9*Cv*f))/Math.cos(h),x=Math.asin(Math.sin(h)/B1),C=Le(180*y/Math.PI,-180,180),I=Le(180*x/Math.PI,-ke,ke);return new W(C,I)}}class LV extends rp{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0}project(i,a){return{x:.5+i/360,y:.5-a/360,z:0}}unproject(i,a){const h=360*(i-.5),f=Le(360*(.5-a),-ke,ke);return new W(h,f)}}const y_=Math.PI/2;function F1(l){return Math.tan((y_+l)/2)}class zV extends rp{constructor(i){super(i),this.center=i.center||[0,30];const[a,h]=this.parallels=i.parallels||[30,30];let f=Xe(a),_=Xe(h);this.southernCenter=f+_<0,this.southernCenter&&(f=-f,_=-_);const y=Math.cos(f),x=F1(f);this.n=f===_?Math.sin(f):Math.log(y/Math.cos(_))/Math.log(F1(_)/x),this.f=y*Math.pow(F1(f),this.n)/this.n}project(i,a){a=Xe(a),this.southernCenter&&(a=-a),i=Xe(i-this.center[0]);const h=1e-6,{n:f,f:_}=this;_>0?a<-y_+h&&(a=-y_+h):a>y_-h&&(a=y_-h);const y=_/Math.pow(F1(a),f);let x=y*Math.sin(f*i),C=_-y*Math.cos(f*i);return x=.5*(x/Math.PI+.5),C=.5*(C/Math.PI+.5),{x,y:this.southernCenter?C:1-C,z:0}}unproject(i,a){i=(2*i-.5)*Math.PI,this.southernCenter&&(a=1-a),a=(2*(1-a)-.5)*Math.PI;const{n:h,f}=this,_=f-a,y=Math.sign(_),x=Math.sign(h)*Math.sqrt(i*i+_*_);let C=Math.atan2(i,Math.abs(_))*y;_*h<0&&(C-=Math.PI*Math.sign(i)*y);const I=Le(Y(C/h)+this.center[0],-180,180),R=Le(Y(2*Math.atan(Math.pow(f/x,1/h))-y_),-ke,ke);return new W(I,this.southernCenter?-R:R)}}class vP extends rp{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(i,a){return{x:pe(i),y:Ie(a),z:0}}unproject(i,a){const h=Ae(i),f=Ce(a);return new W(h,f)}}const bP=Xe(ke);class BV extends rp{project(i,a){const h=(a=Xe(a))*a,f=h*h;return{x:.5*((i=Xe(i))*(.8707-.131979*h+f*(f*(.003971*h-.001529*f)-.013791))/Math.PI+.5),y:1-.5*(a*(1.007226+h*(.015085+f*(.028874*h-.044475-.005916*f)))/Math.PI+1),z:0}}unproject(i,a){i=(2*i-.5)*Math.PI;let h=a=(2*(1-a)-1)*Math.PI,f=25,_=0,y=h*h;do{y=h*h;const I=y*y;_=(h*(1.007226+y*(.015085+I*(.028874*y-.044475-.005916*I)))-a)/(1.007226+y*(.045255+I*(.259866*y-.311325-.005916*11*I))),h=Le(h-_,-bP,bP)}while(Math.abs(_)>1e-6&&--f>0);y=h*h;const x=Le(Y(i/(.8707+y*(y*(y*y*y*(.003971-.001529*y)-.013791)-.131979))),-180,180),C=Y(h);return new W(x,C)}}const xP=Xe(ke);class FV extends rp{project(i,a){a=Xe(a),i=Xe(i);const h=Math.cos(a),f=2/Math.PI,_=Math.acos(h*Math.cos(i/2)),y=Math.sin(_)/_,x=.5*(i*f+2*h*Math.sin(i/2)/y)||0,C=.5*(a+Math.sin(a)/y)||0;return{x:.5*(x/Math.PI+.5),y:1-.5*(C/Math.PI+1),z:0}}unproject(i,a){let h=i=(2*i-.5)*Math.PI,f=a=(2*(1-a)-1)*Math.PI,_=25;const y=1e-6;let x=0,C=0;do{const I=Math.cos(f),R=Math.sin(f),P=2*R*I,L=R*R,$=I*I,j=Math.cos(h/2),q=Math.sin(h/2),Z=2*j*q,K=q*q,ae=1-$*j*j,ue=ae?1/ae:0,fe=ae?Math.acos(I*j)*Math.sqrt(1/ae):0,Me=.5*(2*fe*I*q+2*h/Math.PI)-i,De=.5*(fe*R+f)-a,Ve=.5*ue*($*K+fe*I*j*L)+1/Math.PI,He=ue*(Z*P/4-fe*R*q),Ze=.125*ue*(P*q-fe*R*$*Z),_t=.5*ue*(L*j+fe*K*I)+.5,Je=He*Ze-_t*Ve;x=(De*He-Me*_t)/Je,C=(Me*Ze-De*Ve)/Je,h=Le(h-x,-Math.PI,Math.PI),f=Le(f-C,-xP,xP)}while((Math.abs(x)>y||Math.abs(C)>y)&&--_>0);return new W(Y(h),Y(f))}}class wP extends rp{constructor(i){super(i),this.center=i.center||[0,0],this.parallels=i.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Xe(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(i,a){const{scale:h,cosPhi:f}=this;return{x:Xe(i)*f*h+.5,y:-Math.sin(Xe(a))/f*h+.5,z:0}}unproject(i,a){const{scale:h,cosPhi:f}=this,_=-(a-.5)/h,y=Le(Y((i-.5)/h)/f,-180,180),x=Math.asin(Le(_*f,-1,1)),C=Le(Y(x),-ke,ke);return new W(y,C)}}class NV extends vP{constructor(i){super(i),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(i,a,h){const f=Ky(i,a,h);return kn(f,f,f1(Fd(h))),{x:f[0],y:f[1],z:f[2]}}locationPoint(i,a,h){const f=F(a.lat,a.lng),_=ai([],f),y=h?i._centerAltitude+h:i.elevation?i.elevation.getAtPointOrZero(i.locationCoordinate(a),i._centerAltitude):i._centerAltitude;Di(f,f,_,Se(1,0)*Ut*y);const x=Q(new Float64Array(16));return ce(x,i.pixelMatrix,i.globeMatrix),kn(f,f,x),new Dt(f[0],f[1])}pixelsPerMeter(i,a){return Se(1,0)*a}pixelSpaceConversion(i,a,h){const f=Se(1,i)*a,_=Pn(Se(1,45)*a,f,h);return this.pixelsPerMeter(i,a)/_}createTileMatrix(i,a,h){const f=cC(Fd(h.canonical));return ce(new Float64Array(16),i.globeMatrix,f)}createInversionMatrix(i,a){const{center:h}=i,f=f1(Fd(a));return je(f,f,Xe(h.lng)),xe(f,f,Xe(h.lat)),ze(f,f,[i._pixelsPerMercatorPixel,i._pixelsPerMercatorPixel,1]),Float32Array.from(f)}pointCoordinate(i,a,h,f){return WA(i,a,h,!0)||new ut(0,0)}pointCoordinate3D(i,a,h){const f=this.pointCoordinate(i,a,h,0);return[f.x,f.y,f.z]}isPointAboveHorizon(i,a){return!WA(i,a.x,a.y,!1)}farthestPixelDistance(i){const a=function(f,_){const y=f.cameraToCenterDistance,x=f._centerAltitude*_,C=f._camera,I=f._camera.forward(),R=on([],Pt([],I,-y),[0,0,x]),P=f.worldSize/(2*Math.PI),L=[0,0,-P],$=f.width/f.height,j=Math.tan(f.fovAboveCenter),q=Pt([],C.up(),j),Z=Pt([],C.right(),j*$),K=ai([],on([],on([],I,q),Z)),ae=[];let ue;if(new qi(R,K).closestPointOnSphere(L,P,ae)){const fe=on([],ae,L),Me=Gt([],fe,R);ue=Math.cos(f.fovAboveCenter)*Re(Me)}else{const fe=Gt([],R,L),Me=Gt([],L,R);ai(Me,Me);const De=Re(fe)-P;ue=Math.sqrt(De*(De+2*P));const Ve=Math.acos(ue/(P+De))-Math.acos(Ft(I,Me));ue*=Math.cos(Ve)}return 1.01*ue}(i,this.pixelsPerMeter(i.center.lat,i.worldSize)),h=Jf(i.zoom);if(h>0){const f=_P(i,Se(1,i.center.lat)*i.worldSize),_=i.worldSize/(2*Math.PI),y=Math.max(i.width,i.height)/i.worldSize*Math.PI;return Pn(a,f+_*(1-Math.cos(y)),Math.pow(h,10))}return a}upVector(i,a,h){return Ky(a,h,i,1)}upVectorScale(i){return{metersToTile:u1(h1(Fd(i)))}}}function SP(l){const i=l.parallels,a=!!i&&Math.abs(i[0]+i[1])<.01;switch(l.name){case"mercator":return new vP(l);case"equirectangular":return new LV(l);case"naturalEarth":return new BV(l);case"equalEarth":return new OV(l);case"winkelTripel":return new FV(l);case"albers":return a?new wP(l):new DV(l);case"lambertConformalConic":return a?new wP(l):new zV(l);case"globe":return new NV(l)}throw new Error(`Invalid projection name: ${l.name}`)}const VV=Rt.types,$V=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function N1(l,i,a,h,f,_,y,x,C,I,R,P,L){const $=x?Math.min(ip,Math.round(x[0])):0,j=x?Math.min(ip,Math.round(x[1])):0;l.emplaceBack(i,a,Math.round(32*h),Math.round(32*f),_,y,($<<1)+(C?1:0),j,16*I,16*R,256*P,256*L)}function V1(l,i,a){l.emplaceBack(i,a)}function $1(l,i,a,h,f,_,y){l.emplaceBack(i,a,h,f,_,y)}const j1=(l,i,a,h)=>{for(let f=0;f<i;f++)l.emplaceBack(a[0],a[1],a[2],h[0],h[1],h[2])};function U1(l,i,a,h,f){l.emplaceBack(i,a,h,f),l.emplaceBack(i,a,h,f),l.emplaceBack(i,a,h,f),l.emplaceBack(i,a,h,f)}function jV(l){for(const i of l.sections)if(My(i.text))return!0;return!1}class n2{constructor(i){this.layoutVertexArray=new Fy,this.indexArray=new bs,this.programConfigurations=i,this.segments=new ro,this.dynamicLayoutVertexArray=new Ec,this.opacityVertexArray=new Wf,this.placedSymbolArray=new n_,this.iconTransitioningVertexArray=new hs,this.globeExtVertexArray=new Ny,this.zOffsetVertexArray=new Dd,this.orientationVertexArray=new _m}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(i,a,h,f,_){this.isEmpty()||(h&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,q9.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,K9.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,$V,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=i.createVertexBuffer(this.iconTransitioningVertexArray,J9.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,Z9.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||_)&&(this.zOffsetVertexBuffer=i.createVertexBuffer(this.zOffsetVertexArray,X9.members,!0)),!this.orientationVertexBuffer&&this.orientationVertexArray&&this.orientationVertexArray.length>0&&(this.orientationVertexBuffer=i.createVertexBuffer(this.orientationVertexArray,Y9.members,!0)),this.opacityVertexBuffer.itemSize=1),(h||f)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.orientationVertexBuffer&&this.orientationVertexBuffer.destroy())}}en(n2,"SymbolBuffers");class i2{constructor(i,a,h){this.layoutVertexArray=new i,this.layoutAttributes=a,this.indexArray=new h,this.segments=new ro,this.collisionVertexArray=new $y,this.collisionVertexArrayExt=new Ec}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,Q9.members,!0),this.collisionVertexBufferExt=i.createVertexBuffer(this.collisionVertexArrayExt,eV.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}en(i2,"CollisionBuffers");class H1{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(y=>y.fqid),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Q([]),this.placementViewportMatrix=Q([]);const a=this.layers[0]._unevaluatedLayout._values;this.worldview=i.worldview,this.textSizeData=JR(this.zoom,a["text-size"],this.worldview),this.iconSizeData=JR(this.zoom,a["icon-size"],this.worldview);const h=this.layers[0].layout,f=h.get("symbol-sort-key"),_=h.get("symbol-z-order");this.lut=i.lut,this.canOverlap=h.get("text-allow-overlap")||h.get("icon-allow-overlap")||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&f.constantOr(1)!==void 0,this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=h.get("text-writing-mode").map(y=>zl[y]),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=i.sourceID,this.projection=i.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.hasAnySecondaryIcon=!1}createArrays(){this.text=new n2(new Ic(this.layers,{zoom:this.zoom,lut:this.lut},i=>i.startsWith("text")||i.startsWith("symbol"))),this.icon=new n2(new Ic(this.layers,{zoom:this.zoom,lut:this.lut},i=>i.startsWith("icon")||i.startsWith("symbol"))),this.glyphOffsetArray=new t1,this.lineVertexArray=new n1,this.symbolInstances=new e1}calculateGlyphDependencies(i,a,h,f,_){for(const y of i){const x=y.codePointAt(0);if(x===void 0)break;if(a[x]=!0,f&&_&&x<=65535){const C=pv[y];C&&(a[C.charCodeAt(0)]=!0)}}}updateFootprints(i,a){}updateReplacement(i,a){if(a.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=a.updateTime;const h=a.getReplacementRegionsForTile(i.toUnwrapped(),!0);return!v1(this.activeReplacements,h)&&(this.activeReplacements=h,!0)}populate(i,a,h,f){const _=this.layers[0],y=_.layout,x=this.projection.name==="globe",C=y.get("text-font"),I=y.get("text-field"),R=y.get("icon-image"),[P,L]=y.get("icon-size-scale-range"),$=Le(a.scaleFactor||1,P,L),j=(I.value.kind!=="constant"||I.value.value instanceof Co&&!I.value.value.isEmpty()||I.value.value.toString().length>0)&&(C.value.kind!=="constant"||C.value.value.length>0),q=R.value.kind!=="constant"||!!R.value.value||Object.keys(R.parameters).length>0,Z=y.get("symbol-sort-key");if(this.features=[],!j&&!q)return;const K=a.iconDependencies,ae=a.glyphDependencies,ue=a.availableImages,fe=new Tr(this.zoom,{worldview:this.worldview});for(const{feature:Me,id:De,index:Ve,sourceLayerIndex:He}of i){const Ze=_._featureFilter.needGeometry,_t=Lt(Me,Ze);if(!_._featureFilter.filter(fe,_t,h))continue;if(Ze||(_t.geometry=rn(Me,h,f)),x&&Me.type!==1&&h.z<=5){const It=_t.geometry,zt=.98078528056,mt=(At,ct)=>Ft(Ky(At.x,At.y,h,1),Ky(ct.x,ct.y,h,1))<zt;for(let At=0;At<It.length;At++)It[At]=pt(It[At],mt)}let Je,bt;if(j){const It=_.getValueAndResolveTokens("text-field",_t,h,ue),zt=Co.factory(It);jV(zt)&&(this.hasRTLText=!0),(!this.hasRTLText||wh()==="unavailable"||this.hasRTLText&&Pl.isParsed())&&(Je=nV(zt,_,_t))}if(q){const It=_.getValueAndResolveTokens("icon-image",_t,h,ue);bt=typeof It=="string"?ks.build(It):It}if(!Je&&!bt)continue;const Mt=this.sortFeaturesByKey?Z.evaluate(_t,{},h):void 0,Tt={id:De,text:Je,icon:bt,index:Ve,sourceLayerIndex:He,geometry:_t.geometry,properties:Me.properties,type:VV[Me.type],sortKey:Mt};if(this.features.push(Tt),bt){const It=this.layers[0]._unevaluatedLayout._values,{iconPrimary:zt,iconSecondary:mt}=fP(bt,this.iconSizeData,It["icon-size"],h,this.zoom,Tt,this.pixelRatio,$,this.worldview),At=zt.id.toString();if(K.has(At)?K.get(At).push(zt):K.set(At,[zt]),mt){this.hasAnySecondaryIcon=!0;const ct=mt.id.toString();K.has(ct)?K.get(ct).push(mt):K.set(ct,[mt])}}if(Je){const It=C.evaluate(_t,{},h).join(","),zt=y.get("text-rotation-alignment")==="map"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(zl.vertical)>=0;for(const mt of Je.sections)if(mt.image){const At=mt.image.getPrimary().scaleSelf(this.pixelRatio),ct=At.id.toString(),rt=K.get(ct)||[];rt.push(At),K.set(ct,rt)}else{const At=um(Je.toString()),ct=mt.fontStack||It,rt=ae[ct]=ae[ct]||{};this.calculateGlyphDependencies(mt.text,rt,zt,this.allowVerticalPlacement,At)}}}if(y.get("symbol-placement")==="line"&&(this.features=function(Me){const De={},Ve={},He=[];let Ze=0;function _t(Tt){He.push(Me[Tt]),Ze++}function Je(Tt,It,zt){const mt=Ve[Tt];return delete Ve[Tt],Ve[It]=mt,He[mt].geometry[0].pop(),He[mt].geometry[0]=He[mt].geometry[0].concat(zt[0]),mt}function bt(Tt,It,zt){const mt=De[It];return delete De[It],De[Tt]=mt,He[mt].geometry[0].shift(),He[mt].geometry[0]=zt[0].concat(He[mt].geometry[0]),mt}function Mt(Tt,It,zt){const mt=zt?It[0][It[0].length-1]:It[0][0];return`${Tt}:${mt.x}:${mt.y}`}for(let Tt=0;Tt<Me.length;Tt++){const It=Me[Tt],zt=It.geometry,mt=It.text?It.text.toString():null;if(!mt){_t(Tt);continue}const At=Mt(mt,zt),ct=Mt(mt,zt,!0);if(At in Ve&&ct in De&&Ve[At]!==De[ct]){const rt=bt(At,ct,zt),Bt=Je(At,ct,He[rt].geometry);delete De[At],delete Ve[ct],Ve[Mt(mt,He[Bt].geometry,!0)]=Bt,He[rt].geometry=null}else At in Ve?Je(At,ct,zt):ct in De?bt(At,ct,zt):(_t(Tt),De[At]=Ze-1,Ve[ct]=Ze-1)}return He.filter(Tt=>Tt.geometry)}(this.features)),y.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",a.elevationFeatures){!this.elevationFeatures&&a.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(const Me of a.elevationFeatures)this.elevationFeatureIdToIndex.set(Me.id,this.elevationFeatures.length),this.elevationFeatures.push(Me)}}else y.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort((Me,De)=>Me.sortKey-De.sortKey)}update(i,a,h,f,_,y,x){this.text.programConfigurations.updatePaintArrays(i,a,_,h,f,y,x,this.worldview),this.icon.programConfigurations.updatePaintArrays(i,a,_,h,f,y,x,this.worldview)}updateRoadElevation(i){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let a=!1;const h=et(i),f=1/h;let _=!1,y=!1;for(let x=0;x<this.symbolInstances.length;x++){const C=this.symbolInstances.get(x),I=tn(1,0,0),R=tn(0,1,0),{numHorizontalGlyphVertices:P,numVerticalGlyphVertices:L,numIconVertices:$,numVerticalIconVertices:j}=C,q=P>0||L>0,Z=$>0,K=this.elevationFeatures[C.elevationFeatureIndex];if(K){const ae=new Dt(C.tileAnchorX,C.tileAnchorY),ue=.075+K.pointElevation(ae);C.zOffset!==ue&&(a=!0,C.zOffset=ue);const fe=K.computeSlopeNormal(ae,f),Me=Io(pi(),tn(0,0,1),fe);Qe(I,I,Me),Qe(R,R,Me),I[2]*=h,R[2]*=h,I[0]===1&&I[1]===0&&I[2]===0&&R[0]===0&&R[1]===1&&R[2]===0||(_=_||q,y=y||Z)}if(q&&(j1(this.text.orientationVertexArray,P,I,R),j1(this.text.orientationVertexArray,L,I,R)),Z){const{placedIconSymbolIndex:ae,verticalPlacedIconSymbolIndex:ue}=C;ae>=0&&j1(this.icon.orientationVertexArray,$,I,R),ue>=0&&j1(this.icon.orientationVertexArray,j,I,R)}}_||(this.text.orientationVertexArray=void 0),y||(this.icon.orientationVertexArray=void 0),a&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){const i=(_,y,x)=>{h+=y,h>_.length&&_.resize(h);for(let C=-y;C<0;C++)_.emplace(C+h,x)},a=(_,y,x)=>{f+=y,f>_.length&&_.resize(f);for(let C=-y;C<0;C++)_.emplace(C+f,x)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let h=0,f=0;for(let _=0;_<this.symbolInstances.length;_++){const y=this.symbolInstances.get(_),{numHorizontalGlyphVertices:x,numVerticalGlyphVertices:C,numIconVertices:I}=y,R=y.zOffset,P=I>0;if((x>0||C>0)&&(i(this.text.zOffsetVertexArray,x,R),i(this.text.zOffsetVertexArray,C,R)),P){const{placedIconSymbolIndex:L,verticalPlacedIconSymbolIndex:$}=y;L>=0&&a(this.icon.zOffsetVertexArray,I,R),$>=0&&a(this.icon.zOffsetVertexArray,y.numVerticalIconVertices,R)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=SP(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,a){const h=this.lineVertexArray.length;if(i.segment!==void 0)for(const{x:f,y:_}of a)this.lineVertexArray.emplaceBack(f,_);return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(i,a,h,f,_,y,x,C,I,R,P,L,$,j,q,Z){const K=i.indexArray,ae=i.layoutVertexArray,ue=i.globeExtVertexArray,fe=i.segments.prepareSegment(4*a.length,ae,K,this.canOverlap?y.sortKey:void 0),Me=this.glyphOffsetArray.length,De=fe.vertexLength,Ve=this.allowVerticalPlacement&&x===zl.vertical?Math.PI/2:0,He=y.text&&y.text.sections;for(let _t=0;_t<a.length;_t++){const{tl:Je,tr:bt,bl:Mt,br:Tt,texPrimary:It,texSecondary:zt,pixelOffsetTL:mt,pixelOffsetBR:At,minFontScaleX:ct,minFontScaleY:rt,glyphOffset:Bt,isSDF:Ot,sectionIndex:En}=a[_t],ln=fe.vertexLength,pn=Bt[1];if(N1(ae,I.x,I.y,Je.x,pn+Je.y,It.x,It.y,h,Ot,mt.x,mt.y,ct,rt),N1(ae,I.x,I.y,bt.x,pn+bt.y,It.x+It.w,It.y,h,Ot,At.x,mt.y,ct,rt),N1(ae,I.x,I.y,Mt.x,pn+Mt.y,It.x,It.y+It.h,h,Ot,mt.x,At.y,ct,rt),N1(ae,I.x,I.y,Tt.x,pn+Tt.y,It.x+It.w,It.y+It.h,h,Ot,At.x,At.y,ct,rt),C){const{x:Ht,y:Tn,z:qn}=C.anchor,[Jt,vn,Fn]=C.up;$1(ue,Ht,Tn,qn,Jt,vn,Fn),$1(ue,Ht,Tn,qn,Jt,vn,Fn),$1(ue,Ht,Tn,qn,Jt,vn,Fn),$1(ue,Ht,Tn,qn,Jt,vn,Fn),U1(i.dynamicLayoutVertexArray,Ht,Tn,qn,Ve)}else U1(i.dynamicLayoutVertexArray,I.x,I.y,I.z,Ve);if(Z){const Ht=zt||It;V1(i.iconTransitioningVertexArray,Ht.x,Ht.y),V1(i.iconTransitioningVertexArray,Ht.x+Ht.w,Ht.y),V1(i.iconTransitioningVertexArray,Ht.x,Ht.y+Ht.h),V1(i.iconTransitioningVertexArray,Ht.x+Ht.w,Ht.y+Ht.h)}K.emplaceBack(ln,ln+1,ln+2),K.emplaceBack(ln+1,ln+2,ln+3),fe.vertexLength+=4,fe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Bt[0]),_t!==a.length-1&&En===a[_t+1].sectionIndex||i.programConfigurations.populatePaintArrays(ae.length,y,y.index,{},$,j,q,He&&He[En],this.worldview)}const Ze=C?C.anchor:I;i.placedSymbolArray.emplaceBack(Ze.x,Ze.y,Ze.z,I.x,I.y,Me,this.glyphOffsetArray.length-Me,De,R,P,I.segment,h?h[0]:0,h?h[1]:0,f[0],f[1],x,0,0,0,L,0)}_commitLayoutVertex(i,a,h,f,_,y,x){i.emplaceBack(a,h,f,_,y,Math.round(x.x),Math.round(x.y))}_addCollisionDebugVertices(i,a,h,f,_,y,x){const C=h.segments.prepareSegment(4,h.layoutVertexArray,h.indexArray),I=C.vertexLength,R=x.tileAnchorX,P=x.tileAnchorY;for(let $=0;$<4;$++)h.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(h.collisionVertexArrayExt,a,i.padding,x.zOffset),this._commitLayoutVertex(h.layoutVertexArray,f,_,y,R,P,new Dt(i.x1,i.y1)),this._commitLayoutVertex(h.layoutVertexArray,f,_,y,R,P,new Dt(i.x2,i.y1)),this._commitLayoutVertex(h.layoutVertexArray,f,_,y,R,P,new Dt(i.x2,i.y2)),this._commitLayoutVertex(h.layoutVertexArray,f,_,y,R,P,new Dt(i.x1,i.y2)),C.vertexLength+=4;const L=h.indexArray;L.emplaceBack(I,I+1),L.emplaceBack(I+1,I+2),L.emplaceBack(I+2,I+3),L.emplaceBack(I+3,I),C.primitiveLength+=4}_addTextDebugCollisionBoxes(i,a,h,f,_,y){for(let x=f;x<_;x++){const C=h.get(x),I=this.getSymbolInstanceTextSize(i,y,a,x);this._addCollisionDebugVertices(C,I,this.textCollisionBox,C.projectedAnchorX,C.projectedAnchorY,C.projectedAnchorZ,y)}}_addIconDebugCollisionBoxes(i,a,h,f,_,y){for(let x=f;x<_;x++){const C=h.get(x),I=this.getSymbolInstanceIconSize(i,a,y.placedIconSymbolIndex);this._addCollisionDebugVertices(C,I,this.iconCollisionBox,C.projectedAnchorX,C.projectedAnchorY,C.projectedAnchorZ,y)}}generateCollisionDebugBuffers(i,a,h){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new i2(Yg,BR.members,hs),this.iconCollisionBox=new i2(Yg,BR.members,hs);const f=gv(this.iconSizeData,i),_=gv(this.textSizeData,i,h);for(let y=0;y<this.symbolInstances.length;y++){const x=this.symbolInstances.get(y);this._addTextDebugCollisionBoxes(_,i,a,x.textBoxStartIndex,x.textBoxEndIndex,x),this._addTextDebugCollisionBoxes(_,i,a,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._addIconDebugCollisionBoxes(f,i,a,x.iconBoxStartIndex,x.iconBoxEndIndex,x),this._addIconDebugCollisionBoxes(f,i,a,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x)}}getSymbolInstanceTextSize(i,a,h,f){const _=this.text.placedSymbolArray.get(a.rightJustifiedTextSymbolIndex>=0?a.rightJustifiedTextSymbolIndex:a.centerJustifiedTextSymbolIndex>=0?a.centerJustifiedTextSymbolIndex:a.leftJustifiedTextSymbolIndex>=0?a.leftJustifiedTextSymbolIndex:a.verticalPlacedTextSymbolIndex>=0?a.verticalPlacedTextSymbolIndex:f),y=KC(this.textSizeData,i,_)/Qs;return this.tilePixelRatio*y}getSymbolInstanceIconSize(i,a,h){const f=this.icon.placedSymbolArray.get(h),_=KC(this.iconSizeData,i,f);return this.tilePixelRatio*_}_commitDebugCollisionVertexUpdate(i,a,h,f){i.emplaceBack(a,-h,-h,f),i.emplaceBack(a,h,-h,f),i.emplaceBack(a,h,h,f),i.emplaceBack(a,-h,h,f)}_updateTextDebugCollisionBoxes(i,a,h,f,_,y,x){for(let C=f;C<_;C++){const I=h.get(C),R=this.getSymbolInstanceTextSize(i,y,a,C);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,R,I.padding,y.zOffset)}}_updateIconDebugCollisionBoxes(i,a,h,f,_,y,x){for(let C=f;C<_;C++){const I=h.get(C),R=this.getSymbolInstanceIconSize(i,a,y.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,R,I.padding,y.zOffset)}}updateCollisionDebugBuffers(i,a,h,f){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const _=gv(this.iconSizeData,i,f),y=gv(this.textSizeData,i,h);for(let x=0;x<this.symbolInstances.length;x++){const C=this.symbolInstances.get(x);this._updateTextDebugCollisionBoxes(y,i,a,C.textBoxStartIndex,C.textBoxEndIndex,C,h),this._updateTextDebugCollisionBoxes(y,i,a,C.verticalTextBoxStartIndex,C.verticalTextBoxEndIndex,C,h),this._updateIconDebugCollisionBoxes(_,i,a,C.iconBoxStartIndex,C.iconBoxEndIndex,C,f),this._updateIconDebugCollisionBoxes(_,i,a,C.verticalIconBoxStartIndex,C.verticalIconBoxEndIndex,C,f)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(i,a,h,f,_,y,x,C,I){const R={};if(a<h){const{x1:P,y1:L,x2:$,y2:j,padding:q,projectedAnchorX:Z,projectedAnchorY:K,projectedAnchorZ:ae,tileAnchorX:ue,tileAnchorY:fe,featureIndex:Me}=i.get(a);R.textBox={x1:P,y1:L,x2:$,y2:j,padding:q,projectedAnchorX:Z,projectedAnchorY:K,projectedAnchorZ:ae,tileAnchorX:ue,tileAnchorY:fe},R.textFeatureIndex=Me}if(f<_){const{x1:P,y1:L,x2:$,y2:j,padding:q,projectedAnchorX:Z,projectedAnchorY:K,projectedAnchorZ:ae,tileAnchorX:ue,tileAnchorY:fe,featureIndex:Me}=i.get(f);R.verticalTextBox={x1:P,y1:L,x2:$,y2:j,padding:q,projectedAnchorX:Z,projectedAnchorY:K,projectedAnchorZ:ae,tileAnchorX:ue,tileAnchorY:fe},R.verticalTextFeatureIndex=Me}if(y<x){const{x1:P,y1:L,x2:$,y2:j,padding:q,projectedAnchorX:Z,projectedAnchorY:K,projectedAnchorZ:ae,tileAnchorX:ue,tileAnchorY:fe,featureIndex:Me}=i.get(y);R.iconBox={x1:P,y1:L,x2:$,y2:j,padding:q,projectedAnchorX:Z,projectedAnchorY:K,projectedAnchorZ:ae,tileAnchorX:ue,tileAnchorY:fe},R.iconFeatureIndex=Me}if(C<I){const{x1:P,y1:L,x2:$,y2:j,padding:q,projectedAnchorX:Z,projectedAnchorY:K,projectedAnchorZ:ae,tileAnchorX:ue,tileAnchorY:fe,featureIndex:Me}=i.get(C);R.verticalIconBox={x1:P,y1:L,x2:$,y2:j,padding:q,projectedAnchorX:Z,projectedAnchorY:K,projectedAnchorZ:ae,tileAnchorX:ue,tileAnchorY:fe},R.verticalIconFeatureIndex=Me}return R}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const h=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(i,a){const h=i.placedSymbolArray.get(a),f=h.vertexStartIndex+4*h.numGlyphs;for(let _=h.vertexStartIndex;_<f;_+=4)i.indexArray.emplaceBack(_,_+1,_+2),i.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(i),h=Math.cos(i),f=[],_=[],y=[];for(let x=0;x<this.symbolInstances.length;++x){y.push(x);const C=this.symbolInstances.get(x);f.push(0|Math.round(a*C.tileAnchorX+h*C.tileAnchorY)),_.push(C.featureIndex)}return y.sort((x,C)=>f[x]-f[C]||_[C]-_[x]),y}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let i=0;i<this.symbolInstances.length;++i)this.symbolInstanceIndexesSortedZOffset.push(i)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((i,a)=>this.symbolInstances.get(a).zOffset-this.symbolInstances.get(i).zOffset)}addToSortKeyRanges(i,a){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===a?h.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const h=this.symbolInstances.get(a);this.featureSortOrder.push(h.featureIndex);const{rightJustifiedTextSymbolIndex:f,centerJustifiedTextSymbolIndex:_,leftJustifiedTextSymbolIndex:y,verticalPlacedTextSymbolIndex:x,placedIconSymbolIndex:C,verticalPlacedIconSymbolIndex:I}=h;f>=0&&this.addIndicesForPlacedSymbol(this.text,f),_>=0&&_!==f&&this.addIndicesForPlacedSymbol(this.text,_),y>=0&&y!==_&&y!==f&&this.addIndicesForPlacedSymbol(this.text,y),x>=0&&this.addIndicesForPlacedSymbol(this.text,x),C>=0&&this.addIndicesForPlacedSymbol(this.icon,C),I>=0&&this.addIndicesForPlacedSymbol(this.icon,I)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let CP,TP,r2;en(H1,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),H1.addDynamicAttributes=U1;class EP{constructor(i){this.type=i.property.overrides?i.property.overrides.runtimeType:ja,this.defaultValue=i}evaluate(i){if(i.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(i.formattedSection))return a.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}en(EP,"FormatSectionOverride",{omit:["defaultValue"]});const o2=()=>r2||(r2={layout:CP||(CP=new _o({"symbol-placement":new Vt(Ye.layout_symbol["symbol-placement"]),"symbol-spacing":new Vt(Ye.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Vt(Ye.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new nn(Ye.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Vt(Ye.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Vt(Ye.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new Vt(Ye.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new Vt(Ye.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Vt(Ye.layout_symbol["icon-ignore-placement"]),"icon-optional":new Vt(Ye.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Vt(Ye.layout_symbol["icon-rotation-alignment"]),"icon-size":new nn(Ye.layout_symbol["icon-size"]),"icon-size-scale-range":new Vt(Ye.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new nn(Ye.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new nn(Ye.layout_symbol["icon-text-fit-padding"]),"icon-image":new nn(Ye.layout_symbol["icon-image"]),"icon-image-use-theme":new Vt({type:"string",default:"default","property-type":"data-constant"}),"icon-rotate":new nn(Ye.layout_symbol["icon-rotate"]),"icon-padding":new Vt(Ye.layout_symbol["icon-padding"]),"icon-keep-upright":new Vt(Ye.layout_symbol["icon-keep-upright"]),"icon-offset":new nn(Ye.layout_symbol["icon-offset"]),"icon-anchor":new nn(Ye.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Vt(Ye.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Vt(Ye.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Vt(Ye.layout_symbol["text-rotation-alignment"]),"text-field":new nn(Ye.layout_symbol["text-field"]),"text-font":new nn(Ye.layout_symbol["text-font"]),"text-size":new nn(Ye.layout_symbol["text-size"]),"text-size-scale-range":new Vt(Ye.layout_symbol["text-size-scale-range"]),"text-max-width":new nn(Ye.layout_symbol["text-max-width"]),"text-line-height":new nn(Ye.layout_symbol["text-line-height"]),"text-letter-spacing":new nn(Ye.layout_symbol["text-letter-spacing"]),"text-justify":new nn(Ye.layout_symbol["text-justify"]),"text-radial-offset":new nn(Ye.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Vt(Ye.layout_symbol["text-variable-anchor"]),"text-anchor":new nn(Ye.layout_symbol["text-anchor"]),"text-max-angle":new Vt(Ye.layout_symbol["text-max-angle"]),"text-writing-mode":new Vt(Ye.layout_symbol["text-writing-mode"]),"text-rotate":new nn(Ye.layout_symbol["text-rotate"]),"text-padding":new Vt(Ye.layout_symbol["text-padding"]),"text-keep-upright":new Vt(Ye.layout_symbol["text-keep-upright"]),"text-transform":new nn(Ye.layout_symbol["text-transform"]),"text-offset":new nn(Ye.layout_symbol["text-offset"]),"text-allow-overlap":new Vt(Ye.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Vt(Ye.layout_symbol["text-ignore-placement"]),"text-optional":new Vt(Ye.layout_symbol["text-optional"]),visibility:new Vt(Ye.layout_symbol.visibility)})),paint:TP||(TP=new _o({"icon-opacity":new nn(Ye.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new nn(Ye.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new nn(Ye.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new nn(Ye.paint_symbol["text-emissive-strength"]),"icon-color":new nn(Ye.paint_symbol["icon-color"]),"icon-halo-color":new nn(Ye.paint_symbol["icon-halo-color"]),"icon-halo-width":new nn(Ye.paint_symbol["icon-halo-width"]),"icon-halo-blur":new nn(Ye.paint_symbol["icon-halo-blur"]),"icon-translate":new Vt(Ye.paint_symbol["icon-translate"]),"icon-translate-anchor":new Vt(Ye.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Vt(Ye.paint_symbol["icon-image-cross-fade"]),"text-opacity":new nn(Ye.paint_symbol["text-opacity"]),"text-occlusion-opacity":new nn(Ye.paint_symbol["text-occlusion-opacity"]),"text-color":new nn(Ye.paint_symbol["text-color"],{runtimeType:Ys,getOverride:l=>l.textColor,hasOverride:l=>!!l.textColor}),"text-halo-color":new nn(Ye.paint_symbol["text-halo-color"]),"text-halo-width":new nn(Ye.paint_symbol["text-halo-width"]),"text-halo-blur":new nn(Ye.paint_symbol["text-halo-blur"]),"text-translate":new Vt(Ye.paint_symbol["text-translate"]),"text-translate-anchor":new Vt(Ye.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Vt(Ye.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Vt(Ye.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Vt(Ye.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Vt(Ye.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new nn(Ye.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},r2);class G1 extends ba{constructor(i,a,h,f){super(i,o2(),a,h,f,i.layout?i.layout["icon-image-use-theme"]:null),this._colorAdjustmentMatrix=Q([]),this.hasOcclusionOpacityProperties=i.paint!==void 0&&("icon-occlusion-opacity"in i.paint||"text-occlusion-opacity"in i.paint)}_handleSpecialPaintPropertyUpdate(i){i!=="icon-occlusion-opacity"&&i!=="text-occlusion-opacity"||(this.hasOcclusionOpacityProperties=!0)}recalculate(i,a){super.recalculate(i,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const h=this.layout.get("text-writing-mode");if(h){const f=[];for(const _ of h)f.indexOf(_)<0&&f.push(_);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(i,a,h,f){return this._saturation===i&&this._contrast===a&&this._brightnessMin===h&&this._brightnessMax===f||(this._colorAdjustmentMatrix=function(_,y,x,C){_=ta(_),y=Ts(y);const I=ee(),R=_/3,P=1-2*R,L=[P,R,R,0,R,P,R,0,R,R,P,0,0,0,0,1],$=.5-.5*y,j=C-x;return ce(I,[j,0,0,0,0,j,0,0,0,0,j,0,x,x,x,1],[y,0,0,0,0,y,0,0,0,0,y,0,$,$,$,1]),ce(I,I,L),I}(i,a,h,f),this._saturation=i,this._contrast=a,this._brightnessMin=h,this._brightnessMax=f),this._colorAdjustmentMatrix}getValueAndResolveTokens(i,a,h,f){const _=this.layout.get(i).evaluate(a,{},h,f),y=this._unevaluatedLayout._values[i];return y.isDataDriven()||va(y.value)||!_?_:function(x,C){return C.replace(/{([^{}]+)}/g,(I,R)=>R in x?String(x[R]):"")}(a.properties,_)}createBucket(i){return new H1(i)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const i of o2().paint.overridableProperties){if(!G1.hasPaintOverride(this.layout,i))continue;const a=this.paint.get(i),h=new EP(a),f=new Qo(h,a.property.specification,this.scope,this.options,this.layout.get("icon-image-use-theme"));let _=null;_=a.value.kind==="constant"||a.value.kind==="source"?new js("source",f):new Us("composite",f,a.value.zoomStops,a.value.interpolationType),this.paint._values[i]=new Th(a.property,_,a.parameters)}}_handleOverridablePaintPropertyUpdate(i,a,h){return!(!this.layout||a.isDataDriven()||h.isDataDriven())&&G1.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,a){const h=i.get("text-field"),f=o2().paint.properties[a];let _=!1;const y=x=>{for(const C of x)if(f.overrides&&f.overrides.hasOverride(C))return void(_=!0)};if(h.value.kind==="constant"&&h.value.value instanceof Co)y(h.value.value.sections);else if(h.value.kind==="source"){const x=I=>{_||(I instanceof ti&&ds(I.value)===le?y(I.value.sections):I instanceof Kc?y(I.sections):I.eachChild(x))},C=h.value;C._styleExpression&&x(C._styleExpression.expression)}return _}getProgramIds(){return["symbol"]}getDefaultProgramParams(i,a,h){return{config:new Mh(this,{zoom:a,lut:h}),overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("symbol-elevation-reference")==="hd-road-markup"}}let IP,AP,kP,RP;var s2=ki([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function W1(l,i,a,h,f,_,y,x){const C=[l,i,1,a,h,1,f,_,1],I=[y,x,1],R=B([],C),[P,L,$]=dr(I,I,R);return N(C,C,[P,0,0,0,L,0,0,0,$])}function PP(l,i,a,h,f,_,y,x){const C=function(I,R,P,L,$,j,q,Z){const K=W1(0,0,1,0,1,1,0,1),ae=W1(I,R,P,L,$,j,q,Z);return N(ae,ae,B([],K))}(l,i,a,h,f,_,y,x);return[C[2]/C[8]/Ut,C[5]/C[8]/Ut]}function q1(l){return[l[0],Math.min(Math.max(l[1],-ke),ke)]}class MP extends Ta{constructor(i,a,h,f){super(),this.id=i,this.dispatcher=h,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(f),this.options=a,this._dirty=!1}load(i,a){if(this._loaded=a||!1,this.fire(new Vs("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return i&&(this.coordinates=i),this._loaded=!0,void this._finishLoading();this._imageRequest=Il(this.map._requestManager.transformRequest(this.url,Va.Image),(h,f)=>{this._imageRequest=null,this._loaded=!0,h?this.fire(new el(h)):f&&(this.image=f instanceof HTMLImageElement?Ko.getImageData(f):f,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,i&&(this.coordinates=i),this._finishLoading())})}loaded(){return this._loaded}updateImage(i){return i.url?(this._imageRequest&&i.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=i.url,this.load(i.coordinates,this._loaded),this):this}setTexture(i){if(!(i.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new dv(this.map.painter.context,i.handle),this.width=i.dimensions[0],this.height=i.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Vs("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(i){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof dv||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(i){if(this.coordinates=i,this._boundsArray=void 0,this._unsupportedCoords=!1,!i.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let a=i[0][1],h=i[0][1];for(const _ of i)_[1]>h&&(h=_[1]),_[1]<a&&(a=_[1]);const f=(h+a)/2;if(f>ke?this.onNorthPole=!0:f<-ke&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const _=i.map(ut.fromLngLat);this.tileID=function(y){let x=1/0,C=1/0,I=-1/0,R=-1/0;for(const q of y)x=Math.min(x,q.x),C=Math.min(C,q.y),I=Math.max(I,q.x),R=Math.max(R,q.y);const P=Math.max(I-x,R-C),L=Math.max(0,Math.floor(-Math.log2(P))),$=Math.pow(2,L);let j=Math.floor((x+I)/2*$);return j>1&&(j-=1),new qu(L,j,Math.floor((C+R)/2*$))}(_),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Vs("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){!this.texture||this.texture instanceof dv||(this.texture.destroy(),this._dirty=!0),this.texture=null,this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(i){for(const K in this.tiles){const ae=this.tiles[K];ae.state!=="loaded"&&(ae.state="loaded",ae.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const a=bv(new qu(0,0,0),this.map.transform.projection),h=[a.projection.project(this.coordinates[0][0],this.coordinates[0][1]),a.projection.project(this.coordinates[1][0],this.coordinates[1][1]),a.projection.project(this.coordinates[2][0],this.coordinates[2][1]),a.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(K){const ae=K[1].x-K[0].x,ue=K[1].y-K[0].y,fe=K[2].x-K[1].x,Me=K[2].y-K[1].y,De=K[3].x-K[2].x,Ve=K[3].y-K[2].y,He=K[0].x-K[3].x,Ze=K[0].y-K[3].y,_t=ae*Me-fe*ue,Je=fe*Ve-De*Me,bt=De*Ze-He*Ve,Mt=He*ue-ae*Ze;return _t>0&&Je>0&&bt>0&&Mt>0||_t<0&&Je<0&&bt<0&&Mt<0}(h))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const f=bv(this.tileID,this.map.transform.projection),[_,y,x,C]=this.coordinates.map(K=>{const ae=f.projection.project(K[0],K[1]);return yP(f,ae)._round()});this.perspectiveTransform=PP(_.x,_.y,y.x,y.y,x.x,x.y,C.x,C.y);const I=this._boundsArray=new kh;I.emplaceBack(_.x,_.y,0,0),I.emplaceBack(y.x,y.y,Ut,0),I.emplaceBack(C.x,C.y,0,Ut),I.emplaceBack(x.x,x.y,Ut,Ut),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=i.createVertexBuffer(I,s2.members),this.boundsSegments=ro.simpleSegment(0,0,4,2);const R=[],P=[q1((L=this.coordinates)[0]),q1(L[1]),q1(L[2]),q1(L[3])];var L;const[$,j,q,Z]=function(K){let ae=K[0][0],ue=ae,fe=K[0][1],Me=fe;for(let De=1;De<K.length;De++)K[De][0]<ae?ae=K[De][0]:K[De][0]>ue&&(ue=K[De][0]),K[De][1]<fe?fe=K[De][1]:K[De][1]>Me&&(Me=K[De][1]);return[ae,fe,ue-ae,Me-fe]}(P);{const K=new kh,[ae,ue,fe,Me]=function(mt){let At=mt[0].x,ct=At,rt=mt[0].y,Bt=rt;for(let Ot=1;Ot<mt.length;Ot++)mt[Ot].x<At?At=mt[Ot].x:mt[Ot].x>ct&&(ct=mt[Ot].x),mt[Ot].y<rt?rt=mt[Ot].y:mt[Ot].y>Bt&&(Bt=mt[Ot].y);return[At,rt,ct-At,Bt-rt]}(h),De=mt=>[(mt.x-ae)/fe,(mt.y-ue)/Me],[Ve,He,Ze,_t]=h.map(De),Je=function(mt,At,ct,rt,Bt,Ot,En,ln){const pn=W1(0,0,1,0,1,1,0,1);return N(pn,pn,B([],W1(mt,At,ct,rt,Bt,Ot,En,ln)))}(Ve[0],Ve[1],He[0],He[1],Ze[0],Ze[1],_t[0],_t[1]);this.elevatedGlobePerspectiveTransform=PP(Ve[0],Ve[1],He[0],He[1],Ze[0],Ze[1],_t[0],_t[1]);const bt=(mt,At)=>{R.push(mt.lng);const ct=Math.round((mt.lng-$)/q*Ut),rt=Math.round((mt.lat-j)/Z*Ut),Bt=De(At),Ot=dr([],[Bt[0],Bt[1],1],Je),En=Math.round(Ot[0]/Ot[2]*Ut),ln=Math.round(Ot[1]/Ot[2]*Ut);K.emplaceBack(ct,rt,En,ln)},Mt=h[3].x-h[0].x,Tt=h[3].y-h[0].y,It=h[2].x-h[1].x,zt=h[2].y-h[1].y;for(let mt=0;mt<65;mt++){const At=mt/64,ct=[h[0].x+At*Mt,h[0].y+At*Tt],rt=[h[1].x+At*It,h[1].y+At*zt],Bt=rt[0]-ct[0],Ot=rt[1]-ct[1];for(let En=0;En<65;En++){const ln=En/64,pn={x:ct[0]+Bt*ln,y:ct[1]+Ot*ln};bt(a.projection.unproject(pn.x,pn.y),pn)}}this.elevatedGlobeVertexBuffer=i.createVertexBuffer(K,s2.members)}{this.maxLongitudeTriangleSize=0;let K=[],ae=new bs;const ue=(fe,Me,De)=>{ae.emplaceBack(fe,Me,De);const Ve=R[fe],He=R[Me],Ze=R[De],_t=Math.min(Math.min(Ve,He),Ze),Je=Math.max(Math.max(Ve,He),Ze)-_t;Je>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Je),K.push(_t+Je/2)};for(let fe=0;fe<64;fe++)for(let Me=0;Me<64;Me++){const De=65*fe+Me,Ve=De+1,He=De+65,Ze=He+1;ue(De,He,Ve),ue(Ve,He,Ze)}[K,ae]=function(fe,Me){const De=Array.from({length:fe.length},(Ze,_t)=>_t);De.sort((Ze,_t)=>fe[Ze]-fe[_t]);const Ve=[],He=new bs;for(let Ze=0;Ze<De.length;Ze++){const _t=De[Ze];Ve.push(fe[_t]);const Je=3*_t,bt=Je+1;He.emplaceBack(Me.uint16[Je],Me.uint16[bt],Me.uint16[bt+1])}return[Ve,He]}(K,ae),this.elevatedGlobeTrianglesCenterLongitudes=K,this.elevatedGlobeIndexBuffer=i.createIndexBuffer(ae)}this.elevatedGlobeSegments=ro.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,q/Ut,0,Z/Ut,0,0,j,$,0])}prepare(){const i=Object.keys(this.tiles).length!==0;if(this.tileID&&!i)return;const a=this.map.painter.context,h=a.gl;!this._dirty||this.texture instanceof dv||(this.texture?this.texture.update(this.image):(this.texture=new OC(a,this.image,h.RGBA8),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this._dirty=!1),i&&this._prepareData(a)}loadTile(i,a){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},a(null)):(i.state="errored",a(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(i){const a=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!a)return null;const h=this.elevatedGlobeTrianglesCenterLongitudes;let f=(_=i+180)+360*Math.round((h[0]-_)/360);var _;const y=new ro,x=(P,L)=>{y.segments.push({vertexOffset:0,primitiveOffset:P,vertexLength:a.segments[0].vertexLength,primitiveLength:L,sortKey:void 0,vaos:{}})},C=.51*this.maxLongitudeTriangleSize;if(Math.abs(h[0]-f)<=C){const P=Zo(h,0,h.length,f+C);return P===h.length||x(P,ur(h,P+1,h.length,f+360-C)-P),y}f<h[0]&&(f+=360);const I=ur(h,0,h.length,f-C);if(I===h.length)return x(0,h.length),y;x(0,I-0);const R=Zo(h,I+1,h.length,f+C);return R!==h.length&&x(R,h.length-R),y}}const UV=(Math.pow(256,2)-1)/16907520;class DP extends ba{constructor(i,a,h,f){super(i,{layout:kP||(kP=new _o({visibility:new Vt(Ye.layout_raster.visibility)})),paint:RP||(RP=new _o({"raster-opacity":new Vt(Ye.paint_raster["raster-opacity"]),"raster-color":new $f(Ye.paint_raster["raster-color"]),"raster-color-mix":new Vt(Ye.paint_raster["raster-color-mix"]),"raster-color-range":new Vt(Ye.paint_raster["raster-color-range"]),"raster-hue-rotate":new Vt(Ye.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Vt(Ye.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Vt(Ye.paint_raster["raster-brightness-max"]),"raster-saturation":new Vt(Ye.paint_raster["raster-saturation"]),"raster-contrast":new Vt(Ye.paint_raster["raster-contrast"]),"raster-resampling":new Vt(Ye.paint_raster["raster-resampling"]),"raster-fade-duration":new Vt(Ye.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Vt(Ye.paint_raster["raster-emissive-strength"]),"raster-array-band":new Vt(Ye.paint_raster["raster-array-band"]),"raster-elevation":new Vt(Ye.paint_raster["raster-elevation"]),"raster-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},a,h,f),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(i){return!(i&&i._source instanceof MP&&(i._source.onNorthPole||i._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(i){i!=="raster-color"&&i!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}_clear(){this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}updateColorRamp(i){if(!this.hasColorMap()||!this._curRampRange)return;const a=this._transitionablePaint._values["raster-color"].value.expression,[h,f]=i||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(h)&&isNaN(f)||h===this._curRampRange[0]&&f===this._curRampRange[1]||(this.colorRamp=Xy({expression:a,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:h,end:f}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[h,f])}}let OP,LP,zP,BP,FP;class NP extends ba{constructor(i,a,h,f){super(i,{layout:OP||(OP=new _o({visibility:new Vt(Ye["layout_raster-particle"].visibility)})),paint:LP||(LP=new _o({"raster-particle-array-band":new Vt(Ye["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Vt(Ye["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new $f(Ye["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Vt(Ye["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Vt(Ye["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Vt(Ye["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Vt(Ye["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Vt(Ye["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},a,h,f),this._updateColorRamp(),this.lastInvalidatedAt=Ko.now()}_clear(){this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null),this.tileFramebuffer&&(this.tileFramebuffer.destroy(),this.tileFramebuffer=null),this.particleFramebuffer&&(this.particleFramebuffer.destroy(),this.particleFramebuffer=null)}onRemove(i){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(i){return!1}_handleSpecialPaintPropertyUpdate(i){i!=="raster-particle-color"&&i!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),i==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const i=this._transitionablePaint._values["raster-particle-color"].value.expression,a=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Xy({expression:i,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:a}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Ko.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class HV extends ba{constructor(i,a){super(i,{},a,null),this.implementation=i,i.slot&&(this.slot=i.slot)}is3D(i){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(i){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)}onRemove(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)}}function a2(l,i,a){const h=[0,0,1],f=Ln([]);return yi(f,f,a?-Xe(l)+Math.PI:Xe(l)),mi(f,f,-Xe(i)),Qe(h,h,f),ai(h,h)}const VP={None:0,Model:1,Symbol:2,FillExtrusion:4};class Z1{constructor(i,a,h,f){this.message=(i?`${i}: `:"")+h,f&&(this.identifier=f),a!=null&&a.__line__&&(this.line=a.__line__)}}function l2(l,i){const a=l.indexOf("://")===-1;try{return new URL(l,a&&i?"http://example.com":void 0),!0}catch{return!1}}class $P{constructor(i,a){this.feature=i,this.instancedDataOffset=a,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class jP{constructor(){this.instancedDataArray=new Hy,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class c2{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.layers=i.layers,this.layerIds=this.layers.map(a=>a.fqid),this.projection=i.projection,this.index=i.index,this.worldview=i.worldview,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z+1?0:this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.styleDefinedModelURLs=i.styleDefinedModelURLs}updateFootprints(i,a){}populate(i,a,h,f){this.tileToMeter=et(h);const _=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:y,id:x,index:C,sourceLayerIndex:I}of i){const R=x??(y.properties&&y.properties.hasOwnProperty("id")?y.properties.id:void 0),P=Lt(y,_);if(!this.layers[0]._featureFilter.filter(new Tr(this.zoom,{worldview:this.worldview}),P,h))continue;const L={id:R,sourceLayerIndex:I,index:C,geometry:_?P.geometry:rn(y,h,f),properties:y.properties,type:y.type,patterns:{}},$=this.addFeature(L,L.geometry,P);$&&a.featureIndex.insert(y,L.geometry,C,I,this.index,this.instancesPerModel[$].instancedDataArray.length,Ut/32)}this.lookup=null}update(i,a,h,f){for(const _ in this.instancesPerModel){const y=this.instancesPerModel[_];for(const x in i)y.idToFeaturesIndex.hasOwnProperty(x)&&(this.evaluate(y.features[y.idToFeaturesIndex[x]],i[x],y,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let i=!1;for(const a in this.instancesPerModel){const h=this.instancesPerModel[a];for(const f of h.features){const _=this.layers[0],y=f.feature,x=this.canonical,C=_.paint.get("model-rotation").evaluate(y,{},x),I=_.paint.get("model-scale").evaluate(y,{},x),R=_.paint.get("model-translation").evaluate(y,{},x);vt(f.rotation,C)&&vt(f.scale,I)&&vt(f.translation,R)||(this.evaluate(f,f.featureStates,h,!0),i=!0)}}return i}updateReplacement(i,a,h,f){if(a.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=a.updateTime;const _=a.getReplacementRegionsForTile(i.toUnwrapped(),!0);if(v1(this.activeReplacements,_))return!1;this.activeReplacements=_;let y=!1;for(const x in this.instancesPerModel){const C=this.instancesPerModel[x],I=C.instancedDataArray;for(const R of C.features){const P=R.instancedDataOffset,L=R.instancedDataCount;for(let $=0;$<L;$++){const j=16*($+P);let q=I.float32[j+0];const Z=q>Ut;q=Z?q-Ut:q;const K=Math.floor(q),ae=I.float32[j+1];let ue=!1;for(const fe of this.activeReplacements)if(!Ak(fe,h,VP.Model,f)&&!(fe.min.x>K||K>fe.max.x||fe.min.y>ae||ae>fe.max.y)&&(ue=wC(Mk(K,ae,i.canonical,fe.footprintTileId.canonical),fe.footprint),ue))break;I.float32[j]=ue?q+Ut:q,y=y||ue!==Z}}}return y}isEmpty(){for(const i in this.instancesPerModel)if(this.instancesPerModel[i].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(i){if(!this.uploaded)for(const a in this.instancesPerModel){const h=this.instancesPerModel[a];h.instancedDataArray.length<0||h.instancedDataArray.length===0||(h.instancedDataBuffer?h.instancedDataBuffer.updateData(h.instancedDataArray):h.instancedDataBuffer=i.createVertexBuffer(h.instancedDataArray,v9.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const a in this.instancesPerModel){const h=this.instancesPerModel[a];h.instancedDataArray.length!==0&&h.instancedDataBuffer&&h.instancedDataBuffer.destroy()}const i=this.layers[0].modelManager;if(i&&this.modelUris&&this.modelsRequested)for(const a of this.modelUris)i.removeModel(a,"",!0)}addFeature(i,a,h){const f=this.layers[0],_=f.layout.get("model-id").evaluate(h,{},this.canonical);if(!_)return li(`modelId is not evaluated for layer ${f.id} and it is not going to get rendered.`),_;(l2(_,!1)||this.styleDefinedModelURLs[_]!==void 0)&&(this.modelUris.includes(_)||this.modelUris.push(_)),this.instancesPerModel[_]||(this.instancesPerModel[_]=new jP);const y=this.instancesPerModel[_],x=y.instancedDataArray,C=new $P(h,x.length);for(const I of a)for(const R of I){if(R.x<0||R.x>=Ut||R.y<0||R.y>=Ut)continue;if(this.lookupDim!==0){const L=(this.lookupDim-1)/Ut,$=this.lookupDim*(R.y*L|0)+R.x*L|0;if(this.lookup){if(this.lookup[$]!==0)continue;this.lookup[$]=1}}this.instanceCount++;const P=x.length;x.resize(P+1),y.instancesEvaluatedElevation.push(0),x.float32[16*P]=R.x,x.float32[16*P+1]=R.y}return C.instancedDataCount=y.instancedDataArray.length-C.instancedDataOffset,C.instancedDataCount>0&&(i.id&&(y.idToFeaturesIndex[i.id]=y.features.length),y.features.push(C),this.evaluate(C,{},y,!1)),_}getModelUris(){return this.modelUris}evaluate(i,a,h,f){const _=this.layers[0],y=i.feature,x=this.canonical,C=i.rotation=_.paint.get("model-rotation").evaluate(y,a,x),I=i.scale=_.paint.get("model-scale").evaluate(y,a,x),R=i.translation=_.paint.get("model-translation").evaluate(y,a,x),P=_.paint.get("model-color").evaluate(y,a,x);P.a=_.paint.get("model-color-mix-intensity").evaluate(y,a,x);const L=[];this.maxVerticalOffset<R[2]&&(this.maxVerticalOffset=R[2]),this.maxScale=Math.max(Math.max(this.maxScale,I[0]),Math.max(I[1],I[2])),fR(L,C,I);const $=Math.round(100*P.a)+P.b/1.05;for(let j=0;j<i.instancedDataCount;++j){const q=i.instancedDataOffset+j,Z=16*q,K=h.instancedDataArray.float32;let ae=0;f&&(ae=K[Z+6]-h.instancesEvaluatedElevation[q]);const ue=0|K[Z+1];K[Z]=(0|K[Z])+P.r/1.05,K[Z+1]=ue+P.g/1.05,K[Z+2]=$,K[Z+3]=1/(x.z>10?this.tileToMeter:et(x,ue)),K[Z+4]=R[0],K[Z+5]=R[1],K[Z+6]=R[2]+ae,K[Z+7]=L[0],K[Z+8]=L[1],K[Z+9]=L[2],K[Z+10]=L[4],K[Z+11]=L[5],K[Z+12]=L[6],K[Z+13]=L[8],K[Z+14]=L[9],K[Z+15]=L[10],h.instancesEvaluatedElevation[q]=R[2]}}}let UP,HP;en(c2,"ModelBucket",{omit:["layers"]}),en(jP,"PerModelAttributes"),en($P,"ModelFeature");class v_{constructor(i,a,h){this._demTile=i,this._dem=this._demTile.dem,this._scale=a,this._offset=h}static create(i,a,h){const f=h||i.findDEMTileFor(a);if(!f||!f.dem)return;const _=f.dem,y=f.tileID,x=1<<a.canonical.z-y.canonical.z;return new v_(f,_.dim/Ut/x,[(a.canonical.x/x-y.canonical.x)*_.dim,(a.canonical.y/x-y.canonical.y)*_.dim])}tileCoordToPixel(i,a){const h=a*this._scale+this._offset[1];return new Dt(Math.floor(i*this._scale+this._offset[0]),Math.floor(h))}getElevationAt(i,a,h,f){const _=i*this._scale+this._offset[0],y=a*this._scale+this._offset[1],x=Math.floor(_),C=Math.floor(y),I=this._dem;return f=!!f,h?Pn(Pn(I.get(x,C,f),I.get(x,C+1,f),y-C),Pn(I.get(x+1,C,f),I.get(x+1,C+1,f),y-C),_-x):I.get(x,C,f)}getElevationAtPixel(i,a,h){return this._dem.get(i,a,!!h)}getMeterToDEM(i){return(1<<this._demTile.tileID.canonical.z)*Se(1,i)*this._dem.stride}}const u2=new Float32Array(262144),Dm=new Uint8Array(262144);function GP(l){let i=0;if(l.meshes)for(const a of l.meshes)i=Math.max(i,a.aabb.max[2]);if(l.children)for(const a of l.children)i=Math.max(i,GP(a));return i}function WP(l,i,a){if(l.meshes)for(const h of l.meshes){if(h.aabb.min[0]===1/0)continue;const f=Vn.applyTransform(h.aabb,l.matrix);a.insert(i,f.min[0],f.min[1],f.max[0],f.max[1])}if(l.children)for(const h of l.children)WP(h,i,a)}const qP=["","wall","door","roof","window","lamp","logo"];class ZP{constructor(i){this.node=i,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedTranslation=[0,0,0],this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:i.id,geometry:[],properties:{height:GP(i)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new Vn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let i=0;const a=new Vn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const h of this.node.meshes)this.node.lightMeshIndex!==i&&(h.transformedAabb=Vn.applyTransformFast(h.aabb,this.node.matrix),a.encapsulate(h.transformedAabb)),i++;this.aabb=a}return this.aabb}}class K1{constructor(i,a,h,f,_,y,x,C){this.id=h,this.layers=i,this.layerIds=this.layers.map(I=>I.fqid),this.stateDependentLayerIds=this.layers.filter(I=>I.isStateDependent()).map(I=>I.id),this.modelTraits|=f_.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,f&&(this.modelTraits|=f_.HasMapboxMeshFeatures),_&&(this.modelTraits|=f_.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=y,this.worldview=C,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(const I of a)this.nodesInfo.push(new ZP(I)),WP(I,x.featureIndexArray.length,x.grid),x.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,x.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(i,a){for(const h of this.getNodesInfo()){const f=h.node;f.footprint&&a.push({footprint:f.footprint,id:i})}}update(i){const a=Object.keys(i).length!==0;if(a&&!this.stateDependentLayers.length)return;const h=a?this.stateDependentLayers:this.layers;if(!bl(i,this.states))for(const f of h)this.evaluate(f,i);this.states=structuredClone(i)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(i){if(!this.needsUpload)return;const a=this.getNodesInfo();for(const h of a){const f=h.node;this.uploaded?this.updatePbrBuffer(f):BC(f,i,!0)}for(const h of a)k1(h.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(i){let a=!1;if(!i.meshes)return a;for(const h of i.meshes)h.pbrBuffer&&(h.pbrBuffer.updateData(h.featureArray),a=!0);return a}needsReEvaluation(i,a,h){const f=i.transform.projectionOptions,_=i.style.getBrightness(),y=this.brightness!==_;if(!this.uploaded||this.dirty||f.name!==this.projection.name||Tv(h.paint.get("model-color").value,y)||Tv(h.paint.get("model-color-mix-intensity").value,y)||Tv(h.paint.get("model-roughness").value,y)||Tv(h.paint.get("model-emissive-strength").value,y)||Tv(h.paint.get("model-height-based-emissive-strength-multiplier").value,y)){this.projection=f,this.brightness=_;const x=this.getNodesInfo();for(const C of x)C.state=null;return!0}return!1}evaluateTransform(i,a){if(i.transform.zoom===this.zoom)return;this.zoom=i.transform.zoom;const h=this.getNodesInfo(),f=this.id.canonical;for(const _ of h){const y=_.feature;_.evaluatedTranslation=a.paint.get("model-translation").evaluate(y,{},f),_.evaluatedScale=a.paint.get("model-scale").evaluate(y,{},f)}}evaluate(i,a){const h=this.getNodesInfo();for(const f of h){if(!f.node.meshes)continue;const _=f.feature,y=a&&a[_.id];if(bl(y,f.state))continue;f.state=structuredClone(y);const x=f.node.meshes&&f.node.meshes[0].featureData,C=f.evaluatedColor[2],I=f.evaluatedRMEA[2],R=this.id.canonical;if(f.hasTranslucentParts=!1,x){for(let P=0;P<qP.length;P++){const L=qP[P];L.length&&(_.properties.part=L);const $=i.paint.get("model-color").evaluate(_,y,R).toPremultipliedRenderColor(null),j=i.paint.get("model-color-mix-intensity").evaluate(_,y,R);f.evaluatedColor[P]=[$.r,$.g,$.b,j],f.evaluatedRMEA[P][0]=i.paint.get("model-roughness").evaluate(_,y,R),f.evaluatedRMEA[P][2]=i.paint.get("model-emissive-strength").evaluate(_,y,R),f.evaluatedRMEA[P][3]=$.a,f.emissionHeightBasedParams[P]=i.paint.get("model-height-based-emissive-strength-multiplier").evaluate(_,y,R),!f.hasTranslucentParts&&$.a<1&&(f.hasTranslucentParts=!0)}delete _.properties.part,WV(f,C!==f.evaluatedColor[2]||I!==f.evaluatedRMEA[2],this.modelTraits)}else f.evaluatedRMEA[0][2]=i.paint.get("model-emissive-strength").evaluate(_,y,R);f.evaluatedTranslation=i.paint.get("model-translation").evaluate(_,y,R),f.evaluatedScale=i.paint.get("model-scale").evaluate(_,y,R),this.updatePbrBuffer(f.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(i,a,h,f){const _=i.findDEMTileFor(h);if(_&&(_.tileID.canonical!==this.terrainTile||a!==this.terrainExaggeration)){if(_.dem&&_.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=_.tileID.overscaledZ;const y=v_.create(i,h,_);if(!y)return;this.modelTraits&f_.HasMapboxMeshFeatures&&this.updateDEM(i,y,h,f);for(const x of this.getNodesInfo()){const C=x.node;if(!C.footprint||!C.footprint.vertices||!C.footprint.vertices.length)continue;const I=C.footprint.vertices;let R=y.getElevationAt(I[0].x,I[0].y,!0,!0);for(let P=1;P<I.length;P++)R=Math.min(R,y.getElevationAt(I[P].x,I[P].y,!0,!0));C.elevation=R}}this.terrainTile=_.tileID.canonical,this.terrainExaggeration=a}}updateDEM(i,a,h,f){let _=a._dem._modifiedForSources[f];if(_===void 0&&(a._dem._modifiedForSources[f]=[],_=a._dem._modifiedForSources[f]),_.includes(h.canonical))return;const y=a._dem.dim;_.push(h.canonical);let x=!1;for(const C of this.getNodesInfo()){const I=C.node;if(!I.footprint||!I.footprint.grid)continue;const R=I.footprint.grid,P=a.tileCoordToPixel(R.min.x,R.min.y),L=a.tileCoordToPixel(R.max.x,R.max.y),$=Math.min(Math.min(y-L.y,P.x),Math.min(P.y,y-L.x));if($<0)continue;const j=Le($,2,5);let q=Math.max(0,P.x-j),Z=Math.max(0,P.y-j),K=Math.min(L.x+j,y-1),ae=Math.min(L.y+j,y-1);for(let De=Z;De<=ae;++De)for(let Ve=q;Ve<=K;++Ve)Dm[De*y+Ve]=255;let ue=0,fe=0;for(let De=0;De<R.cellsY;++De)for(let Ve=0;Ve<R.cellsX;++Ve){if(!R.cells[De*R.cellsX+Ve])continue;const He=a.tileCoordToPixel(R.min.x+Ve/R.xScale,R.min.y+De/R.yScale),Ze=a.tileCoordToPixel(R.min.x+(Ve+1)/R.xScale,R.min.y+(De+1)/R.yScale);for(let _t=He.y;_t<=Math.min(Ze.y+1,y-1);++_t)for(let Je=He.x;Je<=Math.min(Ze.x+1,y-1);++Je)Dm[_t*y+Je]===255&&(Dm[_t*y+Je]=0,ue+=a.getElevationAtPixel(Je,_t),fe++)}const Me=ue/fe;q=Math.max(1,P.x-j),Z=Math.max(1,P.y-j),K=Math.min(L.x+j,y-2),ae=Math.min(L.y+j,y-2),x=!0;for(let De=Z;De<=ae;++De)for(let Ve=q;Ve<=K;++Ve)Dm[De*y+Ve]===0&&(u2[De*y+Ve]=a._dem.set(Ve,De,Me));for(let De=1;De<j;++De){q=Math.max(1,P.x-De),Z=Math.max(1,P.y-De),K=Math.min(L.x+De,y-2),ae=Math.min(L.y+De,y-2);for(let Ve=Z;Ve<=ae;++Ve)for(let He=q;He<=K;++He){const Ze=Ve*y+He;if(Dm[Ze]===255){let _t=0,Je=0,bt=-1,Mt=-1;for(let Tt=-1;Tt<=1;++Tt)for(let It=-1;It<=1;++It){const zt=(Ve+Tt)*y+He+It;if(Dm[zt]>=De)continue;const mt=u2[zt],At=Math.abs(mt);At>Je&&(_t=mt,Je=At,bt=It,Mt=Tt)}if(Je>.1){const Tt=1-(De+.5*Math.abs(bt*Mt))/j;let It=a._dem.get(He,Ve)+_t*Tt;const zt=a._dem.get(He+bt,Ve+Mt),mt=a._dem.get(He-bt,Ve-Mt,!0);(It-zt)*(It-mt)>0&&(It=(zt+mt)/2),u2[Ze]=a._dem.set(He,Ve,It),Dm[Ze]=De}}}}}x&&(a._demTile.needsDEMTextureUpload=!0,a._dem._timestamp=Ko.now())}setFilter(i){this.filter=i?pm(i):null}getNodesInfo(){return this.filter?this.nodesInfo.filter(i=>this.filter.filter(new Tr(this.id.overscaledZ,{worldview:this.worldview}),i.feature,this.id.canonical)):this.nodesInfo}destroy(){const i=this.getNodesInfo();for(const a of i)k1(a.node),FC(a.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(i,a){if(a.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=a.updateTime;const h=a.getReplacementRegionsForTile(i.toUnwrapped());for(const f of this.getNodesInfo()){const _=f.node.footprint;f.hiddenByReplacement=!!_&&!h.find(y=>y.footprint===_)}}getHeightAtTileCoord(i,a){const h=[],f=[0,0,0],_=Q([]);for(const y of this.getNodesInfo()){const x=y.node.meshes[0],C=x.transformedAabb;if(i<C.min[0]||a<C.min[1]||i>C.max[0]||a>C.max[1])continue;if(y.node.hidden===!0)return{height:1/0,maxHeight:y.feature.properties.height,hidden:!1,verticalScale:y.evaluatedScale[2]};se(_,y.node.matrix),f[0]=i,f[1]=a,kn(f,f,_);const I=(f[0]-x.aabb.min[0])/(x.aabb.max[0]-x.aabb.min[0])*Rm|0,R=Math.min(63,(f[1]-x.aabb.min[1])/(x.aabb.max[1]-x.aabb.min[1])*Rm|0)*Rm+Math.min(63,I),P=x.heightmap[R];if(!(P<0&&y.node.footprint))return y.hiddenByReplacement?void 0:{height:P,maxHeight:y.feature.properties.height,hidden:!1,verticalScale:y.evaluatedScale[2]};if(y.node.footprint.grid.query(new Dt(i,a),new Dt(i,a),h),h.length>0)return{height:void 0,maxHeight:y.feature.properties.height,hidden:y.hiddenByReplacement,verticalScale:y.evaluatedScale[2]}}}}function Tv(l,i){return l instanceof js&&!l.isLightConstant&&i}function GV(l,i,a,h,f,_,y,x){let C=(61440&i|(61440&i)>>4)>>8,I=(3840&i|(3840&i)>>4)>>4,R=240&i|(240&i)>>4;a[3]>0&&(C=Pn(C,255*a[0],a[3]),I=Pn(I,255*a[1],a[3]),R=Pn(R,255*a[2],a[3]));const P=C<<8|I,L=R<<8|Math.floor(255*h[3]),$=function(De){const Ve=Le(De,0,2);return Math.min(Math.round(.5*Ve*255),255)}(h[2])<<8|15*h[0]<<4|15*h[1],j=Le(f[0],0,1),q=Le(f[1],0,1),Z=Le(f[2],0,1),K=Le(f[3],0,1);let ae,ue,fe,Me;if(j!==q&&y!==_&&q!==j){const De=y-_;ue=1/(De*(q-j)),fe=-(_+De*j)/(De*(q-j));const Ve=Le(f[4],-1,1);Me=Math.pow(10,Ve),ae=255*Z<<8|255*K}else ae=65535,ue=0,fe=1,Me=1;if(l.emplaceBack(P,L,$,ae,ue,fe,Me),x){const De=x.length;x.clear();for(let Ve=0;Ve<De;Ve++)x.emplaceBack(P,L,$,ae,ue,fe,Me)}}function WV(l,i,a){const h=l.node;let f=0;const _=a&f_.HasMeshoptCompression;for(const y of h.meshes){if(h.lights&&h.lightMeshIndex===f||!y.featureData)continue;y.featureArray=new Kf,y.featureArray.reserve(y.featureData.length);let x=i;for(const C of y.featureData){const I=_?65535&C:C>>16&65535,R=_?C>>16&65535:65535&C,P=(15&R)<8?15&R:0,L=l.evaluatedRMEA[P],$=l.evaluatedColor[P],j=l.emissionHeightBasedParams[P];let q;if(x&&P===2&&h.lights&&(q=new Kf,q.resize(10*h.lights.length)),GV(y.featureArray,I,$,L,j,y.aabb.min[2],y.aabb.max[2],q),q&&x){x=!1;const Z=h.meshes[h.lightMeshIndex];Z.featureArray=q,Z.featureArray._trim()}}y.featureArray._trim(),f++}}function KP(l,i,a,h){const f=1<<l.z;i.lat=Ce((h/Ut+l.y)/f),i.lng=Ae((a/Ut+l.x)/f)}function qV(l,i,a,h){const f=l.getNodesInfo()[i];if(!f||f.hiddenByReplacement||!f.node.meshes)return;let _=Number.MAX_VALUE;const y=f.node,x=a.tile,C=h.calculatePosMatrix(x.tileID.toUnwrapped(),h.worldSize),I=f.evaluatedScale;let R=0;h.elevation&&y.elevation&&(R=y.elevation*h.elevation.exaggeration()),be(C,C,[(y.anchor?y.anchor[0]:0)*(I[0]-1),(y.anchor?y.anchor[1]:0)*(I[1]-1),R]),ze(C,C,I);const P=a.queryGeometry,L=P.isPointQuery()?P.screenBounds:P.screenGeometry,$=function(q){const Z=ce([],C,q.matrix);ce(Z,h.expandedFarZProjMatrix,Z);for(let K=0;K<q.meshes.length;++K){const ae=q.meshes[K];if(K===q.lightMeshIndex)continue;const ue=pR(L,h,Z,ae.aabb);ue!=null&&(_=Math.min(ue,_))}if(q.children)for(const K of q.children)$(K)};if($(y),_===Number.MAX_VALUE)return;const j=new W(0,0);return KP(x.tileID.canonical,j,f.node.anchor[0],f.node.anchor[1]),{intersectionZ:_,position:j,feature:f.feature}}en(K1,"Tiled3dModelBucket",{omit:["layers"]}),en(ZP,"Tiled3dModelFeature");const ZV={circle:class extends ba{constructor(l,i,a,h){super(l,{layout:Yf||(Yf=new _o({"circle-sort-key":new nn(Ye.layout_circle["circle-sort-key"]),"circle-elevation-reference":new Vt(Ye.layout_circle["circle-elevation-reference"]),visibility:new Vt(Ye.layout_circle.visibility)})),paint:Wu||(Wu=new _o({"circle-radius":new nn(Ye.paint_circle["circle-radius"]),"circle-color":new nn(Ye.paint_circle["circle-color"]),"circle-blur":new nn(Ye.paint_circle["circle-blur"]),"circle-opacity":new nn(Ye.paint_circle["circle-opacity"]),"circle-translate":new Vt(Ye.paint_circle["circle-translate"]),"circle-translate-anchor":new Vt(Ye.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Vt(Ye.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Vt(Ye.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new nn(Ye.paint_circle["circle-stroke-width"]),"circle-stroke-color":new nn(Ye.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new nn(Ye.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Vt(Ye.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},i,a,h)}createBucket(l){return new Js(l)}queryRadius(l){const i=l;return kc("circle-radius",this,i)+kc("circle-stroke-width",this,i)+zd(this.paint.get("circle-translate"))}queryIntersectsFeature(l,i,a,h,f,_,y,x){const C=cu(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,l.pixelToTileUnitsFactor),I=this.paint.get("circle-radius").evaluate(i,a)+this.paint.get("circle-stroke-width").evaluate(i,a);return tk(l,h,_,y,x,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",C,I)}getProgramIds(){return["circle"]}getDefaultProgramParams(l,i,a){const h=ek(this);return{config:new Mh(this,{zoom:i,lut:a}),defines:h,overrideFog:!1}}is3D(l){return!l&&!!this.layout&&this.layout.get("circle-elevation-reference")!=="none"}hasElevation(){return this.layout&&this.layout.get("circle-elevation-reference")!=="none"}},heatmap:class extends ba{createBucket(l){return new ik(l)}constructor(l,i,a,h){super(l,{layout:rk||(rk=new _o({visibility:new Vt(Ye.layout_heatmap.visibility)})),paint:ok||(ok=new _o({"heatmap-radius":new nn(Ye.paint_heatmap["heatmap-radius"]),"heatmap-weight":new nn(Ye.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Vt(Ye.paint_heatmap["heatmap-intensity"]),"heatmap-color":new $f(Ye.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Vt(Ye.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},i,a,h),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Xy({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}_clear(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}queryRadius(l){return kc("heatmap-radius",this,l)}queryIntersectsFeature(l,i,a,h,f,_,y,x){const C=this.paint.get("heatmap-radius").evaluate(i,a);return tk(l,h,_,y,x,!0,!0,new Dt(0,0),C)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(l,i,a){return l==="heatmap"?{config:new Mh(this,{zoom:i,lut:a}),overrideFog:!1}:{}}},hillshade:class extends ba{constructor(l,i,a,h){super(l,{layout:sk||(sk=new _o({visibility:new Vt(Ye.layout_hillshade.visibility)})),paint:ak||(ak=new _o({"hillshade-illumination-direction":new Vt(Ye.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Vt(Ye.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Vt(Ye.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Vt(Ye.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Vt(Ye.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Vt(Ye.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Vt(Ye.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},i,a,h)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(l,i,a){return{overrideFog:!1}}},fill:class extends ba{constructor(l,i,a,h){super(l,{layout:wk||(wk=new _o({"fill-sort-key":new nn(Ye.layout_fill["fill-sort-key"]),visibility:new Vt(Ye.layout_fill.visibility),"fill-elevation-reference":new Vt(Ye.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new nn(Ye.layout_fill["fill-construct-bridge-guard-rail"])})),paint:Sk||(Sk=new _o({"fill-antialias":new Vt(Ye.paint_fill["fill-antialias"]),"fill-opacity":new nn(Ye.paint_fill["fill-opacity"]),"fill-color":new nn(Ye.paint_fill["fill-color"]),"fill-outline-color":new nn(Ye.paint_fill["fill-outline-color"]),"fill-translate":new Vt(Ye.paint_fill["fill-translate"]),"fill-translate-anchor":new Vt(Ye.paint_fill["fill-translate-anchor"]),"fill-pattern":new nn(Ye.paint_fill["fill-pattern"]),"fill-pattern-cross-fade":new Vt(Ye.paint_fill["fill-pattern-cross-fade"]),"fill-emissive-strength":new Vt(Ye.paint_fill["fill-emissive-strength"]),"fill-z-offset":new nn(Ye.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new nn(Ye.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new nn(Ye.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},i,a,h)}getProgramIds(){const l=this.paint.get("fill-pattern"),i=l&&l.constantOr(1),a=[i?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&a.push(i&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),a}getDefaultProgramParams(l,i,a){return{config:new Mh(this,{zoom:i,lut:a}),overrideFog:!1}}recalculate(l,i){super.recalculate(l,i);const a=this.paint._values["fill-outline-color"];a.value.kind==="constant"&&a.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new vC(l)}queryRadius(){return zd(this.paint.get("fill-translate"))}queryIntersectsFeature(l,i,a,h,f,_){return!l.queryGeometry.isAboveHorizon&&ol(Bd(l.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,l.pixelToTileUnitsFactor),h)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(l){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;const i=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return l!=null?i&&!l:i}hasElevation(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}hasShadowPass(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}},"fill-extrusion":class extends ba{constructor(l,i,a,h){super(l,{layout:Wk||(Wk=new _o({visibility:new Vt(Ye["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Vt(Ye["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:qk||(qk=new _o({"fill-extrusion-opacity":new Vt(Ye["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new nn(Ye["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Vt(Ye["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Vt(Ye["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new nn(Ye["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-pattern-cross-fade":new Vt(Ye["paint_fill-extrusion"]["fill-extrusion-pattern-cross-fade"]),"fill-extrusion-height":new nn(Ye["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new nn(Ye["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new Vt(Ye["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new Vt(Ye["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new Vt(Ye["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Vt(Ye["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Vt(Ye["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Vt(Ye["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Vt(Ye["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Vt(Ye["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Vt(Ye["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Vt(Ye["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new nn(Ye["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new nn(Ye["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Vt(Ye["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Vt(Ye["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Vt(Ye["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Vt(Ye["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new nn(Ye["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new nn(Ye["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Vt(Ye["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},i,a,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(l){return new x1(l)}queryRadius(){return zd(this.paint.get("fill-extrusion-translate"))}is3D(l){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(l,i,a,h,f,_,y,x,C){const I=cu(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,l.pixelToTileUnitsFactor),R=this.paint.get("fill-extrusion-height").evaluate(i,a),P=this.paint.get("fill-extrusion-base").evaluate(i,a),L=[0,0],$=x&&_.elevation,j=_.elevation?_.elevation.exaggeration():1,q=l.tile.getBucket(this);if($&&q instanceof x1){const fe=q.centroidVertexArray,Me=C+1;Me<fe.length&&(L[0]=fe.geta_centroid_pos0(Me),L[1]=fe.geta_centroid_pos1(Me))}if(L[0]===0&&L[1]===1)return!1;_.projection.name==="globe"&&(h=Gk([h],[new Dt(0,0),new Dt(Ut,Ut)],l.tileID.canonical).map(fe=>fe.polygon).flat());const Z=$?x:null,[K,ae]=function(fe,Me,De,Ve,He,Ze,_t,Je,bt,Mt,Tt){return fe.projection.name==="globe"?function(It,zt,mt,At,ct,rt,Bt,Ot,En,ln,pn){const Ht=[],Tn=[],qn=It.projection.upVectorScale(pn,It.center.lat,It.worldSize).metersToTile,Jt=[0,0,0,1],vn=[0,0,0,1],Fn=(gi,ii,un,Qn)=>{gi[0]=ii,gi[1]=un,gi[2]=Qn,gi[3]=1},Yn=Hk();mt>0&&(mt+=Yn),At+=Yn;for(const gi of zt){const ii=[],un=[];for(const Qn of gi){const Pi=Qn.x+ct.x,ge=Qn.y+ct.y,ye=It.projection.projectTilePoint(Pi,ge,pn),lt=It.projection.upVector(pn,Qn.x,Qn.y);let gt=mt,Xt=At;if(Bt){const Kt=Qk(Pi,ge,mt,At,Bt,Ot,En,ln);gt+=Kt.base,Xt+=Kt.top}mt!==0?Fn(Jt,ye.x+lt[0]*qn*gt,ye.y+lt[1]*qn*gt,ye.z+lt[2]*qn*gt):Fn(Jt,ye.x,ye.y,ye.z),Fn(vn,ye.x+lt[0]*qn*Xt,ye.y+lt[1]*qn*Xt,ye.z+lt[2]*qn*Xt),kn(Jt,Jt,rt),kn(vn,vn,rt),ii.push(new Am(Jt[0],Jt[1],Jt[2])),un.push(new Am(vn[0],vn[1],vn[2]))}Ht.push(ii),Tn.push(un)}return[Ht,Tn]}(fe,Me,De,Ve,He,Ze,_t,Je,bt,Mt,Tt):_t?function(It,zt,mt,At,ct,rt,Bt,Ot,En){const ln=[],pn=[],Ht=[0,0,0,1];for(const Tn of It){const qn=[],Jt=[];for(const vn of Tn){const Fn=vn.x+At.x,Yn=vn.y+At.y,gi=Qk(Fn,Yn,zt,mt,rt,Bt,Ot,En);Ht[0]=Fn,Ht[1]=Yn,Ht[2]=gi.base,Ht[3]=1,dn(Ht,Ht,ct),Ht[3]=Math.max(Ht[3],1e-5);const ii=new Am(Ht[0]/Ht[3],Ht[1]/Ht[3],Ht[2]/Ht[3]);Ht[0]=Fn,Ht[1]=Yn,Ht[2]=gi.top,Ht[3]=1,dn(Ht,Ht,ct),Ht[3]=Math.max(Ht[3],1e-5);const un=new Am(Ht[0]/Ht[3],Ht[1]/Ht[3],Ht[2]/Ht[3]);qn.push(ii),Jt.push(un)}ln.push(qn),pn.push(Jt)}return[ln,pn]}(Me,De,Ve,He,Ze,_t,Je,bt,Mt):function(It,zt,mt,At,ct){const rt=[],Bt=[],Ot=ct[8]*zt,En=ct[9]*zt,ln=ct[10]*zt,pn=ct[11]*zt,Ht=ct[8]*mt,Tn=ct[9]*mt,qn=ct[10]*mt,Jt=ct[11]*mt;for(const vn of It){const Fn=[],Yn=[];for(const gi of vn){const ii=gi.x+At.x,un=gi.y+At.y,Qn=ct[0]*ii+ct[4]*un+ct[12],Pi=ct[1]*ii+ct[5]*un+ct[13],ge=ct[2]*ii+ct[6]*un+ct[14],ye=ct[3]*ii+ct[7]*un+ct[15],lt=Qn+Ot,gt=Pi+En,Xt=ge+ln,Kt=Math.max(ye+pn,1e-5),cn=Qn+Ht,An=Pi+Tn,_i=ge+qn,vi=Math.max(ye+Jt,1e-5);Fn.push(new Am(lt/Kt,gt/Kt,Xt/Kt)),Yn.push(new Am(cn/vi,An/vi,_i/vi))}rt.push(Fn),Bt.push(Yn)}return[rt,Bt]}(Me,De,Ve,He,Ze)}(_,h,P,R,I,y,Z,L,j,_.center.lat,l.tileID.canonical),ue=l.queryGeometry;return function(fe,Me,De){let Ve=1/0;ol(De,Me)&&(Ve=Jk(De,Me[0]));for(let He=0;He<Me.length;He++){const Ze=Me[He],_t=fe[He];for(let Je=0;Je<Ze.length-1;Je++){const bt=Ze[Je],Mt=[bt,Ze[Je+1],_t[Je+1],_t[Je],bt];Dl(De,Mt)&&(Ve=Math.min(Ve,Jk(De,Mt)))}}return Ve!==1/0&&Ve}(K,ae,ue.isPointQuery()?ue.screenBounds:ue.screenGeometry)}},building:class extends ba{constructor(l,i,a,h){super(l,{layout:CR||(CR=new _o({visibility:new Vt(Ye.layout_building.visibility),"building-facade":new nn(Ye.layout_building["building-facade"]),"building-facade-floors":new nn(Ye.layout_building["building-facade-floors"]),"building-facade-unit-width":new nn(Ye.layout_building["building-facade-unit-width"]),"building-facade-window":new nn(Ye.layout_building["building-facade-window"]),"building-roof-shape":new nn(Ye.layout_building["building-roof-shape"]),"building-height":new nn(Ye.layout_building["building-height"]),"building-base":new nn(Ye.layout_building["building-base"]),"building-flood-light-wall-radius":new nn(Ye.layout_building["building-flood-light-wall-radius"]),"building-flood-light-ground-radius":new nn(Ye.layout_building["building-flood-light-ground-radius"]),"building-flip-roof-orientation":new nn(Ye.layout_building["building-flip-roof-orientation"])})),paint:TR||(TR=new _o({"building-opacity":new Vt(Ye.paint_building["building-opacity"]),"building-ambient-occlusion-intensity":new Vt(Ye.paint_building["building-ambient-occlusion-intensity"]),"building-ambient-occlusion-ground-intensity":new Vt(Ye.paint_building["building-ambient-occlusion-ground-intensity"]),"building-ambient-occlusion-ground-radius":new Vt(Ye.paint_building["building-ambient-occlusion-ground-radius"]),"building-ambient-occlusion-ground-attenuation":new Vt(Ye.paint_building["building-ambient-occlusion-ground-attenuation"]),"building-vertical-scale":new Vt(Ye.paint_building["building-vertical-scale"]),"building-cast-shadows":new Vt(Ye.paint_building["building-cast-shadows"]),"building-color":new nn(Ye.paint_building["building-color"]),"building-emissive-strength":new nn(Ye.paint_building["building-emissive-strength"]),"building-facade-emissive-chance":new Vt(Ye.paint_building["building-facade-emissive-chance"]),"building-cutoff-fade-range":new Vt(Ye.paint_building["building-cutoff-fade-range"]),"building-flood-light-color":new Vt(Ye.paint_building["building-flood-light-color"]),"building-flood-light-intensity":new Vt(Ye.paint_building["building-flood-light-intensity"]),"building-flood-light-ground-attenuation":new Vt(Ye.paint_building["building-flood-light-ground-attenuation"]),"building-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"building-flood-light-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},i,a,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(l){return new SR(l)}cutoffRange(){return this.paint.get("building-cutoff-fade-range")}hasShadowPass(){return this.paint.get("building-cast-shadows")}hasLightBeamPass(){return!0}canCastShadows(){return!0}is3D(l){return!0}},line:class extends ba{constructor(l,i,a,h){const f=LR();super(l,f,i,a,h),f.layout&&(this.layout=new Eh(f.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(l){if(l==="line-gradient"){const i=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=i._styleExpression&&i._styleExpression.expression instanceof Rl,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(l,i){super.recalculate(l,i),this.paint._values["line-floorwidth"]=(()=>{if(fv)return fv;const a=LR();return fv=new W9(a.paint.properties["line-width"].specification),fv.useIntegerZoom=!0,fv})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new jC(l)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(l,i,a){const h=DR(this);return{config:new Mh(this,{zoom:i,lut:a}),defines:h,overrideFog:!1}}queryRadius(l){const i=l,a=zR(kc("line-width",this,i),kc("line-gap-width",this,i)),h=kc("line-offset",this,i);return a/2+Math.abs(h)+zd(this.paint.get("line-translate"))}queryIntersectsFeature(l,i,a,h,f,_){if(l.queryGeometry.isAboveHorizon)return!1;const y=Bd(l.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,l.pixelToTileUnitsFactor),x=l.pixelToTileUnitsFactor/2*zR(this.paint.get("line-width").evaluate(i,a),this.paint.get("line-gap-width").evaluate(i,a)),C=this.paint.get("line-offset").evaluate(i,a);return C&&(h=function(I,R){const P=[],L=new Dt(0,0);for(let $=0;$<I.length;$++){const j=I[$],q=[];for(let Z=0;Z<j.length;Z++){const K=j[Z],ae=j[Z+1],ue=Z===0?L:K.sub(j[Z-1])._unit()._perp(),fe=Z===j.length-1?L:ae.sub(K)._unit()._perp(),Me=ue._add(fe)._unit();Me._mult(1/(Me.x*fe.x+Me.y*fe.y)),q.push(Me._mult(R)._add(K))}P.push(q)}return P}(h,C*l.pixelToTileUnitsFactor)),function(I,R,P){for(let L=0;L<R.length;L++){const $=R[L];if(I.length>=3){for(let j=0;j<$.length;j++)if(Os(I,$[j]))return!0}if(sl(I,$,P))return!0}return!1}(y,h,x)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(l){return!this.hasElevatedBuckets||this.layout&&this.layout.get("line-elevation-reference")==="hd-road-markup"}hasElevation(){return this.layout&&this.layout.get("line-elevation-reference")!=="none"}},symbol:G1,background:class extends ba{constructor(l,i,a,h){super(l,{layout:IP||(IP=new _o({visibility:new Vt(Ye.layout_background.visibility)})),paint:AP||(AP=new _o({"background-pitch-alignment":new Vt(Ye.paint_background["background-pitch-alignment"]),"background-color":new Vt(Ye.paint_background["background-color"]),"background-pattern":new Vt(Ye.paint_background["background-pattern"]),"background-opacity":new Vt(Ye.paint_background["background-opacity"]),"background-emissive-strength":new Vt(Ye.paint_background["background-emissive-strength"]),"background-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},i,a,h)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(l,i,a){return{overrideFog:!1}}is3D(l){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:DP,"raster-particle":NP,sky:class extends ba{constructor(l,i,a,h){super(l,{layout:zP||(zP=new _o({visibility:new Vt(Ye.layout_sky.visibility)})),paint:BP||(BP=new _o({"sky-type":new Vt(Ye.paint_sky["sky-type"]),"sky-atmosphere-sun":new Vt(Ye.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Vt(Ye.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Vt(Ye.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Vt(Ye.paint_sky["sky-gradient-radius"]),"sky-gradient":new $f(Ye.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Vt(Ye.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Vt(Ye.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Vt(Ye.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},i,a,h),this._updateColorRamp()}_clear(){this.skyboxFbo&&(this.skyboxFbo.destroy(),this.skyboxFbo=null),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null),this._skyboxInvalidated=!0}_handleSpecialPaintPropertyUpdate(l){l==="sky-gradient"?this._updateColorRamp():l!=="sky-atmosphere-sun"&&l!=="sky-atmosphere-halo-color"&&l!=="sky-atmosphere-color"&&l!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Xy({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(l){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const i=l.style.light.properties.get("position");return this._lightPosition.azimuthal!==i.azimuthal||this._lightPosition.polar!==i.polar}return!1}getCenter(l,i){if(this.paint.get("sky-type")==="atmosphere"){const h=this.paint.get("sky-atmosphere-sun"),f=!h,_=l.style.light,y=_.properties.get("position");return f&&_.properties.get("anchor")==="viewport"&&li("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),f?a2(y.azimuthal,90-y.polar,i):a2(h[0],90-h[1],i)}const a=this.paint.get("sky-gradient-center");return a2(a[0],90-a[1],i)}isSky(){return!0}markSkyboxValid(l){this._skyboxInvalidated=!1,this._lightPosition=l.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const l=this.paint.get("sky-type");return l==="atmosphere"?["skyboxCapture","skybox"]:l==="gradient"?["skyboxGradient"]:null}},slot:class extends ba{constructor(l,i,a,h){super(l,{paint:FP||(FP=new _o({}))},i,null)}},model:class extends ba{constructor(l,i,a,h){super(l,{layout:UP||(UP=new _o({visibility:new Vt(Ye.layout_model.visibility),"model-id":new nn(Ye.layout_model["model-id"])})),paint:HP||(HP=new _o({"model-opacity":new nn(Ye.paint_model["model-opacity"]),"model-rotation":new nn(Ye.paint_model["model-rotation"]),"model-scale":new nn(Ye.paint_model["model-scale"]),"model-translation":new nn(Ye.paint_model["model-translation"]),"model-color":new nn(Ye.paint_model["model-color"]),"model-color-mix-intensity":new nn(Ye.paint_model["model-color-mix-intensity"]),"model-type":new Vt(Ye.paint_model["model-type"]),"model-cast-shadows":new Vt(Ye.paint_model["model-cast-shadows"]),"model-receive-shadows":new Vt(Ye.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Vt(Ye.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new nn(Ye.paint_model["model-emissive-strength"]),"model-roughness":new nn(Ye.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new nn(Ye.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Vt(Ye.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Vt(Ye.paint_model["model-front-cutoff"]),"model-elevation-reference":new Vt(Ye.paint_model["model-elevation-reference"]),"model-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},i,a,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(l){return new c2(l)}getProgramIds(){return["model"]}is3D(l){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(l){return l instanceof K1?Ut-1:0}queryIntersectsFeature(l,i,a,h,f,_){if(!this.modelManager)return!1;const y=this.modelManager,x=l.tile.getBucket(this);if(!(x&&x instanceof c2))return!1;for(const C in x.instancesPerModel){const I=x.instancesPerModel[C],R=i.id!==void 0?i.id:i.properties&&i.properties.hasOwnProperty("id")?i.properties.id:void 0;if(I.idToFeaturesIndex.hasOwnProperty(R)){const P=I.features[I.idToFeaturesIndex[R]],L=y.getModel(C,this.scope);if(!L)return!1;let $=ee();const j=new W(0,0),q=x.canonical;let Z=Number.MAX_VALUE;for(let K=0;K<P.instancedDataCount;++K){const ae=16*(P.instancedDataOffset+K),ue=I.instancedDataArray.float32,fe=[ue[ae+4],ue[ae+5],ue[ae+6]];KP(q,j,ue[ae],0|ue[ae+1]),mR($,L,_,j,P.rotation,P.scale,fe,!1,!1,!1),_.projection.name==="globe"&&($=zC($,_));const Me=ce([],_.projMatrix,$),De=l.queryGeometry,Ve=pR(De.isPointQuery()?De.screenBounds:De.screenGeometry,_,Me,L.aabb);Ve!=null&&(Z=Math.min(Ve,Z))}return Z!==Number.MAX_VALUE&&Z}}return!1}_handleOverridablePaintPropertyUpdate(l,i,a){return!(!this.layout||i.isDataDriven()||a.isDataDriven()||l!=="model-color"&&l!=="model-color-mix-intensity"&&l!=="model-rotation"&&l!=="model-scale"&&l!=="model-translation"&&l!=="model-emissive-strength")}_isPropertyZoomDependent(l){const i=this._transitionablePaint._values[l];return i!=null&&i.value!=null&&i.value.expression!=null&&i.value.expression instanceof Us}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends ba{constructor(l,i,a,h){super(l,{layout:Ck||(Ck=new _o({"clip-layer-types":new Vt(Ye.layout_clip["clip-layer-types"]),"clip-layer-scope":new Vt(Ye.layout_clip["clip-layer-scope"])})),paint:Tk||(Tk=new _o({}))},i,a,h)}recalculate(l,i){super.recalculate(l,i)}createBucket(l){return new Ek(l)}is3D(l){return!0}}},d2=new Bi(0,0,0),h2={PATH_RULE_NON_ZERO:1,PATH_RULE_EVEN_ODD:2},f2={LINE_CAP_BUTT:1,LINE_CAP_ROUND:2,LINE_CAP_SQUARE:3},X1={LINE_JOIN_MITER:1,LINE_JOIN_MITER_CLIP:2,LINE_JOIN_ROUND:3,LINE_JOIN_BEVEL:4},KV={PAINT_ORDER_FILL_AND_STROKE:1},Ev={PATH_COMMAND_MOVE:1,PATH_COMMAND_LINE:2,PATH_COMMAND_QUAD:3,PATH_COMMAND_CUBIC:4,PATH_COMMAND_CLOSE:5},XP={MASK_TYPE_LUMINANCE:1};function XV(l,i,a){l===1&&i.icons.push(function(h,f){return function(_){if(_.usvg_tree.height||(_.usvg_tree.height=_.usvg_tree.width),!_.metadata)return _;const{metadata:y}=_;if(y.content_area){const{content_area:x}=y;x.left==null&&(x.left=0),x.top==null&&(x.top=x.left),x.width==null&&(x.width=_.usvg_tree.width),x.height==null&&(x.height=x.width)}if(y.text_placeholder){const{text_placeholder:x}=y;x.top==null&&(x.top=x.left),x.height==null&&(x.height=x.width)}return y.stretch_x&&y.stretch_x.length&&YP(y,"x"),y.stretch_y&&y.stretch_y.length&&YP(y,"y"),_}(h.readFields(YV,{name:void 0},f))}(a,a.readVarint()+a.pos))}function YP(l,i){const a=[],h=l[`stretch_${i}`];let f=null;for(let _=0;_<h.length;_++)f===null?f=a.length===0?h[0]:a[a.length-1][1]+h[_]:(a.push([f,f+h[_]]),f=null);l[`stretch_${i}_areas`]=a}function YV(l,i,a){l===1?i.name=a.readString():l===2?i.metadata=function(h,f){return h.readFields(JV,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},f)}(a,a.readVarint()+a.pos):l===3&&(i.usvg_tree=function(h,f){return h.readFields(t$,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},f)}(a,a.readVarint()+a.pos),i.data="usvg_tree")}function JV(l,i,a){l===1?i.stretch_x=a.readPackedVarint():l===2?i.stretch_y=a.readPackedVarint():l===3?i.content_area=JP(a,a.readVarint()+a.pos):l===4?i.variables.push(function(h,f){return h.readFields(e$,{name:void 0},f)}(a,a.readVarint()+a.pos)):l===5&&(i.text_placeholder=JP(a,a.readVarint()+a.pos))}function JP(l,i){return l.readFields(QV,{},i)}function QV(l,i,a){l===1?i.left=a.readVarint():l===2?i.width=a.readVarint():l===3?i.top=a.readVarint():l===4&&(i.height=a.readVarint())}function e$(l,i,a){l===1?i.name=a.readString():l===2&&(i.rgb_color=Q1(a.readVarint()),i.value="rgb_color")}function t$(l,i,a){l===1?i.width=i.height=a.readVarint():l===2?i.height=a.readVarint():l===3?i.children.push(Y1(a,a.readVarint()+a.pos)):l===4?i.linear_gradients.push(function(h,f){return h.readFields(l$,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},f)}(a,a.readVarint()+a.pos)):l===5?i.radial_gradients.push(function(h,f){return h.readFields(u$,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},f)}(a,a.readVarint()+a.pos)):l===7?i.clip_paths.push(function(h,f){return h.readFields(d$,{children:[]},f)}(a,a.readVarint()+a.pos)):l===8&&i.masks.push(function(h,f){const _=h.readFields(h$,{left:0,width:20,mask_type:XP.MASK_TYPE_LUMINANCE,children:[]},f);return _.height==null&&(_.height=_.width),_.top==null&&(_.top=_.left),_}(a,a.readVarint()+a.pos))}function Y1(l,i){return l.readFields(n$,{},i)}function n$(l,i,a){l===1?(i.group=function(h,f){return h.readFields(i$,{opacity:255,children:[]},f)}(a,a.readVarint()+a.pos),i.node="group"):l===2&&(i.path=function(h,f){return h.readFields(o$,{paint_order:1,commands:[],step:1,diffs:[],rule:h2.PATH_RULE_NON_ZERO},f)}(a,a.readVarint()+a.pos),i.node="path")}function i$(l,i,a){l===1?i.transform=J1(a,a.readVarint()+a.pos):l===2?i.opacity=a.readVarint():l===5?i.clip_path_idx=a.readVarint():l===6?i.mask_idx=a.readVarint():l===7&&i.children.push(Y1(a,a.readVarint()+a.pos))}function J1(l,i){return l.readFields(r$,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},i)}function r$(l,i,a){l===1?i.sx=a.readFloat():l===2?i.ky=a.readFloat():l===3?i.kx=a.readFloat():l===4?i.sy=a.readFloat():l===5?i.tx=a.readFloat():l===6&&(i.ty=a.readFloat())}function o$(l,i,a){l===1?i.fill=function(h,f){return h.readFields(s$,{rgb_color:d2,paint:"rgb_color",opacity:255},f)}(a,a.readVarint()+a.pos):l===2?i.stroke=function(h,f){return h.readFields(a$,{rgb_color:d2,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},f)}(a,a.readVarint()+a.pos):l===3?i.paint_order=a.readVarint():l===5?a.readPackedVarint(i.commands):l===6?i.step=a.readFloat():l===7?a.readPackedSVarint(i.diffs):l===8&&(i.rule=a.readVarint())}function s$(l,i,a){l===1?(i.rgb_color=Q1(a.readVarint()),i.paint="rgb_color"):l===2?(i.linear_gradient_idx=a.readVarint(),i.paint="linear_gradient_idx"):l===3?(i.radial_gradient_idx=a.readVarint(),i.paint="radial_gradient_idx"):l===5&&(i.opacity=a.readVarint())}function Q1(l){return new Bi((l>>16&255)/255,(l>>8&255)/255,(255&l)/255,1)}function a$(l,i,a){l===1?(i.rgb_color=Q1(a.readVarint()),i.paint="rgb_color"):l===2?(i.linear_gradient_idx=a.readVarint(),i.paint="linear_gradient_idx"):l===3?(i.radial_gradient_idx=a.readVarint(),i.paint="radial_gradient_idx"):l===5?a.readPackedFloat(i.dasharray):l===6?i.dashoffset=a.readFloat():l===7?i.miterlimit=a.readFloat():l===8?i.opacity=a.readVarint():l===9?i.width=a.readFloat():l===10?i.linecap=a.readVarint():l===11&&(i.linejoin=a.readVarint())}function l$(l,i,a){l===1?i.transform=J1(a,a.readVarint()+a.pos):l===2?i.spread_method=a.readVarint():l===3?i.stops.push(QP(a,a.readVarint()+a.pos)):l===4?i.x1=a.readFloat():l===5?i.y1=a.readFloat():l===6?i.x2=a.readFloat():l===7&&(i.y2=a.readFloat())}function QP(l,i){return l.readFields(c$,{offset:0,opacity:255,rgb_color:d2},i)}function c$(l,i,a){l===1?i.offset=a.readFloat():l===2?i.opacity=a.readVarint():l===3&&(i.rgb_color=Q1(a.readVarint()))}function u$(l,i,a){l===1?i.transform=J1(a,a.readVarint()+a.pos):l===2?i.spread_method=a.readVarint():l===3?i.stops.push(QP(a,a.readVarint()+a.pos)):l===4?i.cx=a.readFloat():l===5?i.cy=a.readFloat():l===6?i.r=a.readFloat():l===7?i.fx=a.readFloat():l===8?i.fy=a.readFloat():l===9&&(i.fr=a.readFloat())}function d$(l,i,a){l===1?i.transform=J1(a,a.readVarint()+a.pos):l===2?i.clip_path_idx=a.readVarint():l===3&&i.children.push(Y1(a,a.readVarint()+a.pos))}function h$(l,i,a){l===1?i.left=i.top=a.readFloat():l===2?i.width=i.height=a.readFloat():l===3?i.top=a.readFloat():l===4?i.height=a.readFloat():l===5?i.mask_type=a.readVarint():l===6?i.mask_idx=a.readVarint():l===7&&i.children.push(Y1(a,a.readVarint()+a.pos))}class f${static calculate(i={},a=[]){const h=new Map,f=new Map;if(Object.keys(i).length===0)return h;a.forEach(_=>{f.set(_.name,_.rgb_color||new Bi(0,0,0))});for(const[_,y]of Object.entries(i))f.has(_)?h.set(f.get(_).toString(),y):console.warn(`Ignoring unknown image variable "${_}"`);return h}}function b_(l,i=255,a){const h=i/255,f=l.toString(),_=a.has(f)?a.get(f).clone():l.clone();return _.a*=h,_.toString()}function Iv(l,i){if(!Sl()){const a=document.createElement("canvas");return a.width=l,a.height=i,a}return new OffscreenCanvas(l,i)}function p$(l,i){const a=f$.calculate(i.params,l.metadata?l.metadata.variables:[]),h=l.usvg_tree,f=h.width,_=h.height,y=i.transform?i.transform:new DOMMatrix,x=Math.max(1,Math.round(f*y.a)),C=Math.max(1,Math.round(_*y.d)),I=new DOMMatrix([x/f,0,0,C/_,0,0]),R=Iv(x,C).getContext("2d");return p2(R,I,h,h,a),R.getImageData(0,0,x,C)}function p2(l,i,a,h,f){for(const _ of h.children)eM(l,i,a,_,f)}function eM(l,i,a,h,f){h.group?(l.save(),function(_,y,x,C,I){const R=C.mask_idx!=null?x.masks[C.mask_idx]:null,P=C.clip_path_idx!=null?x.clip_paths[C.clip_path_idx]:null;if(C.transform&&(y=x_(C.transform).preMultiplySelf(y)),!function(j,q,Z){return j.opacity!==255||q||Z}(C,P!=null,R!=null))return void p2(_,y,x,C,I);const L=Iv(_.canvas.width,_.canvas.height),$=L.getContext("2d");p2($,y,x,C,I),P&&aM($,y,x,P),R&&lM($,y,x,R,I),_.globalAlpha=C.opacity/255,_.drawImage(L,0,0)}(l,i,a,h.group,f),l.restore()):h.path&&(l.save(),function(_,y,x,C,I){_.setTransform(y),C.paint_order===KV.PAINT_ORDER_FILL_AND_STROKE?(tM(_,x,C,I),iM(_,x,C,I)):(iM(_,x,C,I),tM(_,x,C,I))}(l,i,a,h.path,f),l.restore())}function tM(l,i,a,h){const f=a.fill;if(!f)return;const _=f.opacity/255;switch(l.save(),l.beginPath(),cM(a,l),f.paint){case"rgb_color":l.fillStyle=b_(f.rgb_color,f.opacity,h);break;case"linear_gradient_idx":{const y=i.linear_gradients[f.linear_gradient_idx];y.transform&&l.setTransform(x_(y.transform).preMultiplySelf(l.getTransform())),l.fillStyle=rM(l,y,_,h);break}case"radial_gradient_idx":{const y=i.radial_gradients[f.radial_gradient_idx];y.transform&&l.setTransform(x_(y.transform).preMultiplySelf(l.getTransform())),l.fillStyle=oM(l,y,_,h)}}l.fill(nM(a)),l.restore()}function nM(l){return l.rule===h2.PATH_RULE_NON_ZERO?"nonzero":l.rule===h2.PATH_RULE_EVEN_ODD?"evenodd":void 0}function iM(l,i,a,h){const f=a.stroke;if(!f)return;const _=uM(a);l.lineWidth=f.width,l.miterLimit=f.miterlimit,l.setLineDash(f.dasharray),l.lineDashOffset=f.dashoffset;const y=f.opacity/255;switch(f.paint){case"rgb_color":l.strokeStyle=b_(f.rgb_color,f.opacity,h);break;case"linear_gradient_idx":l.strokeStyle=rM(l,i.linear_gradients[f.linear_gradient_idx],y,h,!0);break;case"radial_gradient_idx":l.strokeStyle=oM(l,i.radial_gradients[f.radial_gradient_idx],y,h,!0)}switch(f.linejoin){case X1.LINE_JOIN_MITER_CLIP:case X1.LINE_JOIN_MITER:l.lineJoin="miter";break;case X1.LINE_JOIN_ROUND:l.lineJoin="round";break;case X1.LINE_JOIN_BEVEL:l.lineJoin="bevel"}switch(f.linecap){case f2.LINE_CAP_BUTT:l.lineCap="butt";break;case f2.LINE_CAP_ROUND:l.lineCap="round";break;case f2.LINE_CAP_SQUARE:l.lineCap="square"}l.stroke(_)}function rM(l,i,a,h,f=!1){if(i.stops.length===1){const L=i.stops[0];return b_(L.rgb_color,L.opacity*a,h)}const{x1:_,y1:y,x2:x,y2:C}=i;let I=new DOMPoint(_,y),R=new DOMPoint(x,C);if(f){const L=x_(i.transform);I=L.transformPoint(I),R=L.transformPoint(R)}const P=l.createLinearGradient(I.x,I.y,R.x,R.y);for(const L of i.stops)P.addColorStop(L.offset,b_(L.rgb_color,L.opacity*a,h));return P}function oM(l,i,a,h,f=!1){if(i.stops.length===1){const K=i.stops[0];return b_(K.rgb_color,K.opacity*a,h)}const _=x_(i.transform),{fx:y,fy:x,fr:C,cx:I,cy:R,r:P}=i;let L=new DOMPoint(y,x),$=new DOMPoint(I,R),j=C,q=P;if(f){L=_.transformPoint(L),$=_.transformPoint($);const K=(_.a+_.d)/2;j=C*K,q=i.r*K}const Z=l.createRadialGradient(L.x,L.y,j,$.x,$.y,q);for(const K of i.stops)Z.addColorStop(K.offset,b_(K.rgb_color,K.opacity*a,h));return Z}function sM(l,i,a,h){const f=h.transform?x_(h.transform).preMultiplySelf(i):i,_=Iv(l.canvas.width,l.canvas.height),y=_.getContext("2d");for(const C of h.children)if(C.group)sM(y,f,a,C.group);else if(C.path){const I=C.path,R=new Path2D;R.addPath(uM(I),f),y.fill(R,nM(I))}const x=h.clip_path_idx!=null?a.clip_paths[h.clip_path_idx]:null;x&&aM(y,f,a,x),l.globalCompositeOperation="source-over",l.drawImage(_,0,0)}function aM(l,i,a,h){const f=Iv(l.canvas.width,l.canvas.height);sM(f.getContext("2d"),i,a,h),l.globalCompositeOperation="destination-in",l.drawImage(f,0,0)}function lM(l,i,a,h,f){if(h.children.length===0)return;const _=h.mask_idx!=null?a.masks[h.mask_idx]:null;_&&lM(l,i,a,_,f);const y=l.canvas.width,x=l.canvas.height,C=Iv(y,x),I=C.getContext("2d"),R=h.width,P=h.height,L=h.left,$=h.top,j=new Path2D,q=new Path2D;q.rect(L,$,R,P),j.addPath(q,i),I.clip(j);for(const ae of h.children)eM(I,i,a,ae,f);const Z=I.getImageData(0,0,y,x),K=Z.data;if(h.mask_type===XP.MASK_TYPE_LUMINANCE)for(let ae=0;ae<K.length;ae+=4)K[ae+3]=K[ae+3]/255*(.2126*K[ae]+.7152*K[ae+1]+.0722*K[ae+2]);I.putImageData(Z,0,0),l.globalCompositeOperation="destination-in",l.drawImage(C,0,0)}function x_(l){return l?new DOMMatrix([l.sx,l.ky,l.kx,l.sy,l.tx,l.ty]):new DOMMatrix}function cM(l,i){const a=l.step;let h=l.diffs[0]*a,f=l.diffs[1]*a;i.moveTo(h,f);for(let _=0,y=2;_<l.commands.length;_++)switch(l.commands[_]){case Ev.PATH_COMMAND_MOVE:h+=l.diffs[y++]*a,f+=l.diffs[y++]*a,i.moveTo(h,f);break;case Ev.PATH_COMMAND_LINE:h+=l.diffs[y++]*a,f+=l.diffs[y++]*a,i.lineTo(h,f);break;case Ev.PATH_COMMAND_QUAD:{const x=h+l.diffs[y++]*a,C=f+l.diffs[y++]*a;h=x+l.diffs[y++]*a,f=C+l.diffs[y++]*a,i.quadraticCurveTo(x,C,h,f);break}case Ev.PATH_COMMAND_CUBIC:{const x=h+l.diffs[y++]*a,C=f+l.diffs[y++]*a,I=x+l.diffs[y++]*a,R=C+l.diffs[y++]*a;h=I+l.diffs[y++]*a,f=R+l.diffs[y++]*a,i.bezierCurveTo(x,C,I,R,h,f);break}case Ev.PATH_COMMAND_CLOSE:i.closePath()}return i}function uM(l){return cM(l,new Path2D)}class ex{constructor(i){this.capacity=i,this.cache=new Map}get(i){if(!this.cache.has(i))return;const a=this.cache.get(i);return this.cache.delete(i),this.cache.set(i,a),a}put(i,a){this.cache.has(i)?this.cache.delete(i):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(i,a)}delete(i){this.cache.delete(i)}}en(ex,"LRUCache");class m2{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(i){return new la(i,i.data)}getFromCache(i,a,h){return this.cacheMap.has(h)||this.cacheMap.set(h,new ex(150)),this.cacheMap.get(h).get(Uf(i.toString(),a))}setInCache(i,a,h,f){this.cacheDependenciesMap.has(f)||this.cacheDependenciesMap.set(f,new Map),this.cacheMap.has(f)||this.cacheMap.set(f,new ex(150));const _=this.cacheDependenciesMap.get(f),y=Uf(i.id.toString(),h);_.get(y)||_.set(y,new Set);const x=this.cacheMap.get(f),C=i.toString();_.get(y).add(C),x.put(Uf(i.toString(),h),a)}removeImagesFromCacheByIds(i,a,h=0){if(!this.cacheMap.has(h)||!this.cacheDependenciesMap.has(h))return;const f=this.cacheMap.get(h),_=this.cacheDependenciesMap.get(h);for(const y of i){const x=Uf(y.toString(),a);if(_.has(x)){for(const C of _.get(x))f.delete(C);_.delete(x)}}}rasterize(i,a,h,f,_=p$){const y=this.getFromCache(i,h,f);if(y)return y.clone();const x=_(a.icon,i.options),C=m2._getImage(x);return this.setInCache(i,C,h,f),C.clone()}}class dM{constructor(i){this.size=i,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(i,a){const h=this.toIdx(i,a);return{min:this.minimums[h],max:this.maximums[h]}}isLeaf(i,a){return this.leaves[this.toIdx(i,a)]}toIdx(i,a){return a*this.size+i}}function hM(l,i,a,h){let f=0,_=Number.MAX_VALUE;for(let y=0;y<3;y++)if(Math.abs(h[y])<1e-15){if(a[y]<l[y]||a[y]>i[y])return null}else{const x=1/h[y];let C=(l[y]-a[y])*x,I=(i[y]-a[y])*x;if(C>I){const R=C;C=I,I=R}if(C>f&&(f=C),I<_&&(_=I),f>_)return null}return f}function fM(l,i,a,h,f,_,y,x,C,I,R){const P=h-l,L=f-i,$=_-a,j=y-l,q=x-i,Z=C-a,K=R[1]*Z-R[2]*q,ae=R[2]*j-R[0]*Z,ue=R[0]*q-R[1]*j,fe=P*K+L*ae+$*ue;if(Math.abs(fe)<1e-15)return null;const Me=1/fe,De=I[0]-l,Ve=I[1]-i,He=I[2]-a,Ze=(De*K+Ve*ae+He*ue)*Me;if(Ze<0||Ze>1)return null;const _t=Ve*$-He*L,Je=He*P-De*$,bt=De*L-Ve*P,Mt=(R[0]*_t+R[1]*Je+R[2]*bt)*Me;return Mt<0||Ze+Mt>1?null:(j*_t+q*Je+Z*bt)*Me}function pM(l,i,a){return(l-i)/(a-i)}function mM(l,i,a,h,f,_,y,x,C){const I=1<<a,R=_-h,P=y-f,L=(l+1)/I*R+h,$=(i+0)/I*P+f,j=(i+1)/I*P+f;x[0]=(l+0)/I*R+h,x[1]=$,C[0]=L,C[1]=j}class gM{constructor(i){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=i,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const a=function(_){const y=Math.ceil(Math.log2(_.dim/8)),x=[];let C=Math.ceil(Math.pow(2,y));const I=1/C,R=($,j,q,Z,K)=>{const ae=Z?1:0,ue=($+1)*q-ae,fe=j*q,Me=(j+1)*q-ae;K[0]=$*q,K[1]=fe,K[2]=ue,K[3]=Me};let P=new dM(C);const L=[];for(let $=0;$<C*C;$++){R($%C,Math.floor($/C),I,!1,L);const j=op(L[0],L[1],_),q=op(L[2],L[1],_),Z=op(L[2],L[3],_),K=op(L[0],L[3],_);P.minimums.push(Math.min(j,q,Z,K)),P.maximums.push(Math.max(j,q,Z,K)),P.leaves.push(1)}for(x.push(P),C/=2;C>=1;C/=2){const $=x[x.length-1];P=new dM(C);for(let j=0;j<C*C;j++){R(j%C,Math.floor(j/C),2,!0,L);const q=$.getElevation(L[0],L[1]),Z=$.getElevation(L[2],L[1]),K=$.getElevation(L[2],L[3]),ae=$.getElevation(L[0],L[3]),ue=$.isLeaf(L[0],L[1]),fe=$.isLeaf(L[2],L[1]),Me=$.isLeaf(L[2],L[3]),De=$.isLeaf(L[0],L[3]),Ve=Math.min(q.min,Z.min,K.min,ae.min),He=Math.max(q.max,Z.max,K.max,ae.max),Ze=ue&&fe&&Me&&De;P.maximums.push(He),P.minimums.push(Ve),P.leaves.push(He-Ve<=5&&Ze?1:0)}x.push(P)}return x}(this.dem),h=a.length-1,f=a[h];this._addNode(f.minimums[0],f.maximums[0],f.leaves[0]),this._construct(a,0,0,h,0)}raycastRoot(i,a,h,f,_,y,x=1){return hM([i,a,-100],[h,f,this.maximums[0]*x],_,y)}raycast(i,a,h,f,_,y,x=1){if(!this.nodeCount)return null;const C=this.raycastRoot(i,a,h,f,_,y,x);if(C==null)return null;const I=[],R=[],P=[],L=[],$=[{idx:0,t:C,nodex:0,nodey:0,depth:0}];for(;$.length>0;){const{idx:j,t:q,nodex:Z,nodey:K,depth:ae}=$.pop();if(this.leaves[j]){mM(Z,K,ae,i,a,h,f,P,L);const fe=1<<ae,Me=(Z+0)/fe,De=(Z+1)/fe,Ve=(K+0)/fe,He=(K+1)/fe,Ze=op(Me,Ve,this.dem)*x,_t=op(De,Ve,this.dem)*x,Je=op(De,He,this.dem)*x,bt=op(Me,He,this.dem)*x,Mt=fM(P[0],P[1],Ze,L[0],P[1],_t,L[0],L[1],Je,_,y),Tt=fM(L[0],L[1],Je,P[0],L[1],bt,P[0],P[1],Ze,_,y),It=Math.min(Mt!==null?Mt:Number.MAX_VALUE,Tt!==null?Tt:Number.MAX_VALUE);if(It!==Number.MAX_VALUE)return It;{const zt=Di([],_,y,q);if(_M(Ze,_t,bt,Je,pM(zt[0],P[0],L[0]),pM(zt[1],P[1],L[1]))>=zt[2])return q}continue}let ue=0;for(let fe=0;fe<this._siblingOffset.length;fe++){mM((Z<<1)+this._siblingOffset[fe][0],(K<<1)+this._siblingOffset[fe][1],ae+1,i,a,h,f,P,L),P[2]=-100,L[2]=this.maximums[this.childOffsets[j]+fe]*x;const Me=hM(P,L,_,y);if(Me!=null){const De=Me;I[fe]=De;let Ve=!1;for(let He=0;He<ue&&!Ve;He++)De>=I[R[He]]&&(R.splice(He,0,fe),Ve=!0);Ve||(R[ue]=fe),ue++}}for(let fe=0;fe<ue;fe++){const Me=R[fe];$.push({idx:this.childOffsets[j]+Me,t:I[Me],nodex:(Z<<1)+this._siblingOffset[Me][0],nodey:(K<<1)+this._siblingOffset[Me][1],depth:ae+1})}}return null}_addNode(i,a,h){return this.minimums.push(i),this.maximums.push(a),this.leaves.push(h),this.childOffsets.push(0),this.nodeCount++}_construct(i,a,h,f,_){if(i[f].isLeaf(a,h)===1)return;this.childOffsets[_]||(this.childOffsets[_]=this.nodeCount);const y=f-1,x=i[y];let C=0,I=0;for(let R=0;R<this._siblingOffset.length;R++){const P=2*a+this._siblingOffset[R][0],L=2*h+this._siblingOffset[R][1],$=x.getElevation(P,L),j=x.isLeaf(P,L),q=this._addNode($.min,$.max,j);j&&(C|=1<<R),I||(I=q)}for(let R=0;R<this._siblingOffset.length;R++)C&1<<R||this._construct(i,2*a+this._siblingOffset[R][0],2*h+this._siblingOffset[R][1],y,I+R)}}function _M(l,i,a,h,f,_){return Pn(Pn(l,a,_),Pn(i,h,_),f)}function op(l,i,a){const h=a.dim,f=Le(l*h-.5,0,h-1),_=Le(i*h-.5,0,h-1),y=Math.floor(f),x=Math.floor(_),C=Math.min(y+1,h-1),I=Math.min(x+1,h-1);return _M(a.get(y,x),a.get(C,x),a.get(y,I),a.get(C,I),f-y,_-x)}const m$={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function g$(l,i,a){return(256*l*256+256*i+a)/10-1e4}function _$(l,i,a){return 256*l+i+a/256-32768}class tx{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(i,a,h,f=!1){if(this.uid=i,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(h&&h!=="mapbox"&&h!=="terrarium")return void li(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=a.height;const _=this.dim=a.height-2,y=new Uint32Array(a.data.buffer);if(this.pixels=new Uint8Array(a.data.buffer),this.floatView=new Float32Array(a.data.buffer),this.borderReady=f,this._modifiedForSources={},!f){for(let C=0;C<_;C++)y[this._idx(-1,C)]=y[this._idx(0,C)],y[this._idx(_,C)]=y[this._idx(_-1,C)],y[this._idx(C,-1)]=y[this._idx(C,0)],y[this._idx(C,_)]=y[this._idx(C,_-1)];y[this._idx(-1,-1)]=y[this._idx(0,0)],y[this._idx(_,-1)]=y[this._idx(_-1,0)],y[this._idx(-1,_)]=y[this._idx(0,_-1)],y[this._idx(_,_)]=y[this._idx(_-1,_-1)]}const x=h==="terrarium"?_$:g$;for(let C=0;C<y.length;++C){const I=4*C;this.floatView[C]=x(this.pixels[I],this.pixels[I+1],this.pixels[I+2])}this._timestamp=Ko.now()}_buildQuadTree(){this._tree=new gM(this)}get(i,a,h=!1){h&&(i=Le(i,-1,this.dim),a=Le(a,-1,this.dim));const f=this._idx(i,a);return this.floatView[f]}set(i,a,h){const f=this._idx(i,a),_=this.floatView[f];return this.floatView[f]=h,h-_}static getUnpackVector(i){return m$[i]}_idx(i,a){if(i<-1||i>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(i+1)}static pack(i,a){const h=[0,0,0,0],f=tx.getUnpackVector(a);let _=Math.floor((i+f[3])/f[2]);return h[2]=_%256,_=Math.floor(_/256),h[1]=_%256,_=Math.floor(_/256),h[0]=_,h}getPixels(){return new uk({width:this.stride,height:this.stride},this.pixels)}backfillBorder(i,a,h){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let f=a*this.dim,_=a*this.dim+this.dim,y=h*this.dim,x=h*this.dim+this.dim;switch(a){case-1:f=_-1;break;case 1:_=f+1}switch(h){case-1:y=x-1;break;case 1:x=y+1}const C=-a*this.dim,I=-h*this.dim;for(let R=y;R<x;R++)for(let P=f;P<_;P++){const L=4*this._idx(P,R),$=4*this._idx(P+C,R+I);this.pixels[L+0]=i.pixels[$+0],this.pixels[L+1]=i.pixels[$+1],this.pixels[L+2]=i.pixels[$+2],this.pixels[L+3]=i.pixels[$+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function y$(l,i,a){l===1?i.headerLength=a.readFixed32():l===2?i.x=a.readVarint():l===3?i.y=a.readVarint():l===4?i.z=a.readVarint():l===5&&i.layers.push(function(h,f){return h.readFields(S$,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},f)}(a,a.readVarint()+a.pos))}function v$(l,i,a){l===1?(i.delta_filter=function(h,f){return h.readFields(b$,{blockSize:0},f)}(a,a.readVarint()+a.pos),i.filter="delta_filter"):l===2?(a.readVarint(),i.filter="zigzag_filter"):l===3?(a.readVarint(),i.filter="bitshuffle_filter"):l===4&&(a.readVarint(),i.filter="byteshuffle_filter")}function b$(l,i,a){l===1&&(i.blockSize=a.readVarint())}function x$(l,i,a){l===1?(a.readVarint(),i.codec="gzip_data"):l===2?(a.readVarint(),i.codec="jpeg_image"):l===3?(a.readVarint(),i.codec="webp_image"):l===4&&(a.readVarint(),i.codec="png_image")}function w$(l,i,a){let h=0,f=0;l===1?i.firstByte=a.readFixed64():l===2?i.lastByte=a.readFixed64():l===3?i.filters.push(function(_,y){return _.readFields(v$,{},y)}(a,a.readVarint()+a.pos)):l===4?i.codec=function(_,y){return _.readFields(x$,{},y)}(a,a.readVarint()+a.pos):l===5?f=a.readFloat():l===6?h=a.readFloat():l===7?i.bands.push(a.readString()):l===8?i.offset=a.readDouble():l===9&&(i.scale=a.readDouble()),i.offset===0&&(i.offset=f),i.scale===0&&(i.scale=h)}function S$(l,i,a){l===1?i.version=a.readVarint():l===2?i.name=a.readString():l===3?i.units=a.readString():l===4?i.tileSize=a.readVarint():l===5?i.buffer=a.readVarint():l===6?i.pixelFormat=a.readVarint():l===7&&i.dataIndex.push(function(h,f){return h.readFields(w$,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},f)}(a,a.readVarint()+a.pos))}function C$(l,i,a){if(l===2)(function(h,f,_){h.readFields(T$,_,f)})(a,a.readVarint()+a.pos,i);else if(l===3)throw new Error("Not implemented")}function T$(l,i,a){if(l===1){let h=0;const f=a.readVarint()+a.pos;for(;a.pos<f;)i[h++]=a.readVarint()}}function E$(l,i){if(i.length!==4)throw new Error(`Expected data of dimension 4 but got ${i.length}.`);let a=i[3];for(let h=2;h>=1;h--){const f=h===1?1:0,_=h===2?1:0;for(let y=0;y<i[0];y++){const x=i[1]*y;for(let C=f;C<i[1];C++){const I=i[2]*(C+x);for(let R=_;R<i[2];R++){const P=i[3]*(R+I);for(let L=0;L<i[3];L++){const $=P+L;l[$]+=l[$-a]}}}}a*=i[h]}return l}function I$(l){for(let i=0,a=l.length;i<a;i++)l[i]=l[i]>>>1^-(1&l[i]);return l}function A$(l,i){switch(i){case"uint32":return l;case"uint16":for(let a=0;a<l.length;a+=2){const h=l[a],f=l[a+1];l[a]=(240&h)>>4|(61440&h)>>8|(240&f)<<4|61440&f,l[a+1]=15&h|(3840&h)>>4|(15&f)<<8|(3840&f)<<4}return l;case"uint8":for(let a=0;a<l.length;a+=4){const h=l[a],f=l[a+1],_=l[a+2],y=l[a+3];l[a+0]=(192&h)>>6|(192&f)>>4|(192&_)>>2|192&y,l[a+1]=(48&h)>>4|(48&f)>>2|48&_|(48&y)<<2,l[a+2]=(12&h)>>2|12&f|(12&_)<<2|(12&y)<<4,l[a+3]=3&h|(3&f)<<2|(3&_)<<4|(3&y)<<6}return l;default:throw new Error(`Invalid pixel format, "${i}"`)}}en(tx,"DEMData"),en(gM,"DemMinMaxQuadTree",{omit:["dem"]});var Rc=Uint8Array,Av=Uint16Array,k$=Int32Array,yM=new Rc([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),vM=new Rc([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),R$=new Rc([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),bM=function(l,i){for(var a=new Av(31),h=0;h<31;++h)a[h]=i+=1<<l[h-1];var f=new k$(a[30]);for(h=1;h<30;++h)for(var _=a[h];_<a[h+1];++_)f[_]=_-a[h]<<5|h;return{b:a,r:f}},xM=bM(yM,2),wM=xM.b,P$=xM.r;wM[28]=258,P$[258]=28;for(var M$=bM(vM,0).b,SM=new Av(32768),xs=0;xs<32768;++xs){var w_=(43690&xs)>>1|(21845&xs)<<1;SM[xs]=((65280&(w_=(61680&(w_=(52428&w_)>>2|(13107&w_)<<2))>>4|(3855&w_)<<4))>>8|(255&w_)<<8)>>1}var kv=function(l,i,a){for(var h=l.length,f=0,_=new Av(i);f<h;++f)l[f]&&++_[l[f]-1];var y,x=new Av(i);for(f=1;f<i;++f)x[f]=x[f-1]+_[f-1]<<1;y=new Av(1<<i);var C=15-i;for(f=0;f<h;++f)if(l[f])for(var I=f<<4|l[f],R=i-l[f],P=x[l[f]-1]++<<R,L=P|(1<<R)-1;P<=L;++P)y[SM[P]>>C]=I;return y},Rv=new Rc(288);for(xs=0;xs<144;++xs)Rv[xs]=8;for(xs=144;xs<256;++xs)Rv[xs]=9;for(xs=256;xs<280;++xs)Rv[xs]=7;for(xs=280;xs<288;++xs)Rv[xs]=8;var CM=new Rc(32);for(xs=0;xs<32;++xs)CM[xs]=5;var D$=kv(Rv,9),O$=kv(CM,5),g2=function(l){for(var i=l[0],a=1;a<l.length;++a)l[a]>i&&(i=l[a]);return i},Xu=function(l,i,a){var h=i/8|0;return(l[h]|l[h+1]<<8)>>(7&i)&a},_2=function(l,i){var a=i/8|0;return(l[a]|l[a+1]<<8|l[a+2]<<16)>>(7&i)},L$=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Yu=function(l,i,a){var h=new Error(i||L$[l]);if(h.code=l,Error.captureStackTrace&&Error.captureStackTrace(h,Yu),!a)throw h;return h},z$=new Rc(0),B$=typeof TextDecoder<"u"&&new TextDecoder;try{B$.decode(z$,{stream:!0})}catch{}const F$={gzip_data:"gzip"};class du extends Error{constructor(i){super(i),this.name="MRTError"}}const N$={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},TM={uint32:1,uint16:2,uint8:4},V$={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let y2;class nx{constructor(i=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=i}getLayer(i){const a=this.layers[i];if(!a)throw new du(`Layer '${i}' not found`);return a}getHeaderLength(i){const a=new Uint8Array(i),h=new DataView(i);if(a[0]!==13)throw new du("File is not a valid MRT.");return h.getUint32(1,!0)}parseHeader(i){const a=new Uint8Array(i),h=this.getHeaderLength(i);if(a.length<h)throw new du(`Expected header with length >= ${h} but got buffer of length ${a.length}`);const f=new y2(a.subarray(0,h)).readFields(y$,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0);if(!isNaN(this.x)&&(this.x!==f.x||this.y!==f.y||this.z!==f.z))throw new du(`Invalid attempt to parse header ${f.z}/${f.x}/${f.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=f.x,this.y=f.y,this.z=f.z;for(const _ of f.layers)this.layers[_.name]=new EM(_,{cacheSize:this._cacheSize});return this}createDecodingTask(i){const a=[],h=this.getLayer(i.layerName);for(let f of i.blockIndices){const _=h.dataIndex[f],y=_.firstByte-i.firstByte,x=_.lastByte-i.firstByte;if(h._blocksInProgress.has(f))continue;const C={layerName:h.name,firstByte:y,lastByte:x,pixelFormat:h.pixelFormat,blockIndex:f,blockShape:[_.bands.length].concat(h.bandShape),buffer:h.buffer,codec:_.codec.codec,filters:_.filters.map(I=>I.filter)};h._blocksInProgress.add(f),a.push(C)}return new IM(a,()=>{a.forEach(f=>h._blocksInProgress.delete(f.blockIndex))},(f,_)=>{if(a.forEach(y=>h._blocksInProgress.delete(y.blockIndex)),f)throw f;_.forEach(y=>{this.getLayer(y.layerName).processDecodedData(y)})})}}class EM{constructor({version:i,name:a,units:h,tileSize:f,pixelFormat:_,buffer:y,dataIndex:x},C){if(this.version=i,this.version!==1)throw new du(`Cannot parse raster layer encoded with MRT version ${i}`);this.name=a,this.units=h,this.tileSize=f,this.buffer=y,this.pixelFormat=N$[_],this.dataIndex=x,this.bandShape=[f+2*y,f+2*y,TM[this.pixelFormat]],this._decodedBlocks=new ex(C?C.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return TM[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:i})=>i).flat()}processDecodedData(i){const a=i.blockIndex.toString();this._decodedBlocks.get(a)||this._decodedBlocks.put(a,i.data)}getBlockForBand(i){let a=0;switch(typeof i){case"string":for(const[h,f]of this.dataIndex.entries()){for(const[_,y]of f.bands.entries())if(y===i)return{bandIndex:a+_,blockIndex:h,blockBandIndex:_};a+=f.bands.length}break;case"number":for(const[h,f]of this.dataIndex.entries()){if(i>=a&&i<a+f.bands.length)return{bandIndex:i,blockIndex:h,blockBandIndex:i-a};a+=f.bands.length}break;default:throw new du(`Invalid band \`${JSON.stringify(i)}\`. Expected string or integer.`)}return{blockIndex:-1,blockBandIndex:-1}}getDataRange(i){let a=1/0,h=-1/0;const f=[],_=new Set;for(const y of i){const{blockIndex:x}=this.getBlockForBand(y);if(x<0)throw new du(`Invalid band: ${JSON.stringify(y)}`);const C=this.dataIndex[x];f.includes(x)||f.push(x),_.add(x),a=Math.min(a,C.firstByte),h=Math.max(h,C.lastByte)}if(_.size>this.cacheSize)throw new du(`Number of blocks to decode (${_.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:a,lastByte:h,blockIndices:f}}hasBand(i){const{blockIndex:a}=this.getBlockForBand(i);return a>=0}hasDataForBand(i){const{blockIndex:a}=this.getBlockForBand(i);return a>=0&&!!this._decodedBlocks.get(a.toString())}getBandView(i){const{blockIndex:a,blockBandIndex:h}=this.getBlockForBand(i);if(a<0)throw new du(`Band not found: ${JSON.stringify(i)}`);const f=this._decodedBlocks.get(a.toString());if(!f)throw new du(`Data for band ${JSON.stringify(i)} of layer "${this.name}" not decoded.`);const _=this.dataIndex[a],y=this.bandShape.reduce((I,R)=>I*R,1),x=h*y,C=f.subarray(x,x+y);return{data:C,bytes:new Uint8Array(C.buffer).subarray(C.byteOffset,C.byteOffset+C.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:_.offset,scale:_.scale}}}nx.setPbf=function(l){y2=l};class IM{constructor(i,a,h){this.tasks=i,this._onCancel=a,this._onComplete=h,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(i,a){this._finalized||(this._onComplete(i,a),this._finalized=!0)}}nx.performDecoding=function(l,i){const a=new Uint8Array(l);return Promise.all(i.tasks.map(h=>{const{layerName:f,firstByte:_,lastByte:y,pixelFormat:x,blockShape:C,blockIndex:I,filters:R,codec:P}=h,L=a.subarray(_,y+1),$=new Uint32Array(C[0]*C[1]*C[2]);let j;if(P!=="gzip_data")throw new du(`Unhandled codec: ${P}`);return j=function(q,Z){if(!globalThis.DecompressionStream&&Z==="gzip_data")return Promise.resolve(((fe=function(Ve){Ve[0]==31&&Ve[1]==139&&Ve[2]==8||Yu(6,"invalid gzip data");var He=Ve[3],Ze=10;4&He&&(Ze+=2+(Ve[10]|Ve[11]<<8));for(var _t=(He>>3&1)+(He>>4&1);_t>0;_t-=!Ve[Ze++]);return Ze+(2&He)}(ue=q))+8>ue.length&&Yu(6,"invalid gzip data"),function(Ve,He,Ze,_t){var Je=Ve.length;if(!Je||He.f&&!He.l)return Ze||new Rc(0);var bt=!Ze,Mt=bt||He.i!=2,Tt=He.i;bt&&(Ze=new Rc(3*Je));var It,zt,mt=function(Or){var Lr=Ze.length;if(Or>Lr){var Er=new Rc(Math.max(2*Lr,Or));Er.set(Ze),Ze=Er}},At=He.f||0,ct=He.p||0,rt=He.b||0,Bt=He.l,Ot=He.d,En=He.m,ln=He.n,pn=8*Je;do{if(!Bt){At=Xu(Ve,ct,1);var Ht=Xu(Ve,ct+1,3);if(ct+=3,!Ht){var Tn=Ve[(ge=4+((ct+7)/8|0))-4]|Ve[ge-3]<<8,qn=ge+Tn;if(qn>Je){Tt&&Yu(0);break}Mt&&mt(rt+Tn),Ze.set(Ve.subarray(ge,qn),rt),He.b=rt+=Tn,He.p=ct=8*qn,He.f=At;continue}if(Ht==1)Bt=D$,Ot=O$,En=9,ln=5;else if(Ht==2){var Jt=Xu(Ve,ct,31)+257,vn=Xu(Ve,ct+10,15)+4,Fn=Jt+Xu(Ve,ct+5,31)+1;ct+=14;for(var Yn=new Rc(Fn),gi=new Rc(19),ii=0;ii<vn;++ii)gi[R$[ii]]=Xu(Ve,ct+3*ii,7);ct+=3*vn;var un=g2(gi),Qn=(1<<un)-1,Pi=kv(gi,un);for(ii=0;ii<Fn;){var ge,ye=Pi[Xu(Ve,ct,Qn)];if(ct+=15&ye,(ge=ye>>4)<16)Yn[ii++]=ge;else{var lt=0,gt=0;for(ge==16?(gt=3+Xu(Ve,ct,3),ct+=2,lt=Yn[ii-1]):ge==17?(gt=3+Xu(Ve,ct,7),ct+=3):ge==18&&(gt=11+Xu(Ve,ct,127),ct+=7);gt--;)Yn[ii++]=lt}}var Xt=Yn.subarray(0,Jt),Kt=Yn.subarray(Jt);En=g2(Xt),ln=g2(Kt),Bt=kv(Xt,En),Ot=kv(Kt,ln)}else Yu(1);if(ct>pn){Tt&&Yu(0);break}}Mt&&mt(rt+131072);for(var cn=(1<<En)-1,An=(1<<ln)-1,_i=ct;;_i=ct){var vi=(lt=Bt[_2(Ve,ct)&cn])>>4;if((ct+=15&lt)>pn){Tt&&Yu(0);break}if(lt||Yu(2),vi<256)Ze[rt++]=vi;else{if(vi==256){_i=ct,Bt=null;break}var fi=vi-254;vi>264&&(fi=Xu(Ve,ct,(1<<(di=yM[ii=vi-257]))-1)+wM[ii],ct+=di);var ar=Ot[_2(Ve,ct)&An],Zr=ar>>4;if(ar||Yu(3),ct+=15&ar,Kt=M$[Zr],Zr>3){var di=vM[Zr];Kt+=_2(Ve,ct)&(1<<di)-1,ct+=di}if(ct>pn){Tt&&Yu(0);break}Mt&&mt(rt+131072);var kr=rt+fi;if(rt<Kt){var hr=0-Kt,Zi=Math.min(Kt,kr);for(hr+rt<0&&Yu(3);rt<Zi;++rt)Ze[rt]=(void 0)[hr+rt]}for(;rt<kr;++rt)Ze[rt]=Ze[rt-Kt]}}He.l=Bt,He.p=_i,He.b=rt,He.f=At,Bt&&(At=1,He.m=En,He.d=Ot,He.n=ln)}while(!At);return rt!=Ze.length&&bt?(It=Ze,((zt=rt)==null||zt>It.length)&&(zt=It.length),new Rc(It.subarray(0,zt))):Ze.subarray(0,rt)}(ue.subarray(fe,-8),{i:2},new Rc(((K=ue)[(ae=K.length)-4]|K[ae-3]<<8|K[ae-2]<<16|K[ae-1]<<24)>>>0))));var K,ae,ue,fe;const Me=F$[Z];if(!Me)throw new Error(`Unhandled codec: ${Z}`);const De=new globalThis.DecompressionStream(Me);return new Response(new Blob([q]).stream().pipeThrough(De)).arrayBuffer().then(Ve=>new Uint8Array(Ve))}(L,P).then(q=>(function(Z,K){Z.readFields(C$,K)}(new y2(q),$),new V$[x]($.buffer))),j.then(q=>{for(let Z=R.length-1;Z>=0;Z--)switch(R[Z]){case"delta_filter":E$(q,C);break;case"zigzag_filter":I$(q);break;case"bitshuffle_filter":A$(q,x);break;default:throw new du(`Unhandled filter "${R[Z]}"`)}return{layerName:f,blockIndex:I,data:q}}).catch(q=>{throw q})}))},en(IM,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),en(nx,"MapboxRasterTile"),en(EM,"MapboxRasterLayer",{omit:["_blocksInProgress"]});class AM{constructor(i){this._stringToNumber={},this._numberToString=[];for(let a=0;a<i.length;a++){const h=i[a];this._stringToNumber[h]=a,this._numberToString[a]=h}}encode(i){return this._stringToNumber[i]}decode(i){return this._numberToString[i]}}const $$=["id","tile","layer","source","sourceLayer","state"];class S_{constructor(i,a,h,f,_){this.type="Feature",this._vectorTileFeature=i,this._z=a,this._x=h,this._y=f,this.properties=i.properties,this.id=_}clone(){const i=new S_(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(i.state=Object.assign({},this.state)),this.layer&&(i.layer=Object.assign({},this.layer)),this.source&&(i.source=this.source),this.sourceLayer&&(i.sourceLayer=this.sourceLayer),i}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const a of $$)this[a]!==void 0&&(i[a]=this[a]);return i}}class kM{constructor(i,a){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new Gr(Ut,16,0),this.featureIndexArray=new i1,this.promoteId=a,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(i,a,h,f,_,y=0,x=0){const C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,f,_,y);const I=this.grid;for(let R=0;R<a.length;R++){const P=a[R],L=[1/0,1/0,-1/0,-1/0];for(let $=0;$<P.length;$++){const j=P[$];L[0]=Math.min(L[0],j.x),L[1]=Math.min(L[1],j.y),L[2]=Math.max(L[2],j.x),L[3]=Math.max(L[3],j.y)}x!==0&&(L[0]-=x,L[1]-=x,L[2]+=x,L[3]+=x),L[0]<Ut&&L[1]<Ut&&L[2]>=0&&L[3]>=0&&I.insert(C,L[0],L[1],L[2],L[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Wn(new R1(this.rawTileData)).layers,this.sourceLayerCoder=new AM(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const i in this.vtLayers)this.vtFeatures[i]=[]}return this.vtLayers}query(i,a){const{tilespaceGeometry:h,transform:f,tileTransform:_,pixelPosMatrix:y,availableImages:x,worldview:C}=a;this.loadVTLayers(),this.serializedLayersCache.clear();const I=h.bufferedTilespaceBounds,R=this.grid.query(I.min.x,I.min.y,I.max.x,I.max.y,(j,q,Z,K)=>Go(h.bufferedTilespaceGeometry,j,q,Z,K));R.sort(j$);let P=null;f.elevation&&R.length>0&&(P=v_.create(f.elevation,this.tileID));const L={};let $;for(let j=0;j<R.length;j++){const q=R[j];if(q===$)continue;$=q;const Z=this.featureIndexArray.get(q);let K=null;this.is3DTile?this.loadMatchingModelFeature(L,Z,i,h,f,C):this.loadMatchingFeature(L,Z,i,x,C,(ae,ue,fe,Me=0)=>(K||(K=rn(ae,this.tileID.canonical,_)),ue.queryIntersectsFeature(h,ae,fe,K,this.z,f,y,P,Me)))}return L}loadMatchingFeature(i,a,h,f,_,y){const{featureIndex:x,bucketIndex:C,sourceLayerIndex:I,layoutVertexArrayOffset:R}=a,P=this.bucketLayerIDs[C],L=h.layers,$=Object.keys(L);if($.length&&!ei($,P))return;const j=h.sourceCache,q=this.sourceLayerCoder.decode(I),Z=this.vtLayers[q].feature(x),K=this.getId(Z,q);for(let ae=0;ae<P.length;ae++){const ue=P[ae];if(!L[ue])continue;const{styleLayer:fe,targets:Me}=L[ue];let De={};K!==void 0&&(De=j.getFeatureState(fe.sourceLayer,K));const Ve=!y||y(Z,fe,De,R);if(!Ve)continue;const He=new S_(Z,this.z,this.x,this.y,K);He.tile=this.tileID.canonical,He.state=De;let Ze=this.serializedLayersCache.get(ue);Ze||(Ze=fe.serialize(),Ze.id=ue,this.serializedLayersCache.set(ue,Ze)),He.source=Ze.source,He.sourceLayer=Ze["source-layer"],He.layer=Object.assign({},Ze),He.layer.paint=RM(Ze.paint,fe.paint,Z,De,f),He.layer.layout=RM(Ze.layout,fe.layout,Z,De,f);let _t=!1;for(const Je of Me){this.updateFeatureProperties(He,Je);const{filter:bt}=Je;if(bt){if(Z.properties=He.properties,bt.needGeometry){const Mt=Lt(Z,!0);if(!bt.filter(new Tr(this.tileID.overscaledZ,{worldview:_}),Mt,this.tileID.canonical))continue}else if(!bt.filter(new Tr(this.tileID.overscaledZ,{worldview:_}),Z))continue}_t=!0,Je.targetId&&this.addFeatureVariant(He,Je)}_t&&this.appendToResult(i,ue,x,He,Ve)}}loadMatchingModelFeature(i,a,h,f,_,y){const{featureIndex:x,bucketIndex:C}=a,I=this.bucketLayerIDs[C],R=h.layers,P=Object.keys(R);if(!P.length||ei(P,I))for(let L=0;L<I.length;L++){const $=I[L],{styleLayer:j,targets:q}=R[$];if(j.type!=="model")continue;const Z=f.tile,K=Z.getBucket(j);if(!(K&&K instanceof K1))continue;const ae=qV(K,x,f,_);if(!ae)continue;const{z:ue,x:fe,y:Me}=Z.tileID.canonical,{feature:De,intersectionZ:Ve,position:He}=ae;let Ze={};De.id!==void 0&&(Ze=h.sourceCache.getFeatureState(j.sourceLayer,De.id));const _t=new S_({},ue,fe,Me,De.id);_t.tile=this.tileID.canonical,_t.state=Ze,_t.properties=De.properties,_t.geometry={type:"Point",coordinates:[He.lng,He.lat]};let Je=this.serializedLayersCache.get($);Je||(Je=j.serialize(),Je.id=$,this.serializedLayersCache.set($,Je)),_t.source=Je.source,_t.sourceLayer=Je["source-layer"],_t.layer=Object.assign({},Je);let bt=!1;for(const Mt of q){this.updateFeatureProperties(_t,Mt);const{filter:Tt}=Mt;if(Tt){if(De.properties=_t.properties,Tt.needGeometry){if(!Tt.filter(new Tr(this.tileID.overscaledZ,{worldview:y}),De,this.tileID.canonical))continue}else if(!Tt.filter(new Tr(this.tileID.overscaledZ,{worldview:y}),De))continue}bt=!0,Mt.targetId&&this.addFeatureVariant(_t,Mt)}bt&&this.appendToResult(i,$,x,_t,Ve)}}updateFeatureProperties(i,a,h){if(a.properties){const f={};for(const _ in a.properties){const y=a.properties[_].evaluate({zoom:this.z},i._vectorTileFeature,i.state,i.tile,h);y!=null&&(f[_]=y)}i.properties=f}}addFeatureVariant(i,a,h){const f={target:a.target,namespace:a.namespace,uniqueFeatureID:a.uniqueFeatureID};a.properties&&(f.properties=i.properties),i.variants=i.variants||{},i.variants[a.targetId]=i.variants[a.targetId]||[],i.variants[a.targetId].push(f)}appendToResult(i,a,h,f,_){let y=i[a];y===void 0&&(y=i[a]=[]),y.push({featureIndex:h,feature:f,intersectionZ:_})}lookupSymbolFeatures(i,a,h,f,_,y){const x={};this.loadVTLayers();for(const C of i)this.loadMatchingFeature(x,{bucketIndex:a,sourceLayerIndex:h,featureIndex:C,layoutVertexArrayOffset:0},f,_,y);return x}loadFeature(i){const{featureIndex:a,sourceLayerIndex:h}=i;this.loadVTLayers();const f=this.sourceLayerCoder.decode(h),_=this.vtFeatures[f];if(_[a])return _[a];const y=this.vtLayers[f].feature(a);return _[a]=y,y}hasLayer(i){for(const a of this.bucketLayerIDs)for(const h of a)if(i===h)return!0;return!1}getId(i,a){let h=i.id;if(this.promoteId){const f=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[a];if(f!=null)if(Array.isArray(f)){if(!this.promoteIdExpression){const _=Ps(f);if(_.result!=="success"){const y=_.value.map(x=>`${x.key}: ${x.message}`).join(", ");return void li(`Failed to create expression for promoteId: ${y}`)}this.promoteIdExpression=_.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new mc),h=this.promoteIdExpression.evaluate({zoom:0},i)}else h=i.properties[f];typeof h=="boolean"&&(h=Number(h))}return h}}function RM(l,i,a,h,f){return zn(l,(_,y)=>{const x=i instanceof Eh?i.get(y):null;return x&&x.evaluate?x.evaluate(a,h,void 0,f):x})}function j$(l,i){return i-l}en(kM,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const PM=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class v2{static from(i){if(!(i instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,h]=new Uint8Array(i,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=h>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const _=PM[15&h];if(!_)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(i,2,1),[x]=new Uint32Array(i,4,1);return new v2(x,y,_,i)}constructor(i,a=64,h=Float64Array,f){if(isNaN(i)||i<0)throw new Error(`Unpexpected numItems value: ${i}.`);this.numItems=+i,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=h,this.IndexArrayType=i<65536?Uint16Array:Uint32Array;const _=PM.indexOf(this.ArrayType),y=2*i*this.ArrayType.BYTES_PER_ELEMENT,x=i*this.IndexArrayType.BYTES_PER_ELEMENT,C=(8-x%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${h}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+x+C,2*i),this._pos=2*i,this._finished=!0):(this.data=new ArrayBuffer(8+y+x+C),this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+x+C,2*i),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=i)}add(i,a){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=i,this.coords[this._pos++]=a,h}finish(){const i=this._pos>>1;if(i!==this.numItems)throw new Error(`Added ${i} items when expected ${this.numItems}.`);return b2(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(i,a,h,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:y,nodeSize:x}=this,C=[0,_.length-1,0],I=[];for(;C.length;){const R=C.pop()||0,P=C.pop()||0,L=C.pop()||0;if(P-L<=x){for(let Z=L;Z<=P;Z++){const K=y[2*Z],ae=y[2*Z+1];K>=i&&K<=h&&ae>=a&&ae<=f&&I.push(_[Z])}continue}const $=L+P>>1,j=y[2*$],q=y[2*$+1];j>=i&&j<=h&&q>=a&&q<=f&&I.push(_[$]),(R===0?i<=j:a<=q)&&(C.push(L),C.push($-1),C.push(1-R)),(R===0?h>=j:f>=q)&&(C.push($+1),C.push(P),C.push(1-R))}return I}within(i,a,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:_,nodeSize:y}=this,x=[0,f.length-1,0],C=[],I=h*h;for(;x.length;){const R=x.pop()||0,P=x.pop()||0,L=x.pop()||0;if(P-L<=y){for(let Z=L;Z<=P;Z++)DM(_[2*Z],_[2*Z+1],i,a)<=I&&C.push(f[Z]);continue}const $=L+P>>1,j=_[2*$],q=_[2*$+1];DM(j,q,i,a)<=I&&C.push(f[$]),(R===0?i-h<=j:a-h<=q)&&(x.push(L),x.push($-1),x.push(1-R)),(R===0?i+h>=j:a+h>=q)&&(x.push($+1),x.push(P),x.push(1-R))}return C}}function b2(l,i,a,h,f,_){if(f-h<=a)return;const y=h+f>>1;MM(l,i,y,h,f,_),b2(l,i,a,h,y-1,1-_),b2(l,i,a,y+1,f,1-_)}function MM(l,i,a,h,f,_){for(;f>h;){if(f-h>600){const I=f-h+1,R=a-h+1,P=Math.log(I),L=.5*Math.exp(2*P/3),$=.5*Math.sqrt(P*L*(I-L)/I)*(R-I/2<0?-1:1);MM(l,i,a,Math.max(h,Math.floor(a-R*L/I+$)),Math.min(f,Math.floor(a+(I-R)*L/I+$)),_)}const y=i[2*a+_];let x=h,C=f;for(Pv(l,i,h,a),i[2*f+_]>y&&Pv(l,i,h,f);x<C;){for(Pv(l,i,x,C),x++,C--;i[2*x+_]<y;)x++;for(;i[2*C+_]>y;)C--}i[2*h+_]===y?Pv(l,i,h,C):(C++,Pv(l,i,C,f)),C<=a&&(h=C+1),a<=C&&(f=C-1)}}function Pv(l,i,a,h){x2(l,a,h),x2(i,2*a,2*h),x2(i,2*a+1,2*h+1)}function x2(l,i,a){const h=l[i];l[i]=l[a],l[a]=h}function DM(l,i,a,h){const f=l-a,_=i-h;return f*f+_*_}o.$=Xp,o.A=As,o.B=Uf,o.C=2,o.D=c_,o.E=Ta,o.F=_v,o.G=rP,o.H=Kp,o.I=sa,o.J=Hg,o.K=jn,o.L=Xc,o.M=io,o.N=Wi,o.O=Yi,o.P=Dt,o.Q=va,o.R=Va,o.S=Ih,o.T=OC,o.U=Ps,o.V=Z1,o.W=Aa,o.X=Nu,o.Y=_c,o.Z=Id,o._=ia,o.a=function(l){return ko.API_CDN_URL_REGEX.test(l)},o.a$=Ce,o.a0=vd,o.a1=Pu,o.a2=Gg,o.a3=class extends Z1{},o.a4=po,o.a5=$i,o.a6=Ye,o.a7=function(l){const i=l.value;return i?vd(i)?l2(i,!0)?[]:[new Z1(l.key,i,`invalid url "${i}"`)]:[new Z1(l.key,i,`string expected, "${jn(i)}" found`)]:[]},o.a8=fm,o.a9=_o,o.aA=Le,o.aB=ce,o.aC=dn,o.aD=m,o.aE=Os,o.aF=pe,o.aG=tt,o.aH=function(l,i){const a={};for(let h=0;h<i.length;h++){const f=i[h];f in l&&(a[f]=l[f])}return a},o.aI=ne,o.aJ=Ie,o.aK=class{constructor(l){this.entries={},this.scheduler=l}request(l,i,a,h){const f=this.entries[l]=this.entries[l]||{callbacks:[]};if(f.result){const[_,y]=f.result;return this.scheduler?this.scheduler.add(()=>{h(_,y)},i):h(_,y),()=>{}}return f.callbacks.push(h),f.cancel||(f.cancel=a((_,y)=>{f.result=[_,y];for(const x of f.callbacks)this.scheduler?this.scheduler.add(()=>{x(_,y)},i):x(_,y);setTimeout(()=>delete this.entries[l],3e3)})),()=>{f.result||(f.callbacks=f.callbacks.filter(_=>_!==h),f.callbacks.length||(f.cancel(),delete this.entries[l]))}}},o.aL=function(l,i,a){const h=JSON.stringify(l.request);return l.data&&(this.deduped.entries[h]={result:[null,l.data]}),this.deduped.request(h,{type:"parseTile",isSymbolTile:l.isSymbolTile,zoom:l.tileZoom},f=>{const _=Sa(l.request,(y,x,C,I)=>{y?f(y):x&&f(null,{vectorTile:a?void 0:new Wn(new R1(x)),rawData:x,cacheControl:C,expires:I})});return()=>{_.cancel(),f()}},i)},o.aM=function(l){Ja++,Ja>Ks&&(l.getActor().send("enforceCacheSizeLimit",Ns),Ja=0)},o.aN=function(l){return l<=1?1:Math.pow(2,Math.floor(Math.log2(l)))},o.aO=Ma,o.aP=DP,o.aQ=NP,o.aR=W,o.aS=MP,o.aT=function(l,i){const a=document.createElement("video");a.muted=!0,a.onloadstart=function(){i(null,a)};for(let h=0;h<l.length;h++){const f=document.createElement("source");md(l[h])||(a.crossOrigin="Anonymous"),f.src=l[h],a.appendChild(f)}return{cancel:()=>{}}},o.aU=dv,o.aV=function(l){return fetch(l).then(i=>i.arrayBuffer()).then(i=>cR(i,0,l))},o.aW=_R,o.aX=class{constructor(l,i,a,h){this.id=l,this.position=i!=null?new W(i[0],i[1]):new W(0,0),this.orientation=a??[0,0,0],this.nodes=h,this.uploaded=!1,this.aabb=new Vn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(l,i){if(ce(l.matrix,i,l.matrix),l.meshes)for(const a of l.meshes){const h=Vn.applyTransformFast(a.aabb,l.matrix);this.aabb.encapsulate(h)}if(l.children)for(const a of l.children)this._applyTransformations(a,l.matrix)}computeBoundsAndApplyParent(){const l=Q([]);for(const i of this.nodes)this._applyTransformations(i,l)}computeModelMatrix(l,i,a,h,f,_,y=!1){mR(this.matrix,this,l.transform,this.position,i,a,h,f,_,y)}upload(l){if(!this.uploaded){for(const i of this.nodes)BC(i,l);for(const i of this.nodes)k1(i);this.uploaded=!0}}destroy(){for(const l of this.nodes)FC(l)}},o.aY=Mn,o.aZ=bv,o.a_=Ae,o.aa=Vt,o.ab=class{constructor(l){this.specification=l}possiblyEvaluate(l,i){return no(l.expression.evaluate(i))}interpolate(l,i,a){return{x:Pn(l.x,i.x,a),y:Pn(l.y,i.y,a),z:Pn(l.z,i.z,a),azimuthal:Pn(l.azimuthal,i.azimuthal,a),polar:Pn(l.polar,i.polar,a)}}},o.ac=Tr,o.ad=Us,o.ae=ut,o.af=kn,o.ag=Re,o.ah=it,o.ai=Eh,o.aj=Jf,o.ak=Pn,o.al=Ut,o.am=gd,o.an=Xe,o.ao=Bi,o.ap=class{constructor(l){this.specification=l}possiblyEvaluate(l,i){return function([a,h]){const f=no([1,a,h]);return{x:f.x,y:f.y,z:f.z}}(l.expression.evaluate(i))}interpolate(l,i,a){return{x:Pn(l.x,i.x,a),y:Pn(l.y,i.y,a),z:Pn(l.z,i.z,a)}}},o.aq=function(l,i,a=0,h=!0){const f=new Dt(a,a),_=l.sub(f),y=i.add(f),x=[_,new Dt(y.x,_.y),y,new Dt(_.x,y.y)];return h&&x.push(_.clone()),x},o.ar=function(l,i){const a=[];for(let h=0;h<l.length;h++){const f=Ge(h-1,-1,l.length-1),_=Ge(h+1,-1,l.length-1),y=l[h],x=l[_],C=l[f].sub(y).unit(),I=x.sub(y).unit(),R=I.angleWithSep(C.x,C.y),P=C.add(I).unit().mult(-1*i/Math.sin(R/2));a.push(y.add(P))}return a},o.as=yP,o.at=Go,o.au=function(l,i,a=0){return tn(((i.x-a)*l.scale-l.x)*Ut,(i.y*l.scale-l.y)*Ut,we(i.z,i.y))},o.av=Gt,o.aw=ai,o.ax=qi,o.ay=kR,o.az=function(l){let i=1/0,a=1/0,h=-1/0,f=-1/0;for(const _ of l)i=Math.min(i,_.x),a=Math.min(a,_.y),h=Math.max(h,_.x),f=Math.max(f,_.y);return{min:new Dt(i,a),max:new Dt(h,f)}},o.b=function(l){return ko.API_FONTS_REGEX.test(l)},o.b$=wC,o.b0=kh,o.b1=bs,o.b2=St,o.b3=Gy,o.b4=H1,o.b5=function(){Pl.isLoading()||Pl.isLoaded()||wh()!=="deferred"||ou()},o.b6=pm,o.b7=Lt,o.b8=S_,o.b9=Oi,o.bA=Q,o.bB=qe,o.bC=ee,o.bD=function(l,i){const{x:a,y:h}=l.point,f=YA(a,h,l.worldSize/l._pixelsPerMercatorPixel,0,0);return ce(f,f,cC(Fd(i)))},o.bE=A,o.bF=at,o.bG=function(l,i){var a=i[0]-l[0],h=i[1]-l[1],f=i[2]-l[2];return Math.sqrt(a*a+h*h+f*f)},o.bH=Di,o.bI=In,o.bJ=Ft,o.bK=gv,o.bL=zl,o.bM=KC,o.bN=function(l,i,a,h,f){const _=5*i+2;l.float32[_+0]=a,l.float32[_+1]=h,l.float32[_+2]=f},o.bO=U1,o.bP=ho,o.bQ=Ao,o.bR=ha,o.bS=So,o.bT=Ge,o.bU=function(l,i,a,h){var f=new T(4);return f[0]=l,f[1]=i,f[2]=a,f[3]=h,f},o.bV=w1,o.bW=Dl,o.bX=Qs,o.bY=Ak,o.bZ=VP,o.b_=Mk,o.ba=jC,o.bb=vC,o.bc=rn,o.bd=Md,o.be=e_,o.bf=GA,o.bg=ro,o.bh=a_,o.bi=s2,o.bj=function(l,i){const a=Jf(i.zoom);if(a===0)return Fd(l);const h=d1(l),f=lC(h),_=pe(h.getWest())*i.worldSize,y=pe(h.getEast())*i.worldSize,x=Ie(h.getNorth())*i.worldSize,C=Ie(h.getSouth())*i.worldSize,I=[_,x,0],R=[y,x,0],P=[_,C,0],L=[y,C,0],$=se([],i.globeMatrix);return kn(I,I,$),kn(R,R,$),kn(P,P,$),kn(L,L,$),f[0]=Dh(f[0],P,a),f[1]=Dh(f[1],L,a),f[2]=Dh(f[2],R,a),f[3]=Dh(f[3],I,a),Vn.fromPoints(f)},o.bk=f1,o.bl=se,o.bm=Ky,o.bn=Dh,o.bo=Ah,o.bp=g7,o.bq=oe,o.br=be,o.bs=nx,o.bt=R1,o.bu=Sa,o.bv=function(l,i){const a=[];for(const h in l)h in i||a.push(h);return a},o.bw=st,o.bx=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.by=bl,o.bz=function(l){var i=new T(16);return i[0]=l[0],i[1]=l[1],i[2]=l[2],i[3]=l[3],i[4]=l[4],i[5]=l[5],i[6]=l[6],i[7]=l[7],i[8]=l[8],i[9]=l[9],i[10]=l[10],i[11]=l[11],i[12]=l[12],i[13]=l[13],i[14]=l[14],i[15]=l[15],i},o.c=pc,o.c$=function(l){return l*l*l*l*l},o.c0=ZC,o.c1=dP,o.c2=QC,o.c3=v2,o.c4=Pt,o.c5=Qt,o.c6=Ln,o.c7=function(l,i,a){a*=.5;var h=i[0],f=i[1],_=i[2],y=i[3],x=Math.sin(a),C=Math.cos(a);return l[0]=h*C+f*x,l[1]=f*C-h*x,l[2]=_*C+y*x,l[3]=y*C-_*x,l},o.c8=mi,o.c9=Pr,o.cA=ui,o.cB=dR,o.cC=qu,o.cD=ZA,o.cE=function(l,i,a,h,f,_,y,x,C){if(C.name==="globe")return ZA(l,i,new qu(a,h,f),!1);const I=bv({z:a,x:h,y:f},C);return new Vn([(_+I.x/I.scale)*i,i*(I.y/I.scale),y],[(_+I.x2/I.scale)*i,i*(I.y2/I.scale),x])},o.cF=function(l,i,a){return l[0]=Math.min(i[0],a[0]),l[1]=Math.min(i[1],a[1]),l[2]=Math.min(i[2],a[2]),l[3]=Math.min(i[3],a[3]),l},o.cG=function(l,i,a){return l[0]=Math.max(i[0],a[0]),l[1]=Math.max(i[1],a[1]),l[2]=Math.max(i[2],a[2]),l[3]=Math.max(i[3],a[3]),l},o.cH=function(l){const i=Math.round((l+45+360)%360/90)%4;return ie[i]},o.cI=ke,o.cJ=fn,o.cK=b,o.cL=function(l){const i=Q(new Float64Array(16));ce(i,l.pixelMatrix,l.globeMatrix);const a=[0,O,0],h=[0,z,0];return kn(a,a,i),kn(h,h,i),[a[0]>0&&a[0]<=l.width&&a[1]>0&&a[1]<=l.height&&!dC(l,new W(l.center.lat,90)),h[0]>0&&h[0]<=l.width&&h[1]>0&&h[1]<=l.height&&!dC(l,new W(l.center.lat,-90))]},o.cM=function(l,i){const{scale:a}=l.tileTransform,h=a*Ut/(l.tileSize*Math.pow(2,i.zoom-l.tileID.overscaledZ+l.tileID.canonical.z));return function(f,_,y){var x=_[1],C=_[2],I=_[3],R=y[0],P=y[1];return f[0]=_[0]*R,f[1]=x*R,f[2]=C*P,f[3]=I*P,f}(new Float32Array(4),i.inverseAdjustmentMatrix,[h,h])},o.cN=I1,o.cO=$e,o.cP=uR,o.cQ=function(l){const i=uR(l,!0);return A([],[i[0],i[1],i[4],i[5]])},o.cR=ze,o.cS=er,o.cT=xe,o.cU=function(l){const{x:i,y:a}=l.point,{lng:h,lat:f}=l._center;return YA(i,a,l.worldSize,h,f)},o.cV=Hn,o.cW=Y,o.cX=s_,o.cY=aa,o.cZ=v,o.c_=function(l,i,a){let h=0;for(let f=0;f<2;++f)l[f]>0&&(h+=(l[f]-0)*(l[f]-0)),i[f]<0&&(h+=(0-i[f])*(0-i[f]));return h},o.ca=function(l,i){return l[0]=-i[0],l[1]=-i[1],l[2]=-i[2],l[3]=i[3],l},o.cb=Ee,o.cc=function(l,i,a,h,f){var _=1/Math.tan(i/2);if(l[0]=_/a,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=_,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,f!=null&&f!==1/0){var y=1/(h-f);l[10]=(f+h)*y,l[14]=2*f*h*y}else l[10]=-1,l[14]=-2*h;return l},o.cd=function(l,i,a,h,f,_,y){var x=1/(i-a),C=1/(h-f),I=1/(_-y);return l[0]=-2*x,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=-2*C,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=2*I,l[11]=0,l[12]=(i+a)*x,l[13]=(f+h)*C,l[14]=(y+_)*I,l[15]=1,l},o.ce=Se,o.cf=function(l,i,a){l[4*i+0]=a[0],l[4*i+1]=a[1],l[4*i+2]=a[2],l[4*i+3]=a[3]},o.cg=wm,o.ch=Sm,o.ci=Ho,o.cj=au,o.ck=Tm,o.cl=SP,o.cm=function(){var l=new T(4);return T!=Float32Array&&(l[1]=0,l[2]=0),l[0]=1,l[3]=1,l},o.cn=function(l,i,a){var h=i[0],f=i[1],_=i[2],y=i[3],x=Math.sin(a),C=Math.cos(a);return l[0]=h*C+_*x,l[1]=f*C+y*x,l[2]=h*-x+_*C,l[3]=f*-x+y*C,l},o.co=function(l,i){return l[0]===i[0]&&l[1]===i[1]&&l[2]===i[2]&&l[3]===i[3]},o.cp=vt,o.cq=function(l){var i=l[0],a=l[1],h=l[2],f=l[3];return Math.sqrt(i*i+a*a+h*h+f*f)},o.cr=zo,o.cs=Qe,o.ct=o_,o.cu=3,o.cv=2,o.cw=7,o.cx=6,o.cy=Wt,o.cz=me,o.d=function(l){return ko.API_TILEJSON_REGEX.test(l)},o.d$=DR,o.d0=he,o.d1=45,o.d2=Cm,o.d3=function(l,i,a){const h=Math.sqrt(l*l+i*i+a*a),f=h>0?Math.acos(a/h)*$c:0;let _=l!==0||i!==0?Math.atan2(-i,-l)*$c+90:0;return _<0&&(_+=360),[h,_,f]},o.d4=tn,o.d5=no,o.d6=et,o.d7=on,o.d8=Vn,o.d9=hn,o.dA=function(l,i,a){const h=Jf(a.zoom),f=l.style.map._antialias,_=l.terrain&&l.terrain.exaggeration()>0;return h===0&&!f&&!_},o.dB=function(l){const i=l.pixelsPerMeter,a=i/Se(1,l.center.lat),h=Q(new Float64Array(16));return be(h,h,[l.point.x,l.point.y,0]),ze(h,h,[a,a,i]),Float32Array.from(h)},o.dC=d1,o.dD=function(l){const i=ke-5;l=Le(l,-i,i)/i*90;const a=Math.pow(Math.abs(Math.sin(Xe(l))),3);return Math.round(a*(k.length-1))},o.dE=function(l,i,a,h){const f=i.getNorth(),_=i.getSouth(),y=i.getWest(),x=i.getEast(),C=1<<l.z,I=x-y,R=f-_,P=I/E,L=-R/k[a],$=[0,P,0,L,0,0,f,y,0];if(l.z>0){const j=180/h;N($,$,[j/I+1,0,0,0,j/R+1,0,-.5*j/P,.5*j/L,1])}return $[2]=C,$[5]=l.x,$[8]=l.y,$},o.dF=Fd,o.dG=function(l,i,a){const h=Q(new Float64Array(16)),f=(i/(1<<l)-.5)*Math.PI*2;return je(h,a.globeMatrix,f),Float32Array.from(h)},o.dH=class{isDataAvailableAtPoint(l){const i=this._source();if(this.isUsingMockSource()||!i||l.y<0||l.y>1)return!1;const a=i.getSource().maxzoom,h=1<<a,f=Math.floor(l.x),_=Math.floor((l.x-f)*h),y=Math.floor(l.y*h),x=this.findDEMTileFor(new Ma(a,f,a,_,y));return!(!x||!x.dem)}getAtPointOrZero(l,i=0){return this.getAtPoint(l,i)||0}getAtPoint(l,i,a=!0){if(this.isUsingMockSource())return null;i==null&&(i=null);const h=this._source();if(!h||l.y<0||l.y>1)return i;const f=h.getSource().maxzoom,_=1<<f,y=Math.floor(l.x),x=l.x-y,C=new Ma(f,y,f,Math.floor(x*_),Math.floor(l.y*_)),I=this.findDEMTileFor(C);if(!I||!I.dem)return i;const R=I.dem,P=1<<I.tileID.canonical.z,L=(x*P-I.tileID.canonical.x)*R.dim,$=(l.y*P-I.tileID.canonical.y)*R.dim,j=Math.floor(L),q=Math.floor($);return(a?this.exaggeration():1)*Pn(Pn(R.get(j,q),R.get(j,q+1),$-q),Pn(R.get(j+1,q),R.get(j+1,q+1),$-q),L-j)}getAtTileOffset(l,i,a){const h=1<<l.canonical.z;return this.getAtPointOrZero(new ut(l.wrap+(l.canonical.x+i/Ut)/h,(l.canonical.y+a/Ut)/h))}getAtTileOffsetFunc(l,i,a,h){return f=>{const _=this.getAtTileOffset(l,f.x,f.y),y=h.upVector(l.canonical,f.x,f.y);return Pt(y,y,_*h.upVectorScale(l.canonical,i,a).metersToTile),y}}getForTilePoints(l,i,a,h){if(this.isUsingMockSource())return!1;const f=v_.create(this,l,h);return!!f&&(i.forEach(_=>{_[2]=this.exaggeration()*f.getElevationAt(_[0],_[1],a)}),!0)}getMinMaxForTile(l){if(this.isUsingMockSource())return null;const i=this.findDEMTileFor(l);if(!i||!i.dem)return null;const a=i.dem.tree,h=i.tileID,f=1<<l.canonical.z-h.canonical.z;let _=l.canonical.x/f-h.canonical.x,y=l.canonical.y/f-h.canonical.y,x=0;for(let C=0;C<l.canonical.z-h.canonical.z&&!a.leaves[x];C++){_*=2,y*=2;const I=2*Math.floor(y)+Math.floor(_);x=a.childOffsets[x]+I,_%=1,y%=1}return{min:this.exaggeration()*a.minimums[x],max:this.exaggeration()*a.maximums[x]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(l,i,a){throw new Error("Pure virtual method called.")}pointCoordinate(l){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(l){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const l=this.visibleDemTiles;if(l.length===0)return null;let i=!1,a=Number.MAX_VALUE,h=Number.MIN_VALUE;for(const f of l){const _=this.getMinMaxForTile(f.tileID);_&&(a=Math.min(a,_.min),h=Math.max(h,_.max),i=!0)}return i?{min:a,max:h}:null}},o.dI=uk,o.dJ=u1,o.dK=function(l,i){return[Math.pow(l[0],2.2)*i,Math.pow(l[1],2.2)*i,Math.pow(l[2],2.2)*i]},o.dL=D,o.dM=function(l,i){var a=Math.sin(i),h=Math.cos(i);return l[0]=h,l[1]=a,l[2]=0,l[3]=-a,l[4]=h,l[5]=0,l[6]=0,l[7]=0,l[8]=1,l},o.dN=dr,o.dO=XA,o.dP=Ts,o.dQ=ta,o.dR=256,o.dS=function(l,i){const a=[0,0,0];return kn(a,a,f1(Fd(i.canonical))),kn(a,a,l),a},o.dT=l=>({u_matrix:new Tm(l),u_texsize:new au(l),u_pixels_to_tile_units:new r_(l),u_device_pixel_ratio:new Ho(l),u_width_scale:new Ho(l),u_floor_width_scale:new Ho(l),u_image:new wm(l),u_units_to_pixels:new au(l),u_tile_units_to_pixels:new Ho(l),u_alpha_discard_threshold:new Ho(l),u_trim_offset:new au(l),u_trim_fade_range:new au(l),u_trim_color:new Cm(l),u_emissive_strength:new Ho(l),u_zbias_factor:new Ho(l),u_tile_to_meter:new Ho(l),u_ground_shadow_factor:new Sm(l),u_pattern_transition:new Ho(l)}),o.dU=l=>({u_matrix:new Tm(l),u_pixels_to_tile_units:new r_(l),u_device_pixel_ratio:new Ho(l),u_width_scale:new Ho(l),u_floor_width_scale:new Ho(l),u_units_to_pixels:new au(l),u_dash_image:new wm(l),u_gradient_image:new wm(l),u_image_height:new Ho(l),u_texsize:new au(l),u_tile_units_to_pixels:new Ho(l),u_alpha_discard_threshold:new Ho(l),u_trim_offset:new au(l),u_trim_fade_range:new au(l),u_trim_color:new Cm(l),u_emissive_strength:new Ho(l),u_zbias_factor:new Ho(l),u_tile_to_meter:new Ho(l),u_ground_shadow_factor:new Sm(l)}),o.dV=l=>({u_camera_to_center_distance:new Ho(l),u_extrude_scale:new r_(l),u_device_pixel_ratio:new Ho(l),u_matrix:new Tm(l),u_inv_rot_matrix:new Tm(l),u_merc_center:new au(l),u_tile_id:new Sm(l),u_zoom_transition:new Ho(l),u_up_dir:new Sm(l),u_emissive_strength:new Ho(l)}),o.dW=Vy,o.dX=tV,o.dY=class{constructor(l,i,a,h){this.context=l,this.format=h,this.size=a,this.texture=l.gl.createTexture();const[f,_,y]=this.size,{gl:x}=l;x.bindTexture(x.TEXTURE_3D,this.texture),l.pixelStoreUnpackFlipY.set(!1),l.pixelStoreUnpack.set(1),l.pixelStoreUnpackPremultiplyAlpha.set(!1),"data"in i&&i.data&&x.texImage3D(x.TEXTURE_3D,0,this.format,f,_,y,0,MC(this.format),DC(this.format),i.data)}bind(l,i){const{context:a}=this,{gl:h}=a;h.bindTexture(h.TEXTURE_3D,this.texture),l!==this.minFilter&&(h.texParameteri(h.TEXTURE_3D,h.TEXTURE_MAG_FILTER,l),h.texParameteri(h.TEXTURE_3D,h.TEXTURE_MIN_FILTER,l),this.minFilter=l),i!==this.wrapS&&(h.texParameteri(h.TEXTURE_3D,h.TEXTURE_WRAP_S,i),h.texParameteri(h.TEXTURE_3D,h.TEXTURE_WRAP_T,i),this.wrapS=i)}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}},o.dZ=ek,o.d_=(l,i,a,h,f,_)=>{const y=l.transform,x=y.projection.name==="globe";let C;if(_.paint.get("circle-pitch-alignment")==="map")if(x){const R=XA(y.zoom,i.canonical)*y._pixelsPerMercatorPixel;C=Float32Array.from([R,0,0,R])}else C=y.calculatePixelsToTileUnitsMatrix(a);else C=new Float32Array([y.pixelsToGLUnits[0],0,0,y.pixelsToGLUnits[1]]);const I={u_camera_to_center_distance:l.transform.getCameraToCenterDistance(y.projection),u_matrix:l.translatePosMatrix(i.projMatrix,a,_.paint.get("circle-translate"),_.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Ko.devicePixelRatio,u_extrude_scale:C,u_inv_rot_matrix:x7,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:_.paint.get("circle-emissive-strength")};if(x){I.u_inv_rot_matrix=h,I.u_merc_center=f,I.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],I.u_zoom_transition=Jf(y.zoom);const R=f[0]*Ut,P=f[1]*Ut;I.u_up_dir=y.projection.upVector(new qu(0,0,0),R,P)}return I},o.da=function(l){return[Math.pow(l[0],1/2.2),Math.pow(l[1],1/2.2),Math.pow(l[2],1/2.2)]},o.db=l2,o.dc=function(l,i){return l.readFields(XV,{icons:[]},i)},o.dd=S1,o.de=g_,o.df=YC,o.dg=El,o.dh=hm,o.di=jc,o.dj=Gc,o.dk=Un,o.dl=function(l){const i=l.indexOf(mm);return i>=0?l.slice(0,i):l},o.dm=function(l){return l.indexOf(mm)>=0},o.dn=function(l){const i=l.lastIndexOf(mm);return i>=0?l.slice(i+1):""},o.dp=function(l){const i=[],a=l.id;return a===void 0&&i.push({message:`layers.${a}: missing required property "id"`}),l.render===void 0&&i.push({message:`layers.${a}: missing required method "render"`}),l.renderingMode&&l.renderingMode!=="2d"&&l.renderingMode!=="3d"&&i.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),i},o.dq=function(l,i,a,h){return l.type==="custom"?new HV(l,i):new ZV[l.type](l,i,a,h)},o.dr=Kn,o.ds=function(l){const i=l.indexOf(mm);return i>=0?l.slice(i+1):""},o.dt=class extends S_{constructor(l,i){super(l._vectorTileFeature,l._z,l._x,l._y,l.id),l.state&&(this.state=Object.assign({},l.state)),this.target=i.target,this.namespace=i.namespace,i.properties&&(this.properties=i.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=l.source,this.sourceLayer=l.sourceLayer,this.layer=l.layer)}toJSON(){const l=super.toJSON();return l.target=this.target,l.namespace=this.namespace,l}},o.du=Vf,o.dv=Ci,o.dw=function(l){return l({pluginStatus:Gs,pluginURL:Cc}),Vf.on("pluginStateChange",l),l},o.dx=a1,o.dy=class extends su{constructor(l){super(l),this.current=oC}set(l,i,a){if(this.fetchUniformLocation(l,i)){for(let h=0;h<9;h++)if(a[h]!==this.current[h]){this.current=a,this.gl.uniformMatrix3fv(this.location,!1,a);break}}}},o.dz=ve,o.e=ko,o.e$=function(){const l=lv;l&&(l.isPreloaded()&&l.numActive()===1?(l.release(IC),lv=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},o.e0=ks,o.e1=(l,i,a,h,f,_,y,x,C,I)=>{const R=l.transform,P=R.pitch<15?RR(.07,.7,Le((14-R.zoom)/5,0,1)):.07,L=a.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:MR(l,i,a,h),u_texsize:i.imageAtlasTexture?i.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:R.calculatePixelsToTileUnitsMatrix(i),u_device_pixel_ratio:f,u_width_scale:_,u_floor_width_scale:y,u_image:0,u_tile_units_to_pixels:PR(i,R),u_units_to_pixels:[1/R.pixelsToGLUnits[0],1/R.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:x,u_trim_fade_range:a.paint.get("line-trim-fade-range"),u_trim_color:a.paint.get("line-trim-color").toPremultipliedRenderColor(L?null:a.lut).toArray01(),u_emissive_strength:a.paint.get("line-emissive-strength"),u_zbias_factor:P,u_tile_to_meter:et(i.tileID.canonical,0),u_ground_shadow_factor:C,u_pattern_transition:I}},o.e2=(l,i,a,h,f,_,y,x,C,I)=>{const R=l.transform,P=R.calculatePixelsToTileUnitsMatrix(i),L=a.paint.get("line-trim-color-use-theme").constantOr("default")==="none",$=R.pitch<15?RR(.07,.7,Le((14-R.zoom)/5,0,1)):.07;return{u_matrix:MR(l,i,a,h),u_pixels_to_tile_units:P,u_device_pixel_ratio:_,u_width_scale:y,u_floor_width_scale:x,u_units_to_pixels:[1/R.pixelsToGLUnits[0],1/R.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:f,u_texsize:OR(a)&&i.lineAtlasTexture?i.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:PR(i,l.transform),u_alpha_discard_threshold:0,u_trim_offset:C,u_trim_fade_range:a.paint.get("line-trim-fade-range"),u_trim_color:a.paint.get("line-trim-color").toPremultipliedRenderColor(L?null:a.lut).toArray01(),u_emissive_strength:a.paint.get("line-emissive-strength"),u_zbias_factor:$,u_tile_to_meter:et(i.tileID.canonical,0),u_ground_shadow_factor:I}},o.e3=xn,o.e4=Xy,o.e5=we,o.e6=p7,o.e7=x1,o.e8=Hk,o.e9=ep,o.eA=hs,o.eB=Zf,o.eC=function(l,i,a,h,f,_,y,x,C,I,R,P,L,$,j,q){var Z=new T(16);return Z[0]=l,Z[1]=i,Z[2]=a,Z[3]=h,Z[4]=f,Z[5]=_,Z[6]=y,Z[7]=x,Z[8]=C,Z[9]=I,Z[10]=R,Z[11]=P,Z[12]=L,Z[13]=$,Z[14]=j,Z[15]=q,Z},o.eD=H,o.eE=ym,o.eF=Jg,o.eG=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Dt(1/0,1/0),max:new Dt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(l,i=!1){const a=Rk(new Dt(0,0),new Dt(Ut,Ut),l),h=[];if(i&&!bC(a,this._globalClipBounds))return h;for(const f of this._activeRegions){if(f.hiddenByOverlap||!bC(a,f))continue;const _=K7(f.min,f.max,l);h.push({min:_.min,max:_.max,sourceId:this._sourceIds[f.priority],footprint:f.footprint,footprintTileId:f.tileId,order:f.order,clipMask:f.clipMask,clipScope:f.clipScope})}return h}setSources(l){this._setSources(l.map(i=>({getSourceId:()=>i.cache.id,getFootprints:()=>{const a=[];for(const h of i.cache.getVisibleCoordinates()){const f=i.cache.getTile(h).buckets[i.layer];f&&f.updateFootprints(h.toUnwrapped(),a)}return a},getOrder:()=>i.order,getClipMask:()=>i.clipMask,getClipScope:()=>i.clipScope})))}_addSource(l){const i=l.getFootprints();if(i.length===0)return;const a=l.getOrder(),h=l.getClipMask(),f=l.getClipScope();for(const _ of i){if(!_.footprint)continue;const y=Rk(_.footprint.min,_.footprint.max,_.id);this._activeRegions.push({min:y.min,max:y.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:_.id,footprint:_.footprint,order:a,clipMask:h,clipScope:f})}this._sourceIds.push(l.getSourceId())}_computeReplacement(){this._activeRegions.sort((i,a)=>i.priority-a.priority||y1(i.min,a.min)||y1(i.max,a.max)||i.order-a.order||i.clipMask-a.clipMask||function(h,f){const _=(y,x)=>y+x;return h.length-f.length||h.reduce(_,"").localeCompare(f.reduce(_,""))}(i.clipScope,a.clipScope));let l=this._activeRegions.length!==this._prevRegions.length;if(!l){let i=0;for(;!l&&i!==this._activeRegions.length;){const a=this._activeRegions[i],h=this._prevRegions[i];l=a.priority!==h.priority||!kk(a,h)||a.order!==h.order||a.clipMask!==h.clipMask||!bl(a.clipScope,h.clipScope),++i}}if(l){++this._updateTime;for(const a of this._activeRegions)a.order!==nv&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,a.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,a.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,a.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,a.max.y));const i=a=>{const h=this._activeRegions;if(a>=h.length)return a;const f=h[a].priority;for(;a<h.length&&h[a].priority===f;)++a;return a};if(this._sourceIds.length>1){let a=0,h=i(a);for(;a!==h;){let f=a;const _=a;for(;f!==h;){const y=this._activeRegions[f];y.hiddenByOverlap=!1;for(let x=0;x<_;x++){const C=this._activeRegions[x];if(!C.hiddenByOverlap&&y.order===nv&&bC(y,C)&&(y.hiddenByOverlap=Pk(y.footprint,y.tileId,C.footprint,C.tileId),y.hiddenByOverlap))break}++f}a=h,h=i(a)}}}}_setSources(l){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let i=l.length-1;i>=0;i--)this._addSource(l[i]);this._computeReplacement()}},o.eH=nv,o.eI=class{constructor(l){this._createGrid(l),this._createPoles(l)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const l of this._poleSegments)l.destroy();for(const l of this._gridSegments)l.withSkirts.destroy(),l.withoutSkirts.destroy()}_fillGridMeshWithLods(l,i){const a=new Md,h=new bs,f=[],_=l+1+2,y=i[0]+1,x=i[0]+1+(1+i.length),C=(I,R,P)=>{let L=I===_-1?I-2:I===0?I:I-1;return L+=P?24575:0,[L,R]};for(let I=0;I<_;++I)a.emplaceBack(...C(I,0,!0));for(let I=0;I<y;++I)for(let R=0;R<_;++R)a.emplaceBack(...C(R,I,(R===0||R===_-1)&&!0));for(let I=0;I<i.length;++I){const R=i[I];for(let P=0;P<_;++P)a.emplaceBack(...C(P,R,!0))}for(let I=0;I<i.length;++I){const R=h.length,P=i[I]+1+2,L=new bs;for(let q=0;q<P-1;q++){const Z=q===P-2,K=Z?_*(x-i.length+I-q):_;for(let ae=0;ae<_-1;ae++){const ue=q*_+ae;q===0||Z||ae===0||ae===_-2?(L.emplaceBack(ue+1,ue,ue+K),L.emplaceBack(ue+K,ue+K+1,ue+1)):(h.emplaceBack(ue+1,ue,ue+K),h.emplaceBack(ue+K,ue+K+1,ue+1))}}const $=ro.simpleSegment(0,R,a.length,h.length-R);for(let q=0;q<L.uint16.length;q+=3)h.emplaceBack(L.uint16[q],L.uint16[q+1],L.uint16[q+2]);const j=ro.simpleSegment(0,R,a.length,h.length-R);f.push({withoutSkirts:$,withSkirts:j})}return{vertices:a,indices:h,segments:f}}_createGrid(l){const i=this._fillGridMeshWithLods(E,k);this._gridSegments=i.segments,this._gridBuffer=l.createVertexBuffer(i.vertices,GA.members),this._gridIndexBuffer=l.createIndexBuffer(i.indices,!0)}_createPoles(l){const i=new bs;for(let y=0;y<=E;y++)i.emplaceBack(0,y+1,y+2);this._poleIndexBuffer=l.createIndexBuffer(i,!0);const a=new Rh,h=new Rh,f=new Rh,_=new Rh;this._poleSegments=[];for(let y=0,x=0;y<v;y++){const C=360/(1<<y);a.emplaceBack(0,-m,0,.5,0),h.emplaceBack(0,-m,0,.5,1),f.emplaceBack(0,-m,0,.5,.5),_.emplaceBack(0,-m,0,.5,.5);for(let I=0;I<=E;I++){let R=I/E,P=0;const L=Pn(0,C,R),[$,j,q]=U(v7,b7,L,m);a.emplaceBack($,j,q,R,P),h.emplaceBack($,j,q,R,1-P);const Z=Xe(L);R=.5+.5*Math.sin(Z),P=.5+.5*Math.cos(Z),f.emplaceBack($,j,q,R,P),_.emplaceBack($,j,q,R,1-P)}this._poleSegments.push(ro.simpleSegment(x,0,66,64)),x+=66}this._poleNorthVertexBuffer=l.createVertexBuffer(a,c1,!1),this._poleSouthVertexBuffer=l.createVertexBuffer(h,c1,!1),this._texturedPoleNorthVertexBuffer=l.createVertexBuffer(f,c1,!1),this._texturedPoleSouthVertexBuffer=l.createVertexBuffer(_,c1,!1)}getGridBuffers(l,i){return[this._gridBuffer,this._gridIndexBuffer,i?this._gridSegments[l].withSkirts:this._gridSegments[l].withoutSkirts]}getPoleBuffers(l,i){return[i?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,i?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[l]]}},o.eJ=Ik,o.eK=Fe,o.eL=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},o.eM=Oe,o.eN=ht,o.eO=function(l,i,a){return l[0]=i[0]/a[0],l[1]=i[1]/a[1],l[2]=i[2]/a[2],l},o.eP=an,o.eQ=F,o.eR=Ur,o.eS=Zt,o.eT=function([l,i,a]){const h=Math.hypot(l,i,a),f=Math.atan2(l,a),_=.5*Math.PI-Math.acos(-i/h);return new W(Y(f),Y(_))},o.eU=mn,o.eV=LC,o.eW=function(l){const i=l.navigator?l.navigator.userAgent:null;return!!function(a){if(Cr==null){const h=a.navigator?a.navigator.userAgent:null;Cr=!!a.safari||!(!h||!(/\b(iPad|iPhone|iPod)\b/.test(h)||h.match("Safari")&&!h.match("Chrome")))}return Cr}(l)&&!(!i||!(i.match("Version/15.4")||i.match("Version/15.5")||i.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/)))},o.eX=function(l,i){Ns=l,Ks=i},o.eY=dC,o.eZ=JA,o.e_=function(l){const i=[0,0,0],a=Q(new Float64Array(16));return ce(a,l.pixelMatrix,l.globeMatrix),kn(i,i,a),new Dt(i[0],i[1])},o.ea=450,o.eb=7,o.ec=Ke,o.ed=function(l,i){if(l===i){var a=i[1],h=i[2],f=i[3],_=i[6],y=i[7],x=i[11];l[1]=i[4],l[2]=i[8],l[3]=i[12],l[4]=a,l[6]=i[9],l[7]=i[13],l[8]=h,l[9]=_,l[11]=i[14],l[12]=f,l[13]=y,l[14]=x}else l[0]=i[0],l[1]=i[4],l[2]=i[8],l[3]=i[12],l[4]=i[1],l[5]=i[5],l[6]=i[9],l[7]=i[13],l[8]=i[2],l[9]=i[6],l[10]=i[10],l[11]=i[14],l[12]=i[3],l[13]=i[7],l[14]=i[11],l[15]=i[15];return l},o.ee=UV,o.ef=ki,o.eg=Xf,o.eh=256,o.ei=cC,o.ej=Ga,o.ek=je,o.el=function(l,i){return l[0]=i[0],l[1]=i[1],l[2]=i[2],l[3]=i[4],l[4]=i[5],l[5]=i[6],l[6]=i[8],l[7]=i[9],l[8]=i[10],l},o.em=Rh,o.en=Uy,o.eo=yt,o.ep=function(l,i,a,h,f){return Le((l-i)/(a-i)*(f-h)+h,h,f)},o.eq=yi,o.er=function(l,i){var a=i[0],h=i[1],f=i[2],_=i[3],y=i[4],x=i[5],C=i[6],I=i[7],R=i[8],P=R*y-x*I,L=-R*_+x*C,$=I*_-y*C,j=a*P+h*L+f*$;return j?(l[0]=P*(j=1/j),l[1]=(-R*h+f*I)*j,l[2]=(x*h-f*y)*j,l[3]=L*j,l[4]=(R*a-f*C)*j,l[5]=(-x*a+f*_)*j,l[6]=$*j,l[7]=(-I*a+h*C)*j,l[8]=(y*a-h*_)*j,l):null},o.es=2,o.et=Br,o.eu=zC,o.ev=[1,1,1],o.ew=v_,o.ex=On,o.ey=function(l,i,a,h){var f=i[0],_=i[1],y=i[2],x=i[3];return l[0]=f+h*(a[0]-f),l[1]=_+h*(a[1]-_),l[2]=y+h*(a[2]-y),l[3]=x+h*(a[3]-x),l},o.ez=f_,o.f=function(l){return btoa(encodeURIComponent(l).replace(/%([0-9A-F]{2})/g,(i,a)=>String.fromCharCode(+("0x"+a))))},o.f0=function(){S1().acquire(IC)},o.f1=wh,o.f2=function(l,i,a=!1){if(Gs===Ra.deferred||Gs===Ra.loading||Gs===Ra.loaded)throw new Error("setRTLTextPlugin cannot be called multiple times.");Cc=Ko.resolveURL(l),Gs=Ra.deferred,Sc=i,xh(),a||ou()},o.f3=function(l){u_=Ko.resolveURL(l),d_||(d_=new c_(S1(),new Ta)),d_.broadcast("setMeshoptUrl",u_)},o.f4=iR,o.f5=function(l){kC=Ko.resolveURL(l),d_||(d_=new c_(S1(),new Ta)),d_.broadcast("setDracoUrl",kC)},o.f6=nR,o.f7=av,o.f8=function(l){const i=Tl();if(!i)return;const a=i.delete(Xo);l&&a.then(()=>l()).catch(l)},o.f9=km,o.fA=function(l){Zl(),vs!=null&&vs.then(i=>{i.keys().then(a=>{for(let h=0;h<a.length-l;h++)i.delete(a[h]).catch(f=>li(f.message))}).catch(a=>li(a.message))}).catch(i=>li(i.message))},o.fa=en,o.fb=Qf,o.fc=Ku,o.fd=AM,o.fe=kM,o.ff=ER,o.fg=ci,o.fh="hd_road_elevation",o.fi=Yr,o.fj=zn,o.fk=Oh,o.fl=XC,o.fm=Mm,o.fn=function(l,i,a,h,f,_,y,x=1,C,I,R){l.createArrays(),l.tilePixelRatio=Ut/(512*l.overscaling),l.compareText={},l.iconsNeedLinear=!1;const P=l.layers[0].layout,L=l.layers[0]._unevaluatedLayout._values,$={};$.scaleFactor=x,$.textSizeScaleRange=P.get("text-size-scale-range"),$.iconSizeScaleRange=P.get("icon-size-scale-range");const[j,q]=$.textSizeScaleRange,[Z,K]=$.iconSizeScaleRange;$.textScaleFactor=Le($.scaleFactor,j,q),$.iconScaleFactor=Le($.scaleFactor,Z,K);const ae=L["text-size"],ue=L["icon-size"];if(l.textSizeData.kind==="composite"){const{minZoom:Ze,maxZoom:_t}=l.textSizeData;$.compositeTextSizes=[ae.possiblyEvaluate(new Tr(Ze,{worldview:R}),_),ae.possiblyEvaluate(new Tr(_t,{worldview:R}),_)]}if(l.iconSizeData.kind==="composite"){const{minZoom:Ze,maxZoom:_t}=l.iconSizeData;$.compositeIconSizes=[ue.possiblyEvaluate(new Tr(Ze,{worldview:R}),_),ue.possiblyEvaluate(new Tr(_t,{worldview:R}),_)]}$.layoutTextSize=ae.possiblyEvaluate(new Tr(y+1,{worldview:R}),_),$.layoutIconSize=ue.possiblyEvaluate(new Tr(y+1,{worldview:R}),_),$.textMaxSize=ae.possiblyEvaluate(new Tr(18,{worldview:R}),_);const fe=P.get("symbol-placement"),Me=P.get("text-rotation-alignment")==="map"&&fe!=="point",De=P.get("text-size");let Ve=!1;const He=[];for(const Ze of l.features){const _t=P.get("text-font").evaluate(Ze,{},_).join(","),Je=De.evaluate(Ze,{},_)*$.textScaleFactor,bt=$.layoutTextSize.evaluate(Ze,{},_)*$.textScaleFactor,Mt=$.layoutIconSize.evaluate(Ze,{},_)*$.iconScaleFactor,Tt={horizontal:{},vertical:void 0},It=Ze.text;let zt,mt=[0,0];if(It){const vn=It.toString(),Fn=P.get("text-letter-spacing").evaluate(Ze,{},_)*Qs,Yn=P.get("text-line-height").evaluate(Ze,{},_)*Qs,gi=jg(vn)?Fn:0,ii=P.get("text-anchor").evaluate(Ze,{},_),un=P.get("text-variable-anchor");if(!un){const lt=P.get("text-radial-offset").evaluate(Ze,{},_);if(lt)mt=dP(ii,[lt*Qs,JC]);else{const gt=P.get("text-offset").evaluate(Ze,{},_);mt=[gt[0]*Qs,gt[1]*Qs]}}let Qn=Me?"center":P.get("text-justify").evaluate(Ze,{},_);const Pi=fe==="point",ge=Pi?P.get("text-max-width").evaluate(Ze,{},_)*Qs:1/0,ye=lt=>{l.allowVerticalPlacement&&um(vn)&&(Tt.vertical=qC(It,i,a,f,_t,ge,Yn,ii,lt,gi,mt,zl.vertical,!0,bt,Je,C))};if(!Me&&un){const lt=Qn==="auto"?un.map(Xt=>QC(Xt)):[Qn];let gt=!1;for(let Xt=0;Xt<lt.length;Xt++){const Kt=lt[Xt];if(!Tt.horizontal[Kt])if(gt)Tt.horizontal[Kt]=Tt.horizontal[0];else{const cn=qC(It,i,a,f,_t,ge,Yn,"center",Kt,gi,mt,zl.horizontal,!1,bt,Je,C);cn&&(Tt.horizontal[Kt]=cn,gt=cn.positionedLines.length===1)}}ye("left")}else{if(Qn==="auto"&&(Qn=QC(ii)),Pi||P.get("text-writing-mode").indexOf("horizontal")>=0||!um(vn)){const lt=qC(It,i,a,f,_t,ge,Yn,ii,Qn,gi,mt,zl.horizontal,!1,bt,Je,C);lt&&(Tt.horizontal[Qn]=lt)}ye(Pi?"left":Qn)}}let At,ct,rt,Bt,Ot,En,ln=!1;const pn=P.get("icon-text-fit").evaluate(Ze,{},_);if(Ze.icon&&Ze.icon.hasPrimary()){const vn=fP(Ze.icon,l.iconSizeData,L["icon-size"],_,l.zoom,Ze,C,$.iconScaleFactor,R);At=vn.iconPrimary,rt=vn.iconSecondary;const Fn=At.toString();if(ct=h.get(Fn),ct&&(Ot=P.get("icon-offset").evaluate(Ze,{},_),En=P.get("icon-anchor").evaluate(Ze,{},_),zt=vV(f.get(Fn),rt?f.get(rt.toString()):void 0,Ot,En),ln=ct.sdf,l.sdfIcons===void 0?l.sdfIcons=ct.sdf:l.sdfIcons!==ct.sdf&&li("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ct.pixelRatio!==l.pixelRatio||P.get("icon-rotate").constantOr(1)!==0)&&(l.iconsNeedLinear=!0)),rt){const Yn=rt.toString();Bt=h.get(Yn)}}Ve=Ve||!(!Ze.icon||!Ze.icon.hasSecondary());const Ht=e2(Tt.horizontal)||Tt.vertical;l.iconsInText||(l.iconsInText=!!Ht&&Ht.iconsInText);const Tn=bt*$.textScaleFactor/Qs,{defaultShapedIcon:qn,verticallyShapedIcon:Jt}=kV(l,zt,P,Ze,_,Tt,Tn,Ot,pn);pn!=="none"&&zt&&(KR(zt)||XR(zt))&&(L1(0,ct,At,zt,qn,pn,I,h,f),L1(0,Bt,rt,zt,qn,pn,I,h,f),Jt&&(L1(0,ct,At,zt,Jt,pn,I,h,f),L1(0,Bt,rt,zt,Jt,pn,I,h,f))),zt=qn,He.push({feature:Ze,shapedTextOrientations:Tt,shapedText:Ht,shapedIcon:zt,iconPrimary:At,iconSecondary:rt,iconOffset:Ot,iconAnchor:En,verticallyShapedIcon:Jt,layoutTextSize:bt,layoutIconSize:Mt,textOffset:mt,isSDFIcon:ln,iconTextFit:pn})}return{featureData:He,sizes:$,hasAnySecondaryIcon:Ve,textAlongLine:Me,symbolPlacement:fe}},o.fo=oP,o.fp=function(l,i,a,h,f,_,y,x,C,I){const{featureData:R,hasAnySecondaryIcon:P,sizes:L,textAlongLine:$,symbolPlacement:j}=i;for(const q of R){const{shapedIcon:Z,verticallyShapedIcon:K,feature:ae,shapedTextOrientations:ue,shapedText:fe,layoutTextSize:Me,textOffset:De,isSDFIcon:Ve,iconPrimary:He,iconSecondary:Ze,iconTextFit:_t,iconOffset:Je}=q;pP(Z,I.iconPositions,He,Ze),pP(K,I.iconPositions,He,Ze),AV(ue,I.iconPositions),IV(He,Ze,I.iconPositions),(fe||Z)&&RV(l,ae,ue,Z,K,C,L,Me,0,De,Ve,h,f,y,x,P,_t,Je,$,j)}a&&l.generateCollisionDebugBuffers(_,l.collisionBoxArray,L.textScaleFactor)},o.fq=Wn,o.fr=tx,o.fs=Rt,o.ft=function(l){let i=0;if(new Uint32Array(l,0,1)[0]!==oR){const a=new Uint32Array(l,0,7),[,,h,f,_,y]=a;i=a.byteLength+f+_+y+_,(h!==l.byteLength||i>=l.byteLength)&&li("Invalid b3dm header information.")}return cR(l,i)},o.fu=function(l,i){const a=_R(l);for(const h of a){for(const f of h.meshes)E9(f);h.lights&&(h.lightMeshIndex=h.meshes.length,h.meshes.push(I9(h.lights,i)))}return a},o.fv=K1,o.fw=ir,o.fx=eR,o.fy=Pl,o.fz=Ra,o.g=function(l,i){return Ci(Object.assign(l,{method:"GET"}),i)},o.h=function(l){return l.indexOf("mapbox:")===0},o.i=function(l){return ko.API_STYLE_REGEX.test(l)&&!pc(l)},o.j=Zs,o.k=Es,o.l=function(l){return decodeURIComponent(atob(l).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join(""))},o.m=function(l,i){return Ci(Object.assign(l,{type:"json"}),i)},o.n=Il,o.o=Ko,o.p=function(l,i){return Ci(Object.assign(l,{method:"POST"}),i)},o.q=la,o.r=Sl,o.s=function(l){try{const i=self[l];return i.setItem("_mapbox_test_",1),i.removeItem("_mapbox_test_"),!0}catch{return!1}},o.t=function(){return AC||(AC=new km),AC},o.u=function(){return function l(i){return i?(i^Math.random()*(16>>i/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,l)}()},o.v=function(l){return!!l&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(l)},o.w=li,o.x=m2,o.y=el,o.z=Vs}),u(["./shared"],function(o){function w(Xe){const Y=Xe?Xe.url.toString():void 0;return Y?performance.getEntriesByName(Y):[]}function T(Xe){if(typeof Xe=="number"||typeof Xe=="boolean"||typeof Xe=="string"||Xe==null)return JSON.stringify(Xe);if(Array.isArray(Xe)){let ie="[";for(const ve of Xe)ie+=`${T(ve)},`;return`${ie}]`}let Y="{";for(const ie of Object.keys(Xe).sort())Y+=`${ie}:${T(Xe[ie])},`;return`${Y}}`}function A(Xe){let Y="";for(const ie of o.bx)Y+=`/${T(Xe[ie])}`;return Y}class D{constructor(Y){this.keyCache={},this._layers={},this._layerConfigs={},Y&&this.replace(Y)}replace(Y,ie){this._layerConfigs={},this._layers={},this.update(Y,[],ie)}update(Y,ie,ve){this._options=ve;for(const Oe of Y)this._layerConfigs[Oe.id]=Oe,(this._layers[Oe.id]=o.dq(Oe,this.scope,null,this._options)).compileFilter(ve),this.keyCache[Oe.id]&&delete this.keyCache[Oe.id];for(const Oe of ie)delete this.keyCache[Oe],delete this._layerConfigs[Oe],delete this._layers[Oe];this.familiesBySource={};const Fe=function(Oe,Le){const it={};for(let st=0;st<Oe.length;st++){const Nt=Oe[st];let St=Le&&Le[Nt.id];St||(Nt.type==="symbol"?St=Nt.id:(St=A(Nt),Nt.type==="line"&&Nt.paint&&function Mn(zn){return typeof zn=="string"&&zn==="line-progress"||(Array.isArray(zn)?zn.some(Mn):!(!zn||typeof zn!="object")&&Object.values(zn).some(Mn))}(Nt.paint["line-width"])&&(St+=`/${T(Nt.paint["line-width"])}`))),Le&&(Le[Nt.id]=St);let xn=it[St];xn||(xn=it[St]=[]),xn.push(Nt)}const Ge=[];for(const st in it)Ge.push(it[st]);return Ge}(Object.values(this._layerConfigs),this.keyCache);for(const Oe of Fe){const Le=Oe.map(xn=>this._layers[xn.id]),it=Le[0];if(it.visibility==="none")continue;const Ge=it.source||"";let st=this.familiesBySource[Ge];st||(st=this.familiesBySource[Ge]={});const Nt=it.sourceLayer||"_geojsonTileLayer";let St=st[Nt];St||(St=st[Nt]=[]),St.push(Le)}}}const B=1*o.fc;class N{constructor(Y){const ie={},ve=[];for(const it in Y){const Ge=Y[it],st=ie[it]={};for(const Nt in Ge.glyphs){const St=Ge.glyphs[+Nt];if(!St||St.bitmap.width===0||St.bitmap.height===0)continue;const xn=St.metrics.localGlyph?B:1,Mn={x:0,y:0,w:St.bitmap.width+2*xn,h:St.bitmap.height+2*xn};ve.push(Mn),st[Nt]=Mn}}const{w:Fe,h:Oe}=o.G(ve),Le=new o.fb({width:Fe||1,height:Oe||1});for(const it in Y){const Ge=Y[it];for(const st in Ge.glyphs){const Nt=Ge.glyphs[+st];if(!Nt||Nt.bitmap.width===0||Nt.bitmap.height===0)continue;const St=ie[it][st],xn=Nt.metrics.localGlyph?B:1;o.fb.copy(Nt.bitmap,Le,{x:0,y:0},{x:St.x+xn,y:St.y+xn},Nt.bitmap)}}this.image=Le,this.positions=ie}}o.fa(N,"GlyphAtlas");class ee{constructor(Y){this.tileID=new o.aO(Y.tileID.overscaledZ,Y.tileID.wrap,Y.tileID.canonical.z,Y.tileID.canonical.x,Y.tileID.canonical.y),this.tileZoom=Y.tileZoom,this.uid=Y.uid,this.zoom=Y.zoom,this.lut=Y.lut,this.canonical=Y.tileID.canonical,this.pixelRatio=Y.pixelRatio,this.tileSize=Y.tileSize,this.source=Y.source,this.scope=Y.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Y.showCollisionBoxes,this.collectResourceTiming=!!Y.request&&Y.request.collectResourceTiming,this.promoteId=Y.promoteId,this.isSymbolTile=Y.isSymbolTile,this.tileTransform=o.aZ(Y.tileID.canonical,Y.projection),this.projection=Y.projection,this.worldview=Y.worldview,this.localizableLayerIds=Y.localizableLayerIds,this.brightness=Y.brightness,this.extraShadowCaster=!!Y.extraShadowCaster,this.tessellationStep=Y.tessellationStep,this.scaleFactor=Y.scaleFactor,this.worldview=Y.worldview}parse(Y,ie,ve,Fe,Oe,Le){this.status="parsing",this.data=Y,this.collisionBoxArray=new o.b3;const it=new o.fd(Object.keys(Y.layers).sort()),Ge=new o.fe(this.tileID,this.promoteId);Ge.bucketLayerIDs=[];const st={},Nt=new o.ff(256,256),St={featureIndex:Ge,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:Nt,availableImages:ve,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},xn=[],Mn=ie.familiesBySource[this.source];for(const Kn in Mn){const Un=Y.layers[Kn];if(!Un)continue;let ei=!1,Ei=!1,li=!1;for(const ir of Mn[Kn])ir[0].type==="symbol"?ei=!0:Ei=!0,ir[0].is3D()&&ir[0].type!=="model"&&(li=!0);if(this.extraShadowCaster&&!li||this.isSymbolTile===!0&&!ei||this.isSymbolTile===!1&&!Ei)continue;Un.version===1&&o.w(`Vector tile source "${this.source}" layer "${Kn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const cr=it.encode(Kn),Fr=[];let no=!1;for(let ir=0,Oi=0;ir<Un.length;ir++){const Cr=Un.feature(ir),Pr=Ge.getId(Cr,Kn);if(this.localizableLayerIds&&this.localizableLayerIds.has(Kn)){const ur=Cr.properties?Cr.properties.worldview:null;if(this.worldview&&typeof ur=="string")if(ur==="all")Cr.properties.$localized=!0;else{if(!ur.split(",").includes(this.worldview))continue;Cr.properties.$localized=!0,Cr.properties.worldview=this.worldview}}!no&&Cr.properties&&Cr.properties.hasOwnProperty(o.fg)&&(no=!0),Fr.push({feature:Cr,id:Pr,index:Oi,sourceLayerIndex:cr}),Oi++}no&&!St.elevationFeatures&&Y.layers.hasOwnProperty(o.fh)&&(St.elevationFeatures=o.fi.parseFrom(Y.layers[o.fh],this.canonical));for(const ir of Mn[Kn]){const Oi=ir[0];if(this.extraShadowCaster&&(!Oi.is3D()||Oi.type==="model")||this.isSymbolTile!==void 0&&Oi.type==="symbol"!==this.isSymbolTile||Oi.minzoom&&this.zoom<Math.floor(Oi.minzoom)||Oi.maxzoom&&this.zoom>=Oi.maxzoom||Oi.visibility==="none")continue;Q(ir,this.zoom,St.brightness,ve,this.worldview);const Cr=st[Oi.id]=Oi.createBucket({index:Ge.bucketLayerIDs.length,layers:ir,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:cr,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep,styleDefinedModelURLs:Fe,worldview:this.worldview});Ge.bucketLayerIDs.push(ir.map(ur=>o.B(ur.id,ur.scope)));let Pr=Cr.prepare?Cr.prepare():null;Pr!=null?(Pr=Pr.then(()=>Cr.populate(Fr,St,this.tileID.canonical,this.tileTransform)),xn.push(Pr)):Cr.populate(Fr,St,this.tileID.canonical,this.tileTransform)}}const zn=()=>{let Kn,Un,ei,Ei,li,cr;Nt.trim();const Fr={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},no=()=>{if(Kn)return this.status="done",Le(Kn);if(this.extraShadowCaster)this.status="done",Le(null,{buckets:Object.values(st).filter(Oi=>!Oi.isEmpty()),featureIndex:Ge,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:St.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Un&&ei&&Ei){const Oi=new N(Un),Cr=new Map;for(const[Zo,Ts]of ei.entries()){const{imagePosition:ta}=o.fl(Zo,Ts,o.fm);Cr.set(Zo,ta)}const Pr={};for(const Zo in st){const Ts=st[Zo];Ts instanceof o.b4&&(Q(Ts.layers,this.zoom,St.brightness,ve,this.worldview),Pr[Zo]=o.fn(Ts,Un,Oi.positions,ei,Cr,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio,li,this.worldview))}const ur={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(Oe,ei,li,()=>{ur.iconsPending=!1,ir(Pr,Oi,ur)}),this.rasterizeIfNeeded(Oe,Ei,cr,()=>{ur.patternsPending=!1,ir(Pr,Oi,ur)})}},ir=(Oi,Cr,Pr,ur)=>{if(Pr.iconsPending||Pr.patternsPending)return;const Zo=new o.fo(ei,Ei,this.lut);for(const Ts in st){const ta=st[Ts];if(Ts in Oi)o.fp(ta,Oi[Ts],this.showCollisionBoxes,ve,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,ei,Zo);else if(ta.hasPattern&&(ta instanceof o.ba||ta instanceof o.bb||ta instanceof o.e7)){Q(ta.layers,this.zoom,St.brightness,ve,this.worldview);const Ya=Object.fromEntries(Zo.patternPositions);ta.addFeatures(St,this.tileID.canonical,Ya,ve,this.tileTransform,this.brightness)}}this.status="done",Le(null,{buckets:Object.values(st).filter(Ts=>!Ts.isEmpty()),featureIndex:Ge,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Cr.image,lineAtlas:Nt,imageAtlas:Zo,brightness:St.brightness})};if(!this.extraShadowCaster){const Oi=o.fj(St.glyphDependencies,ur=>Object.keys(ur).map(Number));Object.keys(Oi).length?Oe.send("getGlyphs",{uid:this.uid,stacks:Oi},(ur,Zo)=>{Kn||(Kn=ur,Un=Zo,no())},void 0,!1,Fr):Un={};const Cr=Array.from(St.iconDependencies.keys()).map(ur=>o.I.parse(ur));Cr.length?Oe.send("getImages",{images:Cr,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(ur,Zo)=>{Kn||(Kn=ur,ei=new Map,li=this.updateImageMapAndGetImageTaskQueue(ei,Zo,St.iconDependencies),no())},void 0,!1,Fr):(ei=new Map,li=new Map);const Pr=Array.from(St.patternDependencies.keys()).map(ur=>o.I.parse(ur));Pr.length?Oe.send("getImages",{images:Pr,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(ur,Zo)=>{Kn||(Kn=ur,Ei=new Map,cr=this.updateImageMapAndGetImageTaskQueue(Ei,Zo,St.patternDependencies),no())},void 0,!1,Fr):(Ei=new Map,cr=new Map)}if(St.elevationFeatures&&St.elevationFeatures.length>0){const Oi=[];for(const Pr of Object.values(st))if(Pr instanceof o.bb){const ur=Pr.getUnevaluatedPortalGraph();ur&&Oi.push(ur)}const Cr=o.fk.evaluate(Oi);for(const Pr of Object.values(st))if(Pr instanceof o.bb){const ur=Y.layers[it.decode(Pr.sourceLayerIndex)];Pr.setEvaluatedPortalGraph(Cr,ur,this.tileID.canonical,St.availableImages,St.brightness)}}no()};xn.length>0?Promise.allSettled(xn).then(zn).catch(Le):zn()}rasterizeIfNeeded(Y,ie,ve,Fe){Array.from(ie.values()).some(Oe=>Oe.usvg)?this.rasterize(Y,ie,ve,Fe):Fe()}updateImageMapAndGetImageTaskQueue(Y,ie,ve){const Fe=new Map;for(const Oe of ie.keys()){const Le=ve.get(Oe)||[];for(const it of Le){const Ge=it.toString(),st=ie.get(it.id.toString());st.usvg?Fe.has(Ge)||(Fe.set(Ge,it),Y.set(Ge,Object.assign({},st))):Y.set(Ge,st)}}return Fe}rasterize(Y,ie,ve,Fe){this.rasterizeTask=Y.send("rasterizeImages",{scope:this.scope,tasks:ve},(Oe,Le)=>{if(!Oe)for(const[it,Ge]of Le.entries()){const st=Object.assign(ie.get(it),{data:Ge});ie.set(it,st)}Fe()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function Q(Xe,Y,ie,ve,Fe){const Oe=new o.ac(Y,{brightness:ie,worldview:Fe});for(const Le of Xe)Le.recalculate(Oe,ve)}class se extends o.E{constructor(Y,ie,ve,Fe,Oe,Le,it){super(),this.actor=Y,this.layerIndex=ie,this.availableImages=ve,this.availableModels=Fe,this.loadVectorData=Le||o.aL,this.loading={},this.loaded={},this.deduped=new o.aK(Y.scheduler),this.isSpriteLoaded=Oe,this.scheduler=Y.scheduler,this.brightness=it}loadTile(Y,ie){const ve=Y.uid,Fe=Y&&Y.request,Oe=Fe&&Fe.collectResourceTiming,Le=this.loading[ve]=new ee(Y);Le.abort=this.loadVectorData(Y,(it,Ge)=>{const st=!this.loading[ve];if(delete this.loading[ve],Le.cancelRasterize(),st||it||!Ge)return Le.status="done",st||(this.loaded[ve]=Le),ie(it);const Nt=Ge.rawData,St={};Ge.expires&&(St.expires=Ge.expires),Ge.cacheControl&&(St.cacheControl=Ge.cacheControl),Le.vectorTile=Ge.vectorTile||new o.fq(new o.bt(Nt));const xn=()=>{Le.parse(Le.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,(Mn,zn)=>{if(Mn||!zn)return ie(Mn);const Kn={};if(Oe){const Un=w(Fe);Un.length>0&&(Kn.resourceTiming=JSON.parse(JSON.stringify(Un)))}ie(null,Object.assign({rawTileData:Nt.slice(0)},zn,St,Kn))})};this.isSpriteLoaded?xn():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(xn,{type:"parseTile",isSymbolTile:Y.isSymbolTile,zoom:Y.tileZoom}):xn()}),this.loaded=this.loaded||{},this.loaded[ve]=Le})}reloadTile(Y,ie){const ve=this.loaded,Fe=Y.uid;if(ve&&ve[Fe]){const Oe=ve[Fe];Oe.scaleFactor=Y.scaleFactor,Oe.showCollisionBoxes=Y.showCollisionBoxes,Oe.projection=Y.projection,Oe.brightness=Y.brightness,Oe.tileTransform=o.aZ(Y.tileID.canonical,Y.projection),Oe.extraShadowCaster=Y.extraShadowCaster,Oe.lut=Y.lut,Oe.worldview=Y.worldview;const Le=(it,Ge)=>{const st=Oe.reloadCallback;st&&(delete Oe.reloadCallback,Oe.parse(Oe.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,st)),ie(it,Ge)};Oe.status==="parsing"?Oe.reloadCallback=Le:Oe.status==="done"&&(Oe.vectorTile?Oe.parse(Oe.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,Le):Le())}else ie(null,void 0)}abortTile(Y,ie){const ve=Y.uid,Fe=this.loading[ve];Fe&&(Fe.abort&&Fe.abort(),delete this.loading[ve]),ie()}removeTile(Y,ie){const ve=this.loaded,Fe=Y.uid;ve&&ve[Fe]&&delete ve[Fe],ie()}}class ce{loadTile(Y,ie){const{uid:ve,encoding:Fe,rawImageData:Oe,padding:Le}=Y,it=ImageBitmap&&Oe instanceof ImageBitmap?this.getImageData(Oe,Le):Oe;ie(null,new o.fr(ve,it,Fe,Le<1))}reloadTile(Y,ie){ie(null,null)}abortTile(Y,ie){ie()}removeTile(Y,ie){ie()}getImageData(Y,ie){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Y.width,Y.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Y.width,this.offscreenCanvas.height=Y.height,this.offscreenCanvasContext.drawImage(Y,0,0,Y.width,Y.height);const ve=this.offscreenCanvasContext.getImageData(-ie,-ie,Y.width+2*ie,Y.height+2*ie);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ve}}o.bs.setPbf(o.bt);class be{constructor(Y){this._mrt=new o.bs(Y.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=Y.uid,this.tileID=Y.tileID,this.source=Y.source}parse(Y,ie){const ve=this._mrt;this.status="parsing",this._entireBuffer=Y;try{ve.parseHeader(Y),this._isHeaderLoaded=!0;const Fe=[];for(const Oe in ve.layers){const Le=ve.getLayer(Oe),it=Le.getDataRange(Le.getBandList()),Ge=ve.createDecodingTask(it),st=Y.slice(it.firstByte,it.lastByte+1),Nt=o.bs.performDecoding(st,Ge).then(St=>Ge.complete(null,St)).catch(St=>Ge.complete(St,null));Fe.push(Nt)}Promise.allSettled(Fe).then(()=>ie(null,ve)).catch(Oe=>ie(Oe))}catch(Fe){ie(Fe)}}}class ze{constructor(Y){this.actor=Y,this.loading={},this.loaded={}}loadTile(Y,ie){const ve=Y.uid,Fe=Y.request,Oe=this.loading[ve]=new be(Y),{cancel:Le}=o.bu(Fe,(it,Ge,st,Nt)=>{const St=!this.loading[ve];if(delete this.loading[ve],St||it||!Ge)return Oe.status="done",St||(this.loaded[ve]=Oe),ie(it);Oe.parse(Ge,(xn,Mn)=>{if(xn||!Mn)return ie(xn);ie(null,Mn,st,Nt)}),this.loaded[ve]=Oe});Oe.abort=Le}reloadTile(Y,ie){ie(null,void 0)}abortTile(Y,ie){const ve=Y.uid,Fe=this.loading[ve];Fe&&(Fe.abort&&Fe.abort(),delete this.loading[ve]),ie()}removeTile(Y,ie){const ve=Y.uid;this.loaded[ve]&&delete this.loaded[ve],ie()}decodeRasterArray(Y,ie){o.bs.performDecoding(Y.buffer,Y.task).then(ve=>ie(null,ve)).catch(ve=>ie(ve))}}const xe=o.fs.prototype.toGeoJSON;class je{constructor(Y){this._feature=Y,this.extent=o.al,this.type=Y.type,this.properties=Y.tags,"id"in Y&&!isNaN(Y.id)&&(this.id=parseInt(Y.id,10))}loadGeometry(){if(this._feature.type===1){const Y=[];for(const ie of this._feature.geometry)Y.push([new o.P(ie[0],ie[1])]);return Y}{const Y=[];for(const ie of this._feature.geometry){const ve=[];for(const Fe of ie)ve.push(new o.P(Fe[0],Fe[1]));Y.push(ve)}return Y}}toGeoJSON(Y,ie,ve){return xe.call(this,Y,ie,ve)}}class qe{constructor(Y,ie){this.name=Y,this.extent=o.al,this.length=ie.length,this._jsonFeatures=ie}feature(Y){return new je(this._jsonFeatures[Y])}}class oe{constructor(Y){this.layers={},this.extent=o.al;for(const ie of Object.keys(Y))this.layers[ie]=new qe(ie,Y[ie])}}const de=64/4096,Ee=128;class $e{constructor(){this.features=new Map}clear(){this.features.clear()}load(Y=[],ie){for(const ve of Y){const Fe=ve.id;if(Fe==null)continue;let Oe=this.features.get(Fe);Oe&&this.updateCache(Oe,ie),ve.geometry?(Oe=Te(ve),this.updateCache(Oe,ie),this.features.set(Fe,Oe)):this.features.delete(Fe),this.updateCache(Oe,ie)}}updateCache(Y,ie){for(const{canonical:ve,uid:Fe}of Object.values(ie)){const{z:Oe,x:Le,y:it}=ve;me(Y,Math.pow(2,Oe),Le,it)&&delete ie[Fe]}}getTile(Y,ie,ve){const Fe=Math.pow(2,Y),Oe=[];for(const Le of this.features.values())me(Le,Fe,ie,ve)&&Oe.push(on(Le,Fe,ie,ve));return{features:Oe}}getFeatures(){return[...this.features.values()]}}function me({minX:Xe,minY:Y,maxX:ie,maxY:ve},Fe,Oe,Le){return Xe<(Oe+1+de)/Fe&&Y<(Le+1+de)/Fe&&ie>(Oe-de)/Fe&&ve>(Le-de)/Fe}function Te(Xe){const{id:Y,geometry:ie,properties:ve}=Xe;if(!ie)return;if(ie.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:Fe,coordinates:Oe}=ie,Le={id:Y,type:1,geometry:[],tags:ve,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},it=Le.geometry;if(Fe==="Point")Re(Oe,it,Le);else if(Fe==="MultiPoint")for(const Ge of Oe)Re(Ge,it,Le);else if(Fe==="LineString")Le.type=2,tn(Oe,it,Le);else if(Fe==="MultiLineString")Le.type=2,Zt(Oe,it,Le);else if(Fe==="Polygon")Le.type=3,Zt(Oe,it,Le,!0);else{if(Fe!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");Le.type=3;for(const Ge of Oe)Zt(Ge,it,Le,!0)}return Le}function Re([Xe,Y],ie,ve){const Fe=o.aF(Xe);let Oe=o.aJ(Y);Oe=Oe<0?0:Oe>1?1:Oe,ie.push(Fe,Oe),ve.minX=Math.min(ve.minX,Fe),ve.minY=Math.min(ve.minY,Oe),ve.maxX=Math.max(ve.maxX,Fe),ve.maxY=Math.max(ve.maxY,Oe)}function tn(Xe,Y,ie,ve=!1,Fe=!1){const Oe=[];for(const Le of Xe)Re(Le,Oe,ie);Y.push(Oe),ve&&function(Le,it){let Ge=0;for(let st=0,Nt=Le.length,St=Nt-2;st<Nt;St=st,st+=2)Ge+=(Le[st]-Le[St])*(Le[st+1]+Le[St+1]);if(Ge>0===it)for(let st=0,Nt=Le.length;st<Nt/2;st+=2){const St=Le[st],xn=Le[st+1];Le[st]=Le[Nt-2-st],Le[st+1]=Le[Nt-1-st],Le[Nt-2-st]=St,Le[Nt-1-st]=xn}}(Oe,Fe)}function Zt(Xe,Y,ie,ve=!1){for(let Fe=0;Fe<Xe.length;Fe++)tn(Xe[Fe],Y,ie,ve,Fe===0)}function on(Xe,Y,ie,ve){const{id:Fe,type:Oe,geometry:Le,tags:it}=Xe,Ge=[];if(Oe===1)(function(st,Nt,St,xn,Mn){for(let zn=0;zn<st.length;zn+=2){const Kn=Math.round(o.al*(st[zn+0]*Nt-St)),Un=Math.round(o.al*(st[zn+1]*Nt-xn));Mn.push([Kn,Un])}})(Le,Y,ie,ve,Ge);else for(const st of Le)hn(st,Y,ie,ve,Ge);return{id:Fe,type:Oe,geometry:Ge,tags:it}}function hn(Xe,Y,ie,ve,Fe){const Oe=-Ee,Le=o.al+Ee;let it;for(let Ge=0;Ge<Xe.length-2;Ge+=2){let st=Math.round(o.al*(Xe[Ge+0]*Y-ie)),Nt=Math.round(o.al*(Xe[Ge+1]*Y-ve)),St=Math.round(o.al*(Xe[Ge+2]*Y-ie)),xn=Math.round(o.al*(Xe[Ge+3]*Y-ve));const Mn=St-st,zn=xn-Nt;st<Oe&&St<Oe||(st<Oe?(Nt+=Math.round(zn*((Oe-st)/Mn)),st=Oe):St<Oe&&(xn=Nt+Math.round(zn*((Oe-st)/Mn)),St=Oe),Nt<Oe&&xn<Oe||(Nt<Oe?(st+=Math.round(Mn*((Oe-Nt)/zn)),Nt=Oe):xn<Oe&&(St=st+Math.round(Mn*((Oe-Nt)/zn)),xn=Oe),st>=Le&&St>=Le||(st>=Le?(Nt+=Math.round(zn*((Le-st)/Mn)),st=Le):St>=Le&&(xn=Nt+Math.round(zn*((Le-st)/Mn)),St=Le),Nt>=Le&&xn>=Le||(Nt>=Le?(st+=Math.round(Mn*((Le-Nt)/zn)),Nt=Le):xn>=Le&&(St=st+Math.round(Mn*((Le-Nt)/zn)),xn=Le),it&&st===it[it.length-1][0]&&Nt===it[it.length-1][1]||(it=[[st,Nt]],Fe.push(it)),it.push([St,xn])))))}}function Hn({name:Xe,features:Y},ie){ie.writeStringField(1,Xe),ie.writeVarintField(5,o.al);const ve=new Map,Fe=new Map,Oe={keys:ve,values:Fe,feature:null};for(const Le of Y)Oe.feature=Le,ie.writeMessage(2,Ri,Oe);for(const Le of ve.keys())ie.writeStringField(3,Le);for(const Le of Fe.keys())ie.writeMessage(4,Ur,Le)}function Ri(Xe,Y){const ie=Xe.feature;ie.id!==void 0&&Number.isSafeInteger(+ie.id)&&Y.writeVarintField(1,+ie.id),ie.tags&&Y.writeMessage(2,zi,Xe),Y.writeVarintField(3,ie.type),Y.writeMessage(4,wo,ie)}function zi({keys:Xe,values:Y,feature:ie},ve){for(const Fe of Object.keys(ie.tags)){let Oe=ie.tags[Fe];if(Oe===null)continue;let Le=Xe.get(Fe);Le===void 0&&(Le=Xe.size,Xe.set(Fe,Le)),ve.writeVarint(Le);const it=typeof Oe;it!=="string"&&it!=="boolean"&&it!=="number"&&(Oe=JSON.stringify(Oe));let Ge=Y.get(Oe);Ge===void 0&&(Ge=Y.size,Y.set(Oe,Ge)),ve.writeVarint(Ge)}}function Pt(Xe,Y){return(Y<<3)+(7&Xe)}function Di(Xe){return Xe<<1^Xe>>31}function wo(Xe,Y){const{geometry:ie,type:ve}=Xe;let Fe=0,Oe=0;if(ve===1){Y.writeVarint(Pt(1,ie.length));for(const Le of ie){const it=Le[0]-Fe,Ge=Le[1]-Oe;Y.writeVarint(Di(it)),Y.writeVarint(Di(Ge)),Fe+=it,Oe+=Ge}}else for(const Le of ie){Y.writeVarint(Pt(1,1));const it=Le.length-(ve===3?1:0);for(let Ge=0;Ge<it;Ge++){Ge===1&&Y.writeVarint(Pt(2,it-1));const st=Le[Ge][0]-Fe,Nt=Le[Ge][1]-Oe;Y.writeVarint(Di(st)),Y.writeVarint(Di(Nt)),Fe+=st,Oe+=Nt}ve===3&&Y.writeVarint(Pt(7,1))}}function Ur(Xe,Y){const ie=typeof Xe;ie==="string"?Y.writeStringField(1,Xe):ie==="boolean"?Y.writeBooleanField(7,Xe):ie==="number"&&(Xe%1!=0?Y.writeDoubleField(3,Xe):Xe<0?Y.writeSVarintField(6,Xe):Y.writeVarintField(5,Xe))}const Br={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Xe=>Xe},ai=Math.fround||(Ft=new Float32Array(1),Xe=>(Ft[0]=+Xe,Ft[0]));var Ft;const In=3,Wt=5,kn=6;class dr{constructor(Y){this.options=Object.assign(Object.create(Br),Y),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Y){const{log:ie,minZoom:ve,maxZoom:Fe}=this.options;ie&&console.time("total time");const Oe=`prepare ${Y.length} points`;ie&&console.time(Oe),this.points=Y;const Le=[];for(let Ge=0;Ge<Y.length;Ge++){const st=Y[Ge];if(!st.geometry)continue;const[Nt,St]=st.geometry.coordinates,xn=ai(vt(Nt)),Mn=ai(Gt(St));Le.push(xn,Mn,1/0,Ge,-1,1),this.options.reduce&&Le.push(0)}let it=this.trees[Fe+1]=this._createTree(Le);ie&&console.timeEnd(Oe);for(let Ge=Fe;Ge>=ve;Ge--){const st=+Date.now();it=this.trees[Ge]=this._createTree(this._cluster(it,Ge)),ie&&console.log("z%d: %d clusters in %dms",Ge,it.numItems,+Date.now()-st)}return ie&&console.timeEnd("total time"),this}getClusters(Y,ie){let ve=((Y[0]+180)%360+360)%360-180;const Fe=Math.max(-90,Math.min(90,Y[1]));let Oe=Y[2]===180?180:((Y[2]+180)%360+360)%360-180;const Le=Math.max(-90,Math.min(90,Y[3]));if(Y[2]-Y[0]>=360)ve=-180,Oe=180;else if(ve>Oe){const St=this.getClusters([ve,Fe,180,Le],ie),xn=this.getClusters([-180,Fe,Oe,Le],ie);return St.concat(xn)}const it=this.trees[this._limitZoom(ie)],Ge=it.range(vt(ve),Gt(Le),vt(Oe),Gt(Fe)),st=it.data,Nt=[];for(const St of Ge){const xn=this.stride*St;Nt.push(st[xn+Wt]>1?Qe(st,xn,this.clusterProps):this.points[st[xn+In]])}return Nt}getChildren(Y){const ie=this._getOriginId(Y),ve=this._getOriginZoom(Y),Fe="No cluster with the specified id.",Oe=this.trees[ve];if(!Oe)throw new Error(Fe);const Le=Oe.data;if(ie*this.stride>=Le.length)throw new Error(Fe);const it=this.options.radius/(this.options.extent*Math.pow(2,ve-1)),Ge=Oe.within(Le[ie*this.stride],Le[ie*this.stride+1],it),st=[];for(const Nt of Ge){const St=Nt*this.stride;Le[St+4]===Y&&st.push(Le[St+Wt]>1?Qe(Le,St,this.clusterProps):this.points[Le[St+In]])}if(st.length===0)throw new Error(Fe);return st}getLeaves(Y,ie,ve){const Fe=[];return this._appendLeaves(Fe,Y,ie=ie||10,ve=ve||0,0),Fe}getTile(Y,ie,ve){const Fe=this.trees[this._limitZoom(Y)],Oe=Math.pow(2,Y),{extent:Le,radius:it}=this.options,Ge=it/Le,st=(ve-Ge)/Oe,Nt=(ve+1+Ge)/Oe,St={features:[]};return this._addTileFeatures(Fe.range((ie-Ge)/Oe,st,(ie+1+Ge)/Oe,Nt),Fe.data,ie,ve,Oe,St),ie===0&&this._addTileFeatures(Fe.range(1-Ge/Oe,st,1,Nt),Fe.data,Oe,ve,Oe,St),ie===Oe-1&&this._addTileFeatures(Fe.range(0,st,Ge/Oe,Nt),Fe.data,-1,ve,Oe,St),St.features.length?St:null}getClusterExpansionZoom(Y){let ie=this._getOriginZoom(Y)-1;for(;ie<=this.options.maxZoom;){const ve=this.getChildren(Y);if(ie++,ve.length!==1)break;Y=ve[0].properties.cluster_id}return ie}_appendLeaves(Y,ie,ve,Fe,Oe){const Le=this.getChildren(ie);for(const it of Le){const Ge=it.properties;if(Ge&&Ge.cluster?Oe+Ge.point_count<=Fe?Oe+=Ge.point_count:Oe=this._appendLeaves(Y,Ge.cluster_id,ve,Fe,Oe):Oe<Fe?Oe++:Y.push(it),Y.length===ve)break}return Oe}_createTree(Y){const ie=new o.c3(Y.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ve=0;ve<Y.length;ve+=this.stride)ie.add(Y[ve],Y[ve+1]);return ie.finish(),ie.data=Y,ie}_addTileFeatures(Y,ie,ve,Fe,Oe,Le){for(const it of Y){const Ge=it*this.stride,st=ie[Ge+Wt]>1;let Nt,St,xn;if(st)Nt=at(ie,Ge,this.clusterProps),St=ie[Ge],xn=ie[Ge+1];else{const Kn=this.points[ie[Ge+In]];Nt=Kn.properties;const[Un,ei]=Kn.geometry.coordinates;St=vt(Un),xn=Gt(ei)}const Mn={type:1,geometry:[[Math.round(this.options.extent*(St*Oe-ve)),Math.round(this.options.extent*(xn*Oe-Fe))]],tags:Nt};let zn;zn=st||this.options.generateId?ie[Ge+In]:this.points[ie[Ge+In]].id,zn!==void 0&&(Mn.id=zn),Le.features.push(Mn)}}_limitZoom(Y){return Math.max(this.options.minZoom,Math.min(Math.floor(+Y),this.options.maxZoom+1))}_cluster(Y,ie){const{radius:ve,extent:Fe,reduce:Oe,minPoints:Le}=this.options,it=ve/(Fe*Math.pow(2,ie)),Ge=Y.data,st=[],Nt=this.stride;for(let St=0;St<Ge.length;St+=Nt){if(Ge[St+2]<=ie)continue;Ge[St+2]=ie;const xn=Ge[St],Mn=Ge[St+1],zn=Y.within(Ge[St],Ge[St+1],it),Kn=Ge[St+Wt];let Un=Kn;for(const ei of zn){const Ei=ei*Nt;Ge[Ei+2]>ie&&(Un+=Ge[Ei+Wt])}if(Un>Kn&&Un>=Le){let ei,Ei=xn*Kn,li=Mn*Kn,cr=-1;const Fr=(St/Nt<<5)+(ie+1)+this.points.length;for(const no of zn){const ir=no*Nt;if(Ge[ir+2]<=ie)continue;Ge[ir+2]=ie;const Oi=Ge[ir+Wt];Ei+=Ge[ir]*Oi,li+=Ge[ir+1]*Oi,Ge[ir+4]=Fr,Oe&&(ei||(ei=this._map(Ge,St,!0),cr=this.clusterProps.length,this.clusterProps.push(ei)),Oe(ei,this._map(Ge,ir)))}Ge[St+4]=Fr,st.push(Ei/Un,li/Un,1/0,Fr,-1,Un),Oe&&st.push(cr)}else{for(let ei=0;ei<Nt;ei++)st.push(Ge[St+ei]);if(Un>1)for(const ei of zn){const Ei=ei*Nt;if(!(Ge[Ei+2]<=ie)){Ge[Ei+2]=ie;for(let li=0;li<Nt;li++)st.push(Ge[Ei+li])}}}}return st}_getOriginId(Y){return Y-this.points.length>>5}_getOriginZoom(Y){return(Y-this.points.length)%32}_map(Y,ie,ve){if(Y[ie+Wt]>1){const Le=this.clusterProps[Y[ie+kn]];return ve?Object.assign({},Le):Le}const Fe=this.points[Y[ie+In]].properties,Oe=this.options.map(Fe);return ve&&Oe===Fe?Object.assign({},Oe):Oe}}function Qe(Xe,Y,ie){return{type:"Feature",id:Xe[Y+In],properties:at(Xe,Y,ie),geometry:{type:"Point",coordinates:[(ve=Xe[Y],360*(ve-.5)),an(Xe[Y+1])]}};var ve}function at(Xe,Y,ie){const ve=Xe[Y+Wt],Fe=ve>=1e4?`${Math.round(ve/1e3)}k`:ve>=1e3?Math.round(ve/100)/10+"k":ve,Oe=Xe[Y+kn],Le=Oe===-1?{}:Object.assign({},ie[Oe]);return Object.assign(Le,{cluster:!0,cluster_id:Xe[Y+In],point_count:ve,point_count_abbreviated:Fe})}function vt(Xe){return Xe/360+.5}function Gt(Xe){const Y=Math.sin(Xe*Math.PI/180),ie=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return ie<0?0:ie>1?1:ie}function an(Xe){const Y=(180-360*Xe)*Math.PI/180;return 360*Math.atan(Math.exp(Y))/Math.PI-90}function Qt(Xe,Y,ie,ve){let Fe=ve;const Oe=Y+(ie-Y>>1);let Le,it=ie-Y;const Ge=Xe[Y],st=Xe[Y+1],Nt=Xe[ie],St=Xe[ie+1];for(let xn=Y+3;xn<ie;xn+=3){const Mn=On(Xe[xn],Xe[xn+1],Ge,st,Nt,St);if(Mn>Fe)Le=xn,Fe=Mn;else if(Mn===Fe){const zn=Math.abs(xn-Oe);zn<it&&(Le=xn,it=zn)}}Fe>ve&&(Le-Y>3&&Qt(Xe,Y,Le,ve),Xe[Le+2]=Fe,ie-Le>3&&Qt(Xe,Le,ie,ve))}function On(Xe,Y,ie,ve,Fe,Oe){let Le=Fe-ie,it=Oe-ve;if(Le!==0||it!==0){const Ge=((Xe-ie)*Le+(Y-ve)*it)/(Le*Le+it*it);Ge>1?(ie=Fe,ve=Oe):Ge>0&&(ie+=Le*Ge,ve+=it*Ge)}return Le=Xe-ie,it=Y-ve,Le*Le+it*it}function fn(Xe,Y,ie,ve){const Fe={id:Xe??null,type:Y,geometry:ie,tags:ve,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(Y==="Point"||Y==="MultiPoint"||Y==="LineString")mn(Fe,ie);else if(Y==="Polygon")mn(Fe,ie[0]);else if(Y==="MultiLineString")for(const Oe of ie)mn(Fe,Oe);else if(Y==="MultiPolygon")for(const Oe of ie)mn(Fe,Oe[0]);return Fe}function mn(Xe,Y){for(let ie=0;ie<Y.length;ie+=3)Xe.minX=Math.min(Xe.minX,Y[ie]),Xe.minY=Math.min(Xe.minY,Y[ie+1]),Xe.maxX=Math.max(Xe.maxX,Y[ie]),Xe.maxY=Math.max(Xe.maxY,Y[ie+1])}function dn(Xe,Y,ie,ve){if(!Y.geometry)return;const Fe=Y.geometry.coordinates;if(Fe&&Fe.length===0)return;const Oe=Y.geometry.type,Le=Math.pow(ie.tolerance/((1<<ie.maxZoom)*ie.extent),2);let it=[],Ge=Y.id;if(ie.promoteId?Ge=Y.properties[ie.promoteId]:ie.generateId&&(Ge=ve||0),Oe==="Point")pi(Fe,it);else if(Oe==="MultiPoint")for(const st of Fe)pi(st,it);else if(Oe==="LineString")Ln(Fe,it,Le,!1);else if(Oe==="MultiLineString"){if(ie.lineMetrics){for(const st of Fe)it=[],Ln(st,it,Le,!1),Xe.push(fn(Ge,"LineString",it,Y.properties));return}mi(Fe,it,Le,!1)}else if(Oe==="Polygon")mi(Fe,it,Le,!0);else{if(Oe!=="MultiPolygon"){if(Oe==="GeometryCollection"){for(const st of Y.geometry.geometries)dn(Xe,{id:Ge,geometry:st,properties:Y.properties},ie,ve);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const st of Fe){const Nt=[];mi(st,Nt,Le,!0),it.push(Nt)}}Xe.push(fn(Ge,Oe,it,Y.properties))}function pi(Xe,Y){Y.push(yi(Xe[0]),xi(Xe[1]),0)}function Ln(Xe,Y,ie,ve){let Fe,Oe,Le=0;for(let Ge=0;Ge<Xe.length;Ge++){const st=yi(Xe[Ge][0]),Nt=xi(Xe[Ge][1]);Y.push(st,Nt,0),Ge>0&&(Le+=ve?(Fe*Nt-st*Oe)/2:Math.sqrt(Math.pow(st-Fe,2)+Math.pow(Nt-Oe,2))),Fe=st,Oe=Nt}const it=Y.length-3;Y[2]=1,Qt(Y,0,it,ie),Y[it+2]=1,Y.size=Math.abs(Le),Y.start=0,Y.end=Y.size}function mi(Xe,Y,ie,ve){for(let Fe=0;Fe<Xe.length;Fe++){const Oe=[];Ln(Xe[Fe],Oe,ie,ve),Y.push(Oe)}}function yi(Xe){return Xe/360+.5}function xi(Xe){const Y=Math.sin(Xe*Math.PI/180),ie=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return ie<0?0:ie>1?1:ie}function nr(Xe,Y,ie,ve,Fe,Oe,Le,it){if(ve/=Y,Oe>=(ie/=Y)&&Le<ve)return Xe;if(Le<ie||Oe>=ve)return null;const Ge=[];for(const st of Xe){const Nt=st.geometry;let St=st.type;const xn=Fe===0?st.minX:st.minY,Mn=Fe===0?st.maxX:st.maxY;if(xn>=ie&&Mn<ve){Ge.push(st);continue}if(Mn<ie||xn>=ve)continue;let zn=[];if(St==="Point"||St==="MultiPoint")yr(Nt,zn,ie,ve,Fe);else if(St==="LineString")zo(Nt,zn,ie,ve,Fe,!1,it.lineMetrics);else if(St==="MultiLineString")Sr(Nt,zn,ie,ve,Fe,!1);else if(St==="Polygon")Sr(Nt,zn,ie,ve,Fe,!0);else if(St==="MultiPolygon")for(const Kn of Nt){const Un=[];Sr(Kn,Un,ie,ve,Fe,!0),Un.length&&zn.push(Un)}if(zn.length){if(it.lineMetrics&&St==="LineString"){for(const Kn of zn)Ge.push(fn(st.id,St,Kn,st.tags));continue}St!=="LineString"&&St!=="MultiLineString"||(zn.length===1?(St="LineString",zn=zn[0]):St="MultiLineString"),St!=="Point"&&St!=="MultiPoint"||(St=zn.length===3?"Point":"MultiPoint"),Ge.push(fn(st.id,St,zn,st.tags))}}return Ge.length?Ge:null}function yr(Xe,Y,ie,ve,Fe){for(let Oe=0;Oe<Xe.length;Oe+=3){const Le=Xe[Oe+Fe];Le>=ie&&Le<=ve&&ho(Y,Xe[Oe],Xe[Oe+1],Xe[Oe+2])}}function zo(Xe,Y,ie,ve,Fe,Oe,Le){let it=Io(Xe);const Ge=Fe===0?Cs:ha;let st,Nt,St=Xe.start;for(let Un=0;Un<Xe.length-3;Un+=3){const ei=Xe[Un],Ei=Xe[Un+1],li=Xe[Un+2],cr=Xe[Un+3],Fr=Xe[Un+4],no=Fe===0?ei:Ei,ir=Fe===0?cr:Fr;let Oi=!1;Le&&(st=Math.sqrt(Math.pow(ei-cr,2)+Math.pow(Ei-Fr,2))),no<ie?ir>ie&&(Nt=Ge(it,ei,Ei,cr,Fr,ie),Le&&(it.start=St+st*Nt)):no>ve?ir<ve&&(Nt=Ge(it,ei,Ei,cr,Fr,ve),Le&&(it.start=St+st*Nt)):ho(it,ei,Ei,li),ir<ie&&no>=ie&&(Nt=Ge(it,ei,Ei,cr,Fr,ie),Oi=!0),ir>ve&&no<=ve&&(Nt=Ge(it,ei,Ei,cr,Fr,ve),Oi=!0),!Oe&&Oi&&(Le&&(it.end=St+st*Nt),Y.push(it),it=Io(Xe)),Le&&(St+=st)}let xn=Xe.length-3;const Mn=Xe[xn],zn=Xe[xn+1],Kn=Fe===0?Mn:zn;Kn>=ie&&Kn<=ve&&ho(it,Mn,zn,Xe[xn+2]),xn=it.length-3,Oe&&xn>=3&&(it[xn]!==it[0]||it[xn+1]!==it[1])&&ho(it,it[0],it[1],it[2]),it.length&&Y.push(it)}function Io(Xe){const Y=[];return Y.size=Xe.size,Y.start=Xe.start,Y.end=Xe.end,Y}function Sr(Xe,Y,ie,ve,Fe,Oe){for(const Le of Xe)zo(Le,Y,ie,ve,Fe,Oe,!1)}function ho(Xe,Y,ie,ve){Xe.push(Y,ie,ve)}function Cs(Xe,Y,ie,ve,Fe,Oe){const Le=(Oe-Y)/(ve-Y);return ho(Xe,Oe,ie+(Fe-ie)*Le,1),Le}function ha(Xe,Y,ie,ve,Fe,Oe){const Le=(Oe-ie)/(Fe-ie);return ho(Xe,Y+(ve-Y)*Le,Oe,1),Le}function ao(Xe,Y){const ie=[];for(let ve=0;ve<Xe.length;ve++){const Fe=Xe[ve],Oe=Fe.type;let Le;if(Oe==="Point"||Oe==="MultiPoint"||Oe==="LineString")Le=Ao(Fe.geometry,Y);else if(Oe==="MultiLineString"||Oe==="Polygon"){Le=[];for(const it of Fe.geometry)Le.push(Ao(it,Y))}else if(Oe==="MultiPolygon"){Le=[];for(const it of Fe.geometry){const Ge=[];for(const st of it)Ge.push(Ao(st,Y));Le.push(Ge)}}ie.push(fn(Fe.id,Oe,Le,Fe.tags))}return ie}function Ao(Xe,Y){const ie=[];ie.size=Xe.size,Xe.start!==void 0&&(ie.start=Xe.start,ie.end=Xe.end);for(let ve=0;ve<Xe.length;ve+=3)ie.push(Xe[ve]+Y,Xe[ve+1],Xe[ve+2]);return ie}function Fa(Xe,Y){if(Xe.transformed)return Xe;const ie=1<<Xe.z,ve=Xe.x,Fe=Xe.y;for(const Oe of Xe.features){const Le=Oe.geometry,it=Oe.type;if(Oe.geometry=[],it===1)for(let Ge=0;Ge<Le.length;Ge+=2)Oe.geometry.push(vr(Le[Ge],Le[Ge+1],Y,ie,ve,Fe));else for(let Ge=0;Ge<Le.length;Ge++){const st=[];for(let Nt=0;Nt<Le[Ge].length;Nt+=2)st.push(vr(Le[Ge][Nt],Le[Ge][Nt+1],Y,ie,ve,Fe));Oe.geometry.push(st)}}return Xe.transformed=!0,Xe}function vr(Xe,Y,ie,ve,Fe,Oe){return[Math.round(ie*(Xe*ve-Fe)),Math.round(ie*(Y*ve-Oe))]}function ns(Xe,Y,ie,ve,Fe){const Oe=Y===Fe.maxZoom?0:Fe.tolerance/((1<<Y)*Fe.extent),Le={features:[],numPoints:0,numSimplified:0,numFeatures:Xe.length,source:null,x:ie,y:ve,z:Y,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const it of Xe)_l(Le,it,Oe,Fe);return Le}function _l(Xe,Y,ie,ve){const Fe=Y.geometry,Oe=Y.type,Le=[];if(Xe.minX=Math.min(Xe.minX,Y.minX),Xe.minY=Math.min(Xe.minY,Y.minY),Xe.maxX=Math.max(Xe.maxX,Y.maxX),Xe.maxY=Math.max(Xe.maxY,Y.maxY),Oe==="Point"||Oe==="MultiPoint")for(let it=0;it<Fe.length;it+=3)Le.push(Fe[it],Fe[it+1]),Xe.numPoints++,Xe.numSimplified++;else if(Oe==="LineString")Wl(Le,Fe,Xe,ie,!1,!1);else if(Oe==="MultiLineString"||Oe==="Polygon")for(let it=0;it<Fe.length;it++)Wl(Le,Fe[it],Xe,ie,Oe==="Polygon",it===0);else if(Oe==="MultiPolygon")for(let it=0;it<Fe.length;it++){const Ge=Fe[it];for(let st=0;st<Ge.length;st++)Wl(Le,Ge[st],Xe,ie,!0,st===0)}if(Le.length){let it=Y.tags||null;if(Oe==="LineString"&&ve.lineMetrics){it={};for(const st in Y.tags)it[st]=Y.tags[st];it.mapbox_clip_start=Fe.start/Fe.size,it.mapbox_clip_end=Fe.end/Fe.size}const Ge={geometry:Le,type:Oe==="Polygon"||Oe==="MultiPolygon"?3:Oe==="LineString"||Oe==="MultiLineString"?2:1,tags:it};Y.id!==null&&(Ge.id=Y.id),Xe.features.push(Ge)}}function Wl(Xe,Y,ie,ve,Fe,Oe){const Le=ve*ve;if(ve>0&&Y.size<(Fe?Le:ve))return void(ie.numPoints+=Y.length/3);const it=[];for(let Ge=0;Ge<Y.length;Ge+=3)(ve===0||Y[Ge+2]>Le)&&(ie.numSimplified++,it.push(Y[Ge],Y[Ge+1])),ie.numPoints++;Fe&&function(Ge,st){let Nt=0;for(let St=0,xn=Ge.length,Mn=xn-2;St<xn;Mn=St,St+=2)Nt+=(Ge[St]-Ge[Mn])*(Ge[St+1]+Ge[Mn+1]);if(Nt>0===st)for(let St=0,xn=Ge.length;St<xn/2;St+=2){const Mn=Ge[St],zn=Ge[St+1];Ge[St]=Ge[xn-2-St],Ge[St+1]=Ge[xn-1-St],Ge[xn-2-St]=Mn,Ge[xn-1-St]=zn}}(it,Oe),Xe.push(it)}const So={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class yl{constructor(Y,ie){const ve=(ie=this.options=function(Oe,Le){for(const it in Le)Oe[it]=Le[it];return Oe}(Object.create(So),ie)).debug;if(ve&&console.time("preprocess data"),ie.maxZoom<0||ie.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ie.promoteId&&ie.generateId)throw new Error("promoteId and generateId cannot be used together.");let Fe=function(Oe,Le){const it=[];if(Oe.type==="FeatureCollection")for(let Ge=0;Ge<Oe.features.length;Ge++)dn(it,Oe.features[Ge],Le,Ge);else dn(it,Oe.type==="Feature"?Oe:{geometry:Oe},Le);return it}(Y,ie);this.tiles={},this.tileCoords=[],ve&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ie.indexMaxZoom,ie.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Fe=function(Oe,Le){const it=Le.buffer/Le.extent;let Ge=Oe;const st=nr(Oe,1,-1-it,it,0,-1,2,Le),Nt=nr(Oe,1,1-it,2+it,0,-1,2,Le);return(st||Nt)&&(Ge=nr(Oe,1,-it,1+it,0,-1,2,Le)||[],st&&(Ge=ao(st,1).concat(Ge)),Nt&&(Ge=Ge.concat(ao(Nt,-1)))),Ge}(Fe,ie),Fe.length&&this.splitTile(Fe,0,0,0),ve&&(Fe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(Y,ie,ve,Fe,Oe,Le,it){const Ge=[Y,ie,ve,Fe],st=this.options,Nt=st.debug;for(;Ge.length;){Fe=Ge.pop(),ve=Ge.pop(),ie=Ge.pop(),Y=Ge.pop();const St=1<<ie,xn=Xa(ie,ve,Fe);let Mn=this.tiles[xn];if(!Mn&&(Nt>1&&console.time("creation"),Mn=this.tiles[xn]=ns(Y,ie,ve,Fe,st),this.tileCoords.push({z:ie,x:ve,y:Fe}),Nt)){Nt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ie,ve,Fe,Mn.numFeatures,Mn.numPoints,Mn.numSimplified),console.timeEnd("creation"));const Oi=`z${ie}`;this.stats[Oi]=(this.stats[Oi]||0)+1,this.total++}if(Mn.source=Y,Oe==null){if(ie===st.indexMaxZoom||Mn.numPoints<=st.indexMaxPoints)continue}else{if(ie===st.maxZoom||ie===Oe)continue;if(Oe!=null){const Oi=Oe-ie;if(ve!==Le>>Oi||Fe!==it>>Oi)continue}}if(Mn.source=null,Y.length===0)continue;Nt>1&&console.time("clipping");const zn=.5*st.buffer/st.extent,Kn=.5-zn,Un=.5+zn,ei=1+zn;let Ei=null,li=null,cr=null,Fr=null,no=nr(Y,St,ve-zn,ve+Un,0,Mn.minX,Mn.maxX,st),ir=nr(Y,St,ve+Kn,ve+ei,0,Mn.minX,Mn.maxX,st);Y=null,no&&(Ei=nr(no,St,Fe-zn,Fe+Un,1,Mn.minY,Mn.maxY,st),li=nr(no,St,Fe+Kn,Fe+ei,1,Mn.minY,Mn.maxY,st),no=null),ir&&(cr=nr(ir,St,Fe-zn,Fe+Un,1,Mn.minY,Mn.maxY,st),Fr=nr(ir,St,Fe+Kn,Fe+ei,1,Mn.minY,Mn.maxY,st),ir=null),Nt>1&&console.timeEnd("clipping"),Ge.push(Ei||[],ie+1,2*ve,2*Fe),Ge.push(li||[],ie+1,2*ve,2*Fe+1),Ge.push(cr||[],ie+1,2*ve+1,2*Fe),Ge.push(Fr||[],ie+1,2*ve+1,2*Fe+1)}}getTile(Y,ie,ve){Y=+Y,ie=+ie,ve=+ve;const Fe=this.options,{extent:Oe,debug:Le}=Fe;if(Y<0||Y>24)return null;const it=1<<Y,Ge=Xa(Y,ie=ie+it&it-1,ve);if(this.tiles[Ge])return Fa(this.tiles[Ge],Oe);Le>1&&console.log("drilling down to z%d-%d-%d",Y,ie,ve);let st,Nt=Y,St=ie,xn=ve;for(;!st&&Nt>0;)Nt--,St>>=1,xn>>=1,st=this.tiles[Xa(Nt,St,xn)];return st&&st.source?(Le>1&&(console.log("found parent tile z%d-%d-%d",Nt,St,xn),console.time("drilling down")),this.splitTile(st.source,Nt,St,xn,Y,ie,ve),Le>1&&console.timeEnd("drilling down"),this.tiles[Ge]?Fa(this.tiles[Ge],Oe):null):null}}function Xa(Xe,Y,ie){return 32*((1<<Xe)*ie+Y)+Xe}function vl(Xe,Y){const ie=Xe.tileID.canonical;if(!this._geoJSONIndex)return void Y(null,null);const ve=this._geoJSONIndex.getTile(ie.z,ie.x,ie.y);if(!ve)return void Y(null,null);const Fe=st=>st.tags&&"3d_elevation_id"in st.tags&&"source"in st.tags&&st.tags.source==="elevation",Oe=ve.features.filter(st=>Fe(st));let Le={_geojsonTileLayer:ve.features};Oe.length>0&&(Le={_geojsonTileLayer:ve.features.filter(st=>!Fe(st)),hd_road_elevation:Oe});const it=new oe(Le),Ge=function(st){const Nt=new o.bt;for(const St of Object.keys(st))Nt.writeMessage(3,Hn,{name:St,features:st[St]});return Nt.finish()}(Le).buffer;Y(null,{vectorTile:it,rawData:Ge})}class Dt extends se{constructor(Y,ie,ve,Fe,Oe,Le,it){super(Y,ie,ve,Fe,Oe,vl,it),Le&&(this.loadGeoJSON=Le),this._dynamicIndex=new $e}loadData(Y,ie){const ve=Y&&Y.request,Fe=ve&&ve.collectResourceTiming;this._geoJSONIndex=null,this.loadGeoJSON(Y,(Oe,Le)=>{if(Oe||!Le)return ie(Oe);if(typeof Le!="object")return ie(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));{try{if(Y.filter){const Ge=o.U(Y.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ge.result==="error")throw new Error(Ge.value.map(st=>`${st.key}: ${st.message}`).join(", "));Le.features=Le.features.filter(st=>Ge.value.evaluate({zoom:0},st))}Y.dynamic?(Le.type==="Feature"&&(Le={type:"FeatureCollection",features:[Le]}),Y.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(Le.features,this.loaded),Y.cluster&&(Le.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=Y.cluster?new dr(function({superclusterOptions:Ge,clusterProperties:st}){if(!st||!Ge)return Ge;const Nt={},St={},xn={accumulated:null,zoom:0},Mn={properties:null},zn=Object.keys(st);for(const Kn of zn){const[Un,ei]=st[Kn],Ei=o.U(ei),li=o.U(typeof Un=="string"?[Un,["accumulated"],["get",Kn]]:Un);Nt[Kn]=Ei.value,St[Kn]=li.value}return Ge.map=Kn=>{Mn.properties=Kn;const Un={};for(const ei of zn)Un[ei]=Nt[ei].evaluate(xn,Mn);return Un},Ge.reduce=(Kn,Un)=>{Mn.properties=Un;for(const ei of zn)xn.accumulated=Kn[ei],Kn[ei]=St[ei].evaluate(xn,Mn)},Ge}(Y)).load(Le.features):Y.dynamic?this._dynamicIndex:function(Ge,st){return new yl(Ge,st)}(Le,Y.geojsonVtOptions)}catch(Ge){return ie(Ge)}const it={};if(Fe){const Ge=w(ve);Ge&&(it.resourceTiming={},it.resourceTiming[Y.source]=JSON.parse(JSON.stringify(Ge)))}ie(null,it)}})}reloadTile(Y,ie){const ve=this.loaded;return ve&&ve[Y.uid]?Y.partial?ie(null,void 0):super.reloadTile(Y,ie):this.loadTile(Y,ie)}loadGeoJSON(Y,ie){if(Y.request)o.m(Y.request,ie);else{if(typeof Y.data!="string")return ie(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));setTimeout(()=>{try{return ie(null,JSON.parse(Y.data))}catch{return ie(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`))}},0)}}getClusterExpansionZoom(Y,ie){try{ie(null,this._geoJSONIndex.getClusterExpansionZoom(Y.clusterId))}catch(ve){ie(ve)}}getClusterChildren(Y,ie){try{ie(null,this._geoJSONIndex.getChildren(Y.clusterId))}catch(ve){ie(ve)}}getClusterLeaves(Y,ie){try{ie(null,this._geoJSONIndex.getLeaves(Y.clusterId,Y.limit,Y.offset))}catch(ve){ie(ve)}}}class bl{constructor(Y,ie,ve){this.tileID=new o.aO(Y.tileID.overscaledZ,Y.tileID.wrap,Y.tileID.canonical.z,Y.tileID.canonical.x,Y.tileID.canonical.y),this.tileZoom=Y.tileZoom,this.uid=Y.uid,this.zoom=Y.zoom,this.canonical=Y.tileID.canonical,this.pixelRatio=Y.pixelRatio,this.tileSize=Y.tileSize,this.source=Y.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=Y.projection,this.brightness=ie,this.worldview=ve}parse(Y,ie,ve,Fe){this.status="parsing";const Oe=new o.aO(ve.tileID.overscaledZ,ve.tileID.wrap,ve.tileID.canonical.z,ve.tileID.canonical.x,ve.tileID.canonical.y),Le=[],it=ie.familiesBySource[ve.source],Ge=new o.fe(Oe,ve.promoteId);Ge.bucketLayerIDs=[],Ge.is3DTile=!0,o.ft(Y).then(st=>{if(!st)return Fe(new Error("Could not parse tile"));const Nt=st.json.extensionsUsed&&st.json.extensionsUsed.includes("MAPBOX_mesh_features")||st.json.asset.extras&&st.json.asset.extras.MAPBOX_mesh_features,St=st.json.extensionsUsed&&st.json.extensionsUsed.includes("EXT_meshopt_compression"),xn=new o.ac(this.zoom,{brightness:this.brightness,worldview:this.worldview});for(const Mn in it)for(const zn of it[Mn]){const Kn=zn[0];Ge.bucketLayerIDs.push(zn.map(Ei=>o.B(Ei.id,Ei.scope))),Kn.recalculate(xn,[]);const Un=o.fu(st,1/o.d6(ve.tileID.canonical)),ei=new o.fv(zn,Un,Oe,Nt,St,this.brightness,Ge,this.worldview);Nt||(ei.needsUpload=!0),Le.push(ei),ei.evaluate(Kn)}this.status="done",Fe(null,{buckets:Le,featureIndex:Ge,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(st=>Fe(new Error(st.message)))}}class ql{constructor(Y,ie,ve,Fe,Oe,Le,it,Ge){this.actor=Y,this.layerIndex=ie,this.availableImages=ve,this.availableModels=Fe,this.brightness=it,this.loading={},this.loaded={},this.worldview=Ge}loadTile(Y,ie){const ve=Y.uid,Fe=this.loading[ve]=new bl(Y,this.brightness,this.worldview);o.bu(Y.request,(Oe,Le)=>{const it=!this.loading[ve];return delete this.loading[ve],it||Oe?(Fe.status="done",it||(this.loaded[ve]=Fe),ie(Oe)):Le&&Le.byteLength!==0?void Fe.parse(Le,this.layerIndex,Y,(Ge,st)=>{Fe.status="done",this.loaded=this.loaded||{},this.loaded[ve]=Fe,Ge||!st?ie(Ge):ie(null,st)}):(Fe.status="done",this.loaded[ve]=Fe,ie())})}reloadTile(Y,ie){const ve=this.loaded,Fe=Y.uid;if(ve&&ve[Fe]){const Oe=ve[Fe];Oe.projection=Y.projection,Oe.brightness=Y.brightness;const Le=(it,Ge)=>{Oe.reloadCallback&&(delete Oe.reloadCallback,this.loadTile(Y,ie)),ie(it,Ge)};Oe.status==="parsing"?Oe.reloadCallback=Le:Oe.status==="done"&&this.loadTile(Y,ie)}}abortTile(Y,ie){const ve=Y.uid;this.loading[ve]&&delete this.loading[ve],ie()}removeTile(Y,ie){const ve=this.loaded,Fe=Y.uid;ve&&ve[Fe]&&delete ve[Fe],ie()}}class $c{constructor(Y){this.self=Y,this.actor=new o.fx(Y,this),this.layerIndexes={},this.availableImages={},this.availableModels={},this.isSpriteLoaded={},this.imageRasterizer=new o.x,this.rtlPluginParsingListeners=[],this.projections={},this.defaultProjection=o.cl({name:"mercator"}),this.workerSourceTypes={vector:se,geojson:Dt,"raster-dem":ce,"raster-array":ze,"batched-model":ql},this.workerSources={},this.self.registerWorkerSource=(ie,ve)=>{if(this.workerSourceTypes[ie])throw new Error(`Worker source with name "${ie}" already registered.`);this.workerSourceTypes[ie]=ve},this.self.registerRTLTextPlugin=ie=>{if(o.fy.isParsed())throw new Error("RTL text plugin already registered.");o.fy.setState({pluginStatus:o.fz.parsed,pluginURL:o.fy.getPluginURL()}),o.fy.applyArabicShaping=ie.applyArabicShaping,o.fy.processBidirectionalText=ie.processBidirectionalText,o.fy.processStyledBidirectionalText=ie.processStyledBidirectionalText;for(const ve of this.rtlPluginParsingListeners)ve(null,!0);this.rtlPluginParsingListeners=[]}}clearCaches(Y,ie,ve){delete this.layerIndexes[Y],delete this.availableImages[Y],delete this.availableModels[Y],delete this.workerSources[Y],ve()}checkIfReady(Y,ie,ve){ve()}setReferrer(Y,ie){this.referrer=ie}spriteLoaded(Y,ie){this.isSpriteLoaded[Y]||(this.isSpriteLoaded[Y]={});const{scope:ve,isLoaded:Fe}=ie;if(this.isSpriteLoaded[Y][ve]=Fe,this.workerSources[Y]&&this.workerSources[Y][ve])for(const Oe in this.workerSources[Y][ve]){const Le=this.workerSources[Y][ve][Oe];for(const it in Le){const Ge=Le[it];Ge instanceof se&&(Ge.isSpriteLoaded=Fe,Ge.fire(new o.z("isSpriteLoaded")))}}}setImages(Y,ie,ve){this.availableImages[Y]||(this.availableImages[Y]={});const{scope:Fe,images:Oe}=ie;if(this.availableImages[Y][Fe]=Oe,this.workerSources[Y]&&this.workerSources[Y][Fe]){for(const Le in this.workerSources[Y][Fe]){const it=this.workerSources[Y][Fe][Le];for(const Ge in it)it[Ge].availableImages=Oe}ve()}else ve()}setModels(Y,{scope:ie,models:ve},Fe){if(this.availableModels[Y]||(this.availableModels[Y]={}),this.availableModels[Y][ie]=ve,this.workerSources[Y]&&this.workerSources[Y][ie]){for(const Oe in this.workerSources[Y][ie]){const Le=this.workerSources[Y][ie][Oe];for(const it in Le)Le[it].availableModels=ve}Fe()}else Fe()}setProjection(Y,ie){this.projections[Y]=o.cl(ie)}setBrightness(Y,ie,ve){this.brightness=ie,ve()}setWorldview(Y,ie,ve){this.worldview=ie,ve()}setLayers(Y,ie,ve){this.getLayerIndex(Y,ie.scope).replace(ie.layers,ie.options),ve()}updateLayers(Y,ie,ve){this.getLayerIndex(Y,ie.scope).update(ie.layers,ie.removedIds,ie.options),ve()}loadTile(Y,ie,ve){ie.projection=this.projections[Y]||this.defaultProjection,this.getWorkerSource(Y,ie.type,ie.source,ie.scope).loadTile(ie,ve)}decodeRasterArray(Y,ie,ve){this.getWorkerSource(Y,ie.type,ie.source,ie.scope).decodeRasterArray(ie,ve)}reloadTile(Y,ie,ve){ie.projection=this.projections[Y]||this.defaultProjection,this.getWorkerSource(Y,ie.type,ie.source,ie.scope).reloadTile(ie,ve)}abortTile(Y,ie,ve){this.getWorkerSource(Y,ie.type,ie.source,ie.scope).abortTile(ie,ve)}removeTile(Y,ie,ve){this.getWorkerSource(Y,ie.type,ie.source,ie.scope).removeTile(ie,ve)}removeSource(Y,ie,ve){if(!(this.workerSources[Y]&&this.workerSources[Y][ie.scope]&&this.workerSources[Y][ie.scope][ie.type]&&this.workerSources[Y][ie.scope][ie.type][ie.source]))return;const Fe=this.workerSources[Y][ie.scope][ie.type][ie.source];delete this.workerSources[Y][ie.scope][ie.type][ie.source],Fe.removeSource!==void 0?Fe.removeSource(ie,ve):ve()}loadWorkerSource(Y,ie,ve){try{this.self.importScripts(ie.url),ve()}catch(Fe){ve(Fe.toString())}}syncRTLPluginState(Y,ie,ve){if(o.fy.isParsed())ve(null,!0);else if(o.fy.isParsing())this.rtlPluginParsingListeners.push(ve);else try{o.fy.setState(ie);const Fe=o.fy.getPluginURL();!o.fy.isLoaded()||o.fy.isParsed()||o.fy.isParsing()||Fe==null||(o.fy.setState({pluginStatus:o.fz.parsing,pluginURL:o.fy.getPluginURL()}),this.self.importScripts(Fe),o.fy.isParsed()?ve(null,!0):this.rtlPluginParsingListeners.push(ve))}catch(Fe){ve(Fe.toString())}}setDracoUrl(Y,ie){this.dracoUrl=ie}getAvailableImages(Y,ie){this.availableImages[Y]||(this.availableImages[Y]={});let ve=this.availableImages[Y][ie];return ve||(ve=[]),ve}getAvailableModels(Y,ie){this.availableModels[Y]||(this.availableModels[Y]={});let ve=this.availableModels[Y][ie];return ve||(ve={}),ve}getLayerIndex(Y,ie){this.layerIndexes[Y]||(this.layerIndexes[Y]={});let ve=this.layerIndexes[Y][ie];return ve||(ve=this.layerIndexes[Y][ie]=new D,ve.scope=ie),ve}getWorkerSource(Y,ie,ve,Fe){const Oe=this.workerSources;return Oe[Y]||(Oe[Y]={}),Oe[Y][Fe]||(Oe[Y][Fe]={}),Oe[Y][Fe][ie]||(Oe[Y][Fe][ie]={}),this.isSpriteLoaded[Y]||(this.isSpriteLoaded[Y]={}),Oe[Y][Fe][ie][ve]||(Oe[Y][Fe][ie][ve]=new this.workerSourceTypes[ie]({send:(Le,it,Ge,st,Nt,St)=>this.actor.send(Le,it,Ge,Y,Nt,St),scheduler:this.actor.scheduler},this.getLayerIndex(Y,Fe),this.getAvailableImages(Y,Fe),this.getAvailableModels(Y,Fe),this.isSpriteLoaded[Y][Fe],void 0,this.brightness,this.worldview)),Oe[Y][Fe][ie][ve]}rasterizeImagesWorker(Y,ie,ve){const Fe=new Map;for(const[Oe,{image:Le,imageVariant:it}]of ie.tasks.entries()){const Ge=this.imageRasterizer.rasterize(it,Le,ie.scope,Y);Fe.set(Oe,Ge)}ve(void 0,Fe)}removeRasterizedImages(Y,ie,ve){this.imageRasterizer.removeImagesFromCacheByIds(ie.imageIds,ie.scope,Y),ve()}enforceCacheSizeLimit(Y,ie){o.fA(ie)}getWorkerPerformanceMetrics(Y,ie,ve){ve(void 0,void 0)}}return o.fw(self)&&(self.worker=new $c(self)),$c}),u(["./shared"],function(o){var w="3.15.0";const T={create:"create",load:"load",fullLoad:"fullLoad"},A={mark(g){performance.mark(g)},measure(g,s,d){performance.measure(g,s,d)}};function D(g){const s=g.name.split("?")[0];return o.a(s)&&s.includes("mapbox-gl.js")?"javascript":o.a(s)&&s.includes("mapbox-gl.css")?"css":o.b(s)?"fontRange":o.c(s)?"sprite":o.i(s)?"style":o.d(s)?"tilejson":"other"}var B,N={},ee=function(){if(B)return N;function g(m){return!s(m)}function s(m){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var b,S,E=new Blob([""],{type:"text/javascript"}),k=URL.createObjectURL(E);try{S=new Worker(k),b=!0}catch{b=!1}return S&&S.terminate(),URL.revokeObjectURL(k),b}()?function(){var b=document.createElement("canvas");b.width=b.height=1;var S=b.getContext("2d");if(!S)return!1;var E=S.getImageData(0,0,1,1);return E&&E.width===b.width}()?(d[v=m&&m.failIfMajorPerformanceCaveat]===void 0&&(d[v]=function(b){var S,E=function(k){var O=document.createElement("canvas"),z=Object.create(g.webGLContextAttributes);return z.failIfMajorPerformanceCaveat=k,O.getContext("webgl2",z)}(b);if(!E)return!1;try{S=E.createShader(E.VERTEX_SHADER)}catch{return!1}return!(!S||E.isContextLost())&&(E.shaderSource(S,"void main() {}"),E.compileShader(S),E.getShaderParameter(S,E.COMPILE_STATUS)===!0)}(v)),d[v]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var v}B=1,N.supported=g,N.notSupportedReason=s;var d={};return g.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},N}();function Q(g,s,d){const m=document.createElement(g);return s!=null&&(m.className=s),d&&d.appendChild(m),m}function se(g,s,d){const m=document.createElementNS("http://www.w3.org/2000/svg",g);for(const v of Object.keys(s))m.setAttributeNS(null,v,String(s[v]));return d&&d.appendChild(m),m}const ce=typeof document<"u"?document.documentElement&&document.documentElement.style:null,be=ce&&ce.userSelect!==void 0?"userSelect":"WebkitUserSelect";let ze;function xe(){ce&&be&&(ze=ce[be],ce[be]="none")}function je(){ce&&be&&(ce[be]=ze)}function qe(g){g.preventDefault(),g.stopPropagation(),window.removeEventListener("click",qe,!0)}function oe(){window.addEventListener("click",qe,!0),window.setTimeout(()=>{window.removeEventListener("click",qe,!0)},0)}function de(g,s){const d=g.getBoundingClientRect();return me(g,d,s)}function Ee(g,s){const d=g.getBoundingClientRect(),m=[];for(let v=0;v<s.length;v++)m.push(me(g,d,s[v]));return m}function $e(g){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&g.button===2&&g.ctrlKey?0:g.button}function me(g,s,d){const m=g.offsetWidth===s.width?1:g.offsetWidth/s.width;return new o.P((d.clientX-s.left)*m,(d.clientY-s.top)*m)}const Te="01",Re="NO_ACCESS_TOKEN";class tn{constructor(s,d,m){this._transformRequestFn=s,this._customAccessToken=d,this._silenceAuthErrors=!!m,this._createSkuToken()}_createSkuToken(){const s=function(){let d="";for(let m=0;m<10;m++)d+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Te,d].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=s.token,this._skuTokenExpiresAt=s.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(s,d){return this._transformRequestFn&&this._transformRequestFn(s,d)||{url:s}}normalizeStyleURL(s,d){if(!o.h(s))return s;const m=on(s);return m.params.push(`sdk=js-${w}`),m.path=`/styles/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||d)}normalizeGlyphsURL(s,d){if(!o.h(s))return s;const m=on(s);return m.path=`/fonts/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||d)}normalizeModelURL(s,d){if(!o.h(s))return s;const m=on(s);return m.path=`/models/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||d)}normalizeSourceURL(s,d,m,v){if(!o.h(s))return s;const b=on(s);return b.path=`/v4/${b.authority}.json`,b.params.push("secure"),m&&b.params.push(`language=${m}`),v&&b.params.push(`worldview=${v}`),this._makeAPIURL(b,this._customAccessToken||d)}normalizeIconsetURL(s,d){const m=on(s);return o.h(s)?(m.path=`/styles/v1${m.path}/iconset.pbf`,this._makeAPIURL(m,this._customAccessToken||d)):hn(m)}normalizeSpriteURL(s,d,m,v){const b=on(s);return o.h(s)?(b.path=`/styles/v1${b.path}/sprite${d}${m}`,this._makeAPIURL(b,this._customAccessToken||v)):(b.path+=`${d}${m}`,hn(b))}normalizeTileURL(s,d,m){if(this._isSkuTokenExpired()&&this._createSkuToken(),s&&!o.h(s))return s;const v=on(s);v.path=v.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${d||m&&v.authority!=="raster"&&m===512?"@2x":""}${o.k.supported?".webp":"$1"}`),v.authority==="raster"?v.path=`/${o.e.RASTER_URL_PREFIX}${v.path}`:v.authority==="rasterarrays"?v.path=`/${o.e.RASTERARRAYS_URL_PREFIX}${v.path}`:v.authority==="3dtiles"?v.path=`/${o.e.TILES3D_URL_PREFIX}${v.path}`:(v.path=v.path.replace(/^.+\/v4\//,"/"),v.path=`/${o.e.TILE_URL_VERSION}${v.path}`);const b=this._customAccessToken||function(S){for(const E of S){const k=E.match(/^access_token=(.*)$/);if(k)return k[1]}return null}(v.params)||o.e.ACCESS_TOKEN;return o.e.REQUIRE_ACCESS_TOKEN&&b&&this._skuToken&&v.params.push(`sku=${this._skuToken}`),this._makeAPIURL(v,b)}canonicalizeTileURL(s,d){const m=on(s);if(!m.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!m.path.match(/\.[\w]+$/))return s;let v="mapbox://";m.path.match(/^\/raster\/v1\//)?v+=`raster/${m.path.replace(`/${o.e.RASTER_URL_PREFIX}/`,"")}`:m.path.match(/^\/rasterarrays\/v1\//)?v+=`rasterarrays/${m.path.replace(`/${o.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:v+=`tiles/${m.path.replace(`/${o.e.TILE_URL_VERSION}/`,"")}`;let b=m.params;return d&&(b=b.filter(S=>!S.match(/^access_token=/))),b.length&&(v+=`?${b.join("&")}`),v}canonicalizeTileset(s,d){const m=!!d&&o.h(d),v=[];for(const b of s.tiles||[])o.j(b)?v.push(this.canonicalizeTileURL(b,m)):v.push(b);return v}_makeAPIURL(s,d){const m="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",v=on(o.e.API_URL);if(s.protocol=v.protocol,s.authority=v.authority,s.protocol==="http"){const b=s.params.indexOf("secure");b>=0&&s.params.splice(b,1)}if(v.path!=="/"&&(s.path=`${v.path}${s.path}`),!o.e.REQUIRE_ACCESS_TOKEN)return hn(s);if(d=d||o.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!d)throw new Error(`An API access token is required to use Mapbox GL. ${m}`);if(d[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${m}`)}return s.params=s.params.filter(b=>b.indexOf("access_token")===-1),s.params.push(`access_token=${d||""}`),hn(s)}}const Zt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function on(g){const s=g.match(Zt);if(!s)throw new Error("Unable to parse URL object");return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}function hn(g){const s=g.params.length?`?${g.params.join("&")}`:"";return`${g.protocol}://${g.authority}${g.path}${s}`}const Hn="mapbox.eventData";function Ri(g){if(!g)return null;const s=g.split(".");if(!s||s.length!==3)return null;try{return JSON.parse(o.l(s[1]))}catch{return null}}class zi{constructor(s){this.type=s,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(s){const d=Ri(o.e.ACCESS_TOKEN);let m="";return m=d&&d.u?o.f(d.u):o.e.ACCESS_TOKEN||"",s?`${Hn}.${s}:${m}`:`${Hn}:${m}`}fetchEventData(){const s=o.s("localStorage"),d=this.getStorageKey(),m=this.getStorageKey("uuid");if(s)try{const v=localStorage.getItem(d);v&&(this.eventData=JSON.parse(v));const b=localStorage.getItem(m);b&&(this.anonId=b)}catch{o.w("Unable to read from LocalStorage")}}saveEventData(){const s=o.s("localStorage"),d=this.getStorageKey(),m=this.getStorageKey("uuid"),v=this.anonId;if(s&&v)try{localStorage.setItem(m,v),Object.keys(this.eventData).length>=1&&localStorage.setItem(d,JSON.stringify(this.eventData))}catch{o.w("Unable to write to LocalStorage")}}processRequests(s){}postEvent(s,d,m,v){if(!o.e.EVENTS_URL)return;const b=on(o.e.EVENTS_URL);b.params.push(`access_token=${v||o.e.ACCESS_TOKEN||""}`);const S={event:this.type,created:new Date(s).toISOString()},E=d?Object.assign(S,d):S,k={url:hn(b),headers:{"Content-Type":"text/plain"},body:JSON.stringify([E])};this.pendingRequest=o.p(k,O=>{this.pendingRequest=null,m(O),this.saveEventData(),this.processRequests(v)})}queueRequest(s,d){this.queue.push(s),this.processRequests(d)}}const Pt=new class extends zi{constructor(g){super("appUserTurnstile"),this._customAccessToken=g}postTurnstileEvent(g,s){o.e.EVENTS_URL&&o.e.ACCESS_TOKEN&&Array.isArray(g)&&g.some(d=>o.h(d)||o.j(d))&&this.queueRequest(Date.now(),s)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const s=Ri(o.e.ACCESS_TOKEN),d=s?s.u:o.e.ACCESS_TOKEN;let m=d!==this.eventData.tokenU;o.v(this.anonId)||(this.anonId=o.u(),m=!0);const v=this.queue.shift();if(this.eventData.lastSuccess){const b=new Date(this.eventData.lastSuccess),S=new Date(v),E=(v-this.eventData.lastSuccess)/864e5;m=m||E>=1||E<-1||b.getDate()!==S.getDate()}else m=!0;m?this.postEvent(v,{sdkIdentifier:"mapbox-gl-js",sdkVersion:w,skuId:Te,"enabled.telemetry":!1,userId:this.anonId},b=>{b||(this.eventData.lastSuccess=v,this.eventData.tokenU=d)},g):this.processRequests()}},Di=Pt.postTurnstileEvent.bind(Pt),wo=new class extends zi{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(g,s,d,m){this.skuToken=s,this.errorCb=m,o.e.EVENTS_URL&&(d||o.e.ACCESS_TOKEN?this.queueRequest({id:g,timestamp:Date.now()},d):this.errorCb(new Error(Re)))}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:d}=this.queue.shift();s&&this.success[s]||(this.anonId||this.fetchEventData(),o.v(this.anonId)||(this.anonId=o.u()),this.postEvent(d,{sdkIdentifier:"mapbox-gl-js",sdkVersion:w,skuId:Te,skuToken:this.skuToken,userId:this.anonId},m=>{m?this.errorCb(m):s&&(this.success[s]=!0)},g))}remove(){this.errorCb=null}},Ur=wo.postMapLoadEvent.bind(wo),Br=new class extends zi{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(g){let s=this.mapInstanceIdMap.get(g);return s||(s=o.u(),this.mapInstanceIdMap.set(g,s)),s}getEventId(g){const s=this.eventIdPerMapInstanceMap.get(g)||0;return this.eventIdPerMapInstanceMap.set(g,s+1),s}postStyleLoadEvent(g,s){const{map:d,style:m,importedStyles:v}=s;if(!o.e.EVENTS_URL||!g&&!o.e.ACCESS_TOKEN)return;const b=this.getMapInstanceId(d),S={mapInstanceId:b,eventId:this.getEventId(b),style:m};v.length&&(S.importedStyles=v),this.queueRequest({timestamp:Date.now(),payload:S},g)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:s,payload:d}=this.queue.shift();this.postEvent(s,d,()=>{},g)}},ai=Br.postStyleLoadEvent.bind(Br),Ft=new class extends zi{constructor(){super("gljs.performance")}postPerformanceEvent(g,s){o.e.EVENTS_URL&&(g||o.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:s},g)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:s,performanceData:d}=this.queue.shift(),m=function(v){const b=performance.getEntriesByType("resource"),S=performance.getEntriesByType("mark"),E=function(H){const G={};if(H){for(const W in H)if(W!=="other")for(const ne of H[W]){const X=`${W}ResolveRangeMin`,re=`${W}ResolveRangeMax`,he=`${W}RequestCount`,pe=`${W}RequestCachedCount`;G[X]=Math.min(G[X]||1/0,ne.startTime),G[re]=Math.max(G[re]||-1/0,ne.responseEnd);const Ie=Se=>{G[Se]===void 0&&(G[Se]=0),++G[Se]};ne.transferSize!==void 0&&ne.transferSize===0&&Ie(pe),Ie(he)}}return G}(function(H,G){const W={};if(H)for(const ne of H){const X=G(ne);W[X]===void 0&&(W[X]=[]),W[X].push(ne)}return W}(b,D)),k=window.devicePixelRatio,O=navigator.connection||navigator.mozConnection||navigator.webkitConnection,z=O?O.effectiveType:void 0,U={counters:[],metadata:[],attributes:[]},F=(H,G,W)=>{W!=null&&H.push({name:G,value:W.toString()})};for(const H in E)F(U.counters,H,E[H]);if(v.interactionRange[0]!==1/0&&v.interactionRange[1]!==-1/0&&(F(U.counters,"interactionRangeMin",v.interactionRange[0]),F(U.counters,"interactionRangeMax",v.interactionRange[1])),S)for(const H of Object.keys(T)){const G=T[H],W=S.find(ne=>ne.name===G);W&&F(U.counters,G,W.startTime)}return F(U.counters,"visibilityHidden",v.visibilityHidden),F(U.attributes,"style",function(H){if(H)for(const G of H){const W=G.name.split("?")[0];if(o.i(W)){const ne=W.split("/").slice(-2);if(ne.length===2)return`mapbox://styles/${ne[0]}/${ne[1]}`}}}(b)),F(U.attributes,"terrainEnabled",v.terrainEnabled?"true":"false"),F(U.attributes,"fogEnabled",v.fogEnabled?"true":"false"),F(U.attributes,"projection",v.projection),F(U.attributes,"zoom",v.zoom),F(U.metadata,"devicePixelRatio",k),F(U.metadata,"connectionEffectiveType",z),F(U.metadata,"navigatorUserAgent",navigator.userAgent),F(U.metadata,"screenWidth",window.screen.width),F(U.metadata,"screenHeight",window.screen.height),F(U.metadata,"windowWidth",window.innerWidth),F(U.metadata,"windowHeight",window.innerHeight),F(U.metadata,"mapWidth",v.width/k),F(U.metadata,"mapHeight",v.height/k),F(U.metadata,"webglRenderer",v.renderer),F(U.metadata,"webglVendor",v.vendor),F(U.metadata,"sdkVersion",w),F(U.metadata,"sdkIdentifier","mapbox-gl-js"),U}(d);for(const v of m.metadata);for(const v of m.counters);for(const v of m.attributes);this.postEvent(s,m,()=>{},g)}},In=Ft.postPerformanceEvent.bind(Ft),Wt=new class extends zi{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(g,s,d,m){if(!o.e.API_URL||!o.e.SESSION_PATH)return;const v=on(o.e.API_URL+o.e.SESSION_PATH);v.params.push(`sku=${s||""}`),v.params.push(`access_token=${m||o.e.ACCESS_TOKEN||""}`);const b={url:hn(v),headers:{"Content-Type":"text/plain"}};this.pendingRequest=o.g(b,S=>{this.pendingRequest=null,d(S),this.saveEventData(),this.processRequests(m)})}getSessionAPI(g,s,d,m){this.skuToken=s,this.errorCb=m,o.e.SESSION_PATH&&o.e.API_URL&&(d||o.e.ACCESS_TOKEN?this.queueRequest({id:g,timestamp:Date.now()},d):this.errorCb(new Error(Re)))}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:d}=this.queue.shift();s&&this.success[s]||this.getSession(d,this.skuToken,m=>{m?this.errorCb(m):s&&(this.success[s]=!0)},g)}remove(){this.errorCb=null}},kn=Wt.getSessionAPI.bind(Wt),dr=new Set;function Qe(g,s){s?dr.add(g):dr.delete(g)}class at{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages={}}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(s,d){this._updatedSourceCaches[s]=d,this.setDirty()}discardSourceCacheUpdate(s){delete this._updatedSourceCaches[s]}updateLayer(s){const d=s.scope;this._updatedLayers[d]=this._updatedLayers[d]||new Set,this._updatedLayers[d].add(s.id),this.setDirty()}removeLayer(s){const d=s.scope;this._removedLayers[d]=this._removedLayers[d]||{},this._updatedLayers[d]=this._updatedLayers[d]||new Set,this._removedLayers[d][s.id]=s,this._updatedLayers[d].delete(s.id),this._updatedPaintProps.delete(s.fqid),this.setDirty()}getRemovedLayer(s){return this._removedLayers[s.scope]?this._removedLayers[s.scope][s.id]:null}discardLayerRemoval(s){this._removedLayers[s.scope]&&delete this._removedLayers[s.scope][s.id]}getLayerUpdatesByScope(){const s={};for(const d in this._updatedLayers)s[d]=s[d]||{},s[d].updatedIds=Array.from(this._updatedLayers[d].values());for(const d in this._removedLayers)s[d]=s[d]||{},s[d].removedIds=Object.keys(this._removedLayers[d]);return s}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(s){this._updatedPaintProps.add(s.fqid),this.setDirty()}getUpdatedImages(s){return this._updatedImages[s]?Array.from(this._updatedImages[s].values()):[]}updateImage(s,d){this._updatedImages[d]=this._updatedImages[d]||new Set,this._updatedImages[d].add(o.I.toString(s)),this.setDirty()}resetUpdatedImages(s){this._updatedImages[s]&&this._updatedImages[s].clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages={}}}function vt(g){const{userImage:s}=g;return!!(s&&s.render&&s.render())&&(g.data.replace(new Uint8Array(s.data.buffer)),!0)}class Gt extends o.E{constructor(s){super(),this.imageProviders=new Map,this.images=new Map,this.updatedImages=new Map,this.callbackDispatchedThisFrame=new Map,this.loaded=new Map,this.requestors=[],this.patterns=new Map,this.patternsInFlight=new Set,this.atlasImage=new Map,this.atlasTexture=new Map,this.dirty=!0,this.spriteFormat=s,s!=="raster"&&o.r()&&(this.imageRasterizerDispatcher=new o.D(o.t(),this,"Image Rasterizer Worker",1))}addScope(s){this.loaded.set(s,!1),this.imageProviders.set(s,new Map),this.images.set(s,new Map),this.updatedImages.set(s,new Set),this.callbackDispatchedThisFrame.set(s,new Set),this.patterns.set(s,new Map),this.atlasImage.set(s,new o.q({width:1,height:1}))}removeScope(s){this.loaded.delete(s),this.imageProviders.delete(s),this.images.delete(s),this.updatedImages.delete(s),this.callbackDispatchedThisFrame.delete(s),this.patterns.delete(s),this.atlasImage.delete(s);const d=this.atlasTexture.get(s);d&&(d.destroy(),this.atlasTexture.delete(s))}addImageProvider(s,d){this.imageProviders.has(d)||this.imageProviders.set(d,new Map),this.imageProviders.get(d).set(s.id,s)}removeImageProvider(s,d){this.imageProviders.has(d)&&this.imageProviders.get(d).delete(s)}getPendingImageProviders(){const s=[];for(const d of this.imageProviders.values())for(const m of d.values())m.hasPendingRequests()&&s.push(m);return s}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new o.x),this._imageRasterizer}isLoaded(){for(const s of this.loaded.keys())if(!this.loaded.get(s))return!1;return!0}setLoaded(s,d){if(this.loaded.get(d)!==s&&(this.loaded.set(d,s),s)){for(const{ids:m,callback:v}of this.requestors)this._notify(m,d,v);this.requestors=[]}}hasImage(s,d){return!!this.getImage(s,d)}getImage(s,d){return this.images.get(d).get(s.toString())}addImage(s,d,m){this._validate(s,m)&&this.images.get(d).set(s.toString(),m)}_validate(s,d){let m=!0;return this._validateStretch(d.stretchX,d.data&&d.data.width)||(this.fire(new o.y(new Error(`Image "${s.name}" has invalid "stretchX" value`))),m=!1),this._validateStretch(d.stretchY,d.data&&d.data.height)||(this.fire(new o.y(new Error(`Image "${s.name}" has invalid "stretchY" value`))),m=!1),this._validateContent(d.content,d)||(this.fire(new o.y(new Error(`Image "${s.name}" has invalid "content" value`))),m=!1),m}_validateStretch(s,d){if(!s)return!0;let m=0;for(const v of s){if(v[0]<m||v[1]<v[0]||d<v[1])return!1;m=v[1]}return!0}_validateContent(s,d){return s?s.length!==4||!d.usvg&&(s[0]<0||d.data.width<s[0]||s[1]<0||d.data.height<s[1]||s[2]<0||d.data.width<s[2]||s[3]<0||d.data.height<s[3])?!1:!(s[2]<s[0]||s[3]<s[1]):!0}updateImage(s,d,m){const v=this.images.get(d).get(s.toString());m.version=v.version+1,this.images.get(d).set(s.toString(),m),this.updatedImages.get(d).add(s),this.removeFromImageRasterizerCache(s,d)}clearUpdatedImages(s){this.updatedImages.get(s).clear()}removeFromImageRasterizerCache(s,d){this.spriteFormat!=="raster"&&(o.r()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[s],scope:d}):this.imageRasterizer.removeImagesFromCacheByIds([s],d))}removeImage(s,d){const m=this.images.get(d),v=m.get(s.toString());m.delete(s.toString()),this.patterns.get(d).delete(s.toString()),this.removeFromImageRasterizerCache(s,d),v.userImage&&v.userImage.onRemove&&v.userImage.onRemove()}listImages(s){return Array.from(this.images.get(s).keys()).map(d=>o.I.from(d))}getImages(s,d,m){const v=[],b=[],S=this.imageProviders.get(d);for(const z of s){if(!z.iconsetId){v.push(z);continue}const U=S.get(z.iconsetId);U&&(this.getImage(z,d)?b.push(z):U.addPendingRequest(z))}if(v.length===0)return void this._notify(b,d,m);let E=!0;const k=!!this.loaded.get(d),O=this.images.get(d);if(!k)for(const z of v)O.has(z.toString())||(E=!1);k||E?this._notify(v,d,m):this.requestors.push({ids:v,scope:d,callback:m})}rasterizeImages(s,d){const m=new Map,{tasks:v,scope:b}=s;for(const[S,E]of v.entries()){const k=this.getImage(E.id,b);k&&m.set(S,{image:k,imageVariant:E})}this._rasterizeImages(b,m,d)}_rasterizeImages(s,d,m){if(o.r())this.imageRasterizerDispatcher.getActor().send("rasterizeImagesWorker",{tasks:d,scope:s},m);else{const v=new Map;for(const[b,{image:S,imageVariant:E}]of d.entries())v.set(b,this.imageRasterizer.rasterize(E,S,s,0));m(void 0,v)}}getUpdatedImages(s){return this.updatedImages.get(s)||new Set}_notify(s,d,m){const v=this.images.get(d),b=new Map;for(const S of s){if(!v.get(S.toString())){if(S.iconsetId)continue;this.fire(new o.z("styleimagemissing",{id:S.name}))}const E=v.get(S.toString());if(!E){o.w(`Image "${S.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`);continue}const k={data:E.usvg?null:E.data.clone(),pixelRatio:E.pixelRatio,sdf:E.sdf,usvg:E.usvg,version:E.version,stretchX:E.stretchX,stretchY:E.stretchY,content:E.content,hasRenderCallback:!!(E.userImage&&E.userImage.render)};E.usvg&&Object.assign(k,{width:E.icon.usvg_tree.width,height:E.icon.usvg_tree.height}),b.set(o.I.toString(S),k)}m(null,b)}getPixelSize(s){const{width:d,height:m}=this.atlasImage.get(s);return{width:d,height:m}}getPattern(s,d,m){const v=s.toString(),b=this.patterns.get(d),S=b.get(v),E=this.getImage(s,d);if(!E)return null;if(S){if(S.position.version===E.version)return S.position;S.position.version=E.version}else{if(E.usvg&&!E.data){const k=this.getPatternInFlightId(v,d);if(this.patternsInFlight.has(k))return null;this.patternsInFlight.add(k);const O=new o.A(s).scaleSelf(o.o.devicePixelRatio),z=new Map([[O.toString(),{image:E,imageVariant:O}]]);return this._rasterizeImages(d,z,(U,F)=>this.storePatternImage(O,d,E,m,F)),null}this.storePattern(s,d,E)}return this._updatePatternAtlas(d,m),b.get(v).position}getPatternInFlightId(s,d){return o.B(s,d)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(s,d,m,v,b){const S=s.toString(),E=b?b.get(S):void 0;E&&(m.data=E,this.storePattern(s.id,d,m),this._updatePatternAtlas(d,v),this.patternsInFlight.delete(this.getPatternInFlightId(s.id.toString(),d)))}storePattern(s,d,m){const v={w:m.data.width+2*o.C,h:m.data.height+2*o.C,x:0,y:0},b=new o.F(v,m,o.C);this.patterns.get(d).set(s.toString(),{bin:v,position:b})}destroyAtlasTextures(){for(const s of this.atlasTexture.values())s&&s.destroy();this.atlasTexture.clear()}bind(s,d){const m=s.gl;let v=this.atlasTexture.get(d);v?this.dirty&&(v.update(this.atlasImage.get(d)),this.dirty=!1):(v=new o.T(s,this.atlasImage.get(d),m.RGBA8),this.atlasTexture.set(d,v)),v.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(s,d){const m=this.patterns.get(s),v=Array.from(m.values()).map(({bin:O})=>O),{w:b,h:S}=o.G(v),E=this.atlasImage.get(s);E.resize({width:b||1,height:S||1});const k=this.images.get(s);for(const[O,{bin:z,position:U}]of m.entries()){let F=U.padding;const H=z.x+F,G=z.y+F,W=k.get(O).data,ne=W.width,X=W.height;F=F>1?F-1:F,o.q.copy(W,E,{x:0,y:0},{x:H,y:G},{width:ne,height:X},d),o.q.copy(W,E,{x:0,y:X-F},{x:H,y:G-F},{width:ne,height:F},d),o.q.copy(W,E,{x:0,y:0},{x:H,y:G+X},{width:ne,height:F},d),o.q.copy(W,E,{x:ne-F,y:0},{x:H-F,y:G},{width:F,height:X},d),o.q.copy(W,E,{x:0,y:0},{x:H+ne,y:G},{width:F,height:X},d),o.q.copy(W,E,{x:ne-F,y:X-F},{x:H-F,y:G-F},{width:F,height:F},d),o.q.copy(W,E,{x:0,y:X-F},{x:H+ne,y:G-F},{width:F,height:F},d),o.q.copy(W,E,{x:0,y:0},{x:H+ne,y:G+X},{width:F,height:F},d),o.q.copy(W,E,{x:ne-F,y:0},{x:H-F,y:G+X},{width:F,height:F},d)}this.dirty=!0}beginFrame(){for(const s of this.images.keys())this.callbackDispatchedThisFrame.set(s,new Set)}dispatchRenderCallbacks(s,d){const m=this.images.get(d);for(const v of s){if(this.callbackDispatchedThisFrame.get(d).has(v.toString()))continue;this.callbackDispatchedThisFrame.get(d).add(v.toString());const b=m.get(v.toString());vt(b)&&this.updateImage(v,d,b)}}destroy(){this.imageRasterizerDispatcher&&this.imageRasterizerDispatcher.remove()}}function an(g){const s=g.value,d=g.valueSpec,m=g.style,v=g.styleSpec,b=g.key,S=g.arrayElementValidator||vr;if(!Array.isArray(s))return[new o.V(b,s,`array expected, ${o.K(s)} found`)];if(d.length&&s.length!==d.length)return[new o.V(b,s,`array length ${d.length} expected, length ${s.length} found`)];if(d["min-length"]&&s.length<d["min-length"])return[new o.V(b,s,`array length at least ${d["min-length"]} expected, length ${s.length} found`)];let E={type:d.value,values:d.values,minimum:d.minimum,maximum:d.maximum,function:void 0};v.$version<7&&(E.function=d.function),o.H(d.value)&&(E=d.value);let k=[];for(let O=0;O<s.length;O++)k=k.concat(S({array:s,arrayIndex:O,value:s[O],valueSpec:E,style:m,styleSpec:v,key:`${b}[${O}]`},!0));return k}function Qt(g){const s=g.key,d=g.value,m=g.valueSpec;if(!o.L(d))return[new o.V(s,d,`number expected, ${o.K(d)} found`)];if(d!=d)return[new o.V(s,d,"number expected, NaN found")];if("minimum"in m){let v=m.minimum;if(Array.isArray(m.minimum)&&(v=m.minimum[g.arrayIndex]),d<v)return[new o.V(s,d,`${d} is less than the minimum value ${v}`)]}if("maximum"in m){let v=m.maximum;if(Array.isArray(m.maximum)&&(v=m.maximum[g.arrayIndex]),d>v)return[new o.V(s,d,`${d} is greater than the maximum value ${v}`)]}return[]}function On(g){const s=g.key,d=g.value;if(!o.H(d))return[new o.V(s,d,`object expected, ${o.K(d)} found`)];const m=g.valueSpec,v=o.J(d.type);let b,S,E,k={};const O=v!=="categorical"&&d.property===void 0,z=!O,U=function(W){const ne=W.stops;return Array.isArray(ne)&&Array.isArray(ne[0])&&o.H(ne[0][0])}(d),F=ns({key:g.key,value:g.value,valueSpec:g.styleSpec.function,style:g.style,styleSpec:g.styleSpec,objectElementValidators:{stops:function(W){if(v==="identity")return[new o.V(W.key,W.value,'identity function may not have a "stops" property')];let ne=[];const X=W.value;return ne=ne.concat(an({key:W.key,value:X,valueSpec:W.valueSpec,style:W.style,styleSpec:W.styleSpec,arrayElementValidator:H})),Array.isArray(X)&&X.length===0&&ne.push(new o.V(W.key,X,"array must have at least one stop")),ne},default:function(W){return vr({key:W.key,value:W.value,valueSpec:m,style:W.style,styleSpec:W.styleSpec})}}});return v==="identity"&&O&&F.push(new o.V(g.key,g.value,'missing required property "property"')),v==="identity"||d.stops||F.push(new o.V(g.key,g.value,'missing required property "stops"')),v==="exponential"&&m.expression&&!o.M(m)&&F.push(new o.V(g.key,g.value,"exponential functions not supported")),g.styleSpec.$version>=8&&(z&&!o.N(m)?F.push(new o.V(g.key,g.value,"property functions not supported")):O&&!o.O(m)&&F.push(new o.V(g.key,g.value,"zoom functions not supported"))),v!=="categorical"&&!U||d.property!==void 0||F.push(new o.V(g.key,g.value,'"property" property is required')),F;function H(W){let ne=[];const X=W.value,re=W.key;if(!Array.isArray(X))return[new o.V(re,X,`array expected, ${o.K(X)} found`)];if(X.length!==2)return[new o.V(re,X,`array length 2 expected, length ${X.length} found`)];if(U){if(!o.H(X[0]))return[new o.V(re,X,`object expected, ${o.K(X[0])} found`)];const he=X[0];if(he.zoom===void 0)return[new o.V(re,X,"object stop key must have zoom")];if(he.value===void 0)return[new o.V(re,X,"object stop key must have value")];const pe=o.J(he.zoom);if(typeof pe!="number")return[new o.V(re,he.zoom,"stop zoom values must be numbers")];if(E&&E>pe)return[new o.V(re,he.zoom,"stop zoom values must appear in ascending order")];pe!==E&&(E=pe,S=void 0,k={}),ne=ne.concat(ns({key:`${re}[0]`,value:X[0],valueSpec:{zoom:{}},style:W.style,styleSpec:W.styleSpec,objectElementValidators:{zoom:Qt,value:G}}))}else ne=ne.concat(G({key:`${re}[0]`,value:X[0],style:W.style,styleSpec:W.styleSpec},X));return o.Q(o.S(X[1]))?ne.concat([new o.V(`${re}[1]`,X[1],"expressions are not allowed in function stops.")]):ne.concat(vr({key:`${re}[1]`,value:X[1],valueSpec:m,style:W.style,styleSpec:W.styleSpec}))}function G(W,ne){const X=o.K(W.value),re=o.J(W.value),he=W.value!==null?W.value:ne;if(b){if(X!==b)return[new o.V(W.key,he,`${X} stop domain type must match previous stop domain type ${b}`)]}else b=X;if(X!=="number"&&X!=="string"&&X!=="boolean"&&typeof re!="number"&&typeof re!="string"&&typeof re!="boolean")return[new o.V(W.key,he,"stop domain value must be a number, string, or boolean")];if(X!=="number"&&v!=="categorical"){let pe=`number expected, ${X} found`;return o.N(m)&&v===void 0&&(pe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new o.V(W.key,he,pe)]}return v!=="categorical"||X!=="number"||typeof re=="number"&&isFinite(re)&&Math.floor(re)===re?v!=="categorical"&&X==="number"&&typeof re=="number"&&typeof S=="number"&&S!==void 0&&re<S?[new o.V(W.key,he,"stop domain values must appear in ascending order")]:(S=re,v==="categorical"&&re in k?[new o.V(W.key,he,"stop domain values must be unique")]:(k[re]=!0,[])):[new o.V(W.key,he,`integer expected, found ${String(re)}`)]}}function fn(g){const s=(g.expressionContext==="property"?o.W:o.U)(o.S(g.value),g.valueSpec);if(s.result==="error")return s.value.map(m=>new o.V(`${g.key}${m.key}`,g.value,m.message));const d=s.value.expression||s.value._styleExpression.expression;if(g.expressionContext==="property"&&g.propertyKey==="text-font"&&!d.outputDefined())return[new o.V(g.key,g.value,`Invalid data expression for "${g.propertyKey}". Output values must be contained as literals within the expression.`)];if(g.expressionContext==="property"&&g.propertyType==="layout"&&!o.Z(d))return[new o.V(g.key,g.value,'"feature-state" data expressions are not supported with layout properties.')];if(g.expressionContext==="filter")return mn(d,g);if(g.expressionContext==="appearance")return dn(d,g);if(g.expressionContext&&g.expressionContext.indexOf("cluster")===0){if(!o.X(d,["zoom","feature-state"]))return[new o.V(g.key,g.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(g.expressionContext==="cluster-initial"&&!o.Y(d))return[new o.V(g.key,g.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function mn(g,s){const d=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(s.valueSpec&&s.valueSpec.expression)for(const v of s.valueSpec.expression.parameters)d.delete(v);if(d.size===0)return[];const m=[];return g instanceof o._&&d.has(g.name)?[new o.V(s.key,s.value,`["${g.name}"] expression is not supported in a filter for a ${s.object.type} layer with id: ${s.object.id}`)]:(g.eachChild(v=>{m.push(...mn(v,s))}),m)}function dn(g,s){const d=new Set;if(s.valueSpec&&s.valueSpec.expression)for(const v of s.valueSpec.expression.parameters)d.add(v);if(d.size===0)return[];const m=[];return g instanceof o._&&!d.has(g.name)?[new o.V(s.key,s.value,`["${g.name}"] is not an allowed parameter`)]:(g.eachChild(v=>{m.push(...dn(v,s))}),m)}function pi(g){const s=g.key,d=g.value,m=g.valueSpec,v=[];return Array.isArray(m.values)?m.values.indexOf(o.J(d))===-1&&v.push(new o.V(s,d,`expected one of [${m.values.join(", ")}], ${JSON.stringify(d)} found`)):Object.keys(m.values).indexOf(o.J(d))===-1&&v.push(new o.V(s,d,`expected one of [${Object.keys(m.values).join(", ")}], ${JSON.stringify(d)} found`)),v}function Ln(g){return o.a2(o.S(g.value))?fn(Object.assign({},g,{expressionContext:"filter",valueSpec:g.styleSpec[`filter_${g.layerType||"fill"}`]})):mi(g)}function mi(g){const s=g.value,d=g.key;if(!Array.isArray(s))return[new o.V(d,s,`array expected, ${o.K(s)} found`)];if(s.length<1)return[new o.V(d,s,"filter array must have at least 1 element")];const m=g.styleSpec;let v=pi({key:`${d}[0]`,value:s[0],valueSpec:m.filter_operator});switch(o.J(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&o.J(s[1])==="$type"&&v.push(new o.V(d,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&v.push(new o.V(d,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(o.a0(s[1])||v.push(new o.V(`${d}[1]`,s[1],`string expected, ${o.K(s[1])} found`)));for(let b=2;b<s.length;b++)o.J(s[1])==="$type"?v=v.concat(pi({key:`${d}[${b}]`,value:s[b],valueSpec:m.geometry_type})):o.a0(s[b])||o.L(s[b])||o.$(s[b])||v.push(new o.V(`${d}[${b}]`,s[b],`string, number, or boolean expected, ${o.K(s[b])} found.`));break;case"any":case"all":case"none":for(let b=1;b<s.length;b++)v=v.concat(mi({key:`${d}[${b}]`,value:s[b],style:g.style,styleSpec:g.styleSpec}));break;case"has":case"!has":s.length!==2?v.push(new o.V(d,s,`filter array for "${s[0]}" operator must have 2 elements`)):o.a0(s[1])||v.push(new o.V(`${d}[1]`,s[1],`string expected, ${o.K(s[1])} found`))}return v}function yi(g,s){const d=g.key,m=g.style,v=g.layer,b=g.styleSpec,S=g.value,E=g.objectKey,k=b[`${s}_${g.layerType}`];if(!k)return[];const O=E.match(/^(.*)-use-theme$/);if(O&&k[O[1]])return o.Q(S)?[].concat(vr({key:g.key,value:S,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:m,styleSpec:b,expressionContext:"property",propertyType:s,propertyKey:E})):vr({key:d,value:S,valueSpec:{type:"string"},style:m,styleSpec:b});const z=E.match(/^(.*)-transition$/);if(s==="paint"&&z&&k[z[1]]&&k[z[1]].transition)return vr({key:d,value:S,valueSpec:b.transition,style:m,styleSpec:b});const U=g.valueSpec||k[E];if(!U)return[new o.a3(d,S,`unknown property "${E}"`)];let F;if(o.a0(S)&&o.N(U)&&!U.tokens&&(F=/^{([^}]+)}$/.exec(S))){const G=`\`{ "type": "identity", "property": ${F?JSON.stringify(F[1]):'"_"'} }\``;return[new o.V(d,S,`"${E}" does not support interpolation syntax
Use an identity property function instead: ${G}.`)]}const H=[];if(g.layerType==="symbol")E!=="text-field"||!m||m.glyphs||m.imports||H.push(new o.V(d,S,'use of "text-field" requires a style "glyphs" property')),E==="text-font"&&o.a4(o.S(S))&&o.J(S.type)==="identity"&&H.push(new o.V(d,S,'"text-font" does not support identity functions'));else if(g.layerType==="model"&&s==="paint"&&v&&v.layout&&v.layout.hasOwnProperty("model-id")&&o.N(U)&&(o.a5(U)||o.O(U))){const G=o.W(o.S(S),U),W=G.value.expression||G.value._styleExpression.expression;W&&!o.X(W,["measure-light"])&&(E==="model-emissive-strength"&&o.Y(W)&&o.Z(W)||H.push(new o.V(d,S,`${E} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return H.concat(vr({key:g.key,value:S,valueSpec:U,style:m,styleSpec:b,expressionContext:"property",propertyType:s,propertyKey:E}))}function xi(g){return yi(g,"paint")}function nr(g){return yi(g,"layout")}function yr(g){let s=[];const d=g.value,m=g.key,v=g.style,b=g.styleSpec;if(!o.H(d))return[new o.V(m,d,"object expected")];d.type||d.ref||s.push(new o.V(m,d,'either "type" or "ref" is required'));let S=o.J(d.type);const E=o.J(d.ref);if(d.id){const k=o.J(d.id);for(let O=0;O<g.arrayIndex;O++){const z=v.layers[O];o.J(z.id)===k&&s.push(new o.V(m,d.id,`duplicate layer id "${k}", previously used at line ${z.id.__line__}`))}}if("ref"in d){let k;["type","source","source-layer","filter","layout"].forEach(O=>{O in d&&s.push(new o.V(m,d[O],`"${O}" is prohibited for ref layers`))}),v.layers.forEach(O=>{o.J(O.id)===E&&(k=O)}),k?k.ref?s.push(new o.V(m,d.ref,"ref cannot reference another ref layer")):S=o.J(k.type):typeof E=="string"&&s.push(new o.V(m,d.ref,`ref layer "${E}" not found`))}else if(S!=="background"&&S!=="sky"&&S!=="slot")if(d.source)if(o.a0(d.source)){const k=v.sources&&v.sources[d.source],O=k&&o.J(k.type);k?O==="vector"&&S==="raster"?s.push(new o.V(m,d.source,`layer "${d.id}" requires a raster source`)):O==="raster"&&S!=="raster"?s.push(new o.V(m,d.source,`layer "${d.id}" requires a vector source`)):O!=="vector"||d["source-layer"]?O==="raster-dem"&&S!=="hillshade"?s.push(new o.V(m,d.source,"raster-dem source can only be used with layer type 'hillshade'.")):O!=="raster-array"||["raster","raster-particle"].includes(S)?S==="line"&&d.paint&&(d.paint["line-gradient"]||d.paint["line-trim-offset"])&&O==="geojson"&&!k.lineMetrics?s.push(new o.V(m,d,`layer "${d.id}" specifies a line-gradient, which requires the GeoJSON source to have \`lineMetrics\` enabled.`)):S==="raster-particle"&&O!=="raster-array"&&s.push(new o.V(m,d.source,`layer "${d.id}" requires a 'raster-array' source.`)):s.push(new o.V(m,d.source,"raster-array source can only be used with layer type 'raster'.")):s.push(new o.V(m,d,`layer "${d.id}" must specify a "source-layer"`)):s.push(new o.V(m,d.source,`source "${d.source}" not found`))}else s.push(new o.V(`${m}.source`,d.source,'"source" must be a string'));else s.push(new o.V(m,d,'missing required property "source"'));return s=s.concat(ns({key:m,value:d,valueSpec:b.layer,style:g.style,styleSpec:g.styleSpec,objectElementValidators:{"*":()=>[],type:()=>vr({key:`${m}.type`,value:d.type,valueSpec:b.layer.type,style:g.style,styleSpec:g.styleSpec,object:d,objectKey:"type"}),filter:k=>Ln(Object.assign({layerType:S},k)),layout:k=>ns({layer:d,key:k.key,value:k.value,valueSpec:{},style:k.style,styleSpec:k.styleSpec,objectElementValidators:{"*":O=>nr(Object.assign({layerType:S},O))}}),paint:k=>ns({layer:d,key:k.key,value:k.value,valueSpec:{},style:k.style,styleSpec:k.styleSpec,objectElementValidators:{"*":O=>xi(Object.assign({layerType:S,layer:d},O))}}),appearances(k){const O=an({key:k.key,value:k.value,valueSpec:k.valueSpec,style:k.style,styleSpec:k.styleSpec,arrayElementValidator:F=>function(H){const{key:G,layer:W,layerType:ne}=H,X=o.J(H.value),re=o.J(X.name),he=o.J(X.condition),pe=ns({key:G,value:X,valueSpec:H.styleSpec.appearance,style:H.style,styleSpec:H.styleSpec,objectElementValidators:{condition:Ie=>function(Se){const Ae=[];return Ae.push(...fn({key:Se.key,value:Se.object.condition,valueSpec:o.a6.appearance.condition,expressionContext:"appearance"})),Ae}(Object.assign({layer:W,layerType:ne},Ie)),properties:Ie=>function(Se){const Ae=[],{styleSpec:Ce,layer:we,layerType:ke}=Se,nt=Ce[`paint_${ke}`],Ke=Ce[`layout_${ke}`],ht=Se.object[Se.objectKey];for(const et in ht){const ut=et in nt?"paint":et in Ke?"layout":void 0;if(!ut){Ae.push(new o.V(Se.key,et,`unknown property "${et}" for layer type "${ke}"`));continue}const jt=Object.assign({},Se,{key:`${Se.key}.${et}`,object:ht,objectKey:et,layer:we,layerType:ke,value:ht[et],valueSpec:ut==="paint"?nt[et]:Ke[et]});Ae.push(...yi(jt,ut))}return Ae}(Object.assign({layer:W,layerType:ne},Ie))}});return re==="hidden"||he||pe.push(new o.V(H.key,"name",'Appearance with name different than "hidden" must have a condition')),pe}(Object.assign({layerType:S,layer:d},F))}),z=Array.isArray(k.value)?k.value:[],U=new Set;return z.forEach((F,H)=>{const G=o.J(F.name);if(G)if(U.has(G)){const W=o.J(d.id);O.push(new o.V(k.key,G,`Duplicated appearance name "${G}" for layer "${W}"`))}else U.add(G)}),O}}})),s}function zo({key:g,value:s}){return o.a0(s)?[]:[new o.V(g,s,`string expected, ${o.K(s)} found`)]}const Io={promoteId:function g({key:s,value:d}){if(o.a0(d))return zo({key:s,value:d});if(Array.isArray(d)){const v=[],b=o.S(d),S=o.U(b);return S.result==="error"&&S.value.forEach(E=>{v.push(new o.V(`${s}${E.key}`,null,`${E.message}`))}),o.X(S.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||v.push(new o.V(`${s}`,null,"promoteId expression should be only feature dependent")),v}if(!o.H(d))return[new o.V(s,d,`string, expression or object expected, "${o.K(d)}" found`)];const m=[];for(const v in d)m.push(...g({key:`${s}.${v}`,value:d[v]}));return m}};function Sr(g){const s=g.value,d=g.key,m=g.styleSpec,v=g.style;if(!o.H(s))return[new o.V(d,s,`object expected, ${o.K(s)} found`)];if(!("type"in s))return[new o.V(d,s,'"type" is required')];const b=o.J(s.type);let S=[];switch(["vector","raster","raster-dem","raster-array"].includes(b)&&("url"in s||"tiles"in s||S.push(new o.a3(d,s,'Either "url" or "tiles" is required.'))),b){case"vector":case"raster":case"raster-dem":case"raster-array":return S=S.concat(ns({key:d,value:s,valueSpec:m[`source_${b.replace("-","_")}`],style:g.style,styleSpec:m,objectElementValidators:Io})),S;case"geojson":if(S=ns({key:d,value:s,valueSpec:m.source_geojson,style:v,styleSpec:m,objectElementValidators:Io}),"cluster"in s&&"clusterProperties"in s){if(!o.H(s.clusterProperties))return[new o.V(`${d}.clusterProperties`,s,`object expected, ${o.K(s)} found`)];for(const E in s.clusterProperties){const k=s.clusterProperties[E];if(!Array.isArray(k))return[new o.V(`${d}.clusterProperties.${E}`,k,"array expected")];const[O,z]=k,U=typeof O=="string"?[O,["accumulated"],["get",E]]:O;S.push(...fn({key:`${d}.${E}.map`,value:z,expressionContext:"cluster-map"})),S.push(...fn({key:`${d}.${E}.reduce`,value:U,expressionContext:"cluster-reduce"}))}}return S;case"video":return ns({key:d,value:s,valueSpec:m.source_video,style:v,styleSpec:m});case"image":return ns({key:d,value:s,valueSpec:m.source_image,style:v,styleSpec:m});case"canvas":return[new o.V(d,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return pi({key:`${d}.type`,value:s.type,valueSpec:{values:ho(m)}})}}function ho(g){return g.source.reduce((s,d)=>{const m=g[d];return m.type.type==="enum"&&(s=s.concat(Object.keys(m.type.values))),s},[])}function Cs(g){const s=g.value,d=g.styleSpec,m=d.light,v=g.style;if(s===void 0)return[];if(!o.H(s))return[new o.V("light",s,`object expected, ${o.K(s)} found`)];let b=[];for(const S in s){const E=S.match(/^(.*)-transition$/),k=S.match(/^(.*)-use-theme$/);b=b.concat(k&&m[k[1]]?vr({key:S,value:s[S],valueSpec:{type:"string"},style:v,styleSpec:d}):E&&m[E[1]]&&m[E[1]].transition?vr({key:S,value:s[S],valueSpec:d.transition,style:v,styleSpec:d}):m[S]?vr({key:S,value:s[S],valueSpec:m[S],style:v,styleSpec:d}):[new o.V(S,s[S],`unknown property "${S}"`)])}return b}function ha(g){const s=g.value;if(!s)return[];const d=g.key;if(!o.H(s))return[new o.V(d,s,`object expected, ${o.K(s)} found`)];let m=[];const v=g.styleSpec,b=v["light-3d"],S=g.style,E=g.style.lights;for(const z of["type","id"])if(!(z in s))return m=m.concat([new o.V(d,s,`missing property "${z}"`)]),m;if(!o.a0(s.type))return m=m.concat([new o.V(`${d}.type`,s.type,"string expected")]),m;if(E)for(let z=0;z<g.arrayIndex;z++){const U=o.J(s.type),F=E[z];o.J(F.type)===U&&m.push(new o.V(d,s.id,`duplicate light type "${s.type}", previously defined at line ${F.id.__line__}`))}const k=`properties_light_${s.type}`;if(!(k in v))return m=m.concat([new o.V(`${d}.type`,s,`Invalid light type ${s.type}`)]),m;const O=v[k];for(const z in s)if(z==="properties"){const U=s[z];if(!o.H(U))return m=m.concat([new o.V("properties",U,`object expected, ${o.K(U)} found`)]),m;for(const F in U){const H=F.match(/^(.*)-transition$/),G=F.match(/^(.*)-use-theme$/);m=m.concat(G&&O[G[1]]?vr({key:z,value:U[F],valueSpec:{type:"string"},style:S,styleSpec:v}):H&&O[H[1]]&&O[H[1]].transition?vr({key:z,value:s[z],valueSpec:v.transition,style:S,styleSpec:v}):O[F]?vr({key:F,value:U[F],valueSpec:O[F],style:S,styleSpec:v}):[new o.a3(g.key,U[F],`unknown property "${F}"`)])}}else m=m.concat(b[z]?vr({key:z,value:s[z],valueSpec:b[z],style:S,styleSpec:v}):[new o.a3(z,s[z],`unknown property "${z}"`)]);return m}function ao(g){const s=g.value,d=g.key,m=g.style,v=g.styleSpec,b=v.terrain;if(s==null)return[];if(!o.H(s))return[new o.V("terrain",s,`object expected, ${o.K(s)} found`)];let S=[];for(const E in s){const k=E.match(/^(.*)-transition$/),O=E.match(/^(.*)-use-theme$/);S=S.concat(O&&b[O[1]]?vr({key:E,value:s[E],valueSpec:{type:"string"},style:m,styleSpec:v}):k&&b[k[1]]&&b[k[1]].transition?vr({key:E,value:s[E],valueSpec:v.transition,style:m,styleSpec:v}):b[E]?vr({key:E,value:s[E],valueSpec:b[E],style:m,styleSpec:v}):[new o.a3(E,s[E],`unknown property "${E}"`)])}if(s.source)if(o.a0(s.source)){const E=m.sources&&m.sources[s.source],k=E&&o.J(E.type);E?k!=="raster-dem"&&S.push(new o.V(`${d}.source`,s.source,`terrain cannot be used with a source of type ${k}, it only be used with a "raster-dem" source type`)):S.push(new o.V(`${d}.source`,s.source,`source "${s.source}" not found`))}else S.push(new o.V(`${d}.source`,s.source,"source must be a string"));else S.push(new o.V(d,s,'terrain is missing required property "source"'));return S}function Ao(g){const s=g.value,d=g.style,m=g.styleSpec,v=m.fog;if(s===void 0)return[];if(!o.H(s))return[new o.V("fog",s,`object expected, ${o.K(s)} found`)];let b=[];for(const S in s){const E=S.match(/^(.*)-transition$/),k=S.match(/^(.*)-use-theme$/);b=b.concat(k&&v[k[1]]?vr({key:S,value:s[S],valueSpec:{type:"string"},style:d,styleSpec:m}):E&&v[E[1]]&&v[E[1]].transition?vr({key:S,value:s[S],valueSpec:m.transition,style:d,styleSpec:m}):v[S]?vr({key:S,value:s[S],valueSpec:v[S],style:d,styleSpec:m}):[new o.a3(S,s[S],`unknown property "${S}"`)])}return b}const Fa={"*":()=>[],array:an,boolean:function(g){const s=g.value,d=g.key;return o.$(s)?[]:[new o.V(d,s,`boolean expected, ${o.K(s)} found`)]},number:Qt,color:function({key:g,value:s}){return o.a0(s)?o.a1.parseCSSColor(s)===null?[new o.V(g,s,`color expected, "${s}" found`)]:[]:[new o.V(g,s,`color expected, ${o.K(s)} found`)]},enum:pi,filter:Ln,function:On,layer:yr,object:ns,source:Sr,model:o.a7,light:Cs,"light-3d":ha,terrain:ao,fog:Ao,string:zo,formatted:function(g){return zo(g).length===0?[]:fn(g)},resolvedImage:function(g){return zo(g).length===0?[]:fn(g)},projection:function(g){const s=g.value,d=g.styleSpec,m=d.projection,v=g.style;if(o.H(s)){let b=[];for(const S in s)b=b.concat(vr({key:S,value:s[S],valueSpec:m[S],style:v,styleSpec:d}));return b}return o.a0(s)?[]:[new o.V("projection",s,`object or string expected, ${o.K(s)} found`)]},import:function(g){const s=g.key,{value:d,styleSpec:m}=g;if(!o.H(d))return[new o.V(s,d,"import must be an object")];const{data:v,...b}=d;Object.defineProperty(b,"__line__",{value:d.__line__,enumerable:!1});let S=ns(Object.assign({},g,{value:b,valueSpec:m.import}));return o.J(b.id)===""&&S.push(new o.V(`${g.key}.id`,b,"import id can't be an empty string")),v&&(S=S.concat(Wl(v,m,{key:`${g.key}.data`}))),S},iconset:function(g){const s=g.value,d=g.key,m=g.styleSpec,v=g.style;if(!o.H(s))return[new o.V(d,s,"object expected")];if(!s.type)return[new o.V(d,s,'"type" is required')];const b=o.J(s.type);let S=[];if(S=S.concat(ns({key:d,value:s,valueSpec:m[`iconset_${b}`],style:v,styleSpec:m})),function(E,k){return!(E!=="source"||!k.source)}(b,s)){const E=v.sources&&v.sources[s.source],k=E&&o.J(E.type);E?k!=="raster-array"&&S.push(new o.V(d,s.source,`iconset cannot be used with a source of type ${String(k)}, it only be used with a "raster-array" source type`)):S.push(new o.V(d,s.source,`source "${s.source}" not found`))}return S}};function vr(g,s=!1){const d=g.value,m=g.valueSpec,v=g.styleSpec;if(m.expression){if(o.a4(o.J(d)))return On(g);if(o.Q(o.S(d)))return fn(g)}if(m.type&&Fa[m.type]){const b=Fa[m.type](g);return s===!0&&b.length>0&&Array.isArray(g.value)?fn(g):b}return ns(Object.assign({},g,{valueSpec:m.type?v[m.type]:m}))}function ns(g){const s=g.key,d=g.value,m=g.valueSpec||{},v=g.objectElementValidators||{},b=g.style,S=g.styleSpec;if(!o.H(d))return[new o.V(s,d,`object expected, ${o.K(d)} found`)];let E=[];for(const k in d){const O=k.split(".")[0];let z;v[O]?z=v[O]:m[O]?z=vr:v["*"]?z=v["*"]:m["*"]&&(z=vr),z?E=E.concat(z({key:(s&&`${s}.`)+k,value:d[k],valueSpec:m[O]||m["*"],style:b,styleSpec:S,object:d,objectKey:k},d)):E.push(new o.a3(s,d[k],`unknown property "${k}"`))}for(const k in m)v[k]||m[k].required&&m[k].default===void 0&&d[k]===void 0&&E.push(new o.V(s,d,`missing required property "${k}"`));return E}function _l({key:g,value:s}){const d=zo({key:g,value:s});if(d.length)return d;const m=s;return m.indexOf("{fontstack}")===-1&&d.push(new o.V(g,s,'"glyphs" url must include a "{fontstack}" token')),m.indexOf("{range}")===-1&&d.push(new o.V(g,s,'"glyphs" url must include a "{range}" token')),d}function Wl(g,s=o.a6,d={}){return ns({key:d.key||"",value:g,valueSpec:Object.assign(s.$root,{"*":{type:"*"}}),styleSpec:s,style:g,objectElementValidators:{glyphs:_l}})}function So(g,s=o.a6){return Oe(Wl(g,s))}const yl=g=>Oe(Sr(g)),Xa=g=>Oe(Cs(g)),vl=g=>Oe(ha(g)),Dt=g=>Oe(ao(g)),bl=g=>Oe(Ao(g)),ql=g=>Oe(function(s){const d=s.value,m=s.style,v=s.styleSpec,b=v.snow;if(d===void 0)return[];if(!o.H(d))return[new o.V("snow",d,`object expected, ${o.K(d)} found`)];let S=[];for(const E in d){const k=E.match(/^(.*)-transition$/);S=S.concat(k&&b[k[1]]&&b[k[1]].transition?vr({key:E,value:d[E],valueSpec:v.transition,style:m,styleSpec:v}):b[E]?vr({key:E,value:d[E],valueSpec:b[E],style:m,styleSpec:v}):[new o.a3(E,d[E],`unknown property "${E}"`)])}return S}(g)),$c=g=>Oe(function(s){const d=s.value,m=s.style,v=s.styleSpec,b=v.rain;if(d===void 0)return[];if(!o.H(d))return[new o.V("rain",d,`object expected, ${o.K(d)} found`)];let S=[];for(const E in d){const k=E.match(/^(.*)-transition$/);S=S.concat(k&&b[k[1]]&&b[k[1]].transition?vr({key:E,value:d[E],valueSpec:v.transition,style:m,styleSpec:v}):b[E]?vr({key:E,value:d[E],valueSpec:b[E],style:m,styleSpec:v}):[new o.a3(E,d[E],`unknown property "${E}"`)])}return S}(g)),Xe=g=>Oe(yr(g)),Y=g=>Oe(Ln(g)),ie=g=>Oe(xi(g)),ve=g=>Oe(nr(g)),Fe=g=>Oe(o.a7(g));function Oe(g){return g.slice().sort((s,d)=>s.line&&d.line?s.line-d.line:0)}function Le(g,s){let d=!1;if(s&&s.length)for(const m of s)m instanceof o.a3?o.w(m.message):(g.fire(new o.y(new Error(m.message))),d=!0);return d}let it;class Ge extends o.E{constructor(s,d="flat"){super(),this._transitionable=new o.a8(it||(it=new o.a9({anchor:new o.aa(o.a6.light.anchor),position:new o.ab(o.a6.light.position),color:new o.aa(o.a6.light.color),intensity:new o.aa(o.a6.light.intensity)}))),this.setLight(s,d),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,d,m={}){this._validate(Xa,s,m)||(this._transitionable.setTransitionOrValue(s),this.id=d)}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,d,m){return(!m||m.validate!==!1)&&Le(this,s.call(So,Object.assign({value:d,style:{glyphs:!0,sprite:!0},styleSpec:o.a6})))}}let st=class extends o.E{constructor(g,s,d,m,v){super(),this.scope=d,this._transitionable=new o.a8(new o.a9({source:new o.aa(o.a6.terrain.source),exaggeration:new o.aa(o.a6.terrain.exaggeration)}),d,m),this._transitionable.setTransitionOrValue(g,m),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=s,this.worldview=v}get(){return this._transitionable.serialize()}set(g,s){this._transitionable.setTransitionOrValue(g,s)}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}getExaggeration(g){return this._transitioning.possiblyEvaluate(new o.ac(g,{worldview:this.worldview})).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const g=this._transitionable._values.exaggeration;if(!g)return null;const s=g.value.expression;if(!s)return null;let d=-1,m=-1,v=1;for(const b of s.zoomStops)v=s.evaluate(new o.ac(b,{worldview:this.worldview})),v>.01?(d=b,m=-1):m=b;return v<.01&&d>0&&m>d?[d,m]:null}isZoomDependent(){const g=this._transitionable._values.exaggeration;return g!=null&&g.value!=null&&g.value.expression!=null&&g.value.expression instanceof o.ad}};const Nt=45,St=65,xn=.05;function Mn(g,s,d,m){const v=o.ah(Nt,St,d),[b,S]=zn(g,m);let E=1-Math.min(1,Math.exp((s-b)/(S-b)*-6));return E*=E*E,E=Math.min(1,1.00747*E),E*v*g.alpha}function zn(g,s){const d=.5/Math.tan(.5*s);return[g.range[0]+d,g.range[1]+d]}function Kn(g,s,d,m,v){const b=o.af([],[s,d,m],v.mercatorFogMatrix);return Mn(g,o.ag(b),v.pitch,v._fov)}function Un(g,s,d,m,v,b,S){const E=[[d,m,0],[v,m,0],[v,b,0],[d,b,0]];let k=Number.MAX_VALUE,O=-Number.MAX_VALUE;for(const z of E){const U=o.af([],z,s),F=o.ag(U);k=Math.min(k,F),O=Math.max(O,F)}return[Mn(g,k,S.pitch,S._fov),Mn(g,O,S.pitch,S._fov)]}class ei extends o.E{constructor(s,d,m,v){super();const b=new o.a9({range:new o.aa(o.a6.fog.range),color:new o.aa(o.a6.fog.color),"color-use-theme":new o.aa({type:"string","property-type":"data-constant",default:"default"}),"high-color":new o.aa(o.a6.fog["high-color"]),"high-color-use-theme":new o.aa({type:"string","property-type":"data-constant",default:"default"}),"space-color":new o.aa(o.a6.fog["space-color"]),"space-color-use-theme":new o.aa({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new o.aa(o.a6.fog["horizon-blend"]),"star-intensity":new o.aa(o.a6.fog["star-intensity"]),"vertical-range":new o.aa(o.a6.fog["vertical-range"])});this._transitionable=new o.a8(b,m,new Map(v)),this.set(s,v),this._transitioning=this._transitionable.untransitioned(),this._transform=d,this.properties=new o.ai(b),this.scope=m}get state(){const s=this._transform,d=s.projection.name==="globe",m=o.aj(s.zoom),v=this.properties.get("range"),b=[.5,3];return{range:d?[o.ak(b[0],v[0],m),o.ak(b[1],v[1],m)]:v,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(s,d,m={}){if(this._validate(bl,s,m))return;const v=Object.assign({},s);for(const b of Object.keys(o.a6.fog))v[b]===void 0&&(v[b]=o.a6.fog[b].default);this._options=v,this._transitionable.setTransitionOrValue(this._options,d)}getOpacity(s){if(!this._transform.projection.supportsFog)return 0;const d=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:o.ah(Nt,St,s))*d.a}getOpacityAtLatLng(s,d){return this._transform.projection.supportsFog?function(m,v,b){const S=o.ae.fromLngLat(v),E=b.elevation?b.elevation.getAtPointOrZero(S):0;return Kn(m,S.x,S.y,E,b)}(this.state,s,d):0}getOpacityForTile(s){if(!this._transform.projection.supportsFog)return[1,1];const d=this._transform.calculateFogTileMatrix(s.toUnwrapped());return Un(this.state,d,0,0,o.al,o.al,this._transform)}getOpacityForBounds(s,d,m,v,b){return this._transform.projection.supportsFog?Un(this.state,s,d,m,v,b,this._transform):[1,1]}getFovAdjustedRange(s){return this._transform.projection.supportsFog?zn(this.state,s):[0,1]}isVisibleOnFrustum(s){if(!this._transform.projection.supportsFog)return!1;const d=[4,5,6,7];for(const m of d){const v=s.points[m];let b;if(v[2]>=0)b=v;else{const S=s.points[m-4];b=o.am(S,v,S[2]/(S[2]-v[2]))}if(Kn(this.state,b[0],b[1],0,this._transform)>=xn)return!0}return!1}updateConfig(s){this._transitionable.setTransitionOrValue(this._options,new Map(s))}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,d,m){return(!m||m.validate!==!1)&&Le(this,s.call(So,Object.assign({value:d,style:{glyphs:!0,sprite:!0},styleSpec:o.a6})))}}let Ei,li,cr,Fr,no=class extends o.E{constructor(g,s,d,m){super();const v=Ei||(Ei=new o.a9({density:new o.aa(o.a6.snow.density),intensity:new o.aa(o.a6.snow.intensity),color:new o.aa(o.a6.snow.color),opacity:new o.aa(o.a6.snow.opacity),vignette:new o.aa(o.a6.snow.vignette),"vignette-color":new o.aa(o.a6.snow["vignette-color"]),"center-thinning":new o.aa(o.a6.snow["center-thinning"]),direction:new o.aa(o.a6.snow.direction),"flake-size":new o.aa(o.a6.snow["flake-size"])}));this._transitionable=new o.a8(v,d,new Map(m)),this.set(g,m),this._transitioning=this._transitionable.untransitioned(),this.properties=new o.ai(v),this.scope=d}get state(){const g=this.properties.get("opacity"),s=this.properties.get("color"),d=this.properties.get("direction"),m=o.an(d[0]),v=-Math.max(o.an(d[1]),.01),b=[Math.cos(m)*Math.cos(v),Math.sin(m)*Math.cos(v),Math.sin(v)],S=this.properties.get("vignette"),E=this.properties.get("vignette-color");return E.a=S,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new o.ao(s.r,s.g,s.b,s.a*g),direction:b,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:E}}get(){return this._transitionable.serialize()}set(g,s,d={}){if(this._validate(ql,g,d))return;const m=Object.assign({},g);for(const v of Object.keys(o.a6.snow))m[v]===void 0&&(m[v]=o.a6.snow[v].default);this._options=m,this._transitionable.setTransitionOrValue(this._options,s)}updateConfig(g){this._transitionable.setTransitionOrValue(this._options,new Map(g))}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}_validate(g,s,d){return(!d||d.validate!==!1)&&Le(this,g.call(So,Object.assign({value:s,style:{glyphs:!0,sprite:!0},styleSpec:o.a6})))}},ir=class extends o.E{constructor(g,s,d,m){super();const v=li||(li=new o.a9({density:new o.aa(o.a6.rain.density),intensity:new o.aa(o.a6.rain.intensity),color:new o.aa(o.a6.rain.color),opacity:new o.aa(o.a6.rain.opacity),vignette:new o.aa(o.a6.rain.vignette),"vignette-color":new o.aa(o.a6.rain["vignette-color"]),"center-thinning":new o.aa(o.a6.rain["center-thinning"]),direction:new o.aa(o.a6.rain.direction),"droplet-size":new o.aa(o.a6.rain["droplet-size"]),"distortion-strength":new o.aa(o.a6.rain["distortion-strength"])}));this._transitionable=new o.a8(v,d,new Map(m)),this.set(g,m),this._transitioning=this._transitionable.untransitioned(),this.properties=new o.ai(v),this.scope=d}get state(){const g=this.properties.get("opacity"),s=this.properties.get("color"),d=this.properties.get("direction"),m=o.an(d[0]),v=-Math.max(o.an(d[1]),.01),b=[Math.cos(m)*Math.cos(v),Math.sin(m)*Math.cos(v),Math.sin(v)],S=this.properties.get("vignette-color");return S.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new o.ao(s.r,s.g,s.b,s.a*g),direction:b,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:S}}get(){return this._transitionable.serialize()}set(g,s,d={}){if(this._validate($c,g,d))return;const m=Object.assign({},g);for(const v of Object.keys(o.a6.rain))m[v]===void 0&&(m[v]=o.a6.rain[v].default);this._options=m,this._transitionable.setTransitionOrValue(this._options,s)}updateConfig(g){this._transitionable.setTransitionOrValue(this._options,new Map(g))}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}_validate(g,s,d){return(!d||d.validate!==!1)&&Le(this,g.call(So,Object.assign({value:s,style:{glyphs:!0,sprite:!0},styleSpec:o.a6})))}};class Oi extends o.E{constructor(s,d,m,v){super(),this.scope=m,this._options=s,this.properties=new o.ai(d),this._transitionable=new o.a8(d,m,new Map(v)),this._transitionable.setTransitionOrValue(s.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(s){this._transitionable.setTransitionOrValue(this._options.properties,new Map(s))}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(s,d){this._options=s,this._transitionable.setTransitionOrValue(s.properties,d)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class Cr{constructor(s,d,m){this.screenBounds=s,this.cameraPoint=m.getCameraPoint(),this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=d,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,m)}static createFromScreenPoints(s,d){let m,v;if(s instanceof o.P||typeof s[0]=="number"){const b=o.P.convert(s);m=[b],v=d.isPointAboveHorizon(b)}else{const b=o.P.convert(s[0]),S=o.P.convert(s[1]),E=b.add(S)._div(2);m=[b,S],v=o.aq(b,S).every(k=>d.isPointAboveHorizon(k))&&d.isPointAboveHorizon(E)}return new Cr(m,v,d)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(s){return o.aq(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],s)}bufferedCameraGeometry(s){const d=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new o.P(1,1)):this.screenBounds[1],v=o.aq(d,m,0,!1);return this.cameraPoint.y>m.y&&(this.cameraPoint.x>d.x&&this.cameraPoint.x<m.x?v.splice(3,0,this.cameraPoint):this.cameraPoint.x>=m.x?v[2]=this.cameraPoint:this.cameraPoint.x<=d.x&&(v[3]=this.cameraPoint)),o.ar(v,s)}bufferedCameraGeometryGlobe(s){const d=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new o.P(1,1)):this.screenBounds[1],v=o.aq(d,m,s),b=this.cameraPoint.clone();switch(3*((b.y>d.y)+(b.y>m.y))+((b.x>d.x)+(b.x>m.x))){case 0:v[0]=b,v[4]=b.clone();break;case 1:v.splice(1,0,b);break;case 2:v[1]=b;break;case 3:v.splice(4,0,b);break;case 5:v.splice(2,0,b);break;case 6:v[3]=b;break;case 7:v.splice(3,0,b);break;case 8:v[2]=b}return v}containsTile(s,d,m,v=0){const b=s.queryPadding/d._pixelsPerMercatorPixel+1,S=m?this._bufferedCameraMercator(b,d):this._bufferedScreenMercator(b,d);let E=s.tileID.wrap+(S.unwrapped?v:0);const k=S.polygon.map(ne=>o.as(s.tileTransform,ne,E));if(!o.at(k,0,0,o.al,o.al))return;E=s.tileID.wrap+(this.screenGeometryMercator.unwrapped?v:0);const O=this.screenGeometryMercator.polygon.map(ne=>o.au(s.tileTransform,ne,E)),z=O.map(ne=>new o.P(ne[0],ne[1])),U=d.getFreeCameraOptions().position||new o.ae(0,0,0),F=o.au(s.tileTransform,U,E),H=O.map(ne=>{const X=o.av(ne,ne,F);return o.aw(X,X),new o.ax(F,X)}),G=o.ay(s,1,d.zoom)*d._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:z,tilespaceRays:H,bufferedTilespaceGeometry:k,bufferedTilespaceBounds:(W=o.az(k),W.min.x=o.aA(W.min.x,0,o.al),W.min.y=o.aA(W.min.y,0,o.al),W.max.x=o.aA(W.max.x,0,o.al),W.max.y=o.aA(W.max.y,0,o.al),W),tile:s,tileID:s.tileID,pixelToTileUnitsFactor:G};var W}_bufferedScreenMercator(s,d){const m=Zo(s);if(this._screenRaycastCache[m])return this._screenRaycastCache[m];{let v;return v=d.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(s),d):{polygon:this.bufferedScreenGeometry(s).map(b=>d.pointCoordinate3D(b)),unwrapped:!0},this._screenRaycastCache[m]=v,v}}_bufferedCameraMercator(s,d){const m=Zo(s);if(this._cameraRaycastCache[m])return this._cameraRaycastCache[m];{let v;return v=d.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(s),d):{polygon:this.bufferedCameraGeometry(s).map(b=>d.pointCoordinate3D(b)),unwrapped:!0},this._cameraRaycastCache[m]=v,v}}_projectAndResample(s,d){const m=function(b,S){const E=o.aB([],S.pixelMatrix,S.globeMatrix),k=[0,-o.aD,0,1],O=[0,o.aD,0,1],z=[0,0,0,1];o.aC(k,k,E),o.aC(O,O,E),o.aC(z,z,E);const U=new o.P(k[0]/k[3],k[1]/k[3]),F=new o.P(O[0]/O[3],O[1]/O[3]),H=o.aE(b,U)&&k[3]<z[3],G=o.aE(b,F)&&O[3]<z[3];if(!H&&!G)return null;const W=function(Ae,Ce,we){for(let ke=1;ke<Ae.length;ke++){const nt=ur(Ce.pointCoordinate3D(Ae[ke-1]).x),Ke=ur(Ce.pointCoordinate3D(Ae[ke]).x);if(we<0){if(nt<Ke)return{idx:ke,t:-nt/(Ke-1-nt)}}else if(Ke<nt)return{idx:ke,t:(1-nt)/(Ke+1-nt)}}return null}(b,S,H?-1:1);if(!W)return null;const{idx:ne,t:X}=W;let re=ne>1?Pr(b.slice(0,ne),S):[],he=ne<b.length?Pr(b.slice(ne),S):[];re=re.map(Ae=>new o.P(ur(Ae.x),Ae.y)),he=he.map(Ae=>new o.P(ur(Ae.x),Ae.y));const pe=[...re];pe.length===0&&pe.push(he[he.length-1]);const Ie=o.ak(pe[pe.length-1].y,(he.length===0?re[0]:he[0]).y,X);let Se;return Se=H?[new o.P(0,Ie),new o.P(0,0),new o.P(1,0),new o.P(1,Ie)]:[new o.P(1,Ie),new o.P(1,1),new o.P(0,1),new o.P(0,Ie)],pe.push(...Se),he.length===0?pe.push(re[0]):pe.push(...he),{polygon:pe.map(Ae=>new o.ae(Ae.x,Ae.y)),unwrapped:!1}}(s,d);if(m)return m;const v=function(b,S){let E=!1,k=-1/0,O=0;for(let U=0;U<b.length-1;U++)b[U].x>k&&(k=b[U].x,O=U);for(let U=0;U<b.length-1;U++){const F=(O+U)%(b.length-1),H=b[F],G=b[F+1];Math.abs(H.x-G.x)>.5&&(H.x<G.x?(H.x+=1,F===0&&(b[b.length-1].x+=1)):(G.x+=1,F+1===b.length-1&&(b[0].x+=1)),E=!0)}const z=o.aF(S.center.lng);return E&&z<Math.abs(z-1)&&b.forEach(U=>{U.x-=1}),{polygon:b,unwrapped:E}}(Pr(s,d).map(b=>new o.P(ur(b.x),b.y)),d);return{polygon:v.polygon.map(b=>new o.ae(b.x,b.y)),unwrapped:v.unwrapped}}}function Pr(g,s){return o.aG(g,d=>{const m=s.pointCoordinate3D(d);d.x=m.x,d.y=m.y},1/256)}function ur(g){return g<0?1+g%1:g%1}function Zo(g){return 100*g|0}function Ts(g,s,d,m,v){const b=function(E,k){if(E)return v(E);if(k){if(g.url&&k.tiles&&g.tiles&&delete g.tiles,k.variants){if(!Array.isArray(k.variants))return v(new Error("variants must be an array"));for(const z of k.variants){if(z==null||typeof z!="object"||z.constructor!==Object)return v(new Error("variant must be an object"));if(!Array.isArray(z.capabilities))return v(new Error("capabilities must be an array"));if(z.capabilities.length===1&&z.capabilities[0]==="meshopt"){k=Object.assign(k,z);break}}}const O=o.aH(Object.assign({},k,g),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","extra_bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);O.tiles=s.canonicalizeTileset(O,g.url),v(null,O)}},S=function(E,k,O){if(!E)return null;if(!k&&!O)return E;O=O||E.worldview_default;const z=Object.values(E.language||{});if(z.length===0)return null;const U=Object.values(E.worldview||{});if(U.length===0)return null;const F=z.every(G=>G===k),H=U.every(G=>G===O);return F&&H?E:k in(E.language_options||{})||O in(E.worldview_options||{})?null:E.language_options&&E.worldview_options?E:null}(g.data,d,m);return S?o.o.frame(()=>b(null,S)):g.url?o.m(s.transformRequest(s.normalizeSourceURL(g.url,null,d,m),o.R.Source),b):o.o.frame(()=>{const{data:E,...k}=g;b(null,k)})}function ta(g,s){const d=Math.pow(2,s.z),m=Math.floor(o.aF(g.getWest())*d),v=Math.floor(o.aJ(g.getNorth())*d),b=Math.ceil(o.aF(g.getEast())*d),S=Math.ceil(o.aJ(g.getSouth())*d);return s.x>=m&&s.x<b&&s.y>=v&&s.y<S}class Ya{constructor(s,d,m){this.bounds=s?o.aI.convert(this.validateBounds(s)):null,this.minzoom=d||0,this.maxzoom=m||24}validateBounds(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}addExtraBounds(s){if(s){this.extraBounds||(this.extraBounds=[]);for(const d of s)this.extraBounds.push(o.aI.convert(this.validateBounds(d)))}}contains(s){if(s.z>this.maxzoom||s.z<this.minzoom||this.bounds&&!ta(this.bounds,s))return!1;if(!this.extraBounds)return!0;for(const d of this.extraBounds)if(ta(d,s))return!0;return!1}static fromTileJSON(s){if(!s.bounds&&!s.extra_bounds)return null;const d=new Ya(s.bounds,s.minzoom,s.maxzoom);return d.addExtraBounds(s.extra_bounds),d}}class ko extends o.E{constructor(s,d,m,v){if(super(),this.id=s,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,Object.assign(this,o.aH(d,["url","scheme","tileSize","promoteId"])),this._options=Object.assign({type:"vector"},d),this._collectResourceTiming=!!d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v),this._tileWorkers={},this._deduped=new o.aK}load(s){this._loaded=!1,this.fire(new o.z("dataloading",{dataType:"source"}));const d=Array.isArray(this.map._language)?this.map._language.join():this.map._language,m=this.map.getWorldview();this._tileJSONRequest=Ts(this._options,this.map._requestManager,d,m,(v,b)=>{if(this._tileJSONRequest=null,this._loaded=!0,v)d&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${d}`),m&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${m}`),this.fire(new o.y(v));else if(b){if(Object.assign(this,b),this.hasWorldviews=!!b.worldview_options,b.worldview_default&&(this.worldviewDefault=b.worldview_default),b.vector_layers){this.vectorLayers=b.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const S of b.vector_layers)this.vectorLayerIds.push(S.id),b.worldview&&b.worldview[S.source]&&this.localizableLayerIds.add(S.id)}this.tileBounds=Ya.fromTileJSON(b),Di(b.tiles,this.map._requestManager._customAccessToken),this.fire(new o.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.z("data",{dataType:"source",sourceDataType:"content"}))}s&&s(v)})}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest();const s=o.B(this.id,this.scope);this.load(()=>this.map.style.clearSource(s))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(s){this.cancelTileJSONRequest()}serialize(){return Object.assign({},this._options)}loadTile(s,d){const m=s.tileID.canonical.url(this.tiles,this.scheme),v=this.map._requestManager.normalizeTileURL(m),b=this.map._requestManager.transformRequest(v,o.R.Tile),S=this.map.style?this.map.style.getLut(this.scope):null,E=S?{image:S.image.clone()}:null,k={request:b,data:void 0,uid:s.uid,tileID:s.tileID,tileZoom:s.tileZoom,zoom:s.tileID.overscaledZ,maxZoom:this.maxzoom,lut:E,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:o.o.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:s.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:s.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor(),worldview:this.map.getWorldview()||this.worldviewDefault};if(this.hasWorldviews&&o.h(m)&&(k.localizableLayerIds=this.localizableLayerIds),k.request.collectResourceTiming=this._collectResourceTiming,s.actor&&s.state!=="expired")s.state==="loading"?s.reloadCallback=d:s.request=s.actor.send("reloadTile",k,O.bind(this));else if(s.actor=this._tileWorkers[v]=this._tileWorkers[v]||this.dispatcher.getActor(),this.dispatcher.ready)s.request=s.actor.send("loadTile",k,O.bind(this),void 0,!0);else{const z=o.aL.call({deduped:this._deduped},k,(U,F)=>{U||!F?O.call(this,U):(k.data={cacheControl:F.cacheControl,expires:F.expires,rawData:F.rawData.slice(0)},s.actor&&s.actor.send("loadTile",k,O.bind(this),void 0,!0))},!0);s.request={cancel:z}}function O(z,U){return delete s.request,s.aborted?d(null):z&&z.status!==404?d(z):(U&&U.resourceTiming&&(s.resourceTiming=U.resourceTiming),this.map._refreshExpiredTiles&&U&&s.setExpiryData(U),s.loadVectorData(U,this.map.painter),o.aM(this.dispatcher),d(null),void(s.reloadCallback&&(this.loadTile(s,s.reloadCallback),s.reloadCallback=null)))}}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(s,d){s.actor&&s.actor.send("removeTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope}),s.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Zs extends o.E{constructor(s,d,m,v){super(),this.id=s,this.dispatcher=m,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=Object.assign({type:"raster"},d),Object.assign(this,o.aH(d,["url","scheme","tileSize"]))}load(s){this._loaded=!1,this.fire(new o.z("dataloading",{dataType:"source"}));const d=this.map.getWorldview();this._tileJSONRequest=Ts(this._options,this.map._requestManager,null,d,(m,v)=>{this._tileJSONRequest=null,this._loaded=!0,m?this.fire(new o.y(m)):v&&(Object.assign(this,v),v.raster_layers&&(this.rasterLayers=v.raster_layers,this.rasterLayerIds=this.rasterLayers.map(b=>b.id)),this.tileBounds=Ya.fromTileJSON(v),Di(v.tiles),this.fire(new o.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.z("data",{dataType:"source",sourceDataType:"content"}))),s&&s(m)})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest();const s=o.B(this.id,this.scope);this.load(()=>this.map.style.clearSource(s))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(s){this.cancelTileJSONRequest()}serialize(){return Object.assign({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s,d){const m=o.o.devicePixelRatio>=2,v=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),m,this.tileSize);s.request=o.n(this.map._requestManager.transformRequest(v,o.R.Tile),(b,S,E,k)=>(delete s.request,s.aborted?(s.state="unloaded",d(null)):b?(s.state="errored",d(b)):S?(this.map._refreshExpiredTiles&&s.setExpiryData({cacheControl:E,expires:k}),s.setTexture(S,this.map.painter),s.state="loaded",o.aM(this.dispatcher),void d(null)):d(null)))}abortTile(s,d){s.request&&(s.request.cancel(),delete s.request),d&&d()}unloadTile(s,d){s.texture&&s.texture instanceof o.T?(s.destroy(!0),s.texture&&s.texture instanceof o.T&&this.map.painter.saveTileTexture(s.texture)):s.destroy(),d&&d()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function pc([g,s],d,m,{scaled:v=!0}={}){const{tileSize:b,buffer:S}=m,{x:E,y:k,z:O}=d;if(!isFinite(E)||!isFinite(k)||!isFinite(O))throw new Error("Invalid MRT header");const z=2**O,U=z*o.aF(g),F=z*o.aJ(s);return function([H,G],W,{scaled:ne=!0}={}){if(!W)throw new Error("bandView is undefined");const{data:X,tileSize:re,buffer:he,offset:pe,scale:Ie,dimension:Se}=W;if(H<-he||H>re+he||G<-he||G>re+he)throw new Error(`Point (${H}, ${G}) out of bounds for tileSize=${re}, buffer=${he}`);const Ae=(G+he)*(re+2*he)+(H+he);if(new Uint32Array(X.buffer)[Ae]===4294967295)return null;let Ce=[];Ce=ne?[]:new W.data.constructor(Se);for(let we=0;we<Se;we++)Ce[we]=Math.round(1e12*(X[Se*Ae+we]*Ie+pe))/1e12;return Ce}([Math.min(Math.max(-S,Math.floor((U-E)*b)),b-1+S),Math.min(Math.max(-S,Math.floor((F-k)*b)),b-1+S)],m,{scaled:v})}class fa extends Zs{constructor(s,d,m,v){super(s,d,m,v),this.type="raster-array",this.maxzoom=22,this.partial=!0,this._loadTilePending={},this._loadTileLoaded={},this._options=Object.assign({type:"raster-array"},d)}triggerRepaint(s){const d=this.map.painter._terrain,m=this.map.style.getSourceCache(this.id);d&&d.enabled&&m&&d._clearRenderCacheForTile(m.id,s.tileID),this.map.triggerRepaint()}loadTile(s,d){const m=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),v=this.map._requestManager.transformRequest(m,o.R.Tile),b={request:v,uid:s.uid,tileID:s.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};s.source=this.id,s.scope=this.scope,s.requestParams=v,s.actor||(s.actor=this.dispatcher.getActor());const S=(E,k,O,z)=>{if(delete s.request,s.aborted)return s.state="unloaded",d(null);if(E)return E.name==="AbortError"?void 0:(s.state="errored",d(E));if(this.map._refreshExpiredTiles&&k&&s.setExpiryData({cacheControl:O,expires:z}),this.partial&&s.state!=="expired")s.state="empty";else if(!this.partial){if(!k)return d(null);s.state="loaded",s._isHeaderLoaded=!0,s._mrt=k}d(null)};s.request=this.partial?s.fetchHeader(void 0,S.bind(this)):s.actor.send("loadTile",b,S.bind(this),void 0,!0)}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(s,d){const m=s.texturePerLayer;if(s.flushAllQueues(),m.size){s.destroy(!0);for(const v of m.values())this.map.painter.saveTileTexture(v)}else s.destroy()}prepareTile(s,d,m,v){s._isHeaderLoaded&&(s.state!=="empty"&&(s.state="reloading"),s.fetchBandForRender(d,m,v,(b,S)=>{if(b)return s.state="errored",this.fire(new o.y(b)),void this.triggerRepaint(s);S&&(s._isHeaderLoaded=!0,s.setTexturePerLayer(m,S,this.map.painter),s.state="loaded",this.triggerRepaint(s))}))}getInitialBand(s){if(!this.rasterLayers)return 0;const d=this.rasterLayers.find(({id:b})=>b===s),m=d&&d.fields,v=m&&m.bands&&m.bands;return v?v[0]:0}getTextureDescriptor(s,d,m){if(!s)return;const v=d.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!v)return;let b=null;d instanceof o.aP?b=d.paint.get("raster-array-band"):d instanceof o.aQ&&(b=d.paint.get("raster-particle-array-band"));const S=b||this.getInitialBand(v);if(S==null)return;if(!s.textureDescriptorPerLayer.get(d.id))return void this.prepareTile(s,v,d.id,S);if(s.updateNeeded(d.id,S)&&!m)return;const E=s.textureDescriptorPerLayer.get(d.id);return Object.assign({},E,{texture:s.texturePerLayer.get(d.id)})}getImages(s,d){const m=new Map;for(const v of s)for(const b of d){const[S,E]=b.split("/"),k=v.getLayer(S);if(!k||!k.hasBand(E)||!k.hasDataForBand(E))continue;const{bytes:O,tileSize:z,buffer:U}=k.getBandView(E),F=z+2*U,H={data:new o.q({width:F,height:F},O),pixelRatio:2,sdf:!1,usvg:!1,version:0};m.set(b,H)}return m}queryRasterArrayValueByBandId(s,d,m){const v=d._mrt;return new Promise(b=>{const S={},E=new Set;for(const[k,O]of Object.entries(v.layers)){if(m.layerName&&k!==m.layerName)continue;const z={};S[k]=z;for(const{bands:U}of O.dataIndex)for(const F of U)m.bands&&!m.bands.includes(F)||(E.add(o.B(k,F)),d.fetchBand(k,null,F,H=>{o.o.frame(()=>{z[F]=H?null:pc([s.lng,s.lat],v,O.getBandView(F)),E.delete(o.B(k,F)),E.size===0&&b(S)})},!1))}E.size===0&&b(S)})}_loadTileForQuery(s,d){if(this._loadTileLoaded[s.uid])return void d(null,s._mrt);if(this._loadTilePending[s.uid])return void this._loadTilePending[s.uid].push(d);this._loadTilePending[s.uid]=[d];const m=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),v=this.map._requestManager.transformRequest(m,o.R.Tile);s.actor.send("loadTile",{request:v,uid:s.uid,tileID:s.tileID,type:this.type,source:this.id,scope:this.scope,partial:!1},(b,S,E,k)=>b?(this._loadTilePending[s.uid].forEach(O=>O(b,null)),void delete this._loadTilePending[s.uid]):S?(this.map._refreshExpiredTiles&&S&&s.setExpiryData({cacheControl:E,expires:k}),s._mrt=S,s._isHeaderLoaded=!0,s.state="loaded",this._loadTilePending[s.uid].forEach(O=>O(null,S)),this._loadTileLoaded[s.uid]=!0,void delete this._loadTilePending[s.uid]):(this._loadTilePending[s.uid].forEach(O=>O(null,null)),void delete this._loadTilePending[s.uid]),void 0,!0)}queryRasterArrayValueByAllBands(s,d,m){return new Promise((v,b)=>{this._loadTileForQuery(d,(S,E)=>{S?b(S):v(E?this.queryRasterArrayValueByBandId(s,d,m):null)})})}queryRasterArrayValue(s,d){const m=o.aR.convert(s),v=this.findLoadedParent(m);return v&&v._mrt?d.bands||!this.partial?this.queryRasterArrayValueByBandId(m,v,d):this.queryRasterArrayValueByAllBands(m,v,d):Promise.resolve(null)}findLoadedParent(s){const d=o.ae.fromLngLat(s,this.map.transform.tileSize),m=this.maxzoom+1,v=1<<m,b=Math.floor(d.x),S=Math.floor((d.x-b)*v),E=Math.floor(d.y*v),k=this.map.style.getSourceCache(this.id),O=new o.aO(m,b,m,S,E);return k.findLoadedParent(O,this.minzoom)}}const xl={vector:ko,raster:Zs,"raster-dem":class extends Zs{constructor(g,s,d,m){super(g,s,d,m),this.type="raster-dem",this.maxzoom=22,this._options=Object.assign({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox"}loadTile(g,s){const d=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function m(v,b){v&&(g.state="errored",s(v)),b&&(g.dem=b,g.dem.onDeserialize(),g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0,g.state="loaded",s(null))}g.request=o.n(this.map._requestManager.transformRequest(d,o.R.Tile),(function(v,b,S,E){if(delete g.request,g.aborted)g.state="unloaded",s(null);else if(v)g.state="errored",s(v);else if(b){this.map._refreshExpiredTiles&&g.setExpiryData({cacheControl:S,expires:E});const k=ImageBitmap&&b instanceof ImageBitmap&&o.r(),O=1-(b.width-o.aN(b.width))/2;O<1||g.neighboringTiles||(g.neighboringTiles=this._getNeighboringTiles(g.tileID));const z=k?b:o.o.getImageData(b,O),U={uid:g.uid,tileID:g.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:z,encoding:this.encoding,padding:O};g.actor&&g.state!=="expired"||(g.actor=this.dispatcher.getActor(),g.actor.send("loadTile",U,m.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(g){const s=g.canonical,d=Math.pow(2,s.z),m=(s.x-1+d)%d,v=s.x===0?g.wrap-1:g.wrap,b=(s.x+1+d)%d,S=s.x+1===d?g.wrap+1:g.wrap,E={};return E[new o.aO(g.overscaledZ,v,s.z,m,s.y).key]={backfilled:!1},E[new o.aO(g.overscaledZ,S,s.z,b,s.y).key]={backfilled:!1},s.y>0&&(E[new o.aO(g.overscaledZ,v,s.z,m,s.y-1).key]={backfilled:!1},E[new o.aO(g.overscaledZ,g.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},E[new o.aO(g.overscaledZ,S,s.z,b,s.y-1).key]={backfilled:!1}),s.y+1<d&&(E[new o.aO(g.overscaledZ,v,s.z,m,s.y+1).key]={backfilled:!1},E[new o.aO(g.overscaledZ,g.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},E[new o.aO(g.overscaledZ,S,s.z,b,s.y+1).key]={backfilled:!1}),E}},"raster-array":fa,geojson:class extends o.E{constructor(g,s,d,m){super(),this.id=g,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=d.getActor(),this.setEventedParent(m),this._data=s.data,this._options=Object.assign({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.minzoom!==void 0&&(this.minzoom=s.minzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const v=o.al/this.tileSize;this.workerOptions=Object.assign({source:this.id,scope:this.scope,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*v,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*v,extent:o.al,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:o.al,radius:(s.clusterRadius!==void 0?s.clusterRadius:50)*v,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter,dynamic:s.dynamic},s.workerOptions)}onAdd(g){this.map=g,this.setData(this._data)}setData(g){return this._data=g,this._updateWorkerData(),this}updateData(g){if(!this._options.dynamic)return this.fire(new o.y(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof g!="string"&&(g.type==="Feature"&&(g={type:"FeatureCollection",features:[g]}),g.type!=="FeatureCollection"))return this.fire(new o.y(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof g!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const s=new Map;for(const d of this._data.features)s.set(d.id,d);for(const d of g.features)s.set(d.id,d);this._data.features=[...s.values()]}else this._data=g;return this._updateWorkerData(!0),this}getClusterExpansionZoom(g,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:g,source:this.id,scope:this.scope},s),this}getClusterChildren(g,s){return this.actor.send("geojson.getClusterChildren",{clusterId:g,source:this.id,scope:this.scope},s),this}getClusterLeaves(g,s,d,m){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:g,limit:s,offset:d},m),this}_updateWorkerData(g=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new o.z("dataloading",{dataType:"source"})),this._loaded=!1;const s=Object.assign({append:g},this.workerOptions);s.scope=this.scope;const d=this._data;typeof d=="string"?(s.request=this.map._requestManager.transformRequest(o.o.resolveURL(d),o.R.Source),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(d),this._pendingLoad=this.actor.send(`${this.type}.loadData`,s,(m,v)=>{if(this._loaded=!0,this._pendingLoad=null,m)this.fire(new o.y(m));else{const b={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&v&&v.resourceTiming&&v.resourceTiming[this.id]&&(b.resourceTiming=v.resourceTiming[this.id]),g&&(this._partialReload=!0),this.fire(new o.z("data",b)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(g),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const g=o.B(this.id,this.scope);this.map.style.clearSource(g),this._updateWorkerData()}loadTile(g,s){const d=g.actor?"reloadTile":"loadTile";g.actor=this.actor;const m=this.map.style?this.map.style.getLut(this.scope):null,v=m?{image:m.image.clone()}:null,b=this._partialReload,S={type:this.type,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:v,scope:this.scope,pixelRatio:o.o.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:g.isExtraShadowCaster,scaleFactor:this.map.getScaleFactor(),partial:b,worldview:this.map.getWorldview()};g.request=this.actor.send(d,S,(E,k)=>b&&!k?(g.state="loaded",s(null)):(delete g.request,g.destroy(),g.aborted?s(null):E?s(E):(g.loadVectorData(k,this.map.painter,d==="reloadTile"),s(null))),void 0,d==="loadTile")}abortTile(g){g.request&&(g.request.cancel(),delete g.request),g.aborted=!0}unloadTile(g,s){this.actor.send("removeTile",{uid:g.uid,type:this.type,source:this.id,scope:this.scope}),g.destroy()}onRemove(g){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return Object.assign({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends o.aS{constructor(g,s,d,m){super(g,s,d,m),this.roundZoom=!0,this.type="video",this.options=s}load(){this._loaded=!1;const g=this.options;this.urls=[];for(const s of g.urls)this.urls.push(this.map._requestManager.transformRequest(s,o.R.Source).url);o.aT(this.urls,(s,d)=>{this._loaded=!0,s?this.fire(new o.y(s)):d&&(this.video=d,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(g){if(this.video){const s=this.video.seekable;g<s.start(0)||g>s.end(0)?this.fire(new o.y(new o.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=g}}getVideo(){return this.video}onAdd(g){this.map||(this.map=g,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const g=this.map.painter.context,s=g.gl;this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new o.T(g,this.video,s.RGBA8),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(g)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:o.aS,model:class extends o.E{constructor(g,s,d,m){super(),this.id=g,this.type="model",this.models=[],this._loaded=!1,this._options=s}load(){const g=[];for(const s in this._options.models){const d=this._options.models[s],m=o.aV(this.map._requestManager.transformRequest(d.uri,o.R.Model).url).then(v=>{if(!v)return;const b=o.aW(v),S=new o.aX(s,d.position,d.orientation,b);S.computeBoundsAndApplyParent(),this.models.push(S)}).catch(v=>{this.fire(new o.y(new Error(`Could not load model ${s} from ${d.uri}: ${v.message}`)))});g.push(m)}Promise.allSettled(g).then(()=>{this._loaded=!0,this.fire(new o.z("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(s=>{this._loaded=!0,this.fire(new o.y(new Error(`Could not load models: ${s.message}`)))})}onAdd(g){this.map=g,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(g,s){}serialize(){return this._options}},"batched-model":class extends o.E{constructor(g,s,d,m){super(),this.type="batched-model",this.id=g,this.tileSize=512,this._options=s,this.tiles=this._options.tiles,this.maxzoom=s.maxzoom||19,this.minzoom=s.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=d,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(m)}onAdd(g){this.map=g,this.load()}reload(){this.cancelTileJSONRequest();const g=o.B(this.id,this.scope);this.load(()=>this.map.style.clearSource(g))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(g){this._loaded=!1,this.fire(new o.z("dataloading",{dataType:"source"}));const s=Array.isArray(this.map._language)?this.map._language.join():this.map._language,d=this.map.getWorldview();this._tileJSONRequest=Ts(this._options,this.map._requestManager,s,d,(m,v)=>{this._tileJSONRequest=null,this._loaded=!0,m?(s&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${s}`),d&&d.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${d}`),this.fire(new o.y(m))):v&&(Object.assign(this,v),v.bounds&&(this.tileBounds=new Ya(v.bounds,this.minzoom,this.maxzoom)),Di(v.tiles,this.map._requestManager._customAccessToken),this.fire(new o.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.z("data",{dataType:"source",sourceDataType:"content"}))),g&&g(m)})}hasTransition(){return!1}hasTile(g){return!this.tileBounds||this.tileBounds.contains(g.canonical)}loaded(){return this._loaded}loadTile(g,s){const d=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme)),m={request:this.map._requestManager.transformRequest(d,o.R.Tile),data:void 0,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,tileSize:this.tileSize*g.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:g.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:o.o.devicePixelRatio,promoteId:this.promoteId};if(g.actor&&g.state!=="expired")if(g.state==="loading")g.reloadCallback=s;else{if(g.buckets){const b=Object.values(g.buckets);for(const S of b)S.dirty=!0;return void(g.state="loaded")}g.request=g.actor.send("reloadTile",m,v.bind(this))}else g.actor=this.dispatcher.getActor(),g.request=g.actor.send("loadTile",m,v.bind(this),void 0,!0);function v(b,S){return g.aborted?s(null):b&&b.status!==404?s(b):(this.map._refreshExpiredTiles&&S&&g.setExpiryData(S),g.loadModelData(S,this.map.painter),g.state="loaded",void s(null))}}serialize(){return Object.assign({},this._options)}},canvas:class extends o.aS{constructor(g,s,d,m){super(g,s,d,m),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(v=>!Array.isArray(v)||v.length!==2||v.some(b=>typeof b!="number"))||this.fire(new o.y(new o.V(`sources.${g}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.y(new o.V(`sources.${g}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new o.y(new o.V(`sources.${g}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new o.y(new o.V(`sources.${g}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.y(new o.V(`sources.${g}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.y(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(g){this.map=g,this.load(),this.canvas&&this.animate&&this.play()}onRemove(g){this.pause()}prepare(){let g=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,g=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,g=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context;this.texture?!g&&!this._playing||this.texture instanceof o.aU||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.T(s,this.canvas,s.gl.RGBA8,{premultiply:!0}),this._prepareData(s)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const g of[this.canvas.width,this.canvas.height])if(isNaN(g)||g<=0)return!0;return!1}},custom:class extends o.E{constructor(g,s,d,m){super(),this.id=g,this.type="custom",this._dataType="raster",this._dispatcher=d,this._implementation=s,this.setEventedParent(m),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new o.y(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new o.y(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ya(this._implementation.bounds,this.minzoom,this.maxzoom)),s.update=this._update.bind(this),s.clearTiles=this._clearTiles.bind(this),s.coveringTiles=this._coveringTiles.bind(this),Object.assign(this,o.aH(s,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return o.aH(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new o.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.z("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(g){this.map=g,this._loaded=!1,this.fire(new o.z("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(g),this.load()}onRemove(g){this._implementation.onRemove&&this._implementation.onRemove(g)}hasTile(g){if(this._implementation.hasTile){const{x:s,y:d,z:m}=g.canonical;return this._implementation.hasTile({x:s,y:d,z:m})}return!this.tileBounds||this.tileBounds.contains(g.canonical)}loadTile(g,s){const{x:d,y:m,z:v}=g.tileID.canonical,b=new AbortController;g.request=Promise.resolve(this._implementation.loadTile({x:d,y:m,z:v},{signal:b.signal})).then((function(S){return delete g.request,g.aborted?(g.state="unloaded",s(null)):S===void 0?(g.state="errored",s(null)):S===null?(this.loadTileData(g,{width:this.tileSize,height:this.tileSize,data:null}),g.state="loaded",s(null)):function(E){return E instanceof ImageData||E instanceof HTMLCanvasElement||E instanceof ImageBitmap||E instanceof HTMLImageElement}(S)?(this.loadTileData(g,S),g.state="loaded",void s(null)):(g.state="errored",s(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(S=>{S.name!=="AbortError"&&(g.state="errored",s(S))}),g.request.cancel=()=>b.abort()}loadTileData(g,s){g.setTexture(s,this.map.painter)}unloadTile(g,s){if(g.texture&&g.texture instanceof o.T?(g.destroy(!0),g.texture&&g.texture instanceof o.T&&this.map.painter.saveTileTexture(g.texture)):g.destroy(),this._implementation.unloadTile){const{x:d,y:m,z:v}=g.tileID.canonical;this._implementation.unloadTile({x:d,y:m,z:v})}s&&s()}abortTile(g,s){g.request&&g.request.cancel&&(g.request.cancel(),delete g.request),s&&s()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(g=>({x:g.canonical.x,y:g.canonical.y,z:g.canonical.z}))}_clearTiles(){const g=o.B(this.id,this.scope);this.map.style.clearSource(g)}_update(){this.fire(new o.z("data",{dataType:"source",sourceDataType:"content"}))}}},Xr=function(g,s,d,m){const v=new xl[s.type](g,s,d,m);if(v.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${v.id}`);return o.aY(["load","abort","unload","serialize","prepare"],v),v};function wl(g,s,d=""){return`${d}:${s.id||""}:${s.layer.id}:${function(m){if("layerId"in m)return`layer:${m.layerId}`;{const{featuresetId:v,importId:b}=m;return`featureset:${v}${b?`:import:${b}`:""}`}}(g.target)}`}function is(g,s,d,m=""){if(g.uniqueFeatureID){const v=wl(g,s,m);if(d.has(v))return!0;d.add(v)}return!1}function rs(g,s,d,m,v=!1){const b=s.sourceCache.transform,S=s.sourceCache.tilesIn(g,s.has3DLayers,v);S.sort(Tu);const E=[];for(const k of S){const O=k.tile.queryRenderedFeatures(s,k,d,m,b,v);Object.keys(O).length&&E.push({wrappedTileID:k.tile.tileID.wrapped().key,queryResults:O})}return E.length===0?{}:function(k){const O={},z={};for(const U of k){const F=U.queryResults,H=U.wrappedTileID,G=z[H]=z[H]||{};for(const W in F){const ne=F[W],X=G[W]=G[W]||{},re=O[W]=O[W]||[];for(const he of ne)X[he.featureIndex]||(X[he.featureIndex]=!0,re.push(he))}}return O}(E)}function Sl(g,s,d,m,v,b){const S={},E=m.queryRenderedSymbols(g),k=[];for(const O of Object.keys(E).map(Number))k.push(v[O]);k.sort(Tu);for(const O of k){const z=O.featureIndex.lookupSymbolFeatures(E[O.bucketInstanceId],O.bucketIndex,O.sourceLayerIndex,s,d,b);for(const U in z){const F=S[U]=S[U]||[],H=z[U];H.sort((G,W)=>{const ne=O.featureSortOrder;if(ne){const X=ne.indexOf(G.featureIndex);return ne.indexOf(W.featureIndex)-X}return W.featureIndex-G.featureIndex});for(const G of H)F.push(G)}}return S}function Ko(g,s){const d=g.getRenderableIds().map(b=>g.getTileByID(b)),m=[],v={};for(let b=0;b<d.length;b++){const S=d[b],E=S.tileID.canonical.key;v[E]||(v[E]=!0,S.querySourceFeatures(m,s))}return m}function Tu(g,s){const d=g.tileID,m=s.tileID;return d.overscaledZ-m.overscaledZ||d.canonical.y-m.canonical.y||d.wrap-m.wrap||d.canonical.x-m.canonical.x}function jc(g,s){const d={};if(!s)return d;for(const m of g){const v=m.layerIds.map(b=>s.getLayer(b)).filter(Boolean);if(v.length!==0){m.layers=v,m.stateDependentLayerIds&&(m.stateDependentLayers=m.stateDependentLayerIds.map(b=>v.filter(S=>S.id===b)[0]));for(const b of v)d[b.fqid]=m}}return d}const Xo=32,Ns=33,Ks=new Uint16Array(8184);for(let g=0;g<2046;g++){let s=g+2,d=0,m=0,v=0,b=0,S=0,E=0;for(1&s?v=b=S=Xo:d=m=E=Xo;(s>>=1)>1;){const O=d+v>>1,z=m+b>>1;1&s?(v=d,b=m,d=S,m=E):(d=v,m=b,v=S,b=E),S=O,E=z}const k=4*g;Ks[k+0]=d,Ks[k+1]=m,Ks[k+2]=v,Ks[k+3]=b}const Yo=new Uint16Array(2178),vs=new Uint8Array(1089),Cl=new Uint16Array(1089);function Tl(g){return g===0?-.03125:g===32?.03125:0}const Zl={type:2,extent:o.al,loadGeometry:()=>[[new o.P(0,0),new o.P(o.al+1,0),new o.P(o.al+1,o.al+1),new o.P(0,o.al+1),new o.P(0,0)]]};class Ja{constructor(s,d,m,v,b,S){this.tileID=s,this.uid=o.b2(),this.uses=0,this.tileSize=d,this.tileZoom=m,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=b,v&&v.style&&(this._lastUpdatedBrightness=v.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",v&&v.transform&&(this.projection=v.transform.projection),this.worldview=S}registerFadeDuration(s){const d=s+this.timeAdded;d<o.o.now()||this.fadeEndTime&&d<this.fadeEndTime||(this.fadeEndTime=d)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=o.aZ(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(s,d,m){if(this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=jc(s.buckets,d.style),this.hasSymbolBuckets=!1;for(const v in this.buckets){const b=this.buckets[v];if(b instanceof o.b4){if(this.hasSymbolBuckets=!0,!m)break;b.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const v in this.buckets){const b=this.buckets[v];if(b instanceof o.b4&&b.hasRTLText){this.hasRTLText=!0,o.b5();break}}this.queryPadding=0;for(const v in this.buckets){const b=this.buckets[v],S=d.style.getOwnLayer(v);if(!S)continue;const E=S.queryRadius(b);this.queryPadding=Math.max(this.queryPadding,E)}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage),s.lineAtlas&&(this.lineAtlas=s.lineAtlas),this._lastUpdatedBrightness=s.brightness}else this.collisionBoxArray=new o.b3}unloadVectorData(){if(this.hasData()){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(s,d,m){s&&(s.resourceTiming&&(this.resourceTiming=s.resourceTiming),this.buckets=Object.assign({},this.buckets,jc(s.buckets,d.style)),s.featureIndex&&(this.latestFeatureIndex=s.featureIndex))}getBucket(s){return this.buckets[s.fqid]}upload(s){for(const v in this.buckets){const b=this.buckets[v];b.uploadPending()&&b.upload(s)}const d=s.gl,m=this.imageAtlas;m&&!m.uploaded&&(this.imageAtlasTexture=new o.T(s,m.image,d.RGBA8,{useMipmap:!!m.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new o.T(s,this.glyphAtlasImage,d.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new o.T(s,this.lineAtlas.image,d.R8),this.lineAtlas.uploaded=!0)}prepare(s,d,m){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture,m),!d||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const v=d.style.getBrightness();(this._lastUpdatedBrightness||v)&&(this._lastUpdatedBrightness&&v&&Math.abs(this._lastUpdatedBrightness-v)<.001||(this.updateBuckets(d,this._lastUpdatedBrightness!==v),this._lastUpdatedBrightness=v))}queryRenderedFeatures(s,d,m,v,b,S){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const E=function(k,O){const z=o.bq([],[.5*k.width,.5*-k.height,1]);return o.br(z,z,[1,-1,0]),o.aB(z,z,k.calculateProjMatrix(O.toUnwrapped())),Float32Array.from(z)}(b,this.tileID);return this.latestFeatureIndex.query(s,{tilespaceGeometry:d,pixelPosMatrix:E,transform:v,availableImages:m,tileTransform:this.tileTransform,worldview:this.worldview})}querySourceFeatures(s,d){const m=this.latestFeatureIndex;if(!m||!m.rawTileData)return;const v=m.loadVTLayers(),b=d?d.sourceLayer:"",S=v._geojsonTileLayer||v[b];if(!S)return;const E=o.b6(d&&d.filter),{z:k,x:O,y:z}=this.tileID.canonical,U={z:k,x:O,y:z};for(let F=0;F<S.length;F++){const H=S.feature(F);if(E.needGeometry){const ne=o.b7(H,!0);if(!E.filter(new o.ac(this.tileID.overscaledZ,{worldview:this.worldview}),ne,this.tileID.canonical))continue}else if(!E.filter(new o.ac(this.tileID.overscaledZ,{worldview:this.worldview}),H))continue;const G=m.getId(H,b),W=new o.b8(H,k,O,z,G);W.tile=U,s.push(W)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(s){const d=this.expirationTime;if(s.cacheControl){const m=o.b9(s.cacheControl);m["max-age"]&&(this.expirationTime=Date.now()+1e3*m["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const m=Date.now();let v=!1;if(this.expirationTime>m)v=!1;else if(d)if(this.expirationTime<d)v=!0;else{const b=this.expirationTime-d;b?this.expirationTime=m+Math.max(b,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(s){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&s&&this.updateBuckets(s)}updateBuckets(s,d){if(!this.latestFeatureIndex||!s.style)return;const m=this.latestFeatureIndex.loadVTLayers(),v=s.style.listImages(),b=s.style.getBrightness();for(const S in this.buckets){if(!s.style.hasLayer(S))continue;const E=this.buckets[S],k=E.layers[0],O=k.sourceLayer||"_geojsonTileLayer",z=m[O],U=s.style.getLayerSourceCache(k);let F={};U&&(F=U._state.getState(O,void 0));const H=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},G=Object.keys(F).length>0&&!d;(G&&E.stateDependentLayers.length!==0||d)&&E.update(F,z,v,H,G?E.stateDependentLayers:E.layers,d,b),(E instanceof o.ba||E instanceof o.bb)&&s._terrain&&s._terrain.enabled&&U&&E.uploadPending()&&s._terrain._clearRenderCacheForTile(U.id,this.tileID);const W=s&&s.style&&s.style.getOwnLayer(S);W&&(this.queryPadding=Math.max(this.queryPadding,W.queryRadius(E)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<o.o.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=o.o.now()+s}setTexture(s,d){const m=d.context,v=m.gl;this.texture=this.texture||d.getTileTexture(s.width),this.texture&&this.texture instanceof o.T?this.texture.update(s):(this.texture=new o.T(m,s,v.RGBA8,{useMipmap:!0}),this.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE))}setDependencies(s,d){const m={};for(const v of d)m[v]=!0;this.dependencies[s]=m}hasDependency(s,d){for(const m of s){const v=this.dependencies[m];if(v){for(const b of d)if(v[b])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(s,d){if(!d||d.name==="mercator"||this._tileDebugBuffer)return;const m=o.bc(Zl,this.tileID.canonical,this.tileTransform)[0],v=new o.bd,b=new o.be;for(let S=0;S<m.length;S++){const{x:E,y:k}=m[S];v.emplaceBack(E,k),b.emplaceBack(S)}b.emplaceBack(0),this._tileDebugIndexBuffer=s.createIndexBuffer(b),this._tileDebugBuffer=s.createVertexBuffer(v,o.bf.members),this._tileDebugSegments=o.bg.simpleSegment(0,0,v.length,b.length)}_makeTileBoundsBuffers(s,d){if(this._tileBoundsBuffer||!d||d.name==="mercator")return;const m=o.bc(Zl,this.tileID.canonical,this.tileTransform)[0];let v,b;if(this.isRaster){const S=function(E,k){const O=o.aZ(E,k),z=Math.pow(2,E.z);for(let ne=0;ne<Ns;ne++)for(let X=0;X<Ns;X++){const re=o.a_((E.x+(X+Tl(X))/Xo)/z),he=o.a$((E.y+(ne+Tl(ne))/Xo)/z),pe=k.project(re,he),Ie=ne*Ns+X;Yo[2*Ie+0]=Math.round((pe.x*O.scale-O.x)*o.al),Yo[2*Ie+1]=Math.round((pe.y*O.scale-O.y)*o.al)}vs.fill(0),Cl.fill(0);for(let ne=2045;ne>=0;ne--){const X=4*ne,re=Ks[X+0],he=Ks[X+1],pe=Ks[X+2],Ie=Ks[X+3],Se=re+pe>>1,Ae=he+Ie>>1,Ce=Se+Ae-he,we=Ae+re-Se,ke=he*Ns+re,nt=Ie*Ns+pe,Ke=Ae*Ns+Se,ht=Math.hypot((Yo[2*ke+0]+Yo[2*nt+0])/2-Yo[2*Ke+0],(Yo[2*ke+1]+Yo[2*nt+1])/2-Yo[2*Ke+1])>=16;vs[Ke]=vs[Ke]||(ht?1:0),ne<1022&&(vs[Ke]=vs[Ke]||vs[(he+we>>1)*Ns+(re+Ce>>1)]||vs[(Ie+we>>1)*Ns+(pe+Ce>>1)])}const U=new o.b0,F=new o.b1;let H=0;function G(ne,X){const re=X*Ns+ne;return Cl[re]===0&&(U.emplaceBack(Yo[2*re+0],Yo[2*re+1],ne*o.al/Xo,X*o.al/Xo),Cl[re]=++H),Cl[re]-1}function W(ne,X,re,he,pe,Ie){const Se=ne+re>>1,Ae=X+he>>1;if(Math.abs(ne-pe)+Math.abs(X-Ie)>1&&vs[Ae*Ns+Se])W(pe,Ie,ne,X,Se,Ae),W(re,he,pe,Ie,Se,Ae);else{const Ce=G(ne,X),we=G(re,he),ke=G(pe,Ie);F.emplaceBack(Ce,we,ke)}}return W(0,0,Xo,Xo,Xo,0),W(Xo,Xo,0,0,0,Xo),{vertices:U,indices:F}}(this.tileID.canonical,d);v=S.vertices,b=S.indices}else{v=new o.b0,b=new o.b1;for(const{x:E,y:k}of m)v.emplaceBack(E,k,0,0);const S=o.bh(v.int16.subarray(0,4*v.length),void 0,4);for(let E=0;E<S.length;E+=3)b.emplaceBack(S[E],S[E+1],S[E+2])}this._tileBoundsBuffer=s.createVertexBuffer(v,o.bi.members),this._tileBoundsIndexBuffer=s.createIndexBuffer(b),this._tileBoundsSegments=o.bg.simpleSegment(0,0,v.length,b.length)}_makeGlobeTileDebugBuffers(s,d){const m=d.projection;if(!m||m.name!=="globe"||d.freezeTileCoverage)return;const v=this.tileID.canonical,b=o.bj(v,d),S=o.bk(b),E=o.aj(d.zoom);let k;E>0&&(k=o.bl(new Float64Array(16),d.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(s,v,d,S,k,E),this._makeGlobeTileDebugTextBuffer(s,v,d,S,k,E)}_globePoint(s,d,m,v,b,S,E){let k=o.bm(s,d,m);if(S){const O=1<<m.z,z=o.aF(v.center.lng),U=o.aJ(v.center.lat),F=(m.x+.5)/O-z;let H=0;F>.5?H=-1:F<-.5&&(H=1);let G=(s/o.al+m.x)/O+H,W=(d/o.al+m.y)/O;G=(G-z)*v._pixelsPerMercatorPixel+z,W=(W-U)*v._pixelsPerMercatorPixel+U;const ne=[G*v.worldSize,W*v.worldSize,0];o.af(ne,ne,S),k=o.bn(k,ne,E)}return o.af(k,k,b)}_makeGlobeTileDebugBorderBuffer(s,d,m,v,b,S){const E=new o.bd,k=new o.be,O=new o.bo,z=(F,H,G,W,ne)=>{const X=(G-F)/(ne-1),re=(W-H)/(ne-1),he=E.length;for(let pe=0;pe<ne;pe++){const Ie=F+pe*X,Se=H+pe*re;E.emplaceBack(Ie,Se);const Ae=this._globePoint(Ie,Se,d,m,v,b,S);O.emplaceBack(Ae[0],Ae[1],Ae[2]),k.emplaceBack(he+pe)}},U=o.al;z(0,0,U,0,16),z(U,0,U,U,16),z(U,U,0,U,16),z(0,U,0,0,16),this._tileDebugIndexBuffer=s.createIndexBuffer(k),this._tileDebugBuffer=s.createVertexBuffer(E,o.bf.members),this._globeTileDebugBorderBuffer=s.createVertexBuffer(O,o.bp.members),this._tileDebugSegments=o.bg.simpleSegment(0,0,E.length,k.length)}_makeGlobeTileDebugTextBuffer(s,d,m,v,b,S){const E=o.al/4,k=new o.bd,O=new o.b1,z=new o.bo,U=25;O.reserve(32),k.reserve(U),z.reserve(U);const F=(H,G)=>U*H+G;for(let H=0;H<U;H++){const G=H*E;for(let W=0;W<U;W++){const ne=W*E;k.emplaceBack(ne,G);const X=this._globePoint(ne,G,d,m,v,b,S);z.emplaceBack(X[0],X[1],X[2])}}for(let H=0;H<4;H++)for(let G=0;G<4;G++){const W=F(H,G),ne=F(H,G+1),X=F(H+1,G),re=F(H+1,G+1);O.emplaceBack(W,ne,X),O.emplaceBack(X,ne,re)}this._tileDebugTextIndexBuffer=s.createIndexBuffer(O),this._tileDebugTextBuffer=s.createVertexBuffer(k,o.bf.members),this._globeTileDebugTextBuffer=s.createVertexBuffer(z,o.bp.members),this._tileDebugTextSegments=o.bg.simpleSegment(0,0,U,32)}destroy(s=!1){for(const d in this.buckets)this.buckets[d].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!s&&this.texture&&this.texture instanceof o.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}o.bs.setPbf(o.bt);class Es extends Ja{constructor(s,d,m,v,b){super(s,d,m,v,b),this._workQueuePerLayer=new Map,this._fetchQueuePerLayer=new Map,this._taskQueue=new Map,this._isHeaderLoaded=!1,this.textureDescriptorPerLayer=new Map,this.texturePerLayer=new Map}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(s){return this._mrt&&this._mrt.getLayer(s)}setTexturePerLayer(s,d,m){const v=m.context,b=v.gl;let S=this.texturePerLayer.get(s)||m.getTileTexture(d.width);S&&S instanceof o.T?S.update(d,{premultiply:!1}):S=new o.T(v,d,b.RGBA8,{premultiply:!1}),this.texturePerLayer.has(s)||this.texturePerLayer.set(s,S)}flushQueues(s){const d=this._workQueuePerLayer.get(s)||[],m=this._fetchQueuePerLayer.get(s)||[];for(;d.length;)d.pop()();for(;m.length;)m.pop()()}flushAllQueues(){for(const s of this._workQueuePerLayer.keys()){const d=this._workQueuePerLayer.get(s)||[];for(;d.length;)d.pop()()}for(const s of this._fetchQueuePerLayer.keys()){const d=this._fetchQueuePerLayer.get(s)||[];for(;d.length;)d.pop()()}}fetchHeader(s=16384,d){const m=this._mrt=new o.bs(30),v=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(s-1)}});return this.entireBuffer=null,this.request=o.bu(v,(b,S,E,k)=>{if(b)d(b);else try{const O=m.getHeaderLength(S);if(O>s)return void(this.request=this.fetchHeader(O,d));m.parseHeader(S),this._isHeaderLoaded=!0;let z=0;for(const U of Object.values(m.layers))z=Math.max(z,U.dataIndex[U.dataIndex.length-1].lastByte);S.byteLength>=z&&(this.entireBuffer=S),d(null,this.entireBuffer||S,E,k)}catch(O){d(O)}}),this.request}fetchBandForRender(s,d,m,v){this.fetchBand(s,d,m,b=>{if(b)return void v(b);this.updateTextureDescriptor(s,d,m);const S=this.textureDescriptorPerLayer.get(d);v(null,S?S.img:null)})}fetchBand(s,d,m,v,b=!0){const S=this._mrt;if(!this._isHeaderLoaded||!S)return void v(new Error("Tile header is not ready"));const E=this.actor;if(!E)return void v(new Error("Can't fetch tile band without an actor"));let k;const O=o.B(String(m),o.B(this.tileID.key,s));let z=this._taskQueue.get(O);z?z.add(v):(z=new Set,z.add(v),this._taskQueue.set(O,z));const U=(W,ne)=>{k.complete(W,ne),W?v(W):(z.values().forEach(X=>X(null,ne)),this._taskQueue.delete(O))},F=(W,ne)=>{if(W)return v(W);const X=E.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:ne,task:k},U,void 0,!0);if(d!==null){const re=this._workQueuePerLayer.get(d)||[];re.push(()=>{X&&X.cancel(),k.cancel()}),this._workQueuePerLayer.has(d)||this._workQueuePerLayer.set(d,re)}};let H;try{H=S.getLayer(s)}catch(W){if(this.state==="reloading")return;throw W}if(!H)return void v(new Error(`Unknown sourceLayer "${s}"`));if(H.hasDataForBand(m))return z.values().forEach(W=>W(null,null)),void this._taskQueue.delete(O);const G=H.getDataRange([m]);if(k=S.createDecodingTask(G),!k||k.tasks.length)if(d!==null&&this.flushQueues(d),this.entireBuffer)F(null,this.entireBuffer.slice(G.firstByte,G.lastByte+1));else{const W=Object.assign({},this.requestParams,{headers:{Range:`bytes=${G.firstByte}-${G.lastByte}`}}),ne=o.bu(W,F);if(d!==null){const X=this._fetchQueuePerLayer.get(d)||[];X.push(()=>{ne.cancel(),k.cancel()}),this._fetchQueuePerLayer.has(d)||this._fetchQueuePerLayer.set(d,X)}}}updateNeeded(s,d){return(!this.textureDescriptorPerLayer.get(s)||this.textureDescriptorPerLayer.get(s).band!==d||this.refreshedUponExpiration)&&this.state!=="errored"}updateTextureDescriptor(s,d,m){if(!this._mrt)return;const v=this._mrt.getLayer(s);if(!v||!v.hasBand(m)||!v.hasDataForBand(m))return;const{bytes:b,tileSize:S,buffer:E,offset:k,scale:O}=v.getBandView(m),z=S+2*E,U=new o.q({width:z,height:z},b),F=this.texturePerLayer.get(d);F&&F instanceof o.T&&F.update(U,{premultiply:!1}),this.textureDescriptorPerLayer.set(d,{layer:s,band:m,img:U,buffer:E,offset:k,tileSize:S,format:v.pixelFormat,mix:[O,256*O,65536*O,16777216*O]})}destroy(s=!1){if(super.destroy(s),delete this._mrt,!s)for(const d of this.texturePerLayer.values())d&&d instanceof o.T&&d.destroy();this.texturePerLayer.clear(),this.textureDescriptorPerLayer.clear(),this.fbo&&(this.fbo.destroy(),delete this.fbo),delete this.request,delete this.requestParams,this._isHeaderLoaded=!1}}class Eu{constructor(s,d){this.max=s,this.onRemove=d,this.reset()}reset(){for(const s in this.data)for(const d of this.data[s])d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value);return this.data={},this.order=[],this}add(s,d,m){const v=s.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);const b={value:d,timeout:void 0};if(m!==void 0&&(b.timeout=setTimeout(()=>{this.remove(s,b)},m)),this.data[v].push(b),this.order.push(v),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const d=this.data[s].shift();return d.timeout&&clearTimeout(d.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),d.value}getByKey(s){const d=this.data[s];return d?d[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,d){if(!this.has(s))return this;const m=s.wrapped().key,v=d===void 0?0:this.data[m].indexOf(d),b=this.data[m][v];return this.data[m].splice(v,1),b.timeout&&clearTimeout(b.timeout),this.data[m].length===0&&delete this.data[m],this.onRemove(b.value),this.order.splice(this.order.indexOf(m),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}filter(s){const d=[];for(const m in this.data)for(const v of this.data[m])s(v.value)||d.push(v);for(const m of d)this.remove(m.value.tileID,m)}}class pa{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,d,m){const v=String(d);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][v]=this.stateChanges[s][v]||{},Object.assign(this.stateChanges[s][v],m),this.deletedStates[s]===null){this.deletedStates[s]={};for(const b in this.state[s])b!==v&&(this.deletedStates[s][b]=null)}else if(this.deletedStates[s]&&this.deletedStates[s][v]===null){this.deletedStates[s][v]={};for(const b in this.state[s][v])m[b]||(this.deletedStates[s][v][b]=null)}else for(const b in m)this.deletedStates[s]&&this.deletedStates[s][v]&&this.deletedStates[s][v][b]===null&&delete this.deletedStates[s][v][b]}removeFeatureState(s,d,m){if(this.deletedStates[s]===null)return;const v=String(d);if(this.deletedStates[s]=this.deletedStates[s]||{},m&&d!==void 0)this.deletedStates[s][v]!==null&&(this.deletedStates[s][v]=this.deletedStates[s][v]||{},this.deletedStates[s][v][m]=null);else if(d!==void 0)if(this.stateChanges[s]&&this.stateChanges[s][v])for(m in this.deletedStates[s][v]={},this.stateChanges[s][v])this.deletedStates[s][v][m]=null;else this.deletedStates[s][v]=null;else this.deletedStates[s]=null}getState(s,d){const m=this.state[s]||{},v=this.stateChanges[s]||{},b=this.deletedStates[s];if(b===null)return{};if(d!==void 0){const E=String(d),k=Object.assign({},m[E],v[E]);if(b){const O=b[d];if(O===null)return{};for(const z in O)delete k[z]}return k}const S=Object.assign({},m,v);if(b)for(const E in b)delete S[E];return S}initializeTileState(s,d){s.refreshFeatureState(d)}coalesceChanges(s,d){const m={};for(const v in this.stateChanges){this.state[v]=this.state[v]||{};const b={};for(const S in this.stateChanges[v])this.state[v][S]||(this.state[v][S]={}),Object.assign(this.state[v][S],this.stateChanges[v][S]),b[S]=this.state[v][S];m[v]=b}for(const v in this.deletedStates){this.state[v]=this.state[v]||{};const b={};if(this.deletedStates[v]===null)for(const S in this.state[v])b[S]={},this.state[v][S]={};else for(const S in this.deletedStates[v]){if(this.deletedStates[v][S]===null)this.state[v][S]={};else if(this.state[v][S])for(const E of Object.keys(this.deletedStates[v][S]))delete this.state[v][S][E];b[S]=this.state[v][S]}m[v]=m[v]||{},Object.assign(m[v],b)}if(this.stateChanges={},this.deletedStates={},Object.keys(m).length!==0)for(const v in s)s[v].refreshFeatureState(d)}}class Xs extends o.E{constructor(s,d,m){super(),this.id=s,this._onlySymbols=m,d.on("data",v=>{v.dataType==="source"&&v.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&v.dataType==="source"&&v.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),d.on("error",()=>{this._sourceErrored=!0}),this._source=d,this._tiles={},this._cache=new Eu(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=d.minTileCacheSize,this._maxTileCacheSize=d.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new pa,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(s){this.map=s,this._minTileCacheSize=this._minTileCacheSize===void 0&&s?s._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&s?s._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const s in this._tiles)if(!this._tiles[s].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(s,d){return s.isSymbolTile=this._onlySymbols,s.isExtraShadowCaster=this._shadowCasterTiles[s.tileID.key],this._source.loadTile(s,d)}_unloadTile(s){if(this._source.unloadTile)return this._source.unloadTile(s)}_abortTile(s){if(this._source.abortTile)return this._source.abortTile(s)}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const d in this._tiles){const m=this._tiles[d];m.upload(s),m.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map(s=>s.tileID).sort(Na).map(s=>s.key)}getRenderableIds(s,d){const m=[];for(const v in this._tiles)this._isIdRenderable(+v,s,d)&&m.push(this._tiles[v]);return s?m.sort((v,b)=>{const S=v.tileID,E=b.tileID,k=new o.P(S.canonical.x,S.canonical.y)._rotate(this.transform.angle),O=new o.P(E.canonical.x,E.canonical.y)._rotate(this.transform.angle);return S.overscaledZ-E.overscaledZ||O.y-k.y||O.x-k.x}).map(v=>v.tileID.key):m.map(v=>v.tileID).sort(Na).map(v=>v.key)}hasRenderableParent(s){const d=this.findLoadedParent(s,0);return!!d&&this._isIdRenderable(d.tileID.key)}_isIdRenderable(s,d,m){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(d||!this._tiles[s].holdingForFade())&&(m||!this._shadowCasterTiles[s])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)this._tiles[s].state!=="errored"&&this._reloadTile(+s,"reloading")}}_reloadTile(s,d){const m=this._tiles[s];m&&(m.state!=="loading"&&(m.state=d),this._loadTile(m,this._tileLoaded.bind(this,m,s,d)))}_tileLoaded(s,d,m,v){if(v)if(s.state="errored",v.status!==404)this._source.fire(new o.y(v,{tile:s}));else{if(this._source.fire(new o.z("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:s})),!(s.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const b=this.map.painter.terrain;this.update(this.transform,b.getScaledDemTileSize(),!0),b.resetTileLookupCache(this.id)}else this.update(this.transform)}else s.timeAdded=o.o.now(),m==="expired"&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(d,s),this._source.type==="raster-dem"&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),this._source.fire(new o.z("data",{dataType:"source",tile:s,coord:s.tileID,sourceCacheId:this.id}))}_backfillDEM(s){const d=this.getRenderableIds();for(let v=0;v<d.length;v++){const b=d[v];if(s.neighboringTiles&&s.neighboringTiles[b]){const S=this.getTileByID(b);m(s,S),m(S,s)}}function m(v,b){if(!v.dem||v.dem.borderReady)return;v.needsHillshadePrepare=!0,v.needsDEMTextureUpload=!0;let S=b.tileID.canonical.x-v.tileID.canonical.x;const E=b.tileID.canonical.y-v.tileID.canonical.y,k=Math.pow(2,v.tileID.canonical.z),O=b.tileID.key;S===0&&E===0||Math.abs(E)>1||(Math.abs(S)>1&&(Math.abs(S+k)===1?S+=k:Math.abs(S-k)===1&&(S-=k)),b.dem&&v.dem&&(v.dem.backfillBorder(b.dem,S,E),v.neighboringTiles&&v.neighboringTiles[O]&&(v.neighboringTiles[O].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,d,m,v){for(const b in this._tiles){let S=this._tiles[b];if(v[b]||!S.hasData()||S.tileID.overscaledZ<=d||S.tileID.overscaledZ>m)continue;let E=S.tileID;for(;S&&S.tileID.overscaledZ>d+1;){const O=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[O.key],S&&S.hasData()&&(E=O)}let k=E;for(;k.overscaledZ>d;)if(k=k.scaledTo(k.overscaledZ-1),s[k.key]){v[E.key]=E;break}}}findLoadedParent(s,d){if(s.key in this._loadedParentTiles){const m=this._loadedParentTiles[s.key];return m&&m.tileID.overscaledZ>=d?m:null}for(let m=s.overscaledZ-1;m>=d;m--){const v=s.scaledTo(m),b=this._getLoadedTile(v);if(b)return b}}_getLoadedTile(s){const d=this._tiles[s.key];return d&&d.hasData()?d:this._cache.getByKey(this._source.reparseOverscaled?s.wrapped().key:s.canonical.key)}updateCacheSize(s,d){d=d||this._source.tileSize;const m=Math.ceil(s.width/d)+1,v=Math.ceil(s.height/d)+1,b=Math.floor(m*v*5),S=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,b):b,E=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,S):S;this._cache.setMaxSize(E)}handleWrapJump(s){const d=Math.round((s-(this._prevLng===void 0?s:this._prevLng))/360);if(this._prevLng=s,d){const m={};for(const v in this._tiles){const b=this._tiles[v];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+d),m[b.tileID.key]=b}this._tiles=m;for(const v in this._timers)clearTimeout(this._timers[v]),delete this._timers[v];for(const v in this._tiles)this._setTileReloadTimer(+v,this._tiles[v])}}update(s,d,m,v,b){if(this.transform=s,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!m)return;this.updateCacheSize(s,d),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const S=this._source.type==="batched-model";let E,k=this._source.maxzoom;const O=this.map&&this.map.painter?this.map.painter._terrain:null;if(O&&O.sourceCache===this&&O.attenuationRange()){const F=O.attenuationRange()[0],H=Math.floor(F)-Math.log2(O.getDemUpscale());k>H&&(k=H)}if(this.used||this.usedForTerrain){if(this._source.tileID)E=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(F=>new o.aO(F.canonical.z,F.wrap,F.canonical.z,F.canonical.x,F.canonical.y));else if(this.tileCoverLift!==0){const F=s.clone();F.tileCoverLift=this.tileCoverLift,E=F.coveringTiles({tileSize:d||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:k,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:S}),this._source.minzoom<=1&&s.projection.name==="globe"&&(E.push(new o.aO(1,0,1,0,0)),E.push(new o.aO(1,0,1,1,0)),E.push(new o.aO(1,0,1,0,1)),E.push(new o.aO(1,0,1,1,1)))}else if(E=s.coveringTiles({tileSize:d||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:k,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:S}),this._source.hasTile){const F=this._source.hasTile.bind(this._source);E=E.filter(H=>F(H))}}else E=[];if(E.length>0&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Kl(this._source.type)){const F=s.coveringZoomLevel({tileSize:d||this._source.tileSize,roundZoom:this._source.roundZoom&&!m}),H=Math.min(F,this._source.maxzoom);if(S){const G=s.extendTileCover(E,H);for(const W of G)E.push(W)}else if(b){const G=s.extendTileCoverToNearPlane(E,this.transform.getFrustum(H),H);for(const W of G)E.push(W)}else if(this.castsShadows&&v){const G=s.extendTileCover(E,H,v);for(const W of G)this._shadowCasterTiles[W.key]=!0,E.push(W)}}const z=this._updateRetainedTiles(E);if(Kl(this._source.type)&&E.length!==0){const F={},H={},G=Object.keys(z);for(const ne of G){const X=z[ne],re=this._tiles[ne];if(!re||re.fadeEndTime&&re.fadeEndTime<=o.o.now())continue;const he=this.findLoadedParent(X,Math.max(X.overscaledZ-Xs.maxOverzooming,this._source.minzoom));he&&(this._addTile(he.tileID),F[he.tileID.key]=he.tileID),H[ne]=X}const W=E[E.length-1].overscaledZ;for(const ne in this._tiles){const X=this._tiles[ne];if(z[ne]||!X.hasData())continue;let re=X.tileID;for(;re.overscaledZ>W;){re=re.scaledTo(re.overscaledZ-1);const he=this._tiles[re.key];if(he&&he.hasData()&&H[re.key]){z[ne]=X.tileID;break}}}for(const ne in F)z[ne]||(this._coveredTiles[ne]=!0,z[ne]=F[ne])}for(const F in z)this._tiles[F].clearFadeHold();const U=o.bv(this._tiles,z);for(const F of U){const H=this._tiles[F];H.hasSymbolBuckets&&!H.holdingForFade()?H.setHoldDuration(this.map._fadeDuration):H.hasSymbolBuckets&&!H.symbolFadeFinished()||this._removeTile(+F)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(+s)}_updateRetainedTiles(s){const d={};if(s.length===0)return d;const m={},v=s.reduce((O,z)=>Math.min(O,z.overscaledZ),1/0),b=s[0].overscaledZ,S=Math.max(b-Xs.maxOverzooming,this._source.minzoom),E=Math.max(b+Xs.maxUnderzooming,this._source.minzoom),k={};for(const O of s){const z=this._addTile(O);d[O.key]=O,z.hasData()||v<this._source.maxzoom&&(k[O.key]=O)}this._retainLoadedChildren(k,v,E,d);for(const O of s){let z=this._tiles[O.key];if(z.hasData())continue;if(O.canonical.z>=this._source.maxzoom){const F=O.children(this._source.maxzoom)[0],H=this.getTile(F);if(H&&H.hasData()){d[F.key]=F;continue}}else{const F=O.children(this._source.maxzoom);if(d[F[0].key]&&d[F[1].key]&&d[F[2].key]&&d[F[3].key])continue}let U=z.wasRequested();for(let F=O.overscaledZ-1;F>=S;--F){const H=O.scaledTo(F);if(m[H.key]||(m[H.key]=!0,z=this.getTile(H),!z&&U&&(z=this._addTile(H)),z&&(d[H.key]=H,U=z.wasRequested(),z.hasData())))break}}return d}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const d=[];let m,v=this._tiles[s].tileID;for(;v.overscaledZ>0;){if(v.key in this._loadedParentTiles){m=this._loadedParentTiles[v.key];break}d.push(v.key);const b=v.scaledTo(v.overscaledZ-1);if(m=this._getLoadedTile(b),m)break;v=b}for(const b of d)this._loadedParentTiles[b]=m}}_addTile(s){let d=this._tiles[s.key];if(d)return d.isExtraShadowCaster!==!0||this._shadowCasterTiles[s.key]||this._reloadTile(s.key,"reloading"),d;d=this._cache.getAndRemove(s),d&&(this._setTileReloadTimer(s.key,d),d.tileID=s,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,d)));const m=!!d;if(!m){const v=this.map?this.map.painter:null,b=this._source.tileSize*s.overscaleFactor();d=this._source.type==="raster-array"?new Es(s,b,this.transform.tileZoom,v,this._isRaster):new Ja(s,b,this.transform.tileZoom,v,this._isRaster,this._source.worldview),this._loadTile(d,this._tileLoaded.bind(this,d,s.key,d.state))}return d.uses++,this._tiles[s.key]=d,m||this._source.fire(new o.z("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d}_setTileReloadTimer(s,d){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const m=d.getExpiryTimeout();m&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},m))}_removeTile(s){const d=this._tiles[s];d&&(d.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),d.uses>0||(d.hasData()&&d.state!=="reloading"||d.state==="empty"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(+s);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(s,d,m){const v=[],b=this.transform;if(!b)return v;const S=b.projection.name==="globe",E=o.aF(b.center.lng);for(const k in this._tiles){const O=this._tiles[k];if(m&&O.clearQueryDebugViz(),O.holdingForFade())continue;let z;if(S){const U=O.tileID.canonical;if(U.z===0){const F=[Math.abs(o.aA(E,...Qa(U,-1))-E),Math.abs(o.aA(E,...Qa(U,1))-E)];z=[0,2*F.indexOf(Math.min(...F))-1]}else{const F=[Math.abs(o.aA(E,...Qa(U,-1))-E),Math.abs(o.aA(E,...Qa(U,0))-E),Math.abs(o.aA(E,...Qa(U,1))-E)];z=[F.indexOf(Math.min(...F))-1]}}else z=[0];for(const U of z){const F=s.containsTile(O,b,d,U);F&&v.push(F)}}return v}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(s){return this._getRenderableCoordinates(s)}_getRenderableCoordinates(s,d){const m=this.getRenderableIds(s,d).map(b=>this._tiles[b].tileID),v=this.transform.projection.name==="globe";for(const b of m)b.projMatrix=this.transform.calculateProjMatrix(b.toUnwrapped()),b.expandedProjMatrix=v?this.transform.calculateProjMatrix(b.toUnwrapped(),!1,!0):b.projMatrix;return m}sortCoordinatesByDistance(s){const d=s.slice(),m=this.transform._camera.position,v=this.transform._camera.forward(),b={};for(const S of d){const E=1/(1<<S.canonical.z);b[S.key]=((S.canonical.x+.5)*E+S.wrap-m[0])*v[0]+((S.canonical.y+.5)*E-m[1])*v[1]-m[2]*v[2]}return d.sort((S,E)=>b[S.key]-b[E.key]),d}hasTransition(){if(this._source.hasTransition())return!0;if(Kl(this._source.type))for(const s in this._tiles){const d=this._tiles[s];if(d.fadeEndTime!==void 0&&d.fadeEndTime>=o.o.now())return!0}return!1}setFeatureState(s,d,m){this._state.updateState(s=s||"_geojsonTileLayer",d,m)}removeFeatureState(s,d,m){this._state.removeFeatureState(s=s||"_geojsonTileLayer",d,m)}getFeatureState(s,d){return this._state.getState(s=s||"_geojsonTileLayer",d)}setDependencies(s,d,m){const v=this._tiles[s];v&&v.setDependencies(d,m)}reloadTilesForDependencies(s,d){for(const m in this._tiles)this._tiles[m].hasDependency(s,d)&&this._reloadTile(+m,"reloading");this._cache.filter(m=>!m.hasDependency(s,d))}_preloadTiles(s,d){if(!this._sourceLoaded){const k=()=>{this._sourceLoaded&&(this._source.off("data",k),this._preloadTiles(s,d))};return void this._source.on("data",k)}const m=new Map,v=Array.isArray(s)?s:[s],b=this.map.painter.terrain,S=this.usedForTerrain&&b?b.getScaledDemTileSize():this._source.tileSize;for(const k of v){const O=k.coveringTiles({tileSize:S,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const z of O)m.set(z.key,z);this.usedForTerrain&&k.updateElevation(!1)}const E=Array.from(m.values());o.bw(E,(k,O)=>{const z=new Ja(k,this._source.tileSize*k.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster,this._source.worldview);this._loadTile(z,U=>{this._source.type==="raster-dem"&&z.dem&&this._backfillDEM(z),O(U,z)})},d)}}function Na(g,s){const d=Math.abs(2*g.wrap)-+(g.wrap<0),m=Math.abs(2*s.wrap)-+(s.wrap<0);return g.overscaledZ-s.overscaledZ||m-d||s.canonical.y-g.canonical.y||s.canonical.x-g.canonical.x}function Kl(g){return g==="raster"||g==="image"||g==="video"||g==="custom"}function Qa(g,s){const d=1<<g.z;return[g.x/d+s,(g.x+1)/d+s]}Xs.maxOverzooming=10,Xs.maxUnderzooming=3;class Va{constructor(s){this.style=s,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const s=!1,d=!1;for(const m in this.style._mergedLayers){const v=this.style._mergedLayers[m];if(v.type==="fill-extrusion"||v.type==="building")this.layers.push({layer:v,visible:s,visibilityChanged:d});else if(v.type==="model"){const b=this.style.getLayerSource(v);b&&b.type==="batched-model"&&this.layers.push({layer:v,visible:s,visibilityChanged:d})}}}onNewFrame(s){this.layersGotHidden=!1;for(const d of this.layers){const m=d.layer;let v=!1;m.type==="fill-extrusion"?v=!m.isHidden(s)&&m.paint.get("fill-extrusion-opacity")>0:m.type==="building"?v=!m.isHidden(s)&&m.paint.get("building-opacity")>0:m.type==="model"&&(v=!m.isHidden(s)&&m.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!v&&d.visible,d.visible=v}}updateZOffset(s,d){this.currentBuildingBuckets=[];for(const v of this.layers){const b=v.layer,S=this.style.getLayerSourceCache(b);let E=1;b.type==="fill-extrusion"?E=v.visible?b.paint.get("fill-extrusion-vertical-scale"):0:b.type==="building"&&(E=v.visible?b.paint.get("building-vertical-scale"):0);let k=S?S.getTile(d):null;if(!k&&S)for(const O in S._tiles){const z=S._tiles[O];if(d.canonical.isChildOf(z.tileID.canonical)){k=z;break}}this.currentBuildingBuckets.push({bucket:k?k.getBucket(b):null,tileID:k?k.tileID:d,verticalScale:E})}s.hasAnyZOffset=!1;let m=!1;for(let v=0;v<s.symbolInstances.length;v++){const b=s.symbolInstances.get(v),S=b.zOffset,E=this._getHeightAtTileOffset(d,b.tileAnchorX,b.tileAnchorY);b.zOffset=E!==Number.NEGATIVE_INFINITY?E:S,m||S===b.zOffset||(m=!0),s.hasAnyZOffset||b.zOffset===0||(s.hasAnyZOffset=!0)}m&&(s.zOffsetBuffersNeedUpload=!0,s.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(s,d,m,v){let b=d,S=m;if(s.canonical.z!==v.canonical.z){const E=v.canonical,k=1/(1<<s.canonical.z-E.z);b=(d+s.canonical.x*o.al)*k-E.x*o.al|0,S=(m+s.canonical.y*o.al)*k-E.y*o.al|0}return{tileX:b,tileY:S}}_getHeightAtTileOffset(s,d,m){let v,b;for(let S=0;S<this.layers.length;++S){const E=this.layers[S].layer;if(E.type!=="fill-extrusion"&&E.type!=="building")continue;const{bucket:k,tileID:O,verticalScale:z}=this.currentBuildingBuckets[S];if(!k)continue;const{tileX:U,tileY:F}=this._mapCoordToOverlappingTile(s,d,m,O),H=k.getHeightAtTileCoord(U,F);H&&H.height!==void 0&&(H.hidden?v=H.height:b=Math.max(H.height*z,b||0))}if(b!==void 0)return b;for(let S=0;S<this.layers.length;++S){const E=this.layers[S];if(E.layer.type!=="model"||!E.visible)continue;const{bucket:k,tileID:O}=this.currentBuildingBuckets[S];if(!k)continue;const{tileX:z,tileY:U}=this._mapCoordToOverlappingTile(s,d,m,O),F=k.getHeightAtTileCoord(z,U);if(F&&!F.hidden)return F.height===void 0&&v!==void 0?Math.min(F.maxHeight,v)*F.verticalScale:F.height?F.height*F.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Iu(g,s){const d={};for(const m in g)m!=="ref"&&(d[m]=g[m]);return o.bx.forEach(m=>{m in s&&(d[m]=s[m])}),d}function El(g){g=g.slice();const s=Object.create(null);for(let d=0;d<g.length;d++)s[g[d].id]=g[d];for(let d=0;d<g.length;d++)"ref"in g[d]&&(g[d]=Iu(g[d],s[g[d].ref]));return g}const Ci={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport",addIconset:"addIconset",removeIconset:"removeIconset"};function Sa(g,s,d){d.push({command:Ci.addSource,args:[g,s[g]]})}function md(g,s,d){s.push({command:Ci.removeSource,args:[g]}),d[g]=!0}function $o(g,s,d,m){md(g,d,m),Sa(g,s,d)}function Uc(g,s,d){let m;for(m in g[d])if(g[d].hasOwnProperty(m)&&m!=="data"&&!o.by(g[d][m],s[d][m]))return!1;for(m in s[d])if(s[d].hasOwnProperty(m)&&m!=="data"&&!o.by(g[d][m],s[d][m]))return!1;return!0}function $a(g,s,d,m,v,b){let S;for(S in s=s||{},g=g||{})g.hasOwnProperty(S)&&(o.by(g[S],s[S])||d.push({command:b,args:[m,S,s[S],v]}));for(S in s)s.hasOwnProperty(S)&&!g.hasOwnProperty(S)&&(o.by(g[S],s[S])||d.push({command:b,args:[m,S,s[S],v]}))}function Il(g){return g.id}function Hc(g,s){return g[s.id]=s,g}function Xl(g,s,d){const m=s.createTileMatrix(g,g.worldSize,d.toUnwrapped());return o.aB(new Float32Array(16),g.projMatrix,m)}function Au(g,s,d){if(s.projection.name===d.projection.name)return g.projMatrix;const m=d.clone();return m.setProjection(s.projection),Xl(m,s.getProjection(),g)}function na(g,s,d){return s.name===d.projection.name?g.projMatrix:Xl(d,s,g)}class ku{constructor(s,d){this.reset(s,d)}reset(s,d){this.points=s||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(this.points.length===1)return this.points[0];s=o.aA(s,0,1);let d=1,m=this._distances[d];const v=s*this.paddedLength+this.padding;for(;m<v&&d<this._distances.length;)m=this._distances[++d];const b=d-1,S=this._distances[b],E=m-S,k=E>0?(v-S)/E:0;return this.points[b].mult(1-k).add(this.points[d].mult(k))}}class Ru{constructor(s,d,m){const v=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(s/m),this.yCellCount=Math.ceil(d/m);for(let S=0;S<this.xCellCount*this.yCellCount;S++)v.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=d,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,d,m,v,b){this._forEachCell(d,m,v,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(d),this.bboxes.push(m),this.bboxes.push(v),this.bboxes.push(b)}insertCircle(s,d,m,v){this._forEachCell(d-v,m-v,d+v,m+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(d),this.circles.push(m),this.circles.push(v)}_insertBoxCell(s,d,m,v,b,S){this.boxCells[b].push(S)}_insertCircleCell(s,d,m,v,b,S){this.circleCells[b].push(S)}_query(s,d,m,v,b,S){if(m<0||s>this.width||v<0||d>this.height)return!b&&[];const E=[];if(s<=0&&d<=0&&this.width<=m&&this.height<=v){if(b)return!0;for(let k=0;k<this.boxKeys.length;k++)E.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const O=this.circles[3*k],z=this.circles[3*k+1],U=this.circles[3*k+2];E.push({key:this.circleKeys[k],x1:O-U,y1:z-U,x2:O+U,y2:z+U})}return S?E.filter(S):E}return this._forEachCell(s,d,m,v,this._queryCell,E,{hitTest:b,seenUids:{box:{},circle:{}}},S),b?E.length>0:E}_queryCircle(s,d,m,v,b){const S=s-m,E=s+m,k=d-m,O=d+m;if(E<0||S>this.width||O<0||k>this.height)return!v&&[];const z=[];return this._forEachCell(S,k,E,O,this._queryCellCircle,z,{hitTest:v,circle:{x:s,y:d,radius:m},seenUids:{box:{},circle:{}}},b),v?z.length>0:z}query(s,d,m,v,b){return this._query(s,d,m,v,!1,b)}hitTest(s,d,m,v,b){return this._query(s,d,m,v,!0,b)}hitTestCircle(s,d,m,v){return this._queryCircle(s,d,m,!0,v)}_queryCell(s,d,m,v,b,S,E,k){const O=E.seenUids,z=this.boxCells[b];if(z!==null){const F=this.bboxes;for(const H of z)if(!O.box[H]){O.box[H]=!0;const G=4*H;if(s<=F[G+2]&&d<=F[G+3]&&m>=F[G+0]&&v>=F[G+1]&&(!k||k(this.boxKeys[H]))){if(E.hitTest)return S.push(!0),!0;S.push({key:this.boxKeys[H],x1:F[G],y1:F[G+1],x2:F[G+2],y2:F[G+3]})}}}const U=this.circleCells[b];if(U!==null){const F=this.circles;for(const H of U)if(!O.circle[H]){O.circle[H]=!0;const G=3*H;if(this._circleAndRectCollide(F[G],F[G+1],F[G+2],s,d,m,v)&&(!k||k(this.circleKeys[H]))){if(E.hitTest)return S.push(!0),!0;{const W=F[G],ne=F[G+1],X=F[G+2];S.push({key:this.circleKeys[H],x1:W-X,y1:ne-X,x2:W+X,y2:ne+X})}}}}}_queryCellCircle(s,d,m,v,b,S,E,k){const O=E.circle,z=E.seenUids,U=this.boxCells[b];if(U!==null){const H=this.bboxes;for(const G of U)if(!z.box[G]){z.box[G]=!0;const W=4*G;if(this._circleAndRectCollide(O.x,O.y,O.radius,H[W+0],H[W+1],H[W+2],H[W+3])&&(!k||k(this.boxKeys[G])))return S.push(!0),!0}}const F=this.circleCells[b];if(F!==null){const H=this.circles;for(const G of F)if(!z.circle[G]){z.circle[G]=!0;const W=3*G;if(this._circlesCollide(H[W],H[W+1],H[W+2],O.x,O.y,O.radius)&&(!k||k(this.circleKeys[G])))return S.push(!0),!0}}}_forEachCell(s,d,m,v,b,S,E,k){const O=this._convertToXCellCoord(s),z=this._convertToYCellCoord(d),U=this._convertToXCellCoord(m),F=this._convertToYCellCoord(v);for(let H=O;H<=U;H++)for(let G=z;G<=F;G++)if(b.call(this,s,d,m,v,this.xCellCount*G+H,S,E,k))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,d,m,v,b,S){const E=v-s,k=b-d,O=m+S;return O*O>E*E+k*k}_circleAndRectCollide(s,d,m,v,b,S,E){const k=(S-v)/2,O=Math.abs(s-(v+k));if(O>k+m)return!1;const z=(E-b)/2,U=Math.abs(d-(b+z));if(U>z+m)return!1;if(O<=k||U<=z)return!0;const F=O-k,H=U-z;return F*F+H*H<=m*m}}const Ca={unknown:0,flipRequired:1,flipNotRequired:2},Gc=Math.tan(85*Math.PI/180);function Vs(g,s,d,m,v,b,S){const E=o.bC();if(d)if(b.name==="globe"){const k=o.bD(v,s);o.aB(E,E,k)}else{const k=o.bE([],S);E[0]=k[0],E[1]=k[1],E[4]=k[2],E[5]=k[3],m||o.bB(E,E,v.angle)}else o.aB(E,v.labelPlaneMatrix,g);return E}function el(g,s,d,m,v,b,S){const E=Vs(g,s,d,m,v,b,S);return b.name==="globe"&&d||(E[2]=E[6]=E[10]=E[14]=0),E}function Wc(g,s,d,m,v,b,S){if(d){if(b.name==="globe"){const E=Vs(g,s,d,m,v,b,S);return o.bl(E,E),o.aB(E,g,E),E}{const E=o.bz(g),k=o.bA([]);return k[0]=S[0],k[1]=S[1],k[4]=S[2],k[5]=S[3],o.aB(E,E,k),m||o.bB(E,E,-v.angle),E}}return v.glCoordMatrix}function $s(g,s,d,m){const v=[g,s,d,1];d?o.aC(v,v,m):gd(v,v,m);const b=v[3];return v[0]/=b,v[1]/=b,v[2]/=b,v}function Ta(g,s){return Math.min(.5+g/s*.5,1.5)}function sa(g,s){const d=g[0]/g[3],m=g[1]/g[3];return d>=-s[0]&&d<=s[0]&&m>=-s[1]&&m<=s[1]}function Yl(g,s,d,m,v,b,S,E,k,O){const z=d.transform,U=m?g.textSizeData:g.iconSizeData,F=o.bK(U,d.transform.zoom),H=z.projection.name==="globe",G=[256/d.width*2+1,256/d.height*2+1],W=m?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;W.clear();let ne=null;H&&(ne=m?g.text.globeExtVertexArray:g.icon.globeExtVertexArray);const X=g.lineVertexArray,re=m?g.text.placedSymbolArray:g.icon.placedSymbolArray,he=d.transform.width/d.transform.height;let pe,Ie=!1;for(let Se=0;Se<re.length;Se++){const Ae=re.get(Se),{numGlyphs:Ce,writingMode:we}=Ae;if(we!==o.bL.vertical||Ie||pe===o.bL.horizontal||(Ie=!0),pe=we,(Ae.hidden||we===o.bL.vertical)&&!Ie){Pn(Ce,W);continue}Ie=!1;const ke=new o.P(Ae.tileAnchorX,Ae.tileAnchorY);let{x:nt,y:Ke,z:ht}=z.projection.projectTilePoint(ke.x,ke.y,O.canonical);if(k){const[Rt,Cn,yn]=k(ke);nt+=Rt,Ke+=Cn,ht+=yn}const et=[nt,Ke,ht,1];if(o.aC(et,et,s),!sa(et,G)){Pn(Ce,W);continue}const ut=et[3],jt=Ta(d.transform.getCameraToCenterDistance(z.projection),ut),tt=o.bM(U,F,Ae),Ue=S?tt/jt:tt*jt,pt=$s(nt,Ke,ht,v);if(pt[3]<=0){Pn(Ce,W);continue}let ot={};const Et=o.an(g.layers[0].layout.get("text-max-angle")),$t=Math.cos(Et),rn=S?null:k,Lt=Bi(Ae,Ue,!1,E,s,v,b,g.glyphOffsetArray,X,W,ne,pt,ke,ot,he,rn,z.projection,O,S,$t);Ie=Lt.useVertical,rn&&Lt.needsFlipping&&(ot={}),(Lt.notEnoughRoom||Ie||Lt.needsFlipping&&Bi(Ae,Ue,!0,E,s,v,b,g.glyphOffsetArray,X,W,ne,pt,ke,ot,he,rn,z.projection,O,S,$t).notEnoughRoom)&&Pn(Ce,W)}m?(g.text.dynamicLayoutVertexBuffer.updateData(W),ne&&g.text.globeExtVertexBuffer&&g.text.globeExtVertexBuffer.updateData(ne)):(g.icon.dynamicLayoutVertexBuffer.updateData(W),ne&&g.icon.globeExtVertexBuffer&&g.icon.globeExtVertexBuffer.updateData(ne))}function qc(g,s,d,m,v,b,S,E,k,O,z,U,F,H,G,W,ne){const{lineStartIndex:X,glyphStartIndex:re,segment:he}=E,pe=re+E.numGlyphs,Ie=X+E.lineLength,Se=s.getoffsetX(re),Ae=s.getoffsetX(pe-1),Ce=Jl(g*Se,d,m,v,b,S,he,X,Ie,k,O,z,U,F,!0,H,G,W,ne);if(!Ce)return null;const we=Jl(g*Ae,d,m,v,b,S,he,X,Ie,k,O,z,U,F,!0,H,G,W,ne);return we?{first:Ce,last:we}:null}function Pu(g,s,d,m){return g===o.bL.horizontal&&Math.abs(m)>Math.abs(d)?{useVertical:!0}:g===o.bL.vertical?m>0?{needsFlipping:!0}:null:s!==Ca.unknown&&function(v,b){return v===0||Math.abs(b/v)>Gc}(d,m)?s===Ca.flipRequired?{needsFlipping:!0}:null:d<0?{needsFlipping:!0}:null}function Bi(g,s,d,m,v,b,S,E,k,O,z,U,F,H,G,W,ne,X,re,he){const pe=s/24,Ie=g.lineOffsetX*pe,Se=g.lineOffsetY*pe,{lineStartIndex:Ae,glyphStartIndex:Ce,numGlyphs:we,segment:ke,writingMode:nt,flipState:Ke}=g,ht=Ae+g.lineLength,et=ut=>{if(z){const[pt,ot,Et]=ut.up,$t=O.length;o.bN(z,$t+0,pt,ot,Et),o.bN(z,$t+1,pt,ot,Et),o.bN(z,$t+2,pt,ot,Et),o.bN(z,$t+3,pt,ot,Et)}const[jt,tt,Ue]=ut.point;o.bO(O,jt,tt,Ue,ut.angle)};if(we>1){const ut=qc(pe,E,Ie,Se,d,U,F,g,k,b,H,W,!1,ne,X,re,he);if(!ut)return{notEnoughRoom:!0};if(m&&!d){let[jt,tt,Ue]=ut.first.point,[pt,ot,Et]=ut.last.point;[jt,tt]=$s(jt,tt,Ue,S),[pt,ot]=$s(pt,ot,Et,S);const $t=Pu(nt,Ke,(pt-jt)*G,ot-tt);if(g.flipState=$t&&$t.needsFlipping?Ca.flipRequired:Ca.flipNotRequired,$t)return $t}et(ut.first);for(let jt=Ce+1;jt<Ce+we-1;jt++){const tt=Jl(pe*E.getoffsetX(jt),Ie,Se,d,U,F,ke,Ae,ht,k,b,H,W,!1,!1,ne,X,re,he);if(!tt)return O.length-=4*(jt-Ce),{notEnoughRoom:!0};et(tt)}et(ut.last)}else{if(m&&!d){const jt=$s(F.x,F.y,0,v),tt=Ae+ke+1,Ue=new o.P(k.getx(tt),k.gety(tt)),pt=$s(Ue.x,Ue.y,0,v),ot=pt[3]>0?pt:Mu(F,Ue,jt,1,v,void 0,ne,X.canonical),Et=Pu(nt,Ke,(ot[0]-jt[0])*G,ot[1]-jt[1]);if(g.flipState=Et&&Et.needsFlipping?Ca.flipRequired:Ca.flipNotRequired,Et)return Et}const ut=Jl(pe*E.getoffsetX(Ce),Ie,Se,d,U,F,ke,Ae,ht,k,b,H,W,!1,!1,ne,X,re,he);if(!ut)return{notEnoughRoom:!0};et(ut)}return{}}function Zc(g,s,d,m,v){const{x:b,y:S,z:E}=m.projectTilePoint(g.x,g.y,s);if(!v)return $s(b,S,E,d);const[k,O,z]=v(g);return $s(b+k,S+O,E+z,d)}function Mu(g,s,d,m,v,b,S,E){const k=Zc(g.sub(s)._unit()._add(g),E,v,S,b);return o.av(k,d,k),o.aw(k,k),o.bH(k,d,k,m)}function Jl(g,s,d,m,v,b,S,E,k,O,z,U,F,H,G,W,ne,X,re){const he=m?g-s:g+s;let pe=he>0?1:-1,Ie=0;m&&(pe*=-1,Ie=Math.PI),pe<0&&(Ie+=Math.PI);let Se=E+S+(pe>0?0:1)|0,Ae=v,Ce=v,we=0,ke=0;const nt=Math.abs(he),Ke=[],ht=[];let et=b,ut=et,jt=o.bF([]);const tt=()=>Mu(ut,et,Ce,nt-we+1,z,F,W,ne.canonical);for(;we+ke<=nt;){if(Se+=pe,Se<E||Se>=k)return null;if(Ce=Ae,ut=et,Ke.push(Ce),H&&ht.push(ut),et=new o.P(O.getx(Se),O.gety(Se)),Ae=U[Se],!Ae){const yn=Zc(et,ne.canonical,z,W,F);Ae=yn[3]>0?U[Se]=yn:tt()}we+=ke;const Rt=o.av([],Ae,Ce),Cn=o.bG(Ce,Ae);if(d&&Cn>0&&ke>0&&o.bJ(jt,Rt)/(ke*Cn)<re)return null;ke=Cn,jt=Rt}G&&F&&(U[Se]&&(Ae=tt(),ke=o.bG(Ce,Ae),jt=o.av([],Ae,Ce)),U[Se]=Ae);const Ue=(nt-we)/ke,pt=et.sub(ut)._mult(Ue)._add(ut),ot=o.bH([],Ce,jt,Ue);let Et=[0,0,1],$t=jt[0],rn=jt[1];if(X&&(Et=W.upVector(ne.canonical,pt.x,pt.y),Et[0]!==0||Et[1]!==0||Et[2]!==1)){const Rt=[Et[2],0,-Et[0]],Cn=o.bI([],Et,Rt);o.aw(Rt,Rt),o.aw(Cn,Cn),$t=o.bJ(jt,Rt),rn=o.bJ(jt,Cn)}if(d){const Rt=o.bI([],Et,jt);o.aw(Rt,Rt),o.bH(ot,ot,Rt,d*pe)}const Lt=Ie+Math.atan2(rn,$t);return Ke.push(ot),H&&ht.push(pt),{point:ot,angle:Lt,path:Ke,tilePath:ht,up:Et}}function Pn(g,s){const d=s.length,m=d+4*g;s.resize(m),s.float32.fill(-1/0,4*d,4*m)}function gd(g,s,d){const m=s[0],v=s[1];return g[0]=d[0]*m+d[4]*v+d[12],g[1]=d[1]*m+d[5]*v+d[13],g[3]=d[3]*m+d[7]*v+d[15],g}const us=100;class ma{constructor(s,d,m=new Ru(s.width+200,s.height+200,25),v=new Ru(s.width+200,s.height+200,25)){this.transform=s,this.grid=m,this.ignoredGrid=v,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+us,this.screenBottomBoundary=s.height+us,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.fogState=d}placeCollisionBox(s,d,m,v,b,S,E,k,O,z,U){let F=m.projectedAnchorX,H=m.projectedAnchorY,G=m.projectedAnchorZ;const W=m.tileAnchorX,ne=m.tileAnchorY,X=m.elevation,re=m.tileID,he=s.getProjection();if(X&&re){const[ht,et,ut]=he.upVector(re.canonical,m.tileAnchorX,m.tileAnchorY),jt=he.upVectorScale(re.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;F+=ht*X*jt,H+=et*X*jt,G+=ut*X*jt}const pe=s.projection.name==="globe",Ie=s.projection.name==="globe"?o.aj(this.transform.zoom):0;if(re&&pe&&Ie<1&&!S){const ht=1<<re.canonical.z,et=o.bP(W,ne);o.bQ(et,et,1/o.al),o.bR(et,et,o.bP(re.canonical.x,re.canonical.y)),o.bQ(et,et,1/ht),o.bS(et,et,o.bP(v[0],v[1])),et[0]=o.bT(et[0],-.5,.5),o.bQ(et,et,o.al);const ut=o.bU(et[0],et[1],o.al/(2*Math.PI),1);o.aC(ut,ut,b),F=o.ak(F,ut[0],Ie),H=o.ak(H,ut[1],Ie),G=o.ak(G,ut[2],Ie)}const Se=this.projectAndGetPerspectiveRatio(z,F,H,G,m.tileID,he.name==="globe"||!!X||this.transform.pitch>0,he),Ae=O*Se.perspectiveRatio,Ce=(m.x1*d+E.x-m.padding)*Ae+Se.point.x,we=(m.y1*d+E.y-m.padding)*Ae+Se.point.y,ke=(m.x2*d+E.x+m.padding)*Ae+Se.point.x,nt=(m.y2*d+E.y+m.padding)*Ae+Se.point.y,Ke=Se.perspectiveRatio<=.55||Se.occluded;return!this.isInsideGrid(Ce,we,ke,nt)||!k&&this.grid.hitTest(Ce,we,ke,nt,U)||Ke?{box:[],offscreen:!1,occluded:Se.occluded}:{box:[Ce,we,ke,nt],offscreen:this.isOffscreen(Ce,we,ke,nt),occluded:!1}}placeCollisionCircles(s,d,m,v,b,S,E,k,O,z,U,F,H,G,W){const ne=[],X=this.transform.elevation,re=s.getProjection(),he=X?X.getAtTileOffsetFunc(W,this.transform.center.lat,this.transform.worldSize,re):null,pe=new o.P(m.tileAnchorX,m.tileAnchorY);let{x:Ie,y:Se,z:Ae}=re.projectTilePoint(pe.x,pe.y,W.canonical);if(he){const[Et,$t,rn]=he(pe);Ie+=Et,Se+=$t,Ae+=rn}const Ce=re.name==="globe",we=this.projectAndGetPerspectiveRatio(E,Ie,Se,Ae,W,Ce||!!X||this.transform.pitch>0,re),{perspectiveRatio:ke}=we,nt=(U?S/ke:S*ke)/o.bX,Ke=$s(Ie,Se,Ae,k),ht=m.lineOffsetX*nt,et=m.lineOffsetY*nt,ut=o.an(s.layers[0].layout.get("text-max-angle")),jt=Math.cos(ut),tt=we.signedDistanceFromCamera>0?qc(nt,b,ht,et,!1,Ke,pe,m,v,k,{},X&&!U?he:null,U&&!!X,re,W,U,jt):null;let Ue=!1,pt=!1,ot=!0;if(tt&&!we.occluded){const Et=.5*H*ke+G,$t=new o.P(-100,-100),rn=new o.P(this.screenRightBoundary,this.screenBottomBoundary),Lt=new ku,{first:Rt,last:Cn}=tt,yn=Rt.path.length;let wn=[];for(let ri=yn-1;ri>=1;ri--)wn.push(Rt.path[ri]);for(let ri=1;ri<Cn.path.length;ri++)wn.push(Cn.path[ri]);const gn=2.5*Et;O&&(wn=wn.map(([ri,ci,or],Xn)=>(he&&!Ce&&(or=he(Xn<yn-1?Rt.tilePath[yn-1-Xn]:Cn.tilePath[Xn-yn+2])[2]),$s(ri,ci,or,O))),wn.some(ri=>ri[3]<=0)&&(wn=[]));let Wn=[];if(wn.length>0){let ri=1/0,ci=-1/0,or=1/0,Xn=-1/0;for(const ji of wn)ri=Math.min(ri,ji[0]),or=Math.min(or,ji[1]),ci=Math.max(ci,ji[0]),Xn=Math.max(Xn,ji[1]);ci>=$t.x&&ri<=rn.x&&Xn>=$t.y&&or<=rn.y&&(Wn=[wn.map(ji=>new o.P(ji[0],ji[1]))],(ri<$t.x||ci>rn.x||or<$t.y||Xn>rn.y)&&(Wn=o.bV(Wn,$t.x,$t.y,rn.x,rn.y)))}for(const ri of Wn){Lt.reset(ri,.25*Et);let ci=0;ci=Lt.length<=.5*Et?1:Math.ceil(Lt.paddedLength/gn)+1;for(let or=0;or<ci;or++){const Xn=or/Math.max(ci-1,1),ji=Lt.lerp(Xn),rr=ji.x+us,$r=ji.y+us;ne.push(rr,$r,Et,0);const oi=rr-Et,Ji=$r-Et,qi=rr+Et,er=$r+Et;if(ot=ot&&this.isOffscreen(oi,Ji,qi,er),pt=pt||this.isInsideGrid(oi,Ji,qi,er),!d&&this.grid.hitTestCircle(rr,$r,Et,F)&&(Ue=!0,!z))return{circles:[],offscreen:!1,collisionDetected:Ue,occluded:!1}}}}return{circles:!z&&Ue||!pt?[]:ne,offscreen:ot,collisionDetected:Ue,occluded:we.occluded}}queryRenderedSymbols(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[];let m=1/0,v=1/0,b=-1/0,S=-1/0;for(const z of s){const U=new o.P(z.x+us,z.y+us);m=Math.min(m,U.x),v=Math.min(v,U.y),b=Math.max(b,U.x),S=Math.max(S,U.y),d.push(U)}const E=this.grid.query(m,v,b,S).concat(this.ignoredGrid.query(m,v,b,S)),k={},O={};for(const z of E){const U=z.key;if(k[U.bucketInstanceId]===void 0&&(k[U.bucketInstanceId]={}),k[U.bucketInstanceId][U.featureIndex])continue;const F=[new o.P(z.x1,z.y1),new o.P(z.x2,z.y1),new o.P(z.x2,z.y2),new o.P(z.x1,z.y2)];o.bW(d,F)&&(k[U.bucketInstanceId][U.featureIndex]=!0,O[U.bucketInstanceId]===void 0&&(O[U.bucketInstanceId]=[]),O[U.bucketInstanceId].push(U.featureIndex))}return O}insertCollisionBox(s,d,m,v,b){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:v,collisionGroupID:b},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,d,m,v,b){const S=d?this.ignoredGrid:this.grid,E={bucketInstanceId:m,featureIndex:v,collisionGroupID:b};for(let k=0;k<s.length;k+=4)S.insertCircle(E,s[k],s[k+1],s[k+2])}projectAndGetPerspectiveRatio(s,d,m,v,b,S,E){const k=[d,m,v,1];let O=!1;v||this.transform.pitch>0?(o.aC(k,k,s),this.fogState&&b&&E.name!=="globe"&&(O=function(F,H,G,W,ne,X){const re=X.calculateFogTileMatrix(ne),he=[H,G,W];return o.af(he,he,re),Mn(F,o.ag(he),X.pitch,X._fov)}(this.fogState,d,m,v,b.toUnwrapped(),this.transform)>.9)):gd(k,k,s);const z=k[3];return{point:new o.P((k[0]/z+1)/2*this.transform.width+us,(-k[1]/z+1)/2*this.transform.height+us),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(E)/z*.5,1.5),signedDistanceFromCamera:z,occluded:S&&k[2]>z||O}}isOffscreen(s,d,m,v){return m<us||s>=this.screenRightBoundary||v<us||d>this.screenBottomBoundary}isInsideGrid(s,d,m,v){return m>=0&&s<this.gridRightBoundary&&v>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const s=o.bA([]);return o.br(s,s,[-100,-100,0]),s}}class Ql{constructor(s,d,m,v){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?d:-d))):v&&m?1:0,this.placed=m}isHidden(){return this.opacity===0&&!this.placed}}class ja{constructor(s,d,m,v,b,S=!1){this.text=new Ql(s?s.text:null,d,m,b),this.icon=new Ql(s?s.icon:null,d,v,b),this.clipped=S}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class bn{constructor(s,d,m,v=!1){this.text=s,this.icon=d,this.skipFade=m,this.clipped=v}}class wi{constructor(){this.invProjMatrix=o.bC(),this.viewportMatrix=o.bC(),this.circles=[]}}class Ni{constructor(s,d,m,v,b){this.bucketInstanceId=s,this.featureIndex=d,this.sourceLayerIndex=m,this.bucketIndex=v,this.tileID=b}}class Ys{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){const d=++this.maxGroupID;this.collisionGroups[s]={ID:d,predicate:m=>m.collisionGroupID===d}}return this.collisionGroups[s]}}function Is(g,s,d,m,v){const{horizontalAlign:b,verticalAlign:S}=o.c0(g),E=-(b-.5)*s,k=-(S-.5)*d,O=o.c1(g,m);return new o.P(E+O[0]*v,k+O[1]*v)}function M(g,s,d,m,v){const b=new o.P(g,s);return d&&b._rotate(m?v:-v),b}class J{constructor(s,d,m,v,b,S){this.transform=s.clone(),this.projection=s.projection.name,this.collisionIndex=new ma(this.transform,b),this.buildingIndex=S,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new Ys(m),this.collisionCircleArrays={},this.prevPlacement=v,v&&(v.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(s,d,m,v,b=1){const S=m.getBucket(d),E=m.latestFeatureIndex;if(!S||!E||d.fqid!==S.layerIds[0])return;const k=S.layers[0].layout,O=S.layers[0].paint,z=m.collisionBoxArray,U=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),F=m.tileSize/o.al,H=m.tileID.toUnwrapped();this.transform.setProjection(S.projection);const G=(W=m.tileID,ne=S.getProjection(),X=this.transform,ne.name===this.projection?X.calculateProjMatrix(W.toUnwrapped()):Xl(X,ne,W));var W,ne,X;const re=k.get("text-pitch-alignment")==="map",he=k.get("text-rotation-alignment")==="map";d.compileFilter(d.options);const pe=d.dynamicFilter(),Ie=d.dynamicFilterNeedsFeature(),Se=this.transform.calculatePixelsToTileUnitsMatrix(m),Ae=el(G,m.tileID.canonical,re,he,this.transform,S.getProjection(),Se);let Ce=null;const we=S.getProjection().createInversionMatrix(this.transform,m.tileID.canonical);if(re){const Ue=Wc(G,m.tileID.canonical,re,he,this.transform,S.getProjection(),Se);Ce=o.aB([],this.transform.labelPlaneMatrix,Ue)}let ke=null;pe&&m.latestFeatureIndex&&(ke={unwrappedTileID:H,dynamicFilter:pe,dynamicFilterNeedsFeature:Ie}),this.retainedQueryData[S.bucketInstanceId]=new Ni(S.bucketInstanceId,E,S.sourceLayerIndex,S.index,m.tileID);const[nt,Ke]=S.layers[0].layout.get("text-size-scale-range"),ht=o.aA(b,nt,Ke),[et,ut]=k.get("icon-size-scale-range"),jt=o.aA(b,et,ut),tt={bucket:S,layout:k,paint:O,posMatrix:G,invMatrix:we,mercatorCenter:[o.aF(this.transform.center.lng),o.aJ(this.transform.center.lat)],textLabelPlaneMatrix:Ae,labelToScreenMatrix:Ce,clippingData:ke,scale:U,textPixelRatio:F,holdingForFade:m.holdingForFade(),collisionBoxArray:z,partiallyEvaluatedTextSize:o.bK(S.textSizeData,this.transform.zoom,ht),partiallyEvaluatedIconSize:o.bK(S.iconSizeData,this.transform.zoom,jt),collisionGroup:this.collisionGroups.get(S.sourceID),latestFeatureIndex:m.latestFeatureIndex};if(v)for(const Ue of S.sortKeyRanges){const{sortKey:pt,symbolInstanceStart:ot,symbolInstanceEnd:Et}=Ue;s.push({sortKey:pt,symbolInstanceStart:ot,symbolInstanceEnd:Et,parameters:tt})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:tt})}attemptAnchorPlacement(s,d,m,v,b,S,E,k,O,z,U,F,H,G,W,ne,X,re,he,pe,Ie){const{textOffset0:Se,textOffset1:Ae,crossTileID:Ce}=W,we=[Se,Ae],ke=Is(s,S,E,we,k),nt=this.collisionIndex.placeCollisionBox(X,k,d,m,v,b,M(ke.x,ke.y,O,z,this.transform.angle),G,U,F,H.predicate);if(he){const Ke=X.getSymbolInstanceIconSize(Ie,this.transform.zoom,W.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(X,Ke,he,m,v,b,M(ke.x,ke.y,O,z,this.transform.angle),G,U,F,H.predicate).box.length===0)return}if(nt.box.length>0){let Ke;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ce]&&this.prevPlacement.placements[Ce]&&this.prevPlacement.placements[Ce].text&&(Ke=this.prevPlacement.variableOffsets[Ce].anchor),this.variableOffsets[Ce]={textOffset:we,width:S,height:E,anchor:s,textScale:k,prevAnchor:Ke},this.markUsedJustification(X,s,W,re),X.allowVerticalPlacement&&(this.markUsedOrientation(X,re,W),this.placedOrientations[Ce]=re),{shift:ke,placedGlyphBoxes:nt}}}placeLayerBucketPart(s,d,m,v,b=1){const{bucket:S,layout:E,paint:k,posMatrix:O,textLabelPlaneMatrix:z,labelToScreenMatrix:U,clippingData:F,textPixelRatio:H,mercatorCenter:G,invMatrix:W,holdingForFade:ne,collisionBoxArray:X,partiallyEvaluatedTextSize:re,partiallyEvaluatedIconSize:he,collisionGroup:pe,latestFeatureIndex:Ie}=s.parameters,Se=E.get("text-optional"),Ae=E.get("icon-optional"),Ce=E.get("text-allow-overlap"),we=E.get("icon-allow-overlap"),ke=E.get("text-rotation-alignment")==="map",nt=E.get("icon-rotation-alignment")==="map",Ke=E.get("text-pitch-alignment")==="map",ht=k.get("symbol-z-offset"),et=E.get("symbol-elevation-reference")==="sea",ut=E.get("symbol-placement"),[jt,tt]=E.get("text-size-scale-range"),[Ue,pt]=E.get("icon-size-scale-range"),ot=o.aA(b,jt,tt),Et=o.aA(b,Ue,pt),$t=E.get("text-variable-anchor"),rn=ke&&ut!=="point",Lt=nt&&ut!=="point",Rt=$t&&S.hasTextData(),Cn=S.hasIconTextFit()&&Rt&&S.hasIconData();this.transform.setProjection(S.projection);const yn=Rt||rn,wn=Lt||Cn;let gn=Ce&&(we||!S.hasIconData()||Ae),Wn=we&&(Ce||!S.hasTextData()||Se);const ri=!ht.isConstant();!S.collisionArrays&&X&&S.deserializeCollisionBoxes(X),m&&v&&S.updateCollisionDebugBuffers(this.transform.zoom,X,ot,Et);const ci=(Xn,ji,rr)=>{const{crossTileID:$r,numVerticalGlyphVertices:oi}=Xn;let Ji=null;if(F&&F.dynamicFilterNeedsFeature||ri){const To=this.retainedQueryData[S.bucketInstanceId];Ji=Ie.loadFeature({featureIndex:Xn.featureIndex,bucketIndex:To.bucketIndex,sourceLayerIndex:To.sourceLayerIndex,layoutVertexArrayOffset:0})}if(F&&!(0,F.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},Ji,this.retainedQueryData[S.bucketInstanceId].tileID.canonical,new o.P(Xn.tileAnchorX,Xn.tileAnchorY),this.transform.calculateDistanceTileData(F.unwrappedTileID)))return this.placements[$r]=new bn(!1,!1,!1,!0),void d.add($r);const qi=ht.evaluate(Ji,{});if(d.has($r))return;if(ne)return void(this.placements[$r]=new bn(!1,!1,!1));let er=!1,Wr=!1,Po=!0,Ds=!1,qr=!1,ui=null,Vn={box:null,offscreen:null,occluded:null},sr={box:null},yo=null,Yr=null,es=null,Js=0,Dl=0,Ol=0;rr.textFeatureIndex?Js=rr.textFeatureIndex:Xn.useRuntimeCollisionCircles&&(Js=Xn.featureIndex),rr.verticalTextFeatureIndex&&(Dl=rr.verticalTextFeatureIndex);const ol=To=>{To.tileID=this.retainedQueryData[S.bucketInstanceId].tileID;const Mo=this.transform.elevation;To.elevation=et?qi:qi+(Mo?Mo.getAtTileOffset(To.tileID,To.tileAnchorX,To.tileAnchorY):0),To.elevation+=Xn.zOffset},sl=rr.textBox;if(sl){ol(sl);const To=Jr=>{let fs=o.bL.horizontal;if(S.allowVerticalPlacement&&!Jr&&this.prevPlacement){const Os=this.prevPlacement.placedOrientations[$r];Os&&(this.placedOrientations[$r]=Os,fs=Os,this.markUsedOrientation(S,fs,Xn))}return fs},Mo=(Jr,fs)=>{if(S.allowVerticalPlacement&&oi>0&&rr.verticalTextBox){for(const Os of S.writingModes)if(Os===o.bL.vertical?(Vn=fs(),sr=Vn):Vn=Jr(),Vn&&Vn.box&&Vn.box.length)break}else Vn=Jr()};if($t){let Jr=$t;if(this.prevPlacement&&this.prevPlacement.variableOffsets[$r]){const Go=this.prevPlacement.variableOffsets[$r];Jr.indexOf(Go.anchor)>0&&(Jr=Jr.filter(aa=>aa!==Go.anchor),Jr.unshift(Go.anchor))}const fs=(Go,aa,lu)=>{const Gu=S.getSymbolInstanceTextSize(re,Xn,this.transform.zoom,ji),kc=(Go.x2-Go.x1)*Gu+2*Go.padding,zd=(Go.y2-Go.y1)*Gu+2*Go.padding,Bd=Xn.hasIconTextFit&&!we?aa:null;Bd&&ol(Bd);let cu={box:[],offscreen:!1,occluded:!1};const Yf=Ce?2*Jr.length:Jr.length;for(let Wu=0;Wu<Yf;++Wu){const uu=this.attemptAnchorPlacement(Jr[Wu%Jr.length],Go,G,W,yn,kc,zd,Gu,ke,Ke,H,O,pe,Wu>=Jr.length,Xn,ji,S,lu,Bd,re,he);if(uu&&(cu=uu.placedGlyphBoxes,cu&&cu.box&&cu.box.length)){er=!0,ui=uu.shift;break}}return cu};Mo(()=>fs(sl,rr.iconBox,o.bL.horizontal),()=>{const Go=rr.verticalTextBox;return Go&&ol(Go),S.allowVerticalPlacement&&!(Vn&&Vn.box&&Vn.box.length)&&oi>0&&Go?fs(Go,rr.verticalIconBox,o.bL.vertical):{box:null,offscreen:null,occluded:null}}),Vn&&(er=Vn.box,Po=Vn.offscreen,Ds=Vn.occluded);const Os=To(!(!Vn||!Vn.box));if(!er&&this.prevPlacement){const Go=this.prevPlacement.variableOffsets[$r];Go&&(this.variableOffsets[$r]=Go,this.markUsedJustification(S,Go.anchor,Xn,Os))}}else{const Jr=(fs,Os)=>{const Go=S.getSymbolInstanceTextSize(re,Xn,this.transform.zoom,ji),aa=this.collisionIndex.placeCollisionBox(S,Go,fs,G,W,yn,new o.P(0,0),Ce,H,O,pe.predicate);return aa&&aa.box&&aa.box.length&&(this.markUsedOrientation(S,Os,Xn),this.placedOrientations[$r]=Os),aa};Mo(()=>Jr(sl,o.bL.horizontal),()=>{const fs=rr.verticalTextBox;return S.allowVerticalPlacement&&oi>0&&fs?(ol(fs),Jr(fs,o.bL.vertical)):{box:null,offscreen:null,occluded:null}}),To(!!(Vn&&Vn.box&&Vn.box.length))}}if(yo=Vn,er=yo&&yo.box&&yo.box.length>0,Po=yo&&yo.offscreen,Ds=yo&&yo.occluded,Xn.useRuntimeCollisionCircles){const To=S.text.placedSymbolArray.get(Xn.centerJustifiedTextSymbolIndex>=0?Xn.centerJustifiedTextSymbolIndex:Xn.verticalPlacedTextSymbolIndex),Mo=o.bM(S.textSizeData,re,To),Jr=E.get("text-padding");Yr=this.collisionIndex.placeCollisionCircles(S,Ce,To,S.lineVertexArray,S.glyphOffsetArray,Mo,O,z,U,m,Ke,pe.predicate,Xn.collisionCircleDiameter*Mo/o.bX,Jr,this.retainedQueryData[S.bucketInstanceId].tileID),er=Ce||Yr.circles.length>0&&!Yr.collisionDetected,Po=Po&&Yr.offscreen,Ds=Yr.occluded}if(rr.iconFeatureIndex&&(Ol=rr.iconFeatureIndex),rr.iconBox){const To=Mo=>{ol(Mo);const Jr=Xn.hasIconTextFit&&ui?M(ui.x,ui.y,ke,Ke,this.transform.angle):new o.P(0,0),fs=S.getSymbolInstanceIconSize(he,this.transform.zoom,Xn.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(S,fs,Mo,G,W,wn,Jr,we,H,O,pe.predicate)};sr&&sr.box&&sr.box.length&&rr.verticalIconBox?(es=To(rr.verticalIconBox),Wr=es.box.length>0):(es=To(rr.iconBox),Wr=es.box.length>0),Po=Po&&es.offscreen,qr=es.occluded}const Pa=Se||Xn.numHorizontalGlyphVertices===0&&oi===0,sc=Ae||Xn.numIconVertices===0;if(Pa||sc?sc?Pa||(Wr=Wr&&er):er=Wr&&er:Wr=er=Wr&&er,er&&yo&&yo.box&&this.collisionIndex.insertCollisionBox(yo.box,E.get("text-ignore-placement"),S.bucketInstanceId,sr&&sr.box&&Dl?Dl:Js,pe.ID),Wr&&es&&this.collisionIndex.insertCollisionBox(es.box,E.get("icon-ignore-placement"),S.bucketInstanceId,Ol,pe.ID),Yr&&(er&&this.collisionIndex.insertCollisionCircles(Yr.circles,E.get("text-ignore-placement"),S.bucketInstanceId,Js,pe.ID),m)){const To=S.bucketInstanceId;let Mo=this.collisionCircleArrays[To];Mo===void 0&&(Mo=this.collisionCircleArrays[To]=new wi);for(let Jr=0;Jr<Yr.circles.length;Jr+=4)Mo.circles.push(Yr.circles[Jr+0]),Mo.circles.push(Yr.circles[Jr+1]),Mo.circles.push(Yr.circles[Jr+2]),Mo.circles.push(Yr.collisionDetected?1:0)}const Ac=S.projection.name!=="globe";gn=gn&&(Ac||!Ds),Wn=Wn&&(Ac||!qr),this.placements[$r]=new bn(er||gn,Wr||Wn,Po||S.justReloaded),d.add($r)},or=this.retainedQueryData[S.bucketInstanceId].tileID;if(S.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(S,or),S.elevationType==="road"&&S.updateRoadElevation(or.canonical),S.updateZOffset(),S.sortFeaturesByY){const Xn=S.getSortedSymbolIndexes(this.transform.angle);for(let ji=Xn.length-1;ji>=0;--ji){const rr=Xn[ji];ci(S.symbolInstances.get(rr),rr,S.collisionArrays[rr])}S.hasAnyZOffset&&o.w(`${S.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(S.hasAnyZOffset){const Xn=S.getSortedIndexesByZOffset();for(let ji=0;ji<Xn.length;++ji){const rr=Xn[ji];ci(S.symbolInstances.get(rr),rr,S.collisionArrays[rr])}}else for(let Xn=s.symbolInstanceStart;Xn<s.symbolInstanceEnd;Xn++)ci(S.symbolInstances.get(Xn),Xn,S.collisionArrays[Xn]);if(m&&S.bucketInstanceId in this.collisionCircleArrays){const Xn=this.collisionCircleArrays[S.bucketInstanceId];o.bl(Xn.invProjMatrix,O),Xn.viewportMatrix=this.collisionIndex.getViewportMatrix()}S.justReloaded=!1}markUsedJustification(s,d,m,v){const{leftJustifiedTextSymbolIndex:b,centerJustifiedTextSymbolIndex:S,rightJustifiedTextSymbolIndex:E,verticalPlacedTextSymbolIndex:k,crossTileID:O}=m,z=o.c2(d),U=v===o.bL.vertical?k:z==="left"?b:z==="center"?S:z==="right"?E:-1;b>=0&&(s.text.placedSymbolArray.get(b).crossTileID=U>=0&&b!==U?0:O),S>=0&&(s.text.placedSymbolArray.get(S).crossTileID=U>=0&&S!==U?0:O),E>=0&&(s.text.placedSymbolArray.get(E).crossTileID=U>=0&&E!==U?0:O),k>=0&&(s.text.placedSymbolArray.get(k).crossTileID=U>=0&&k!==U?0:O)}markUsedOrientation(s,d,m){const v=d===o.bL.horizontal||d===o.bL.horizontalOnly?d:0,b=d===o.bL.vertical?d:0,{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:E,rightJustifiedTextSymbolIndex:k,verticalPlacedTextSymbolIndex:O}=m,z=s.text.placedSymbolArray;S>=0&&(z.get(S).placedOrientation=v),E>=0&&(z.get(E).placedOrientation=v),k>=0&&(z.get(k).placedOrientation=v),O>=0&&(z.get(O).placedOrientation=b)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let m=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const v=d?d.symbolFadeChange(s):1,b=d?d.opacities:{},S=d?d.variableOffsets:{},E=d?d.placedOrientations:{};for(const k in this.placements){const O=this.placements[k],z=b[k];z?(this.opacities[k]=new ja(z,v,O.text,O.icon,null,O.clipped),m=m||O.text!==z.text.placed||O.icon!==z.icon.placed):(this.opacities[k]=new ja(null,v,O.text,O.icon,O.skipFade,O.clipped),m=m||O.text||O.icon)}for(const k in b){const O=b[k];if(!this.opacities[k]){const z=new ja(O,v,!1,!1);z.isHidden()||(this.opacities[k]=z,m=m||O.text.placed||O.icon.placed)}}for(const k in S)this.variableOffsets[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.variableOffsets[k]=S[k]);for(const k in E)this.placedOrientations[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.placedOrientations[k]=E[k]);m?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:s)}updateLayerOpacities(s,d,m,v){const b=new Set;for(const S of d){const E=S.getBucket(s);E&&S.latestFeatureIndex&&s.fqid===E.layerIds[0]&&(this.updateBucketOpacities(E,b,S,S.collisionBoxArray,m,v,S.tileID,s.scope),E.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(E,S.tileID),E.elevationType==="road"&&E.updateRoadElevation(S.tileID.canonical),E.updateZOffset())}}updateBucketOpacities(s,d,m,v,b,S,E,k){s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();const O=s.layers[0].layout,z=s.layers[0].paint,U=!!s.layers[0].dynamicFilter(),F=new ja(null,0,!1,!1,!0),H=O.get("text-allow-overlap"),G=O.get("icon-allow-overlap"),W=O.get("text-variable-anchor"),ne=O.get("text-rotation-alignment")==="map",X=O.get("text-pitch-alignment")==="map",re=z.get("symbol-z-offset"),he=O.get("symbol-elevation-reference")==="sea",pe=!re.isConstant(),Ie=new ja(null,0,H&&(G||!s.hasIconData()||O.get("icon-optional")),G&&(H||!s.hasTextData()||O.get("text-optional")),!0);!s.collisionArrays&&v&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(v);const Se=(Ce,we,ke)=>{for(let nt=0;nt<we/4;nt++)Ce.opacityVertexArray.emplaceBack(ke)};let Ae=0;S&&s.updateReplacement(E,S);for(let Ce=0;Ce<s.symbolInstances.length;Ce++){const we=s.symbolInstances.get(Ce),{numHorizontalGlyphVertices:ke,numVerticalGlyphVertices:nt,crossTileID:Ke,numIconVertices:ht,tileAnchorX:et,tileAnchorY:ut}=we;let jt=null;const tt=this.retainedQueryData[s.bucketInstanceId];pe&&we&&tt&&(jt=m.latestFeatureIndex.loadFeature({featureIndex:we.featureIndex,bucketIndex:tt.bucketIndex,sourceLayerIndex:tt.sourceLayerIndex,layoutVertexArrayOffset:0}));const Ue=re.evaluate(jt,{}),pt=d.has(Ke);let ot=this.opacities[Ke];pt?ot=F:ot||(ot=Ie,this.opacities[Ke]=ot),d.add(Ke);const Et=ke>0||nt>0,$t=ht>0,rn=this.placedOrientations[Ke],Lt=rn===o.bL.vertical,Rt=rn===o.bL.horizontal||rn===o.bL.horizontalOnly;!Et&&!$t||ot.isHidden()||Ae++;let Cn=!1;if((Et||$t)&&S)for(const yn of s.activeReplacements){if(o.bY(yn,b,o.bZ.Symbol,k)||yn.min.x>et||et>yn.max.x||yn.min.y>ut||ut>yn.max.y)continue;const wn=o.b_(et,ut,E.canonical,yn.footprintTileId.canonical);if(Cn=o.b$(wn,yn.footprint),Cn)break}if(Et){const yn=Cn?jo:fo(ot.text);Se(s.text,ke,Lt?jo:yn),Se(s.text,nt,Rt?jo:yn);const wn=ot.text.isHidden(),{leftJustifiedTextSymbolIndex:gn,centerJustifiedTextSymbolIndex:Wn,rightJustifiedTextSymbolIndex:ri,verticalPlacedTextSymbolIndex:ci}=we,or=s.text.placedSymbolArray,Xn=wn||Lt?1:0;gn>=0&&(or.get(gn).hidden=Xn),Wn>=0&&(or.get(Wn).hidden=Xn),ri>=0&&(or.get(ri).hidden=Xn),ci>=0&&(or.get(ci).hidden=wn||Rt?1:0);const ji=this.variableOffsets[Ke];ji&&this.markUsedJustification(s,ji.anchor,we,rn);const rr=this.placedOrientations[Ke];rr&&(this.markUsedJustification(s,"left",we,rr),this.markUsedOrientation(s,rr,we))}if($t){const yn=Cn?jo:fo(ot.icon),{placedIconSymbolIndex:wn,verticalPlacedIconSymbolIndex:gn}=we,Wn=s.icon.placedSymbolArray,ri=ot.icon.isHidden()?1:0;wn>=0&&(Se(s.icon,ht,Lt?jo:yn),Wn.get(wn).hidden=ri),gn>=0&&(Se(s.icon,we.numVerticalIconVertices,Rt?jo:yn),Wn.get(gn).hidden=ri)}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){const yn=s.collisionArrays[Ce];if(yn){let wn=new o.P(0,0),gn=!0;if(yn.textBox||yn.verticalTextBox){if(W){const ri=this.variableOffsets[Ke];ri?(wn=Is(ri.anchor,ri.width,ri.height,ri.textOffset,ri.textScale),ne&&wn._rotate(X?this.transform.angle:-this.transform.angle)):gn=!1}U&&(gn=!ot.clipped),yn.textBox&&le(s.textCollisionBox.collisionVertexArray,ot.text.placed,!gn||Lt,Ue,he,wn.x,wn.y),yn.verticalTextBox&&le(s.textCollisionBox.collisionVertexArray,ot.text.placed,!gn||Rt,Ue,he,wn.x,wn.y)}const Wn=gn&&!!(!Rt&&yn.verticalIconBox);yn.iconBox&&le(s.iconCollisionBox.collisionVertexArray,ot.icon.placed,Wn,Ue,he,we.hasIconTextFit?wn.x:0,we.hasIconTextFit?wn.y:0),yn.verticalIconBox&&le(s.iconCollisionBox.collisionVertexArray,ot.icon.placed,!Wn,Ue,he,we.hasIconTextFit?wn.x:0,we.hasIconTextFit?wn.y:0)}}}if(s.fullyClipped=Ae===0,s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.bucketInstanceId in this.collisionCircleArrays){const Ce=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=Ce.invProjMatrix,s.placementViewportMatrix=Ce.viewportMatrix,s.collisionCircleArray=Ce.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}}symbolFadeChange(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,d){const m=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*m>s}setStale(){this.stale=!0}}function le(g,s,d,m,v,b,S){g.emplaceBack(s?1:0,d?1:0,b||0,S||0,m,v?1:0),g.emplaceBack(s?1:0,d?1:0,b||0,S||0,m,v?1:0),g.emplaceBack(s?1:0,d?1:0,b||0,S||0,m,v?1:0),g.emplaceBack(s?1:0,d?1:0,b||0,S||0,m,v?1:0)}const Ne=Math.pow(2,25),Ct=Math.pow(2,24),kt=Math.pow(2,17),Nn=Math.pow(2,16),Gi=Math.pow(2,9),Jo=Math.pow(2,8),Hr=Math.pow(2,1);function fo(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const s=g.placed?1:0,d=Math.floor(127*g.opacity);return d*Ne+s*Ct+d*kt+s*Nn+d*Gi+s*Jo+d*Hr+s}const jo=0;class tl{constructor(s){this._sortAcrossTiles=s.layout.get("symbol-z-order")!=="viewport-y"&&s.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(s,d,m,v,b,S){const E=this._bucketParts;for(;this._currentTileIndex<s.length;)if(d.getBucketParts(E,v,s[this._currentTileIndex],this._sortAcrossTiles,S),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort((k,O)=>k.sortKey-O.sortKey));this._currentPartIndex<E.length;){const k=E[this._currentPartIndex];if(d.placeLayerBucketPart(k,this._seenCrossTileIDs,m,k.symbolInstanceStart===0,S),this._currentPartIndex++,b())return!0}return!1}}class Co{constructor(s,d,m,v,b,S,E,k,O){this.placement=new J(s,b,S,E,k,O),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=v,this._done=!1}isDone(){return this._done}continuePlacement(s,d,m,v,b){const S=o.o.now(),E=()=>{const k=o.o.now()-S;return!this._forceFullPlacement&&k>2};for(;this._currentPlacementIndex>=0;){const k=d[s[this._currentPlacementIndex]],O=this.placement.collisionIndex.transform.zoom;if(k.type==="symbol"&&(!k.minzoom||k.minzoom<=O)&&(!k.maxzoom||k.maxzoom>O)){const z=k,U=z.layout.get("symbol-z-elevate"),F=z.layout.get("symbol-sort-key").constantOr(1)!==void 0,H=z.layout.get("symbol-z-order"),G=H==="viewport-y"||H==="auto"&&!(H!=="viewport-y"&&F),W=z.layout.get("text-allow-overlap")||z.layout.get("icon-allow-overlap")||z.layout.get("text-ignore-placement")||z.layout.get("icon-ignore-placement"),ne=G&&W,X=this._inProgressLayer=this._inProgressLayer||new tl(z),re=o.B(k.source,k.scope);if(X.continuePlacement(U||ne?v[re]:m[re],this.placement,this._showCollisionBoxes,k,E,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}const As=512/o.al/2;class ks{constructor(s,d,m){this.tileID=s,this.bucketInstanceId=m,this.index=new o.c3(d.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const v=s.canonical.x*o.al,b=s.canonical.y*o.al;for(let S=0;S<d.length;S++){const{key:E,crossTileID:k,tileAnchorX:O,tileAnchorY:z}=d.get(S),U=Math.floor((v+O)*As),F=Math.floor((b+z)*As);this.index.add(U,F),this.keys.push(E),this.crossTileIDs.push(k)}this.index.finish()}findMatches(s,d,m){const v=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z),b=As/Math.pow(2,d.canonical.z-this.tileID.canonical.z),S=d.canonical.x*o.al,E=d.canonical.y*o.al;for(let k=0;k<s.length;k++){const O=s.get(k);if(O.crossTileID)continue;const{key:z,tileAnchorX:U,tileAnchorY:F}=O,H=Math.floor((S+U)*b),G=Math.floor((E+F)*b),W=this.index.range(H-v,G-v,H+v,G+v).sort((ne,X)=>ne-X);for(const ne of W){const X=this.crossTileIDs[ne];if(this.keys[ne]===z&&!m.has(X)){m.add(X),O.crossTileID=X;break}}}}}class _d{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class yd{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){const d=Math.round((s-this.lng)/360);if(d!==0)for(const m in this.indexes){const v=this.indexes[m],b={};for(const S in v){const E=v[S];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+d),b[E.tileID.key]=E}this.indexes[m]=b}this.lng=s}addBucket(s,d,m){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let b=0;b<d.symbolInstances.length;b++)d.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]=new Set);const v=this.usedCrossTileIDs[s.overscaledZ];for(const b in this.indexes){const S=this.indexes[b];if(Number(b)>s.overscaledZ)for(const E in S){const k=S[E];k.tileID.isChildOf(s)&&k.findMatches(d.symbolInstances,s,v)}else{const E=S[s.scaledTo(Number(b)).key];E&&E.findMatches(d.symbolInstances,s,v)}}for(let b=0;b<d.symbolInstances.length;b++){const S=d.symbolInstances.get(b);S.crossTileID||(S.crossTileID=m.generate(),v.add(S.crossTileID))}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new ks(s,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(s,d){for(const m of d.crossTileIDs)this.usedCrossTileIDs[s].delete(m)}removeStaleBuckets(s){let d=!1;for(const m in this.indexes){const v=this.indexes[m];for(const b in v)s[v[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,v[b]),delete v[b],d=!0)}return d}}class ds{constructor(){this.layerIndexes={},this.crossTileIDs=new _d,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,d,m,v){let b=this.layerIndexes[s.fqid];b===void 0&&(b=this.layerIndexes[s.fqid]=new yd);let S=!1;const E={};v.name!=="globe"&&b.handleWrapJump(m);for(const k of d){const O=k.getBucket(s);O&&s.fqid===O.layerIds[0]&&(O.bucketInstanceId||(O.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(k.tileID,O,this.crossTileIDs)&&(S=!0),E[O.bucketInstanceId]=!0)}return b.removeStaleBuckets(E)&&(S=!0),S}pruneUnusedLayers(s){const d={};s.forEach(m=>{d[m]=!0});for(const m in this.layerIndexes)d[m]||delete this.layerIndexes[m]}}const ga=771;class ti{constructor(s,d,m,v){this.blendFunction=s,this.blendColor=d.toNonPremultipliedRenderColor(null),this.mask=m,this.blendEquation=v}}ti.Replace=[1,0,1,0],ti.disabled=new ti(ti.Replace,o.ao.transparent,[!1,!1,!1,!1]),ti.unblended=new ti(ti.Replace,o.ao.transparent,[!0,!0,!0,!0]),ti.alphaBlended=new ti([1,ga,1,ga],o.ao.transparent,[!0,!0,!0,!0]),ti.alphaBlendedNonPremultiplied=new ti([770,ga,770,ga],o.ao.transparent,[!0,!0,!0,!0]),ti.multiply=new ti([774,0,774,0],o.ao.transparent,[!0,!0,!0,!0]);class sn{constructor(s,d,m){this.func=s,this.mask=d,this.range=m}}sn.ReadOnly=!1,sn.ReadWrite=!0,sn.disabled=new sn(519,sn.ReadOnly,[0,1]);const _a=7680;class Dn{constructor(s,d,m,v,b,S){this.test=s,this.ref=d,this.mask=m,this.fail=v,this.depthFail=b,this.pass=S}}Dn.disabled=new Dn({func:519,mask:0},0,0,_a,_a,_a);const Kc=1029,Du=2305;class jn{constructor(s,d,m){this.enable=s,this.mode=d,this.frontFace=m}}function Kp(g,s){const d=o.c9(g,3);o.cb(g,s),o.cf(g,3,d)}function vd(g,s){const d=o.c6([]);return o.c7(d,d,-s),o.c8(d,d,-g),d}function Xc(g,s){const d=[g[0],g[1],0],m=[s[0],s[1],0];if(o.ag(d)>=1e-15){const S=o.aw([],d);o.c4(m,S,o.bJ(m,S)),s[0]=m[0],s[1]=m[1]}const v=o.bI([],s,g);if(o.c5(v)<1e-15)return null;const b=Math.atan2(-v[1],v[0]);return vd(Math.atan2(Math.sqrt(g[0]*g[0]+g[1]*g[1]),-g[2]),b)}jn.disabled=new jn(!1,Kc,Du),jn.backCCW=new jn(!0,Kc,Du),jn.backCW=new jn(!0,Kc,2304),jn.frontCW=new jn(!0,1028,2304),jn.frontCCW=new jn(!0,1028,Du);class Xp{constructor(s,d){this.position=s,this.orientation=d}get position(){return this._position}set position(s){if(s){const d=s instanceof o.ae?s:new o.ae(s[0],s[1],s[2]);this._renderWorldCopies&&(d.x=o.bT(d.x,0,1)),this._position=d}else this._position=null}lookAtPoint(s,d){if(this.orientation=null,!this.position)return;const m=this.position,v=this._elevation?this._elevation.getAtPointOrZero(o.ae.fromLngLat(s)):0,b=o.ae.fromLngLat(s,v),S=[b.x-m.x,b.y-m.y,b.z-m.z];d||(d=[0,0,1]),d[2]=Math.abs(d[2]),this.orientation=Xc(S,d)}setPitchBearing(s,d){this.orientation=vd(o.an(s),o.an(-d))}}class mf{constructor(s,d){this._transform=o.bA([]),this.orientation=d,this.position=s}get mercatorPosition(){const s=this.position;return new o.ae(s[0],s[1],s[2])}get position(){const s=o.c9(this._transform,3);return[s[0],s[1],s[2]]}set position(s){var d;s&&o.cf(this._transform,3,[(d=s)[0],d[1],d[2],1])}get orientation(){return this._orientation}set orientation(s){this._orientation=s||o.c6([]),s&&Kp(this._transform,this._orientation)}getPitchBearing(){const s=this.forward(),d=this.right();return{bearing:Math.atan2(-d[1],d[0]),pitch:Math.atan2(Math.sqrt(s[0]*s[0]+s[1]*s[1]),-s[2])}}setPitchBearing(s,d){this._orientation=vd(s,d),Kp(this._transform,this._orientation)}forward(){const s=o.c9(this._transform,2);return[-s[0],-s[1],-s[2]]}up(){const s=o.c9(this._transform,1);return[-s[0],-s[1],-s[2]]}right(){const s=o.c9(this._transform,0);return[s[0],s[1],s[2]]}getCameraToWorld(s,d){const m=new Float64Array(16);return o.bl(m,this.getWorldToCamera(s,d)),m}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(s,d,m){const v=this.position;o.c4(v,v,-s);const b=new Float64Array(16);return o.bq(b,[m,m,m]),o.br(b,b,v),b[10]*=d,b}getWorldToCamera(s,d){const m=new Float64Array(16),v=new Float64Array(4),b=this.position;return o.ca(v,this._orientation),o.c4(b,b,-s),o.cb(m,v),o.br(m,m,b),m[1]*=-1,m[5]*=-1,m[9]*=-1,m[13]*=-1,m[8]*=d,m[9]*=d,m[10]*=d,m[11]*=d,m}getCameraToClipPerspective(s,d,m,v){const b=new Float64Array(16);return o.cc(b,s,d,m,v),b}getCameraToClipOrthographic(s,d,m,v,b,S){const E=new Float64Array(16);return o.cd(E,s,d,m,v,b,S),E}getDistanceToElevation(s,d=!1){const m=s===0?0:o.ce(s,d?o.a$(this.position[1]):this.position[1]),v=this.forward();return(m-this.position[2])/v[2]}clone(){return new mf([...this.position],[...this.orientation])}}const Ro={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class Yp{constructor(s=0,d=0,m=0,v=0){if(isNaN(s)||s<0||isNaN(d)||d<0||isNaN(m)||m<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=d,this.left=m,this.right=v}interpolate(s,d,m){return d.top!=null&&s.top!=null&&(this.top=o.ak(s.top,d.top,m)),d.bottom!=null&&s.bottom!=null&&(this.bottom=o.ak(s.bottom,d.bottom,m)),d.left!=null&&s.left!=null&&(this.left=o.ak(s.left,d.left,m)),d.right!=null&&s.right!=null&&(this.right=o.ak(s.right,d.right,m)),this}getCenter(s,d){const m=o.aA((this.left+s-this.right)/2,0,s),v=o.aA((this.top+d-this.bottom)/2,0,d);return new o.P(m,v)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new Yp(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const mc=15;class ia{constructor(s,d,m,v,b,S,E){this.tileSize=512,this._renderWorldCopies=b===void 0||b,this._minZoom=s||0,this._maxZoom=d||22,this._minPitch=m??0,this._maxPitch=v??60,this.setProjection(S),this.setMaxBounds(E),this.width=0,this.height=0,this._center=new o.aR(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Yp,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new mf,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){const s=new ia(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return s._elevation=this._elevation,s._centerAltitude=this._centerAltitude,s._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,s.tileSize=this.tileSize,s.mercatorFromTransition=this.mercatorFromTransition,s.width=this.width,s.height=this.height,s.cameraElevationReference=this.cameraElevationReference,s._center=this._center,s._setZoom(this.zoom),s._seaLevelZoom=this._seaLevelZoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._nearZ=this._nearZ,s._farZ=this._farZ,s._averageElevation=this._averageElevation,s._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._camera=this._camera.clone(),s._calcMatrices(),s.freezeTileCoverage=this.freezeTileCoverage,s.frustumCorners=this.frustumCorners,s._allowWorldUnderZoom=this._allowWorldUnderZoom,s}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<mc}get elevation(){return this._elevation}set elevation(s){this._elevation!==s&&(this._elevation=s,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(s,d=!1){const m=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||m)&&this._updateCameraOnTerrain(),(s||m)&&this._constrainCamera(d),this._calcMatrices()}getProjection(){return o.aH(this.projection,["name","center","parallels"])}setProjection(s){this.projectionOptions=s||{name:"mercator"};const d=this.projection?this.getProjection():void 0;this.projection=o.cl(this.projectionOptions);const m=this.getProjection(),v=!o.by(d,m);return v&&this._calcMatrices(),this.mercatorFromTransition=!1,v}setOrthographicProjectionAtLowPitch(s){return this._orthographicProjectionAtLowPitch!==s&&(this._orthographicProjectionAtLowPitch=s,this._calcMatrices(),!0)}setMercatorFromTransition(){const s=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=o.cl({name:"mercator"});const d=s!==this.projection.name;return d&&this._calcMatrices(),d}get minZoom(){return this._minZoom}set minZoom(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}get maxZoom(){return this._maxZoom}set maxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}get minPitch(){return this._minPitch}set minPitch(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))}get maxPitch(){return this._maxPitch}set maxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const s=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get cameraWorldSize(){const s=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return o.ce(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this.width,this.height)}get bearing(){return o.bT(this.rotation,-180,180)}set bearing(s){this.rotation=s}get rotation(){return-this.angle/Math.PI*180}set rotation(s){const d=-s*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=o.cm(),o.cn(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(s){const d=o.aA(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=o.an(s),this._calcMatrices())}get fovX(){return this._fov}get fovY(){const s=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/s)}get averageElevation(){return this._averageElevation}set averageElevation(s){this._averageElevation=s,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(s){const d=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._setZoom(d),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(s){this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(s){this._tileCoverLift!==s&&(this._tileCoverLift=s)}_updateCameraOnTerrain(){const s=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,d=this.elevation&&s===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||s===Number.NEGATIVE_INFINITY&&(!d||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const m=this._elevation;d||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&m.exaggeration()&&this._centerAltitudeValidForExaggeration!==m.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*m.exaggeration(),this._centerAltitudeValidForExaggeration=m.exaggeration()):(this._centerAltitude=s||0,this._centerAltitudeValidForExaggeration=m.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){if(this._centerAltitudeValidForExaggeration===void 0)return;const s=Math.max(0,(this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize);this._seaLevelZoom=this._zoomFromMercatorZ(s)}sampleAverageElevation(){if(!this._elevation)return 0;const s=this._elevation,d=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],m=this.horizonLineFromTop();let v=0,b=0;for(let S=0;S<d.length;S++){const E=new o.P(d[S][0]*this.width,m+d[S][1]*(this.height-m)),k=s.pointCoordinate(E);if(!k)continue;const O=1/Math.hypot(k[0]-this._camera.position[0],k[1]-this._camera.position[1]);v+=k[3]*O,b+=O}return b===0?NaN:v/b}get center(){return this._center}set center(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const s=this._seaLevelZoom,d=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),m=this.pixelsPerMeter/this.worldSize*d,v=this._mercatorZfromZoom(s),b=this._mercatorZfromZoom(this._maxZoom),S=Math.max(v-m,b);this._setZoom(this._zoomFromMercatorZ(S))}get padding(){return this._edgeInsets.toJSON()}set padding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}computeZoomRelativeTo(s){const d=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,s.toAltitude()));let m;m=s.z<this._camera.position[2]?[d.x,d.y,d.z]:[s.x,s.y,s.z];const v=o.ag(o.av([],this._camera.position,m));return o.aA(this._zoomFromMercatorZ(v),this._minZoom,this._maxZoom)}setFreeCameraOptions(s){if(!this.height||!s.position&&!s.orientation)return;this._updateCameraState();let d=!1;if(s.orientation&&!o.co(s.orientation,this._camera.orientation)&&(d=this._setCameraOrientation(s.orientation)),s.position){const m=[s.position.x,s.position.y,s.position.z];o.cp(m,this._camera.position)||(this._setCameraPosition(m),d=!0)}d&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const s=this._camera.position,d=new Xp;return d.position=new o.ae(s[0],s[1],s[2]),d.orientation=this._camera.orientation,d._elevation=this.elevation,d._renderWorldCopies=this.renderWorldCopies,d}_setCameraOrientation(s){if(!o.cq(s))return!1;o.cr(s,s);const d=o.cs([],[0,0,-1],s),m=o.cs([],[0,-1,0],s);if(m[2]<0)return!1;const v=Xc(d,m);return!!v&&(this._camera.orientation=v,!0)}_setCameraPosition(s){const d=this.zoomScale(this.minZoom)*this.tileSize,m=this.zoomScale(this.maxZoom)*this.tileSize,v=this.cameraToCenterDistance;s[2]=o.aA(s[2],v/m,v/d),this._camera.position=s}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,d,m){this._unmodified=!1,this._edgeInsets.interpolate(s,d,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(s){const d=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(s){const d=[new o.ct(0,s)];if(this.renderWorldCopies){const m=this.pointCoordinate(new o.P(0,0)),v=this.pointCoordinate(new o.P(this.width,0)),b=this.pointCoordinate(new o.P(this.width,this.height)),S=this.pointCoordinate(new o.P(0,this.height)),E=Math.floor(Math.min(m.x,v.x,b.x,S.x)),k=Math.floor(Math.max(m.x,v.x,b.x,S.x)),O=1;for(let z=E-O;z<=k+O;z++)z!==0&&d.push(new o.ct(z,s))}return d}isLODDisabled(s){return(!s||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(s,d,m){let v=[];const b=m!=null,S=!b;if(S&&this.zoom<d||b&&m[0]===0&&m[1]===0)return v;const E=new Set,k=(z,U,F,H,G)=>{const W=o.cX(U,z,F,H,G);E.has(W)||(v.push(new o.aO(z,U,F,H,G)),E.add(W))};for(let z=0;z<s.length;z++){const U=s[z];if(S&&U.canonical.z!==d)continue;const F=U.canonical,H=U.overscaledZ,G=U.wrap,W=1<<F.z,ne=F.x+1<W,X=F.x>0,re=F.y+1<W,he=F.y>0,pe=U.wrap-(X?0:1),Ie=U.wrap+(ne?0:1),Se=X?F.x-1:W-1,Ae=ne?F.x+1:0;if(b)m[0]<0?(k(H,Ie,F.z,Ae,F.y),m[1]<0&&re&&(k(H,G,F.z,F.x,F.y+1),k(H,Ie,F.z,Ae,F.y+1)),m[1]>0&&he&&(k(H,G,F.z,F.x,F.y-1),k(H,Ie,F.z,Ae,F.y-1))):m[0]>0?(k(H,pe,F.z,Se,F.y),m[1]<0&&re&&(k(H,G,F.z,F.x,F.y+1),k(H,pe,F.z,Se,F.y+1)),m[1]>0&&he&&(k(H,G,F.z,F.x,F.y-1),k(H,pe,F.z,Se,F.y-1))):m[1]<0&&re?k(H,G,F.z,F.x,F.y+1):he&&k(H,G,F.z,F.x,F.y-1);else{const Ce=U.visibleQuadrants;1&Ce&&(k(H,pe,F.z,Se,F.y),he&&(k(H,G,F.z,F.x,F.y-1),k(H,pe,F.z,Se,F.y-1))),2&Ce&&(k(H,Ie,F.z,Ae,F.y),he&&(k(H,G,F.z,F.x,F.y-1),k(H,Ie,F.z,Ae,F.y-1))),4&Ce&&(k(H,pe,F.z,Se,F.y),re&&(k(H,G,F.z,F.x,F.y+1),k(H,pe,F.z,Se,F.y+1))),8&Ce&&(k(H,Ie,F.z,Ae,F.y),re&&(k(H,G,F.z,F.x,F.y+1),k(H,Ie,F.z,Ae,F.y+1)))}}const O=[];for(const z of v)v.some(U=>z.isChildOf(U))||O.push(z);if(v=O.filter(z=>!s.some(U=>!!(z.overscaledZ<d&&U.isChildOf(z))||z.equals(U)||z.isChildOf(U))),S){const z=1<<d,U=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),F=[z*U.x,z*U.y],H=4,G=H*H;v=v.filter(W=>{const ne=W.canonical.x+.5-F[0],X=W.canonical.y+.5-F[1];return ne*ne+X*X<G})}return v}extendTileCoverToNearPlane(s,d,m){const v=[],b=new Set;for(const re of s)b.add(re.key);const S=(re,he,pe,Ie,Se)=>{const Ae=o.cX(he,re,pe,Ie,Se);b.has(Ae)||(v.push(new o.aO(re,he,pe,Ie,Se)),b.add(Ae))},E=s.reduce((re,he)=>Math.max(re,he.overscaledZ),m),k=1<<m,O=[new o.P(0,0),new o.P(o.al,0),new o.P(o.al,o.al),new o.P(0,o.al)],z=new o.P(0,0),U=new o.P(0,0),F=(re,he)=>{const pe=Math.floor(re[0]),Ie=Math.floor(re[1]),Se=(re[0]-pe)*o.al,Ae=(re[1]-Ie)*o.al,Ce=Math.floor(he[0]),we=Math.floor(he[1]),ke=(he[0]-Ce)*o.al,nt=(he[1]-we)*o.al;for(let Ke=-1;Ke<=1;Ke++){const ht=pe+Ke;if(!(ht<0||ht>=k)){z.x=Se-Ke*o.al,U.x=ke-(ht-Ce)*o.al;for(let et=-1;et<=1;et++){const ut=Ie+et;z.y=Ae-et*o.al,U.y=nt-(ut-we)*o.al,o.cY(z,U,O)&&S(E,0,m,ht,ut)}}}},H=d.points,G=H[o.cu],W=H[o.cv],ne=this._projectToGround(G,H[o.cw]),X=this._projectToGround(W,H[o.cx]);return F(G,ne),F(W,X),v}_projectToGround(s,d){return o.cy(o.cz(),s,d,s[2]/(s[2]-d[2]))}coveringTiles(s){let d=this.coveringZoomLevel(s);const m=d,v=this.elevation&&this.elevation.exaggeration(),b=v&&!s.isTerrainDEM,S=this.projection.name==="mercator";if(s.minzoom!==void 0&&d<s.minzoom)return[];s.maxzoom!==void 0&&d>s.maxzoom&&(d=s.maxzoom);const E=this.locationCoordinate(this.center),k=this.center.lat,O=1<<d,z=[O*E.x,O*E.y,0],U=this.projection.name==="globe",F=!U,H=o.cA.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d,F),G=U?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),W=O*o.ce(1,this.center.lat),ne=this._camera.position[2]/o.ce(1,this.center.lat),X=[O*G.x,O*G.y,ne*(F?1:W)],re=U||v,he=this.cameraToCenterDistance/s.tileSize*(s.roundZoom?1:.502),pe=this.isLODDisabled(!0)?d:0;let Ie;if(this._elevation&&s.isTerrainDEM)Ie=1e4*this._elevation.exaggeration();else if(this._elevation){const Ue=this._elevation.getMinMaxForVisibleTiles();Ie=Ue?Ue.max:this._centerAltitude}else Ie=this._centerAltitude;const Se=s.isTerrainDEM?-Ie:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ae=this.projection.isReprojectedInTileSpace?o.cB(this):1,Ce=Ue=>{const ot=new o.ae(Ue.x+25e-6,Ue.y,Ue.z),Et=new o.ae(Ue.x,Ue.y+25e-6,Ue.z),$t=Ue.toLngLat(),rn=ot.toLngLat(),Lt=Et.toLngLat(),Rt=this.locationCoordinate($t),Cn=this.locationCoordinate(rn),yn=this.locationCoordinate(Lt),wn=Math.hypot(Cn.x-Rt.x,Cn.y-Rt.y),gn=Math.hypot(yn.x-Rt.x,yn.y-Rt.y);return Math.sqrt(wn*gn)*Ae/25e-6},we=Ue=>{const pt=Ie,ot=Se;return{aabb:o.cE(this,O,0,0,0,Ue,ot,pt,this.projection),zoom:0,x:0,y:0,minZ:ot,maxZ:pt,wrap:Ue,fullyVisible:!1}},ke=[];let nt=[];const Ke=d,ht=s.reparseOverscaled?m:d,et=(ne-this._centerAltitude)*W,ut=Ue=>{if(!this._elevation||!Ue.tileID||!S)return;const pt=this._elevation.getMinMaxForTile(Ue.tileID),ot=Ue.aabb;pt?(ot.min[2]=pt.min,ot.max[2]=pt.max,ot.center[2]=(ot.min[2]+ot.max[2])/2):(Ue.shouldSplit=tt(Ue),Ue.shouldSplit||(ot.min[2]=ot.max[2]=ot.center[2]=this._centerAltitude))},jt=(Ue,pt)=>{if(.707*pt<Ue)return 1;const ot=pt/Ue;return ot/(1.4144271570014144+(Math.pow(1.1,ot-1.4144271570014144+1)-1)/(1.1-1)-1)},tt=Ue=>{if(Ue.zoom<pe)return!0;if(Ue.zoom===Ke)return!1;if(Ue.shouldSplit!=null)return Ue.shouldSplit;const pt=Ue.aabb.distanceX(X),ot=Ue.aabb.distanceY(X);let Et=et,$t=1;if(U){Et=Ue.aabb.distanceZ(X);const gn=Math.pow(2,Ue.zoom),Wn=o.a$((Ue.y+1)/gn),ri=o.a$(Ue.y/gn),ci=Math.min(Math.max(k,Wn),ri),or=o.d0(ci)/o.d0(k);if($t=ci===k?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,or/this._mercatorScaleRatio),this.zoom<=o.cZ&&Ue.zoom===Ke-1&&or>=.9)return!0}else if(b&&(Et=Ue.aabb.distanceZ(X)*W),this.projection.isReprojectedInTileSpace&&m<=5){const gn=Math.pow(2,Ue.zoom),Wn=Ce(new o.ae((Ue.x+.5)/gn,(Ue.y+.5)/gn));$t=Wn>.85?1:Wn}if(!S){const gn=Math.sqrt(pt*pt+ot*ot+Et*Et);let Wn=(1<<Ke-Ue.zoom)*he*$t;return Wn*=jt(Math.max(Et,et),gn),gn<Wn}let rn=Number.MAX_VALUE,Lt=0;const Rt=Ue.aabb.getCorners(),Cn=[];for(const gn of Rt){o.av(Cn,gn,X),U||(b?Cn[2]*=W:Cn[2]=et);const Wn=o.bJ(Cn,this._camera.forward());Wn<rn&&(rn=Wn,Lt=Math.abs(Cn[2]))}let yn=(1<<Ke-Ue.zoom)*he*$t;if(yn*=jt(Math.max(Lt,et),rn),rn<yn)return!0;const wn=Ue.aabb.closestPoint(z);return wn[0]===z[0]&&wn[1]===z[1]};if(this.renderWorldCopies)for(let Ue=1;Ue<=3;Ue++)ke.push(we(-Ue)),ke.push(we(Ue));for(ke.push(we(0));ke.length>0;){const Ue=ke.pop(),pt=Ue.x,ot=Ue.y;let Et=Ue.fullyVisible;const $t=()=>this.projection.name==="globe"&&(Ue.y===0||Ue.y===(1<<Ue.zoom)-1);if(!Et){let rn=re?Ue.aabb.intersects(H):Ue.aabb.intersectsFlat(H);if(rn===0&&$t()){const Lt=new o.cC(Ue.zoom,pt,ot);rn=o.cD(this,O,Lt,!0).intersects(H)}if(rn===0)continue;Et=rn===2}if(Ue.zoom!==Ke&&tt(Ue))for(let rn=0;rn<4;rn++){const Lt=(pt<<1)+rn%2,Rt=(ot<<1)+(rn>>1),Cn={aabb:S?Ue.aabb.quadrant(rn):o.cE(this,O,Ue.zoom+1,Lt,Rt,Ue.wrap,Ue.minZ,Ue.maxZ,this.projection),zoom:Ue.zoom+1,x:Lt,y:Rt,wrap:Ue.wrap,fullyVisible:Et,tileID:void 0,shouldSplit:void 0,minZ:Ue.minZ,maxZ:Ue.maxZ};b&&!U&&(Cn.tileID=new o.aO(Ue.zoom+1===Ke?ht:Ue.zoom+1,Ue.wrap,Ue.zoom+1,Lt,Rt),ut(Cn)),ke.push(Cn)}else{const rn=Ue.zoom===Ke?ht:Ue.zoom;if(s.minzoom&&s.minzoom>rn)continue;let Lt=0;if(!Et){let wn=re?Ue.aabb.intersectsPrecise(H):Ue.aabb.intersectsPreciseFlat(H);if(wn===0&&$t()){const gn=new o.cC(Ue.zoom,pt,ot);wn=o.cD(this,O,gn,!0).intersectsPrecise(H)}if(wn===0)continue;if(s.calculateQuadrantVisibility)if(H.containsPoint(Ue.aabb.center))Lt=15;else for(let gn=0;gn<4;gn++)Ue.aabb.quadrant(gn).intersects(H)!==0&&(Lt|=1<<gn)}const Rt=z[0]-(.5+pt+(Ue.wrap<<Ue.zoom))*(1<<d-Ue.zoom),Cn=z[1]-.5-ot,yn=Ue.tileID?Ue.tileID:new o.aO(rn,Ue.wrap,Ue.zoom,pt,ot);s.calculateQuadrantVisibility&&(yn.visibleQuadrants=Lt),nt.push({tileID:yn,distanceSq:Rt*Rt+Cn*Cn})}}if(this.fogCullDistSq){const Ue=this.fogCullDistSq,pt=this.horizonLineFromTop();nt=nt.filter(ot=>{const Et=[0,0,0,1],$t=[o.al,o.al,0,1],rn=this.calculateFogTileMatrix(ot.tileID.toUnwrapped());o.aC(Et,Et,rn),o.aC($t,$t,rn);const Lt=o.cF([],Et,$t),Rt=o.cG([],Et,$t),Cn=o.c_(Lt,Rt);if(Cn===0)return!0;let yn=!1;const wn=this._elevation;if(wn&&Cn>Ue&&pt!==0){const gn=this.calculateProjMatrix(ot.tileID.toUnwrapped());let Wn;s.isTerrainDEM||(Wn=wn.getMinMaxForTile(ot.tileID)),Wn||(Wn={min:Se,max:Ie});const ri=o.cH(this.rotation),ci=[ri[0]*o.al,ri[1]*o.al,Wn.max];o.af(ci,ci,gn),yn=(1-ci[1])*this.height*.5<pt}return Cn<Ue||yn})}return nt.sort((Ue,pt)=>Ue.distanceSq-pt.distanceSq).map(Ue=>Ue.tileID)}resize(s,d){this.width=s,this.height=d,this.pixelsToGLUnits=[2/s,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(s){return Math.pow(2,s)}scaleZoom(s){return Math.log2(s)}project(s){const d=o.aA(s.lat,-o.cI,o.cI),m=this.projection.project(s.lng,d);return new o.P(m.x*this.worldSize,m.y*this.worldSize)}unproject(s){return this.projection.unproject(s.x/this.worldSize,s.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/o.ce(1,this.center.lat)/this.worldSize}setLocationAtPoint(s,d){let m,v;const b=this.centerPoint;if(this.projection.name==="globe"){const E=this.worldSize;m=(d.x-b.x)/E,v=(d.y-b.y)/E}else{const E=this.pointCoordinate(d),k=this.pointCoordinate(b);m=E.x-k.x,v=E.y-k.y}const S=this.locationCoordinate(s);this.setLocation(new o.ae(S.x-m,S.y-v))}setLocation(s){this.center=this.coordinateLocation(s),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(s,d){return this.projection.locationPoint(this,s,d)}locationPoint3D(s,d){return this.projection.locationPoint(this,s,d,!0)}pointLocation(s){return this.coordinateLocation(this.pointCoordinate(s))}pointLocation3D(s,d){return this.coordinateLocation(this.pointCoordinate3D(s,d))}locationCoordinate(s,d){const m=d?o.ce(d,s.lat):void 0,v=this.projection.project(s.lng,s.lat);return new o.ae(v.x,v.y,m)}coordinateLocation(s){return this.projection.unproject(s.x,s.y)}pointRayIntersection(s,d){const m=d??this._centerAltitude,v=[s.x,s.y,0,1],b=[s.x,s.y,1,1];o.aC(v,v,this.pixelMatrixInverse),o.aC(b,b,this.pixelMatrixInverse);const S=b[3];o.cJ(v,v,1/v[3]),o.cJ(b,b,1/S);const E=v[2],k=b[2];return{p0:v,p1:b,t:E===k?0:(m-E)/(k-E)}}screenPointToMercatorRay(s){const d=[s.x,s.y,0,1],m=[s.x,s.y,1,1];return o.aC(d,d,this.pixelMatrixInverse),o.aC(m,m,this.pixelMatrixInverse),o.cJ(d,d,1/d[3]),o.cJ(m,m,1/m[3]),d[2]=o.ce(d[2],this._center.lat)*this.worldSize,m[2]=o.ce(m[2],this._center.lat)*this.worldSize,o.cJ(d,d,1/this.worldSize),o.cJ(m,m,1/this.worldSize),new o.ax([d[0],d[1],d[2]],o.aw([],o.av([],m,d)))}rayIntersectionCoordinate(s){const{p0:d,p1:m,t:v}=s,b=o.ce(d[2],this._center.lat),S=o.ce(m[2],this._center.lat);return new o.ae(o.ak(d[0],m[0],v)/this.worldSize,o.ak(d[1],m[1],v)/this.worldSize,o.ak(b,S,v))}pointCoordinate(s,d=this._centerAltitude){return this.projection.pointCoordinate(this,s.x,s.y,d)}pointCoordinate3D(s,d){if(!this.elevation)return this.pointCoordinate(s,d);let m=this.projection.pointCoordinate3D(this,s.x,s.y);if(m)return new o.ae(m[0],m[1],m[2]);let v=0,b=this.horizonLineFromTop();if(s.y>b)return this.pointCoordinate(s,d);const S=.02*b,E=s.clone();for(let k=0;k<10&&b-v>S;k++){E.y=o.ak(v,b,.66);const O=this.projection.pointCoordinate3D(this,E.x,E.y);O?(b=E.y,m=O):v=E.y}return m?new o.ae(m[0],m[1],m[2]):this.pointCoordinate(s)}isPointAboveHorizon(s){return this.projection.isPointAboveHorizon(this,s)}isPointOnSurface(s){if(s.y<0||s.y>this.height||s.x<0||s.x>this.width)return!1;if(this.elevation||this.zoom>=o.cK)return!this.isPointAboveHorizon(s);const d=this.pointCoordinate(s);return d.y>=0&&d.y<=1}_coordinatePoint(s,d){const m=d&&this.elevation?this.elevation.getAtPointOrZero(s,this._centerAltitude):this._centerAltitude,v=[s.x*this.worldSize,s.y*this.worldSize,m+s.toAltitude(),1];return o.aC(v,v,this.pixelMatrix),v[3]>0?new o.P(v[0]/v[3],v[1]/v[3]):new o.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:s,left:d}=this._edgeInsets,m=this.height-this._edgeInsets.bottom,v=this.width-this._edgeInsets.right,b=this.pointLocation3D(new o.P(d,s)),S=this.pointLocation3D(new o.P(v,s)),E=this.pointLocation3D(new o.P(v,m)),k=this.pointLocation3D(new o.P(d,m));let O=Math.min(b.lng,S.lng,E.lng,k.lng),z=Math.max(b.lng,S.lng,E.lng,k.lng),U=Math.min(b.lat,S.lat,E.lat,k.lat),F=Math.max(b.lat,S.lat,E.lat,k.lat);const H=Math.pow(2,-this.zoom)/16*270,G=this.projection.name==="globe"?1:4,W=(ne,X,re,he,pe)=>{const Ie=(ne+re)/2,Se=(X+he)/2,Ae=new o.P(Ie,Se),{lng:Ce,lat:we}=this.pointLocation3D(Ae),ke=Math.max(0,O-Ce,U-we,Ce-z,we-F);O=Math.min(O,Ce),z=Math.max(z,Ce),U=Math.min(U,we),F=Math.max(F,we),(pe<G||ke>H)&&(W(ne,X,Ie,Se,pe+1),W(Ie,Se,re,he,pe+1))};if(W(d,s,v,s,1),W(v,s,v,m,1),W(v,m,d,m,1),W(d,m,d,s,1),this.projection.name==="globe"){const[ne,X]=o.cL(this);ne?(F=90,z=180,O=-180):X&&(U=-90,z=180,O=-180)}return new o.aI(new o.aR(O,U),new o.aR(z,F))}_getBoundsRectangular(s,d){const{top:m,left:v}=this._edgeInsets,b=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,E=new o.P(v,m),k=new o.P(S,m),O=new o.P(S,b),z=new o.P(v,b);let U=this.pointCoordinate(E,s),F=this.pointCoordinate(k,s);const H=this.pointCoordinate(O,d),G=this.pointCoordinate(z,d),W=(ne,X)=>(X.y-ne.y)/(X.x-ne.x);return U.y>1&&F.y>=0?U=new o.ae((1-G.y)/W(G,U)+G.x,1):U.y<0&&F.y<=1&&(U=new o.ae(-G.y/W(G,U)+G.x,0)),F.y>1&&U.y>=0?F=new o.ae((1-H.y)/W(H,F)+H.x,1):F.y<0&&U.y<=1&&(F=new o.ae(-H.y/W(H,F)+H.x,0)),new o.aI().extend(this.coordinateLocation(U)).extend(this.coordinateLocation(F)).extend(this.coordinateLocation(G)).extend(this.coordinateLocation(H))}_getBoundsRectangularTerrain(){const s=this.elevation;if(!s.visibleDemTiles.length||s.isUsingMockSource())return this._getBoundsRectangular(0,0);const d=s.visibleDemTiles.reduce((m,v)=>{if(v.dem){const b=v.dem.tree;m.min=Math.min(m.min,b.minimums[0]),m.max=Math.max(m.max,b.maximums[0])}return m},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(d.min*s.exaggeration(),d.max*s.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(s=!0){const d=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,m=this.height/2-d*(1-this._horizonShift);return s?Math.max(0,m):m}getMaxBounds(){return this.maxBounds}setMaxBounds(s){this.maxBounds=s,this.minLat=-o.cI,this.maxLat=o.cI,this.minLng=-180,this.maxLng=180,s&&(this.minLat=s.getSouth(),this.maxLat=s.getNorth(),this.minLng=s.getWest(),this.maxLng=s.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=o.aF(this.minLng)*this.tileSize,this.worldMaxX=o.aF(this.maxLng)*this.tileSize,this.worldMinY=o.aJ(this.maxLat)*this.tileSize,this.worldMaxY=o.aJ(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(s,d){return this.projection.createTileMatrix(this,d,s)}calculateDistanceTileData(s){const d=s.key,m=this._distanceTileDataCache;if(m[d])return m[d];const v=s.canonical,b=1/this.height,S=this.cameraWorldSize,E=S/this.zoomScale(v.z),k=(v.x+Math.pow(2,v.z)*s.wrap)*E,O=v.y*E,z=this.point;z.x*=S/this.worldSize,z.y*=S/this.worldSize;const U=this.angle,F=Math.sin(-U),H=-Math.cos(-U);return m[d]={bearing:[F,H],center:[(z.x-k)*b,(z.y-O)*b],scale:E/o.al*b},m[d]}calculateFogTileMatrix(s){const d=s.key,m=this._fogTileMatrixCache;if(m[d])return m[d];const v=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,s);return o.aB(v,this.worldToFogMatrix,v),m[d]=new Float32Array(v),m[d]}calculateProjMatrix(s,d=!1,m=!1){const v=s.key;let b;if(b=m?this._expandedProjMatrixCache:d?this._alignedProjMatrixCache:this._projMatrixCache,b[v])return b[v];const S=this.calculatePosMatrix(s,this.worldSize);let E;return E=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:m?this.expandedFarZProjMatrix:d?this.alignedProjMatrix:this.projMatrix,o.aB(S,E,S),b[v]=new Float32Array(S),b[v]}calculatePixelsToTileUnitsMatrix(s){const d=s.tileID.key,m=this._pixelsToTileUnitsCache;if(m[d])return m[d];const v=o.cM(s,this);return m[d]=v,m[d]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const s=1/this.worldSize,d=o.bq([],[s,s,s]);return o.aB(d,d,this.globeMatrix),d}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const s=this._elevation;this._updateCameraState();const d=o.ce(1,this._center.lat)*this.worldSize,m=this._computeCameraPosition(d),v=this._camera.forward(),b=o.ce(1,this._center.lat);m[2]/=b,v[2]/=b,o.aw(v,v);const S=s.raycast(m,v,s.exaggeration());if(S){const E=o.bH([],m,v,S),k=new o.ae(E[0],E[1],o.ce(E[2],o.a$(E[1]))),O=(k.z+o.ag([k.x-m[0],k.y-m[1],k.z-m[2]*b]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(O),this._centerAltitude=k.toAltitude(),this._center=this.coordinateLocation(k),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(s=!1){if(!this._elevation)return;const d=this._elevation,m=o.ce(1,this._center.lat)*this.worldSize,v=this._computeCameraPosition(m),b=d.getAtPointOrZero(new o.ae(...v)),S=this.pixelsPerMeter/this.worldSize*b,E=this._minimumHeightOverTerrain(),k=v[2]-S;if(k<=E)if(k<0||s){const O=this.locationCoordinate(this._center,this._centerAltitude),z=[v[0],v[1],O.z-v[2]],U=o.ag(z);z[2]-=(E-k)/this._pixelsPerMercatorPixel;const F=o.ag(z);if(F===0)return;o.c4(z,z,U/F*this._pixelsPerMercatorPixel),this._camera.position=[v[0],v[1],O.z*this._pixelsPerMercatorPixel-z[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const s=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||s){const F=this.center;return F.lat=o.aA(F.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!s)&&(F.lng=o.aA(F.lng,this.minLng,this.maxLng)),this.center=F,void(this._constraining=!1)}const d=this._unmodified,{x:m,y:v}=this.point;let b=0,S=m,E=v;const k=this.width/2,O=this.height/2,z=this.worldMinY*this.scale,U=this.worldMaxY*this.scale;if(v-O<z&&(E=z+O),v+O>U&&(E=U-O),U-z<this.height&&(b=Math.max(b,this.height/(U-z)),E=(U+z)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const F=this.worldMinX*this.scale,H=this.worldMaxX*this.scale,G=this.worldSize/2-(F+H)/2;S=(m+G+this.worldSize)%this.worldSize-G,S-k<F&&(S=F+k),S+k>H&&(S=H-k),H-F<this.width&&(b=Math.max(b,this.width/(H-F)),S=(H+F)/2)}S===m&&E===v||this._allowWorldUnderZoom||(this.center=this.unproject(new o.P(S,E))),b&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(b)),this._constrainCamera(),this._unmodified=d,this._constraining=!1}_minZoomForBounds(){let s=Math.max(0,this.scaleZoom(Math.max(0,this.height)/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(s=Math.max(s,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),s}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const s=this.centerOffset,d=this.projection.name==="globe",m=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=o.ce(1,this.center.lat)/o.ce(1,o.d1));const v=o.cN(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,v),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const b=this.projection.zAxisUnit==="meters"?m:1,S=this._camera.getWorldToCamera(this.worldSize,b);let E;const k=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(k[8]=2*-s.x/this.width,k[9]=2*s.y/this.height,this.isOrthographic){let we=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),ke=we*this.aspect,nt=-ke,Ke=-we;ke-=s.x,nt-=s.x,we+=s.y,Ke+=s.y,E=this._camera.getCameraToClipOrthographic(nt,ke,Ke,we,this._nearZ,this._farZ),((ht,et,ut,jt)=>{for(let tt=0;tt<16;tt++)ht[tt]=o.ak(et[tt],ut[tt],jt)})(E,E,k,o.c$(this.pitch>=mc?1:this.pitch/mc))}else E=k;const O=o.cO([],k,S);let z=o.cO([],E,S);if(this.projection.isReprojectedInTileSpace){const we=this.locationCoordinate(this.center),ke=o.bA([]);o.br(ke,ke,[we.x*this.worldSize,we.y*this.worldSize,0]),o.aB(ke,ke,o.cP(this)),o.br(ke,ke,[-we.x*this.worldSize,-we.y*this.worldSize,0]),o.aB(z,z,ke),o.aB(O,O,ke),this.inverseAdjustmentMatrix=o.cQ(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=o.cR([],z,[this.worldSize,this.worldSize,this.worldSize/b,1]),this.projMatrix=z,this.invProjMatrix=o.bl(new Float64Array(16),this.projMatrix),d){const we=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);we[8]=2*-s.x/this.width,we[9]=2*s.y/this.height,this.expandedFarZProjMatrix=o.cO([],we,S)}else this.expandedFarZProjMatrix=this.projMatrix;const U=o.bl([],E);this.frustumCorners=o.cS.fromInvProjectionMatrix(U,this.horizonLineFromTop(),this.height),this.cameraFrustum=o.cA.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!d);const F=new Float32Array(16);o.bA(F),o.cR(F,F,[1,-1,1]),o.cT(F,F,this._pitch),o.bB(F,F,this.angle);const H=o.cc(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=o.bz(H);const G=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;H[8]=2*-s.x/this.width,H[9]=2*(s.y+G)/this.height,this.skyboxMatrix=o.aB(F,H,F);const W=this.point,ne=W.x,X=W.y,re=this.width%2/2,he=this.height%2/2,pe=Math.cos(this.angle),Ie=Math.sin(this.angle),Se=ne-Math.round(ne)+pe*re+Ie*he,Ae=X-Math.round(X)+pe*he+Ie*re,Ce=new Float64Array(z);if(o.br(Ce,Ce,[Se>.5?Se-1:Se,Ae>.5?Ae-1:Ae,0]),this.alignedProjMatrix=Ce,z=o.bC(),o.cR(z,z,[this.width/2,-this.height/2,1]),o.br(z,z,[1,-1,0]),this.labelPlaneMatrix=z,z=o.bC(),o.cR(z,z,[1,-1,1]),o.br(z,z,[-1,-1,0]),o.cR(z,z,[2/this.width,2/this.height,1]),this.glCoordMatrix=z,this.pixelMatrix=o.aB(new Float64Array(16),this.labelPlaneMatrix,O),this._calcFogMatrices(),this._distanceTileDataCache={},z=o.bl(new Float64Array(16),this.pixelMatrix),!z)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=z,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=o.cU(this);const we=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=o.af(we,we,S),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=z;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const s=this.cameraWorldSizeForFog,d=this.cameraPixelsPerMeter,m=this._camera.position,v=1/this.height/this._pixelsPerMercatorPixel,b=[s,s,d];o.c4(b,b,v),o.c4(m,m,-1),o.cV(m,m,b);const S=o.bC();o.br(S,S,m),o.cR(S,S,b),this.mercatorFogMatrix=S,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(s,d,v)}_computeCameraPosition(s){const d=(s=s||this.pixelsPerMeter)/this.pixelsPerMeter,m=this._camera.forward(),v=this.point,b=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*d-s/this.worldSize*this._centerAltitude;return[v.x/this.worldSize-m[0]*b,v.y/this.worldSize-m[1]*b,s/this.worldSize*this._centerAltitude-m[2]*b]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(s){const d=this._maxCameraBoundsDistance()*Math.cos(this._pitch),m=this._camera.position[2],v=s[2];let b=1;this.projection.wrap&&(this.center=this.center.wrap()),v>0&&(b=Math.min((d-m)/v,1)),this._camera.position=o.bH([],this._camera.position,s,b),this._updateStateFromCamera()}_updateStateFromCamera(){const s=this._camera.position,d=this._camera.forward(),{pitch:m,bearing:v}=this._camera.getPitchBearing(),b=o.ce(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,S=this._mercatorZfromZoom(this._maxZoom)*Math.cos(o.an(this._maxPitch)),E=Math.max((s[2]-b)/Math.cos(m),S),k=this._zoomFromMercatorZ(E);o.bH(s,s,d,E),this._pitch=o.aA(m,o.an(this.minPitch),o.an(this.maxPitch)),this.angle=o.bT(v,-Math.PI,Math.PI),this._setZoom(o.aA(k,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new o.ae(s[0],s[1],s[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(s){return Math.pow(2,s)*this.tileSize}_mercatorZfromZoom(s){return this.cameraToCenterDistance/this._worldSizeFromZoom(s)}_minimumHeightOverTerrain(){const s=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(s)}_zoomFromMercatorZ(s){return this.scaleZoom(this.cameraToCenterDistance/(Math.max(0,s)*this.tileSize))}zoomFromMercatorZAdjusted(s){let d=0,m=o.cK,v=0,b=1/0;for(;m-d>1e-6&&m>d;){const S=d+.5*(m-d),E=this.tileSize*Math.pow(2,S),k=this.getCameraToCenterDistance(this.projection,S,E),O=this.scaleZoom(k/(Math.max(0,s)*this.tileSize)),z=Math.abs(S-O);z<b&&(b=z,v=S),S<O?d=S:m=S}return v}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(o.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(s,d){const m=Math.min(s.x,d.x),v=Math.max(s.x,d.x),b=Math.min(s.y,d.y),S=Math.max(s.y,d.y);if(b<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const E=[new o.P(m,b),new o.P(v,S),new o.P(m,S),new o.P(v,b)],k=this.renderWorldCopies?-3:0,O=this.renderWorldCopies?4:1;for(const z of E){const U=this.pointRayIntersection(z);if(U.t<0)return!0;const F=this.rayIntersectionCoordinate(U);if(F.x<k||F.y<0||F.x>O||F.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+o.cW(this.fovAboveCenter)>88||this.anyCornerOffEdge(new o.P(0,0),new o.P(this.width,this.height))}zoomDeltaToMovement(s,d){const m=o.ag(o.av([],this._camera.position,s)),v=this._zoomFromMercatorZ(m)+d;return m-this._mercatorZfromZoom(v)}getCameraPoint(){if(this.projection.name==="globe"){const s=function([d,m,v],b){const S=[d,m,v,1];o.aC(S,S,b);const E=S[3]=Math.max(S[3],1e-6);return S[0]/=E,S[1]/=E,S[2]/=E,S}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new o.P(s[0],s[1])}{const s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(0,s))}}getCameraToCenterDistance(s,d=this.zoom,m=this.worldSize){const v=o.cN(s,d,this.width,this.height,1024),b=s.pixelSpaceConversion(this.center.lat,m,v);let S=.5/Math.tan(.5*this._fov)*this.height*b;return this.isOrthographic&&(S=o.ak(1,S,o.c$(this.pitch>=mc?1:this.pitch/mc))),S}getWorldToCameraMatrix(){const s=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&o.aB(s,s,this.globeMatrix),s}getFrustum(s){return o.cA.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s,this.projection.zAxisUnit==="meters")}}const gc=(g,s)=>{if(s>0&&g.terrain&&o.w("Cutoff is currently disabled on terrain"),s<=0||g.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const d=g.transform,m=Math.max(Math.abs(d._zoom-(g.minCutoffZoom-1)),1),v=d.isLODDisabled(!1)?o.ah(60,45,d.pitch):o.ah(30,15,d.pitch),b=d._farZ-d._nearZ,S=s*d.height,E=((1-(k=v))*d.cameraToCenterDistance+k*(d._farZ+S))*m;var k;return{shouldRenderCutoff:v<1,uniformValues:{u_cutoff_params:[d._nearZ,d._farZ,(E-d._nearZ)/b,(E-S-d._nearZ)/b]}}},Rs={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class uh{constructor(s,d){this.aabb=s,this.lastCascade=d}}class bd{add(s,d){const m=this.receivers[s.key];m!==void 0?(m.aabb.min[0]=Math.min(m.aabb.min[0],d.min[0]),m.aabb.min[1]=Math.min(m.aabb.min[1],d.min[1]),m.aabb.min[2]=Math.min(m.aabb.min[2],d.min[2]),m.aabb.max[0]=Math.max(m.aabb.max[0],d.max[0]),m.aabb.max[1]=Math.max(m.aabb.max[1],d.max[1]),m.aabb.max[2]=Math.max(m.aabb.max[2],d.max[2])):this.receivers[s.key]=new uh(d,null)}clear(){this.receivers={}}get(s){return this.receivers[s.key]}computeRequiredCascades(s,d,m){const v=o.d8.fromPoints(s.points);let b=0;for(const S in this.receivers){const E=this.receivers[S];if(!E||!v.intersectsAabb(E.aabb))continue;E.aabb.min=v.closestPoint(E.aabb.min),E.aabb.max=v.closestPoint(E.aabb.max);const k=E.aabb.getCorners();for(let O=0;O<m.length;O++){let z=!0;for(const U of k){const F=[U[0]*d,U[1]*d,U[2]];if(o.af(F,F,m[O].matrix),F[0]<-1||F[0]>1||F[1]<-1||F[1]>1){z=!1;break}}if(E.lastCascade=O,b=Math.max(b,O),z)break}}return b+1}}class Jp{constructor(s){this.painter=s,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new bd,this._depthMode=new sn(s.context.gl.LEQUAL,sn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,s.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),s.tp.registerParameter(Rs,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),s.tp.registerParameter(Rs,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),s.tp.registerParameter(Rs,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),s.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const s of this._cascades)s.texture.destroy(),s.framebuffer.destroy();this._cascades=[]}updateShadowParameters(s,d){const m=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!d||!d.properties)return;const v=d.properties.get("shadow-intensity");if(!d.shadowsEnabled()||v<=0||(this._shadowLayerCount=m.style.order.reduce((G,W)=>{const ne=m.style._mergedLayers[W];return G+(ne.hasShadowPass()&&!ne.isHidden(s.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const b=m.context,S=Rs.shadowMapResolution,E=Rs.shadowMapResolution;if(this._cascades.length===0||Rs.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let G=0;G<Rs.cascadeCount;++G){const W=m._shadowMapDebug,ne=b.gl,X=b.createFramebuffer(S,E,W,"texture"),re=new o.T(b,{width:S,height:E,data:null},ne.DEPTH_COMPONENT16);if(X.depthAttachment.set(re.texture),W){const he=new o.T(b,{width:S,height:E,data:null},ne.RGBA8);X.colorAttachment.set(he.texture)}this._cascades.push({framebuffer:X,texture:re,matrix:[],far:0,boundingSphereRadius:0,frustum:new o.cA,scale:0})}}this.shadowDirection=xd(d);let k=0;if(s.elevation){const G=s.elevation,W=[1e4,-1e4];G.visibleDemTiles.filter(ne=>ne.dem).forEach(ne=>{const X=ne.dem.tree;W[0]=Math.min(W[0],X.minimums[0]),W[1]=Math.max(W[1],X.maximums[0])}),W[0]!==1e4&&(k=(W[1]-W[0])*G.exaggeration())}const O=1.5*s.cameraToCenterDistance,z=3*O,U=new Float64Array(16);for(let G=0;G<this._cascades.length;++G){const W=this._cascades[G];let ne=s.height/50,X=1;Rs.cascadeCount===1?X=z:G===0?X=O:(ne=O,X=z);const[re,he]=kg(s,this.shadowDirection,ne,X,Rs.shadowMapResolution,k);W.scale=s.scale,W.matrix=re,W.boundingSphereRadius=he,o.bl(U,W.matrix),W.frustum=o.cA.fromInvProjectionMatrix(U,1,0,!0),W.far=X}const F=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[F].far,this._cascades[F].far],this._uniformValues.u_shadow_intensity=v,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Rs.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Rs.shadowMapResolution,this._uniformValues.u_shadowmap_0=Ro.ShadowMap0,this._uniformValues.u_shadowmap_1=Ro.ShadowMap0+1,this._groundShadowTiles=m.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const H=m.transform.elevation;for(const G of this._groundShadowTiles){let W={min:0,max:0};if(H){const ne=H.getMinMaxForTile(G);ne&&(W=ne)}this.addShadowReceiver(G.toUnwrapped(),W.min,W.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(s){this._enabled=s}drawShadowPass(s,d){if(!this.enabled)return;const m=this.painter,v=m.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(m.transform.getFrustum(0),m.transform.worldSize,this._cascades),v.viewport.set([0,0,Rs.shadowMapResolution,Rs.shadowMapResolution]);for(let b=0;b<this._numCascadesToRender;++b){m.currentShadowCascade=b,v.bindFramebuffer.set(this._cascades[b].framebuffer.framebuffer),v.clear({color:o.ao.white,depth:1});for(const S of s.order){const E=s._mergedLayers[S];if(!E.hasShadowPass()||E.isHidden(m.transform.zoom))continue;const k=s.getLayerSourceCache(E),O=k?d[k.id]:void 0;(E.type==="model"||O&&O.length)&&m.renderLayer(m,k,E,O)}}m.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const s=this.painter,d=s.style,m=s.context,v=m.gl,b=d.directionalLight,S=d.ambientLight;if(!b||!S)return;const E=[],k=gc(s,s.longestCutoffRange);k.shouldRenderCutoff&&E.push("RENDER_CUTOFF"),E.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&E.push("NORMAL_OFFSET");const O=Al(d,b,S),z=new sn(v.LEQUAL,sn.ReadOnly,s.depthRangeFor3D),U=new Dn({func:v.EQUAL,mask:255},0,255,v.KEEP,v.KEEP,v.KEEP);for(const F of this._groundShadowTiles){const H=F.toUnwrapped(),G=s.isTileAffectedByFog(F),W=s.getOrCreateProgram("groundShadow",{defines:E,overrideFog:G});this.setupShadows(H,W),s.uploadCommonUniforms(m,W,H,null,k);const ne={u_matrix:s.transform.calculateProjMatrix(H),u_ground_shadow_factor:O};W.draw(s,v.TRIANGLES,z,U,ti.multiply,jn.disabled,ne,"ground_shadow",s.tileExtentBuffer,s.quadTriangleIndexBuffer,s.tileExtentSegments,null,s.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?ti.unblended:ti.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(s){const d=this.painter.transform,m=d.calculatePosMatrix(s,d.worldSize);return o.aB(m,this._cascades[this.painter.currentShadowCascade].matrix,m),Float32Array.from(m)}calculateShadowPassMatrixFromMatrix(s){return o.aB(s,this._cascades[this.painter.currentShadowCascade].matrix,s),Float32Array.from(s)}setupShadows(s,d,m){if(!this.enabled)return;const v=this.painter.transform,b=this.painter.context,S=b.gl,E=this._uniformValues,k=new Float64Array(16),O=v.calculatePosMatrix(s,v.worldSize);for(let z=0;z<this._cascades.length;z++)o.aB(k,this._cascades[z].matrix,O),E[z===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(k),b.activeTexture.set(S.TEXTURE0+Ro.ShadowMap0+z),this._cascades[z].texture.bindExtraParam(S.LINEAR,S.LINEAR,S.CLAMP_TO_EDGE,S.CLAMP_TO_EDGE,S.GREATER);if(this.useNormalOffset=!!m,this.useNormalOffset){const z=o.d6(s.canonical),U=2/v.tileSize*o.al/Rs.shadowMapResolution,F=U*this._cascades[0].boundingSphereRadius,H=U*this._cascades[this._cascades.length-1].boundingSphereRadius,G=(m==="vector-tile"?1:3)*function(W,ne,X,re,he){const pe=o.aA((W-22)/-22,0,1);return .125*(1-pe)+4*pe}(v.zoom);E.u_shadow_normal_offset=[z,F*G,H*G],E.u_shadow_bias=[1e-4,.0012,.012]}else E.u_shadow_bias=[36e-5,.0012,.012];d.setShadowUniformValues(b,E)}setupShadowsFromMatrix(s,d,m=!1){if(!this.enabled)return;const v=this.painter.context,b=v.gl,S=this._uniformValues,E=new Float64Array(16);for(let k=0;k<Rs.cascadeCount;k++)o.aB(E,this._cascades[k].matrix,s),S[k===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(E),v.activeTexture.set(b.TEXTURE0+Ro.ShadowMap0+k),this._cascades[k].texture.bindExtraParam(b.LINEAR,b.LINEAR,b.CLAMP_TO_EDGE,b.CLAMP_TO_EDGE,b.GREATER);if(this.useNormalOffset=m,m){const k=Rs.normalOffset;S.u_shadow_normal_offset=[1,k,k],S.u_shadow_bias=[6e-5,.0012,.012]}else S.u_shadow_bias=[36e-5,.0012,.012];d.setShadowUniformValues(v,S)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(s,d,m,v){if(v[2]>=0)return{};const b=function(k,O,z){const U=z/(1<<k.canonical.z);return new o.d8([k.canonical.x*U+k.wrap*z,k.canonical.y*U+k.wrap*z,0],[(k.canonical.x+1)*U+k.wrap*z,(k.canonical.y+1)*U+k.wrap*z,O])}(s,d,m).getCorners(),S=d/-v[2];v[0]<0?(o.d7(b[0],b[0],[v[0]*S,0,0]),o.d7(b[3],b[3],[v[0]*S,0,0])):v[0]>0&&(o.d7(b[1],b[1],[v[0]*S,0,0]),o.d7(b[2],b[2],[v[0]*S,0,0])),v[1]<0?(o.d7(b[0],b[0],[0,v[1]*S,0]),o.d7(b[1],b[1],[0,v[1]*S,0])):v[1]>0&&(o.d7(b[2],b[2],[0,v[1]*S,0]),o.d7(b[3],b[3],[0,v[1]*S,0]));const E={};return E.vertices=b,E.planes=[ya(b[1],b[0],b[4]),ya(b[2],b[1],b[5]),ya(b[3],b[2],b[6]),ya(b[0],b[3],b[7])],E}addShadowReceiver(s,d,m){this._receivers.add(s,o.d8.fromTileIdAndHeight(s,d,m))}getMaxCascadeForTile(s){const d=this._receivers.get(s);return d&&d.lastCascade?d.lastCascade:0}}function ya(g,s,d){const m=o.av([],d,s),v=o.av([],g,s),b=o.bI([],m,v),S=o.ag(b);return S===0?[0,0,1,0]:(o.c4(b,b,1/S),[b[0],b[1],b[2],-o.bJ(b,s)])}function xd(g){const s=g.properties.get("direction"),d=o.d3(s.x,s.y,s.z);d[2]=o.aA(d[2],0,75);const m=o.d5([d[0],d[1],d[2]]);return o.d4(m.x,m.y,m.z)}function Al(g,s,d){const m=s.properties.get("color-use-theme")==="none",v=s.properties.get("color"),b=s.properties.get("intensity"),S=s.properties.get("direction"),E=[S.x,S.y,S.z],k=d.properties.get("color-use-theme")==="none",O=d.properties.get("color"),z=d.properties.get("intensity"),U=Math.max(o.bJ([0,0,1],E),0),F=[0,0,0];o.c4(F,O.toPremultipliedRenderColor(k?null:g.getLut(s.scope)).toArray01Linear().slice(0,3),z);const H=[0,0,0];return o.c4(H,v.toPremultipliedRenderColor(m?null:g.getLut(d.scope)).toArray01Linear().slice(0,3),U*b),o.da([F[0]>0?F[0]/(F[0]+H[0]):0,F[1]>0?F[1]/(F[1]+H[1]):0,F[2]>0?F[2]/(F[2]+H[2]):0])}function kg(g,s,d,m,v,b){const S=g.zoom,E=g.scale,k=g.worldSize,O=1/k,z=g.aspect,U=Math.sqrt(1+z*z)*Math.tan(.5*g.fovX),F=U*U,H=m-d,G=m+d;let W,ne;F>H/G?(W=m,ne=m*U):(W=.5*G*(1+F),ne=.5*Math.sqrt(H*H+2*(m*m+d*d)*F+G*G*F*F));const X=g.projection.pixelsPerMeter(g.center.lat,k),re=g._camera.getCameraToWorldMercator(),he=[0,0,-W*O];o.af(he,he,re);let pe=ne*O;const Ie=g._edgeInsets;if(!(Ie.left===0&&Ie.top===0&&Ie.right===0&&Ie.bottom===0||Ie.left===Ie.right&&Ie.top===Ie.bottom)){const Et=g._camera.getWorldToCamera(g.worldSize,g.projection.zAxisUnit==="meters"?X:1),$t=g._camera.getCameraToClipPerspective(g._fov,g.width/g.height,d,m);$t[8]=2*-g.centerOffset.x/g.width,$t[9]=2*g.centerOffset.y/g.height;const rn=new Float64Array(16);o.cO(rn,$t,Et);const Lt=new Float64Array(16);o.bl(Lt,rn);const Rt=o.cA.fromInvProjectionMatrix(Lt,k,S,!0);for(const Cn of Rt.points){const yn=((Se=Cn)[0]/=E,Se[1]/=E,Se[2]=o.ce(Se[2],g._center.lat),Se);pe=Math.max(pe,o.c5(o.d9([],he,yn)))}}var Se;pe*=v/(v-1);const Ae=Math.acos(s[2]),Ce=Math.atan2(-s[0],-s[1]),we=new mf;we.position=he,we.setPitchBearing(Ae,Ce);const ke=we.getWorldToCamera(k,X),nt=pe*k,Ke=Math.min(g._mercatorZfromZoom(17)*k*-2,-2*nt),ht=we.getCameraToClipOrthographic(-nt,nt,-nt,nt,Ke,(nt+b*X)/s[2]),et=new Float64Array(16);o.aB(et,ht,ke);const ut=o.d4(Math.floor(1e6*he[0])/1e6*k,Math.floor(1e6*he[1])/1e6*k,0),jt=.5*v,tt=[0,0,0];o.af(tt,ut,et),o.c4(tt,tt,jt);const Ue=[Math.floor(tt[0]),Math.floor(tt[1]),Math.floor(tt[2])],pt=[0,0,0];o.av(pt,tt,Ue),o.c4(pt,pt,-1/jt);const ot=new Float64Array(16);return o.bA(ot),o.br(ot,ot,pt),o.aB(et,ot,et),[et,nt]}class Ou extends o.E{constructor(s){super(),this.requestManager=s,this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}loadModel(s,d){return o.aV(this.requestManager.transformRequest(d,o.R.Model).url).then(m=>{if(!m)return;const v=o.aW(m),b=new o.aX(s,void 0,void 0,v);return b.computeBoundsAndApplyParent(),b}).catch(m=>{if(m&&m.status===404)return null;this.fire(new o.y(new Error(`Could not load model ${s} from ${d}: ${m.message}`)))})}load(s,d,m={forceReload:!1}){this.models[d]||(this.models[d]={});const v=Object.keys(s),b=[],S=[];for(const E of v){const k=s[E];this.hasURLBeenRequested(k)&&!m.forceReload||(this.modelByURL[k]={modelId:E,scope:d},b.push(this.loadModel(E,k)),S.push(E)),this.models[d][E]||(this.models[d][E]={model:null,numReferences:1})}this.numModelsLoading[d]=(this.numModelsLoading[d]||0)+S.length,Promise.allSettled(b).then(E=>{for(let k=0;k<E.length;k++){const{status:O}=E[k];if(O==="rejected")continue;const{value:z}=E[k];this.models[d][S[k]]||(this.models[d][S[k]]={model:null,numReferences:1}),this.models[d][S[k]].model=z}this.numModelsLoading[d]-=S.length,this.fire(new o.z("data",{dataType:"style"}))}).catch(E=>{this.fire(new o.y(new Error(`Could not load models: ${E.message}`)))})}isLoaded(){for(const s in this.numModelsLoading)if(this.numModelsLoading[s]>0)return!1;return!0}hasModel(s,d,m={exactIdMatch:!1}){return!!(m.exactIdMatch?this.getModel(s,d):this.getModelByURL(this.modelUris[d][s]))}getModel(s,d){return this.models[d]||(this.models[d]={}),this.models[d][s]?this.models[d][s].model:void 0}getModelByURL(s){if(!s)return null;const d=this.modelByURL[s];return d?this.models[d.scope][d.modelId].model:null}hasModelBeenAdded(s,d){return this.models[d]&&this.models[d][s]!==void 0}getModelURIs(s){return this.modelUris[s]||{}}addModel(s,d,m){this.models[m]||(this.models[m]={}),this.modelUris[m]||(this.modelUris[m]={});const v=this.requestManager.normalizeModelURL(d);if((this.hasModel(s,m,{exactIdMatch:!0})||this.hasModelBeenAdded(s,m))&&this.modelUris[m][s]===v)this.models[m][s].numReferences++;else if(this.hasURLBeenRequested(v)){const{scope:b,modelId:S}=this.modelByURL[v];this.models[b][S].numReferences++}else this.modelUris[m][s]=v,this.load({[s]:this.modelUris[m][s]},m)}addModelURLs(s,d){this.models[d]||(this.models[d]={}),this.modelUris[d]||(this.modelUris[d]={});const m=this.modelUris[d];for(const v in s)m[v]=this.requestManager.normalizeModelURL(s[v])}reloadModels(s){this.load(this.modelUris[s],s,{forceReload:!0})}addModelsFromBucket(s,d){this.models[d]||(this.models[d]={}),this.modelUris[d]||(this.modelUris[d]={});const m={};for(const v of s)this.hasModel(v,d,{exactIdMatch:!0})||this.hasURLBeenRequested(v)?this.models[d][v].numReferences++:this.modelUris[d][v]&&!this.hasURLBeenRequested(v)?m[v]=this.modelUris[d][v]:!this.hasURLBeenRequested(v)&&o.db(v,!1)&&(this.modelUris[d][v]=this.requestManager.normalizeModelURL(v),m[v]=this.modelUris[d][v]);this.load(m,d)}hasURLBeenRequested(s){return this.modelByURL[s]!==void 0}removeModel(s,d,m=!1,v=!1){if(this.models[d]&&this.models[d][s]&&(this.models[d][s].numReferences--,this.models[d][s].numReferences===0||v)){const b=this.modelUris[d][s];m||delete this.modelUris[d][s],delete this.modelByURL[b];const S=this.models[d][s].model;if(!S)return;delete this.models[d][s],S.destroy()}}destroy(){for(const s of Object.keys(this.models))for(const d of Object.keys(this.models[s])){const m=this.models[s][d].model;delete this.models[s][d],m&&m.destroy()}this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}listModels(s){return this.models[s]||(this.models[s]={}),Object.keys(this.models[s])}upload(s,d){this.models[d]||(this.models[d]={});for(const m in this.models[d])this.models[d][m].model&&this.models[d][m].model.upload(s.context)}}const Rg=new o.a9({data:new o.aa(o.a6.colorTheme.data)});function gf(g){if(!g.metadata||!g.metadata.content_area)return;const s=o.o.devicePixelRatio,{left:d,top:m,width:v,height:b}=g.metadata.content_area,S=d*s,E=m*s;return[S,E,S+v*s,E+b*s]}function _f(g){if(g)return g.map(([s,d])=>[s*o.o.devicePixelRatio,d*o.o.devicePixelRatio])}class Yc{constructor(s,d,m){this.id=s,this.scope=d,this.sourceCache=m,this.pendingRequests=new Set,this.missingRequests=new Set}addPendingRequest(s){this.missingRequests.has(s.name)||this.pendingRequests.has(s.name)||this.pendingRequests.add(s.name)}hasPendingRequests(){return this.pendingRequests.size>0}resolvePendingRequests(){const s=new Map;if(!this.sourceCache.loaded())return s;const d=this.sourceCache.getVisibleCoordinates();if(d.length===0)return s;const m=this.sourceCache.getSource();if(!(m instanceof fa))return s;const v=d.map(S=>this.sourceCache.getTile(S)),b=m.getImages(v,Array.from(this.pendingRequests));for(const[S,E]of b)s.set(o.I.from({name:S,iconsetId:this.id}),E),this.pendingRequests.delete(S);for(const S of this.pendingRequests)this.missingRequests.add(S);return this.pendingRequests.clear(),s}}const Lu=(g,s)=>Le(g,s&&s.filter(d=>d.identifier!=="source.canvas")),xy=o.aH(Ci,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport","addIconset","removeIconset"]),Pg=o.aH(Ci,["setCenter","setZoom","setBearing","setPitch"]),dh=new Set(["background","sky","slot","custom"]),yf={version:8,layers:[],sources:{}},vf={duration:300,delay:0};class nl extends o.E{constructor(s,d={}){super(),this.map=s,this.scope=d.scope||"",this.globalId=null,this.fragments=[],this.importDepth=d.importDepth||0,this.importsCache=d.importsCache||new Map,this.resolvedImports=d.resolvedImports||new Set,this.transition=Object.assign({},vf),this._buildingIndex=new Va(this),this.crossTileSymbolIndex=new ds,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=d.styleChanges||new at,this.dispatcher=d.dispatcher?d.dispatcher:new o.D(o.dd(),this),d.imageManager?this.imageManager=d.imageManager:(this.imageManager=new Gt(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.addScope(this.scope),this.glyphManager=d.glyphManager?d.glyphManager:new o.de(s._requestManager,d.localFontFamily?o.df.all:d.localIdeographFontFamily?o.df.ideographs:o.df.none,d.localFontFamily||d.localIdeographFontFamily),d.modelManager?this.modelManager=d.modelManager:(this.modelManager=new Ou(s._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._availableModels={},this._order=[],this._markersNeedUpdate=!1,this.options=d.configOptions?d.configOptions:new Map,this._configDependentLayers=d.configDependentLayers?d.configDependentLayers:new Set,this._config=d.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:d.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=d.initialConfig,this.dispatcher.broadcast("setReferrer",o.dg());const m=this;this._rtlTextPluginCallback=nl.registerForPluginStateChange(v=>{m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:v.pluginStatus,pluginURL:v.pluginURL},(b,S)=>{if(o.dh(b),S&&S.every(E=>E))for(const E in m._sourceCaches){const k=m._sourceCaches[E],O=k.getSource().type;O!=="vector"&&O!=="geojson"||k.reload()}})}),this.on("data",v=>{if(v.dataType!=="source"||v.sourceDataType!=="metadata")return;const b=this.getOwnSource(v.sourceId);if(b&&b.vectorLayerIds)for(const S in this._layers){const E=this._layers[S];E.source===b.id&&this._validateLayer(E)}})}load(s){return s?(typeof s=="string"?this.loadURL(s):this.loadJSON(s),this):this}_getGlobalId(s){if(!s)return null;if(typeof s=="string"){if(o.h(s))return s;const d=o.di(s);if(!d.startsWith("http"))try{return new URL(d,location.href).toString()}catch{return d}return d}return`json://${o.dj(JSON.stringify(s))}`}_diffStyle(s,d,m){this.globalId=this._getGlobalId(s);const v=(b,S)=>{try{S(null,this.setState(b,m))}catch(E){S(E,!1)}};if(typeof s=="string"){const b=this.map._requestManager.normalizeStyleURL(s),S=this.map._requestManager.transformRequest(b,o.R.Style);o.m(S,(E,k)=>{E?this.fire(new o.y(E)):k&&v(k,d)})}else typeof s=="object"&&v(s,d)}loadURL(s,d={}){this.fire(new o.z("dataloading",{dataType:"style"}));const m=typeof d.validate=="boolean"?d.validate:!o.h(s);this.globalId=this._getGlobalId(s),s=this.map._requestManager.normalizeStyleURL(s,d.accessToken),this.resolvedImports.add(s);const v=this.importsCache.get(s);if(v)return this._load(v,m);const b=this.map._requestManager.transformRequest(s,o.R.Style);this._request=o.m(b,(S,E)=>{if(this._request=null,S)this.fire(new o.y(S));else if(E)return this.importsCache.set(s,E),this._load(E,m)})}loadJSON(s,d={}){this.fire(new o.z("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(s),this._request=o.o.frame(()=>{this._request=null,this._load(s,d.validate!==!1)})}loadEmpty(){this.fire(new o.z("dataloading",{dataType:"style"})),this._load(yf,!1)}_loadImports(s,d,m){if(this.importDepth>=4)return o.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const v=[];for(const b of s){const S=this._createFragmentStyle(b),E=new Promise(z=>{S.once("style.import.load",z),S.once("error",z)}).then(()=>this.mergeAll());if(v.push(E),this.resolvedImports.has(b.url)){S.loadEmpty();continue}const k=b.data||this.importsCache.get(b.url);k?(S.loadJSON(k,{validate:d}),this._isInternalStyle(k)&&(S.globalId=null)):b.url?S.loadURL(b.url,{validate:d}):S.loadEmpty();const O={style:S,id:b.id,config:b.config};if(m){const z=this.fragments.findIndex(({id:U})=>U===m);this.fragments=this.fragments.slice(0,z).concat(O).concat(this.fragments.slice(z))}else this.fragments.push(O)}return Promise.allSettled(v)}getImportGlobalIds(s=this,d=new Set){for(const m of s.fragments)m.style.globalId&&d.add(m.style.globalId),this.getImportGlobalIds(m.style,d);return[...d.values()]}_createFragmentStyle(s){const d=this.scope?o.B(s.id,this.scope):s.id;let m;const v=this._initialConfig&&this._initialConfig[d];(s.config||v)&&(m=Object.assign({},s.config,v));const b=new nl(this.map,{scope:d,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:m,configOptions:this.options,colorThemeOverride:s["color-theme"],configDependentLayers:this._configDependentLayers});return b.setEventedParent(this.map,{style:b}),b}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(s){return this.isRootStyle()&&(s.fragment||!!s.schema&&s.fragment!==!1)}_load(s,d){if(this._isInternalStyle(s)){const b=Object.assign({},yf,{imports:[{id:"basemap",data:s,url:""}]});return void this._load(b,d)}if(this.updateConfig(this._config,s.schema),d&&Lu(this,So(s)))return;this._loaded=!0,this.stylesheet=o.dk(s);const m=()=>{for(const k in s.sources)this.addSource(k,s.sources[k],{validate:!1,isInitialLoad:!0});if(s.iconsets)for(const k in s.iconsets)this.addIconset(k,s.iconsets[k]);s.sprite?this._loadIconset(s.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),!this.glyphManager.url&&s.glyphs&&this.glyphManager.setURL(s.glyphs);const b=El(this.stylesheet.layers);if(this._order=b.map(k=>k.id),this.stylesheet.light&&o.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const k=this.stylesheet.lights[0];this.light=new Ge(k.properties,k.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Ge(this.stylesheet.light)),this._layers={};for(const k of b){const O=o.dq(k,this.scope,this._styleColorTheme.lut,this.options);O.configDependencies.size!==0&&this._configDependentLayers.add(O.fqid),O.setEventedParent(this,{layer:{id:O.id}}),this._layers[O.id]=O;const z=this.getOwnLayerSourceCache(O),U=!!this.directionalLight&&this.directionalLight.shadowsEnabled();z&&O.canCastShadows()&&U&&(z.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.addModelURLs(this.stylesheet.models);const S=this.stylesheet.terrain;S&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(S,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new o.z("data",{dataType:"style"}));const E=this.isRootStyle();s.imports?this._loadImports(s.imports,d).then(()=>{this._reloadImports(),this.fire(new o.z(E?"style.load":"style.import.load"))}).catch(k=>{this.fire(new o.y(new Error("Failed to load imports",k))),this.fire(new o.z(E?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new o.z(E?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const v=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(v){const b=this._evaluateColorThemeData(v);this._loadColorTheme(b).then(()=>{m()}).catch(S=>{o.w(`Couldn't load color theme from the stylesheet: ${S}`),m()})}else this._styleColorTheme.lut=null,m()}isRootStyle(){return this.importDepth===0}mergeAll(){let s,d,m,v,b,S,E,k,O,z;const U={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(F=>{if(F.stylesheet){if(F.light!=null&&(s=F.light),F.stylesheet.lights)for(const H of F.stylesheet.lights)H.type==="ambient"&&F.ambientLight!=null&&(d=F.ambientLight),H.type==="directional"&&F.directionalLight!=null&&(m=F.directionalLight);v=this._prioritizeTerrain(v,F.terrain,F.stylesheet.terrain),F.stylesheet.fog&&F.fog!=null&&(b=F.fog),F.stylesheet.snow&&F.snow!=null&&(S=F.snow),F.stylesheet.rain&&F.rain!=null&&(E=F.rain),F.stylesheet.camera!=null&&(z=F.stylesheet.camera),F.stylesheet.projection!=null&&(k=F.stylesheet.projection),F.stylesheet.transition!=null&&(O=F.stylesheet.transition),U[F.scope]=F._styleColorTheme}}),this.light=s,this.ambientLight=d,this.directionalLight=m,this.fog=b,this.snow=S,this.rain=E,this._styleColorThemeForScope=U,v===null?delete this.terrain:this.terrain=v,this.camera=z||{"camera-projection":"perspective"},this.projection=k||{name:"mercator"},this.transition=Object.assign({},vf,O),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(s){const d=m=>{for(const v of m.fragments)d(v.style);s(m)};d(this)}_prioritizeTerrain(s,d,m){const v=s&&s.drapeRenderMode===0;return m===null?d&&d.drapeRenderMode===0?d:v?s:null:d!=null&&(!s||v||d&&d.drapeRenderMode===1)?d:s}mergeTerrain(){let s;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(d=>{s=this._prioritizeTerrain(s,d.terrain,d.stylesheet.terrain)}),s===null?delete this.terrain:this.terrain=s}mergeProjection(){let s;this.forEachFragmentStyle(d=>{d.stylesheet.projection!=null&&(s=d.stylesheet.projection)}),this.projection=s||{name:"mercator"}}mergeSources(){const s={},d={},m={};this.forEachFragmentStyle(v=>{for(const b in v._sourceCaches){const S=o.B(b,v.scope);s[S]=v._sourceCaches[b]}for(const b in v._otherSourceCaches){const S=o.B(b,v.scope);d[S]=v._otherSourceCaches[b]}for(const b in v._symbolSourceCaches){const S=o.B(b,v.scope);m[S]=v._symbolSourceCaches[b]}}),this._mergedSourceCaches=s,this._mergedOtherSourceCaches=d,this._mergedSymbolSourceCaches=m}mergeLayers(){const s={},d=[],m={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(S=>{for(const E of S._order){const k=S._layers[E];if(k.type==="slot"){const O=o.dl(E);if(s[O])continue;s[O]=[]}k.slot&&s[k.slot]?s[k.slot].push(k):d.push(k)}}),this._mergedOrder=[];let v=-1;const b=(S=[])=>{for(const E of S)if(E.type==="slot"){const k=o.dl(E.id);s[k]&&b(s[k]),this._mergedSlots.push(k)}else{const k=o.B(E.id,E.scope);this._mergedOrder.push(k),m[k]=E,E.is3D(!!this.terrain)&&(this._has3DLayers=!0,v=this._mergedOrder.length-1),E.type==="circle"&&(this._hasCircleLayers=!0),E.type==="symbol"&&(this._hasSymbolLayers=!0),E.type==="clip"&&(this._clipLayerPresent=!0)}};if(b(d),this._has3DLayers){const S={};for(let E=0;E<this._mergedOrder.length;++E){const k=this._mergedOrder[E];S[k]=E===v?1:E<v?m[k].hasOcclusionOpacityProperties?2:0:4}this._mergedOrder.sort((E,k)=>S[E]-S[k])}this._mergedLayers=m,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(s){return this.stylesheet.camera=Object.assign({},this.stylesheet.camera,s),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(s){return s.data?function(d,m,v,b){const S=Object.assign({},m);for(const k of Object.keys(o.a6.colorTheme))S[k]===void 0&&(S[k]=o.a6.colorTheme[k].default);const E=new o.a8(Rg,d,new Map(v));return E.setTransitionOrValue(S,v),E.untransitioned().possiblyEvaluate(new o.ac(0,{worldview:void 0}))}(this.scope,s,this.options).get("data"):null}_loadColorTheme(s){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const d=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((m,v)=>{const b="data:image/png;base64,";if(!s||s.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void m();let S=s;S.startsWith(b)||(S=b+S);const E=o.I.from("mapbox-reserved-lut"),k=new Image;k.src=S,k.onerror=()=>{this._styleColorTheme.lutLoading=!1,v(new Error("Failed to load image data"))},k.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==d)return void m();this._styleColorTheme.lutLoading=!1;const{width:O,height:z,data:U}=o.o.getImageData(k);if(z>32)return void v(new Error("The height of the image must be less than or equal to 32 pixels."));if(O!==z*z)return void v(new Error("The width of the image must be equal to the height squared."));this.getImage(E)&&this.removeImage(E),this.addImage(E,{data:new o.q({width:O,height:z},U),pixelRatio:1,sdf:!1,usvg:!1,version:0});const F=this.imageManager.getImage(E,this.scope);F?(this._styleColorTheme.lut={image:F.data,data:s},m()):v(new Error("Missing LUT image."))}})}getLut(s){const d=this._styleColorThemeForScope[s];return d?d.lut:null}setProjection(s){s?this.stylesheet.projection=s:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(s){this._spriteRequest=function(d,m,v){let b,S,E;const k=o.o.devicePixelRatio>1?"@2x":"";let O=o.m(m.transformRequest(m.normalizeSpriteURL(d,k,".json"),o.R.SpriteJSON),(F,H)=>{O=null,E||(E=F,b=H,U())}),z=o.n(m.transformRequest(m.normalizeSpriteURL(d,k,".png"),o.R.SpriteImage),(F,H)=>{z=null,E||(E=F,S=H,U())});function U(){if(E)v(E);else if(b&&S){const F=o.o.getImageData(S),H={};for(const G in b){const{width:W,height:ne,x:X,y:re,sdf:he,pixelRatio:pe,stretchX:Ie,stretchY:Se,content:Ae}=b[G],Ce=new o.q({width:W,height:ne});o.q.copy(F,Ce,{x:X,y:re},{x:0,y:0},{width:W,height:ne},null),H[G]={data:Ce,pixelRatio:pe!==void 0?pe:1,sdf:he!==void 0&&he,stretchX:Ie,stretchY:Se,content:Ae,usvg:!1,version:0}}v(null,H)}}return{cancel(){O&&(O.cancel(),O=null),z&&(z.cancel(),z=null)}}}(s,this.map._requestManager,(d,m)=>{if(this._spriteRequest=null,d)this.fire(new o.y(d));else if(m){const v=new Map;for(const b in m)v.set(o.I.from(b),m[b]);this.addImages(v)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new o.z("data",{dataType:"style"}))})}addIconset(s,d){if(d.type==="sprite")return void this._loadSprite(d.url);const m=this.getOwnSourceCache(d.source);if(!m)return void this.fire(new o.y(new Error(`Source "${d.source}" as specified by iconset "${s}" does not exist and cannot be used as an iconset source`)));const v=m.getSource();if(v.type!=="raster-array")return void this.fire(new o.y(new Error(`Source "${d.source}" as specified by iconset "${s}" is not a "raster-array" source and cannot be used as an iconset source`)));v.partial=!1;const b=new Yc(s,this.scope,m);this.imageManager.addImageProvider(b,this.scope)}removeIconset(s){this.imageManager.removeImageProvider(s,this.scope)}_loadIconset(s){if(!o.h(s)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(s);const d=this.map._spriteFormat==="auto";var m,v;this._spriteRequest=(v=(b,S)=>{if(this._spriteRequest=null,b)d?this._loadSprite(s):this.fire(new o.y(b));else if(S){const E=new Map;for(const k in S)E.set(o.I.from(k),S[k]);this.addImages(E)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new o.z("data",{dataType:"style"}))},o.bu((m=this.map._requestManager).transformRequest(m.normalizeIconsetURL(s),o.R.Iconset),(b,S)=>{if(b)return void v(b);const E={},k=o.dc(new o.bt(S));for(const O of k.icons){const z={version:1,pixelRatio:o.o.devicePixelRatio,content:gf(O),stretchX:O.metadata?_f(O.metadata.stretch_x_areas):void 0,stretchY:O.metadata?_f(O.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:O};E[O.name]=z}v(null,E)}))}_validateLayer(s){const d=this.getOwnSource(s.source);if(!d)return;const m=s.sourceLayer;m&&(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(m)===-1)&&this.fire(new o.y(new Error(`Source layer "${m}" does not exist on source "${d.id}" as specified by style layer "${s.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const s in this._sourceCaches)if(!this._sourceCaches[s].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:s}of this.fragments)if(!s.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((s,d)=>{const m=this.fragments[d];return m&&m.style&&(s.data=m.style.serialize()),s})}_serializeSources(){const s={};for(const d in this._sourceCaches){const m=this._sourceCaches[d].getSource();s[m.id]||(s[m.id]=m.serialize())}return s}_serializeLayers(s){const d=[];for(const m of s){const v=this._layers[m];v&&v.type!=="custom"&&d.push(v.serialize())}return d}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const s in this._sourceCaches)if(this._sourceCaches[s].hasTransition())return!0;for(const s in this._layers)if(this._layers[s].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(s){return s?this.order:this._mergedOrder}isLayerDraped(s){return!!this.terrain&&s.isDraped(this.getLayerSourceCache(s))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(s){const d=this.getOwnLayer(s);if(d)return d;this.fire(new o.y(new Error(`The layer '${s}' does not exist in the map's style.`)))}_checkSource(s){const d=this.getOwnSource(s);if(d)return d;this.fire(new o.y(new Error(`The source '${s}' does not exist in the map's style.`)))}precompilePrograms(s,d){const m=this.map.painter;if(m)for(let v=s.minzoom||0;v<(s.maxzoom||25.5);v++){const b=s.getProgramIds();if(b)for(const S of b){const E=s.getDefaultProgramParams(S,d.zoom,this._styleColorTheme.lut);E&&(m.style=this,this.fog&&(m._fogVisible=!0,E.overrideFog=!0,m.getOrCreateProgram(S,E)),m._fogVisible=!1,E.overrideFog=!1,m.getOrCreateProgram(S,E),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(E.overrideRtt=!0,m.getOrCreateProgram(S,E)))}}}update(s){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(s),this.directionalLight&&this.directionalLight.recalculate(s);const d=this.calculateLightsBrightness();s.brightness=d||0,d!==this._brightness&&(this._brightness=d,this.dispatcher.broadcast("setBrightness",d)),s.worldview!==this._worldview&&(this._worldview=s.worldview,this.dispatcher.broadcast("setWorldview",this._worldview));const m=this._changes.isDirty();let v=!1;if(this._changes.isDirty()){const E=this._changes.getLayerUpdatesByScope();for(const k in E){const{updatedIds:O,removedIds:z}=E[k];(O||z)&&(this._updateWorkerLayers(k,O,z),v=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(s),this.light&&this.light.updateTransitions(s),this.ambientLight&&this.ambientLight.updateTransitions(s),this.directionalLight&&this.directionalLight.updateTransitions(s),this.fog&&this.fog.updateTransitions(s),this.snow&&this.snow.updateTransitions(s),this.rain&&this.rain.updateTransitions(s),this._changes.reset()}const b={};for(const E in this._mergedSourceCaches){const k=this._mergedSourceCaches[E];b[E]=k.used,k.used=!1,k.tileCoverLift=0}for(const E of this._mergedOrder){const k=this._mergedLayers[E];if(k.recalculate(s,this._availableImages),!k.isHidden(s.zoom)){const O=this.getLayerSourceCache(k);O&&(O.used=!0,O.tileCoverLift=Math.max(O.tileCoverLift,k.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(k,s)}):this.precompilePrograms(k,s))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&v&&this.mergeLayers();const S=this.imageManager.getPendingImageProviders();for(const E of S)E.sourceCache.used=!0;for(const E in b){const k=this._mergedSourceCaches[E];b[E]!==k.used&&k.getSource().fire(new o.z("data",{sourceDataType:"visibility",dataType:"source",sourceId:k.getSource().id}))}this.light&&this.light.recalculate(s),this.terrain&&this.terrain.recalculate(s),this.fog&&this.fog.recalculate(s),this.snow&&this.snow.recalculate(s),this.rain&&this.rain.recalculate(s),this.z=s.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),m&&this.fire(new o.z("data",{dataType:"style"}))}updateImageProviders(){const s=this.imageManager.getPendingImageProviders();for(const d of s){const m=d.resolvePendingRequests(),v=this.getFragmentStyle(d.scope);v&&v.addImages(m)}}_updateTilesForChangedImages(){const s={};for(const d in this._mergedSourceCaches){const m=this._mergedSourceCaches[d].getSource().scope;s[m]=s[m]||this._changes.getUpdatedImages(m),s[m].length!==0&&this._mergedSourceCaches[d].reloadTilesForDependencies(["icons","patterns"],s[m])}for(const d in s)this._changes.resetUpdatedImages(d)}_updateWorkerLayers(s,d,m){const v=this.getFragmentStyle(s);v&&this.dispatcher.broadcast("updateLayers",{layers:d?v._serializeLayers(d):[],scope:s,removedIds:m||[],options:v.options})}setState(s,d){if(this._checkLoaded(),Lu(this,So(s)))return!1;(s=o.dk(s)).layers=El(s.layers);const m=function(S,E){if(!S)return[{command:Ci.setStyle,args:[E]}];let k=[];try{if(!o.by(S.version,E.version))return[{command:Ci.setStyle,args:[E]}];if(o.by(S.center,E.center)||k.push({command:Ci.setCenter,args:[E.center]}),o.by(S.zoom,E.zoom)||k.push({command:Ci.setZoom,args:[E.zoom]}),o.by(S.bearing,E.bearing)||k.push({command:Ci.setBearing,args:[E.bearing]}),o.by(S.pitch,E.pitch)||k.push({command:Ci.setPitch,args:[E.pitch]}),o.by(S.sprite,E.sprite)||k.push({command:Ci.setSprite,args:[E.sprite]}),o.by(S.glyphs,E.glyphs)||k.push({command:Ci.setGlyphs,args:[E.glyphs]}),o.by(S.imports,E.imports)||function(H=[],G=[],W){G=G||[];const ne=(H=H||[]).map(Il),X=G.map(Il),re=H.reduce(Hc,{}),he=G.reduce(Hc,{}),pe=ne.slice();let Ie,Se,Ae,Ce;for(Ie=0,Se=0;Ie<ne.length;Ie++)Ae=ne[Ie],he.hasOwnProperty(Ae)?Se++:(W.push({command:Ci.removeImport,args:[Ae]}),pe.splice(pe.indexOf(Ae,Se),1));for(Ie=0,Se=0;Ie<X.length;Ie++)Ae=X[X.length-1-Ie],pe[pe.length-1-Ie]!==Ae&&(re.hasOwnProperty(Ae)?(W.push({command:Ci.removeImport,args:[Ae]}),pe.splice(pe.lastIndexOf(Ae,pe.length-Se),1)):Se++,Ce=pe[pe.length-Ie],W.push({command:Ci.addImport,args:[he[Ae],Ce]}),pe.splice(pe.length-Ie,0,Ae));for(const we of G){const ke=re[we.id];ke&&(delete ke.data,o.by(ke,we)||W.push({command:Ci.updateImport,args:[we.id,we]}))}}(S.imports,E.imports,k),o.by(S.transition,E.transition)||k.push({command:Ci.setTransition,args:[E.transition]}),o.by(S.light,E.light)||k.push({command:Ci.setLight,args:[E.light]}),o.by(S.fog,E.fog)||k.push({command:Ci.setFog,args:[E.fog]}),o.by(S.snow,E.snow)||k.push({command:Ci.setSnow,args:[E.snow]}),o.by(S.rain,E.rain)||k.push({command:Ci.setRain,args:[E.rain]}),o.by(S.projection,E.projection)||k.push({command:Ci.setProjection,args:[E.projection]}),o.by(S.lights,E.lights)||k.push({command:Ci.setLights,args:[E.lights]}),o.by(S.camera,E.camera)||k.push({command:Ci.setCamera,args:[E.camera]}),o.by(S.iconsets,E.iconsets)||function(H,G,W){let ne;for(ne in G=G||{},H=H||{})H.hasOwnProperty(ne)&&(G.hasOwnProperty(ne)||W.push({command:Ci.removeIconset,args:[ne]}));for(ne in G){if(!G.hasOwnProperty(ne))continue;const X=G[ne];H.hasOwnProperty(ne)?o.by(H[ne],X)||(W.push({command:Ci.removeIconset,args:[ne]}),W.push({command:Ci.addIconset,args:[ne,X]})):W.push({command:Ci.addIconset,args:[ne,X]})}}(S.iconsets,E.iconsets,k),!o.by(S["color-theme"],E["color-theme"]))return[{command:Ci.setStyle,args:[E]}];const O={},z=[];(function(H,G,W,ne){let X;for(X in G=G||{},H=H||{})H.hasOwnProperty(X)&&(G.hasOwnProperty(X)||md(X,W,ne));for(X in G){if(!G.hasOwnProperty(X))continue;const re=G[X];H.hasOwnProperty(X)?o.by(H[X],re)||(H[X].type==="geojson"&&re.type==="geojson"&&Uc(H,G,X)?W.push({command:Ci.setGeoJSONSourceData,args:[X,re.data]}):$o(X,G,W,ne)):Sa(X,G,W)}})(S.sources,E.sources,z,O);const U=[];S.layers&&S.layers.forEach(H=>{H.source&&O[H.source]?k.push({command:Ci.removeLayer,args:[H.id]}):U.push(H)});let F=S.terrain;F&&O[F.source]&&(k.push({command:Ci.setTerrain,args:[void 0]}),F=void 0),k=k.concat(z),o.by(F,E.terrain)||k.push({command:Ci.setTerrain,args:[E.terrain]}),function(H,G,W){G=G||[];const ne=(H=H||[]).map(Il),X=G.map(Il),re=H.reduce(Hc,{}),he=G.reduce(Hc,{}),pe=ne.slice(),Ie=Object.create(null);let Se,Ae,Ce,we,ke,nt,Ke;for(Se=0,Ae=0;Se<ne.length;Se++)Ce=ne[Se],he.hasOwnProperty(Ce)?Ae++:(W.push({command:Ci.removeLayer,args:[Ce]}),pe.splice(pe.indexOf(Ce,Ae),1));for(Se=0,Ae=0;Se<X.length;Se++)Ce=X[X.length-1-Se],pe[pe.length-1-Se]!==Ce&&(re.hasOwnProperty(Ce)?(W.push({command:Ci.removeLayer,args:[Ce]}),pe.splice(pe.lastIndexOf(Ce,pe.length-Ae),1)):Ae++,nt=pe[pe.length-Se],W.push({command:Ci.addLayer,args:[he[Ce],nt]}),pe.splice(pe.length-Se,0,Ce),Ie[Ce]=!0);for(Se=0;Se<X.length;Se++)if(Ce=X[Se],we=re[Ce],ke=he[Ce],!Ie[Ce]&&!o.by(we,ke))if(o.by(we.source,ke.source)&&o.by(we["source-layer"],ke["source-layer"])&&o.by(we.type,ke.type)){for(Ke in $a(we.layout,ke.layout,W,Ce,null,Ci.setLayoutProperty),$a(we.paint,ke.paint,W,Ce,null,Ci.setPaintProperty),o.by(we.slot,ke.slot)||W.push({command:Ci.setSlot,args:[Ce,ke.slot]}),o.by(we.filter,ke.filter)||W.push({command:Ci.setFilter,args:[Ce,ke.filter]}),o.by(we.minzoom,ke.minzoom)&&o.by(we.maxzoom,ke.maxzoom)||W.push({command:Ci.setLayerZoomRange,args:[Ce,ke.minzoom,ke.maxzoom]}),we)we.hasOwnProperty(Ke)&&Ke!=="layout"&&Ke!=="paint"&&Ke!=="filter"&&Ke!=="metadata"&&Ke!=="minzoom"&&Ke!=="maxzoom"&&Ke!=="slot"&&(Ke.indexOf("paint.")===0?$a(we[Ke],ke[Ke],W,Ce,Ke.slice(6),Ci.setPaintProperty):o.by(we[Ke],ke[Ke])||W.push({command:Ci.setLayerProperty,args:[Ce,Ke,ke[Ke]]}));for(Ke in ke)ke.hasOwnProperty(Ke)&&!we.hasOwnProperty(Ke)&&Ke!=="layout"&&Ke!=="paint"&&Ke!=="filter"&&Ke!=="metadata"&&Ke!=="minzoom"&&Ke!=="maxzoom"&&Ke!=="slot"&&(Ke.indexOf("paint.")===0?$a(we[Ke],ke[Ke],W,Ce,Ke.slice(6),Ci.setPaintProperty):o.by(we[Ke],ke[Ke])||W.push({command:Ci.setLayerProperty,args:[Ce,Ke,ke[Ke]]}))}else W.push({command:Ci.removeLayer,args:[Ce]}),nt=pe[pe.lastIndexOf(Ce)+1],W.push({command:Ci.addLayer,args:[ke,nt]})}(U,E.layers,k)}catch(O){console.warn("Unable to compute style diff:",O),k=[{command:Ci.setStyle,args:[E]}]}return k}(this.serialize(),s).filter(S=>!(S.command in Pg));if(m.length===0)return!1;const v=m.filter(S=>!(S.command in xy));if(v.length>0)throw new Error(`Unimplemented: ${v.map(S=>S.command).join(", ")}.`);const b=[];return m.forEach(S=>{b.push(this[S.command](...S.args))}),d&&Promise.all(b).then(d).catch(d),this.stylesheet=s,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}_updateWorkerModels(){this._availableModels=this.modelManager.getModelURIs(this.scope),this.dispatcher.broadcast("setModels",{scope:this.scope,models:this._availableModels})}addImages(s){if(s.size===0)return this;for(const[d,m]of s.entries()){if(this.getImage(d))return this.fire(new o.y(new Error(`An image with the name "${d.name}" already exists.`)));this.imageManager.addImage(d,this.scope,m),this._changes.updateImage(d,this.scope)}return this._updateWorkerImages(),this.fire(new o.z("data",{dataType:"style"})),this}addImage(s,d){return this.getImage(s)?this.fire(new o.y(new Error(`An image with the name "${s.name}" already exists.`))):(this.imageManager.addImage(s,this.scope,d),this._changes.updateImage(s,this.scope),this._updateWorkerImages(),this.fire(new o.z("data",{dataType:"style"})),this)}updateImage(s,d,m=!1){this.imageManager.updateImage(s,this.scope,d),m&&(this._changes.updateImage(s,this.scope),this._updateWorkerImages(),this.fire(new o.z("data",{dataType:"style"})))}getImage(s){return this.imageManager.getImage(s,this.scope)}removeImage(s){return this.getImage(s)?(this.imageManager.removeImage(s,this.scope),this._changes.updateImage(s,this.scope),this._updateWorkerImages(),this.fire(new o.z("data",{dataType:"style"})),this):this.fire(new o.y(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModelURLs(s){return this.modelManager.addModelURLs(s,this.scope),this._updateWorkerModels(),this.fire(new o.z("data",{dataType:"style"})),this}addModel(s,d,m={}){return this._checkLoaded(),this._validate(Fe,`models.${s}`,d,null,m)||(this.modelManager.addModel(s,d,this.scope),this.fire(new o.z("data",{dataType:"style"}))),this}hasModel(s){return this.modelManager.hasModel(s,this.scope)}removeModel(s){return this.hasModel(s)?(this.modelManager.removeModel(s,this.scope,!1,!0),this.fire(new o.z("data",{dataType:"style"})),this):this.fire(new o.y(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(s,d,m={}){if(this._checkLoaded(),this.getOwnSource(s)!==void 0)throw new Error(`There is already a source with ID "${s}".`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(yl,`sources.${s}`,d,null,m))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const v=Xr(s,d,this.dispatcher,this);v.scope=this.scope,v.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(v.id),source:v.serialize(),sourceId:v.id}));const b=S=>{const E=(S?"symbol:":"other:")+v.id,k=o.B(E,this.scope),O=this._sourceCaches[E]=new Xs(k,v,S);(S?this._symbolSourceCaches:this._otherSourceCaches)[v.id]=O,O.onAdd(this.map)};b(!1),d.type!=="vector"&&d.type!=="geojson"||b(!0),v.onAdd&&v.onAdd(this.map),m.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(s){this._checkLoaded();const d=this.getOwnSource(s);if(!d)throw new Error("There is no source with this ID");for(const v in this._layers)if(this._layers[v].source===s)return this.fire(new o.y(new Error(`Source "${s}" cannot be removed while layer "${v}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===s)return this.fire(new o.y(new Error(`Source "${s}" cannot be removed while terrain is using it.`)));if(this.stylesheet.iconsets){const v=Object.entries(this.stylesheet.iconsets).find(([b,S])=>S.type==="source"&&S.source===s);if(v)return this.fire(new o.y(new Error(`Source "${s}" cannot be removed while iconset "${v[0]}" is using it.`)))}const m=this.getOwnSourceCaches(s);for(const v of m){const b=o.dl(v.id);delete this._sourceCaches[b],this._changes.discardSourceCacheUpdate(v.id),v.fire(new o.z("data",{sourceDataType:"metadata",dataType:"source",sourceId:v.getSource().id})),v.setEventedParent(null),v.clearTiles()}return delete this._otherSourceCaches[s],delete this._symbolSourceCaches[s],this.mergeSources(),d.setEventedParent(null),d.onRemove&&d.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(s,d){this._checkLoaded(),this.getOwnSource(s).setData(d),this._changes.setDirty()}getOwnSource(s){const d=this.getOwnSourceCache(s);return d&&d.getSource()}getOwnSources(){const s=[];for(const d in this._otherSourceCaches){const m=this.getOwnSourceCache(d);m&&s.push(m.getSource())}return s}areTilesLoaded(){const s=this._mergedSourceCaches;for(const d in s){const m=s[d]._tiles;for(const v in m){const b=m[v];if(b.state!=="loaded"&&b.state!=="errored")return!1}}return!0}setLights(s){if(this._checkLoaded(),!s)return delete this.ambientLight,void delete this.directionalLight;const d=this._getTransitionParameters();for(const b of s){if(this._validate(vl,"lights",b))return;switch(b.type){case"ambient":if(this.ambientLight){const S=this.ambientLight;S.set(b),S.updateTransitions(d)}else this.ambientLight=new Oi(b,cr||(cr=new o.a9({color:new o.aa(o.a6.properties_light_ambient.color),"color-use-theme":new o.aa({type:"string",default:"default","property-type":"data-constant"}),intensity:new o.aa(o.a6.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const S=this.directionalLight;S.set(b),S.updateTransitions(d)}else this.directionalLight=new Oi(b,Fr||(Fr=new o.a9({direction:new o.ap(o.a6.properties_light_directional.direction),color:new o.aa(o.a6.properties_light_directional.color),"color-use-theme":new o.aa({type:"string",default:"default","property-type":"data-constant"}),intensity:new o.aa(o.a6.properties_light_directional.intensity),"cast-shadows":new o.aa(o.a6.properties_light_directional["cast-shadows"]),"shadow-quality":new o.aa(o.a6.properties_light_directional["shadow-quality"]),"shadow-intensity":new o.aa(o.a6.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const m=Object.assign(d,{worldview:this.map.getWorldview()}),v=new o.ac(this.z||0,m);this.ambientLight&&this.ambientLight.recalculate(v),this.directionalLight&&this.directionalLight.recalculate(v),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const s=this.directionalLight,d=this.ambientLight;if(!s||!d)return;const m=F=>.2126*(F[0]<=.03928?F[0]/12.92:Math.pow((F[0]+.055)/1.055,2.4))+.7152*(F[1]<=.03928?F[1]/12.92:Math.pow((F[1]+.055)/1.055,2.4))+.0722*(F[2]<=.03928?F[2]/12.92:Math.pow((F[2]+.055)/1.055,2.4)),v=s.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),b=s.properties.get("intensity"),S=s.properties.get("direction"),E=1-o.d3(S.x,S.y,S.z)[2]/90,k=m(v)*b*E,O=d.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),z=d.properties.get("intensity"),U=m(O)*z;return Number(((k+U)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const s=[];return this.directionalLight&&s.push(this.directionalLight.get()),this.ambientLight&&s.push(this.ambientLight.get()),s}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(s){if(s==null||s===""&&this.isRootStyle())return this;if(o.dm(s)){const d=o.dn(s),m=this.fragments.find(({id:b})=>b===d);if(!m)return;const v=o.dl(s);return m.style.getFragmentStyle(v)}{const d=this.fragments.find(({id:m})=>m===s);return d?d.style:void 0}}setFeaturesetSelectors(s){if(!s)return;const d={},m=(v,b="")=>`${v}::${b}`;this._featuresetSelectors={};for(const v in s){const b=this._featuresetSelectors[v]=[];for(const S of s[v].selectors){if(S.featureNamespace){const k=this.getOwnLayer(S.layer);if(!k){o.w(`Layer is undefined for selector: ${S.layer}`);continue}const O=m(k.source,k.sourceLayer);if(O in d&&d[O]!==S.featureNamespace){o.w(`"featureNamespace ${S.featureNamespace} of featureset ${v}'s selector is not associated to the same source, skip this selector`);continue}d[O]=S.featureNamespace}let E;if(S.properties)for(const k in S.properties){const O=o.U(S.properties[k]);O.result==="success"&&(E=E||{},E[k]=O.value)}b.push({layerId:S.layer,namespace:S.featureNamespace,properties:E,uniqueFeatureID:S._uniqueFeatureID})}}}getFeaturesetDescriptors(s){const d=this.getFragmentStyle(s);if(!d||!d.stylesheet.featuresets)return[];const m=[];for(const v in d.stylesheet.featuresets)m.push({featuresetId:v,importId:d.scope?d.scope:void 0});return m}getFeaturesetLayers(s,d){const m=this.getFragmentStyle(d),v=m.stylesheet.featuresets;if(!v||!v[s])return this.fire(new o.y(new Error(`The featureset '${s}' does not exist in the map's style and cannot be queried.`))),[];const b=[];for(const S of v[s].selectors){const E=m.getOwnLayer(S.layer);E&&b.push(E)}return b}getConfigProperty(s,d){const m=this.getFragmentStyle(s);if(!m)return null;const v=o.B(d,m.scope),b=m.options.get(v),S=b?b.value||b.default:null;return S?S.serialize():null}setConfigProperty(s,d,m){const v=this.getFragmentStyle(s);if(!v)return;const b=v.stylesheet.schema;if(!b||!b[d])return;const S=o.U(m);if(S.result!=="success")return void Lu(this,S.value);const E=S.value.expression,k=o.B(d,v.scope),O=v.options.get(k);if(!O)return;let z;const{minValue:U,maxValue:F,stepValue:H,type:G,values:W}=b[d],ne=o.U(b[d].default);ne.result==="success"&&(z=ne.value.expression),z?(this.options.set(k,Object.assign({},O,{value:E,default:z,minValue:U,maxValue:F,stepValue:H,type:G,values:W})),this.updateConfigDependencies(d)):this.fire(new o.y(new Error(`No schema defined for the config option "${d}" in the "${s}" fragment.`)))}getConfig(s){const d=this.getFragmentStyle(s);if(!d)return null;const m=d.stylesheet.schema;if(!m)return null;const v={};for(const b in m){const S=o.B(b,d.scope),E=d.options.get(S),k=E?E.value||E.default:null;v[b]=k?k.serialize():null}return v}setConfig(s,d){const m=this.getFragmentStyle(s);m&&(m.updateConfig(d,m.stylesheet.schema),this.updateConfigDependencies())}getSchema(s){const d=this.getFragmentStyle(s);return d?d.stylesheet.schema:null}setSchema(s,d){const m=this.getFragmentStyle(s);m&&(m.stylesheet.schema=d,m.updateConfig(m._config,d),this.updateConfigDependencies())}updateConfig(s,d){if(this._config=s,s||d)if(d)for(const m in d){let v,b;const S=o.U(d[m].default);if(S.result==="success"&&(v=S.value.expression),s&&s[m]!==void 0){const F=o.U(s[m]);F.result==="success"&&(b=F.value.expression)}const{minValue:E,maxValue:k,stepValue:O,type:z,values:U}=d[m];if(v){const F=o.B(m,this.scope);this.options.set(F,{default:v,value:b,minValue:E,maxValue:k,stepValue:O,type:z,values:U})}else this.fire(new o.y(new Error(`No schema defined for config option "${m}".`)))}else this.fire(new o.y(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(s){for(const d of this._configDependentLayers){const m=this.getLayer(d);if(m){if(s&&!m.configDependencies.has(s))continue;m.possiblyEvaluateVisibility(),this._updateLayer(m)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(d=>{const m=d._styleColorTheme.colorThemeOverride?d._styleColorTheme.colorThemeOverride:d._styleColorTheme.colorTheme;if(m){const v=d._evaluateColorThemeData(m);(!d._styleColorTheme.lut&&v!==""||d._styleColorTheme.lut&&v!==d._styleColorTheme.lut.data)&&d.setColorTheme(m)}}),this._changes.setDirty()}addLayer(s,d,m={}){this._checkLoaded();const v=s.id;if(this._layers[v])return void this.fire(new o.y(new Error(`Layer with id "${v}" already exists on this map`)));let b;if(s.type==="custom"){if(Lu(this,o.dp(s)))return;b=o.dq(s,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof s.source=="object"&&(this.addSource(v,s.source),s=o.dk(s),s=Object.assign(s,{source:v})),this._validate(Xe,`layers.${v}`,s,{arrayIndex:-1},m))return;b=o.dq(s,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(b),b.setEventedParent(this,{layer:{id:v}})}b.configDependencies.size!==0&&this._configDependentLayers.add(b.fqid);let S=this._order.length;if(d){const z=this._order.indexOf(d);if(z===-1)return void this.fire(new o.y(new Error(`Layer with id "${d}" does not exist on this map.`)));b.slot===this._layers[d].slot?S=z:o.w(`Layer with id "${d}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(S,0,v),this._layerOrderChanged=!0,this._layers[v]=b;const E=this.getOwnLayerSourceCache(b),k=!!this.directionalLight&&this.directionalLight.shadowsEnabled();E&&b.canCastShadows()&&k&&(E.castsShadows=!0);const O=this._changes.getRemovedLayer(b);if(O&&b.source&&E&&b.type!=="custom"){this._changes.discardLayerRemoval(b);const z=o.B(b.source,b.scope);O.type!==b.type?this._changes.updateSourceCache(z,"clear"):(this._changes.updateSourceCache(z,"reload"),E.pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map),b.scope=this.scope,this.mergeLayers()}moveLayer(s,d){this._checkLoaded();const m=this._checkLayer(s);if(!m||s===d)return;const v=this._order.indexOf(s);this._order.splice(v,1);let b=this._order.length;if(d){const S=this._order.indexOf(d);if(S===-1)return void this.fire(new o.y(new Error(`Layer with id "${d}" does not exist on this map.`)));m.slot===this._layers[d].slot?b=S:o.w(`Layer with id "${d}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(b,0,s),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(s){this._checkLoaded();const d=this._checkLayer(s);if(!d)return;d.setEventedParent(null);const m=this._order.indexOf(s);this._order.splice(m,1),delete this._layers[s],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(d.fqid),this._changes.removeLayer(d);const v=this.getOwnLayerSourceCache(d);if(v&&v.castsShadows){let b=!1;for(const S in this._layers)if(this._layers[S].source===d.source&&this._layers[S].canCastShadows()){b=!0;break}v.castsShadows=b}d.onRemove&&d.onRemove(this.map),this.mergeLayers()}getOwnLayer(s){return this._layers[s]}hasLayer(s){return s in this._mergedLayers}hasLayerType(s){for(const d in this._layers)if(this._layers[d].type===s)return!0;return!1}setLayerZoomRange(s,d,m){this._checkLoaded();const v=this._checkLayer(s);v&&(v.minzoom===d&&v.maxzoom===m||(d!=null&&(v.minzoom=d),m!=null&&(v.maxzoom=m),this._updateLayer(v)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(s,d){this._checkLoaded();const m=this._checkLayer(s);m&&m.slot!==d&&(m.slot=d,this._updateLayer(m))}setFilter(s,d,m={}){this._checkLoaded();const v=this._checkLayer(s);if(v&&!o.by(v.filter,d))return d==null?(v.filter=void 0,void this._updateLayer(v)):void(this._validate(Y,`layers.${v.id}.filter`,d,{layerType:v.type},m)||(v.filter=o.dk(d),this._updateLayer(v)))}getFilter(s){const d=this._checkLayer(s);if(d)return o.dk(d.filter)}setLayoutProperty(s,d,m,v={}){this._checkLoaded();const b=this._checkLayer(s);if(b&&!o.by(b.getLayoutProperty(d),m)){if(m!=null&&(!v||v.validate!==!1)&&Lu(b,ve.call(So,{key:`layers.${s}.layout.${d}`,layerType:b.type,objectKey:d,value:m,styleSpec:o.a6,style:{glyphs:!0,sprite:!0}})))return;b.setLayoutProperty(d,m),b.configDependencies.size!==0&&this._configDependentLayers.add(b.fqid),this._updateLayer(b)}}getLayoutProperty(s,d){const m=this._checkLayer(s);if(m)return m.getLayoutProperty(d)}setPaintProperty(s,d,m,v={}){this._checkLoaded();const b=this._checkLayer(s);if(!b||o.by(b.getPaintProperty(d),m)||m!=null&&(!v||v.validate!==!1)&&Lu(b,ie.call(So,{key:`layers.${s}.paint.${d}`,layerType:b.type,objectKey:d,value:m,styleSpec:o.a6})))return;const S=b.setPaintProperty(d,m);b.configDependencies.size!==0&&this._configDependentLayers.add(b.fqid),S&&this._updateLayer(b),this._changes.updatePaintProperties(b)}getPaintProperty(s,d){const m=this._checkLayer(s);if(m)return m.getPaintProperty(d)}setFeatureState(s,d){if(this._checkLoaded(),"target"in s){if("featuresetId"in s.target){const{featuresetId:k,importId:O}=s.target,z=this.getFragmentStyle(O),U=z.getFeaturesetLayers(k);for(const{source:F,sourceLayer:H}of U)z.setFeatureState({id:s.id,source:F,sourceLayer:H},d)}else if("layerId"in s.target){const{layerId:k}=s.target,O=this.getLayer(k);this.setFeatureState({id:s.id,source:O.source,sourceLayer:O.sourceLayer},d)}return}const m=s.source,v=s.sourceLayer,b=this._checkSource(m);if(!b)return;const S=b.type;if(S==="geojson"&&v)return void this.fire(new o.y(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(S==="vector"&&!v)return void this.fire(new o.y(new Error("The sourceLayer parameter must be provided for vector source types.")));s.id===void 0&&this.fire(new o.y(new Error("The feature id parameter must be provided.")));const E=this.getOwnSourceCaches(m);for(const k of E)k.setFeatureState(v,s.id,d)}removeFeatureState(s,d){if(this._checkLoaded(),"target"in s){if("featuresetId"in s.target){const{featuresetId:k,importId:O}=s.target,z=this.getFragmentStyle(O),U=z.getFeaturesetLayers(k);for(const{source:F,sourceLayer:H}of U)z.removeFeatureState({id:s.id,source:F,sourceLayer:H},d)}else if("layerId"in s.target){const{layerId:k}=s.target,O=this.getLayer(k);this.removeFeatureState({id:s.id,source:O.source,sourceLayer:O.sourceLayer},d)}return}const m=s.source,v=this._checkSource(m);if(!v)return;const b=v.type,S=b==="vector"?s.sourceLayer:void 0;if(b==="vector"&&!S)return void this.fire(new o.y(new Error("The sourceLayer parameter must be provided for vector source types.")));if(d&&typeof s.id!="string"&&typeof s.id!="number")return void this.fire(new o.y(new Error("A feature id is required to remove its specific state property.")));const E=this.getOwnSourceCaches(m);for(const k of E)k.removeFeatureState(S,s.id,d)}getFeatureState(s){if(this._checkLoaded(),"target"in s){let b;if("featuresetId"in s.target){const{featuresetId:S,importId:E}=s.target,k=this.getFragmentStyle(E),O=k.getFeaturesetLayers(S);for(const{source:z,sourceLayer:U}of O){const F=k.getFeatureState({id:s.id,source:z,sourceLayer:U});if(F&&!b)b=F;else if(!o.by(b,F))return void this.fire(new o.y(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in s.target){const{layerId:S}=s.target,E=this.getLayer(S);b=this.getFeatureState({id:s.id,source:E.source,sourceLayer:E.sourceLayer})}return b}const d=s.source,m=s.sourceLayer,v=this._checkSource(d);if(v){if(v.type!=="vector"||m)return s.id===void 0&&this.fire(new o.y(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(d)[0].getFeatureState(m,s.id);this.fire(new o.y(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(s){return this.stylesheet.transition=Object.assign({},this.stylesheet.transition,s),this.transition=this.stylesheet.transition,this}getTransition(){return Object.assign({},this.stylesheet.transition)}serialize(){this._checkLoaded();const s=this.getTerrain(),d=s&&this.terrain&&this.terrain.scope===this.scope?s:this.stylesheet.terrain;return o.dr({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:d,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},m=>m!==void 0)}_updateFilteredLayers(s){for(const d of Object.values(this._mergedLayers))s(d)&&this._updateLayer(d)}_updateLayer(s){this._changes.updateLayer(s);const d=this.getLayerSourceCache(s),m=o.B(s.source,s.scope),v=this._changes.getUpdatedSourceCaches();s.source&&!v[m]&&d&&d.getSource().type!=="raster"&&(this._changes.updateSourceCache(m,"reload"),d.pause()),s.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(s){const d=E=>this._mergedLayers[E].is3D(!!this.terrain),m=this.order,v={},b=[];for(let E=m.length-1;E>=0;E--){const k=m[E];if(d(k)){v[k]=E;for(const O of s){const z=O[k];if(z)for(const U of z)b.push(U)}}}b.sort((E,k)=>k.intersectionZ-E.intersectionZ);const S=[];for(let E=m.length-1;E>=0;E--){const k=m[E];if(d(k))for(let O=b.length-1;O>=0;O--){const z=b[O].feature;if(z.layer&&v[z.layer.id]<E)break;S.push(z),b.pop()}else for(const O of s){const z=O[k];if(z)for(const U of z)S.push(U.feature)}}return S}queryRasterValue(s,d,m){const v=this.getOwnSource(s);return v?v.type!=="raster-array"?(this.fire(new o.y(new Error('queryRasterValue support only "raster-array" sources.'))),Promise.resolve(null)):v.queryRasterArrayValue(d,m):(this.fire(new o.y(new Error(`Source with id "${s}" does not exist in the style.`))),Promise.resolve(null))}queryRenderedFeatures(s,d,m){let v;d&&!Array.isArray(d)&&d.filter&&(this._validate(Y,"queryRenderedFeatures.filter",d.filter,null,d),v=o.b6(d.filter));const b={},S=z=>{if(dh.has(z.type))return;const U=this.getOwnLayerSourceCache(z),F=b[U.id]=b[U.id]||{sourceCache:U,layers:{},has3DLayers:!1};z.is3D(!!this.terrain)&&(F.has3DLayers=!0),F.layers[z.fqid]=F.layers[z.fqid]||{styleLayer:z,targets:[]},F.layers[z.fqid].targets.push({filter:v})};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new o.y(new Error("parameters.layers must be an Array."))),[];for(const z of d.layers){const U=this._layers[z];if(!U)return this.fire(new o.y(new Error(`The layer '${z}' does not exist in the map's style and cannot be queried for features.`))),[];S(U)}}else for(const z in this._layers)S(this._layers[z]);const E=this._queryRenderedFeatures(s,b,m),k=this._flattenAndSortRenderedFeatures(E),O=[];for(const z of k)o.ds(z.layer.id)===this.scope&&O.push(z);return O}queryRenderedFeatureset(s,d,m){let v;d&&!Array.isArray(d)&&d.filter&&(this._validate(Y,"queryRenderedFeatures.filter",d.filter,null,d),v=o.b6(d.filter));const b="mock",S=[];if(d&&d.target)S.push(Object.assign({},d,{targetId:b,filter:v}));else{const z=this.getFeaturesetDescriptors();for(const U of z)S.push({targetId:b,filter:v,target:U});for(const{style:U}of this.fragments){const F=U.getFeaturesetDescriptors();for(const H of F)S.push({targetId:b,filter:v,target:H})}}const E=this.queryRenderedTargets(s,S,m),k=[],O=new Set;for(const z of E)for(const U of z.variants[b])is(U,z,O)||k.push(new o.dt(z,U));return k}queryRenderedTargets(s,d,m){const v={},b=(E,k,O,z)=>{const U=v[k.id]=v[k.id]||{sourceCache:k,layers:{},has3DLayers:!1};if(U.layers[E.fqid]=U.layers[E.fqid]||{styleLayer:E,targets:[]},E.is3D(!!this.terrain)&&(U.has3DLayers=!0),!z)return O.uniqueFeatureID=!1,void U.layers[E.fqid].targets.push(O);U.layers[E.fqid].targets.push(Object.assign({},O,{namespace:z.namespace,properties:z.properties,uniqueFeatureID:z.uniqueFeatureID}))};for(const E of d)if("featuresetId"in E.target){const{featuresetId:k,importId:O}=E.target,z=this.getFragmentStyle(O);if(!z||!z._featuresetSelectors)continue;const U=z._featuresetSelectors[k];if(!U){this.fire(new o.y(new Error(`The featureset '${k}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const F of U){const H=z.getOwnLayer(F.layerId);H&&!dh.has(H.type)&&b(H,z.getOwnLayerSourceCache(H),E,F)}}else if("layerId"in E.target){const{layerId:k}=E.target,O=this.getLayer(k);if(!O||dh.has(O.type))continue;b(O,this.getLayerSourceCache(O),E)}const S=this._queryRenderedFeatures(s,v,m);return this._flattenAndSortRenderedFeatures(S)}_queryRenderedFeatures(s,d,m){const v=[],b=!!this.map._showQueryGeometry,S=Cr.createFromScreenPoints(s,m);for(const E in d){const k=rs(S,d[E],this._availableImages,m,b);Object.keys(k).length&&v.push(k)}if(this.placement)for(const E in d){if(!d[E].sourceCache._onlySymbols)continue;const k=Sl(S.screenGeometry,d[E],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData,this.map.getWorldview());Object.keys(k).length&&v.push(k)}return v}querySourceFeatures(s,d){const m=d&&d.filter;m&&this._validate(Y,"querySourceFeatures.filter",m,null,d);let v=[];const b=this.getOwnSourceCaches(s);for(const S of b)v=v.concat(Ko(S,d));return v}addSourceType(s,d,m){return nl.getSourceType(s)?m(new Error(`A source type called "${s}" already exists.`)):(nl.setSourceType(s,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:s,url:d.workerSourceURL},m):m(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(s,d,m={}){this._checkLoaded();const v=this.light.getLight();let b=!1;for(const E in s)if(!o.by(s[E],v[E])){b=!0;break}if(!b)return;const S=this._getTransitionParameters();this.light.setLight(s,d,m),this.light.updateTransitions(S)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=o.o.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&o.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(s,d=1){if(this._checkLoaded(),!s)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),d===0&&delete this.terrain,s===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let m=s;const v=s.source==null;if(d===1){if(this.disableElevatedTerrain)return;if(typeof m.source=="object"){const E="terrain-dem-src";this.addSource(E,m.source),m=o.dk(m),m=Object.assign(m,{source:E})}const b=Object.assign({},m),S={};if(this.terrain&&v){b.source=this.terrain.get().source;const E=this.terrain?this.getFragmentStyle(this.terrain.scope):null;E&&(S.style=E.serialize())}if(this._validate(Dt,"terrain",b,S))return}if(!this.terrain||this.terrain.scope!==this.scope&&!v||this.terrain&&d!==this.terrain.drapeRenderMode){if(!m)return;this._createTerrain(m,d),this.fire(new o.z("data",{dataType:"style"}))}else{const b=this.terrain,S=b.get();for(const E of Object.keys(o.a6.terrain))!m.hasOwnProperty(E)&&o.a6.terrain[E].default&&(m[E]=o.a6.terrain[E].default);for(const E in s)if(!o.by(s[E],S[E])){b.set(s,this.options),this.stylesheet.terrain=s;const k=this._getTransitionParameters({duration:0});b.updateTransitions(k),this.fire(new o.z("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(s){const d=this.fog=new ei(s,this.map.transform,this.scope,this.options);this.stylesheet.fog=d.get();const m=this._getTransitionParameters({duration:0});d.updateTransitions(m)}_createSnow(s){const d=this.snow=new no(s,this.map.transform,this.scope,this.options);this.stylesheet.snow=d.get();const m=this._getTransitionParameters({duration:0});d.updateTransitions(m)}_createRain(s){const d=this.rain=new ir(s,this.map.transform,this.scope,this.options);this.stylesheet.rain=d.get();const m=this._getTransitionParameters({duration:0});d.updateTransitions(m)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const s of this.map._markers)s._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(s){if(this._checkLoaded(),!s)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const d=this.fog;if(!o.by(d.get(),s)){d.set(s,this.options),this.stylesheet.fog=d.get();const m=this._getTransitionParameters({duration:0});d.updateTransitions(m)}}else this._createFog(s);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(s){if(this._checkLoaded(),!s)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const d=this.snow;if(!o.by(d.get(),s)){d.set(s,this.options),this.stylesheet.snow=d.get();const m=this._getTransitionParameters({duration:0});d.updateTransitions(m)}}else this._createSnow(s);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(s){if(this._checkLoaded(),!s)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const d=this.rain;if(!o.by(d.get(),s)){d.set(s,this.options),this.stylesheet.rain=d.get();const m=this._getTransitionParameters({duration:0});d.updateTransitions(m)}}else this._createRain(s);this._markersNeedUpdate=!0}_reloadColorTheme(){const s=()=>{for(const v in this._layers)this._layers[v].lut=this._styleColorTheme.lut;for(const v in this._sourceCaches)this._sourceCaches[v].clearTiles()},d=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!d)return this._styleColorTheme.lut=null,void s();const m=this._evaluateColorThemeData(d);this._loadColorTheme(m).then(()=>{this.fire(new o.z("colorthemeset")),s()}).catch(v=>{o.w(`Couldn't set color theme: ${v}`)})}setColorTheme(s){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&o.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=s,this._reloadColorTheme()}setImportColorTheme(s,d){const m=this.getFragmentStyle(s);m&&(m._styleColorTheme.colorThemeOverride=d,m._reloadColorTheme())}_getTransitionParameters(s){return{now:o.o.now(),transition:Object.assign(this.transition,s)}}updateDrapeFirstLayers(){if(!this.terrain)return;const s=[],d=[];for(const m of this._mergedOrder)this.isLayerDraped(this._mergedLayers[m])?s.push(m):d.push(m);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...s),this._drapedFirstOrder.push(...d)}_createTerrain(s,d){const m=this.terrain=new st(s,d,this.scope,this.options,this.map.getWorldview());d===1&&(this.stylesheet.terrain=s),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const v=this._getTransitionParameters({duration:0});m.updateTransitions(v)}_force3DLayerUpdate(){for(const s in this._layers){const d=this._layers[s];d.type==="fill-extrusion"&&this._updateLayer(d)}}_forceSymbolLayerUpdate(){for(const s in this._layers){const d=this._layers[s];d.type==="symbol"&&this._updateLayer(d)}}_validate(s,d,m,v,b={}){if(b&&b.validate===!1)return!1;const S=Object.assign({},this.serialize());return Lu(this,s.call(So,Object.assign({key:d,style:S,value:m,styleSpec:o.a6},v)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.du.off("pluginStateChange",this._rtlTextPluginCallback);for(const s in this._mergedLayers)this._mergedLayers[s].setEventedParent(null);for(const s in this._mergedSourceCaches)this._mergedSourceCaches[s].clearTiles(),this._mergedSourceCaches[s].setEventedParent(null);this.imageManager.removeScope(this.scope),this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this.modelManager.setEventedParent(null),this.modelManager.destroy(),this.dispatcher.remove())}clearSource(s){const d=this.getSourceCaches(s);for(const m of d)m.clearTiles()}clearSources(){for(const s in this._mergedSourceCaches)this._mergedSourceCaches[s].clearTiles()}clearLayers(){for(const s in this._mergedLayers){const d=this._mergedLayers[s];d._clear&&d._clear()}}reloadSource(s){const d=this.getSourceCaches(s);for(const m of d)m.resume(),m.reload()}reloadSources(){for(const s of this.getSources())s.reload&&s.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(s=>{s.modelManager.reloadModels(s.scope)})}updateSources(s){let d;this.directionalLight&&(d=xd(this.directionalLight));const m=new Set;for(const v in this._mergedLayers){const b=this._mergedLayers[v];b.hasElevation()&&!m.has(b.source)&&m.add(b.source)}for(const v in this._mergedSourceCaches){const b=this._mergedSourceCaches[v],S=m.has(b._source.id);b.update(s,void 0,void 0,d,S)}}_generateCollisionBoxes(){for(const s in this._sourceCaches){const d=this._sourceCaches[s];d.resume(),d.reload()}}_updatePlacement(s,d,m,v,b,S,E=!1){let k=!1,O=!1;const z={},U={};for(const F of this._mergedOrder){const H=this._mergedLayers[F];if(H.type!=="symbol")continue;const G=o.B(H.source,H.scope);let W=z[G];if(!W){const X=this.getLayerSourceCache(H);if(!X)continue;const re=X.getRenderableIds(!0).map(he=>X.getTileByID(he));U[G]=re.slice(),W=z[G]=re.sort((he,pe)=>pe.tileID.overscaledZ-he.tileID.overscaledZ||(he.tileID.isLessThan(pe.tileID)?-1:1))}const ne=this.crossTileSymbolIndex.addLayer(H,W,d.center.lng,d.projection);k=k||ne}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),E=E||this._layerOrderChanged||v===0,this._layerOrderChanged&&this.fire(new o.z("neworder")),(E||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.o.now(),d.zoom))&&(this.pauseablePlacement=new Co(d,this._mergedOrder,E,m,v,b,this.placement,this.fog&&d.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,z,U,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.o.now()),O=!0),k&&this.pauseablePlacement.placement.setStale()),O||k){this._buildingIndex.onNewFrame(d.zoom);for(let F=0;F<this._mergedOrder.length;F++){const H=this._mergedLayers[this._mergedOrder[F]];if(H.type!=="symbol")continue;const G=this.isLayerClipped(H);this.placement.updateLayerOpacities(H,z[o.B(H.source,H.scope)],F,G?S:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.o.now())}}_releaseSymbolFadeTiles(){for(const s in this._sourceCaches)this._sourceCaches[s].releaseSymbolFadeTiles()}addImport(s,d){this._checkLoaded();const m=this.stylesheet.imports=this.stylesheet.imports||[];if(m.findIndex(({id:b})=>b===s.id)!==-1)return void this.fire(new o.y(new Error(`Import with id '${s.id}' already exists in the map's style.`)));if(!d)return m.push(s),this._loadImports([s],!0);const v=m.findIndex(({id:b})=>b===d);return v===-1&&this.fire(new o.y(new Error(`Import with id "${d}" does not exist on this map.`))),this.stylesheet.imports=m.slice(0,v).concat(s).concat(m.slice(v)),this._loadImports([s],!0,d)}updateImport(s,d){this._checkLoaded();const m=this.stylesheet.imports||[],v=this.getImportIndex(s);return v===-1?this:typeof d=="string"?(this.setImportUrl(s,d),this):(d.url&&d.url!==m[v].url&&this.setImportUrl(s,d.url),o.by(d.config,m[v].config)||this.setImportConfig(s,d.config,d.data.schema),o.by(d.data,m[v].data)||this.setImportData(s,d.data),this)}moveImport(s,d){this._checkLoaded();let m=this.stylesheet.imports||[];const v=this.getImportIndex(s);if(v===-1)return this;const b=this.getImportIndex(d);if(b===-1)return this;const S=m[v],E=this.fragments[v];return m=m.filter(({id:k})=>k!==s),this.fragments=this.fragments.filter(({id:k})=>k!==s),this.stylesheet.imports=m.slice(0,b).concat(S).concat(m.slice(b)),this.fragments=this.fragments.slice(0,b).concat(E).concat(this.fragments.slice(b)),this.mergeLayers(),this}setImportUrl(s,d){this._checkLoaded();const m=this.stylesheet.imports||[],v=this.getImportIndex(s);if(v===-1)return this;m[v].url=d;const b=this.fragments[v];return b.style=this._createFragmentStyle(m[v]),b.style.on("style.import.load",()=>this.mergeAll()),b.style.loadURL(d),this}setImportData(s,d){this._checkLoaded();const m=this.getImportIndex(s),v=this.stylesheet.imports||[];return m===-1?this:d?(this.fragments[m].style.setState(d),this._reloadImports(),this):(delete v[m].data,this.setImportUrl(s,v[m].url))}setImportConfig(s,d,m){this._checkLoaded();const v=this.getImportIndex(s),b=this.stylesheet.imports||[];if(v===-1)return this;d?b[v].config=d:delete b[v].config;const S=this.fragments[v];m&&S.style.stylesheet&&(S.style.stylesheet.schema=m);const E=S.style.stylesheet&&S.style.stylesheet.schema;return S.config=d,S.style.updateConfig(d,E),this.updateConfigDependencies(),this}removeImport(s){this._checkLoaded();const d=this.stylesheet.imports||[],m=this.getImportIndex(s);m!==-1&&(d.splice(m,1),this.fragments[m].style._remove(),this.fragments.splice(m,1),this._reloadImports())}getImportIndex(s){const d=(this.stylesheet.imports||[]).findIndex(m=>m.id===s);return d===-1&&this.fire(new o.y(new Error(`Import '${s}' does not exist in the map's style and cannot be updated.`))),d}getLayer(s){return this._mergedLayers[s]}getSources(){const s=[];for(const d in this._mergedOtherSourceCaches){const m=this._mergedOtherSourceCaches[d];m&&s.push(m.getSource())}return s}getSource(s,d){const m=this.getSourceCache(s,d);return m&&m.getSource()}getLayerSource(s){const d=this.getLayerSourceCache(s);return d&&d.getSource()}getSourceCache(s,d){const m=o.B(s,d);return this._mergedOtherSourceCaches[m]}getLayerSourceCache(s){const d=o.B(s.source,s.scope);return s.type==="symbol"?this._mergedSymbolSourceCaches[d]:this._mergedOtherSourceCaches[d]}getSourceCaches(s){if(s==null)return Object.values(this._mergedSourceCaches);const d=[];return this._mergedOtherSourceCaches[s]&&d.push(this._mergedOtherSourceCaches[s]),this._mergedSymbolSourceCaches[s]&&d.push(this._mergedSymbolSourceCaches[s]),d}updateSourceCaches(){const s=this._changes.getUpdatedSourceCaches();for(const d in s){const m=s[d];m==="reload"?this.reloadSource(d):m==="clear"&&this.clearSource(d)}}updateLayers(s){const d=this._changes.getUpdatedPaintProperties();for(const m of d){const v=this.getLayer(m);v&&v.updateTransitions(s)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(s){this.stylesheet.glyphs=s,this.glyphManager.setURL(s)}getImages(s,d,m){this.imageManager.getImages(d.images,d.scope,m),this._updateTilesForChangedImages();const v=S=>{if(S){const E=d.images.map(k=>o.I.toString(k));S.setDependencies(d.tileID.key,d.type,E)}},b=o.B(d.source,d.scope);v(this._mergedOtherSourceCaches[b]),v(this._mergedSymbolSourceCaches[b]),d.images.some(S=>S.iconsetId)&&this.fire(new o.z("data",{dataType:"style"}))}rasterizeImages(s,d,m){this.imageManager.rasterizeImages(d,m)}getGlyphs(s,d,m){this.glyphManager.getGlyphs(d.stacks,m)}getResource(s,d,m){return o.dv(d,m)}getOwnSourceCache(s){return this._otherSourceCaches[s]}getOwnLayerSourceCache(s){return s.type==="symbol"?this._symbolSourceCaches[s.source]:this._otherSourceCaches[s.source]}getOwnSourceCaches(s){const d=[];return this._otherSourceCaches[s]&&d.push(this._otherSourceCaches[s]),this._symbolSourceCaches[s]&&d.push(this._symbolSourceCaches[s]),d}_isSourceCacheLoaded(s){const d=this.getOwnSourceCaches(s);return d.length===0?(this.fire(new o.y(new Error(`There is no source with ID '${s}'`))),!1):d.every(m=>m.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(s,d){if(!this._clipLayerPresent&&s.type!=="fill-extrusion"&&s.type!=="building")return!1;const m=s.type==="fill-extrusion"&&(s.sourceLayer==="building"||s.sourceLayer==="procedural_buildings"),v=s.type==="building";if(s.is3D(!!this.terrain)){if(m||v||d&&d.type==="batched-model"||s.type==="model")return!0}else if(s.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(s=>{s.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}nl.getSourceType=function(g){return xl[g]},nl.setSourceType=function(g,s){xl[g]=s},nl.registerForPluginStateChange=o.dw;class Jc{execute(s){const d=this._makeBuildingsQueryArea(s),m=this._makeFloorsQueryArea(s),v=s.queryRenderedFeatures(d).reduce((O,z)=>{const U=z.properties.id;return z.properties.type!=="building"||O.some(F=>F.properties.id===U)||O.push(z),O},[]),b=s.queryRenderedFeatures(m).reduce((O,z)=>{const U=z.properties.id;return z.properties.type!=="floor"||O.some(F=>F.properties.id===U)||O.push(z),O},[]),S=[s.getCenter().lng,s.getCenter().lat],E=this._findBuildingAtCenter(S,v),k=v.length>0?v[0]:null;return{floors:b.map(O=>({id:O.properties.id,name:O.properties.name,isDefault:O.properties.is_default,zIndex:O.properties.z_index,connectedFloorIds:O.properties.connected_floor_ids,conflictedFloorIds:O.properties.conflicted_floor_ids,buildingIds:O.properties.building_ids})),building:E?{id:E.properties.id,name:E.properties.name}:{id:k.properties.id,name:k.properties.name}}}_makeBuildingsQueryArea(s){const d=s.transform.width,m=s.transform.height,v=Math.min(d,m)*(1/8),b=.5*(d-v),S=.5*(m-v);return[new o.P(b,S),new o.P(b+v,S+v)]}_makeFloorsQueryArea(s){const d=s.transform.width,m=s.transform.height;return[new o.P(0,0),new o.P(d,m)]}_findBuildingAtCenter(s,d){for(const m of d)if(m.geometry.type==="Polygon"&&this._pointInPolygon(s,m.geometry.coordinates[0]))return m;return null}_pointInPolygon(s,d){let m=!1;for(let v=0,b=d.length-1;v<d.length;b=v++){const S=d[v][0],E=d[v][1],k=d[b][1];E>s[1]!=k>s[1]&&s[0]<(d[b][0]-S)*(s[1]-E)/(k-E)+S&&(m=!m)}return m}}class ec{constructor(){this._floors=new Map,this._buildings=new Map}append(s){const d=s.building;let m=!1;if(d){const v=d.id;v&&(this._buildings.set(v,d),m||this._buildings.has(v)||(m=!0))}return s.floors.forEach(v=>{const b=v.id;m||this._floors.has(b)||(m=!0),this._floors.set(b,v)}),m}clear(){this._floors.clear(),this._buildings.clear()}getFloors(s=null){const d=Array.from(this._floors.values());return s?d.filter(m=>{const v=m.buildingIds;return!!v&&v.split(";").includes(s)}):d}}class Qp{constructor(){this._selectedFloorId=null,this._selectedBuildingId=null,this._lastActiveFloors=[],this._featuresStorage=new ec}setIndoorData(s){const d=this._featuresStorage.append(s);return this._selectedBuildingId=s.building?s.building.id:null,d}setFloorId(s){const d=this._selectedFloorId!==s;return d&&(this._selectedFloorId=s),d}getCurrentBuildingSelection(){if(!this._selectedBuildingId)return{selectedFloorId:null,floors:[]};const s=this._featuresStorage.getFloors(this._selectedBuildingId),d=this.getActiveFloors().find(m=>{const v=m.buildingIds;if(!v)return!1;const b=v.split(";");return!!this._selectedBuildingId&&b.includes(this._selectedBuildingId)});return{selectedFloorId:d?d.id:null,floors:s}}getActiveFloors(s=!1){const d=this._featuresStorage.getFloors(),m=d.find(k=>k.id===this._selectedFloorId),v=d.filter(k=>k.isDefault===!0);let b=[];if(m)return b=this._calculateCurrentActiveFloors(d,m,v,s),b;if(v.length===0){const k=this._featuresStorage.getFloors(this._selectedBuildingId);b=k.length>0?[k[0]]:[]}else b=v;const S=this._getNonConflictingLastActiveFloors(b),E=[...b,...S];return this._lastActiveFloors=E,E}hasBuildingChanged(s){return this._selectedBuildingId!==(s.building?s.building.id:null)}hasActiveBuilding(){return this._selectedBuildingId!==null}isEmpty(){return this._selectedFloorId===null&&this._selectedBuildingId===null&&this._lastActiveFloors.length===0}_calculateCurrentActiveFloors(s,d,m,v){if(!d)return this._getNonConflictingDefaultFloors(this._lastActiveFloors,m);const b=this._getConnectedFloors(d,s);return v?this._buildExplicitSelectionFloors(d,b,m):this._buildImplicitSelectionFloors(b,m)}_getConnectedFloors(s,d){const m=s.connectedFloorIds;if(!m)return[];const v=new Set(m.split(";"));return d.filter(b=>v.has(b.id))}_buildExplicitSelectionFloors(s,d,m){const v=[s,...d],b=this._getNonConflictingLastActiveFloors(v),S=[...v,...b],E=this._deduplicateFloors(S),k=this._getConflictingFloorIdsFrom(E),O=m.filter(U=>!k.has(U.id)),z=[...E,...O];return this._lastActiveFloors=z,z}_buildImplicitSelectionFloors(s,d){const m=this._getConflictingFloorIdsFrom(this._lastActiveFloors),v=d.filter(S=>!m.has(S.id)),b=this._deduplicateFloors([...this._lastActiveFloors,...v]);return this._lastActiveFloors=b,b}_getNonConflictingDefaultFloors(s,d){const m=this._getConflictingFloorIdsFrom(s),v=d.filter(S=>!m.has(S.id)),b=this._deduplicateFloors([...s,...v]);return this._lastActiveFloors=b,b}_deduplicateFloors(s){const d=new Set;return s.filter(m=>{const v=m.id;return!d.has(v)&&(d.add(v),!0)})}_getConflictingFloorIdsFrom(s){const d=new Set;return s.forEach(m=>{const v=m.conflictedFloorIds;v&&v.split(";").forEach(b=>d.add(b))}),d}_getNonConflictingLastActiveFloors(s){if(!this._lastActiveFloors||this._lastActiveFloors.length===0)return[];const d=new Set(s.map(v=>v.id)),m=this._getConflictingFloorIdsFrom(s);return this._lastActiveFloors.filter(v=>{const b=v.id;return!d.has(b)&&!m.has(b)})}_isFloorConflicted(s,d){const m=s.id;return d.some(v=>{const b=v.conflictedFloorIds;return!!b&&b.split(";").includes(m)})}reset(){this._selectedFloorId=null,this._selectedBuildingId=null,this._lastActiveFloors=[],this._featuresStorage.clear()}}class zu extends o.E{constructor(s){super(),o.aY(["_onLoad","_onMove"],this),this._map=s,this._floorSelectionState=new Qp,this._queryIndoor(),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.off("load",this._onLoad),this._map.off("move",this._onMove),this._map=null,this._floorSelectionState=null}selectFloor(s){this._floorSelectionState.setFloorId(s)&&this._updateIndoorConfig(!0)}_onLoad(){this._map.style.forEachFragmentStyle(s=>{s.stylesheet.indoor&&(this._indoorDataQuery?this.fire(new o.y(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._scope=s.scope,this._indoorDataQuery=new Jc))}),this._map._addIndoorControl(),this._queryIndoor()}_onMove(){this._queryIndoor()}_queryIndoor(){if(!this._indoorDataQuery||!this._map.isStyleLoaded())return;if(this._map.transform.zoom<15)return void this._clearIndoorData();const s=this._indoorDataQuery.execute(this._map);if(!s||s.floors.length===0||this._map.transform.zoom<16)this._clearIndoorData();else if(this._floorSelectionState.hasBuildingChanged(s)){if(!s.building&&this._floorSelectionState.getActiveFloors().length<=0)return void this._clearIndoorData();this._setIndoorData(s),s.building&&this._updateIndoorSelector()}else this._setIndoorData(s)}_setIndoorData(s){this._floorSelectionState.setIndoorData(s)&&this._updateIndoorConfig()}_clearIndoorData(){this._floorSelectionState.isEmpty()||(this._floorSelectionState.reset(),this._updateIndoorSelector(),this._map.setConfigProperty(this._scope,"activeFloors",["literal",[]]))}_updateIndoorSelector(){const s=this._floorSelectionState.getCurrentBuildingSelection(),d=s.floors.map(m=>({id:m.id,name:m.name,shortName:m.zIndex.toString(),levelOrder:m.zIndex}));this.fire(new o.z("indoorupdate",{selectedFloorId:s.selectedFloorId,floors:d}))}_updateIndoorConfig(s=!1){const d=this._floorSelectionState.getActiveFloors(s).map(m=>m.id)||[];this._map.setConfigProperty(this._scope,"activeFloors",["literal",d])}}var wd=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,bf=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb*col.a,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,xf=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,Bu="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Sd=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,em=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,wf=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;
#ifdef FLIP_Y
uv.y=1.0-uv.y;
#endif
highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,Ea=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,hh=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,Ut=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,tm=`#ifdef RENDER_SHADOWS
precision highp sampler2DShadow;uniform sampler2DShadow u_shadowmap_0;uniform sampler2DShadow u_shadowmap_1;uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;float shadow_sample(sampler2DShadow shadowmap,highp vec3 pos,highp float bias) {
#ifdef CLIP_ZERO_TO_ONE
highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z-bias);
#else
highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z*0.5+0.5-bias);
#endif
return texture(shadowmap,coord);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {light_view_pos0.xyz/=light_view_pos0.w;
#ifdef SHADOWS_SINGLE_CASCADE
vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);
#else
light_view_pos1.xyz/=light_view_pos1.w;vec4 abs_bounds=abs(vec4(light_view_pos0.xy,light_view_pos1.xy));if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}float occlusion1=shadow_sample(u_shadowmap_1,light_view_pos1.xyz,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const Cd=[];il(wd,Cd),il(xf,Cd),il(bf,Cd);const Td={"_prelude_fog.vertex.glsl":em,"_prelude_terrain.vertex.glsl":Sd,"_prelude_shadow.vertex.glsl":Ut,"_prelude_fog.fragment.glsl":wf,"_prelude_shadow.fragment.glsl":tm,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":Ea,"_prelude_raster_particle.glsl":hh},fh={};Ii("",Sd),Ii(wf,em),Ii(tm,Ut),Ii(Ea,""),Ii(hh,"");const Ua=Ii(bf,xf),kl=wd;var Sf={background:Ii(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Ii(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),building:Ii(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
const float window_depth=0.5;const float ao_radius=0.2;in vec4 v_color;in highp vec3 v_normal;in highp vec3 v_pos;
#ifdef BUILDING_FAUX_FACADE
in lowp float v_faux_facade;in highp float v_faux_facade_ed;in highp vec2 v_faux_facade_window;in highp vec2 v_faux_facade_floor;in highp vec2 v_faux_facade_range;in highp float v_aspect;in highp vec3 v_tbn_0;in highp vec3 v_tbn_1;in highp vec3 v_tbn_2;in highp vec4 v_faux_color_emissive;uniform float u_faux_facade_ao_intensity;
#endif
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
uniform lowp float u_opacity;uniform vec3 u_camera_pos;uniform highp float u_tile_to_meter;uniform float u_facade_emissive_chance;vec3 linearTosRGB(in vec3 color) {return pow(color,vec3(1./2.2));}
#ifdef BUILDING_FAUX_FACADE
float hash12(in vec2 p) {vec3 p3 =fract(vec3(p.xyx)*0.1031);p3+=dot(p3,p3.yzx+33.33);return fract((p3.x+p3.y)*p3.z);}float min3(in vec3 v) {return min(min(v.x,v.y),v.z);}vec2 get_uv_mask_id(in vec2 q,out float mask,out vec2 id) {vec2 p=q;mask=step(v_faux_facade_range.x,p.y)*step(p.y,v_faux_facade_range.y);p.y=p.y-v_faux_facade_range.x;vec2 uv=modf(p/v_faux_facade_floor,id);vec4 d=(v_faux_facade_floor.xyxy+vec4(-v_faux_facade_window,v_faux_facade_window))*0.5;vec4 edge=d/v_faux_facade_floor.xyxy;vec2 m=step(edge.xy,uv)*step(uv,edge.zw);mask*=m.x*m.y;uv-=vec2(0.5);uv*=vec2(0.5)/(vec2(0.5)-edge.xy);uv+=vec2(0.5);return uv;}float ray_unit_box(in vec3 ray_o,in vec3 ray_d,in vec3 bmin,in vec3 bmax) {vec3 planes=mix(bmin,bmax,step(0.0,ray_d));vec3 t=(planes-ray_o)/ray_d;return min3(t);}float get_emissive(in vec2 id) {if (u_facade_emissive_chance > 0.0) {return (step(hash12(id),u_facade_emissive_chance)+0.05)*v_faux_color_emissive.a;}return 0.0;}vec3 get_shade_info(in vec3 v,in vec3 v_normalized,in vec3 color,in vec2 id,in mat3 tbn,inout vec3 out_normal,inout float out_emissive) {vec3 out_color=color;vec3 abs_v=abs(v_normalized);bool x_major=abs_v.x >=abs_v.y && abs_v.x >=abs_v.z;bool y_major=abs_v.y >=abs_v.x && abs_v.y >=abs_v.z;bool z_major=abs_v.z >=abs_v.x && abs_v.z >=abs_v.y;
#if 0
if (x_major) {out_color=v.x > 0.0 ? vec3(1.0,0.0,0.0) : vec3(0.0,1.0,1.0);} else if (y_major) {out_color=v.y > 0.0 ? vec3(0.0,1.0,0.0) : vec3(1.0,0.0,1.0);} else if (z_major) {out_color=v.z > 0.0 ? vec3(0.0,0.0,1.0) : vec3(1.0,1.0,0.0);}out_emissive=1.0;
#else
if (x_major) {out_normal=sign(v.x)*tbn[0];} else if (y_major) {out_normal=vec3(0.0,0.0,-sign(v.y));} else if (z_major) {out_color=v_faux_color_emissive.rgb;out_emissive=v.z <=0.0 ? get_emissive(id) : out_emissive;}float ao=1.0;if (u_faux_facade_ao_intensity > 0.0) {vec4 ao_range=v_faux_facade_window.xxyy*0.5-vec4(0,ao_radius,0,ao_radius);vec2 ao_range_z=vec2(window_depth*0.5)-vec2(0.0,ao_radius);if (x_major || y_major) {ao*=smoothstep(-ao_range_z.x,-ao_range_z.y,v.z);} else if (z_major) {ao*=smoothstep(-ao_range.x,-ao_range.y,v.x)*(1.0-smoothstep(ao_range.y,ao_range.x,v.x));ao*=smoothstep(-ao_range.z,-ao_range.w,v.y)*(1.0-smoothstep(ao_range.w,ao_range.z,v.y));}ao=mix(1.0,min(1.0,ao+0.25),u_faux_facade_ao_intensity);}out_color*=ao;
#endif
return out_color;}
#endif
vec3 apply_lighting_linear(in vec3 color,in vec3 normal,in float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return color*(ambient_contrib+directional_contrib);}void main() {vec3 normal=normalize(v_normal);vec3 base_color=v_color.rgb;float emissive=v_color.a;
#ifdef BUILDING_FAUX_FACADE
if (v_faux_facade > 0.0) {mat3 tbn=mat3(v_tbn_0,v_tbn_1,v_tbn_2);vec3 v=vec3(v_pos.xy,v_pos.z/u_tile_to_meter)-u_camera_pos;vec3 view_tangent=transpose(tbn)*v;vec2 q=vec2(v_faux_facade_ed,v_pos.z);float mask=0.0;vec2 id=vec2(0.0);vec2 uv=get_uv_mask_id(q,mask,id);uv*=v_faux_facade_window;vec3 bmin=vec3(0.0,0.0,-window_depth);vec3 bmax=bmin+vec3(v_faux_facade_window,window_depth);vec3 ray_o=vec3(uv,0.0);vec3 ray_d=normalize(view_tangent);float t_min=ray_unit_box(ray_o,ray_d,bmin,bmax);vec3 hit=ray_o+t_min*ray_d;vec3 r=vec3(v_faux_facade_window,-window_depth);hit-=r*0.5;vec3 normalized=hit/r;vec3 out_normal=normal;float out_emissive=emissive;vec3 room_color=get_shade_info(hit,normalized,base_color,id,tbn,out_normal,out_emissive);base_color=mix(base_color,room_color,mask);normal=mix(normal,out_normal,mask);emissive=mix(emissive,out_emissive,mask);}
#endif
vec4 color=vec4(base_color,1.0);vec3 xy_flipped_normal=vec3(-normal.xy,normal.z);float shadowed_lighting_factor=0.0;
#ifdef RENDER_SHADOWS
shadowed_lighting_factor=shadowed_light_factor_normal(xy_flipped_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
shadowed_lighting_factor=dot(normal,u_lighting_directional_dir);
#endif
color.rgb=apply_lighting_linear(color.rgb,xy_flipped_normal,shadowed_lighting_factor);color.rgb=mix(color.rgb,base_color.rgb,emissive);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,v_pos.z));
#endif
color.rgb=linearTosRGB(color.rgb);color*=u_opacity;
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_pos.z);
#endif
glFragColor=color; 
#ifdef DEBUG_SHOW_NORMALS
color.rgb=xy_flipped_normal*0.5+vec3(0.5,0.5,0.5);color.a=1.0;glFragColor=color;
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;in vec3 a_normal_3;in vec3 a_centroid_3;in vec4 a_faux_facade_data;in vec2 a_faux_facade_vertical_range;uniform mat4 u_matrix;uniform mat4 u_normal_matrix;uniform highp float u_tile_to_meter;out vec4 v_color;out vec3 v_normal;out highp vec3 v_pos;
#ifdef BUILDING_FAUX_FACADE
out lowp float v_faux_facade;out highp float v_faux_facade_ed;out highp vec2 v_faux_facade_window;out highp vec2 v_faux_facade_floor;out highp vec2 v_faux_facade_range;out highp float v_aspect;out highp vec3 v_tbn_0;out highp vec3 v_tbn_1;out highp vec3 v_tbn_2;out highp vec4 v_faux_color_emissive;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
const float MAX_UINT_16=65535.0;const float MAX_INT_16=32767.0;const float MAX_UINT_8=255.0;const float TWO_POW_8=256.0;vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#ifdef BUILDING_FAUX_FACADE
mat3 get_tbn(in vec3 normal) {const vec3 bitangent=vec3(0.0,0.0,1.0);vec3 tangent=normalize(vec3(normal.y,-normal.x,0.0));return mat3(tangent,bitangent,normal);}
#endif
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 faux_facade_color_emissive
void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
#pragma mapbox: initialize-attribute-custom highp vec2 faux_facade_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);v_color=vec4(sRGBToLinear(color_emissive.rgb),color_emissive.a);vec3 a_normal_3f=a_normal_3/MAX_INT_16;v_normal=vec3(u_normal_matrix*vec4(a_normal_3f,0.0));float hidden=0.0;
#ifdef BUILDING_FAUX_FACADE
v_faux_facade=a_faux_facade_data.x;if (v_faux_facade > 0.0) {v_faux_facade_ed=a_faux_facade_data.x *u_tile_to_meter;float window_x_perc=floor(a_faux_facade_data.y/TWO_POW_8);float window_y_perc=a_faux_facade_data.y-TWO_POW_8*window_x_perc;vec2 window_perc=vec2(window_x_perc,window_y_perc)/MAX_UINT_8;v_faux_facade_floor=(a_faux_facade_data.zw/MAX_UINT_16*EXTENT)*u_tile_to_meter;v_faux_facade_window=window_perc*v_faux_facade_floor;v_faux_facade_range=(a_faux_facade_vertical_range/MAX_UINT_16*EXTENT)*u_tile_to_meter;v_aspect=v_faux_facade_window.x/v_faux_facade_window.y;mat3 tbn=get_tbn(normalize(v_normal));v_tbn_0=tbn[0];v_tbn_1=tbn[1];v_tbn_2=tbn[2];v_faux_color_emissive=decode_color(faux_facade_color_emissive);v_faux_color_emissive.rgb=sRGBToLinear(v_faux_color_emissive.rgb);}
#endif
v_pos=a_pos_3f;
#ifdef RENDER_CUTOFF
vec4 ground=u_matrix*vec4(a_centroid_3,1.0);v_cutoff_opacity=cutoff_opacity(u_cutoff_params,ground.z);hidden=float(v_cutoff_opacity==0.0);v_pos.z*=v_cutoff_opacity;
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=v_pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset_model(v_normal);shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1.0);v_depth_shadows=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(v_pos);
#endif
gl_Position=mix(u_matrix*vec4(v_pos,1),AWAY,hidden);}`),buildingBloom:Ii(`in vec4 v_color_emissive;
#pragma mapbox: define-attribute highp vec4 bloom_attenuation
#pragma mapbox: initialize-attribute highp vec4 bloom_attenuation
float saturate(float val) {return clamp(val,0.0,1.0);}void main() {float emission=v_color_emissive.a;float opacity=1.0;
#ifdef HAS_ATTRIBUTE_a_bloom_attenuation
float distance=length(vec2(1.3*max(0.0,abs(bloom_attenuation.x)-bloom_attenuation.z),bloom_attenuation.y));distance+= mix(0.5,0.0,clamp(emission-1.0,0.0,1.0));opacity*=saturate(1.0-distance*distance);
#endif
glFragColor=vec4(v_color_emissive.rgb,1.0)*opacity;}`,`in vec3 a_pos_3f;
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
#pragma mapbox: define-attribute highp vec4 bloom_attenuation
out vec4 v_color_emissive;uniform mat4 u_matrix;vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
#pragma mapbox: initialize-attribute highp vec4 bloom_attenuation
#ifdef HAS_ATTRIBUTE_a_part_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);float part_emissive=color_emissive.a*5.0;v_color_emissive=vec4(sRGBToLinear(color_emissive.rgb),part_emissive);
#else
v_color_emissive=vec4(1.0);
#endif
gl_Position=u_matrix*vec4(a_pos_3f,1.0);}`),buildingDepth:Ii(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,"in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;void main() {gl_Position=u_matrix*vec4(a_pos_3f,1.0);v_depth=gl_Position.z/gl_Position.w;}"),circle:Ii(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Ii("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ii(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Ii(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Ii("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform float u_zoom_transition;
#endif
out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec3 proj_pos=a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation);
#ifdef PROJECTION_GLOBE_VIEW
#ifndef PROJECTED_POS_ON_VIEWPORT
vec3 globe_pos=proj_pos;vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,a_anchor_pos,u_tile_id,u_merc_center);proj_pos=mix_globe_mercator(globe_pos,mercator_pos,u_zoom_transition);
#endif
#endif
vec4 projectedPoint=u_matrix*vec4(proj_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Ii("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Ii("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:Ii(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:Ii(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#else
#ifdef FEATURE_CUTOUT
apply_feature_cutout(vec4(0.0,0.0,0.0,1.0),gl_FragCoord);
#endif
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:Ii(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}vec3 compute_view_dependent_emissive_color(float ndotl,float emissive_strength,vec3 color)
{color=sRGBToLinear(color);color=color*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);color=linearTosRGB(color.rgb);return color;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
vec3 color=structure_color.xyz;
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);vec3 transformed_normal=vec3(-normal.xy,normal.z);float ndotl=calculate_NdotL(transformed_normal);float emissive_strength=u_emissive_strength;emissive_strength=0.0;vec3 emissive_color=compute_view_dependent_emissive_color(ndotl,emissive_strength,color.xyz);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,transformed_normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,transformed_normal);
#endif
color=mix(color,emissive_color,emissive_strength);if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(-v_normal.xy,v_normal.z));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:Ii(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:Ii(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef FLIP_Y
v_pos=(vec2(gl_Position.x,-gl_Position.y)/gl_Position.w+1.0)/2.0*u_world;
#else
v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#endif
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Ii(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
uniform float u_emissive_strength;
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FLIP_Y
v_pos_world=(vec2(gl_Position.x,-gl_Position.y)/gl_Position.w+1.0)/2.0*u_world;
#else
v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#endif
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Ii(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Ii(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
#ifdef FEATURE_CUTOUT
color=apply_feature_cutout(color,gl_FragCoord);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);
#ifdef CLIP_ZERO_TO_ONE
cutoff=cutoff_opacity(u_cutoff_params,ground.z*2.0-ground.w);
#else
cutoff=cutoff_opacity(u_cutoff_params,ground.z);
#endif
if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Ii(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Ii(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Ii(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Ii(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Ii(`precision highp float;uniform highp sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ii(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Ii(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float epsilon=0.0001;float extrude_length_without_perspective=max(length(dist),epsilon);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),epsilon);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:Ii(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef LINE_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
#ifdef LINE_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl*texel_size-texel_size,pattern_b_br*texel_size+texel_size,vec2(x,y));vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);color=color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:Ii(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Ii(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Ii("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Ii("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Ii(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Ii(`#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#else
#ifdef RENDER_SHADOWS
in highp float v_z_offset;
#endif
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef TERRAIN
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#else
out_color.rgb*=mix(v_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#endif
#endif
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef ELEVATED_ROADS
in vec3 a_x_axis;in vec3 a_y_axis;uniform float u_normal_scale;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#else
#ifdef RENDER_SHADOWS
out highp float v_z_offset;
#endif
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+z_offset : 0.0;
#else
z+=u_pitch_with_map ? z_offset : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
#ifdef ELEVATED_ROADS
vec3 xAxis=vec3(a_x_axis.xy,a_x_axis.z*u_normal_scale);vec3 yAxis=vec3(a_y_axis.xy,a_y_axis.z*u_normal_scale);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
pos=vec3(projected_pos.xy/projected_pos.w+offset,z);
#endif
#endif
gl_Position=mix(u_coord_matrix*vec4(pos,1.0),AWAY,hidden);float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef RENDER_SHADOWS
vec4 shd_pos=u_inv_matrix*vec4(pos,1.0);vec3 shd_pos0=shd_pos.xyz;vec3 shd_pos1=shd_pos.xyz;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#else
#ifdef RENDER_SHADOWS
v_z_offset=e;
#endif
#endif
}`),terrainRaster:Ii(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Ii("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Ii(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Bu),skyboxGradient:Ii(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Bu),skyboxCapture:Ii(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Ii(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;
#ifdef FLIP_Y
uv.y=1.0-uv.y;
#endif
highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Ii(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_atmosphere_fog_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_atmosphere_fog_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_atmosphere_fog_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Ii(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;
#ifdef FLIP_Y
T=-T;B=-B;
#endif
highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));
#ifdef FLIP_Y
n=normalize(cross(fdx,fdy));
#else
n=normalize(cross(fdx,fdy))*-1.0;
#endif
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
#ifdef FEATURE_CUTOUT
finalColor=apply_feature_cutout(finalColor,gl_FragCoord);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Ii(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Ii(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:Ii("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:Ii("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:Ii("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:Ii("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function il(g,s){const d=g.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let m of d)if(m=m.trim(),m[0]==="#"&&m.includes("if")&&!m.includes("endif")){m=m.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const v=m.split(" ");for(const b of v)s.includes(b)||s.push(b)}}function Ii(g,s){const d=/#include\s+"([^"]+)"/g,m=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g,v={},b=[],S=[];if(g=g.replace(d,(k,O)=>(S.push(O),"")),(s=s.replace(d,(k,O)=>(b.push(O),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let E=[...Cd];il(g,E),il(s,E);for(const k of[...b,...S])Td[k]||console.error(`Undefined include: ${k}`),fh[k]||(fh[k]=[],il(Td[k],fh[k])),E=[...E,...fh[k]];return{fragmentSource:g=g.replace(m,(k,O,z,U,F)=>(v[F]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_${F}
in ${z} ${U} ${F};
#else
uniform ${z} ${U} u_${F};
#endif
`:O==="initialize"?`
#ifdef HAS_UNIFORM_u_${F}
    ${z} ${U} ${F} = u_${F};
#endif
`:O==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${F}
    in ${z} ${U} ${F};
#endif
`:O==="initialize-attribute"?"":void 0)),vertexSource:s=s.replace(m,(k,O,z,U,F)=>{const H=U==="float"?"vec2":U,G=F.match(/color/)?"color":H;return O==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${F}
in ${z} ${U} a_${F};
#endif
`:v[F]?O==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
in ${z} ${H} a_${F};
out ${z} ${U} ${F};
#else
uniform ${z} ${U} u_${F};
#endif
`:O==="initialize"?G==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = a_${F};
#else
    ${z} ${U} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = unpack_mix_${G}(a_${F}, u_${F}_t);
#else
    ${z} ${U} ${F} = u_${F};
#endif
`:O==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${F}
    in ${z} ${U} a_${F};
    out ${z} ${U} ${F};
#endif
`:O==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${F}
    ${F} = a_${F};
#endif
`:void 0:O==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
in ${z} ${H} a_${F};
#else
uniform ${z} ${U} u_${F};
#endif
`:O==="define-instanced"?G==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${F}0;
in vec4 a_${F}1;
in vec4 a_${F}2;
in vec4 a_${F}3;
#else
uniform ${z} ${U} u_${F};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${z} ${H} a_${F};
#else
uniform ${z} ${U} u_${F};
#endif
`:O==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${F}
    ${z} ${U} ${F} = a_${F};
#endif
`:G==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${z} ${U} ${F} = a_${F};
#else
    ${z} ${U} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${z} ${U} ${F} = unpack_mix_${G}(a_${F}, u_${F}_t);
#else
    ${z} ${U} ${F} = u_${F};
#endif
`}),usedDefines:E,vertexIncludes:b,fragmentIncludes:S}}class Ed{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(s,d,m,v,b,S,E,k){this.context=s;let O=this.boundPaintVertexBuffers.length!==v.length;for(let U=0;!O&&U<v.length;U++)this.boundPaintVertexBuffers[U]!==v[U]&&(O=!0);let z=this.boundDynamicVertexBuffers.length!==E.length;for(let U=0;!z&&U<E.length;U++)this.boundDynamicVertexBuffers[U]!==E[U]&&(z=!0);if(!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==m||O||z||this.boundIndexBuffer!==b||this.boundVertexOffset!==S)this.freshBind(d,m,v,b,S,E,k);else{s.bindVertexArrayOES.set(this.vao);for(const U of E)U&&(U.bind(),k&&U.instanceCount&&U.setVertexAttribDivisor(s.gl,d,k));b&&b.dynamicDraw&&b.bind()}}freshBind(s,d,m,v,b,S,E){const k=this.context,O=k.gl;this.vao&&this.destroy(),this.vao=k.gl.createVertexArray(),k.bindVertexArrayOES.set(this.vao),this.boundProgram=s,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=v,this.boundVertexOffset=b,this.boundDynamicVertexBuffers=S,d.enableAttributes(O,s),d.bind(),d.setVertexAttribPointers(O,s,b);for(const z of m)z.enableAttributes(O,s),z.bind(),z.setVertexAttribPointers(O,s,b);for(const z of S)z&&(z.enableAttributes(O,s),z.bind(),z.setVertexAttribPointers(O,s,b),E&&z.instanceCount&&z.setVertexAttribDivisor(O,s,E));v&&v.bind()}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function wy(g,s){const d=Math.pow(2,s.canonical.z),m=s.canonical.y;return[new o.ae(0,m/d).toLngLat().lat,new o.ae(0,(m+1)/d).toLngLat().lat]}function Sy(g,s,d,m,v,b,S){const E=g.context,k=E.gl,O=d.hillshadeFBO;if(!O)return;g.prepareDrawTile();const z=g.isTileAffectedByFog(s),U=g.getOrCreateProgram("hillshade",{overrideFog:z});E.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,O.colorAttachment.get());const F=((ne,X,re,he)=>{const pe=re.paint.get("hillshade-shadow-color"),Ie=re.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",Se=re.paint.get("hillshade-highlight-color"),Ae=re.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Ce=re.paint.get("hillshade-accent-color"),we=re.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",ke=re.paint.get("hillshade-emissive-strength");let nt=o.an(re.paint.get("hillshade-illumination-direction"));if(re.paint.get("hillshade-illumination-anchor")==="viewport")nt-=ne.transform.angle;else if(ne.style&&ne.style.enable3dLights()&&ne.style.directionalLight){const ht=ne.style.directionalLight.properties.get("direction"),et=o.d3(ht.x,ht.y,ht.z);nt=o.an(et[1])}const Ke=!ne.options.moving;return{u_matrix:he||ne.transform.calculateProjMatrix(X.tileID.toUnwrapped(),Ke),u_image:0,u_latrange:wy(0,X.tileID),u_light:[re.paint.get("hillshade-exaggeration"),nt],u_shadow:pe.toPremultipliedRenderColor(Ie?null:re.lut),u_highlight:Se.toPremultipliedRenderColor(Ae?null:re.lut),u_emissive_strength:ke,u_accent:Ce.toPremultipliedRenderColor(we?null:re.lut)}})(g,d,m,g.terrain?s.projMatrix:null);g.uploadCommonUniforms(E,U,s.toUnwrapped());const{tileBoundsBuffer:H,tileBoundsIndexBuffer:G,tileBoundsSegments:W}=g.getTileBoundsBuffers(d);U.draw(g,k.TRIANGLES,v,b,S,jn.disabled,F,m.id,H,G,W)}function Cf(g,s,d){if(!s.needsDEMTextureUpload)return;const m=g.context,v=m.gl;m.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||g.getTileTexture(d.stride);const b=d.getPixels();s.demTexture?s.demTexture.update(b,{premultiply:!1}):s.demTexture=new o.T(m,b,v.R32F,{premultiply:!1}),s.needsDEMTextureUpload=!1}function Cy(g,s,d){const m=g.context,v=m.gl;if(!s.dem)return;const b=s.dem;if(m.activeTexture.set(v.TEXTURE1),Cf(g,s,b),!s.demTexture)return;s.demTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE);const S=b.dim;m.activeTexture.set(v.TEXTURE0);let E=s.hillshadeFBO;if(!E){const F=new o.T(m,{width:S,height:S,data:null},v.RGBA8);F.bind(v.LINEAR,v.CLAMP_TO_EDGE),E=s.hillshadeFBO=m.createFramebuffer(S,S,!0,"renderbuffer"),E.colorAttachment.set(F.texture)}m.bindFramebuffer.set(E.framebuffer),m.viewport.set([0,0,S,S]);const{tileBoundsBuffer:k,tileBoundsIndexBuffer:O,tileBoundsSegments:z}=g.getMercatorTileBoundsBuffers(),U=[];g.linearFloatFilteringSupported()&&U.push("TERRAIN_DEM_FLOAT_FORMAT"),g.getOrCreateProgram("hillshadePrepare",{defines:U}).draw(g,v.TRIANGLES,sn.disabled,Dn.disabled,ti.unblended,jn.disabled,((F,H)=>{const G=H.stride,W=o.bC();return o.cd(W,0,o.al,-o.al,0,0,1),o.br(W,W,[0,-o.al,0]),{u_matrix:W,u_image:1,u_dimension:[G,G],u_zoom:F.overscaledZ}})(s.tileID,b),d.id,k,O,z),s.needsHillshadePrepare=!1}class Mr{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ph extends Mr{getDefault(){return o.ao.transparent.toNonPremultipliedRenderColor(null)}set(s){const d=this.current;(s.r!==d.r||s.g!==d.g||s.b!==d.b||s.a!==d.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class nm extends Mr{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class Mg extends Mr{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class Dg extends Mr{getDefault(){return[!0,!0,!0,!0]}set(s){const d=this.current;(s[0]!==d[0]||s[1]!==d[1]||s[2]!==d[2]||s[3]!==d[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class mh extends Mr{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class im extends Mr{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class Tf extends Mr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){const d=this.current;(s.func!==d.func||s.ref!==d.ref||s.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class Ty extends Mr{getDefault(){const s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){const d=this.current;(s[0]!==d[0]||s[1]!==d[1]||s[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class Ef extends Mr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const d=this.gl;s?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=s,this.dirty=!1}}class Ey extends Mr{getDefault(){return[0,1]}set(s){const d=this.current;(s[0]!==d[0]||s[1]!==d[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class Qc extends Mr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const d=this.gl;s?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=s,this.dirty=!1}}class rm extends Mr{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class If extends Mr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const d=this.gl;s?d.enable(d.BLEND):d.disable(d.BLEND),this.current=s,this.dirty=!1}}class om extends Mr{getDefault(){const s=this.gl;return[s.ONE,s.ZERO,s.ONE,s.ZERO]}set(s){const d=this.current;(s[0]!==d[0]||s[1]!==d[1]||s[2]!==d[2]||s[3]!==d[3]||this.dirty)&&(this.gl.blendFuncSeparate(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class Fu extends Mr{getDefault(){return o.ao.transparent.toNonPremultipliedRenderColor(null)}set(s){const d=this.current;(s.r!==d.r||s.g!==d.g||s.b!==d.b||s.a!==d.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class _c extends Mr{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(s,s),this.current=s,this.dirty=!1)}}class Id extends Mr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const d=this.gl;s?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=s,this.dirty=!1}}class Af extends Mr{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class Nu extends Mr{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}let Og=class extends Mr{getDefault(){return null}set(g){(g!==this.current||this.dirty)&&(this.gl.useProgram(g),this.current=g,this.dirty=!1)}};class eu extends Mr{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class kf extends Mr{getDefault(){const s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){const d=this.current;(s[0]!==d[0]||s[1]!==d[1]||s[2]!==d[2]||s[3]!==d[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class Vu extends Mr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class Rf extends Mr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Pf extends Mr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class sm extends Mr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class tu extends Mr{getDefault(){return null}set(s){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class Rl extends Mr{getDefault(){return null}set(s){this.gl&&(s!==this.current||this.dirty)&&(this.gl.bindVertexArray(s),this.current=s,this.dirty=!1)}}class Lg extends Mr{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class zg extends Mr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class Bg extends Mr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class nu extends Mr{constructor(s,d){super(s),this.context=s,this.parent=d}getDefault(){return null}}class Fg extends nu{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class Ng extends nu{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,this.attachment(),d.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Iy extends nu{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,this.attachment(),d.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class Ay extends Ng{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const Mf=(g,s,d)=>({u_matrix:g,u_image0:0,u_skirt_height:s,u_ground_shadow_factor:d}),Df=(g,s,d,m,v,b,S,E,k,O,z,U,F,H,G,W)=>({u_proj_matrix:Float32Array.from(g),u_globe_matrix:s,u_normalize_matrix:Float32Array.from(m),u_merc_matrix:d,u_zoom_transition:v,u_merc_center:b,u_image0:0,u_frustum_tl:S,u_frustum_tr:E,u_frustum_br:k,u_frustum_bl:O,u_globe_pos:z,u_globe_radius:U,u_viewport:F,u_grid_matrix:W?Float32Array.from(W):new Float32Array(9),u_skirt_height:H,u_far_z_cutoff:G});function gh(g,s){return g!=null&&s!=null&&!(!g.hasData()||!s.hasData())&&g.demTexture!=null&&s.demTexture!=null&&g.tileID.key!==s.tileID.key}const tc=new class{constructor(){this.operations={}}newMorphing(g,s,d,m,v){if(g in this.operations){const b=this.operations[g];b.to.tileID.key!==d.tileID.key&&(b.queued=d)}else this.operations[g]={startTime:m,phase:0,duration:v,from:s,to:d,queued:null}}getMorphValuesForProxy(g){if(!(g in this.operations))return null;const s=this.operations[g];return{from:s.from,to:s.to,phase:s.phase}}update(g){for(const s in this.operations){const d=this.operations[s];for(d.phase=(g-d.startTime)/d.duration;d.phase>=1||!this._validOp(d);)if(!this._nextOp(d,g)){delete this.operations[s];break}}}_nextOp(g,s){return!!g.queued&&(g.from=g.to,g.to=g.queued,g.queued=null,g.phase=0,g.startTime=s,!0)}_validOp(g){return g.from.hasData()&&g.to.hasData()}},Of={0:null,1:"TERRAIN_VERTEX_MORPHING"};function yc(g,s,d){if(s===0)return 0;const m=s<1&&d===514?.25/s:1;return 6*Math.pow(1.5,22-g)*Math.max(s,1)*m}function Vg(g,s){const d=1<<g.z;return!s&&(g.x===0||g.x===d-1)||g.y===0||g.y===d-1}const vc=g=>({u_matrix:g});function iu(g,s,d,m,v){if(v>0){const b=o.o.now(),S=(b-g.timeAdded)/v,E=s?(b-s.timeAdded)/v:-1,k=d.getSource(),O=m.coveringZoomLevel({tileSize:k.tileSize,roundZoom:k.roundZoom}),z=!s||Math.abs(s.tileID.overscaledZ-O)>Math.abs(g.tileID.overscaledZ-O),U=z&&g.refreshedUponExpiration?1:o.aA(z?S:1-E,0,1);return s?{opacity:1,mix:1-U,isFading:S<1}:{opacity:U,mix:0,isFading:S<1}}return{opacity:1,mix:0,isFading:!1}}class Lf extends Xs{constructor(s){const d=Xr("mock-dem",{type:"raster-dem",maxzoom:s.transform.maxZoom},s.style.dispatcher,s.style);super("mock-dem",d,!1),d.setEventedParent(this),this._sourceLoaded=!0}_loadTile(s,d){s.state="loaded",d(null)}}class Ia extends Xs{constructor(s){const d=Xr("proxy",{type:"geojson",maxzoom:s.transform.maxZoom},s.style.dispatcher,s.style);super("proxy",d,!1),d.setEventedParent(this),this.map=this.getSource().map=s,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(s,d,m){if(s.freezeTileCoverage)return;this.transform=s;const v=s.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((b,S)=>{if(b[S.key]="",!this._tiles[S.key]){const E=new Ja(S,this._source.tileSize*S.overscaleFactor(),s.tileZoom,void 0,void 0,this._source.worldview);E.state="loaded",this._tiles[S.key]=E}return b},{});for(const b in this._tiles)b in v||(this.freeFBO(b),this._tiles[b].unloadVectorData(),delete this._tiles[b])}freeFBO(s){const d=this.proxyCachedFBO[s];if(d!==void 0){const m=Object.values(d);this.renderCachePool.push(...m),delete this.proxyCachedFBO[s]}}deallocRenderCache(){this.renderCache.forEach(s=>s.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Ad extends o.aO{constructor(s,d,m){super(s.overscaledZ,s.wrap,s.canonical.z,s.canonical.x,s.canonical.y),this.proxyTileKey=d,this.projMatrix=m}}class _h extends o.dH{constructor(s,d){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},s.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),s.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),s.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=s,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[m,v,b]=function(k){const O=new o.bd,z=new o.b1,U=131;O.reserve(17161),z.reserve(33800);const F=o.al/128,H=o.al+F/2,G=H+F;for(let ne=-F;ne<G;ne+=F)for(let X=-F;X<G;X+=F){const re=X<0||X>H||ne<0||ne>H?24575:0,he=o.aA(Math.round(X),0,o.al),pe=o.aA(Math.round(ne),0,o.al);O.emplaceBack(he+re,pe)}const W=(ne,X)=>{const re=X*U+ne;z.emplaceBack(re+1,re,re+U),z.emplaceBack(re+U,re+U+1,re+1)};for(let ne=1;ne<129;ne++)for(let X=1;X<129;X++)W(X,ne);return[0,129].forEach(ne=>{for(let X=0;X<130;X++)W(X,ne),W(ne,X)}),[O,z,32768]}(),S=s.context;this.gridBuffer=S.createVertexBuffer(m,o.bf.members),this.gridIndexBuffer=S.createIndexBuffer(v),this.gridSegments=o.bg.simpleSegment(0,0,m.length,v.length),this.gridNoSkirtSegments=o.bg.simpleSegment(0,0,m.length,b),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Ia(d.map),this.orthoMatrix=o.bC(),o.cd(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,o.al,0,o.al,0,1);const E=S.gl;this._overlapStencilMode=new Dn({func:E.GEQUAL,mask:255},0,255,E.KEEP,E.KEEP,E.REPLACE),this._previousZoom=s.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=d,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Lf(d.map),this._pendingGroundEffectLayers=[]}set style(s){s.on("data",this._onStyleDataEvent.bind(this)),this._style=s,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(s,d,m){if(s&&s.terrain){this._style!==s&&(this.style=s,this._evaluationZoom=void 0);const v=s.terrain.properties,b=s.terrain.drapeRenderMode===0,S=s.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=o.o.now();const E=s.terrain&&s.terrain.scope,k=v.get("source"),O=b?this._mockSourceCache:s.getSourceCache(k,E);if(!O)return void o.w(`Couldn't find terrain source "${k}".`);if(this.sourceCache=O,this._attenuationRange=s.terrain.getAttenuationRange(),this._exaggeration=S?this.calculateExaggeration(d):v.get("exaggeration"),!d.projection.requiresDraping&&S&&this._exaggeration===0)return void this._disable();this.enabled=!0;const z=()=>{this.sourceCache.used&&o.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const U=this.getScaledDemTileSize();this.sourceCache.update(d,U,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,z(),this._initializing=!0),z(),d.updateElevation(!0,m),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(d),this._emptyDEMTextureDirty=!0,this._previousZoom=d.zoom}else this._disable()}calculateExaggeration(s){if(this._attenuationRange&&s.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(s.zoom);const d=this._previousCameraAltitude,m=s.getFreeCameraOptions().position.z/s.pixelsPerMeter*s.worldSize;this._previousCameraAltitude=m;const v=d!=null?m-d:Number.MAX_VALUE;if(Math.abs(v)<2)return this._exaggeration;const b=s.zoom,S=this._style.terrain;if(!this._previousUpdateTimestamp)return S.getExaggeration(b);let E=b-this._previousZoom;const k=this._previousUpdateTimestamp;let O=b;this._evaluationZoom!=null&&(O=this._evaluationZoom,Math.abs(b-O)>.5&&(E=.5*(b-O+E)),E*v<0&&(O+=E)),this._evaluationZoom=O;const z=S.getExaggeration(O),U=z===S.getExaggeration(Math.max(0,O-.1));if(U&&Math.abs(z-this._exaggeration)<.01)return z;let F=Math.min(.1,.00375*(this._updateTimestamp-k));return(U||z<.1||Math.abs(E)<1e-4)&&(F=Math.min(.2,4*F)),o.ak(this._exaggeration,z,F)}resetTileLookupCache(s){this._findCoveringTileCache[s]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(s){s.dataType==="source"&&s.coord?this._clearRenderCacheForTile(s.sourceCacheId,s.coord):s.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const s in this._style._mergedSourceCaches)this._style._mergedSourceCaches[s].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(s=>s.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const s=2*this.proxySourceCache.getSource().tileSize;return[s,s]}set useVertexMorphing(s){this._useVertexMorphing=s}updateTileBinding(s){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const d=this.proxySourceCache,m=this.painter.transform;this._initializing&&(this._initializing=m._centerAltitude===0&&this.getAtPointOrZero(o.ae.fromLngLat(m.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const v=this.proxyCoords=d.getIds().map(k=>{const O=d.getTileByID(k).tileID;return O.projMatrix=m.calculateProjMatrix(O.toUnwrapped()),O});(function(k,O){const z=O.transform.pointCoordinate(O.transform.getCameraPoint()),U=new o.P(z.x,z.y);k.sort((F,H)=>{if(H.overscaledZ-F.overscaledZ)return H.overscaledZ-F.overscaledZ;const G=new o.P(F.canonical.x+(1<<F.canonical.z)*F.wrap,F.canonical.y),W=new o.P(H.canonical.x+(1<<H.canonical.z)*H.wrap,H.canonical.y),ne=U.mult(1<<F.canonical.z);return ne.x-=.5,ne.y-=.5,ne.distSqr(G)-ne.distSqr(W)})})(v,this.painter);const b=this.proxyToSource||{};this.proxyToSource={},v.forEach(k=>{this.proxyToSource[k.key]={}}),this.terrainTileForTile={};const S=this._style._mergedSourceCaches;for(const k in S){const O=S[k];if(!O.used||(O!==this.sourceCache&&this.resetTileLookupCache(O.id),this._setupProxiedCoordsForOrtho(O,s[k],b),O.usedForTerrain))continue;const z=s[k];O.getSource().reparseOverscaled&&this._assignTerrainTiles(z)}this.proxiedCoords[d.id]=v.map(k=>new Ad(k,k.key,this.orthoMatrix)),this._assignTerrainTiles(v),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(b),this.renderingToTexture=!1;const E={};this._visibleDemTiles=[];for(const k of this.proxyCoords){const O=this.terrainTileForTile[k.key];if(!O)continue;const z=O.tileID.key;z in E||(this._visibleDemTiles.push(O),E[z]=z)}}_assignTerrainTiles(s){this._initializing||s.forEach(d=>{if(this.terrainTileForTile[d.key])return;const m=this._findTileCoveringTileID(d,this.sourceCache);m&&(this.terrainTileForTile[d.key]=m)})}_prepareDEMTextures(){const s=this.painter.context,d=s.gl;for(const m in this.terrainTileForTile){const v=this.terrainTileForTile[m],b=v.dem;!b||v.demTexture&&!v.needsDEMTextureUpload||(s.activeTexture.set(d.TEXTURE1),Cf(this.painter,v,b))}}_prepareDemTileUniforms(s,d,m,v){if(!d||d.demTexture==null)return!1;const b=s.tileID.canonical,S=Math.pow(2,d.tileID.canonical.z-b.z),E=v||"";return m[`u_dem_tl${E}`]=[b.x*S%1,b.y*S%1],m[`u_dem_scale${E}`]=S,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let s=0;const d=this._visibleDemTiles.reduce((m,v)=>{if(!v.dem)return m;const b=v.dem.tree.minimums[0];return b>0&&s++,m+b},0);return s?d/s:0}_updateEmptyDEMTexture(){const s=this.painter.context,d=s.gl;s.activeTexture.set(d.TEXTURE2);const m=this._getLoadedAreaMinimum(),v=new o.dI({width:1,height:1},new Float32Array([m]));this._emptyDEMTextureDirty=!1;let b=this._emptyDEMTexture;return b?b.update(v,{premultiply:!1}):b=this._emptyDEMTexture=new o.T(s,v,d.R32F,{premultiply:!1}),b}setupElevationDraw(s,d,m){const v=this.painter.context,b=v.gl,S={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};S.u_exaggeration=this.exaggeration();let E=null,k=null,O=1;if(m&&m.morphing&&this._useVertexMorphing){const H=m.morphing.srcDemTile,G=m.morphing.dstDemTile;O=m.morphing.phase,H&&G&&(this._prepareDemTileUniforms(s,H,S,"_prev")&&(k=H),this._prepareDemTileUniforms(s,G,S)&&(E=G))}const z=H=>H&&H.demTexture&&this.painter.linearFloatFilteringSupported()?b.LINEAR:b.NEAREST;let U=null;var F;if(this.enabled?k&&E?(U=E.demTexture,v.activeTexture.set(b.TEXTURE4),k.demTexture.bind(z(k),b.CLAMP_TO_EDGE),S.u_dem_lerp=O):(E=this.terrainTileForTile[s.tileID.key],U=this._prepareDemTileUniforms(s,E,S)?E.demTexture:this.emptyDEMTexture):U=this.emptyDEMTexture,v.activeTexture.set(b.TEXTURE2),U&&(S.u_dem_size=(F=U).size[0]===1?1:F.size[0]-2,U.bind(z(E),b.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(m&&m.useDepthForOcclusion,d,S),m&&m.useMeterToDem&&E){const H=(1<<E.tileID.canonical.z)*o.ce(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;S.u_meter_to_dem=H}if(m&&m.labelPlaneMatrixInv&&(S.u_label_plane_matrix_inv=m.labelPlaneMatrixInv),d.setTerrainUniformValues(v,S),this.painter.transform.projection.name==="globe"){const H=this.globeUniformValues(this.painter.transform,s.tileID.canonical,m&&m.useDenormalizedUpVectorScale);d.setGlobeUniformValues(v,H)}}globeUniformValues(s,d,m){const v=s.projection;return{u_tile_tl_up:v.upVector(d,0,0),u_tile_tr_up:v.upVector(d,o.al,0),u_tile_br_up:v.upVector(d,o.al,o.al),u_tile_bl_up:v.upVector(d,0,o.al),u_tile_up_scale:m?o.dJ(1):v.upVectorScale(d,s.center.lat,s.worldSize).metersToTile}}renderToBackBuffer(s){const d=this.painter,m=this.painter.context;s.length!==0&&(m.bindFramebuffer.set(null),m.viewport.set([0,0,d.width,d.height]),d.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(v,b,S,E,k){if(v.transform.projection.name==="globe")(function(O,z,U,F,H){const G=O.context,W=G.gl;let ne,X;const re=O.transform,he=o.dA(O,G,re),pe=(ht,et)=>{if(X===et)return;const ut=[Of[et],"PROJECTION_GLOBE_VIEW"];he&&ut.push("CUSTOM_ANTIALIASING");const jt=O.isTileAffectedByFog(ht);ne=O.getOrCreateProgram("globeRaster",{defines:ut,overrideFog:jt}),X=et},Ie=O.colorModeForRenderPass(),Se=new sn(W.LEQUAL,sn.ReadWrite,O.depthRangeFor3D);tc.update(H);const Ae=o.dB(re),Ce=[o.aF(re.center.lng),o.aJ(re.center.lat)],we=O.globeSharedBuffers,ke=[re.width*o.o.devicePixelRatio,re.height*o.o.devicePixelRatio],nt=Float32Array.from(re.globeMatrix),Ke={useDenormalizedUpVectorScale:!0};{const ht=O.transform,et=yc(ht.zoom,z.exaggeration(),z.sourceCache._source.tileSize);X=-1;const ut=W.TRIANGLES;for(const jt of F){const tt=U.getTile(jt),Ue=Dn.disabled,pt=z.prevTerrainTileForTile[jt.key],ot=z.terrainTileForTile[jt.key];gh(pt,ot)&&tc.newMorphing(jt.key,pt,ot,H,250),G.activeTexture.set(W.TEXTURE0),tt.texture&&tt.texture.bind(W.LINEAR,W.CLAMP_TO_EDGE);const Et=tc.getMorphValuesForProxy(jt.key),$t=Et?1:0;Et&&Object.assign(Ke,{morphing:{srcDemTile:Et.from,dstDemTile:Et.to,phase:o.dz(Et.phase)}});const rn=o.dC(jt.canonical),Lt=o.dD(rn.getCenter().lat),Rt=o.dE(jt.canonical,rn,Lt,ht.worldSize/ht._pixelsPerMercatorPixel),Cn=o.bk(o.dF(jt.canonical)),yn=Df(ht.expandedFarZProjMatrix,nt,Ae,Cn,o.aj(ht.zoom),Ce,ht.frustumCorners.TL,ht.frustumCorners.TR,ht.frustumCorners.BR,ht.frustumCorners.BL,ht.globeCenterInViewSpace,ht.globeRadius,ke,et,ht._farZ,Rt);if(pe(jt,$t),ne&&(z.setupElevationDraw(tt,ne,Ke),O.uploadCommonUniforms(G,ne,jt.toUnwrapped()),we)){const[wn,gn,Wn]=we.getGridBuffers(Lt,et!==0);ne.draw(O,ut,Se,Ue,Ie,jn.backCCW,yn,"globe_raster",wn,gn,Wn)}}}if(we&&(O.renderDefaultNorthPole||O.renderDefaultSouthPole)){const ht=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];he&&ht.push("CUSTOM_ANTIALIASING"),ne=O.getOrCreateProgram("globeRaster",{defines:ht});for(const et of F){const{x:ut,y:jt,z:tt}=et.canonical,Ue=jt===0,pt=jt===(1<<tt)-1,[ot,Et,$t,rn]=we.getPoleBuffers(tt,!1);if(rn&&(Ue||pt)){const Lt=U.getTile(et);G.activeTexture.set(W.TEXTURE0),Lt.texture&&Lt.texture.bind(W.LINEAR,W.CLAMP_TO_EDGE);let Rt=o.dG(tt,ut,re);const Cn=o.bk(o.dF(et.canonical)),yn=(wn,gn)=>wn.draw(O,W.TRIANGLES,Se,Dn.disabled,Ie,jn.disabled,Df(re.expandedFarZProjMatrix,Rt,Rt,Cn,0,Ce,re.frustumCorners.TL,re.frustumCorners.TR,re.frustumCorners.BR,re.frustumCorners.BL,re.globeCenterInViewSpace,re.globeRadius,ke,0,re._farZ),"globe_pole_raster",gn,$t,rn);z.setupElevationDraw(Lt,ne,Ke),O.uploadCommonUniforms(G,ne,et.toUnwrapped()),Ue&&O.renderDefaultNorthPole&&yn(ne,ot),pt&&O.renderDefaultSouthPole&&(Rt=o.cR(o.bC(),Rt,[1,-1,1]),yn(ne,Et))}}}})(v,b,S,E,k);else{const O=v.context,z=O.gl;let U,F;const H=v.shadowRenderer,G=gc(v,v.longestCutoffRange),W=Ie=>{if(F===Ie)return;const Se=[];Se.push(Of[Ie]),G.shouldRenderCutoff&&Se.push("RENDER_CUTOFF"),H&&(Se.push("RENDER_SHADOWS","DEPTH_TEXTURE"),H.useNormalOffset&&Se.push("NORMAL_OFFSET")),U=v.getOrCreateProgram("terrainRaster",{defines:Se}),F=Ie},ne=v.colorModeForRenderPass(),X=new sn(z.LEQUAL,sn.ReadWrite,v.depthRangeFor3D);tc.update(k);const re=v.transform,he=yc(re.zoom,b.exaggeration(),b.sourceCache._source.tileSize);let pe=[0,0,0];if(H){const Ie=v.style.directionalLight,Se=v.style.ambientLight;Ie&&Se&&(pe=Al(v.style,Ie,Se))}{F=-1;const Ie=z.TRIANGLES,[Se,Ae]=[b.gridIndexBuffer,b.gridSegments];for(const Ce of E){const we=S.getTile(Ce),ke=Dn.disabled,nt=b.prevTerrainTileForTile[Ce.key],Ke=b.terrainTileForTile[Ce.key];gh(nt,Ke)&&tc.newMorphing(Ce.key,nt,Ke,k,250),O.activeTexture.set(z.TEXTURE0),we.texture&&we.texture.bind(z.LINEAR,z.CLAMP_TO_EDGE);const ht=tc.getMorphValuesForProxy(Ce.key),et=ht?1:0;let ut;ht&&(ut={morphing:{srcDemTile:ht.from,dstDemTile:ht.to,phase:o.dz(ht.phase)}});const jt=Mf(Ce.projMatrix,Vg(Ce.canonical,re.renderWorldCopies)?he/10:he,pe);if(W(et),!U)continue;b.setupElevationDraw(we,U,ut);const tt=Ce.toUnwrapped();H&&H.setupShadows(tt,U),v.uploadCommonUniforms(O,U,tt,null,G),U.draw(v,Ie,X,ke,ne,jn.backCCW,jt,"terrain_raster",b.gridBuffer,Se,Ae)}}}}(d,this,this.proxySourceCache,s,this._updateTimestamp),this.renderingToTexture=!0,d.gpuTimingDeferredRenderEnd(),s.splice(0,s.length))}renderBatch(s){if(this._drapedRenderBatches.length===0)return s+1;this.renderingToTexture=!0;const d=this.painter,m=this.painter.context,v=this.proxySourceCache,b=this.proxiedCoords[v.id],S=this._drapedRenderBatches.shift(),E=d.style.order,k=[];let O=0;for(const z of b){const U=v.getTileByID(z.proxyTileKey),F=v.proxyCachedFBO[z.key]?v.proxyCachedFBO[z.key][s]:void 0,H=F!==void 0?v.renderCache[F]:this.pool[O++],G=F!==void 0;if(U.texture=H.tex,G&&!H.dirty){k.push(U.tileID);continue}let W;m.bindFramebuffer.set(H.fb.framebuffer),this.renderedToTile=!1,H.dirty&&(m.clear({color:o.ao.transparent,stencil:0}),H.dirty=!1);for(let ne=S.start;ne<=S.end;++ne){const X=d.style._mergedLayers[E[ne]];if(X.isHidden(d.transform.zoom))continue;const re=d.style.getLayerSourceCache(X),he=re?this.proxyToSource[z.key][re.id]:[z];if(!he)continue;const pe=he;m.viewport.set([0,0,H.fb.width,H.fb.height]),W!==(re?re.id:null)&&(this._setupStencil(H,he,X,re),W=re?re.id:null),d.renderLayer(d,re,X,pe)}if(this._drapedRenderBatches.length===0)for(const ne of this._pendingGroundEffectLayers){const X=d.style._mergedLayers[E[ne]];if(X.isHidden(d.transform.zoom))continue;const re=d.style.getLayerSourceCache(X),he=re?this.proxyToSource[z.key][re.id]:[z];if(!he)continue;const pe=he;m.viewport.set([0,0,H.fb.width,H.fb.height]),W!==(re?re.id:null)&&(this._setupStencil(H,he,X,re),W=re?re.id:null),d.renderLayer(d,re,X,pe)}this.renderedToTile?(H.dirty=!0,k.push(U.tileID)):G||--O,O===5&&(O=0,this.renderToBackBuffer(k))}return this.renderToBackBuffer(k),this.renderingToTexture=!1,m.bindFramebuffer.set(null),m.viewport.set([0,0,d.width,d.height]),S.end+1}postRender(){}isLayerOrderingCorrect(s){const d=s.order.length;let m=-1,v=d;for(let b=0;b<d;++b)this._style.isLayerDraped(s._mergedLayers[s.order[b]])?m=Math.max(m,b):v=Math.min(v,b);return v>m}getMinElevationBelowMSL(){let s=0;return this._visibleDemTiles.filter(d=>d.dem).forEach(d=>{s=Math.min(s,d.dem.tree.minimums[0])}),s===0?s:(s-30)*this._exaggeration}raycast(s,d,m){if(!this._visibleDemTiles)return null;const v=this._visibleDemTiles.filter(b=>b.dem).map(b=>{const S=b.tileID,E=1<<S.overscaledZ,{x:k,y:O}=S.canonical,z=k/E,U=(k+1)/E,F=O/E,H=(O+1)/E;return{minx:z,miny:F,maxx:U,maxy:H,t:b.dem.tree.raycastRoot(z,F,U,H,s,d,m),tile:b}});v.sort((b,S)=>(b.t!==null?b.t:Number.MAX_VALUE)-(S.t!==null?S.t:Number.MAX_VALUE));for(const b of v){if(b.t==null)return null;const S=b.tile.dem.tree.raycast(b.minx,b.miny,b.maxx,b.maxy,s,d,m);if(S!=null)return S}return null}_createFBO(){const s=this.painter.context,d=s.gl,m=this.drapeBufferSize;s.activeTexture.set(d.TEXTURE0);const v=new o.T(s,{width:m[0],height:m[1],data:null},d.RGBA8);v.bind(d.LINEAR,d.CLAMP_TO_EDGE);const b=s.createFramebuffer(m[0],m[1],!0,null);return b.colorAttachment.set(v.texture),b.depthAttachment=new Ay(s,b.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=s.createRenderbuffer(s.gl.DEPTH_STENCIL,m[0],m[1]),this._stencilRef=0,b.depthAttachment.set(this._sharedDepthStencil),s.clear({stencil:0})):b.depthAttachment.set(this._sharedDepthStencil),s.extTextureFilterAnisotropic&&d.texParameterf(d.TEXTURE_2D,s.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,s.extTextureFilterAnisotropicMax),{fb:b,tex:v,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const s in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[s].hasTransition())return!0;return this._style.order.some(s=>{const d=this._style._mergedLayers[s],m=d.isHidden(this.painter.transform.zoom);return d.type==="hillshade"||d.type==="custom"?!m&&d.shouldRedrape():!m&&d.hasTransition()})}_clearLineLayersFromRenderCache(){let s=!1;for(const m of this._style.getSources())if(m instanceof ko){s=!0;break}if(!s)return;const d={};for(let m=0;m<this._style.order.length;++m){const v=this._style._mergedLayers[this._style.order[m]],b=this._style.getLayerSourceCache(v);if(b&&!d[b.id]&&!v.isHidden(this.painter.transform.zoom)&&v.type==="line"&&v.widthExpression()instanceof o.ad){d[b.id]=!0;for(const S of this.proxyCoords){const E=this.proxyToSource[S.key][b.id];if(E)for(const k of E)this._clearRenderCacheForTile(b.id,k)}}}}_clearRasterLayersFromRenderCache(){let s=!1;for(const m in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[m]._source instanceof Zs){s=!0;break}if(!s)return;const d={};for(let m=0;m<this._style.order.length;++m){const v=this._style._mergedLayers[this._style.order[m]],b=this._style.getLayerSourceCache(v);if(!b||d[b.id]||v.isHidden(this.painter.transform.zoom)||v.type!=="raster")continue;const S=v.paint.get("raster-fade-duration");for(const E of this.proxyCoords){const k=this.proxyToSource[E.key][b.id];if(k)for(const O of k){const z=iu(b.getTile(O),b.findLoadedParent(O,0),b,this.painter.transform,S);(z.opacity!==1||z.mix!==0)&&this._clearRenderCacheForTile(b.id,O)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const s=this._style.order,d=s.length;if(d===0)return;const m=[];this._pendingGroundEffectLayers=[];let v,b=0,S=this._style._mergedLayers[s[b]];for(;!this._style.isLayerDraped(S)&&S.isHidden(this.painter.transform.zoom)&&++b<d;)S=this._style._mergedLayers[s[b]];for(;b<d;++b){const E=this._style._mergedLayers[s[b]];E.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(E)?v===void 0&&(v=b):(E.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(b),v!==void 0&&(m.push({start:v,end:b-1}),v=void 0)))}if(v!==void 0&&m.push({start:v,end:b-1}),m.length!==0){const E=m[m.length-1];this._pendingGroundEffectLayers.every(k=>k>E.end)||o.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=m}_setupRenderCache(s){const d=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,d.renderCache.length>d.renderCachePool.length){const S=Object.values(d.proxyCachedFBO);d.proxyCachedFBO={};for(let E=0;E<S.length;++E){const k=Object.values(S[E]);d.renderCachePool.push(...k)}}return}this._clearRasterLayersFromRenderCache();const m=this.proxyCoords,v=this._tilesDirty;for(let S=m.length-1;S>=0;S--){const E=m[S];if(d.getTileByID(E.key),d.proxyCachedFBO[E.key]!==void 0){const k=s[E.key],O=this.proxyToSource[E.key];let z=0;for(const U in O){const F=O[U],H=k[U];if(!H||H.length!==F.length||F.some((G,W)=>G!==H[W]||v[U]&&v[U].hasOwnProperty(G.key))){z=-1;break}++z}for(const U in d.proxyCachedFBO[E.key])d.renderCache[d.proxyCachedFBO[E.key][U]].dirty=z<0||z!==Object.values(k).length}}const b=[...this._drapedRenderBatches];b.sort((S,E)=>E.end-E.start-(S.end-S.start));for(const S of b)for(const E of m){if(d.proxyCachedFBO[E.key])continue;let k=d.renderCachePool.pop();k===void 0&&d.renderCache.length<50&&(k=d.renderCache.length,d.renderCache.push(this._createFBO())),k!==void 0&&(d.proxyCachedFBO[E.key]={},d.proxyCachedFBO[E.key][S.start]=k,d.renderCache[k].dirty=!0)}this._tilesDirty={}}_setupStencil(s,d,m,v){if(!v||!this._sourceTilesOverlap[v.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const b=this.painter.context,S=b.gl;if(d.length<=1)return void(this._overlapStencilType=!1);let E;if(m.isTileClipped())E=d.length,this._overlapStencilMode.test={func:S.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(d[0].overscaledZ>d[d.length-1].overscaledZ))return void(this._overlapStencilType=!1);E=1,this._overlapStencilMode.test={func:S.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+E>255&&(b.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=E,this._overlapStencilMode.ref=this._stencilRef,m.isTileClipped()&&this._renderTileClippingMasks(d,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(s){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[s.key]),this._overlapStencilMode):Dn.disabled}_renderTileClippingMasks(s,d){const m=this.painter,v=this.painter.context,b=v.gl;m._tileClippingMaskIDs={},v.setColorMode(ti.disabled),v.setDepthMode(sn.disabled);const S=m.getOrCreateProgram("clippingMask");for(const E of s){const k=m._tileClippingMaskIDs[E.key]=--d;S.draw(m,b.TRIANGLES,sn.disabled,new Dn({func:b.ALWAYS,mask:0},k,255,b.KEEP,b.KEEP,b.REPLACE),ti.disabled,jn.disabled,vc(E.projMatrix),"$clipping",m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}}pointCoordinate(s){const d=this.painter.transform;if(s.x<0||s.x>d.width||s.y<0||s.y>d.height)return null;const m=[s.x,s.y,1,1];o.aC(m,m,d.pixelMatrixInverse),o.cJ(m,m,1/m[3]),m[0]/=d.worldSize,m[1]/=d.worldSize;const v=d._camera.position,b=o.ce(1,d.center.lat),S=[v[0],v[1],v[2]/b,0],E=o.d9([],m.slice(0,3),S);o.aw(E,E);const k=this.raycast(S,E,this._exaggeration);return k!==null&&k?(o.bH(S,S,E,k),S[3]=S[2],S[2]*=b,S):null}_setupProxiedCoordsForOrtho(s,d,m){if(s.getSource()instanceof o.aS)return this._setupProxiedCoordsForImageSource(s,d,m);this._findCoveringTileCache[s.id]=this._findCoveringTileCache[s.id]||{};const v=this.proxiedCoords[s.id]=[],b=this.proxyCoords;for(let k=0;k<b.length;k++){const O=b[k],z=this._findTileCoveringTileID(O,s);if(z){const U=this._createProxiedId(O,z,m[O.key]&&m[O.key][s.id]);v.push(U),this.proxyToSource[O.key][s.id]=[U]}}let S=!1;const E=new Set;for(let k=0;k<d.length;k++){const O=s.getTile(d[k]);if(!O||!O.hasData())continue;const z=this._findTileCoveringTileID(O.tileID,this.proxySourceCache);if(z&&z.tileID.canonical.z!==O.tileID.canonical.z){const U=this.proxyToSource[z.tileID.key][s.id],F=this._createProxiedId(z.tileID,O,m[z.tileID.key]&&m[z.tileID.key][s.id]);U?U.splice(U.length-1,0,F):this.proxyToSource[z.tileID.key][s.id]=[F];const H=this.proxyToSource[z.tileID.key][s.id];E.has(H)||E.add(H),v.push(F),S=!0}}if(this._sourceTilesOverlap[s.id]=S,S&&this._debugParams.sortTilesHiZFirst)for(const k of E)k.sort((O,z)=>z.overscaledZ-O.overscaledZ)}_setupProxiedCoordsForImageSource(s,d,m){if(!s.getSource().loaded())return;const v=this.proxiedCoords[s.id]=[],b=this.proxyCoords,S=s.getSource(),E=S.tileID;if(!E)return;const k=new o.P(E.x,E.y)._div(1<<E.z),O=S.coordinates.map(o.ae.fromLngLat).reduce((U,F)=>(U.min.x=Math.min(U.min.x,F.x-k.x),U.min.y=Math.min(U.min.y,F.y-k.y),U.max.x=Math.max(U.max.x,F.x-k.x),U.max.y=Math.max(U.max.y,F.y-k.y),U),{min:new o.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new o.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),z=(U,F)=>{const H=U.wrap+U.canonical.x/(1<<U.canonical.z),G=U.canonical.y/(1<<U.canonical.z),W=o.al/(1<<U.canonical.z),ne=F.wrap+F.canonical.x/(1<<F.canonical.z),X=F.canonical.y/(1<<F.canonical.z);return H+W<ne+O.min.x||H>ne+O.max.x||G+W<X+O.min.y||G>X+O.max.y};for(let U=0;U<b.length;U++){const F=b[U];for(let H=0;H<d.length;H++){const G=s.getTile(d[H]);if(!G||!G.hasData()||z(F,G.tileID))continue;const W=this._createProxiedId(F,G,m[F.key]&&m[F.key][s.id]),ne=this.proxyToSource[F.key][s.id];ne?ne.push(W):this.proxyToSource[F.key][s.id]=[W],v.push(W)}}}_createProxiedId(s,d,m){let v=this.orthoMatrix;if(m){const b=m.find(S=>S.key===d.tileID.key);if(b)return b}if(d.tileID.key!==s.key){const b=s.canonical.z-d.tileID.canonical.z;let S,E,k;v=o.bC();const O=d.tileID.wrap-s.wrap<<s.overscaledZ;b>0?(S=o.al>>b,E=S*((d.tileID.canonical.x<<b)-s.canonical.x+O),k=S*((d.tileID.canonical.y<<b)-s.canonical.y)):(S=o.al<<-b,E=o.al*(d.tileID.canonical.x-(s.canonical.x+O<<-b)),k=o.al*(d.tileID.canonical.y-(s.canonical.y<<-b))),o.cd(v,0,S,0,S,0,1),o.br(v,v,[E,k,0])}return new Ad(d.tileID,s.key,v)}_findTileCoveringTileID(s,d){let m=d.getTile(s);if(m&&m.hasData())return m;const v=this._findCoveringTileCache[d.id],b=v[s.key];if(m=b?d.getTileByID(b):null,m&&m.hasData()||b===null)return m;let S=m?m.tileID:s,E=S.overscaledZ;const k=d.getSource().minzoom,O=[];if(!b){const U=d.getSource().maxzoom;if(s.canonical.z>=U){const F=s.canonical.z-U;d.getSource().reparseOverscaled?(E=Math.max(s.canonical.z+2,d.transform.tileZoom),S=new o.aO(E,s.wrap,U,s.canonical.x>>F,s.canonical.y>>F)):F!==0&&(E=U,S=new o.aO(E,s.wrap,U,s.canonical.x>>F,s.canonical.y>>F))}S.key!==s.key&&(O.push(S.key),m=d.getTile(S))}const z=U=>{O.forEach(F=>{v[F]=U}),O.length=0};for(E-=1;E>=k&&(!m||!m.hasData());E--){m&&z(m.tileID.key);const U=S.calculateScaledKey(E);if(m=d.getTileByID(U),m&&m.hasData())break;const F=v[U];if(F===null)break;F===void 0?O.push(U):m=d.getTileByID(F)}return z(m?m.tileID.key:null),m&&m.hasData()?m:null}findDEMTileFor(s){return this.enabled?this._findTileCoveringTileID(s,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(s,d){let m=this._tilesDirty[s];m||(m=this._tilesDirty[s]={}),m[d.key]=!0}}function nc(g,s,d){const m=function(E,k,O){const z=o.bJ(k,E),U=o.bJ(O,[.2126,.7152,.0722]),F=(G,W,ne)=>(1-ne)*G+ne*W,H=F(1-.3*Math.min(U,1),1,Math.min(z+1,1));return F(.92,1,Math.asin(o.aA(k[2],-1,1))/Math.PI+.5)*H}(g,[0,0,1],s),v=[0,0,0];o.c4(v,d.slice(0,3),m);const b=[0,0,0];o.c4(b,s.slice(0,3),g[2]);const S=[0,0,0];return o.d7(S,v,b),o.da(S)}const ic=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],am=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class zf{static cacheKey(s,d,m,v){let b=`${d}${v?v.cacheKey:""}`;for(const S of m)s.usedDefines.includes(S)&&(b+=`/${S}`);return b}constructor(s,d,m,v,b,S){const E=s.gl;this.program=E.createProgram(),this.configuration=v,this.name=d,this.fixedDefines=[...S];let k=v?v.defines():[];k=k.concat(S.map(G=>`#define ${G}`));const O=`#version 300 es
`;let z=O+k.concat("precision mediump float;",kl,Ua.fragmentSource).join(`
`);for(const G of m.fragmentIncludes)z+=`
${Td[G]}`;z+=`
${m.fragmentSource}`;let U=O+k.concat("precision highp float;",kl,Ua.vertexSource).join(`
`);for(const G of m.vertexIncludes)U+=`
${Td[G]}`;this.forceManualRenderingForInstanceIDShaders=s.forceManualRenderingForInstanceIDShaders&&m.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(U+=`
uniform int u_instanceID;
`),U+=`
${m.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(U=U.replaceAll("gl_InstanceID","u_instanceID"));const F=E.createShader(E.FRAGMENT_SHADER);if(E.isContextLost())return void(this.failedToCreate=!0);E.shaderSource(F,z),E.compileShader(F),E.attachShader(this.program,F);const H=E.createShader(E.VERTEX_SHADER);E.isContextLost()?this.failedToCreate=!0:(E.shaderSource(H,U),E.compileShader(H),E.attachShader(this.program,H),this.attributes={},E.linkProgram(this.program),E.deleteShader(H),E.deleteShader(F),this.fixedUniforms=b(s),this.binderUniforms=v?v.getUniforms(s):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(G=>({u_instanceID:new o.cg(G)}))(s)),(S.includes("TERRAIN")||d.indexOf("symbol")!==-1||d.indexOf("circle")!==-1)&&(this.terrainUniforms=(G=>({u_dem:new o.cg(G),u_dem_prev:new o.cg(G),u_dem_tl:new o.cj(G),u_dem_scale:new o.ci(G),u_dem_tl_prev:new o.cj(G),u_dem_scale_prev:new o.ci(G),u_dem_size:new o.ci(G),u_dem_lerp:new o.ci(G),u_exaggeration:new o.ci(G),u_depth:new o.cg(G),u_depth_size_inv:new o.cj(G),u_depth_range_unpack:new o.cj(G),u_occluder_half_size:new o.ci(G),u_occlusion_depth_offset:new o.ci(G),u_meter_to_dem:new o.ci(G),u_label_plane_matrix_inv:new o.ck(G)}))(s)),S.includes("GLOBE")&&(this.globeUniforms=(G=>({u_tile_tl_up:new o.ch(G),u_tile_tr_up:new o.ch(G),u_tile_br_up:new o.ch(G),u_tile_bl_up:new o.ch(G),u_tile_up_scale:new o.ci(G)}))(s)),S.includes("FOG")&&(this.fogUniforms=(G=>({u_fog_matrix:new o.ck(G),u_fog_range:new o.cj(G),u_fog_color:new o.d2(G),u_fog_horizon_blend:new o.ci(G),u_fog_vertical_limit:new o.cj(G),u_fog_temporal_offset:new o.ci(G),u_frustum_tl:new o.ch(G),u_frustum_tr:new o.ch(G),u_frustum_br:new o.ch(G),u_frustum_bl:new o.ch(G),u_globe_pos:new o.ch(G),u_globe_radius:new o.ci(G),u_globe_transition:new o.ci(G),u_is_globe:new o.cg(G),u_viewport:new o.cj(G)}))(s)),S.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(G=>({u_cutoff_params:new o.d2(G)}))(s)),S.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(G=>({u_lighting_ambient_color:new o.ch(G),u_lighting_directional_dir:new o.ch(G),u_lighting_directional_color:new o.ch(G),u_ground_radiance:new o.ch(G)}))(s)),S.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(G=>({u_light_matrix_0:new o.ck(G),u_light_matrix_1:new o.ck(G),u_fade_range:new o.cj(G),u_shadow_normal_offset:new o.ch(G),u_shadow_intensity:new o.ci(G),u_shadow_texel_size:new o.ci(G),u_shadow_map_resolution:new o.ci(G),u_shadow_direction:new o.ch(G),u_shadow_bias:new o.ch(G),u_shadowmap_0:new o.cg(G),u_shadowmap_1:new o.cg(G)}))(s)))}getAttributeLocation(s,d){let m=this.attributes[d];return m===void 0&&(m=this.attributes[d]=s.getAttribLocation(this.program,d)),m}setTerrainUniformValues(s,d){if(!this.terrainUniforms)return;const m=this.terrainUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const v in d)m[v]&&m[v].set(this.program,v,d[v])}}setGlobeUniformValues(s,d){if(!this.globeUniforms)return;const m=this.globeUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const v in d)m[v]&&m[v].set(this.program,v,d[v])}}setFogUniformValues(s,d){if(!this.fogUniforms)return;const m=this.fogUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const v in d)m[v].set(this.program,v,d[v])}}setCutoffUniformValues(s,d){if(!this.cutoffUniforms)return;const m=this.cutoffUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const v in d)m[v].set(this.program,v,d[v])}}setLightsUniformValues(s,d){if(!this.lightsUniforms)return;const m=this.lightsUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const v in d)m[v].set(this.program,v,d[v])}}setShadowUniformValues(s,d){if(this.failedToCreate||!this.shadowUniforms)return;const m=this.shadowUniforms;s.program.set(this.program);for(const v in d)m[v].set(this.program,v,d[v])}_drawDebugWireframe(s,d,m,v,b,S,E,k,O,z){const U=s.options.wireframe;if(U.terrain===!1&&U.layers2D===!1&&U.layers3D===!1)return;const F=s.context;if(!(!(!U.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!U.layers2D||s._terrain&&s._terrain.renderingToTexture||!ic.includes(this.name))||!(!U.layers3D||!am.includes(this.name))))return;const H=F.gl,G=s.wireframeDebugCache.getLinesFromTrianglesBuffer(s.frameCounter,b,F);if(!G)return;const W=[...this.fixedDefines];W.push("DEBUG_WIREFRAME");const ne=s.getOrCreateProgram(this.name,{config:this.configuration,defines:W});F.program.set(ne.program);const X=(pe,Ie,Se)=>{if(Ie[pe]&&Se[pe])for(const Ae in Ie[pe])Se[pe][Ae]&&Se[pe][Ae].set(Se.program,Ae,Ie[pe][Ae].current)};O&&O.setUniforms(ne.program,F,ne.binderUniforms,E,{zoom:k}),X("fixedUniforms",this,ne),X("terrainUniforms",this,ne),X("globeUniforms",this,ne),X("fogUniforms",this,ne),X("lightsUniforms",this,ne),X("shadowUniforms",this,ne),G.bind(),F.setColorMode(new ti([H.ONE,H.ONE_MINUS_SRC_ALPHA,H.ZERO,H.ONE],o.ao.transparent,[!0,!0,!0,!1])),F.setDepthMode(new sn(d.func===H.LESS?H.LEQUAL:d.func,sn.ReadOnly,d.range)),F.setStencilMode(Dn.disabled);const re=3*S.primitiveLength*2,he=3*S.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const pe=z||1;for(let Ie=0;Ie<pe;++Ie)ne.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Ie),H.drawElements(H.LINES,re,H.UNSIGNED_SHORT,he)}else z&&z>1?H.drawElementsInstanced(H.LINES,re,H.UNSIGNED_SHORT,he,z):H.drawElements(H.LINES,re,H.UNSIGNED_SHORT,he);b.bind(),F.program.set(this.program),F.setDepthMode(d),F.setStencilMode(m),F.setColorMode(v)}checkUniforms(s,d,m){if(this.fixedDefines.includes(d)){for(const v of Object.keys(m))if(!m[v].initialized)throw new Error(`Program '${this.name}', from draw '${s}': uniform ${v} not set but required by ${d} being defined`)}}draw(s,d,m,v,b,S,E,k,O,z,U,F,H,G,W,ne){const X=s.context,re=X.gl;if(this.failedToCreate)return;X.program.set(this.program),X.setDepthMode(m),X.setStencilMode(v),X.setColorMode(b),X.setCullFace(S);for(const Ie of Object.keys(this.fixedUniforms))this.fixedUniforms[Ie].set(this.program,Ie,E[Ie]);G&&G.setUniforms(this.program,X,this.binderUniforms,F,{zoom:H});const he={[re.POINTS]:1,[re.LINES]:2,[re.TRIANGLES]:3,[re.LINE_STRIP]:1}[d];this.checkUniforms(k,"RENDER_SHADOWS",this.shadowUniforms);const pe=ne&&ne>0?1:void 0;for(const Ie of U.get()){const Se=Ie.vaos||(Ie.vaos={});if((Se[k]||(Se[k]=new Ed)).bind(X,this,O,G?G.getPaintVertexBuffers():[],z,Ie.vertexOffset,W||[],pe),this.forceManualRenderingForInstanceIDShaders){const Ae=ne||1;for(let Ce=0;Ce<Ae;++Ce)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Ce),z?re.drawElements(d,Ie.primitiveLength*he,re.UNSIGNED_SHORT,Ie.primitiveOffset*he*2):re.drawArrays(d,Ie.vertexOffset,Ie.vertexLength)}else ne&&ne>1?re.drawElementsInstanced(d,Ie.primitiveLength*he,re.UNSIGNED_SHORT,Ie.primitiveOffset*he*2,ne):z?re.drawElements(d,Ie.primitiveLength*he,re.UNSIGNED_SHORT,Ie.primitiveOffset*he*2):re.drawArrays(d,Ie.vertexOffset,Ie.vertexLength);d===re.TRIANGLES&&z&&this._drawDebugWireframe(s,m,v,b,z,Ie,F,H,G,ne)}}}function yh(g,s,d=0){const m=Math.pow(2,s.tileID.overscaledZ),v=s.tileSize*Math.pow(2,g.transform.tileZoom)/m,b=v*(s.tileID.canonical.x+s.tileID.wrap*m),S=v*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture?s.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/o.ay(s,1,g.transform.tileZoom),u_pixel_coord_upper:[b>>16,S>>16],u_pixel_coord_lower:[65535&b,65535&S],u_pattern_transition:d}}const kd={terrain:0,flat:1},lm=o.bC(),vh=(g,s,d,m,v,b,S,E,k,O,z,U,F,H,G,W,ne,X)=>{const re=s.style.light,he=re.properties.get("position"),pe=[he.x,he.y,he.z],Ie=o.dL();re.properties.get("anchor")==="viewport"&&(o.dM(Ie,-s.transform.angle),o.dN(pe,pe,Ie));const Se=re.properties.get("color").toPremultipliedRenderColor(null),Ae=s.transform,Ce={u_matrix:g,u_lightpos:pe,u_lightintensity:re.properties.get("intensity"),u_lightcolor:[Se.r,Se.g,Se.b],u_vertical_gradient:+d,u_opacity:m,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:lm,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:kd[O],u_base_type:kd[z],u_ao:v,u_edge_radius:b,u_width_scale:S,u_flood_light_color:G,u_vertical_scale:W,u_flood_light_intensity:ne,u_ground_shadow_factor:X};return Ae.projection.name==="globe"&&(Ce.u_tile_id=[E.canonical.x,E.canonical.y,1<<E.canonical.z],Ce.u_zoom_transition=U,Ce.u_inv_rot_matrix=H,Ce.u_merc_center=F,Ce.u_up_dir=Ae.projection.upVector(new o.cC(0,0,0),F[0]*o.al,F[1]*o.al),Ce.u_height_lift=k),Ce},cm=(g,s,d,m,v,b)=>({u_matrix:g,u_edge_radius:s,u_width_scale:d,u_vertical_scale:m,u_height_type:kd[v],u_base_type:kd[b]}),$g=(g,s,d,m,v,b,S,E,k,O,z,U,F,H,G,W,ne,X)=>{const re=vh(g,s,d,m,v,b,S,E,O,z,U,F,H,G,W,ne,1,[0,0,0]),he={u_height_factor:-Math.pow(2,E.overscaledZ)/k.tileSize/8};return Object.assign(re,yh(s,k,X),he)},Bf=(g,s,d)=>({u_matrix:g,u_emissive_strength:s,u_ground_shadow_factor:d}),rc=(g,s,d,m,v,b=0)=>Object.assign(Bf(g,s,v),yh(d,m,b)),Ff=(g,s,d,m)=>({u_matrix:g,u_world:d,u_emissive_strength:s,u_ground_shadow_factor:m}),ky=(g,s,d,m,v,b,S=0)=>Object.assign(rc(g,s,d,m,b,S),{u_world:v}),Ry=(g,s)=>({u_matrix:g,u_ground_shadow_factor:s}),ru=(g,s,d,m,v)=>({u_matrix:g,u_camera_pos:[s[0],s[1],s[2]],u_depth_bias:d,u_height_scale:m,u_reset_depth:v}),_e=(g,s,d,m,v,b,S)=>({u_matrix:g,u_normal_matrix:s,u_opacity:d,u_faux_facade_ao_intensity:m,u_camera_pos:v,u_tile_to_meter:b,u_facade_emissive_chance:S}),V=g=>({u_matrix:g}),te=g=>({u_matrix:g}),Be=(g,s,d,m,v,b,S,E)=>{const k=o.al/b.tileSize;return{u_matrix:g,u_inv_rot_matrix:s,u_camera_to_center_distance:d.getCameraToCenterDistance(E),u_extrude_scale:[d.pixelsToGLUnits[0]/k,d.pixelsToGLUnits[1]/k],u_zoom_transition:m,u_tile_id:S,u_merc_center:v}},yt=(g,s,d=1)=>({u_matrix:g,u_color:s,u_overlay:0,u_overlay_scale:d}),xt=o.bC(),Yt=(g,s,d,m,v,b,S)=>{const E=g.transform,k=E.projection.name==="globe",O=k?o.dO(E.zoom,s.canonical)*E._pixelsPerMercatorPixel:o.ay(d,1,b),z={u_matrix:s.projMatrix,u_extrude_scale:O,u_intensity:S,u_inv_rot_matrix:xt,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(k){z.u_inv_rot_matrix=m,z.u_merc_center=v,z.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],z.u_zoom_transition=o.aj(E.zoom);const U=v[0]*o.al,F=v[1]*o.al;z.u_up_dir=E.projection.upVector(new o.cC(0,0,0),U,F)}return z};function _n(g,[s,d,m,v],[b,S]){if(b===S)return[0,0,0,0];const E=255*(g-1)/(g*(S-b));return[s*E,d*E,m*E,v*E]}function Bn(g,s,[d,m]){return d===m?0:.5/g+(s-d)*(g-1)/(g*(m-d))}const ni=(g,s,d,m,v,b,S,E,k,O,z,U,F,H,G,W,ne,X,re,he,pe)=>({u_matrix:g,u_normalize_matrix:s,u_globe_matrix:d,u_merc_matrix:m,u_grid_matrix:v,u_tl_parent:b,u_scale_parent:O,u_fade_t:z.mix,u_opacity:z.opacity*U.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:U.paint.get("raster-brightness-min"),u_brightness_high:U.paint.get("raster-brightness-max"),u_saturation_factor:o.dQ(U.paint.get("raster-saturation")),u_contrast_factor:o.dP(U.paint.get("raster-contrast")),u_spin_weights:Jn(U.paint.get("raster-hue-rotate")),u_perspective_transform:F,u_raster_elevation:H,u_zoom_transition:S,u_merc_center:E,u_cutoff_params:k,u_colorization_mix:_n(o.dR,W,X),u_colorization_offset:Bn(o.dR,ne,X),u_color_ramp:G,u_texture_offset:[he/(re+2*he),re/(re+2*he)],u_texture_res:[re+2*he,re+2*he],u_emissive_strength:pe});function Jn(g){g*=Math.PI/180;const s=Math.sin(g),d=Math.cos(g);return[(2*d+1)/3,(-Math.sqrt(3)*s-d+1)/3,(Math.sqrt(3)*s-d+1)/3]}const Gn=.05,Vi=(g,s,d,m,v,b,S,E,k,O,z,U)=>({u_matrix:g,u_normalize_matrix:s,u_globe_matrix:d,u_merc_matrix:m,u_grid_matrix:v,u_tl_parent:b,u_scale_parent:O,u_fade_t:z.mix,u_opacity:z.opacity,u_image0:0,u_image1:1,u_raster_elevation:U,u_zoom_transition:S,u_merc_center:E,u_cutoff_params:k}),Li=(g,s,d,m,v,b,S,E,k,O)=>({u_particle_texture:g,u_particle_texture_side_len:s,u_tile_offset:d,u_velocity:m,u_color_ramp:b,u_velocity_res:v,u_max_speed:S,u_uv_offset:E,u_data_scale:[255*k[0],255*k[1]],u_data_offset:O,u_particle_pos_scale:1.1,u_particle_pos_offset:[Gn,Gn]}),Wi=(g,s,d,m,v,b,S,E,k,O)=>({u_particle_texture:g,u_particle_texture_side_len:s,u_velocity:d,u_velocity_res:m,u_max_speed:v,u_speed_factor:b,u_reset_rate:S,u_rand_seed:Math.random(),u_uv_offset:E,u_data_scale:[255*k[0],255*k[1]],u_data_offset:O,u_particle_pos_scale:1.1,u_particle_pos_offset:[Gn,Gn]}),$i=o.bC(),Yi=(g,s,d,m,v,b,S,E,k,O,z,U,F,H,G,W,ne,X,re,he,pe,Ie,Se,Ae)=>{const Ce=v.transform,we={u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:Ce.getCameraToCenterDistance(re),u_rotate_symbol:+d,u_aspect_ratio:Ce.width/Ce.height,u_fade_change:v.options.fadeDuration?v.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:S,u_coord_matrix:E,u_is_text:+O,u_elevation_from_sea:k?1:0,u_pitch_with_map:+m,u_texsize:z,u_texsize_icon:U,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:$i,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:$i,u_up_vector:[0,-1,0],u_color_adj_mat:Ie,u_icon_transition:Se||0,u_gamma_scale:m?v.transform.getCameraToCenterDistance(re)*Math.cos(v.terrain?0:v.transform._pitch):1,u_device_pixel_ratio:o.o.devicePixelRatio,u_is_halo:1,u_scale_factor:Ae||1,u_ground_shadow_factor:he,u_inv_matrix:o.bl(o.bC(),S),u_normal_scale:pe,u_lutTexture:Ro.LUT};return re.name==="globe"&&(we.u_tile_id=[H.canonical.x,H.canonical.y,1<<H.canonical.z],we.u_zoom_transition=G,we.u_inv_rot_matrix=ne,we.u_merc_center=W,we.u_camera_forward=Ce._camera.forward(),we.u_ecef_origin=o.dS(Ce.globeMatrix,H.toUnwrapped()),we.u_tile_matrix=Float32Array.from(Ce.globeMatrix),we.u_up_vector=X),we},io=(g,s,d,m)=>({u_matrix:g,u_emissive_strength:s,u_opacity:d,u_color:m}),po=(g,s,d,m,v,b,S,E,k)=>Object.assign(function(O,z,U,F,H,G){const{width:W,height:ne}=F.imageManager.getPixelSize(z),X=Math.pow(2,G.tileID.overscaledZ),re=G.tileSize*Math.pow(2,F.transform.tileZoom)/X,he=re*(G.tileID.canonical.x+G.tileID.wrap*X),pe=re*G.tileID.canonical.y;return{u_image:0,u_pattern_tl:U.tl,u_pattern_br:U.br,u_texsize:[W,ne],u_pattern_size:U.displaySize,u_pattern_units_to_pixels:H?[F.transform.width,-1*F.transform.height]:[1/o.ay(G,1,F.transform.tileZoom),1/o.ay(G,1,F.transform.tileZoom)],u_pixel_coord_upper:[he>>16,pe>>16],u_pixel_coord_lower:[65535&he,65535&pe]}}(0,b,S,m,E,k),{u_matrix:g,u_emissive_strength:s,u_opacity:d}),mr=new Float32Array(o.bA([])),Nr=(g,s,d,m,v,b,S,E,k,O,z,U,F,H=[0,0,0],G)=>{const W=v.style.light,ne=W.properties.get("position"),X=[-ne.x,-ne.y,ne.z],re=o.dL();W.properties.get("anchor")==="viewport"&&(o.dM(re,-v.transform.angle),o.dN(X,X,re));const he=z.alphaMode==="MASK",pe=W.properties.get("color").toNonPremultipliedRenderColor(null),Ie=F.paint.get("model-ambient-occlusion-intensity"),Se=F.paint.get("model-color").constantOr(o.ao.white).toNonPremultipliedRenderColor(null);return Se.a=F.paint.get("model-color-mix-intensity").constantOr(0),{u_matrix:g,u_lighting_matrix:s,u_normal_matrix:d,u_node_matrix:m||mr,u_lightpos:X,u_lightintensity:W.properties.get("intensity"),u_lightcolor:[pe.r,pe.g,pe.b],u_camera_pos:H,u_opacity:b,u_baseTextureIsAlpha:0,u_alphaMask:+he,u_alphaCutoff:z.alphaCutoff,u_baseColorFactor:S.toNonPremultipliedRenderColor(null).toArray01(),u_emissiveFactor:E.toNonPremultipliedRenderColor(null).toArray01(),u_metallicFactor:k,u_roughnessFactor:O,u_baseColorTexture:Ro.BaseColor,u_metallicRoughnessTexture:Ro.MetallicRoughness,u_normalTexture:Ro.Normal,u_occlusionTexture:Ro.Occlusion,u_emissionTexture:Ro.Emission,u_lutTexture:Ro.LUT,u_color_mix:Se.toArray01(),u_aoIntensity:Ie,u_emissive_strength:U,u_occlusionTextureTransform:G||[0,0,0,0]}},Qi=(g,s=mr,d=mr)=>({u_matrix:g,u_instance:s,u_node_matrix:d}),Dr={fillExtrusion:g=>({u_matrix:new o.ck(g),u_lightpos:new o.ch(g),u_lightintensity:new o.ci(g),u_lightcolor:new o.ch(g),u_vertical_gradient:new o.ci(g),u_opacity:new o.ci(g),u_edge_radius:new o.ci(g),u_width_scale:new o.ci(g),u_ao:new o.cj(g),u_height_type:new o.cg(g),u_base_type:new o.cg(g),u_tile_id:new o.ch(g),u_zoom_transition:new o.ci(g),u_inv_rot_matrix:new o.ck(g),u_merc_center:new o.cj(g),u_up_dir:new o.ch(g),u_height_lift:new o.ci(g),u_flood_light_color:new o.ch(g),u_vertical_scale:new o.ci(g),u_flood_light_intensity:new o.ci(g),u_ground_shadow_factor:new o.ch(g)}),fillExtrusionDepth:g=>({u_matrix:new o.ck(g),u_edge_radius:new o.ci(g),u_width_scale:new o.ci(g),u_vertical_scale:new o.ci(g),u_height_type:new o.cg(g),u_base_type:new o.cg(g)}),fillExtrusionPattern:g=>({u_matrix:new o.ck(g),u_lightpos:new o.ch(g),u_lightintensity:new o.ci(g),u_lightcolor:new o.ch(g),u_vertical_gradient:new o.ci(g),u_height_factor:new o.ci(g),u_edge_radius:new o.ci(g),u_width_scale:new o.ci(g),u_ao:new o.cj(g),u_height_type:new o.cg(g),u_base_type:new o.cg(g),u_tile_id:new o.ch(g),u_zoom_transition:new o.ci(g),u_inv_rot_matrix:new o.ck(g),u_merc_center:new o.cj(g),u_up_dir:new o.ch(g),u_height_lift:new o.ci(g),u_image:new o.cg(g),u_texsize:new o.cj(g),u_pixel_coord_upper:new o.cj(g),u_pixel_coord_lower:new o.cj(g),u_tile_units_to_pixels:new o.ci(g),u_opacity:new o.ci(g),u_pattern_transition:new o.ci(g)}),fillExtrusionGroundEffect:g=>({u_matrix:new o.ck(g),u_opacity:new o.ci(g),u_ao_pass:new o.ci(g),u_meter_to_tile:new o.ci(g),u_ao:new o.cj(g),u_flood_light_intensity:new o.ci(g),u_flood_light_color:new o.ch(g),u_attenuation:new o.ci(g),u_edge_radius:new o.ci(g),u_fb:new o.cg(g),u_fb_size:new o.ci(g),u_dynamic_offset:new o.ci(g)}),fill:g=>({u_matrix:new o.ck(g),u_emissive_strength:new o.ci(g),u_ground_shadow_factor:new o.ch(g)}),fillPattern:g=>({u_matrix:new o.ck(g),u_emissive_strength:new o.ci(g),u_image:new o.cg(g),u_texsize:new o.cj(g),u_pixel_coord_upper:new o.cj(g),u_pixel_coord_lower:new o.cj(g),u_tile_units_to_pixels:new o.ci(g),u_ground_shadow_factor:new o.ch(g),u_pattern_transition:new o.ci(g)}),fillOutline:g=>({u_matrix:new o.ck(g),u_emissive_strength:new o.ci(g),u_world:new o.cj(g),u_ground_shadow_factor:new o.ch(g)}),fillOutlinePattern:g=>({u_matrix:new o.ck(g),u_emissive_strength:new o.ci(g),u_world:new o.cj(g),u_image:new o.cg(g),u_texsize:new o.cj(g),u_pixel_coord_upper:new o.cj(g),u_pixel_coord_lower:new o.cj(g),u_tile_units_to_pixels:new o.ci(g),u_ground_shadow_factor:new o.ch(g),u_pattern_transition:new o.ci(g)}),building:g=>({u_matrix:new o.ck(g),u_normal_matrix:new o.ck(g),u_opacity:new o.ci(g),u_faux_facade_ao_intensity:new o.ci(g),u_camera_pos:new o.ch(g),u_tile_to_meter:new o.ci(g),u_facade_emissive_chance:new o.ci(g)}),buildingBloom:g=>({u_matrix:new o.ck(g)}),buildingDepth:g=>({u_matrix:new o.ck(g)}),elevatedStructuresDepth:g=>({u_matrix:new o.ck(g),u_depth_bias:new o.ci(g)}),elevatedStructures:g=>({u_matrix:new o.ck(g),u_ground_shadow_factor:new o.ch(g)}),elevatedStructuresDepthReconstruct:g=>({u_matrix:new o.ck(g),u_camera_pos:new o.ch(g),u_depth_bias:new o.ci(g),u_height_scale:new o.ci(g),u_reset_depth:new o.ci(g)}),circle:o.dV,collisionBox:g=>({u_matrix:new o.ck(g),u_inv_rot_matrix:new o.ck(g),u_camera_to_center_distance:new o.ci(g),u_extrude_scale:new o.cj(g),u_zoom_transition:new o.ci(g),u_merc_center:new o.cj(g),u_tile_id:new o.ch(g)}),collisionCircle:g=>({u_matrix:new o.ck(g),u_inv_matrix:new o.ck(g),u_camera_to_center_distance:new o.ci(g),u_viewport_size:new o.cj(g)}),debug:g=>({u_color:new o.dx(g),u_matrix:new o.ck(g),u_overlay:new o.cg(g),u_overlay_scale:new o.ci(g)}),clippingMask:g=>({u_matrix:new o.ck(g)}),heatmap:g=>({u_extrude_scale:new o.ci(g),u_intensity:new o.ci(g),u_matrix:new o.ck(g),u_inv_rot_matrix:new o.ck(g),u_merc_center:new o.cj(g),u_tile_id:new o.ch(g),u_zoom_transition:new o.ci(g),u_up_dir:new o.ch(g)}),heatmapTexture:g=>({u_image:new o.cg(g),u_color_ramp:new o.cg(g),u_opacity:new o.ci(g)}),hillshade:g=>({u_matrix:new o.ck(g),u_image:new o.cg(g),u_latrange:new o.cj(g),u_light:new o.cj(g),u_shadow:new o.dx(g),u_highlight:new o.dx(g),u_emissive_strength:new o.ci(g),u_accent:new o.dx(g)}),hillshadePrepare:g=>({u_matrix:new o.ck(g),u_image:new o.cg(g),u_dimension:new o.cj(g),u_zoom:new o.ci(g)}),line:o.dU,linePattern:o.dT,raster:g=>({u_matrix:new o.ck(g),u_normalize_matrix:new o.ck(g),u_globe_matrix:new o.ck(g),u_merc_matrix:new o.ck(g),u_grid_matrix:new o.dy(g),u_tl_parent:new o.cj(g),u_scale_parent:new o.ci(g),u_fade_t:new o.ci(g),u_opacity:new o.ci(g),u_image0:new o.cg(g),u_image1:new o.cg(g),u_brightness_low:new o.ci(g),u_brightness_high:new o.ci(g),u_saturation_factor:new o.ci(g),u_contrast_factor:new o.ci(g),u_spin_weights:new o.ch(g),u_perspective_transform:new o.cj(g),u_raster_elevation:new o.ci(g),u_zoom_transition:new o.ci(g),u_merc_center:new o.cj(g),u_cutoff_params:new o.d2(g),u_colorization_mix:new o.d2(g),u_colorization_offset:new o.ci(g),u_color_ramp:new o.cg(g),u_texture_offset:new o.cj(g),u_texture_res:new o.cj(g),u_emissive_strength:new o.ci(g)}),rasterParticle:g=>({u_matrix:new o.ck(g),u_normalize_matrix:new o.ck(g),u_globe_matrix:new o.ck(g),u_merc_matrix:new o.ck(g),u_grid_matrix:new o.dy(g),u_tl_parent:new o.cj(g),u_scale_parent:new o.ci(g),u_fade_t:new o.ci(g),u_opacity:new o.ci(g),u_image0:new o.cg(g),u_image1:new o.cg(g),u_raster_elevation:new o.ci(g),u_zoom_transition:new o.ci(g),u_merc_center:new o.cj(g),u_cutoff_params:new o.d2(g)}),rasterParticleTexture:g=>({u_texture:new o.cg(g),u_opacity:new o.ci(g)}),rasterParticleDraw:g=>({u_particle_texture:new o.cg(g),u_particle_texture_side_len:new o.ci(g),u_tile_offset:new o.cj(g),u_velocity:new o.cg(g),u_color_ramp:new o.cg(g),u_velocity_res:new o.cj(g),u_max_speed:new o.ci(g),u_uv_offset:new o.cj(g),u_data_scale:new o.cj(g),u_data_offset:new o.ci(g),u_particle_pos_scale:new o.ci(g),u_particle_pos_offset:new o.cj(g)}),rasterParticleUpdate:g=>({u_particle_texture:new o.cg(g),u_particle_texture_side_len:new o.ci(g),u_velocity:new o.cg(g),u_velocity_res:new o.cj(g),u_max_speed:new o.ci(g),u_speed_factor:new o.ci(g),u_reset_rate:new o.ci(g),u_rand_seed:new o.ci(g),u_uv_offset:new o.cj(g),u_data_scale:new o.cj(g),u_data_offset:new o.ci(g),u_particle_pos_scale:new o.ci(g),u_particle_pos_offset:new o.cj(g)}),symbol:g=>({u_is_size_zoom_constant:new o.cg(g),u_is_size_feature_constant:new o.cg(g),u_size_t:new o.ci(g),u_size:new o.ci(g),u_camera_to_center_distance:new o.ci(g),u_rotate_symbol:new o.cg(g),u_aspect_ratio:new o.ci(g),u_fade_change:new o.ci(g),u_matrix:new o.ck(g),u_label_plane_matrix:new o.ck(g),u_coord_matrix:new o.ck(g),u_is_text:new o.cg(g),u_elevation_from_sea:new o.cg(g),u_pitch_with_map:new o.cg(g),u_texsize:new o.cj(g),u_texsize_icon:new o.cj(g),u_texture:new o.cg(g),u_texture_icon:new o.cg(g),u_gamma_scale:new o.ci(g),u_device_pixel_ratio:new o.ci(g),u_tile_id:new o.ch(g),u_zoom_transition:new o.ci(g),u_inv_rot_matrix:new o.ck(g),u_merc_center:new o.cj(g),u_camera_forward:new o.ch(g),u_tile_matrix:new o.ck(g),u_up_vector:new o.ch(g),u_ecef_origin:new o.ch(g),u_is_halo:new o.cg(g),u_icon_transition:new o.ci(g),u_color_adj_mat:new o.ck(g),u_scale_factor:new o.ci(g),u_ground_shadow_factor:new o.ch(g),u_inv_matrix:new o.ck(g),u_normal_scale:new o.ci(g),u_lutTexture:new o.cg(g)}),background:g=>({u_matrix:new o.ck(g),u_emissive_strength:new o.ci(g),u_opacity:new o.ci(g),u_color:new o.dx(g)}),backgroundPattern:g=>({u_matrix:new o.ck(g),u_emissive_strength:new o.ci(g),u_opacity:new o.ci(g),u_image:new o.cg(g),u_pattern_tl:new o.cj(g),u_pattern_br:new o.cj(g),u_texsize:new o.cj(g),u_pattern_size:new o.cj(g),u_pixel_coord_upper:new o.cj(g),u_pixel_coord_lower:new o.cj(g),u_pattern_units_to_pixels:new o.cj(g)}),terrainRaster:g=>({u_matrix:new o.ck(g),u_image0:new o.cg(g),u_skirt_height:new o.ci(g),u_ground_shadow_factor:new o.ch(g)}),skybox:g=>({u_matrix:new o.ck(g),u_sun_direction:new o.ch(g),u_cubemap:new o.cg(g),u_opacity:new o.ci(g),u_temporal_offset:new o.ci(g)}),skyboxGradient:g=>({u_matrix:new o.ck(g),u_color_ramp:new o.cg(g),u_center_direction:new o.ch(g),u_radius:new o.ci(g),u_opacity:new o.ci(g),u_temporal_offset:new o.ci(g)}),skyboxCapture:g=>({u_matrix_3f:new o.dy(g),u_sun_direction:new o.ch(g),u_sun_intensity:new o.ci(g),u_color_tint_r:new o.d2(g),u_color_tint_m:new o.d2(g),u_luminance:new o.ci(g)}),globeRaster:g=>({u_proj_matrix:new o.ck(g),u_globe_matrix:new o.ck(g),u_normalize_matrix:new o.ck(g),u_merc_matrix:new o.ck(g),u_zoom_transition:new o.ci(g),u_merc_center:new o.cj(g),u_image0:new o.cg(g),u_grid_matrix:new o.dy(g),u_skirt_height:new o.ci(g),u_far_z_cutoff:new o.ci(g),u_frustum_tl:new o.ch(g),u_frustum_tr:new o.ch(g),u_frustum_br:new o.ch(g),u_frustum_bl:new o.ch(g),u_globe_pos:new o.ch(g),u_globe_radius:new o.ci(g),u_viewport:new o.cj(g)}),globeAtmosphere:g=>({u_frustum_tl:new o.ch(g),u_frustum_tr:new o.ch(g),u_frustum_br:new o.ch(g),u_frustum_bl:new o.ch(g),u_horizon:new o.ci(g),u_transition:new o.ci(g),u_fadeout_range:new o.ci(g),u_atmosphere_fog_color:new o.d2(g),u_high_color:new o.d2(g),u_space_color:new o.d2(g),u_temporal_offset:new o.ci(g),u_horizon_angle:new o.ci(g)}),model:g=>({u_matrix:new o.ck(g),u_lighting_matrix:new o.ck(g),u_normal_matrix:new o.ck(g),u_node_matrix:new o.ck(g),u_lightpos:new o.ch(g),u_lightintensity:new o.ci(g),u_lightcolor:new o.ch(g),u_camera_pos:new o.ch(g),u_opacity:new o.ci(g),u_baseColorFactor:new o.d2(g),u_emissiveFactor:new o.d2(g),u_metallicFactor:new o.ci(g),u_roughnessFactor:new o.ci(g),u_baseTextureIsAlpha:new o.cg(g),u_alphaMask:new o.cg(g),u_alphaCutoff:new o.ci(g),u_baseColorTexture:new o.cg(g),u_metallicRoughnessTexture:new o.cg(g),u_normalTexture:new o.cg(g),u_occlusionTexture:new o.cg(g),u_emissionTexture:new o.cg(g),u_lutTexture:new o.cg(g),u_color_mix:new o.d2(g),u_aoIntensity:new o.ci(g),u_emissive_strength:new o.ci(g),u_occlusionTextureTransform:new o.d2(g)}),modelDepth:g=>({u_matrix:new o.ck(g),u_instance:new o.ck(g),u_node_matrix:new o.ck(g)}),groundShadow:g=>({u_matrix:new o.ck(g),u_ground_shadow_factor:new o.ch(g)}),stars:g=>({u_matrix:new o.ck(g),u_up:new o.ch(g),u_right:new o.ch(g),u_intensity_multiplier:new o.ci(g)}),snowParticle:g=>({u_modelview:new o.ck(g),u_projection:new o.ck(g),u_time:new o.ci(g),u_cam_pos:new o.ch(g),u_velocityConeAperture:new o.ci(g),u_velocity:new o.ci(g),u_horizontalOscillationRadius:new o.ci(g),u_horizontalOscillationRate:new o.ci(g),u_boxSize:new o.ci(g),u_billboardSize:new o.ci(g),u_simpleShapeParameters:new o.cj(g),u_screenSize:new o.cj(g),u_thinningCenterPos:new o.cj(g),u_thinningShape:new o.ch(g),u_thinningAffectedRatio:new o.ci(g),u_thinningParticleOffset:new o.ci(g),u_particleColor:new o.d2(g),u_direction:new o.ch(g)}),rainParticle:g=>({u_modelview:new o.ck(g),u_projection:new o.ck(g),u_time:new o.ci(g),u_cam_pos:new o.ch(g),u_texScreen:new o.cg(g),u_velocityConeAperture:new o.ci(g),u_velocity:new o.ci(g),u_boxSize:new o.ci(g),u_rainDropletSize:new o.cj(g),u_distortionStrength:new o.ci(g),u_rainDirection:new o.ch(g),u_color:new o.d2(g),u_screenSize:new o.cj(g),u_thinningCenterPos:new o.cj(g),u_thinningShape:new o.ch(g),u_thinningAffectedRatio:new o.ci(g),u_thinningParticleOffset:new o.ci(g),u_shapeDirectionalPower:new o.ci(g),u_shapeNormalPower:new o.ci(g),u_mode:new o.ci(g)}),vignette:g=>({u_vignetteShape:new o.ch(g),u_vignetteColor:new o.d2(g)}),occlusion:g=>({u_matrix:new o.ck(g),u_anchorPos:new o.ch(g),u_screenSizePx:new o.cj(g),u_occluderSizePx:new o.cj(g),u_color:new o.d2(g)})};class Ar{constructor(s,d,m,v){this.id=Ar.uniqueIdxCounter,Ar.uniqueIdxCounter++,this.context=s;const b=s.gl;this.buffer=b.createBuffer(),this.dynamicDraw=!!m,this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||v||d.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(s){this.id=Ar.uniqueIdxCounter,Ar.uniqueIdxCounter++;const d=this.context.gl;this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Ar.uniqueIdxCounter=0;const mo={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class go{constructor(s,d,m,v,b,S){this.length=d.length,this.attributes=m,this.itemSize=d.bytesPerElement,this.dynamicDraw=v,this.instanceCount=S,this.context=s;const E=s.gl;this.buffer=E.createBuffer(),s.bindVertexBuffer.set(this.buffer),E.bufferData(E.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||b||d.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,d){for(let m=0;m<this.attributes.length;m++){const v=d.getAttributeLocation(s,this.attributes[m].name);v!==-1&&s.enableVertexAttribArray(v)}}setVertexAttribPointers(s,d,m){for(let v=0;v<this.attributes.length;v++){const b=this.attributes[v],S=d.getAttributeLocation(s,b.name);S!==-1&&s.vertexAttribPointer(S,b.components,s[mo[b.type]],!1,this.itemSize,b.offset+this.itemSize*(m||0))}}setVertexAttribDivisor(s,d,m){for(let v=0;v<this.attributes.length;v++){const b=d.getAttributeLocation(s,this.attributes[v].name);b!==-1&&this.instanceCount&&this.instanceCount>0&&s.vertexAttribDivisor(b,m)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Qo{constructor(s,d,m,v,b){this.context=s,this.width=d,this.height=m;const S=this.framebuffer=s.gl.createFramebuffer();v&&(this.colorAttachment=new Fg(s,S)),b&&(this.depthAttachmentType=b,this.depthAttachment=b==="renderbuffer"?new Ng(s,S):new Iy(s,S))}destroy(){const s=this.context.gl;if(this.colorAttachment){const d=this.colorAttachment.get();d&&s.deleteTexture(d)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const d=this.depthAttachment.get();d&&s.deleteRenderbuffer(d)}else{const d=this.depthAttachment.get();d&&s.deleteTexture(d)}s.deleteFramebuffer(this.framebuffer)}}class va{constructor(s,d){this.gl=s,this.clearColor=new ph(this),this.clearDepth=new nm(this),this.clearStencil=new Mg(this),this.colorMask=new Dg(this),this.depthMask=new mh(this),this.stencilMask=new im(this),this.stencilFunc=new Tf(this),this.stencilOp=new Ty(this),this.stencilTest=new Ef(this),this.depthRange=new Ey(this),this.depthTest=new Qc(this),this.depthFunc=new rm(this),this.blend=new If(this),this.blendFunc=new om(this),this.blendColor=new Fu(this),this.blendEquation=new _c(this),this.cullFace=new Id(this),this.cullFaceSide=new Af(this),this.frontFace=new Nu(this),this.program=new Og(this),this.activeTexture=new eu(this),this.viewport=new kf(this),this.bindFramebuffer=new Vu(this),this.bindRenderbuffer=new Rf(this),this.bindTexture=new Pf(this),this.bindVertexBuffer=new sm(this),this.bindElementBuffer=new tu(this),this.bindVertexArrayOES=new Rl(this),this.pixelStoreUnpack=new Lg(this),this.pixelStoreUnpackPremultiplyAlpha=new zg(this),this.pixelStoreUnpackFlipY=new Bg(this),this.options=d?Object.assign({},d):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=s.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=s.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=s.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=d&&!!d.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=s.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=s.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=s.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),this.maxPointSize=s.getParameter(s.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,d,m){return new Ar(this,s,d,m)}createVertexBuffer(s,d,m,v,b){return new go(this,s,d,m,v,b)}createRenderbuffer(s,d,m){const v=this.gl,b=v.createRenderbuffer();return this.bindRenderbuffer.set(b),v.renderbufferStorage(v.RENDERBUFFER,s,d,m),this.bindRenderbuffer.set(null),b}createFramebuffer(s,d,m,v){return new Qo(this,s,d,m,v)}clear({color:s,depth:d,stencil:m,colorMask:v}){const b=this.gl;let S=0;s&&(S|=b.COLOR_BUFFER_BIT,this.clearColor.set(s.toNonPremultipliedRenderColor(null)),this.colorMask.set(v||[!0,!0,!0,!0])),d!==void 0&&(S|=b.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),m!==void 0&&(S|=b.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),b.clear(S)}setCullFace(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){o.by(s.blendFunction,ti.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor),s.blendEquation?this.blendEquation.set(s.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(s.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let Ps;function js(g,s,d,m,v,b,S){const E=g.context,k=E.gl,O=g.transform,z=[o.aF(O.center.lng),o.aJ(O.center.lat)],U=d.layout.get("symbol-placement"),F=d.layout.get("text-variable-anchor"),H=d.layout.get("icon-rotation-alignment")==="map",G=d.layout.get("text-rotation-alignment")==="map",W=U!=="point",ne=[];let X=0,re=0;for(let we=0;we<m.length;we++){const ke=m[we],nt=s.getTile(ke),Ke=nt.getBucket(d);if(!Ke)continue;const ht=Ke.getProjection().createInversionMatrix(O,ke.canonical),et=[],ut=Au(ke,Ke,O),jt=!S&&H&&W,tt=S&&G&&W,Ue=F&&Ke.hasTextData(),pt=Ke.hasIconTextFit()&&Ue&&Ke.hasIconData(),ot=jt||tt||S&&Ue||pt,Et=Ke.projection.name==="globe",$t=Et?o.aj(O.zoom):0;Et&&(et.push("PROJECTION_GLOBE_VIEW"),ot&&et.push("PROJECTED_POS_ON_VIEWPORT"));const rn=g.getOrCreateProgram("collisionBox",{defines:et});let Lt=ut;v[0]===0&&v[1]===0||(Lt=g.translatePosMatrix(ut,nt,v,b));const Rt=S?Ke.textCollisionBox:Ke.iconCollisionBox,Cn=Ke.collisionCircleArray;if(Cn.length>0){const wn=o.bC(),gn=Lt;o.cO(wn,Ke.placementInvProjMatrix,O.glCoordMatrix),o.cO(wn,wn,Ke.placementViewportMatrix),ne.push({circleArray:Cn,circleOffset:re,transform:gn,invTransform:wn,projection:Ke.getProjection()}),X+=Cn.length/4,re=X}if(!Rt)continue;g.terrain&&g.terrain.setupElevationDraw(nt,rn);const yn=Et?[ke.canonical.x,ke.canonical.y,1<<ke.canonical.z]:[0,0,0];rn.draw(g,k.LINES,sn.disabled,Dn.disabled,g.colorModeForRenderPass(),jn.disabled,Be(Lt,ht,O,$t,z,nt,yn,Ke.getProjection()),d.id,Rt.layoutVertexBuffer,Rt.indexBuffer,Rt.segments,null,O.zoom,null,[Rt.collisionVertexBuffer,Rt.collisionVertexBufferExt])}if(!S||!ne.length)return;const he=g.getOrCreateProgram("collisionCircle"),pe=new o.dW;pe.resize(4*X),pe._trim();let Ie=0;for(const we of ne)for(let ke=0;ke<we.circleArray.length/4;ke++){const nt=4*ke,Ke=we.circleArray[nt+0],ht=we.circleArray[nt+1],et=we.circleArray[nt+2],ut=we.circleArray[nt+3];pe.emplace(Ie++,Ke,ht,et,ut,0),pe.emplace(Ie++,Ke,ht,et,ut,1),pe.emplace(Ie++,Ke,ht,et,ut,2),pe.emplace(Ie++,Ke,ht,et,ut,3)}(!Ps||Ps.length<2*X)&&(Ps=function(we){const ke=2*we,nt=new o.b1;nt.resize(ke),nt._trim();for(let Ke=0;Ke<ke;Ke++){const ht=6*Ke;nt.uint16[ht+0]=4*Ke+0,nt.uint16[ht+1]=4*Ke+1,nt.uint16[ht+2]=4*Ke+2,nt.uint16[ht+3]=4*Ke+2,nt.uint16[ht+4]=4*Ke+3,nt.uint16[ht+5]=4*Ke+0}return nt}(X));const Se=E.createIndexBuffer(Ps,!0),Ae=E.createVertexBuffer(pe,o.dX.members,!0);for(const we of ne){const ke={u_matrix:we.transform,u_inv_matrix:we.invTransform,u_camera_to_center_distance:(Ce=O).getCameraToCenterDistance(we.projection),u_viewport_size:[Ce.width,Ce.height]};he.draw(g,k.TRIANGLES,sn.disabled,Dn.disabled,g.colorModeForRenderPass(),jn.disabled,ke,d.id,Ae,Se,o.bg.simpleSegment(0,2*we.circleOffset,we.circleArray.length,we.circleArray.length/2),null,O.zoom)}var Ce;Ae.destroy(),Se.destroy()}const Us=o.bC();function Aa(g){const s=g._camera.getWorldToCamera(g.worldSize,1),d=o.aB([],s,g.globeMatrix);o.bl(d,d);const m=[0,0,0],v=[0,1,0,0];return o.aC(v,v,d),m[0]=v[0],m[1]=v[1],m[2]=v[2],o.aw(m,m),m}function Uo({width:g,height:s,anchor:d,textOffset:m,textScale:v},b){const{horizontalAlign:S,verticalAlign:E}=o.c0(d),k=-(S-.5)*g,O=-(E-.5)*s,z=o.c1(d,m);return new o.P((k/v+z[0])*b,(O/v+z[1])*b)}function Ha(g,s,d,m,v,b,S,E,k,O){const z=g.text.placedSymbolArray,U=g.text.dynamicLayoutVertexArray,F=g.icon.dynamicLayoutVertexArray,H={},G=g.getProjection(),W=na(S,G,v),ne=v.elevation,X=G.upVectorScale(S.canonical,v.center.lat,v.worldSize).metersToTile;U.clear();for(let re=0;re<z.length;re++){const he=z.get(re),{tileAnchorX:pe,tileAnchorY:Ie,numGlyphs:Se}=he,Ae=he.hidden||!he.crossTileID||g.allowVerticalPlacement&&!he.placedOrientation?null:m[he.crossTileID];if(Ae){let Ce=0,we=0,ke=0;if(ne){const pt=ne?ne.getAtTileOffset(S,pe,Ie):0,[ot,Et,$t]=G.upVector(S.canonical,pe,Ie);Ce=pt*ot*X,we=pt*Et*X,ke=pt*$t*X}let[nt,Ke,ht,et]=$s(he.projectedAnchorX+Ce,he.projectedAnchorY+we,he.projectedAnchorZ+ke,d?W:b);const ut=Ta(v.getCameraToCenterDistance(G),et);let jt=o.bM(g.textSizeData,k,he)*ut/o.bX;d&&(jt*=g.tilePixelRatio/E);const tt=Uo(Ae,jt);d?({x:nt,y:Ke,z:ht}=G.projectTilePoint(pe+tt.x,Ie+tt.y,S.canonical),[nt,Ke,ht]=$s(nt+Ce,Ke+we,ht+ke,b)):(s&&tt._rotate(-v.angle),nt+=tt.x,Ke+=tt.y,ht=0);const Ue=g.allowVerticalPlacement&&he.placedOrientation===o.bL.vertical?Math.PI/2:0;for(let pt=0;pt<Se;pt++)o.bO(U,nt,Ke,ht,Ue);O&&he.associatedIconIndex>=0&&(H[he.associatedIconIndex]={x:nt,y:Ke,z:ht,angle:Ue})}else Pn(Se,U)}if(O){F.clear();const re=g.icon.placedSymbolArray;for(let he=0;he<re.length;he++){const pe=re.get(he),{numGlyphs:Ie}=pe,Se=H[he];if(pe.hidden||!Se)Pn(Ie,F);else{const{x:Ae,y:Ce,z:we,angle:ke}=Se;for(let nt=0;nt<Ie;nt++)o.bO(F,Ae,Ce,we,ke)}}g.icon.dynamicLayoutVertexBuffer.updateData(F)}g.text.dynamicLayoutVertexBuffer.updateData(U)}function ka(g,s,d,m,v,b,S={}){const E=d.paint.get("icon-translate"),k=d.paint.get("text-translate"),O=d.paint.get("icon-translate-anchor"),z=d.paint.get("text-translate-anchor"),U=d.layout.get("icon-rotation-alignment"),F=d.layout.get("text-rotation-alignment"),H=d.layout.get("icon-pitch-alignment"),G=d.layout.get("text-pitch-alignment"),W=d.layout.get("icon-keep-upright"),ne=d.layout.get("text-keep-upright"),X=d.paint.get("icon-color-saturation"),re=d.paint.get("icon-color-contrast"),he=d.paint.get("icon-color-brightness-min"),pe=d.paint.get("icon-color-brightness-max"),Ie=d.layout.get("symbol-elevation-reference")==="sea",Se=d.layout.get("icon-image-use-theme")==="none",Ae=g.context,Ce=Ae.gl,we=g.transform,ke=U==="map",nt=F==="map",Ke=H==="map",ht=G==="map",et=d.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ut=!1;const jt=g.depthModeForSublayer(0,sn.ReadOnly),tt=new sn(g.context.gl.LEQUAL,sn.ReadOnly,g.depthRangeFor3D),Ue=[o.aF(we.center.lng),o.aJ(we.center.lat)],pt=d.layout.get("text-variable-anchor"),ot=we.projection.name==="globe",Et=[],$t=[0,-1,0];for(const rn of m){const Lt=s.getTile(rn),Rt=Lt.getBucket(d);if(!Rt||Rt.projection.name==="mercator"&&ot||Rt.fullyClipped)continue;const Cn=Rt.projection.name==="globe",yn=Cn?o.aj(we.zoom):0,wn=na(rn,Rt.getProjection(),we),gn=we.calculatePixelsToTileUnitsMatrix(Lt),Wn=pt&&Rt.hasTextData(),ri=Rt.hasIconTextFit()&&Wn&&Rt.hasIconData(),ci=Rt.getProjection().createInversionMatrix(we,rn.canonical),or=(1<<Lt.tileID.canonical.z)*o.al/g.transform.worldSize,Xn=qr=>{let ui=[0,0,0];if(qr){const Vn=g.style.directionalLight,sr=g.style.ambientLight;Vn&&sr&&(ui=Al(g.style,Vn,sr))}return ui},ji=qr=>{we.depthOcclusionForSymbolsAndCircles&&(d.hasOcclusionOpacityProperties||g.terrain)&&(qr.push("DEPTH_D24"),qr.push("DEPTH_OCCLUSION"))},rr=qr=>{d.lut&&!Se&&(d.lut.texture||(d.lut.texture=new o.dY(g.context,d.lut.image,[d.lut.image.height,d.lut.image.height,d.lut.image.height],Ae.gl.RGBA8)),Ae.activeTexture.set(Ae.gl.TEXTURE0+Ro.LUT),d.lut.texture&&d.lut.texture.bind(Ae.gl.LINEAR,Ae.gl.CLAMP_TO_EDGE),qr.push("APPLY_LUT_ON_GPU"))},$r=()=>{const qr=ke&&d.layout.get("symbol-placement")!=="point",ui=[];ji(ui),rr(ui);const Vn=qr||ri,sr=Rt.elevationType==="road",yo=g.shadowRenderer,Yr=sr&&Ke&&!!yo&&yo.enabled,es=Xn(Yr),Js=sr&&Ke&&!g.terrain?tt:jt,Dl=d.paint.get("icon-image-cross-fade");g.terrainRenderModeElevated()&&Ke&&ui.push("PITCH_WITH_MAP_TERRAIN"),Cn&&(ui.push("PROJECTION_GLOBE_VIEW"),Vn&&ui.push("PROJECTED_POS_ON_VIEWPORT")),Dl>0&&Rt.hasAnySecondaryIcon&&ui.push("ICON_TRANSITION"),!Rt.icon.zOffsetVertexBuffer||sr&&g.terrain||ui.push("Z_OFFSET"),X===0&&re===0&&he===0&&pe===1||ui.push("COLOR_ADJUSTMENT"),Rt.sdfIcons&&ui.push("RENDER_SDF"),Yr&&ui.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),sr&&Ke&&!g.terrain&&Rt.icon.orientationVertexBuffer&&ui.push("ELEVATED_ROADS");const Ol=Rt.icon.programConfigurations.get(d.id),ol=g.getOrCreateProgram("symbol",{config:Ol,defines:ui}),sl=Lt.imageAtlasTexture?Lt.imageAtlasTexture.size:[0,0],Pa=Rt.iconSizeData,sc=o.bK(Pa,we.zoom),Ac=Ke||!we.isOrthographic,To=Vs(wn,Lt.tileID.canonical,Ke,ke,we,Rt.getProjection(),gn),Mo=Wc(wn,Lt.tileID.canonical,Ke,ke,we,Rt.getProjection(),gn),Jr=g.translatePosMatrix(Mo,Lt,E,O,!0),fs=g.translatePosMatrix(wn,Lt,E,O),Os=Vn?Us:To,Go=ke&&!Ke&&!qr;let aa=$t;!ot&&!we.mercatorFromTransition||ke||(aa=Aa(we));const lu=Cn?aa:$t,Gu=d.getColorAdjustmentMatrix(X,re,he,pe),kc=Yi(Pa.kind,sc,Go,Ke,g,fs,Os,Jr,Ie,!1,sl,[0,0],0,rn,yn,Ue,ci,lu,Rt.getProjection(),es,or,Gu,Dl,null),zd=Lt.imageAtlasTexture?Lt.imageAtlasTexture:null,Bd=d.layout.get("icon-size").constantOr(0)!==1||Rt.iconsNeedLinear,cu=Rt.sdfIcons||g.options.rotating||g.options.zooming||Bd||Ac?Ce.LINEAR:Ce.NEAREST,Yf=Rt.sdfIcons&&d.paint.get("icon-halo-width").constantOr(1)!==0,Wu=g.terrain&&Ke&&qr?o.bl(o.bC(),To):Us;if(qr&&Rt.icon){const uu=we.elevation,qu=uu?uu.getAtTileOffsetFunc(rn,we.center.lat,we.worldSize,Rt.getProjection()):null,o_=el(wn,Lt.tileID.canonical,Ke,ke,we,Rt.getProjection(),gn);Yl(Rt,wn,g,!1,o_,Mo,Ke,W,qu,rn)}return{program:ol,buffers:Rt.icon,uniformValues:kc,atlasTexture:zd,atlasTextureIcon:null,atlasInterpolation:cu,atlasInterpolationIcon:null,isSDF:Rt.sdfIcons,hasHalo:Yf,depthMode:Js,tile:Lt,renderWithShadows:Yr,labelPlaneMatrixInv:Wu}},oi=()=>{const qr=nt&&d.layout.get("symbol-placement")!=="point",ui=[],Vn=qr||pt||ri,sr=Rt.elevationType==="road",yo=g.shadowRenderer,Yr=sr&&ht&&!!yo&&yo.enabled,es=Xn(Yr),Js=sr&&ht&&!g.terrain?tt:jt;g.terrainRenderModeElevated()&&ht&&ui.push("PITCH_WITH_MAP_TERRAIN"),Cn&&(ui.push("PROJECTION_GLOBE_VIEW"),Vn&&ui.push("PROJECTED_POS_ON_VIEWPORT")),!Rt.text.zOffsetVertexBuffer||sr&&g.terrain||ui.push("Z_OFFSET"),Rt.iconsInText&&ui.push("RENDER_TEXT_AND_SYMBOL"),ui.push("RENDER_SDF"),Yr&&ui.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),sr&&ht&&!g.terrain&&Rt.text.orientationVertexBuffer&&ui.push("ELEVATED_ROADS"),ji(ui);const Dl=Rt.text.programConfigurations.get(d.id),Ol=g.getOrCreateProgram("symbol",{config:Dl,defines:ui});let ol,sl=[0,0],Pa=null;const sc=Rt.textSizeData;Rt.iconsInText&&(sl=Lt.imageAtlasTexture?Lt.imageAtlasTexture.size:[0,0],Pa=Lt.imageAtlasTexture?Lt.imageAtlasTexture:null,ol=ht||!we.isOrthographic||g.options.rotating||g.options.zooming||sc.kind==="composite"||sc.kind==="camera"?Ce.LINEAR:Ce.NEAREST);const Ac=Lt.glyphAtlasTexture?Lt.glyphAtlasTexture.size:[0,0],To=d.layout.get("text-size-scale-range"),Mo=o.aA(g.scaleFactor,To[0],To[1]),Jr=o.bK(sc,we.zoom,Mo),fs=Vs(wn,Lt.tileID.canonical,ht,nt,we,Rt.getProjection(),gn),Os=Wc(wn,Lt.tileID.canonical,ht,nt,we,Rt.getProjection(),gn),Go=g.translatePosMatrix(Os,Lt,k,z,!0),aa=g.translatePosMatrix(wn,Lt,k,z),lu=Vn?Us:fs,Gu=nt&&!ht&&!qr;let kc=$t;!ot&&!we.mercatorFromTransition||nt||(kc=Aa(we));const zd=Yi(sc.kind,Jr,Gu,ht,g,aa,lu,Go,Ie,!0,Ac,sl,0,rn,yn,Ue,ci,Cn?kc:$t,Rt.getProjection(),es,or,null,null,Mo),Bd=Lt.glyphAtlasTexture?Lt.glyphAtlasTexture:null,cu=Ce.LINEAR,Yf=d.paint.get("text-halo-width").constantOr(1)!==0,Wu=g.terrain&&ht&&qr?o.bl(o.bC(),fs):Us;if(qr&&Rt.text){const uu=we.elevation,qu=uu?uu.getAtTileOffsetFunc(rn,we.center.lat,we.worldSize,Rt.getProjection()):null,o_=el(wn,Lt.tileID.canonical,ht,nt,we,Rt.getProjection(),gn);Yl(Rt,wn,g,!0,o_,Os,ht,ne,qu,rn)}return{program:Ol,buffers:Rt.text,uniformValues:zd,atlasTexture:Bd,atlasTextureIcon:Pa,atlasInterpolation:cu,atlasInterpolationIcon:ol,isSDF:!0,hasHalo:Yf,depthMode:Js,tile:Lt,renderWithShadows:Yr,labelPlaneMatrixInv:Wu}},Ji=Rt.icon.segments.get().length,qi=Rt.text.segments.get().length,er=Ji&&!S.onlyText?$r():null,Wr=qi&&!S.onlyIcons?oi():null,Po=d.paint.get("icon-opacity").constantOr(1),Ds=d.paint.get("text-opacity").constantOr(1);if(et&&Rt.canOverlap){ut=!0;const qr=Po&&!S.onlyText?Rt.icon.segments.get():[],ui=Ds&&!S.onlyIcons?Rt.text.segments.get():[];for(const Vn of qr)Et.push({segments:new o.bg([Vn]),sortKey:Vn.sortKey,state:er});for(const Vn of ui)Et.push({segments:new o.bg([Vn]),sortKey:Vn.sortKey,state:Wr})}else S.onlyText||Et.push({segments:Po?Rt.icon.segments:new o.bg([]),sortKey:0,state:er}),S.onlyIcons||Et.push({segments:Ds?Rt.text.segments:new o.bg([]),sortKey:0,state:Wr})}ut&&Et.sort((rn,Lt)=>rn.sortKey-Lt.sortKey);for(const rn of Et){const Lt=rn.state;if(Lt)if(g.terrain?g.terrain.setupElevationDraw(Lt.tile,Lt.program,{useDepthForOcclusion:we.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Lt.labelPlaneMatrixInv}):g.setupDepthForOcclusion(we.depthOcclusionForSymbolsAndCircles,Lt.program),Ae.activeTexture.set(Ce.TEXTURE0),Lt.atlasTexture&&Lt.atlasTexture.bind(Lt.atlasInterpolation,Ce.CLAMP_TO_EDGE,!0),Lt.atlasTextureIcon&&(Ae.activeTexture.set(Ce.TEXTURE1),Lt.atlasTextureIcon&&Lt.atlasTextureIcon.bind(Lt.atlasInterpolationIcon,Ce.CLAMP_TO_EDGE,!0)),Lt.renderWithShadows&&g.shadowRenderer.setupShadows(Lt.tile.tileID.toUnwrapped(),Lt.program,"vector-tile"),g.uploadCommonLightUniforms(g.context,Lt.program),Lt.hasHalo){const Rt=Lt.uniformValues;Rt.u_is_halo=1,bc(Lt.buffers,rn.segments,d,g,Lt.program,Lt.depthMode,v,b,Rt,2),Rt.u_is_halo=0}else{if(Lt.isSDF){const Rt=Lt.uniformValues;Lt.hasHalo&&(Rt.u_is_halo=1,bc(Lt.buffers,rn.segments,d,g,Lt.program,Lt.depthMode,v,b,Rt,1)),Rt.u_is_halo=0}bc(Lt.buffers,rn.segments,d,g,Lt.program,Lt.depthMode,v,b,Lt.uniformValues,1)}}}function bc(g,s,d,m,v,b,S,E,k,O){const z=[g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer,g.iconTransitioningVertexBuffer,g.globeExtVertexBuffer,g.zOffsetVertexBuffer,g.orientationVertexBuffer];v.draw(m,m.context.gl.TRIANGLES,b,S,E,jn.disabled,k,d.id,g.layoutVertexBuffer,g.indexBuffer,s,d.paint,m.transform.zoom,g.programConfigurations.get(d.id),z,O)}function Hs(g,s){const d=1<<g.canonical.z,m=(s.x*d-g.canonical.x-g.wrap*d)*o.al,v=(s.y*d-g.canonical.y)*o.al,b=o.e5(s.z,s.y);return o.d4(m,v,b)}function Gr(g,s,d,m,v){if(!d.layout||d.layout.get("fill-elevation-reference")==="none")return;const b=g.context.gl,S=new sn(g.context.gl.LEQUAL,sn.ReadWrite,g.depthRangeFor3D),E=new sn(g.context.gl.GREATER,sn.ReadWrite,g.depthRangeFor3D),k=function(H){let G=.01;return H.isOrthographic&&(G=o.ak(1e-4,G,o.c$(H.pitch>=mc?1:H.pitch/mc))),2*G}(g.transform),O=g.transform.getFreeCameraOptions().position,z="elevatedStructuresDepthReconstruct",U=g.getOrCreateProgram(z,{defines:["DEPTH_RECONSTRUCTION"]}),F=g.getOrCreateProgram(z);for(const H of m){const G=s.getTile(H),W=G.getBucket(d);if(!W)continue;const ne=W.elevatedStructures;if(!ne)continue;const X=W.elevationBufferData.heightRange,re=Hs(H.toUnwrapped(),O),he=g.translatePosMatrix(H.projMatrix,G,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));let pe,Ie,Se,Ae;if(v==="initialize"){if(!X||X.min>=1||ne.depthSegments.segments[0].primitiveLength===0)continue;pe=ru(he,re,k,1,0),Ie=S,Se=ne.depthSegments,Ae=U}else if(v==="reset"){if(!X||X.min>=0||ne.maskSegments.segments[0].primitiveLength===0)continue;pe=ru(he,re,0,0,1),Ie=E,Se=ne.maskSegments,Ae=U}else if(v==="geometry"){if(ne.depthSegments.segments[0].primitiveLength===0)continue;pe=ru(he,re,k,1,0),Ie=S,Se=ne.depthSegments,Ae=F}Ae.draw(g,b.TRIANGLES,Ie,Dn.disabled,ti.disabled,jn.disabled,pe,d.id,ne.vertexBuffer,ne.indexBuffer,Se,d.paint,g.transform.zoom)}}function Ms(g,s,d){const{painter:m,sourceCache:v,layer:b,coords:S,colorMode:E,elevationType:k,terrainEnabled:O,pass:z}=g,U=m.context.gl,F=b.paint.get("fill-pattern"),H=b.paint.get("fill-pattern-cross-fade"),G=F.constantOr(null);let W=k;k!=="road"||s&&!O||(W="none");const ne=W==="road",X=g.painter.shadowRenderer,re=ne&&!!X&&X.enabled,he=new sn(m.context.gl.LEQUAL,sn.ReadOnly,m.depthRangeFor3D);let pe=[0,0,0];if(re){const Ae=m.style.directionalLight,Ce=m.style.ambientLight;Ae&&Ce&&(pe=Al(m.style,Ae,Ce))}const Ie=F&&F.constantOr(1),Se=(Ae,Ce)=>{let we,ke,nt,Ke,ht;Ce?(we=Ie&&!b.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",nt=U.LINES):(we=Ie?"fillPattern":"fill",nt=U.TRIANGLES);for(const et of S){const ut=v.getTile(et);if(Ie&&!ut.patternsLoaded())continue;const jt=ut.getBucket(b);if(!jt)continue;const tt=s?jt.elevationBufferData:jt.bufferData;if(tt.isEmpty())continue;m.prepareDrawTile();const Ue=tt.programConfigurations.get(b.id),pt=m.isTileAffectedByFog(et),ot=[],Et=[];ne&&(ot.push("ELEVATED_ROADS"),Et.push(tt.elevatedLayoutVertexBuffer)),re&&ot.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Ie&&(m.context.activeTexture.set(U.TEXTURE0),ut.imageAtlasTexture&&ut.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),Ue.updatePaintBuffers());let $t=!1;if(G&&ut.imageAtlas){const yn=ut.imageAtlas,wn=o.e0.from(G),gn=wn.getPrimary().scaleSelf(o.o.devicePixelRatio).toString(),Wn=wn.getSecondary(),ri=yn.patternPositions.get(gn),ci=Wn?yn.patternPositions.get(Wn.scaleSelf(o.o.devicePixelRatio).toString()):null;$t=!!ri&&!!ci,ri&&Ue.setConstantPatternPositions(ri,ci)}H>0&&($t||Ue.getPatternTransitionVertexBuffer("fill-pattern"))&&ot.push("FILL_PATTERN_TRANSITION");const rn=m.getOrCreateProgram(we,{config:Ue,overrideFog:pt,defines:ot}),Lt=m.translatePosMatrix(et.projMatrix,ut,b.paint.get("fill-translate"),b.paint.get("fill-translate-anchor"));re&&X.setupShadows(ut.tileID.toUnwrapped(),rn,"vector-tile");const Rt=b.paint.get("fill-emissive-strength");if(Ce){Ke=tt.lineIndexBuffer,ht=tt.lineSegments;const yn=m.terrain&&m.terrain.renderingToTexture?m.terrain.drapeBufferSize:[U.drawingBufferWidth,U.drawingBufferHeight];ke=we==="fillOutlinePattern"&&Ie?ky(Lt,Rt,m,ut,yn,pe,H):Ff(Lt,Rt,yn,pe)}else Ke=tt.indexBuffer,ht=tt.triangleSegments,ke=Ie?rc(Lt,Rt,m,ut,pe,H):Bf(Lt,Rt,pe);m.uploadCommonUniforms(m.context,rn,et.toUnwrapped());let Cn=Ae;(k==="road"&&!O||k==="offset")&&(Cn=he),rn.draw(m,nt,Cn,d||m.stencilModeForClipping(et),E,jn.disabled,ke,b.id,tt.layoutVertexBuffer,Ke,ht,b.paint,m.transform.zoom,Ue,Et)}};m.renderPass===z&&Se(m.depthModeForSublayer(1,m.renderPass==="opaque"?sn.ReadWrite:sn.ReadOnly),!1),W==="none"&&m.renderPass==="translucent"&&b.paint.get("fill-antialias")&&Se(m.depthModeForSublayer(b.getPaintProperty("fill-outline-color")?2:0,sn.ReadOnly),!0)}function en(g,s,d,m,v,b,S,E){d.resetLayerRenderingStats(g);const k=g.context,O=k.gl,z=g.transform,U=d.paint.get("fill-extrusion-pattern"),F=d.paint.get("fill-extrusion-pattern-cross-fade"),H=U.constantOr(null),G=U.constantOr(1),W=d.paint.get("fill-extrusion-opacity"),ne=g.style.enable3dLights(),X=d.paint.get(ne&&!G?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),re=[d.paint.get("fill-extrusion-ambient-occlusion-intensity"),X],he=d.layout.get("fill-extrusion-edge-radius"),pe=he>0&&!d.paint.get("fill-extrusion-rounded-roof"),Ie=pe?0:he,Se=z.projection.name==="globe"?o.e8():0,Ae=z.projection.name==="globe",Ce=Ae?o.aj(z.zoom):0,we=[o.aF(z.center.lng),o.aJ(z.center.lat)],ke=d.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",nt=d.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(ke?null:d.lut).toArray01().slice(0,3),Ke=d.paint.get("fill-extrusion-flood-light-intensity"),ht=d.paint.get("fill-extrusion-vertical-scale"),et=d.paint.get("fill-extrusion-line-width").constantOr(1)!==0,ut=d.paint.get("fill-extrusion-height-alignment"),jt=d.paint.get("fill-extrusion-base-alignment"),tt=gc(g,d.paint.get("fill-extrusion-cutoff-fade-range")),Ue=[];let pt;Ae&&Ue.push("PROJECTION_GLOBE_VIEW"),re[0]>0&&Ue.push("FAUX_AO"),pe&&Ue.push("ZERO_ROOF_RADIUS"),E&&Ue.push("HAS_CENTROID"),Ke>0&&Ue.push("FLOOD_LIGHT"),tt.shouldRenderCutoff&&Ue.push("RENDER_CUTOFF"),et&&Ue.push("RENDER_WALL_MODE");const ot=g.renderPass==="shadow",Et=g.shadowRenderer,$t=ot&&!!Et,rn=ot?jn.disabled:jn.backCCW;g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!0);let Lt=[0,0,0];if(Et){const yn=g.style.directionalLight,wn=g.style.ambientLight;yn&&wn&&(Lt=Al(g.style,yn,wn)),ot||(Ue.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Et.useNormalOffset&&Ue.push("NORMAL_OFFSET")),pt=Ue.concat(["SHADOWS_SINGLE_CASCADE"])}const Rt=$t?"fillExtrusionDepth":G?"fillExtrusionPattern":"fillExtrusion",Cn=d.getLayerRenderingStats();for(const yn of m){const wn=s.getTile(yn),gn=wn.getBucket(d);if(!gn||gn.projection.name!==z.projection.name)continue;let Wn=!1;Et&&(Wn=Et.getMaxCascadeForTile(yn.toUnwrapped())===0);const ri=g.isTileAffectedByFog(yn),ci=gn.programConfigurations.get(d.id);let or=!1;if(H&&wn.imageAtlas){const qi=wn.imageAtlas,er=o.e0.from(H),Wr=er.getPrimary().scaleSelf(o.o.devicePixelRatio).toString(),Po=er.getSecondary(),Ds=qi.patternPositions.get(Wr),qr=Po?qi.patternPositions.get(Po.scaleSelf(o.o.devicePixelRatio).toString()):null;or=!!Ds&&!!qr,Ds&&ci.setConstantPatternPositions(Ds,qr)}F>0&&(or||ci.getPatternTransitionVertexBuffer("fill-extrusion-pattern"))&&Ue.push("FILL_EXTRUSION_PATTERN_TRANSITION");const Xn=g.getOrCreateProgram(Rt,{config:ci,defines:Wn?pt:Ue,overrideFog:ri});if(g.terrain&&g.terrain.setupElevationDraw(wn,Xn,{useMeterToDem:!0}),!gn.centroidVertexBuffer){const qi=Xn.getAttributeLocation(O,"a_centroid_pos");qi!==-1&&O.vertexAttrib2f(qi,0,0)}!ot&&Et&&Et.setupShadows(wn.tileID.toUnwrapped(),Xn,"vector-tile"),G&&(g.context.activeTexture.set(O.TEXTURE0),wn.imageAtlasTexture&&wn.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),ci.updatePaintBuffers());const ji=d.paint.get("fill-extrusion-vertical-gradient"),rr=1/gn.tileToMeter;let $r;if(ot&&Et){if(jg(wn.tileID,gn.maxHeight,g))continue;const qi=Et.calculateShadowPassMatrixFromTile(wn.tileID.toUnwrapped());$r=cm(qi,Ie,rr,ht,ut,jt)}else{const qi=g.translatePosMatrix(yn.expandedProjMatrix,wn,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),er=z.projection.createInversionMatrix(z,yn.canonical);$r=G?$g(qi,g,ji,W,re,Ie,rr,yn,wn,Se,ut,jt,Ce,we,er,nt,ht,F):vh(qi,g,ji,W,re,Ie,rr,yn,Se,ut,jt,Ce,we,er,nt,ht,Ke,Lt)}g.uploadCommonUniforms(k,Xn,yn.toUnwrapped(),null,tt);let oi=gn.segments;if(z.projection.name==="mercator"&&!ot&&(oi=gn.getVisibleSegments(wn.tileID,g.terrain,g.transform.getFrustum(0)),!oi.get().length))continue;if(Cn)if(ot)for(const qi of oi.get())Cn.numRenderedVerticesInShadowPass+=qi.primitiveLength;else for(const qi of oi.get())Cn.numRenderedVerticesInTransparentPass+=qi.primitiveLength;const Ji=[];(g.terrain||E)&&Ji.push(gn.centroidVertexBuffer),Ae&&Ji.push(gn.layoutVertexExtBuffer),et&&Ji.push(gn.wallVertexBuffer),Xn.draw(g,k.gl.TRIANGLES,v,b,S,rn,$r,d.id,gn.layoutVertexBuffer,gn.indexBuffer,oi,d.paint,g.transform.zoom,ci,Ji)}g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!1)}class oc{constructor(){this.translate=[0,0],this.translateAnchor="map",this.edgeRadius=0,this.cutoffFadeRange=0}}function rl(g,s,d,m,v,b,S,E,k,O,z,U,F,H,G,W,ne,X,re,he){const pe=s.context,Ie=pe.gl,Se=s.transform,Ae=s.transform.zoom,Ce=[],we=g.translate,ke=g.translateAnchor,nt=g.edgeRadius,Ke=gc(s,g.cutoffFadeRange);z==="clear"?(Ce.push("CLEAR_SUBPASS"),he&&(Ce.push("CLEAR_FROM_TEXTURE"),pe.activeTexture.set(Ie.TEXTURE0),he.bind(Ie.LINEAR,Ie.CLAMP_TO_EDGE))):z==="sdf"&&Ce.push("SDF_SUBPASS"),X&&Ce.push("HAS_CENTROID"),Ke.shouldRenderCutoff&&Ce.push("RENDER_CUTOFF");const ht=(et,ut,jt,tt,Ue)=>{const pt=ut.programConfigurations.get(m.id),ot=s.isTileAffectedByFog(et),Et=s.getOrCreateProgram("fillExtrusionGroundEffect",{config:pt,defines:Ce,overrideFog:ot}),$t=((Lt,Rt,Cn,yn,wn,gn,Wn,ri,ci,or,Xn)=>({u_matrix:Rt,u_opacity:Cn,u_ao_pass:yn?1:0,u_meter_to_tile:wn,u_ao:gn,u_flood_light_intensity:Wn,u_flood_light_color:ri,u_attenuation:ci,u_edge_radius:or,u_fb:0,u_fb_size:Xn,u_dynamic_offset:1}))(0,tt,U,O,Ue,[F,H*Ue],G,W,ne,Ae>=17?0:nt*Ue,he?he.size[0]:0),rn=[];X&&rn.push(ut.hiddenByLandmarkVertexBuffer),s.uploadCommonUniforms(pe,Et,et.toUnwrapped(),null,Ke),Et.draw(s,pe.gl.TRIANGLES,b,S,E,k,$t,m.id,ut.vertexBuffer,ut.indexBuffer,jt,m.paint,Ae,pt,rn)};for(const et of v){const ut=d.getTile(et),jt=ut.getBucket(m);if(!jt||jt.projection.name!==Se.projection.name||!jt.groundEffect||jt.groundEffect&&!jt.groundEffect.hasData())continue;const tt=jt.groundEffect,Ue=1/jt.tileToMeter;{const pt=s.translatePosMatrix(et.projMatrix,ut,we,ke),ot=tt.getDefaultSegment();ht(et,tt,ot,pt,Ue)}if(re)for(let pt=0;pt<4;pt++){const ot=o.e6[pt](et),Et=d.getTile(ot);if(!Et)continue;const $t=Et.getBucket(m);if(!$t||$t.projection.name!==Se.projection.name||!$t.groundEffect||$t.groundEffect&&!$t.groundEffect.hasData())continue;const rn=$t.groundEffect;let Lt,Rt;pt===0?(Lt=[-o.al,0,0],Rt=1):pt===1?(Lt=[o.al,0,0],Rt=0):pt===2?(Lt=[0,-o.al,0],Rt=3):(Lt=[0,o.al,0],Rt=2);const Cn=rn.regionSegments[Rt];if(!Cn)continue;const yn=new Float32Array(16);o.br(yn,et.projMatrix,Lt),ht(et,rn,Cn,s.translatePosMatrix(yn,ut,we,ke),Ue)}}}function xc(g,s,d,m,v,b,S){m.centroidVertexArray.length===0&&m.createCentroidsBuffer();const E=b?b.findDEMTileFor(d):null;if(!(E&&E.dem||S))return;b&&E&&E.dem&&m.selfDEMTileTimestamp!==E.dem._timestamp&&(m.borderDoneWithNeighborZ=[-1,-1,-1,-1],m.selfDEMTileTimestamp=E.dem._timestamp);const k=X=>new o.P(Math.ceil((X+o.ea)*o.eb),0),O=X=>{const re=s.getSource().minzoom,he=Ie=>{const Se=s.getTileByID(Ie);if(Se&&Se.hasData())return Se.getBucket(v)},pe=[0,-1,1];for(const Ie of pe){if(X.overscaledZ+Ie<re)continue;const Se=he(X.calculateScaledKey(X.overscaledZ+Ie));if(Se)return Se}},z=[0,0,0],U=(X,re)=>(z[0]=Math.min(X.min.y,re.min.y),z[1]=Math.max(X.max.y,re.max.y),z[2]=o.al-re.min.x>X.max.x?re.min.x-o.al:X.max.x,z),F=(X,re)=>(z[0]=Math.min(X.min.x,re.min.x),z[1]=Math.max(X.max.x,re.max.x),z[2]=o.al-re.min.y>X.max.y?re.min.y-o.al:X.max.y,z),H=[(X,re)=>U(X,re),(X,re)=>U(re,X),(X,re)=>F(X,re),(X,re)=>F(re,X)],G=(X,re,he,pe,Ie,Se,Ae)=>{if(!b)return 0;const Ce=[[Se?he:X,Se?X:he,0],[Se?he:re,Se?re:he,0]],we=Ae<0?o.al+Ae:Ae,ke=[Se?we:(X+re)/2,Se?(X+re)/2:we,0];return he===0&&Ae<0||he!==0&&Ae>0?b.getForTilePoints(Ie,[ke],!0,pe):Ce.push(ke),b.getForTilePoints(d,Ce,!0,E),Math.max(Ce[0][2],Ce[1][2],ke[2])/b.exaggeration()};for(let X=0;X<4;X++){const re=m.borderFeatureIndices[X];if(re.length===0)continue;const he=o.e6[X](d),pe=O(he);if(!(pe&&pe instanceof o.e7))continue;const Ie=b?b.findDEMTileFor(he):null;if(!(Ie&&Ie.dem||S)||(b&&Ie&&Ie.dem&&m.borderDEMTileTimestamp[X]!==Ie.dem._timestamp&&(m.borderDoneWithNeighborZ[X]=-1,m.borderDEMTileTimestamp[X]=Ie.dem._timestamp),m.borderDoneWithNeighborZ[X]===pe.canonical.z))continue;pe.centroidVertexArray.length===0&&pe.createCentroidsBuffer();const Se=(X<2?1:5)-X,Ae=pe.borderDoneWithNeighborZ[Se]!==m.canonical.z,Ce=pe.borderFeatureIndices[Se];let we=0;if(m.canonical.z!==pe.canonical.z){for(const ke of re)m.showCentroid(m.featuresOnBorder[ke]);if(Ae)for(const ke of Ce)pe.showCentroid(pe.featuresOnBorder[ke]);m.borderDoneWithNeighborZ[X]=pe.canonical.z,pe.borderDoneWithNeighborZ[Se]=m.canonical.z}for(const ke of re){const nt=m.featuresOnBorder[ke],Ke=m.centroidData[nt.centroidDataIndex],ht=nt.borders[X];let et;for(;we<Ce.length;){et=pe.featuresOnBorder[Ce[we]];const ut=et.borders[Se];if(ut[1]>ht[0]+3||ut[0]>ht[0]-3)break;pe.showCentroid(et),we++}if(et&&we<Ce.length){const ut=we;let jt=0;for(;!(et.borders[Se][0]>ht[1]-3)&&(jt++,++we!==Ce.length);)et=pe.featuresOnBorder[Ce[we]];et=pe.featuresOnBorder[Ce[ut]];let tt=!1;if(jt>=1){const ot=et.borders[Se];Math.abs(ht[0]-ot[0])<3&&Math.abs(ht[1]-ot[1])<3&&(jt=1,tt=!0,we=ut+1)}else if(jt===0){m.showCentroid(nt);continue}const Ue=pe.centroidData[et.centroidDataIndex];S&&tt&&(((W=Ke).flags|(ne=Ue).flags)&o.e9?(W.flags|=o.e9,ne.flags|=o.e9):(W.flags&=~o.e9,ne.flags&=~o.e9));const pt=nt.intersectsCount()>1||et.intersectsCount()>1;if(jt>1)we=ut,Ke.centroidXY=Ue.centroidXY=new o.P(0,0);else if(Ie&&Ie.dem&&!pt){const ot=H[X](Ke,Ue),Et=X%2?o.al-1:0,$t=G(ot[0],Math.min(o.al-1,ot[1]),Et,Ie,he,X<2,ot[2]);Ke.centroidXY=Ue.centroidXY=k($t)}else pt?Ke.centroidXY=Ue.centroidXY=new o.P(0,0):(Ke.centroidXY=m.encodeBorderCentroid(nt),Ue.centroidXY=pe.encodeBorderCentroid(et));m.writeCentroidToBuffer(Ke),pe.writeCentroidToBuffer(Ue)}else m.showCentroid(nt)}m.borderDoneWithNeighborZ[X]=pe.canonical.z,pe.borderDoneWithNeighborZ[Se]=m.canonical.z}var W,ne;(m.needsCentroidUpdate||!m.centroidVertexBuffer&&m.centroidVertexArray.length!==0)&&m.uploadCentroid(g)}const wc=[1,0,0],Rn=[0,1,0],um=[0,0,1];function jg(g,s,d){const m=d.transform,v=d.shadowRenderer;if(!v)return!0;const b=g.toUnwrapped(),S=m.tileSize*v._cascades[d.currentShadowCascade].scale;let E=s;if(m.elevation){const W=m.elevation.getMinMaxForTile(g);W&&(E+=W.max)}const k=[...v.shadowDirection];k[2]=-k[2];const O=v.computeSimplifiedTileShadowVolume(b,E,S,k);if(!O)return!1;const z=[wc,Rn,um,k,[k[0],0,k[2]],[0,k[1],k[2]]],U=m.projection.name==="globe",F=m.scaleZoom(S),H=o.cA.fromInvProjectionMatrix(m.invProjMatrix,m.worldSize,F,!U),G=v.getCurrentCascadeFrustum();return H.intersectsPrecise(O.vertices,O.planes,z)===0||G.intersectsPrecise(O.vertices,O.planes,z)===0}function Rd(g){const{painter:s,source:d,layer:m,coords:v}=g;let b=g.defines;const S=s.context,E=s.renderPass==="shadow",k=s.renderPass==="light-beam",O=s.shadowRenderer,z=o.ec(s.transform.center.lat,s.transform.zoom),U=gc(s,m.paint.get("building-cutoff-fade-range"));U.shouldRenderCutoff&&(b=b.concat("RENDER_CUTOFF"));for(const F of v){const H=d.getTile(F),G=H.getBucket(m);if(!G)continue;O&&O.getMaxCascadeForTile(F.toUnwrapped())===0&&(b=b.concat("SHADOWS_SINGLE_CASCADE"));const W=G.programConfigurations.get(m.id);let ne,X,re,he=s.translatePosMatrix(F.expandedProjMatrix,H,[0,0],"map");if(he=o.cR(o.bC(),he,[1,1,g.verticalScale]),E&&O){if(jg(H.tileID,G.maxHeight*z,s))continue;let Ie=O.calculateShadowPassMatrixFromTile(H.tileID.toUnwrapped());Ie=o.cR(o.bC(),Ie,[1,1,g.verticalScale]),re=te(Ie),ne=X=s.getOrCreateProgram("buildingDepth",{config:W,defines:b,overrideFog:!1})}else if(k)ne=X=s.getOrCreateProgram("buildingBloom",{config:W,defines:b,overrideFog:!1}),re=V(he);else{const Ie=s.transform.calculatePosMatrix(F.toUnwrapped(),s.transform.worldSize);o.cR(Ie,Ie,[1,1,g.verticalScale]);const Se=o.bC();o.cR(Se,Ie,[1,-1,1/z]),o.bl(Se,Se),o.ed(Se,Se);const Ae=s.transform.getFreeCameraOptions().position,Ce=1<<F.canonical.z;re=_e(he,Se,g.opacity,g.facadeAOIntensity,[((Ae.x-F.wrap)*Ce-F.canonical.x)*o.al,(Ae.y*Ce-F.canonical.y)*o.al,Ae.z*Ce*o.al],G.tileToMeter,g.facadeEmissiveChance),X=s.getOrCreateProgram("building",{config:W,defines:b,overrideFog:!1});const we=b.concat(["BUILDING_FAUX_FACADE","HAS_ATTRIBUTE_a_faux_facade_color_emissive"]);ne=s.getOrCreateProgram("building",{config:W,defines:we,overrideFog:!1}),O&&(O.setupShadowsFromMatrix(Ie,X,!0),O.setupShadowsFromMatrix(Ie,ne,!0))}const pe=(Ie,Se)=>{if(k){const Ae=Ie.entranceBloom;Se.draw(s,S.gl.TRIANGLES,g.depthMode,Dn.disabled,g.blendMode,jn.disabled,re,m.id,Ae.layoutVertexBuffer,Ae.indexBuffer,Ae.segmentsBucket,m.paint,s.transform.zoom,W,[Ae.layoutAttenuationBuffer,Ae.layoutColorBuffer])}else{const Ae=Ie.segmentsBucket;let Ce=[Ie.layoutNormalBuffer,Ie.layoutCentroidBuffer,Ie.layoutColorBuffer];Ie.layoutFacadePaintBuffer&&(Ce=Ce.concat([Ie.layoutFacadeDataBuffer,Ie.layoutFacadeVerticalRangeBuffer,Ie.layoutFacadePaintBuffer])),Se.draw(s,S.gl.TRIANGLES,g.depthMode,Dn.disabled,g.blendMode,E?jn.disabled:jn.backCW,re,m.id,Ie.layoutVertexBuffer,Ie.indexBuffer,Ae,m.paint,s.transform.zoom,W,Ce)}};s.uploadCommonUniforms(S,X,F.toUnwrapped(),null,U),G.buildingWithoutFacade&&pe(G.buildingWithoutFacade,X),ne!==X&&s.uploadCommonUniforms(S,ne,F.toUnwrapped(),null,U),G.buildingWithFacade&&pe(G.buildingWithFacade,ne)}}function Nf(g){return[g[0]*o.ee,g[1]*o.ee,g[2]*o.ee,0]}function bh(g,s,d,m,v,b,S,E,k){const O=m.getSource(),z=d.globeSharedBuffers;if(!z)return;let U,F,H;if(s&&(U=m.getTile(s)),O instanceof o.aS?(F=O.texture,H=o.dG(0,0,d.transform)):U&&s&&(F=U.texture,H=o.dG(s.canonical.z,s.canonical.x,d.transform)),!F||!H)return;g||(H=o.cR(o.bC(),H,[1,-1,1]));const G=d.context,W=G.gl,ne=v.paint.get("raster-resampling")==="nearest"?W.NEAREST:W.LINEAR,X=d.colorModeForDrapableLayerRenderPass(b),re=S.defines;re.push("GLOBE_POLES");const he=new sn(W.LEQUAL,sn.ReadWrite,d.depthRangeFor3D),pe=Float32Array.from(d.transform.expandedFarZProjMatrix),Ie=Float32Array.from(o.bk(o.dF(new o.cC(0,0,0))));d.terrain&&d.terrain.prepareDrawTile(),G.activeTexture.set(W.TEXTURE0),F.bind(ne,W.CLAMP_TO_EDGE),G.activeTexture.set(W.TEXTURE1),F.bind(ne,W.CLAMP_TO_EDGE),"useMipmap"in F&&G.extTextureFilterAnisotropic&&d.transform.pitch>20&&W.texParameterf(W.TEXTURE_2D,G.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,G.extTextureFilterAnisotropicMax);const[Se,Ae,Ce,we]=s?z.getPoleBuffers(s.canonical.z,!1):z.getPoleBuffers(0,!0),ke=v.paint.get("raster-elevation");let nt;g?(nt=Se,d.renderDefaultNorthPole=ke!==0):(nt=Ae,d.renderDefaultSouthPole=ke!==0);const Ke=Nf(S.mix),ht=((ut,jt,tt,Ue,pt,ot,Et,$t,rn,Lt,Rt,Cn,yn)=>ni(ut,jt,tt,new Float32Array(16),new Float32Array(9),[0,0],Ue,[0,0],[0,0,0,0],1,{opacity:1,mix:0},ot,[0,0],$t,2,Lt,Rt,Cn,1,0,yn))(pe,Ie,H,o.aj(d.transform.zoom),0,v,0,ke,0,Ke,S.offset,S.range,b),et=d.getOrCreateProgram("raster",{defines:re});d.uploadCommonUniforms(G,et,null),et.draw(d,W.TRIANGLES,he,k,X,E,ht,v.id,nt,Ce,we)}function Py(g){const s=g._nearZ,d=g.projection.farthestPixelDistance(g),m=d-s,v=.2*g.height,b=s+v;return[s,d,(b-v-s)/m,(b-s)/m]}function dm(g,s,d,m){if(g)return s instanceof fa&&g instanceof Es?s.getTextureDescriptor(g,d,!0):{texture:g.texture,mix:Nf(m.mix),offset:m.offset,buffer:0,tileSize:1}}var Ug=o.ef([{name:"a_index",type:"Int16",components:1}]);class My{constructor(s,d,m,v){const b={width:m[0],height:m[1],data:null},S=s.gl;this.targetColorTexture=new o.T(s,b,S.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new o.T(s,b,S.RGBA8,{useMipmap:!1}),this.context=s,this.updateParticleTexture(d,v),this.lastInvalidatedAt=0}updateParticleTexture(s,d){if(this.particleTextureDimension===d.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const m=this.context.gl,v=d.width*d.height;this.particleTexture0=new o.T(this.context,d,m.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new o.T(this.context,d,m.RGBA8,{premultiply:!1,useMipmap:!1});const b=new o.eg;b.reserve(v);for(let S=0;S<v;S++)b.emplaceBack(S);this.particleIndexBuffer=this.context.createVertexBuffer(b,Ug.members,!0),this.particleSegment=o.bg.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=d.width}update(s){return!(this.lastInvalidatedAt<s&&(this.lastInvalidatedAt=o.o.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function Ra(g,s,d){if(!g)return null;const m=s.getTextureDescriptor(g,d,!0);if(!m)return null;let{texture:v,mix:b,offset:S,tileSize:E,buffer:k,format:O}=m;if(!v||!O)return null;let z=!1;return O==="uint32"&&(z=!0,b[3]=0,b=_n(o.eh,b,[0,d.paint.get("raster-particle-max-speed")]),S=Bn(o.eh,S,[0,d.paint.get("raster-particle-max-speed")])),{texture:v,textureOffset:[k/(E+2*k),E/(E+2*k)],tileSize:E,scalarData:z,scale:b,offset:S,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[O]]}}function Sc(g){const s=g._nearZ,d=g.projection.farthestPixelDistance(g),m=d-s,v=.2*g.height,b=s+v;return[s,d,(b-v-s)/m,(b-s)/m]}const Gs=new o.ao(1,0,0,1),Cc=new o.ao(0,1,0,1),hm=new o.ao(0,0,1,1),xh=new o.ao(1,0,1,1),Vf=new o.ao(0,1,1,1);function wh(g,s,d,m,v,b){for(let S=0;S<d.length;S++)if(v){const O=new o.ao(m.r*.8,m.g*.8,m.b*.8,1);ou(g,s,d[S],m,-1,-1,b),ou(g,s,d[S],m,-1,1,b),ou(g,s,d[S],m,1,1,b),ou(g,s,d[S],m,1,-1,b),ou(g,s,d[S],O,0,0,b)}else ou(g,s,d[S],m,0,0,b)}function ou(g,s,d,m,v,b,S){const E=g.context,k=g.transform,O=E.gl,z=k.projection.name==="globe",U=z?["PROJECTION_GLOBE_VIEW"]:[];let F=o.bz(d.projMatrix);if(z&&o.aj(k.zoom)>0){const Ke=o.bj(d.canonical,k),ht=o.ei(Ke);F=o.aB(new Float32Array(16),k.globeMatrix,ht),o.aB(F,k.projMatrix,F)}const H=o.bC();H[12]+=2*v/(o.o.devicePixelRatio*k.width),H[13]+=2*b/(o.o.devicePixelRatio*k.height),o.aB(F,H,F);const G=g.getOrCreateProgram("debug",{defines:U}),W=s.getTileByID(d.key);g.terrain&&g.terrain.setupElevationDraw(W,G);const ne=sn.disabled,X=Dn.disabled,re=g.colorModeForRenderPass(),he="$debug";E.activeTexture.set(O.TEXTURE0),g.emptyTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),z?W._makeGlobeTileDebugBuffers(g.context,k):W._makeDebugTileBoundsBuffers(g.context,k.projection);const pe=W._tileDebugBuffer||g.debugBuffer,Ie=W._tileDebugIndexBuffer||g.debugIndexBuffer,Se=W._tileDebugSegments||g.debugSegments;if(G.draw(g,O.LINE_STRIP,ne,X,re,jn.disabled,yt(F,m.toPremultipliedRenderColor(null)),he,pe,Ie,Se,null,null,null,[W._globeTileDebugBorderBuffer]),S){const Ke=W.latestRawTileData,ht=Math.floor((Ke&&Ke.byteLength||0)/1024);let et=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(et+=` => ${d.overscaledZ}`),et+=` ${W.state}`,et+=` ${ht}kb`,function(ut,jt){ut.initDebugOverlayCanvas();const tt=ut.debugOverlayCanvas,Ue=ut.context.gl,pt=ut.debugOverlayCanvas.getContext("2d");pt.clearRect(0,0,tt.width,tt.height),pt.shadowColor="white",pt.shadowBlur=2,pt.lineWidth=1.5,pt.strokeStyle="white",pt.textBaseline="top",pt.font="bold 36px Open Sans, sans-serif",pt.fillText(jt,5,5),pt.strokeText(jt,5,5),ut.debugOverlayTexture.update(tt),ut.debugOverlayTexture.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE)}(g,et)}const Ae=s.getTile(d).tileSize,Ce=512/Math.min(Ae,512)*(d.overscaledZ/k.zoom)*.5,we=W._tileDebugTextBuffer||g.debugBuffer,ke=W._tileDebugTextIndexBuffer||g.quadTriangleIndexBuffer,nt=W._tileDebugTextSegments||g.debugSegments;G.draw(g,O.TRIANGLES,ne,X,ti.alphaBlended,jn.disabled,yt(F,o.ao.transparent.toPremultipliedRenderColor(null),Ce),he,we,ke,nt,null,null,null,[W._globeTileDebugTextBuffer])}function Pl(g,s,d,m){$u(g,0,s+d/2,g.transform.width,d,m)}function Tr(g,s,d,m){$u(g,s-d/2,0,d,g.transform.height,m)}function $u(g,s,d,m,v,b){const S=g.context,E=S.gl;E.enable(E.SCISSOR_TEST),E.scissor(s*o.o.devicePixelRatio,d*o.o.devicePixelRatio,m*o.o.devicePixelRatio,v*o.o.devicePixelRatio),S.clear({color:b}),E.disable(E.SCISSOR_TEST)}const Sh=o.ef([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:fm}=Sh;function ju(g,s,d,m){g.emplaceBack(s,d,m)}class Dy{constructor(s){this.vertexArray=new o.ej,this.indices=new o.b1,ju(this.vertexArray,-1,-1,1),ju(this.vertexArray,1,-1,1),ju(this.vertexArray,-1,1,1),ju(this.vertexArray,1,1,1),ju(this.vertexArray,-1,-1,-1),ju(this.vertexArray,1,-1,-1),ju(this.vertexArray,-1,1,-1),ju(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=s.createVertexBuffer(this.vertexArray,fm),this.indexBuffer=s.createIndexBuffer(this.indices),this.segment=o.bg.simpleSegment(0,0,36,12)}}function Ch(g,s,d,m,v,b){const S=g.context.gl,E=s.paint.get("sky-atmosphere-color"),k=s.paint.get("sky-atmosphere-halo-color"),O=s.paint.get("sky-atmosphere-sun-intensity"),z=((U,F,H,G,W)=>({u_matrix_3f:U,u_sun_direction:F,u_sun_intensity:H,u_color_tint_r:[G.r,G.g,G.b,G.a],u_color_tint_m:[W.r,W.g,W.b,W.a],u_luminance:5e-5}))(o.el(o.dL(),m),v,O,E.toPremultipliedRenderColor(null),k.toPremultipliedRenderColor(null));S.framebufferTexture2D(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,S.TEXTURE_CUBE_MAP_POSITIVE_X+b,s.skyboxTexture,0),d.draw(g,S.TRIANGLES,sn.disabled,Dn.disabled,ti.unblended,jn.frontCW,z,"skyboxCapture",s.skyboxGeometry.vertexBuffer,s.skyboxGeometry.indexBuffer,s.skyboxGeometry.segment)}const Th=o.ef([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Eh{constructor(s){const d=new o.em;d.emplaceBack(-1,1,1,0,0),d.emplaceBack(1,1,1,1,0),d.emplaceBack(1,-1,1,1,1),d.emplaceBack(-1,-1,1,0,1);const m=new o.b1;m.emplaceBack(0,1,2),m.emplaceBack(2,3,0),this.vertexBuffer=s.createVertexBuffer(d,Th.members),this.indexBuffer=s.createIndexBuffer(m),this.segments=o.bg.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Vt=o.ef([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class nn{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class $f{constructor(s){this.colorModeAlphaBlendedWriteRGB=new ti([1,ga,1,ga],o.ao.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new ti([1,0,1,0],o.ao.transparent,[!1,!1,!1,!0]),this.params=new nn,this.updateNeeded=!0,s.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),s.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),s.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),s.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(s){const d=s.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Eh(d);const m=this.params.sizeRange,v=this.params.intensityRange,b=function(z){const U=o.eo(30),F=[];for(let H=0;H<z;++H){const G=2*Math.PI*U(),W=Math.acos(1-2*U())-.5*Math.PI;F.push(o.d4(Math.cos(W)*Math.cos(G),Math.cos(W)*Math.sin(G),Math.sin(W)))}return F}(this.params.starsCount),S=o.eo(300),E=new o.en,k=new o.b1;let O=0;for(let z=0;z<b.length;++z){const U=o.c4([],b[z],200),F=Math.max(0,1+.01*m*(1*S()-.5)),H=Math.max(0,1+.01*v*(1*S()-.5));E.emplaceBack(U[0],U[1],U[2],-1,-1,F,H),E.emplaceBack(U[0],U[1],U[2],1,-1,F,H),E.emplaceBack(U[0],U[1],U[2],1,1,F,H),E.emplaceBack(U[0],U[1],U[2],-1,1,F,H),k.emplaceBack(O+0,O+1,O+2),k.emplaceBack(O+0,O+2,O+3),O+=4}this.starsVx=d.createVertexBuffer(E,Vt.members),this.starsIdx=d.createIndexBuffer(k),this.starsSegments=o.bg.simpleSegment(0,0,E.length,k.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(s,d){const m=s.context,v=m.gl,b=s.transform,S=new sn(v.LEQUAL,sn.ReadOnly,[0,1]),E=o.aj(b.zoom),k=s.style.getLut(d.scope),O=d.properties.get("color-use-theme")==="none",z=d.properties.get("color").toNonPremultipliedRenderColor(O?null:k),U=d.properties.get("high-color-use-theme")==="none",F=d.properties.get("high-color").toNonPremultipliedRenderColor(U?null:k),H=d.properties.get("space-color-use-theme")==="none",G=d.properties.get("space-color").toNonPremultipliedRenderColor(H?null:k),W=5e-4,ne=o.ep(d.properties.get("horizon-blend"),0,1,W,.25),X=o.dA(s,m,b)&&ne===W?b.worldSize/(2*Math.PI*1.025)-1:b.globeRadius,re=s.frameCounter/1e3%1,he=o.ag(b.globeCenterInViewSpace),pe=Math.sqrt(Math.pow(he,2)-Math.pow(X,2)),Ie=Math.acos(pe/he),Se=Ae=>{const Ce=b.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Ae&&Ce.push("ALPHA_PASS");const we=s.getOrCreateProgram("globeAtmosphere",{defines:Ce}),ke=((Ke,ht,et,ut,jt,tt,Ue,pt,ot,Et,$t,rn)=>({u_frustum_tl:Ke,u_frustum_tr:ht,u_frustum_br:et,u_frustum_bl:ut,u_horizon:jt,u_transition:tt,u_fadeout_range:Ue,u_atmosphere_fog_color:pt.toArray01(),u_high_color:ot.toArray01(),u_space_color:Et.toArray01(),u_temporal_offset:$t,u_horizon_angle:rn}))(b.frustumCorners.TL,b.frustumCorners.TR,b.frustumCorners.BR,b.frustumCorners.BL,b.frustumCorners.horizon,E,ne,z,F,G,re,Ie);s.uploadCommonUniforms(m,we);const nt=this.atmosphereBuffer;nt&&we.draw(s,v.TRIANGLES,S,Dn.disabled,Ae?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,jn.backCW,ke,Ae?"atmosphere_glow_alpha":"atmosphere_glow",nt.vertexBuffer,nt.indexBuffer,nt.segments)};Se(!1),Se(!0)}drawStars(s,d){const m=o.aA(d.properties.get("star-intensity"),0,1);if(m===0)return;const v=s.context,b=v.gl,S=s.transform,E=s.getOrCreateProgram("stars"),k=o.c6([]);o.c8(k,k,-S._pitch),o.c7(k,k,-S.angle),o.c8(k,k,o.an(S._center.lat)),o.eq(k,k,-o.an(S._center.lng));const O=o.cb(new Float32Array(16),k),z=o.aB([],S.starsProjMatrix,O),U=o.el([],O),F=o.er([],U),H=[0,1,0];o.dN(H,H,F),o.c4(H,H,this.params.sizeMultiplier);const G=[1,0,0];o.dN(G,G,F),o.c4(G,G,this.params.sizeMultiplier);const W=(ne=H,X=G,re=m,{u_matrix:Float32Array.from(z),u_up:ne,u_right:X,u_intensity_multiplier:re});var ne,X,re;s.uploadCommonUniforms(v,E),this.starsVx&&this.starsIdx&&E.draw(s,b.TRIANGLES,sn.disabled,Dn.disabled,this.colorModeAlphaBlendedWriteRGB,jn.disabled,W,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}class _o{constructor(){this.visibleTiles=[]}updateBorders(s,d){const m=[],v=[],b=s._getRenderableCoordinates(!1,!0);for(const k of b){const O=s.getTile(k);if(!O.hasData())continue;const z=O.getBucket(d);z&&(z.isEmpty()||(m.push(k.key),v.push({bucket:z,tileID:k.canonical})))}let S=m.length!==this.visibleTiles.length;if(!S){m.sort();for(let k=0;k<m.length;k++)if(m[k]!==this.visibleTiles[k]){S=!0;break}}if(!S)return;const E=new Set;this.visibleTiles=m,v.sort((k,O)=>k.tileID.z-O.tileID.z||k.tileID.x-O.tileID.x||k.tileID.y-O.tileID.y);for(const k of v){const O=new Array,z=new Array,U=k.bucket;for(const F of U.featuresOnBorder)E.has(F.featureId)?z.push(F.footprintIndex):(E.add(F.featureId),O.push(F.footprintIndex));U.updateFootprintHiddenFlags(O,o.es,!1),U.updateFootprintHiddenFlags(z,o.es,!0)}}}function Ye(g,s){const d=[...g],m=s.cameraWorldSizeForFog/s.worldSize,v=o.bA([]);return o.cR(v,v,[m,m,1]),o.aB(d,v,d),o.aB(d,s.worldToFogMatrix,d),d}function Hg(g,s,d,m,v){const b=d.material,S=m.context,{baseColorTexture:E,metallicRoughnessTexture:k}=b.pbrMetallicRoughness,{normalTexture:O,occlusionTexture:z,emissionTexture:U}=b;function F(G,W,ne){if(G&&(g.push(W),S.activeTexture.set(S.gl.TEXTURE0+ne),G.gfxTexture)){const{minFilter:X,magFilter:re,wrapS:he,wrapT:pe}=G.sampler;G.gfxTexture.bindExtraParam(X,re,he,pe)}}F(E,"HAS_TEXTURE_u_baseColorTexture",Ro.BaseColor),F(k,"HAS_TEXTURE_u_metallicRoughnessTexture",Ro.MetallicRoughness),F(O,"HAS_TEXTURE_u_normalTexture",Ro.Normal),F(z,"HAS_TEXTURE_u_occlusionTexture",Ro.Occlusion),F(U,"HAS_TEXTURE_u_emissionTexture",Ro.Emission),v&&(v.texture||(v.texture=new o.dY(m.context,v.image,[v.image.height,v.image.height,v.image.height],S.gl.RGBA8)),S.activeTexture.set(S.gl.TEXTURE0+Ro.LUT),v.texture&&v.texture.bind(S.gl.LINEAR,S.gl.CLAMP_TO_EDGE),g.push("APPLY_LUT_ON_GPU")),d.texcoordBuffer&&(g.push("HAS_ATTRIBUTE_a_uv_2f"),s.push(d.texcoordBuffer)),d.colorBuffer&&(g.push(d.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),s.push(d.colorBuffer)),d.normalBuffer&&(g.push("HAS_ATTRIBUTE_a_normal_3f"),s.push(d.normalBuffer)),d.pbrBuffer&&(g.push("HAS_ATTRIBUTE_a_pbr"),g.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),s.push(d.pbrBuffer)),b.alphaMode!=="OPAQUE"&&b.alphaMode!=="MASK"||g.push("UNPREMULT_TEXTURE_IN_SHADER"),b.defined||g.push("DIFFUSE_SHADED");const H=m.shadowRenderer;H&&(g.push("RENDER_SHADOWS","DEPTH_TEXTURE"),H.useNormalOffset&&g.push("NORMAL_OFFSET"))}function Ih(g,s,d,m,v,b){const S=d.paint.get("model-opacity").constantOr(1),E=s.context,k=new sn(s.context.gl.LEQUAL,sn.ReadWrite,s.depthRangeFor3D),O=s.transform,z=g.mesh,U=z.material,F=U.pbrMetallicRoughness,H=s.style.fog;let G;G=s.transform.projection.zAxisUnit==="pixels"?[...g.nodeModelMatrix]:o.aB([],m.zScaleMatrix,g.nodeModelMatrix),o.aB(G,m.negCameraPosMatrix,G);const W=o.bl([],G);o.ed(W,W);const ne=d.paint.get("model-color-use-theme").constantOr("default")==="none",X=d.paint.get("model-emissive-strength").constantOr(0),re=Nr(new Float32Array(g.worldViewProjection),new Float32Array(G),new Float32Array(W),null,s,S,F.baseColorFactor,U.emissiveFactor,F.metallicFactor,F.roughnessFactor,U,X,d),he={defines:[]},pe=[],Ie=s.shadowRenderer;Ie&&(Ie.useNormalOffset=!1),Hg(he.defines,pe,z,s,ne?null:d.lut);let Se=null;if(H){const we=Ye(g.nodeModelMatrix,s.transform);if(Se=new Float32Array(we),O.projection.name!=="globe"){const ke=z.aabb.min,nt=z.aabb.max,[Ke,ht]=H.getOpacityForBounds(we,ke[0],ke[1],nt[0],nt[1]);he.overrideFog=Ke>=xn||ht>=xn}}const Ae=gc(s,d.paint.get("model-cutoff-fade-range"));Ae.shouldRenderCutoff&&he.defines.push("RENDER_CUTOFF");const Ce=s.getOrCreateProgram("model",he);s.uploadCommonUniforms(E,Ce,null,Se,Ae),s.renderPass!=="shadow"&&Ie&&Ie.setupShadowsFromMatrix(g.nodeModelMatrix,Ce),Ce.draw(s,E.gl.TRIANGLES,k,v,b,z.material.doubleSided?jn.disabled:jn.backCCW,re,d.id,z.vertexBuffer,z.indexBuffer,z.segments,d.paint,s.transform.zoom,void 0,pe)}function Gg(g,s,d,m,v,b,S){let E;E=g.projection.name==="globe"?o.eu(d,g):[...d],o.aB(E,E,s.matrix);const k=o.aB([],m,E);if(s.meshes)for(const O of s.meshes){if(O.material.alphaMode!=="BLEND"){S.push({mesh:O,depth:0,modelIndex:v,worldViewProjection:k,nodeModelMatrix:E});continue}const z=o.af([],O.centroid,k);!g.isOrthographic&&z[2]<=0||b.push({mesh:O,depth:z[2],modelIndex:v,worldViewProjection:k,nodeModelMatrix:E})}if(s.children)for(const O of s.children)Gg(g,O,d,m,v,b,S)}function pm(g,s,d,m){const v=d.shadowRenderer;if(!v)return;const b=v.getShadowPassDepthMode(),S=v.getShadowPassColorMode(),E=v.calculateShadowPassMatrixFromMatrix(s),k=Qi(E);d.getOrCreateProgram("modelDepth",{defines:d._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(d,d.context.gl.TRIANGLES,b,Dn.disabled,S,jn.backCCW,k,m.id,g.vertexBuffer,g.indexBuffer,g.segments,m.paint,d.transform.zoom,void 0,void 0)}function j0(g,s,d){const m=s.updateZoomBasedPaintProperties(),v=function(b,S,E){let k,O,z,U=b.terrain?b.terrain.exaggeration():0;if(b.terrain&&U>0){const F=b.terrain,H=F.findDEMTileFor(E);H&&H.dem?k=o.ew.create(F,E,H):U=0}if(U===0&&(S.terrainElevationMin=0,S.terrainElevationMax=0),U===S.validForExaggeration&&(U===0||k&&k._demTile&&k._demTile.tileID===S.validForDEMTile.id&&k._dem._timestamp===S.validForDEMTile.timestamp))return!1;for(const F in S.instancesPerModel){const H=S.instancesPerModel[F];for(let G=0;G<H.instancedDataArray.length;++G){const W=(k?U*k.getElevationAt(0|H.instancedDataArray.float32[16*G],0|H.instancedDataArray.float32[16*G+1],!0,!0):0)+H.instancesEvaluatedElevation[G];H.instancedDataArray.float32[16*G+6]=W,O=O?Math.min(S.terrainElevationMin,W):W,z=z?Math.max(S.terrainElevationMax,W):W}}return S.terrainElevationMin=O||0,S.terrainElevationMax=z||0,S.validForExaggeration=U,S.validForDEMTile=k&&k._demTile?{id:k._demTile.tileID,timestamp:k._dem._timestamp}:{id:void 0,timestamp:0},!0}(g,s,d);(m||v)&&(s.uploaded=!1,s.upload(g.context))}const Tc={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new o.d8([0,0,0],[o.al,o.al,0])};function jf(g,s){const d=1<<g.canonical.z,m=s.getFreeCameraOptions().position,v=s.elevation,b=g.canonical.x/d,S=(g.canonical.x+1)/d,E=g.canonical.y/d,k=(g.canonical.y+1)/d;let O=s._centerAltitude;if(v){const H=v.getMinMaxForTile(g);H&&H.max>O&&(O=H.max)}const z=o.aA(m.x,b,S)-m.x,U=o.aA(m.y,E,k)-m.y,F=o.ce(O,s.center.lat)-m.z;return s._zoomFromMercatorZ(Math.sqrt(z*z+U*U+F*F))}function U0(g,s,d,m,v,b,S){const E=g.context,k=g.renderPass==="shadow",O=g.shadowRenderer,z=k&&O?O.getShadowPassDepthMode():new sn(E.gl.LEQUAL,sn.ReadWrite,g.depthRangeFor3D),U=g.isTileAffectedByFog(b);if(d.meshes)for(const F of d.meshes){const H=["MODEL_POSITION_ON_GPU"],G=[];let W,ne,X;m.instancedDataArray.length>20&&H.push("INSTANCED_ARRAYS");const re=gc(g,s.paint.get("model-cutoff-fade-range"));if(re.shouldRenderCutoff&&H.push("RENDER_CUTOFF"),k&&O)W=g.getOrCreateProgram("modelDepth",{defines:H}),ne=Qi(S.shadowTileMatrix,S.shadowTileMatrix,Float32Array.from(d.matrix)),X=O.getShadowPassColorMode();else{Hg(H,G,F,g,s.paint.get("model-color-use-theme").constantOr("default")==="none"?null:s.lut),W=g.getOrCreateProgram("model",{defines:H,overrideFog:U});const pe=F.material,Ie=pe.pbrMetallicRoughness,Se=s.paint.get("model-opacity").constantOr(1),Ae=s.paint.get("model-emissive-strength").constantOr(0);ne=Nr(b.expandedProjMatrix,Float32Array.from(d.matrix),new Float32Array(16),null,g,Se,Ie.baseColorFactor,pe.emissiveFactor,Ie.metallicFactor,Ie.roughnessFactor,pe,Ae,s,v),O&&(S.shadowUniformsInitialized?W.setShadowUniformValues(E,O.getShadowUniformValues()):(O.setupShadows(b.toUnwrapped(),W,"model-tile"),S.shadowUniformsInitialized=!0)),X=re.shouldRenderCutoff||Se<1||pe.alphaMode!=="OPAQUE"?ti.alphaBlended:ti.unblended}g.uploadCommonUniforms(E,W,b.toUnwrapped(),null,re);const he=F.material.doubleSided?jn.disabled:jn.backCCW;if(m.instancedDataArray.length>20)G.push(m.instancedDataBuffer),W.draw(g,E.gl.TRIANGLES,z,Dn.disabled,X,he,ne,s.id,F.vertexBuffer,F.indexBuffer,F.segments,s.paint,g.transform.zoom,void 0,G,m.instancedDataArray.length);else{const pe=k?"u_instance":"u_normal_matrix";for(let Ie=0;Ie<m.instancedDataArray.length;++Ie)ne[pe]=new Float32Array(m.instancedDataArray.arrayBuffer,64*Ie,16),W.draw(g,E.gl.TRIANGLES,z,Dn.disabled,X,he,ne,s.id,F.vertexBuffer,F.indexBuffer,F.segments,s.paint,g.transform.zoom,void 0,G)}}if(d.children)for(const F of d.children)U0(g,s,F,m,v,b,S)}const YS=[1,-1,1];function H0(g,s,d,m){if(!d.modelManager)return!0;const v=d.modelManager;if(!d.shadowRenderer)return!0;const b=d.shadowRenderer,S=s.aabb;let E=!0,k=g.maxHeight;if(k===0){let z=0;for(const U in g.instancesPerModel){const F=v.getModel(U,m);F?z=Math.max(z,Math.max(Math.max(F.aabb.max[0],F.aabb.max[1]),F.aabb.max[2])):E=!1}k=g.maxScale*z*1.41+g.maxVerticalOffset,E&&(g.maxHeight=k)}S.max[2]=k,S.min[2]+=g.terrainElevationMin,S.max[2]+=g.terrainElevationMax,o.af(S.min,S.min,s.tileMatrix),o.af(S.max,S.max,s.tileMatrix);const O=S.intersects(b.getCurrentCascadeFrustum());return d.currentShadowCascade===0&&(g.isInsideFirstShadowMapFrustum=O===2),O===0}function Wg(g,s){const d=g.uniformValues.u_cutoff_params[0],m=g.uniformValues.u_cutoff_params[1],v=g.uniformValues.u_cutoff_params[2],b=g.uniformValues.u_cutoff_params[3];return m===d||b===v?1:o.aA(((s-d)/(m-d)-v)/(b-v),0,1)}function Oy(g,s,d,m){if(s.pitch<20)return 1;const v=s.getWorldToCameraMatrix();o.aB(v,v,g);const b=o.bU(d.min[0],d.min[1],d.min[2],1);let S=o.aC(o.ex(),b,v),E=S,k=S;b[1]=d.max[1],S=o.aC(o.ex(),b,v),E=S[1]<E[1]?S:E,k=S[1]>k[1]?S:k,b[0]=d.max[0],S=o.aC(o.ex(),b,v),E=S[1]<E[1]?S:E,k=S[1]>k[1]?S:k,b[1]=d.min[1],S=o.aC(o.ex(),b,v),E=S[1]<E[1]?S:E,k=S[1]>k[1]?S:k;const O=o.aA(m[0],0,1),z=100*s.pixelsPerMeter*o.aA(m[1],0,1),U=o.aA(m[2],0,1),F=o.ey(o.ex(),E,k,O),H=Math.tan(.5*s.fovX),G=-F[2]*H;if(z===0)return F[1]<-Math.abs(G)?U:1;const W=(-Math.abs(G)-F[1])/z,ne=(re,he,pe)=>(1-pe)*re+pe*he,X=o.aA(ne(1,U,W),U,1);return ne(1,X,o.aA((s.pitch-20)/20,0,1))}class G0{}class W0{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(s,d,m){{const U=this._storage.get(d.id);if(U)return U.lastUsedFrameIdx=s,U.buf}const v=m.gl,b=v.getBufferParameter(v.ELEMENT_ARRAY_BUFFER,v.BUFFER_SIZE),S=new ArrayBuffer(b),E=new Int16Array(S);v.getBufferSubData(v.ELEMENT_ARRAY_BUFFER,0,new Int16Array(S));const k=new o.eA;for(let U=0;U<b/2;U+=3){const F=E[U],H=E[U+1],G=E[U+2];k.emplaceBack(F,H),k.emplaceBack(H,G),k.emplaceBack(G,F)}const O=m.bindVertexArrayOES.current,z=new G0;return z.buf=new Ar(m,k),z.lastUsedFrameIdx=s,this._storage.set(d.id,z),m.bindVertexArrayOES.set(O),z.buf}update(s){for(const[d,m]of this._storage)s-m.lastUsedFrameIdx>30&&(m.buf.destroy(),this._storage.delete(d))}destroy(){for(const[s,d]of this._storage)d.buf.destroy(),this._storage.delete(s)}}class qg{constructor(s){this.occluderSize=30,this.depthOffset=-1e-4,s.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),s.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const mm=o.ef([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class Uf{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class Ly{constructor(s,d){this.revealStart=11,this.revealRange=2,s.registerParameter(this,[...d,"Reveal"],"revealStart",{min:0,max:17,step:.05}),s.registerParameter(this,[...d,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const q0=o.ef([{type:"Float32",name:"a_pos_2f",components:2}]);class JS{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(s,d){const m=s.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const S=new o.eB,E=new o.b1;S.emplaceBack(-1,-1),S.emplaceBack(1,-1),S.emplaceBack(1,1),S.emplaceBack(-1,1),E.emplaceBack(0,1,2),E.emplaceBack(0,2,3),this.vignetteVx=s.context.createVertexBuffer(S,q0.members),this.vignetteIdx=s.context.createIndexBuffer(E)}const v=o.bg.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){s.uploadCommonUniforms(s.context,m);const S={u_vignetteShape:(b={vignetteShape:[d.start,d.range,Math.pow(10,d.fadePower)],vignetteColor:[d.color.r,d.color.g,d.color.b,d.color.a*d.strength]}).vignetteShape,u_vignetteColor:b.vignetteColor};m.draw(s,s.context.gl.TRIANGLES,sn.disabled,Dn.disabled,ti.alphaBlended,jn.disabled,S,"vignette",this.vignetteVx,this.vignetteIdx,v)}var b}}class Z0{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(s,d){const m=s.getFreeCameraOptions().position,v=m.toAltitude(),b=m.toLngLat(),S=o.an(b.lng),E=o.an(b.lat),k=s.pixelsPerMeter/d,O=S*o.eD,z=o.eD*Math.log(Math.tan(Math.PI/4+E/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const U=-this._offsetYPrev+z,F=-this._elevationPrev+v;this._accumulatedOffsetX+=(-this._offsetXPrev+O)*k,this._accumulatedOffsetY+=U*k,this._accumulatedElevation+=F*k,this._offsetXPrev=O,this._offsetYPrev=z,this._elevationPrev=v}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function K0(g,s){return[-(g[0]-Math.floor(g[0]/s)*s),-(g[1]-Math.floor(g[1]/s)*s),-(g[2]-Math.floor(g[2]/s)*s)]}function ba(g){const s=o.eo(1323123451230),d=[];for(let m=0;m<g;++m){const v=2*s()-1,b=2*s()-1,S=2*s()-1;d.push(o.d4(v,b,S))}return d}function Pd(g,s,d,m,v){const b=o.aA((v-d)/(m-d),0,1);return(1-b)*g+b*s}class Hf{constructor(s){this._movement=new Z0,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new JS,this._ppmScaleFactor=s}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(s,d){const m=s.transform;this._movement.update(m,this._ppmScaleFactor);const v=m.starsProjMatrix,b=o.c6([]);o.c8(b,b,o.an(90)-m._pitch),o.c7(b,b,-m.angle);const S=o.cb(new Float32Array(16),b),E=o.eC(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),k=o.ed([],E),O=o.aB([],k,S),z=Date.now()/1e3;return this._accumulatedTimeFromStart+=(z-this._prevTime)*d,this._prevTime=z,{projectionMatrix:v,modelviewMatrix:O}}}class Vr extends Hf{constructor(s){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new Ly(s.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(s){const d=s.context;if(!this.particlesVx){const m=ba(this.particlesCount),v=new o.eE,b=new o.b1;let S=0;const E=o.eo(1323123451230);for(let k=0;k<m.length;++k){const O=m[k],z=[2*E()-1,E(),E(),E()];v.emplaceBack(O[0],O[1],O[2],-1,-1,...z),v.emplaceBack(O[0],O[1],O[2],1,-1,...z),v.emplaceBack(O[0],O[1],O[2],1,1,...z),v.emplaceBack(O[0],O[1],O[2],-1,1,...z),b.emplaceBack(S+0,S+1,S+2),b.emplaceBack(S+0,S+2,S+3),S+=4}this.particlesVx=d.createVertexBuffer(v,mm.members),this.particlesIdx=d.createIndexBuffer(b)}}draw(s){if(!this._params.overrideStyleParameters&&!s.style.rain)return;const d=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},m=s.transform.zoom;if(d.revealStart>m)return;const v=Pd(0,1,d.revealStart,d.revealStart+d.revealRange,m);if(!this.particlesVx||!this.particlesIdx)return;const b=structuredClone(this._params);let S=[-b.direction.x,b.direction.y,-100];o.aw(S,S);const E=structuredClone(this._vignetteParams);E.strength*=v,b.overrideStyleParameters||(b.intensity=s.style.rain.state.density,b.timeFactor=s.style.rain.state.intensity,b.color=structuredClone(s.style.rain.state.color),S=structuredClone(s.style.rain.state.direction),b.screenThinning.intensity=s.style.rain.state.centerThinning,b.dropletSizeX=s.style.rain.state.dropletSize[0],b.dropletSizeYScale=s.style.rain.state.dropletSize[1]/s.style.rain.state.dropletSize[0],b.distortionStrength=100*s.style.rain.state.distortionStrength,E.strength=1,E.color=structuredClone(s.style.rain.state.vignetteColor));const k=this.updateOnRender(s,b.timeFactor),O=s.context,z=O.gl,U=s.transform;this.screenTexture&&this.screenTexture.size[0]===s.width&&this.screenTexture.size[1]===s.height||(this.screenTexture=new o.T(O,{width:s.width,height:s.height,data:null},z.RGBA8)),b.distortionStrength>0&&(O.activeTexture.set(z.TEXTURE0),this.screenTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),z.copyTexSubImage2D(z.TEXTURE_2D,0,0,0,0,0,s.width,s.height));const F=s.getOrCreateProgram("rainParticle");s.uploadCommonUniforms(O,F),O.activeTexture.set(z.TEXTURE0),this.screenTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE);const H=[b.color.r,b.color.g,b.color.b,b.color.a],G=(W,ne)=>{const X=K0(this._movement.getPosition(),W),re=b.dropletSizeX,he=b.dropletSizeX*b.dropletSizeYScale,pe=s.width/2,Ie=s.height/2,Se=Pd(0,b.screenThinning.start,0,1,b.screenThinning.intensity),Ae=Pd(.001,b.screenThinning.range,0,1,b.screenThinning.intensity),Ce=Pd(0,b.screenThinning.particleOffset,0,1,b.screenThinning.intensity),we=(ke={modelview:k.modelviewMatrix,projection:k.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:X,velocityConeAperture:b.velocityConeAperture,velocity:b.velocity,boxSize:W,rainDropletSize:[re,he],distortionStrength:b.distortionStrength,rainDirection:S,color:H,screenSize:[U.width,U.height],thinningCenterPos:[pe,Ie],thinningShape:[Se,Ae,Math.pow(10,b.screenThinning.fadePower)],thinningAffectedRatio:b.screenThinning.affectedRatio,thinningParticleOffset:Ce,shapeDirectionalPower:b.shapeDirPower,shapeNormalPower:b.shapeNormalPower,mode:ne?0:1},{u_modelview:Float32Array.from(ke.modelview),u_projection:Float32Array.from(ke.projection),u_time:ke.time,u_cam_pos:ke.camPos,u_texScreen:0,u_velocityConeAperture:ke.velocityConeAperture,u_velocity:ke.velocity,u_boxSize:ke.boxSize,u_rainDropletSize:ke.rainDropletSize,u_distortionStrength:ke.distortionStrength,u_rainDirection:ke.rainDirection,u_color:ke.color,u_screenSize:ke.screenSize,u_thinningCenterPos:ke.thinningCenterPos,u_thinningShape:ke.thinningShape,u_thinningAffectedRatio:ke.thinningAffectedRatio,u_thinningParticleOffset:ke.thinningParticleOffset,u_shapeDirectionalPower:ke.shapeDirectionalPower,u_shapeNormalPower:ke.shapeNormalPower,u_mode:ke.mode});var ke;const nt=Math.round(b.intensity*this.particlesCount),Ke=o.bg.simpleSegment(0,0,4*nt,2*nt);F.draw(s,z.TRIANGLES,sn.disabled,Dn.disabled,ti.alphaBlended,jn.disabled,we,"rain_particles",this.particlesVx,this.particlesIdx,Ke)};b.distortionStrength>0&&G(b.boxSize,!0),G(b.boxSize,!1),this._vignette.draw(s,E)}}const ki=o.ef([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class X0 extends Hf{constructor(s){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new Ly(s.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(s){const d=s.context;if(!this.particlesVx){const m=ba(this.particlesCount),v=new o.eF,b=new o.b1;let S=0;const E=o.eo(1323123451230);for(let k=0;k<m.length;++k){const O=m[k],z=E(),U=E(),F=E(),H=[k/m.length,z,U,F],G=[E(),E()];v.emplaceBack(O[0],O[1],O[2],-1,-1,...H,...G),v.emplaceBack(O[0],O[1],O[2],1,-1,...H,...G),v.emplaceBack(O[0],O[1],O[2],1,1,...H,...G),v.emplaceBack(O[0],O[1],O[2],-1,1,...H,...G),b.emplaceBack(S+0,S+1,S+2),b.emplaceBack(S+0,S+2,S+3),S+=4}this.particlesVx=d.createVertexBuffer(v,ki.members),this.particlesIdx=d.createIndexBuffer(b)}}draw(s){if(!this._params.overrideStyleParameters&&!s.style.snow)return;const d=structuredClone(this._params);let m=[-d.direction.x,d.direction.y,-100];o.aw(m,m);const v=structuredClone(this._vignetteParams),b=d.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},S=s.transform.zoom;if(b.revealStart>S)return;const E=Pd(0,1,b.revealStart,b.revealStart+b.revealRange,S);v.strength*=E,d.overrideStyleParameters||(d.intensity=s.style.snow.state.density,d.timeFactor=s.style.snow.state.intensity,d.color=structuredClone(s.style.snow.state.color),m=structuredClone(s.style.snow.state.direction),d.screenThinning.intensity=s.style.snow.state.centerThinning,d.billboardSize=2.79*s.style.snow.state.flakeSize,v.strength=1,v.color=structuredClone(s.style.snow.state.vignetteColor));const k=this.updateOnRender(s,d.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const O=s.context,z=O.gl,U=s.transform,F=s.getOrCreateProgram("snowParticle");s.uploadCommonUniforms(O,F),((H,G,W)=>{const ne=K0(this._movement.getPosition(),H),X=U.width/2,re=U.height/2,he=Pd(0,W.screenThinning.start,0,1,W.screenThinning.intensity),pe=Pd(.001,W.screenThinning.range,0,1,W.screenThinning.intensity),Ie=Pd(0,W.screenThinning.particleOffset,0,1,W.screenThinning.intensity),Se=(Ae={modelview:k.modelviewMatrix,projection:k.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:ne,velocityConeAperture:W.velocityConeAperture,velocity:W.velocity,horizontalOscillationRadius:W.horizontalOscillationRadius,horizontalOscillationRate:W.horizontalOscillationRate,boxSize:H,billboardSize:1*W.billboardSize,simpleShapeParameters:[W.shapeFadeStart,W.shapeFadePower],screenSize:[U.width,U.height],thinningCenterPos:[X,re],thinningShape:[he,pe,Math.pow(10,W.screenThinning.fadePower)],thinningAffectedRatio:W.screenThinning.affectedRatio,thinningParticleOffset:Ie,color:[W.color.r,W.color.g,W.color.b,W.color.a],direction:m},{u_modelview:Float32Array.from(Ae.modelview),u_projection:Float32Array.from(Ae.projection),u_time:Ae.time,u_cam_pos:Ae.camPos,u_velocityConeAperture:Ae.velocityConeAperture,u_velocity:Ae.velocity,u_horizontalOscillationRadius:Ae.horizontalOscillationRadius,u_horizontalOscillationRate:Ae.horizontalOscillationRate,u_boxSize:Ae.boxSize,u_billboardSize:Ae.billboardSize,u_simpleShapeParameters:Ae.simpleShapeParameters,u_screenSize:Ae.screenSize,u_thinningCenterPos:Ae.thinningCenterPos,u_thinningShape:Ae.thinningShape,u_thinningAffectedRatio:Ae.thinningAffectedRatio,u_thinningParticleOffset:Ae.thinningParticleOffset,u_particleColor:Ae.color,u_direction:Ae.direction});var Ae;const Ce=Math.round(W.intensity*this.particlesCount),we=o.bg.simpleSegment(0,0,4*Ce,2*Ce);this.particlesVx&&this.particlesIdx&&F.draw(s,z.TRIANGLES,sn.disabled,Dn.disabled,ti.alphaBlended,jn.disabled,Se,"snow_particles",this.particlesVx,this.particlesIdx,we)})(d.boxSize,0,d),this._vignette.draw(s,v)}}const Md={symbol:function(g,s,d,m,v){if(g.renderPass!=="translucent")return;const b=Dn.disabled,S=g.colorModeForRenderPass(),E=d.layout.get("text-variable-anchor"),k=d.layout.get("text-size-scale-range"),O=o.aA(g.scaleFactor,k[0],k[1]);E&&function(F,H,G,W,ne,X,re,he){const pe=H.transform,Ie=ne==="map",Se=X==="map";for(const Ae of F){const Ce=W.getTile(Ae),we=Ce.getBucket(G);if(!we||!we.text||!we.text.segments.get().length)continue;const ke=o.bK(we.textSizeData,pe.zoom,he),nt=na(Ae,we.getProjection(),pe),Ke=pe.calculatePixelsToTileUnitsMatrix(Ce),ht=Vs(nt,Ce.tileID.canonical,Se,Ie,pe,we.getProjection(),Ke),et=we.hasIconTextFit()&&we.hasIconData();ke&&Ha(we,Ie,Se,re,pe,ht,Ae,Math.pow(2,pe.zoom-Ce.tileID.overscaledZ),ke,et)}}(m,g,d,s,d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),v,O);const z=d.paint.get("icon-opacity").constantOr(1)!==0,U=d.paint.get("text-opacity").constantOr(1)!==0;d.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(z||U)?ka(g,s,d,m,b,S):(z&&ka(g,s,d,m,b,S,{onlyIcons:!0}),U&&ka(g,s,d,m,b,S,{onlyText:!0})),s.map.showCollisionBoxes&&(js(g,s,d,m,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),!0),js(g,s,d,m,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),!1))},circle:function(g,s,d,m){if(g.renderPass!=="translucent")return;const v=d.paint.get("circle-opacity"),b=d.paint.get("circle-stroke-width"),S=d.paint.get("circle-stroke-opacity"),E=d.layout.get("circle-sort-key").constantOr(1)!==void 0,k=d.paint.get("circle-emissive-strength");if(v.constantOr(1)===0&&(b.constantOr(1)===0||S.constantOr(1)===0))return;const O=g.context,z=O.gl,U=g.transform,F=!(!g.terrain||!g.terrain.enabled),H=d.layout.get("circle-elevation-reference"),G=g.depthModeForSublayer(0,sn.ReadOnly),W=new sn(g.context.gl.LEQUAL,sn.ReadOnly,g.depthRangeFor3D),ne=H==="none"||F?G:W,X=Dn.disabled,re=g.colorModeForDrapableLayerRenderPass(k),he=U.projection.name==="globe",pe=[o.aF(U.center.lng),o.aJ(U.center.lat)],Ie=[];for(let Ae=0;Ae<m.length;Ae++){const Ce=m[Ae],we=s.getTile(Ce),ke=we.getBucket(d);if(!ke||ke.projection.name!==U.projection.name)continue;const nt=ke.programConfigurations.get(d.id),Ke=ke.layoutVertexBuffer,ht=ke.globeExtVertexBuffer,et=ke.indexBuffer,ut=o.dZ(d),jt=[ht],tt=g.isTileAffectedByFog(Ce);he&&ut.push("PROJECTION_GLOBE_VIEW"),ut.push("DEPTH_D24"),g.terrain&&U.depthOcclusionForSymbolsAndCircles&&ut.push("DEPTH_OCCLUSION"),ke.hasElevation&&!g.terrain&&(ut.push("ELEVATED_ROADS"),jt.push(ke.elevatedLayoutVertexBuffer));const Ue=g.getOrCreateProgram("circle",{config:nt,defines:ut,overrideFog:tt}),pt=U.projection.createInversionMatrix(U,Ce.canonical),ot={programConfiguration:nt,program:Ue,layoutVertexBuffer:Ke,dynamicBuffers:jt,indexBuffer:et,uniformValues:o.d_(g,Ce,we,pt,pe,d),tile:we};if(E){const Et=ke.segments.get();for(const $t of Et)Ie.push({segments:new o.bg([$t]),sortKey:$t.sortKey,state:ot})}else Ie.push({segments:ke.segments,sortKey:0,state:ot})}E&&Ie.sort((Ae,Ce)=>Ae.sortKey-Ce.sortKey);const Se={useDepthForOcclusion:U.depthOcclusionForSymbolsAndCircles};for(const Ae of Ie){const{programConfiguration:Ce,program:we,layoutVertexBuffer:ke,dynamicBuffers:nt,indexBuffer:Ke,uniformValues:ht,tile:et}=Ae.state,ut=Ae.segments;g.terrain&&g.terrain.setupElevationDraw(et,we,Se),g.uploadCommonUniforms(O,we,et.tileID.toUnwrapped()),we.draw(g,z.TRIANGLES,ne,X,re,jn.disabled,ht,d.id,ke,Ke,ut,d.paint,U.zoom,Ce,nt)}},heatmap:function(g,s,d,m){if(d.paint.get("heatmap-opacity")!==0)if(g.renderPass==="offscreen"){const v=g.context,b=v.gl,S=Dn.disabled,E=new ti([b.ONE,b.ONE,b.ONE,b.ONE],o.ao.transparent,[!0,!0,!0,!0]);(function(H,G,W,ne){const X=H.gl,re=G.width*ne,he=G.height*ne;H.activeTexture.set(X.TEXTURE1),H.viewport.set([0,0,re,he]);let pe=W.heatmapFbo;if(!pe||pe&&(pe.width!==re||pe.height!==he)){pe&&pe.destroy();const Ie=X.createTexture();X.bindTexture(X.TEXTURE_2D,Ie),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_S,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_T,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MIN_FILTER,X.LINEAR),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MAG_FILTER,X.LINEAR),pe=W.heatmapFbo=H.createFramebuffer(re,he,!0,null),function(Se,Ae,Ce,we,ke,nt){const Ke=Se.gl;Ke.texImage2D(Ke.TEXTURE_2D,0,Se.extRenderToTextureHalfFloat?Ke.RGBA16F:Ke.RGBA,ke,nt,0,Ke.RGBA,Se.extRenderToTextureHalfFloat?Ke.HALF_FLOAT:Ke.UNSIGNED_BYTE,null),we.colorAttachment.set(Ce)}(H,0,Ie,pe,re,he)}else X.bindTexture(X.TEXTURE_2D,pe.colorAttachment.get()),H.bindFramebuffer.set(pe.framebuffer)})(v,g,d,g.transform.projection.name==="globe"?.5:.25),v.clear({color:o.ao.transparent});const k=g.transform,O=k.projection.name==="globe",z=O?["PROJECTION_GLOBE_VIEW"]:[],U=O?jn.frontCCW:jn.disabled,F=[o.aF(k.center.lng),o.aJ(k.center.lat)];for(let H=0;H<m.length;H++){const G=m[H];if(s.hasRenderableParent(G))continue;const W=s.getTile(G),ne=W.getBucket(d);if(!ne||ne.projection.name!==k.projection.name)continue;const X=g.isTileAffectedByFog(G),re=ne.programConfigurations.get(d.id),he=g.getOrCreateProgram("heatmap",{config:re,defines:z,overrideFog:X}),{zoom:pe}=g.transform;g.terrain&&g.terrain.setupElevationDraw(W,he),g.uploadCommonUniforms(v,he,G.toUnwrapped());const Ie=k.projection.createInversionMatrix(k,G.canonical);he.draw(g,b.TRIANGLES,sn.disabled,S,E,U,Yt(g,G,W,Ie,F,pe,d.paint.get("heatmap-intensity")),d.id,ne.layoutVertexBuffer,ne.indexBuffer,ne.segments,d.paint,g.transform.zoom,re,O?[ne.globeExtVertexBuffer]:null)}v.viewport.set([0,0,g.width,g.height])}else g.renderPass==="translucent"&&(g.context.setColorMode(g.colorModeForRenderPass()),function(v,b){const S=v.context,E=S.gl,k=b.heatmapFbo;if(!k)return;S.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,k.colorAttachment.get()),S.activeTexture.set(E.TEXTURE1);let O=b.colorRampTexture;O||(O=b.colorRampTexture=new o.T(S,b.colorRamp,E.RGBA8)),O.bind(E.LINEAR,E.CLAMP_TO_EDGE),v.getOrCreateProgram("heatmapTexture").draw(v,E.TRIANGLES,sn.disabled,Dn.disabled,v.colorModeForRenderPass(),jn.disabled,((z,U,F,H)=>({u_image:0,u_color_ramp:1,u_opacity:U.paint.get("heatmap-opacity")}))(0,b),b.id,v.viewportBuffer,v.quadTriangleIndexBuffer,v.viewportSegments,b.paint,v.transform.zoom)}(g,d))},line:function(g,s,d,m){if(g.renderPass!=="translucent")return;const v=d.paint.get("line-opacity"),b=d.paint.get("line-width");if(v.constantOr(1)===0||b.constantOr(1)===0)return;const S=d.paint.get("line-emissive-strength"),E=d.paint.get("line-occlusion-opacity"),k=d.layout.get("line-elevation-reference"),O=d.layout.get("line-width-unit")==="meters",z=k==="sea",U=!(!g.terrain||!g.terrain.enabled),F=g.context,H=F.gl;if(d.hasElevatedBuckets&&g.transform.projection.name==="globe")return;const G=d.layout.get("line-cross-slope"),W=G!==void 0,ne=G<1,X=g.colorModeForDrapableLayerRenderPass(S),re=g.terrain&&g.terrain.renderingToTexture,he=re?1:o.o.devicePixelRatio,pe=d.paint.get("line-dasharray"),Ie=pe.constantOr(1),Se=d.layout.get("line-cap"),Ae=pe.constantOr(null),Ce=Se.constantOr(null),we=d.paint.get("line-pattern"),ke=we.constantOr(1),nt=d.paint.get("line-pattern-cross-fade"),Ke=we.constantOr(null),ht=d.paint.get("line-opacity").constantOr(1);let et=!ke&&ht!==1||g.depthOcclusion&&E>0&&E<1;const ut=d.paint.get("line-gradient"),jt=ke?"linePattern":"line",tt=o.d$(d);let Ue;if(re&&g.terrain&&g.terrain.clipOrMaskOverlapStencilType()&&(et=!1),E!==0&&g.depthOcclusion){const $t=d.paint._values["line-opacity"];$t&&$t.value&&$t.value.kind==="constant"?Ue=$t.value:o.w(`Occlusion opacity for layer ${d.id} is supported only when line-opacity isn't data-driven.`)}b.value.kind!=="constant"&&b.value.isLineProgressConstant===!1&&tt.push("VARIABLE_LINE_WIDTH");const pt=($t,rn,Lt,Rt,Cn,yn)=>{for(const wn of $t){const gn=s.getTile(wn);if(ke&&!gn.patternsLoaded())continue;const Wn=gn.getBucket(d);if(!Wn||Wn.elevationType!=="none"&&!Cn||Wn.elevationType==="none"&&Cn)continue;g.prepareDrawTile();const ri=[...rn],ci=g.shadowRenderer,or=Wn.elevationType==="road"&&!!ci&&ci.enabled;let Xn=[0,0,0];if(or){const ui=g.style.directionalLight,Vn=g.style.ambientLight;ui&&Vn&&(Xn=Al(g.style,ui,Vn)),ri.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET")}const ji=Wn.programConfigurations.get(d.id);let rr=!1;if(Ke&&gn.imageAtlas){const ui=o.e0.from(Ke),Vn=ui.getPrimary().scaleSelf(he).toString(),sr=gn.imageAtlas.patternPositions.get(Vn),yo=ui.getSecondary(),Yr=yo?gn.imageAtlas.patternPositions.get(yo.scaleSelf(he).toString()):null;rr=!!sr&&!!Yr,sr&&ji.setConstantPatternPositions(sr,Yr)}nt>0&&(rr||ji.getPatternTransitionVertexBuffer("line-pattern"))&&ri.push("LINE_PATTERN_TRANSITION");const $r=g.isTileAffectedByFog(wn),oi=g.getOrCreateProgram(jt,{config:ji,defines:ri,overrideFog:$r});if(!ke&&Ae&&Ce&&gn.lineAtlas){const ui=gn.lineAtlas.getDash(Ae,Ce);ui&&ji.setConstantPatternPositions(ui)}or&&ci.setupShadows(gn.tileID.toUnwrapped(),oi,"vector-tile");let[Ji,qi]=d.paint.get("line-trim-offset");(Ce==="round"||Ce==="square")&&Ji!==qi&&(Ji===0&&(Ji-=1),qi===1&&(qi+=1));const er=re?wn.projMatrix:null,Wr=O?1/Wn.tileToMeter/o.ay(gn,1,g.transform.zoom):1,Po=O?1/Wn.tileToMeter/o.ay(gn,1,Math.floor(g.transform.zoom)):1,Ds=ke?o.e1(g,gn,d,er,he,Wr,Po,[Ji,qi],Xn,nt):o.e2(g,gn,d,er,Wn.lineClipsArray.length,he,Wr,Po,[Ji,qi],Xn);if(ut){const ui=Wn.gradients[d.id];let Vn=ui.texture;if(d.gradientVersion!==ui.version){let sr=256;if(d.stepInterpolant){const yo=s.getSource().maxzoom,Yr=wn.canonical.z===yo?Math.ceil(1<<g.transform.maxZoom-wn.canonical.z):1;sr=o.aA(o.e3(Wn.maxLineLength/o.al*1024*Yr),256,F.maxTextureSize)}ui.gradient=o.e4({expression:d.gradientExpression(),evaluationKey:"lineProgress",resolution:sr,image:ui.gradient||void 0,clips:Wn.lineClipsArray}),ui.texture?ui.texture.update(ui.gradient):ui.texture=new o.T(F,ui.gradient,H.RGBA8),ui.version=d.gradientVersion,Vn=ui.texture}F.activeTexture.set(H.TEXTURE1),Vn.bind(d.stepInterpolant?H.NEAREST:H.LINEAR,H.CLAMP_TO_EDGE)}Ie&&(F.activeTexture.set(H.TEXTURE0),gn.lineAtlasTexture&&gn.lineAtlasTexture.bind(H.LINEAR,H.REPEAT),ji.updatePaintBuffers()),ke&&(F.activeTexture.set(H.TEXTURE0),gn.imageAtlasTexture&&gn.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),ji.updatePaintBuffers()),Cn&&!z&&g.terrain.setupElevationDraw(gn,oi),g.uploadCommonUniforms(F,oi,wn.toUnwrapped());const qr=ui=>{Ue!=null&&(Ue.value=ht*E),oi.draw(g,H.TRIANGLES,Lt,ui,X,jn.disabled,Ds,d.id,Wn.layoutVertexBuffer,Wn.indexBuffer,Wn.segments,d.paint,g.transform.zoom,ji,[Wn.layoutVertexBuffer2,Wn.patternVertexBuffer,Wn.zOffsetVertexBuffer]),Ue!=null&&(Ue.value=ht)};if(et&&!Cn){const ui=g.stencilModeForClipping(wn).ref;ui===0&&re&&F.clear({stencil:0});const Vn={func:H.EQUAL,mask:255};Ds.u_alpha_discard_threshold=.8,qr(new Dn(Vn,ui,255,H.KEEP,H.KEEP,H.INVERT)),Ds.u_alpha_discard_threshold=0,qr(new Dn(Vn,ui,255,H.KEEP,H.KEEP,H.KEEP))}else Ds.u_alpha_discard_threshold=et&&Cn&&yn?.8:0,qr(Cn?Rt:g.stencilModeForClipping(wn))}};let ot=g.depthModeForSublayer(0,sn.ReadOnly);const Et=new sn(g.depthOcclusion?H.GREATER:H.LEQUAL,sn.ReadOnly,g.depthRangeFor3D);if(d.hasNonElevatedBuckets){const $t=!re&&g.terrain;E!==0&&$t?o.w(`Occlusion opacity for layer ${d.id} is supported on terrain only if the layer has line-z-offset enabled.`):$t?o.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${d.id}.`):pt(m,tt,ot,Dn.disabled,!1,!0)}if(d.hasElevatedBuckets){k==="hd-road-markup"?U||(ot=Et,tt.push("ELEVATED_ROADS")):(tt.push("ELEVATED"),ot=Et,W&&tt.push(ne?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),z&&tt.push("ELEVATION_REFERENCE_SEA"));const $t=et?g.stencilModeFor3D():Dn.disabled;g.forceTerrainMode=!0,pt(m,tt,ot,$t,!0,!0),et&&pt(m,tt,ot,$t,!0,!1),g.forceTerrainMode=!1}et&&(g.resetStencilClippingMasks(),re&&F.clear({stencil:0})),E===0||g.depthOcclusion||re||g.layersWithOcclusionOpacity.push(g.currentLayer)},fill:function(g,s,d,m){const v=d.paint.get("fill-color"),b=d.paint.get("fill-opacity");if(b.constantOr(1)===0)return;const S=d.paint.get("fill-emissive-strength"),E=g.colorModeForDrapableLayerRenderPass(S),k=d.paint.get("fill-pattern"),O=g.opaquePassEnabledForLayer()&&!k.constantOr(1)&&v.constantOr(o.ao.transparent).a===1&&b.constantOr(0)===1?"opaque":"translucent";let z="none";d.layout.get("fill-elevation-reference")!=="none"?z="road":d.paint.get("fill-z-offset").constantOr(1)!==0&&(z="offset");const U=!(!g.terrain||!g.terrain.enabled),F={painter:g,sourceCache:s,layer:d,coords:m,colorMode:E,elevationType:z,terrainEnabled:U,pass:O};if(g.renderPass!=="shadow")if(z!=="offset"){if(Ms(F,!1),z==="road"){const H=!U&&g.renderPass==="translucent";H&&Gr(g,s,d,m,"geometry"),Ms(F,!0,Dn.disabled),H&&function(G){const{painter:W,sourceCache:ne,layer:X,coords:re,colorMode:he}=G,pe=W.context.gl,Ie=G.painter.shadowRenderer,Se=!!Ie&&Ie.enabled,Ae=new sn(W.context.gl.LEQUAL,sn.ReadOnly,W.depthRangeFor3D);let Ce=[0,0,0];if(Se){const ke=W.style.directionalLight,nt=W.style.ambientLight;ke&&nt&&(Ce=Al(W.style,ke,nt))}const we=ke=>{for(const nt of re){const Ke=ne.getTile(nt),ht=Ke.getBucket(X);if(!ht)continue;const et=ht.elevatedStructures;if(!et)continue;let ut,jt;if(ke?(ut=et.renderableBridgeSegments,jt=et.bridgeProgramConfigurations.get(X.id)):(ut=et.renderableTunnelSegments,jt=et.tunnelProgramConfigurations.get(X.id)),!ut||ut.segments[0].primitiveLength===0)continue;jt.updatePaintBuffers(),W.prepareDrawTile();const tt=W.isTileAffectedByFog(nt),Ue=[];Se&&Ue.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const pt=W.getOrCreateProgram("elevatedStructures",{config:jt,overrideFog:tt,defines:Ue}),ot=W.translatePosMatrix(nt.projMatrix,Ke,X.paint.get("fill-translate"),X.paint.get("fill-translate-anchor"));Se&&Ie.setupShadows(Ke.tileID.toUnwrapped(),pt,"vector-tile");const Et=Ry(ot,Ce);W.uploadCommonUniforms(W.context,pt,nt.toUnwrapped()),pt.draw(W,pe.TRIANGLES,Ae,Dn.disabled,he,jn.backCCW,Et,X.id,et.vertexBuffer,et.indexBuffer,ut,X.paint,W.transform.zoom,jt,[et.vertexBufferNormal])}};we(!0),we(!1)}(F)}}else Ms(F,!1,g.stencilModeFor3D());else g.shadowRenderer&&z==="road"&&!U&&function(H){const{painter:G,sourceCache:W,layer:ne,coords:X}=H,re=G.context.gl,he=H.painter.shadowRenderer;for(const pe of X){const Ie=W.getTile(pe),Se=Ie.getBucket(ne);if(!Se)continue;const Ae=Se.elevatedStructures;if(!Ae||!Ae.shadowCasterSegments||Ae.shadowCasterSegments.segments[0].primitiveLength===0)continue;G.prepareDrawTile();const Ce=Se.bufferData.programConfigurations.get(ne.id),we=G.isTileAffectedByFog(pe),ke=G.getOrCreateProgram("elevatedStructuresDepth",{config:Ce,overrideFog:we}),nt=he.calculateShadowPassMatrixFromTile(Ie.tileID.toUnwrapped());G.uploadCommonUniforms(G.context,ke,pe.toUnwrapped());const Ke={u_matrix:nt,u_depth_bias:0};ke.draw(G,re.TRIANGLES,he.getShadowPassDepthMode(),Dn.disabled,he.getShadowPassColorMode(),jn.disabled,Ke,ne.id,Ae.vertexBuffer,Ae.indexBuffer,Ae.shadowCasterSegments,ne.paint,G.transform.zoom,Ce)}}(F)},"fill-extrusion":function(g,s,d,m){const v=d.paint.get("fill-extrusion-opacity"),b=g.context,S=b.gl,E=g.terrain,k=E&&E.renderingToTexture;if(v===0)return;const O=g.conflationActive&&g.style.isLayerClipped(d,s.getSource()),z=g.style.order.indexOf(d.fqid);if(O&&function(U,F,H,G,W){for(const ne of G){const X=F.getTile(ne).getBucket(H);X&&(X.updateReplacement(ne,U.replacementSource,W),X.uploadCentroid(U.context))}}(g,s,d,m,z),E||O)for(const U of m){const F=s.getTile(U).getBucket(d);F&&xc(g.context,s,U,F,d,E,O)}if(g.renderPass==="shadow"&&g.shadowRenderer){const U=g.shadowRenderer;if(E&&v<.65&&d._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof o.ad)return;const F=U.getShadowPassDepthMode(),H=U.getShadowPassColorMode();en(g,s,d,m,F,Dn.disabled,H,O)}else if(g.renderPass==="translucent"){const U=!d.paint.get("fill-extrusion-pattern").constantOr(1),F=d.paint.get("fill-extrusion-color").constantOr(o.ao.white);if(!k&&F.a!==0){const H=new sn(g.context.gl.LEQUAL,sn.ReadWrite,g.depthRangeFor3D);v===1&&U?en(g,s,d,m,H,Dn.disabled,ti.unblended,O):(en(g,s,d,m,H,Dn.disabled,ti.disabled,O),en(g,s,d,m,H,g.stencilModeFor3D(),g.colorModeForRenderPass(),O),g.resetStencilClippingMasks())}if(g.style.enable3dLights()&&U&&(!E&&g.transform.projection.name!=="globe"||k)){const H=d.paint.get("fill-extrusion-opacity"),G=d.paint.get("fill-extrusion-ambient-occlusion-intensity"),W=d.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),ne=d.paint.get("fill-extrusion-flood-light-intensity"),X=d.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",re=d.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(X?null:d.lut).toArray01().slice(0,3),he=G>0&&W>0,pe=ne>0,Ie=(Ce,we,ke)=>(1-ke)*Ce+ke*we,Se=new oc;Se.translate=d.paint.get("fill-extrusion-translate"),Se.translateAnchor=d.paint.get("fill-extrusion-translate-anchor"),Se.edgeRadius=d.layout.get("fill-extrusion-edge-radius"),Se.cutoffFadeRange=d.paint.get("fill-extrusion-cutoff-fade-range");const Ae=Ce=>{const we=g.depthModeForSublayer(1,sn.ReadOnly,S.LEQUAL,!0),ke=d.paint.get(Ce?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),nt=Ie(.1,3,ke),Ke=g._showOverdrawInspector;if(!Ke){const ht=new Dn({func:S.ALWAYS,mask:255},255,255,S.KEEP,S.KEEP,S.REPLACE),et=new ti([S.ONE,S.ONE,S.ONE,S.ONE],o.ao.transparent,[!1,!1,!1,!0],S.MIN);rl(Se,g,s,d,m,we,ht,et,jn.disabled,Ce,"sdf",H,G,W,ne,re,nt,O,!1)}{const ht=Ke?Dn.disabled:new Dn({func:S.EQUAL,mask:255},255,255,S.KEEP,S.DECR,S.DECR),et=Ke?g.colorModeForRenderPass():new ti([S.ONE_MINUS_DST_ALPHA,S.DST_ALPHA,S.ONE,S.ONE],o.ao.transparent,[!0,!0,!0,!0]);rl(Se,g,s,d,m,we,ht,et,jn.disabled,Ce,"color",H,G,W,ne,re,nt,O,!1)}};if(k){const Ce=(we,ke,nt)=>{const Ke=g.depthModeForSublayer(1,sn.ReadOnly,S.LEQUAL,!1),ht=d.paint.get(we?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),et=Ie(.1,3,ht);{const ut=new ti([S.ONE,S.ONE,S.ONE,S.ONE],o.ao.transparent,[!1,!1,!1,!0]);rl(Se,g,s,d,m,Ke,Dn.disabled,ut,jn.disabled,we,"clear",H,G,W,ne,re,et,O,ke)}{const ut=new Dn({func:S.ALWAYS,mask:255},255,255,S.KEEP,S.KEEP,S.REPLACE),jt=new ti([S.ONE,S.ONE,S.ONE,S.ONE],o.ao.transparent,[!1,!1,!1,!0],S.MIN);rl(Se,g,s,d,m,Ke,ut,jt,jn.disabled,we,"sdf",H,G,W,ne,re,et,O,ke)}{const ut=we?S.ZERO:S.ONE_MINUS_DST_ALPHA,jt=new Dn({func:S.EQUAL,mask:255},255,255,S.KEEP,S.DECR,S.DECR),tt=new ti([ut,S.DST_ALPHA,S.ONE_MINUS_DST_ALPHA,S.ZERO],o.ao.transparent,[!0,!0,!0,!0]);rl(Se,g,s,d,m,Ke,jt,tt,jn.disabled,we,"color",H,G,W,ne,re,et,O,ke)}{const ut=new ti([S.ONE,S.ONE,S.ONE,we?S.ZERO:S.ONE],o.ao.transparent,[!1,!1,!1,!0],we?S.FUNC_ADD:S.MAX);rl(Se,g,s,d,m,Ke,Dn.disabled,ut,jn.disabled,we,"clear",H,G,W,ne,re,et,O,ke,nt)}};if(he||pe){let we;if(g.prepareDrawTile(),E){const ke=E.drapeBufferSize[0],nt=E.drapeBufferSize[1];we=E.framebufferCopyTexture,we&&(!we||we.size[0]===ke&&we.size[1]===nt)||(we&&we.destroy(),we=E.framebufferCopyTexture=new o.T(b,new o.q({width:ke,height:nt}),S.RGBA8)),we.bind(S.LINEAR,S.CLAMP_TO_EDGE),S.copyTexSubImage2D(S.TEXTURE_2D,0,0,0,0,0,ke,nt)}he&&Ce(!0,!1,we),pe&&Ce(!1,!0,we)}}else he&&Ae(!0),pe&&Ae(!1),(he||pe)&&g.resetStencilClippingMasks()}}},building:function(g,s,d,m){g.currentLayer<g.firstLightBeamLayer&&(g.firstLightBeamLayer=g.currentLayer);const v=d.paint.get("building-ambient-occlusion-ground-intensity"),b=d.paint.get("building-ambient-occlusion-ground-radius"),S=d.paint.get("building-ambient-occlusion-ground-attenuation"),E=d.paint.get("building-opacity");if(E<=0)return;let k=v>0&&b>0,O=!0;const z=d.paint.get("building-vertical-scale");(!g.shadowRenderer||z<1)&&(O=!1);const U=g.conflationActive&&g.style.isLayerClipped(d,s.getSource()),F=g.style.order.indexOf(d.fqid);if(function(H,G,W,ne,X,re){for(const he of re){const pe=G.getTile(he).getBucket(W);pe&&(X&&pe.updateReplacement(he,H.replacementSource,ne),pe.uploadUpdatedIndexBuffer(H.context))}}(g,s,d,F,U,m),function(H,G,W,ne){for(const X of ne){const re=G.getTile(X).getBucket(W);re&&re.needsEvaluation()&&re.uploadUpdatedColorBuffer(H.context)}}(g,s,d,m),d.resetLayerRenderingStats(g),g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!0),g.renderPass==="shadow"&&g.shadowRenderer){const H=g.shadowRenderer,G=[],W=H.getShadowPassDepthMode();Rd({painter:g,source:s,layer:d,coords:m,defines:G,blendMode:H.getShadowPassColorMode(),depthMode:W,opacity:E,verticalScale:z,facadeEmissiveChance:0,facadeAOIntensity:0})}else if(g.renderPass==="translucent"){let H=["HAS_ATTRIBUTE_a_part_color_emissive","LIGHTING_3D_MODE"];O&&(H=H.concat("RENDER_SHADOWS","DEPTH_TEXTURE")),g.shadowRenderer&&g.shadowRenderer.useNormalOffset&&(H=H.concat("NORMAL_OFFSET"));const G=d.paint.get("building-facade-emissive-chance"),W=d.paint.get("building-ambient-occlusion-intensity"),ne=new sn(g.context.gl.LEQUAL,sn.ReadWrite,g.depthRangeFor3D);E<1&&Rd({painter:g,source:s,layer:d,coords:m,defines:H,blendMode:ti.disabled,depthMode:ne,opacity:E,verticalScale:z,facadeEmissiveChance:G,facadeAOIntensity:W});const X=g.colorModeForRenderPass();Rd({painter:g,source:s,layer:d,coords:m,defines:H,blendMode:X,depthMode:ne,opacity:E,verticalScale:z,facadeEmissiveChance:G,facadeAOIntensity:W}),k&&function(re,he,pe,Ie,Se,Ae,Ce,we,ke,nt,Ke,ht,et){const ut=re.context.gl,jt=re.depthModeForSublayer(1,sn.ReadOnly,ut.LEQUAL,!0),tt=.1*(1-(Ue=Ke))+3*Ue;var Ue;const pt=re._showOverdrawInspector,ot=ht,Et=new oc;pt||rl(Et,re,he,pe,Ie,jt,new Dn({func:ut.ALWAYS,mask:255},255,255,ut.KEEP,ut.KEEP,ut.REPLACE),new ti([ut.ONE,ut.ONE,ut.ONE,ut.ONE],o.ao.transparent,[!1,!1,!1,!0],ut.MIN),jn.disabled,Se,"sdf",Ae,Ce,we,0,nt,tt,ot,!1);{const $t=pt?Dn.disabled:new Dn({func:ut.EQUAL,mask:255},255,255,ut.KEEP,ut.DECR,ut.DECR),rn=pt?re.colorModeForRenderPass():new ti([ut.ONE_MINUS_DST_ALPHA,ut.DST_ALPHA,ut.ONE,ut.ONE],o.ao.transparent,[!0,!0,!0,!0]);rl(Et,re,he,pe,Ie,jt,$t,rn,jn.disabled,Se,"color",Ae,Ce,we,0,nt,tt,ot,!1)}}(g,s,d,m,!0,E,v,b,0,[0,0,0],S,U)}else if(g.renderPass==="light-beam"){const H=["HAS_ATTRIBUTE_a_part_color_emissive","HAS_ATTRIBUTE_a_bloom_attenuation"],G=new sn(g.context.gl.LEQUAL,sn.ReadOnly,g.depthRangeFor3D);Rd({painter:g,source:s,layer:d,coords:m,defines:H,blendMode:ti.alphaBlended,depthMode:G,opacity:E,verticalScale:z,facadeEmissiveChance:0,facadeAOIntensity:0})}g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!1),g.resetStencilClippingMasks()},hillshade:function(g,s,d,m){if(g.renderPass!=="offscreen"&&g.renderPass!=="translucent"||g.style.disableElevatedTerrain)return;const v=g.context,b=g.terrain&&g.terrain.renderingToTexture,[S,E]=g.renderPass!=="translucent"||b?[{},m]:g.stencilConfigForOverlap(m);for(const k of E){const O=s.getTile(k);if(O.needsHillshadePrepare&&g.renderPass==="offscreen")Cy(g,O,d);else if(g.renderPass==="translucent"){const z=g.depthModeForSublayer(0,sn.ReadOnly),U=d.paint.get("hillshade-emissive-strength"),F=g.colorModeForDrapableLayerRenderPass(U),H=b&&g.terrain?g.terrain.stencilModeForRTTOverlap(k):S[k.overscaledZ];Sy(g,k,O,d,z,H,F)}}v.viewport.set([0,0,g.width,g.height]),g.resetStencilClippingMasks()},raster:function(g,s,d,m,v,b){if(g.renderPass!=="translucent"||d.paint.get("raster-opacity")===0)return;const S=g.transform.projection.name==="globe",E=d.paint.get("raster-elevation")!==0,k=E&&S;if(g.renderElevatedRasterBackface&&!k)return;const O=g.context,z=O.gl,U=s.getSource(),F=function(Se,Ae,Ce,we){const ke=Ae.paint.get("raster-color"),nt=Se.type==="raster-array",Ke=[],ht=Ae.paint.get("raster-resampling"),et=Ae.paint.get("raster-color-mix");let ut=Ae.paint.get("raster-color-range");const jt=[et[0],et[1],et[2],0],tt=et[3];let Ue=ht==="nearest"?we.NEAREST:we.LINEAR;if(nt&&(Ke.push("RASTER_ARRAY"),ke||Ke.push("RASTER_COLOR"),ht==="linear"&&Ke.push("RASTER_ARRAY_LINEAR"),Ue=we.NEAREST,!ut&&Se.rasterLayers)){const pt=Se.rasterLayers.find(({id:ot})=>ot===Ae.sourceLayer);pt&&pt.fields&&pt.fields.range&&(ut=pt.fields.range)}if(ut=ut||[0,1],ke){Ke.push("RASTER_COLOR"),Ce.activeTexture.set(we.TEXTURE2),Ae.updateColorRamp(ut);let pt=Ae.colorRampTexture;pt||(pt=Ae.colorRampTexture=new o.T(Ce,Ae.colorRamp,we.RGBA8)),pt.bind(we.LINEAR,we.CLAMP_TO_EDGE)}return{mix:jt,range:ut,offset:tt,defines:Ke,resampling:Ue}}(U,d,O,z);if(U instanceof o.aS&&!m.length&&!S)return;const H=d.paint.get("raster-emissive-strength"),G=g.colorModeForDrapableLayerRenderPass(H),W=g.terrain&&g.terrain.renderingToTexture,ne=!g.options.moving,X=d.paint.get("raster-resampling")==="nearest"?z.NEAREST:z.LINEAR;if(U instanceof o.aS&&!m.length&&(U.onNorthPole||U.onSouthPole)){const Se=E?g.stencilModeFor3D():Dn.disabled;return void bh(!!U.onNorthPole,null,g,s,d,H,F,jn.disabled,Se)}if(!m.length)return;const[re,he]=U instanceof o.aS||W?[{},m]:g.stencilConfigForOverlap(m),pe=he[he.length-1].overscaledZ;k&&F.defines.push("PROJECTION_GLOBE_VIEW"),E&&F.defines.push("RENDER_CUTOFF");const Ie=(Se,Ae,Ce)=>{for(const we of Se){const ke=we.toUnwrapped(),nt=s.getTile(we);if(W&&(!nt||!nt.hasData()))continue;O.activeTexture.set(z.TEXTURE0);const Ke=dm(nt,U,d,F);if(!Ke||!Ke.texture)continue;const{texture:ht,mix:et,offset:ut,tileSize:jt,buffer:tt}=Ke;let Ue,pt;W?(Ue=sn.disabled,pt=we.projMatrix):E?(Ue=new sn(z.LEQUAL,sn.ReadWrite,g.depthRangeFor3D),pt=S?Float32Array.from(g.transform.expandedFarZProjMatrix):g.transform.calculateProjMatrix(ke,ne)):(Ue=g.depthModeForSublayer(we.overscaledZ-pe,d.paint.get("raster-opacity")===1?sn.ReadWrite:sn.ReadOnly,z.LESS),pt=g.transform.calculateProjMatrix(ke,ne));const ot=g.terrain&&W?g.terrain.stencilModeForRTTOverlap(we):re[we.overscaledZ],Et=b?0:d.paint.get("raster-fade-duration");nt.registerFadeDuration(Et);const $t=s.findLoadedParent(we,0),rn=iu(nt,$t,s,g.transform,Et);let Lt,Rt;!rn.isFading&&nt.refreshedUponExpiration&&(nt.refreshedUponExpiration=!1),g.terrain&&g.terrain.prepareDrawTile(),O.activeTexture.set(z.TEXTURE0),ht.bind(X,z.CLAMP_TO_EDGE),O.activeTexture.set(z.TEXTURE1),$t?($t.texture&&$t.texture.bind(X,z.CLAMP_TO_EDGE),Lt=Math.pow(2,$t.tileID.overscaledZ-nt.tileID.overscaledZ),Rt=[nt.tileID.canonical.x*Lt%1,nt.tileID.canonical.y*Lt%1]):ht.bind(X,z.CLAMP_TO_EDGE),"useMipmap"in ht&&O.extTextureFilterAnisotropic&&g.transform.pitch>20&&z.texParameterf(z.TEXTURE_2D,O.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,O.extTextureFilterAnisotropicMax);const Cn=g.transform;let yn;const wn=E?Py(Cn):[0,0,0,0];let gn,Wn,ri,ci,or,Xn=0;if(k&&U instanceof o.aS&&U.coordinates.length>3)gn=Float32Array.from(o.bk(o.dF(new o.cC(0,0,0)))),Wn=Float32Array.from(Cn.globeMatrix),ri=Float32Array.from(o.dB(Cn)),ci=[o.aF(Cn.center.lng),o.aJ(Cn.center.lat)],yn=U.elevatedGlobePerspectiveTransform,or=U.elevatedGlobeGridMatrix||new Float32Array(9);else if(k){const oi=o.dC(we.canonical);Xn=o.dD(oi.getCenter().lat),gn=Float32Array.from(o.bk(o.dF(we.canonical))),Wn=Float32Array.from(Cn.globeMatrix),ri=Float32Array.from(o.dB(Cn)),ci=[o.aF(Cn.center.lng),o.aJ(Cn.center.lat)],yn=[0,0],or=Float32Array.from(o.dE(we.canonical,oi,Xn,Cn.worldSize/Cn._pixelsPerMercatorPixel))}else yn=U instanceof o.aS?U.perspectiveTransform:[0,0],gn=new Float32Array(16),Wn=new Float32Array(9),ri=new Float32Array(16),ci=[0,0],or=new Float32Array(9);const ji=ni(pt,gn,Wn,ri,or,Rt||[0,0],o.aj(g.transform.zoom),ci,wn,Lt||1,rn,d,yn,E?d.paint.get("raster-elevation"):0,2,et,ut,F.range,jt,tt,H),rr=g.isTileAffectedByFog(we),$r=g.getOrCreateProgram("raster",{defines:F.defines,overrideFog:rr});if(g.uploadCommonUniforms(O,$r,ke),U instanceof o.aS){const oi=U.elevatedGlobeVertexBuffer,Ji=U.elevatedGlobeIndexBuffer;if(W||!S)U.boundsBuffer&&U.boundsSegments&&$r.draw(g,z.TRIANGLES,Ue,Dn.disabled,G,jn.disabled,ji,d.id,U.boundsBuffer,g.quadTriangleIndexBuffer,U.boundsSegments);else if(oi&&Ji){const qi=Cn.zoom<=o.cZ?U.elevatedGlobeSegments:U.getSegmentsForLongitude(Cn.center.lng);qi&&$r.draw(g,z.TRIANGLES,Ue,Dn.disabled,G,Ae,ji,d.id,oi,Ji,qi)}}else if(k){Ue=new sn(z.LEQUAL,sn.ReadOnly,g.depthRangeFor3D);const oi=g.globeSharedBuffers;if(oi){const[Ji,qi,er]=oi.getGridBuffers(Xn,!1);$r.draw(g,z.TRIANGLES,Ue,Ce||ot,g.colorModeForRenderPass(),Ae,ji,d.id,Ji,qi,er)}}else{const{tileBoundsBuffer:oi,tileBoundsIndexBuffer:Ji,tileBoundsSegments:qi}=g.getTileBoundsBuffers(nt);$r.draw(g,z.TRIANGLES,Ue,ot,G,jn.disabled,ji,d.id,oi,Ji,qi)}}if(!(U instanceof o.aS)&&k)for(const we of Se){const ke=we.canonical.y===(1<<we.canonical.z)-1;we.canonical.y===0&&bh(!0,we,g,s,d,H,F,Ae,Ce||Dn.disabled),ke&&bh(!1,we,g,s,d,H,F,Ae===jn.frontCW?jn.backCW:jn.frontCW,Ce||Dn.disabled)}};k?Ie(he,g.renderElevatedRasterBackface?jn.backCW:jn.frontCW,g.stencilModeFor3D()):Ie(he,jn.disabled,void 0),g.resetStencilClippingMasks()},"raster-particle":function(g,s,d,m,v,b){g.renderPass==="offscreen"&&function(S,E,k,O){if(!O.length)return;const z=S.context,U=z.gl,F=E.getSource();if(!(F instanceof fa))return;const H=Math.ceil(Math.sqrt(k.paint.get("raster-particle-count")));let G=k.particlePositionRGBAImage;if(!G||G.width!==H){const he=function(pe){const Ie=pe*pe,Se=new Uint8Array(4*Ie),Ae=function(we){return we|=0,we=Math.imul(2747636419^we,2654435769),we=Math.imul(we^we>>>16,2654435769),((we=Math.imul(we^we>>>16,2654435769))>>>0)/4294967296},Ce=1/1.1;for(let we=0;we<Ie;we++){const ke=Ce*(Ae(2*we+0)+Gn),nt=Ce*(Ae(2*we+1)+Gn),Ke=255*ke%1,ht=255*nt%1,et=Ke,ut=nt-ht/255,jt=ht;Se[4*we+0]=255*(ke-Ke/255),Se[4*we+1]=255*et,Se[4*we+2]=255*ut,Se[4*we+3]=255*jt}return Se}(H);G=k.particlePositionRGBAImage=new o.q({width:H,height:H},he)}let W=k.particleFramebuffer;W?W.width!==H&&(W.destroy(),W=k.particleFramebuffer=z.createFramebuffer(H,H,!0,null)):W=k.particleFramebuffer=z.createFramebuffer(H,H,!0,null);const ne=[];for(const he of O){const pe=E.getTile(he);if(!(pe instanceof Es))continue;const Ie=Ra(pe,F,k);if(!Ie)continue;const Se=[pe.tileSize,pe.tileSize];let Ae=k.tileFramebuffer;Ae||(Ae=k.tileFramebuffer=z.createFramebuffer(Se[0],Se[1],!0,null));let Ce=pe.rasterParticleState;Ce||(Ce=pe.rasterParticleState=new My(z,he,Se,G));const we=Ce.update(k.lastInvalidatedAt);Ce.particleTextureDimension!==H&&Ce.updateParticleTexture(he,G);const ke=Ce.targetColorTexture;Ce.targetColorTexture=Ce.backgroundColorTexture,Ce.backgroundColorTexture=ke;const nt=Ce.particleTexture0;Ce.particleTexture0=Ce.particleTexture1,Ce.particleTexture1=nt,ne.push([he,Ie,Ce,we])}if(ne.length===0)return;const X=o.o.now(),re=k.previousDrawTimestamp?.001*(X-k.previousDrawTimestamp):.0167;if(k.previousDrawTimestamp=X,k.hasColorMap()){z.activeTexture.set(U.TEXTURE0+2);let he=k.colorRampTexture;he||(he=k.colorRampTexture=new o.T(z,k.colorRamp,U.RGBA8)),he.bind(U.LINEAR,U.CLAMP_TO_EDGE)}z.bindFramebuffer.set(k.tileFramebuffer.framebuffer),function(he,pe,Ie){const Se=he.context,Ae=Se.gl,Ce=pe.tileFramebuffer;Se.activeTexture.set(Ae.TEXTURE0);const we={u_texture:0,u_opacity:1.05*(nt=pe.paint.get("raster-particle-fade-opacity-factor"))/(nt+.05)},ke=he.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var nt;for(const Ke of Ie){const[,,ht,et]=Ke;Ce.colorAttachment.set(ht.targetColorTexture.texture),Se.viewport.set([0,0,Ce.width,Ce.height]),Se.clear({color:o.ao.transparent}),et&&(ht.backgroundColorTexture.bind(Ae.NEAREST,Ae.CLAMP_TO_EDGE),ke.draw(he,Ae.TRIANGLES,sn.disabled,Dn.disabled,ti.alphaBlended,jn.disabled,we,pe.id,he.viewportBuffer,he.quadTriangleIndexBuffer,he.viewportSegments))}}(S,k,ne),function(he,pe,Ie,Se){const Ae=he.context,Ce=Ae.gl,we=Ie.tileFramebuffer,ke=he.transform.projection.name==="globe",nt=Ie.paint.get("raster-particle-max-speed");for(const Ke of Se){const[ht,et,ut]=Ke;Ae.activeTexture.set(Ce.TEXTURE0+0),et.texture.bind(Ce.LINEAR,Ce.CLAMP_TO_EDGE),we.colorAttachment.set(ut.targetColorTexture.texture);const jt=he.getOrCreateProgram("rasterParticleDraw",{defines:et.defines,overrideFog:!1});Ae.activeTexture.set(Ce.TEXTURE0+1);const tt=et.scalarData?[]:[0,1,2,3].map(ot=>o.e6[ot](ht));tt.push(ht);const Ue=ht.canonical.x,pt=ht.canonical.y;for(const ot of tt){const Et=pe.getTile(ke?ot.wrapped():ot);if(!Et)continue;const $t=Et.rasterParticleState;if(!$t)continue;const rn=ot.canonical.x+(1<<ot.canonical.z)*(ot.wrap-ht.wrap),Lt=ot.canonical.y;$t.particleTexture0.bind(Ce.NEAREST,Ce.CLAMP_TO_EDGE);const Rt=Li(1,$t.particleTexture0.size[0],[rn-Ue,Lt-pt],0,et.texture.size,2,nt,et.textureOffset,et.scale,et.offset);jt.draw(he,Ce.POINTS,sn.disabled,Dn.disabled,ti.alphaBlended,jn.disabled,Rt,Ie.id,$t.particleIndexBuffer,void 0,$t.particleSegment)}}}(S,E,k,ne),z.bindFramebuffer.set(k.particleFramebuffer.framebuffer),function(he,pe,Ie,Se){const Ae=he.context,Ce=Ae.gl,we=pe.paint.get("raster-particle-max-speed"),ke=Se*pe.paint.get("raster-particle-speed-factor")*.15,nt=function(ht){return Math.pow(ht,6)}(.01+1*pe.paint.get("raster-particle-reset-rate-factor")),Ke=pe.particleFramebuffer;Ae.viewport.set([0,0,Ke.width,Ke.height]);for(const ht of Ie){const[,et,ut]=ht;Ae.activeTexture.set(Ce.TEXTURE0+0),et.texture.bind(Ce.LINEAR,Ce.CLAMP_TO_EDGE),Ae.activeTexture.set(Ce.TEXTURE0+1);const jt=ut.particleTexture0;jt.bind(Ce.NEAREST,Ce.CLAMP_TO_EDGE);const tt=Wi(1,jt.size[0],0,et.texture.size,we,ke,nt,et.textureOffset,et.scale,et.offset);Ke.colorAttachment.set(ut.particleTexture1.texture),Ae.clear({color:o.ao.transparent}),he.getOrCreateProgram("rasterParticleUpdate",{defines:et.defines}).draw(he,Ce.TRIANGLES,sn.disabled,Dn.disabled,ti.unblended,jn.disabled,tt,pe.id,he.viewportBuffer,he.quadTriangleIndexBuffer,he.viewportSegments)}}(S,k,ne,re)}(g,s,d,m),g.renderPass==="translucent"&&(function(S,E,k,O,z){const U=S.context,F=U.gl,H=E.getSource().tileSize,G=5*(1-o.ah(o.cK,o.cK+1,S.transform.zoom))*H+k.paint.get("raster-particle-elevation"),W=!S.options.moving,ne=S.transform.projection.name==="globe";if(!O.length)return;const[X,re]=S.stencilConfigForOverlap(O),he=[];ne&&he.push("PROJECTION_GLOBE_VIEW");const pe=S.stencilModeFor3D();for(const Ie of re){const Se=Ie.toUnwrapped(),Ae=E.getTile(Ie);if(!Ae.rasterParticleState)continue;const Ce=Ae.rasterParticleState,we=100;Ae.registerFadeDuration(we);const ke=E.findLoadedParent(Ie,0),nt=iu(Ae,ke,E,S.transform,we);let Ke,ht;S.terrain&&S.terrain.prepareDrawTile(),U.activeTexture.set(F.TEXTURE0),Ce.targetColorTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),U.activeTexture.set(F.TEXTURE1),ke&&ke.rasterParticleState?(ke.rasterParticleState.targetColorTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),Ke=Math.pow(2,ke.tileID.overscaledZ-Ae.tileID.overscaledZ),ht=[Ae.tileID.canonical.x*Ke%1,Ae.tileID.canonical.y*Ke%1]):Ce.targetColorTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE);const et=ne?Float32Array.from(S.transform.expandedFarZProjMatrix):S.transform.calculateProjMatrix(Se,W),ut=S.transform,jt=Sc(ut),tt=o.dC(Ie.canonical),Ue=o.dD(tt.getCenter().lat);let pt,ot,Et,$t,rn;ne?(pt=Float32Array.from(o.bk(o.dF(Ie.canonical))),ot=Float32Array.from(ut.globeMatrix),Et=Float32Array.from(o.dB(ut)),$t=[o.aF(ut.center.lng),o.aJ(ut.center.lat)],rn=Float32Array.from(o.dE(Ie.canonical,tt,Ue,ut.worldSize/ut._pixelsPerMercatorPixel))):(pt=new Float32Array(16),ot=new Float32Array(9),Et=new Float32Array(16),$t=[0,0],rn=new Float32Array(9));const Lt=Vi(et,pt,ot,Et,rn,ht||[0,0],o.aj(S.transform.zoom),$t,jt,Ke||1,nt,G),Rt=S.isTileAffectedByFog(Ie),Cn=S.getOrCreateProgram("rasterParticle",{defines:he,overrideFog:Rt});if(S.uploadCommonUniforms(U,Cn,Se),ne){const yn=new sn(F.LEQUAL,sn.ReadOnly,S.depthRangeFor3D),wn=0,gn=S.globeSharedBuffers;if(gn){const[Wn,ri,ci]=gn.getGridBuffers(Ue,wn!==0);Cn.draw(S,F.TRIANGLES,yn,pe,ti.alphaBlended,S.renderElevatedRasterBackface?jn.frontCCW:jn.backCCW,Lt,k.id,Wn,ri,ci)}}else{const yn=S.depthModeForSublayer(0,sn.ReadOnly),wn=X[Ie.overscaledZ],{tileBoundsBuffer:gn,tileBoundsIndexBuffer:Wn,tileBoundsSegments:ri}=S.getTileBoundsBuffers(Ae);Cn.draw(S,F.TRIANGLES,yn,wn,ti.alphaBlended,jn.disabled,Lt,k.id,gn,Wn,ri)}}S.resetStencilClippingMasks()}(g,s,d,m),g.style.map.triggerRepaint())},background:function(g,s,d,m){const v=d.paint.get("background-color"),b=d.paint.get("background-color-use-theme").constantOr("default")==="none",S=d.paint.get("background-opacity"),E=d.paint.get("background-emissive-strength"),k=d.paint.get("background-pitch-alignment")==="viewport";if(S===0)return;const O=g.context,z=O.gl,U=g.transform,F=U.tileSize,H=d.paint.get("background-pattern");let G;if(H!==void 0&&(H===null||(G=g.imageManager.getPattern(o.I.from(H.toString()),d.scope,g.style.getLut(d.scope)),!G)))return;const W=!H&&v.a===1&&S===1&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==W)return;const ne=Dn.disabled,X=g.depthModeForSublayer(0,W==="opaque"?sn.ReadWrite:sn.ReadOnly),re=g.colorModeForDrapableLayerRenderPass(E),he=H?"backgroundPattern":"background";let pe,Ie=m;if(Ie||(pe=g.getBackgroundTiles(),Ie=Object.values(pe).map(Se=>Se.tileID)),H&&(O.activeTexture.set(z.TEXTURE0),g.imageManager.bind(g.context,d.scope)),k){const Se=g.getOrCreateProgram(he,{overrideFog:!1,overrideRtt:!0}),Ae=new Float32Array(o.bA([])),Ce=new o.aO(0,0,0,0,0),we=H?po(Ae,E,S,g,0,d.scope,G,k,{tileID:Ce,tileSize:F}):io(Ae,E,S,v.toPremultipliedRenderColor(b?null:d.lut));Se.draw(g,z.TRIANGLES,X,ne,re,jn.disabled,we,d.id,g.viewportBuffer,g.quadTriangleIndexBuffer,g.viewportSegments)}else for(const Se of Ie){const Ae=g.isTileAffectedByFog(Se),Ce=g.getOrCreateProgram(he,{overrideFog:Ae}),we=Se.toUnwrapped(),ke=m?Se.projMatrix:g.transform.calculateProjMatrix(we);g.prepareDrawTile();const nt=s?s.getTile(Se):pe?pe[Se.key]:new Ja(Se,F,U.zoom,g),Ke=H?po(ke,E,S,g,0,d.scope,G,k,{tileID:Se,tileSize:F}):io(ke,E,S,v.toPremultipliedRenderColor(b?null:d.lut));g.uploadCommonUniforms(O,Ce,we);const{tileBoundsBuffer:ht,tileBoundsIndexBuffer:et,tileBoundsSegments:ut}=g.getTileBoundsBuffers(nt);Ce.draw(g,z.TRIANGLES,X,ne,re,jn.disabled,Ke,d.id,ht,et,ut)}},sky:function(g,s,d){const m=g._atmosphere?o.aj(g.transform.zoom):1,v=d.paint.get("sky-opacity")*m;if(v===0)return;const b=g.context,S=d.paint.get("sky-type"),E=new sn(b.gl.LEQUAL,sn.ReadOnly,[0,1]),k=g.frameCounter/1e3%1;S==="atmosphere"?g.renderPass==="offscreen"?d.needsSkyboxCapture(g)&&(function(O,z,U,F){const H=O.context,G=H.gl;let W=z.skyboxFbo;if(!W){W=z.skyboxFbo=H.createFramebuffer(32,32,!0,null),z.skyboxGeometry=new Dy(H),z.skyboxTexture=H.gl.createTexture(),G.bindTexture(G.TEXTURE_CUBE_MAP,z.skyboxTexture),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_WRAP_S,G.CLAMP_TO_EDGE),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_WRAP_T,G.CLAMP_TO_EDGE),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_MIN_FILTER,G.LINEAR),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_MAG_FILTER,G.LINEAR);for(let he=0;he<6;++he)G.texImage2D(G.TEXTURE_CUBE_MAP_POSITIVE_X+he,0,G.RGBA,32,32,0,G.RGBA,G.UNSIGNED_BYTE,null)}H.bindFramebuffer.set(W.framebuffer),H.viewport.set([0,0,32,32]);const ne=z.getCenter(O,!0),X=O.getOrCreateProgram("skyboxCapture"),re=new Float64Array(16);o.bA(re),o.ek(re,re,.5*-Math.PI),Ch(O,z,X,re,ne,0),o.bA(re),o.ek(re,re,.5*Math.PI),Ch(O,z,X,re,ne,1),o.bA(re),o.cT(re,re,.5*-Math.PI),Ch(O,z,X,re,ne,2),o.bA(re),o.cT(re,re,.5*Math.PI),Ch(O,z,X,re,ne,3),o.bA(re),Ch(O,z,X,re,ne,4),o.bA(re),o.ek(re,re,Math.PI),Ch(O,z,X,re,ne,5),H.viewport.set([0,0,O.width,O.height])}(g,d),d.markSkyboxValid(g)):g.renderPass==="sky"&&function(O,z,U,F,H){const G=O.context,W=G.gl,ne=O.transform,X=O.getOrCreateProgram("skybox");G.activeTexture.set(W.TEXTURE0),W.bindTexture(W.TEXTURE_CUBE_MAP,z.skyboxTexture);const re=((he,pe,Ie,Se,Ae)=>({u_matrix:he,u_sun_direction:pe,u_cubemap:0,u_opacity:Se,u_temporal_offset:Ae}))(ne.skyboxMatrix,z.getCenter(O,!1),0,F,H);O.uploadCommonUniforms(G,X),X.draw(O,W.TRIANGLES,U,Dn.disabled,O.colorModeForRenderPass(),jn.backCW,re,"skybox",z.skyboxGeometry.vertexBuffer,z.skyboxGeometry.indexBuffer,z.skyboxGeometry.segment)}(g,d,E,v,k):S==="gradient"&&g.renderPass==="sky"&&function(O,z,U,F,H){const G=O.context,W=G.gl,ne=O.transform,X=O.getOrCreateProgram("skyboxGradient");z.skyboxGeometry||(z.skyboxGeometry=new Dy(G)),G.activeTexture.set(W.TEXTURE0);let re=z.colorRampTexture;re||(re=z.colorRampTexture=new o.T(G,z.colorRamp,W.RGBA8)),re.bind(W.LINEAR,W.CLAMP_TO_EDGE);const he=((pe,Ie,Se,Ae,Ce)=>({u_matrix:pe,u_color_ramp:0,u_center_direction:Ie,u_radius:o.an(Se),u_opacity:Ae,u_temporal_offset:Ce}))(ne.skyboxMatrix,z.getCenter(O,!1),z.paint.get("sky-gradient-radius"),F,H);O.uploadCommonUniforms(G,X),X.draw(O,W.TRIANGLES,U,Dn.disabled,O.colorModeForRenderPass(),jn.backCW,he,"skyboxGradient",z.skyboxGeometry.vertexBuffer,z.skyboxGeometry.indexBuffer,z.skyboxGeometry.segment)}(g,d,E,v,k)},custom:function(g,s,d,m){const v=g.context,b=d.implementation;if(!g.transform.projection.unsupportedLayers||!g.transform.projection.unsupportedLayers.includes("custom")||g.terrain&&(g.terrain.renderingToTexture||g.renderPass==="offscreen")&&d.isDraped(s)){if(g.renderPass==="offscreen"){const S=b.prerender;if(S){if(g.setCustomLayerDefaults(),v.setColorMode(g.colorModeForRenderPass()),g.transform.projection.name==="globe"){const E=g.transform.pointMerc;S.call(b,v.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),o.aj(g.transform.zoom),[E.x,E.y],g.transform.pixelsPerMeterRatio)}else S.call(b,v.gl,g.transform.customLayerMatrix());v.setDirty(),g.setBaseState()}}else if(g.renderPass==="translucent"){if(g.terrain&&g.terrain.renderingToTexture){const E=b.renderToTile;if(E){const k=m[0].canonical,O={x:k.x+m[0].wrap*(b.wrapTileId?0:1<<k.z),y:k.y,z:k.z};v.setDepthMode(sn.disabled),v.setStencilMode(Dn.disabled),v.setColorMode(g.colorModeForRenderPass()),g.setCustomLayerDefaults(),E.call(b,v.gl,O),v.setDirty(),g.setBaseState()}return}g.setCustomLayerDefaults(),v.setColorMode(g.colorModeForRenderPass()),v.setStencilMode(Dn.disabled);const S=b.renderingMode==="3d"?new sn(g.context.gl.LEQUAL,sn.ReadWrite,g.depthRangeFor3D):g.depthModeForSublayer(0,sn.ReadOnly);if(v.setDepthMode(S),g.transform.projection.name==="globe"){const E=g.transform.pointMerc;b.render(v.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),o.aj(g.transform.zoom),[E.x,E.y],g.transform.pixelsPerMeterRatio)}else b.render(v.gl,g.transform.customLayerMatrix());v.setDirty(),g.setBaseState(),v.bindFramebuffer.set(null)}}else o.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(g,s,d,m){if(g.renderPass==="opaque")return;const v=d.paint.get("model-opacity").constantOr(1);if(v===0)return;const b=d.paint.get("model-cast-shadows");if(g.renderPass==="shadow"&&(!b||g.terrain&&v<.65&&d._transitionablePaint._values["model-opacity"].value.expression instanceof o.ad))return;const S=g.shadowRenderer,E=d.paint.get("model-receive-shadows");S&&(S.useNormalOffset=!0,E||(S.enabled=!1));const k=()=>{S&&(S.useNormalOffset=!0,E||(S.enabled=!0))},O=s.getSource();if(g.renderPass==="light-beam"&&O.type!=="batched-model")return;if(O.type==="vector"||O.type==="geojson")return function(X,re,he,pe,Ie){const Se=X.transform;if(Se.projection.name!=="mercator")return void o.w(`Drawing 3D models for ${Se.projection.name} projection is not yet implemented`);const Ae=Se.getFreeCameraOptions().position;if(!X.modelManager)return;const Ce=X.modelManager;he.modelManager=Ce;const we=X.shadowRenderer;if(!he._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const ke=he._unevaluatedLayout._values["model-id"],nt=Object.assign({},he.layout.get("model-id").parameters),Ke=X.style.order.indexOf(he.fqid);for(const ht of pe){const et=re.getTile(ht).getBucket(he);if(!et||et.projection.name!==Se.projection.name)continue;const ut=et.getModelUris();ut&&!et.modelsRequested&&(Ce.addModelsFromBucket(ut,Ie),et.modelsRequested=!0);const jt=jf(ht,Se);nt.zoom=jt;const tt=ke.possiblyEvaluate(nt);if(j0(X,et,ht),Tc.shadowUniformsInitialized=!1,Tc.useSingleShadowCascade=!!we&&we.getMaxCascadeForTile(ht.toUnwrapped())===0,X.renderPass==="shadow"&&we){if(X.currentShadowCascade===1&&et.isInsideFirstShadowMapFrustum)continue;const ot=Se.calculatePosMatrix(ht.toUnwrapped(),Se.worldSize);if(Tc.tileMatrix.set(ot),Tc.shadowTileMatrix=Float32Array.from(we.calculateShadowPassMatrixFromMatrix(ot)),Tc.aabb.min=[0,0,0],Tc.aabb.max[0]=Tc.aabb.max[1]=o.al,Tc.aabb.max[2]=0,H0(et,Tc,X,he.scope))continue}const Ue=1<<ht.canonical.z,pt=[((Ae.x-ht.wrap)*Ue-ht.canonical.x)*o.al,(Ae.y*Ue-ht.canonical.y)*o.al,Ae.z*Ue*o.al];X.conflationActive&&Object.keys(et.instancesPerModel).length>0&&X.style.isLayerClipped(he,re.getSource())&&et.updateReplacement(ht,X.replacementSource,Ke,Ie)&&(et.uploaded=!1,et.upload(X.context));for(let ot in et.instancesPerModel){const Et=et.instancesPerModel[ot];Et.features.length>0&&(ot=tt.evaluate(Et.features[0].feature,{}));const $t=Ce.getModel(ot,Ie);if($t||Ce.hasURLBeenRequested(ot)||et.modelUris.includes(ot)||(et.modelUris.push(ot),et.modelsRequested=!1),$t&&$t.uploaded)for(const rn of $t.nodes)U0(X,he,rn,Et,pt,ht,Tc)}}}(g,s,d,m,O.type==="vector"?d.scope:""),void k();if(!O.loaded())return;if(O.type==="batched-model")return function(X,re,he,pe){he.resetLayerRenderingStats(X);const Ie=X.context,Se=X.transform,Ae=X.style.fog,Ce=X.shadowRenderer;if(Se.projection.name!=="mercator")return void o.w(`Drawing 3D landmark models for ${Se.projection.name} projection is not yet implemented`);const we=X.transform.getFreeCameraOptions().position,ke=o.c4([],[we.x,we.y,we.z],X.transform.worldSize),nt=o.et([],ke),Ke=o.bA([]),ht=o.ec(Se.center.lat,Se.zoom),et=o.bq([],[1,1,1/ht]);o.br(Ke,Ke,nt);const ut=he.paint.get("model-opacity").constantOr(1),jt=new sn(Ie.gl.LEQUAL,sn.ReadWrite,X.depthRangeFor3D),tt=new sn(Ie.gl.LEQUAL,sn.ReadOnly,X.depthRangeFor3D),Ue=new o.d8([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),pt=X.renderPass==="shadow",ot=pt&&Ce?Ce.getCurrentCascadeFrustum():Se.getFrustum(Se.scaleZoom(Se.worldSize)),Et=he.paint.get("model-front-cutoff"),$t=Et[2]<1,rn=gc(X,he.paint.get("model-cutoff-fade-range")),Lt=he.getLayerRenderingStats();(function(Rt,Cn,yn,wn){const gn=Rt.terrain?Rt.terrain.exaggeration():0,Wn=Rt.transform.zoom;for(const ri of wn){const ci=Cn.getTile(ri).getBucket(yn);ci&&(ci.setFilter(yn.filter),Rt.conflationActive&&ci.updateReplacement(ri,Rt.replacementSource),ci.evaluateTransform(Rt,yn),Rt.terrain&&gn>0&&ci.elevationUpdate(Rt.terrain,gn,ri,yn.source),ci.needsReEvaluation(Rt,Wn,yn)&&ci.evaluate(yn))}})(X,re,he,pe),function(){let Rt,Cn,yn;$t?(Rt=pe.length-1,Cn=-1,yn=-1):(Rt=0,Cn=pe.length,yn=1);const wn=new Float64Array(16),gn=o.cz(),Wn=new o.P(0,0);for(let ri=Rt;ri!==Cn;ri+=yn){const ci=pe[ri],or=re.getTile(ci).getBucket(he);if(!or||!or.uploaded)continue;let Xn=!1;Ce&&(Xn=Ce.getMaxCascadeForTile(ci.toUnwrapped())===0);const ji=Se.calculatePosMatrix(ci.toUnwrapped(),Se.worldSize),rr=or.modelTraits;!pt&&$t&&(o.bl(wn,ji),o.af(gn,ke,wn),Wn.x=gn[0],Wn.y=gn[1]);const $r=[];or.setFilter(he.filter);for(const oi of or.getNodesInfo()){if(oi.hiddenByReplacement||!oi.node.meshes)continue;const Ji=oi.node;let qi=0;X.terrain&&Ji.elevation&&(qi=Ji.elevation*X.terrain.exaggeration());const er=(()=>{const Js=oi.aabb;return Ue.min=[...Js.min],Ue.max=[...Js.max],Ue.min[2]+=qi,Ue.max[2]+=qi,o.af(Ue.min,Ue.min,ji),o.af(Ue.max,Ue.max,ji),Ue})(),Wr=oi.evaluatedScale;if(Wr[0]<=1&&Wr[1]<=1&&Wr[2]<=1&&er.intersects(ot)===0)continue;if(!pt&&$t){const Js=.16666666666666666;oi.cameraCollisionOpacity=ke[0]>er.min[0]&&ke[0]<er.max[0]&&ke[1]>er.min[1]&&ke[1]<er.max[1]&&ke[2]*ht<er.max[2]&&Ji.footprint&&o.b$(Wn,Ji.footprint)?Math.max(oi.cameraCollisionOpacity-Js,0):Math.min(1,oi.cameraCollisionOpacity+Js)}const Po=[...ji],Ds=1/o.d6(ci.canonical),qr=Ji.anchor?Ji.anchor[0]:0,ui=Ji.anchor?Ji.anchor[1]:0;o.br(Po,Po,[qr*(Wr[0]-1)+oi.evaluatedTranslation[0]*Ds,ui*(Wr[1]-1)+oi.evaluatedTranslation[1]*Ds,qi+oi.evaluatedTranslation[2]]),o.cp(Wr,o.ev)||o.cR(Po,Po,Wr);const Vn=o.aB([],Po,Ji.matrix),sr=o.aB([],Se.expandedFarZProjMatrix,Vn),yo=o.aB([],Se.expandedFarZProjMatrix,Po),Yr=o.aC([],[qr,ui,qi,1],sr)[2];Ji.hidden=!1;let es=ut;pt||($t&&(es*=oi.cameraCollisionOpacity,es*=Oy(Po,Se,oi.aabb,Et)),es*=Wg(rn,Yr)),es!==0?$r.push({nodeInfo:oi,depth:Yr,opacity:es,wvpForNode:sr,wvpForTile:yo,nodeModelMatrix:Vn,tileModelMatrix:Po}):Ji.hidden=!0}pt||$r.sort((oi,Ji)=>!$t||oi.opacity===1&&Ji.opacity===1?oi.depth<Ji.depth?-1:1:oi.opacity===1?-1:Ji.opacity===1?1:oi.depth>Ji.depth?-1:1);for(const oi of $r){const Ji=oi.nodeInfo,qi=Ji.node;let er=o.aB([],et,oi.tileModelMatrix);o.aB(er,Ke,er);const Wr=o.bl([],er);o.ed(Wr,Wr),o.cR(Wr,Wr,YS),er=o.aB(er,er,qi.matrix);const Po=X.renderPass==="light-beam",Ds=he.paint.get("model-color-use-theme").constantOr("default")==="none",qr=rr&o.ez.HasMapboxMeshFeatures,ui=qr?0:Ji.evaluatedRMEA[0][2];for(let Vn=0;Vn<qi.meshes.length;++Vn){const sr=qi.meshes[Vn],yo=Vn===qi.lightMeshIndex;let Yr=oi.wvpForNode;if(yo){if(!Po&&!X.terrain&&X.shadowRenderer){X.currentLayer<X.firstLightBeamLayer&&(X.firstLightBeamLayer=X.currentLayer);continue}Yr=oi.wvpForTile}else if(Po)continue;const es={defines:[]},Js=[];if(!pt&&Ce&&(Ce.useNormalOffset=!!sr.normalBuffer),Hg(es.defines,Js,sr,X,Ds?null:he.lut),qr||es.defines.push("DIFFUSE_SHADED"),Xn&&es.defines.push("SHADOWS_SINGLE_CASCADE"),Lt&&(pt?Lt.numRenderedVerticesInShadowPass+=sr.vertexArray.length:Lt.numRenderedVerticesInTransparentPass+=sr.vertexArray.length),pt){pm(sr,oi.nodeModelMatrix,X,he);continue}let Dl=null;if(Ae){const Ac=Ye(oi.nodeModelMatrix,X.transform);if(Dl=new Float32Array(Ac),Se.projection.name!=="globe"){const To=sr.aabb.min,Mo=sr.aabb.max,[Jr,fs]=Ae.getOpacityForBounds(Ac,To[0],To[1],Mo[0],Mo[1]);es.overrideFog=Jr>=xn||fs>=xn}}const Ol=sr.material;let ol;Ol.occlusionTexture&&Ol.occlusionTexture.offsetScale&&(ol=Ol.occlusionTexture.offsetScale,es.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const sl=X.getOrCreateProgram("model",es);!pt&&Ce&&Ce.setupShadowsFromMatrix(oi.tileModelMatrix,sl,Ce.useNormalOffset),X.uploadCommonUniforms(Ie,sl,null,Dl);const Pa=Ol.pbrMetallicRoughness;Pa.metallicFactor=.9,Pa.roughnessFactor=.5;const sc=Nr(new Float32Array(Yr),new Float32Array(er),new Float32Array(Wr),new Float32Array(qi.matrix),X,oi.opacity,Pa.baseColorFactor,Ol.emissiveFactor,Pa.metallicFactor,Pa.roughnessFactor,Ol,ui,he,[0,0,0],ol);!yo&&(Ji.hasTranslucentParts||oi.opacity<1)&&sl.draw(X,Ie.gl.TRIANGLES,jt,Dn.disabled,ti.disabled,jn.backCCW,sc,he.id,sr.vertexBuffer,sr.indexBuffer,sr.segments,he.paint,X.transform.zoom,void 0,Js),sl.draw(X,Ie.gl.TRIANGLES,yo?tt:jt,Dn.disabled,yo||oi.opacity<1||Ji.hasTranslucentParts?ti.alphaBlended:ti.unblended,jn.backCCW,sc,he.id,sr.vertexBuffer,sr.indexBuffer,sr.segments,he.paint,X.transform.zoom,void 0,Js)}}}}()}(g,s,d,m),void k();if(O.type!=="model")return;const z=O.getModels(),U=[],F=g.transform.getFreeCameraOptions().position,H=o.c4([],[F.x,F.y,F.z],g.transform.worldSize);o.et(H,H);const G=[],W=[];let ne=0;for(const X of z){const re=d.paint.get("model-rotation").constantOr(null),he=d.paint.get("model-scale").constantOr(null),pe=d.paint.get("model-translation").constantOr(null);X.computeModelMatrix(g,re,he,pe,!0,!0,!1);const Ie=o.bA([]),Se=o.ec(X.position.lat,g.transform.zoom),Ae=o.bq([],[1,1,1/Se]);o.br(Ie,Ie,H),U.push({zScaleMatrix:Ae,negCameraPosMatrix:Ie});for(const Ce of X.nodes)Gg(g.transform,Ce,X.matrix,g.transform.expandedFarZProjMatrix,ne,G,W);ne++}if(G.sort((X,re)=>re.depth-X.depth),g.renderPass!=="shadow"){if(v===1)for(const X of W)Ih(X,g,d,U[X.modelIndex],Dn.disabled,g.colorModeForRenderPass());else{for(const X of W)Ih(X,g,d,U[X.modelIndex],Dn.disabled,ti.disabled);for(const X of W)Ih(X,g,d,U[X.modelIndex],g.stencilModeFor3D(),g.colorModeForRenderPass());g.resetStencilClippingMasks()}for(const X of G)Ih(X,g,d,U[X.modelIndex],Dn.disabled,g.colorModeForRenderPass());k()}else{for(const X of W)pm(X.mesh,X.nodeModelMatrix,g,d);for(const X of G)pm(X.mesh,X.nodeModelMatrix,g,d);k()}}},Ah={line:function(g,s,d){if(g.hasElevatedBuckets=!1,g.hasNonElevatedBuckets=!1,g._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||g._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(s){const m=s.getVisibleCoordinates();for(const v of m){const b=s.getTile(v).getBucket(g);if(b&&(b.elevationType!=="none"?g.hasElevatedBuckets=!0:g.hasNonElevatedBuckets=!0,g.hasElevatedBuckets&&g.hasNonElevatedBuckets))break}}}else g.hasNonElevatedBuckets=!0},model:function(g,s,d){const m=s.getSource();if(!m.loaded())return;if(m.type==="vector"||m.type==="geojson")return void(d.modelManager&&d.modelManager.upload(d,m.type==="vector"?g.scope:""));if(m.type==="batched-model"||m.type!=="model")return;const v=m.getModels();for(const b of v)b.upload(d.context)},raster:function(g,s,d){const m=s.getSource();if(!(m instanceof fa&&m.loaded()))return;const v=g.sourceLayer||m.rasterLayerIds&&m.rasterLayerIds[0];if(!v)return;const b=g.paint.get("raster-array-band")||m.getInitialBand(v);if(b==null)return;const S=s.getIds().map(E=>s.getTileByID(E));for(const E of S)E.updateNeeded(g.id,b)&&m.prepareTile(E,v,g.id,b)},"raster-particle":function(g,s,d){const m=s.getSource();if(!(m instanceof fa&&m.loaded()))return;const v=g.sourceLayer||m.rasterLayerIds&&m.rasterLayerIds[0];if(!v)return;const b=g.paint.get("raster-particle-array-band")||m.getInitialBand(v);if(b==null)return;const S=s.getIds().map(E=>s.getTileByID(E));for(const E of S)E.updateNeeded(g.id,b)&&m.prepareTile(E,v,g.id,b)}},kh={fill:Gr},Dd={fill:function(g,s,d,m){if(!d.layout||d.layout.get("fill-elevation-reference")==="none")return;const v=g.context.gl,b=new sn(v.LEQUAL,sn.ReadOnly,g.depthRangeFor3D),S=new Dn({func:v.ALWAYS,mask:255},255,255,v.KEEP,v.KEEP,v.REPLACE),E=g.transform.getFreeCameraOptions().position,k=g.getOrCreateProgram("elevatedStructuresDepthReconstruct");for(const O of m){const z=s.getTile(O),U=z.getBucket(d);if(!U)continue;const F=U.elevatedStructures;if(!F||F.depthSegments.segments[0].primitiveLength===0)continue;const H=Hs(O.toUnwrapped(),E),G=g.translatePosMatrix(O.projMatrix,z,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor")),W=ru(G,H,0,1,0);k.draw(g,v.TRIANGLES,b,S,ti.disabled,jn.disabled,W,d.id,F.vertexBuffer,F.indexBuffer,F.depthSegments,d.paint,g.transform.zoom)}}};class zy{constructor(s,d,m,v,b,S){this.context=new va(s,d),this.transform=m,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=b,this._timeStamp=o.o.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const E=["fill","line","symbol","circle","heatmap","fill-extrusion","building","raster","raster-particle","hillshade","model","background","sky"];for(const O of E)this._debugParams.enabledLayers[O]=!0;b.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),b.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),b.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),b.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),b.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),b.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const O of E)b.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],O);this.occlusionParams=new qg(b),this.setup(),this.numSublayers=Xs.maxUnderzooming+Xs.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new o.eG,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Jp(this),this._wireframeDebugCache=new W0,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const k=new o.q({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new o.T(this.context,k,s.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=v,this.worldview=S}updateTerrain(s,d){const m=!!s&&!!s.terrain&&this.transform.projection.supportsTerrain;if(!(m||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new _h(this,s));const v=this._terrain;this.transform.elevation=m?v:null,v.update(s,this.transform,d),this.transform.elevation&&!v.enabled&&(this.transform.elevation=null)}_updateFog(s){const d=s.fog;if(!d||this.transform.projection.name==="globe"||d.getOpacity(this.transform.pitch)<1||d.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[m,v]=d.getFovAdjustedRange(this.transform._fov);if(m>v)return void(this.transform.fogCullDistSq=null);const b=m+.78*(v-m);this.transform.fogCullDistSq=b*b}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(s){s&&!this._terrain&&(this._terrain=new _h(this,this.style)),this._forceTerrainMode=s}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(s,d){if(this.width=s*o.o.devicePixelRatio,this.height=d*o.o.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style.order)this.style._mergedLayers[m].resize()}setup(){const s=this.context,d=new o.bd;d.emplaceBack(0,0),d.emplaceBack(o.al,0),d.emplaceBack(0,o.al),d.emplaceBack(o.al,o.al),this.tileExtentBuffer=s.createVertexBuffer(d,o.bf.members),this.tileExtentSegments=o.bg.simpleSegment(0,0,4,2);const m=new o.bd;m.emplaceBack(0,0),m.emplaceBack(o.al,0),m.emplaceBack(0,o.al),m.emplaceBack(o.al,o.al),this.debugBuffer=s.createVertexBuffer(m,o.bf.members),this.debugSegments=o.bg.simpleSegment(0,0,4,5);const v=new o.bd;v.emplaceBack(-1,-1),v.emplaceBack(1,-1),v.emplaceBack(-1,1),v.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(v,o.bf.members),this.viewportSegments=o.bg.simpleSegment(0,0,4,2);const b=new o.b0;b.emplaceBack(0,0,0,0),b.emplaceBack(o.al,0,o.al,0),b.emplaceBack(0,o.al,0,o.al),b.emplaceBack(o.al,o.al,o.al,o.al),this.mercatorBoundsBuffer=s.createVertexBuffer(b,o.bi.members),this.mercatorBoundsSegments=o.bg.simpleSegment(0,0,4,2);const S=new o.b1;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(S);const E=new o.be;for(const O of[0,1,3,2,0])E.emplaceBack(O);this.debugIndexBuffer=s.createIndexBuffer(E),this.emptyTexture=new o.T(s,new o.q({width:1,height:1},Uint8Array.of(0,0,0,0)),s.gl.RGBA8),this.identityMat=o.bC();const k=this.context.gl;this.stencilClearMode=new Dn({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(s){return s._makeTileBoundsBuffers(this.context,this.transform.projection),s._tileBoundsBuffer?{tileBoundsBuffer:s._tileBoundsBuffer,tileBoundsIndexBuffer:s._tileBoundsIndexBuffer,tileBoundsSegments:s._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const s=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,s.TRIANGLES,sn.disabled,this.stencilClearMode,ti.disabled,jn.disabled,vc(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(s,d,m){if(!d||this.currentStencilSource===d.id||!s.isTileClipped()||!m||m.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let E=!1;for(const k of m)if(this._tileClippingMaskIDs[k.key]===void 0){E=!0;break}if(!E)return}this.currentStencilSource=d.id;const v=this.context,b=v.gl;this.nextStencilID+m.length>256&&this.clearStencil(),v.setColorMode(ti.disabled),v.setDepthMode(sn.disabled);const S=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const E of m){const k=d.getTile(E),O=this._tileClippingMaskIDs[E.key]=this.nextStencilID++,{tileBoundsBuffer:z,tileBoundsIndexBuffer:U,tileBoundsSegments:F}=this.getTileBoundsBuffers(k);S.draw(this,b.TRIANGLES,sn.disabled,new Dn({func:b.ALWAYS,mask:0},O,255,b.KEEP,b.KEEP,b.REPLACE),ti.disabled,jn.disabled,vc(E.projMatrix),"$clipping",z,U,F)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const s=this.nextStencilID++,d=this.context.gl;return new Dn({func:d.NOTEQUAL,mask:255},s,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(s){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(s);const d=this.context.gl;return new Dn({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(s){const d=this.context.gl,m=s.sort((S,E)=>E.overscaledZ-S.overscaledZ),v=m[m.length-1].overscaledZ,b=m[0].overscaledZ-v+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();const S={};for(let E=0;E<b;E++)S[E+v]=new Dn({func:d.GEQUAL,mask:255},E+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=b,[S,m]}return[{[v]:Dn.disabled},m]}colorModeForRenderPass(){const s=this.context.gl;return this._showOverdrawInspector?new ti([s.CONSTANT_COLOR,s.ONE,s.CONSTANT_COLOR,s.ONE],new o.ao(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ti.unblended:ti.alphaBlended}colorModeForDrapableLayerRenderPass(s){const d=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new ti([d.ONE,d.ONE_MINUS_SRC_ALPHA,d.CONSTANT_ALPHA,d.ONE_MINUS_SRC_ALPHA],new o.ao(0,0,0,s===void 0?0:s),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(s,d,m,v=!1){if(this.depthOcclusion)return new sn(this.context.gl.GREATER,sn.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!v)return sn.disabled;const b=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new sn(m||this.context.gl.LEQUAL,d,[b,b])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const s=this.context.gl,d=Math.ceil(this.width),m=Math.ceil(this.height),v=this.context.bindFramebuffer.get(),b=s.getParameter(s.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===d&&this.depthFBO.height===m||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),d!==0&&m!==0&&(this.depthFBO=new Qo(this.context,d,m,!1,"texture"),this.depthTexture=new o.T(this.context,{width:d,height:m,data:null},s.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(v),s.bindTexture(s.TEXTURE_2D,b),this.depthFBO&&(s.bindFramebuffer(s.READ_FRAMEBUFFER,null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),s.blitFramebuffer(0,0,d,m,0,0,d,m,s.DEPTH_BUFFER_BIT,s.NEAREST),s.bindFramebuffer(s.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((s,d)=>s+d/this._fpsHistory.length,0))}render(s,d){const m=o.o.now();this._dt=m-this._timeStamp,this._timeStamp=m,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=s.map.repaint,this.style=s,this.options=d;const v=this.style._mergedLayers,b=!(!this.terrain||!this.terrain.enabled),S=()=>this.style._getOrder(b).filter(tt=>{const Ue=v[tt];return!(Ue.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[Ue.type]});let E=S(),k=!1,O=!1,z=null;for(const tt of E){const Ue=v[tt];Ue.type==="circle"?k=!0:Ue.type==="building"?z=Ue:Ue.type==="symbol"&&(Ue.hasOcclusionOpacityProperties?O=!0:k=!0)}let U=E.map(tt=>v[tt]);const F=this.style._mergedSourceCaches;this.imageManager=s.imageManager,this.modelManager=s.modelManager,this.symbolFadeChange=s.placement.symbolFadeChange(o.o.now()),this.imageManager.beginFrame();let H=0,G=!1;for(const tt in F){const Ue=F[tt];Ue.used&&(Ue.prepare(this.context),Ue.getSource().usedInConflation&&++H)}let W=!1;for(const tt of U)tt.isHidden(this.transform.zoom)||(tt.type==="clip"&&(W=!0),this.prepareLayer(tt));const ne={},X={},re={},he={},pe={};for(const tt in F){const Ue=F[tt];ne[tt]=Ue.getVisibleCoordinates(),X[tt]=ne[tt].slice().reverse(),re[tt]=Ue.getVisibleCoordinates(!0).reverse(),he[tt]=Ue.getShadowCasterCoordinates(),pe[tt]=Ue.sortCoordinatesByDistance(ne[tt])}const Ie=tt=>{const Ue=this.style.getLayerSourceCache(tt);return Ue&&Ue.used?Ue.getSource():null};if(H||W||this._clippingActiveLastFrame){const tt=[],Ue=[];let pt=0;for(const ot of U)this.isSourceForClippingOrConflation(ot,Ie(ot))&&(tt.push(ot),Ue.push(pt)),pt++;if(tt&&(W||tt.length>1)||this._clippingActiveLastFrame){W=!1;const ot=[];for(let Et=0;Et<tt.length;Et++){const $t=tt[Et],rn=Ue[Et],Lt=this.style.getLayerSourceCache($t);if(!Lt||!Lt.used||!Lt.getSource().usedInConflation&&$t.type!=="clip"&&$t.type!=="building")continue;let Rt=o.eH,Cn=o.bZ.None;const yn=[];let wn=!0;if($t.type==="building")Rt=o.eJ;else if($t.type==="clip"){Rt=rn;for(const gn of $t.layout.get("clip-layer-types"))Cn|=gn==="model"?o.bZ.Model:gn==="symbol"?o.bZ.Symbol:o.bZ.FillExtrusion;for(const gn of $t.layout.get("clip-layer-scope"))yn.push(gn);$t.isHidden(this.transform.zoom)?wn=!1:W=!0}wn&&ot.push({layer:$t.fqid,cache:Lt,order:Rt,clipMask:Cn,clipScope:yn})}this.replacementSource.setSources(ot),G=!0}}this._clippingActiveLastFrame=W,G||this.replacementSource.clear(),this.conflationActive=G,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let tt=0;tt<U.length;tt++){const Ue=U[tt],pt=Ue.cutoffRange();if(this.longestCutoffRange=Math.max(pt,this.longestCutoffRange),pt>0){const ot=Ie(Ue);ot&&(this.minCutoffZoom=Math.max(ot.minzoom,this.minCutoffZoom)),Ue.minzoom&&(this.minCutoffZoom=Math.max(Ue.minzoom,this.minCutoffZoom))}Ue.is3D(b)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=tt),this._lastOcclusionLayer=tt)}const Se=this.style&&this.style.fog;Se?(this._fogVisible=Se.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Se.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(re),this.opaquePassCutoff=0,E=S(),U=E.map(tt=>v[tt]));const Ae=this._shadowRenderer;if(Ae){Ae.updateShadowParameters(this.transform,this.style.directionalLight);for(const tt in F)for(const Ue of ne[tt]){let pt={min:0,max:0};this.terrain&&(pt=this.terrain.getMinMaxForTile(Ue)||pt),Ae.addShadowReceiver(Ue.toUnwrapped(),pt.min,pt.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new o.eI(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new $f(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const Ce=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),we=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Ce&&!this._snow&&(this._snow=new X0(this)),!Ce&&this._snow&&(this._snow.destroy(),delete this._snow),we&&!this._rain&&(this._rain=new Vr(this)),!we&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),z){this.buildingTileBorderManager||(this.buildingTileBorderManager=new _o);const tt=this.style.getLayerSourceCache(z);this.buildingTileBorderManager.updateBorders(tt,z)}if(!dr.has(this.context.gl))return;this.renderPass="offscreen";for(const tt of U){const Ue=s.getLayerSourceCache(tt);if(!tt.hasOffscreenPass()||tt.isHidden(this.transform.zoom))continue;const pt=Ue?X[Ue.id]:void 0;(tt.type==="custom"||tt.type==="raster"||tt.type==="raster-particle"||tt.isSky()||pt&&pt.length)&&this.renderLayer(this,Ue,tt,pt)}this.depthRangeFor3D=[0,1-(U.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,he)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const ke=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),nt=(()=>{if(d.showOverdrawInspector)return o.ao.black;const tt=this.style.fog;if(tt&&this.transform.projection.supportsFog){const Ue=this.style.getLut(tt.scope);if(!ke){const pt=tt.properties.get("color-use-theme")==="none",ot=tt.properties.get("color").toNonPremultipliedRenderColor(pt?null:Ue).toArray01();return new o.ao(...ot)}if(ke){const pt=tt.properties.get("space-color-use-theme")==="none",ot=tt.properties.get("space-color").toNonPremultipliedRenderColor(pt?null:Ue).toArray01();return new o.ao(...ot)}}return o.ao.transparent})();if(this.context.clear({color:nt,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&ke&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=E.length-1;this.currentLayer>=0;this.currentLayer--){const tt=U[this.currentLayer],Ue=s.getLayerSourceCache(tt);if(tt.isSky())continue;const pt=Ue?(tt.is3D(b)?pe:X)[Ue.id]:void 0;this._renderTileClippingMasks(tt,Ue,pt),this.renderLayer(this,Ue,tt,pt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&ke&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||o.aj(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<E.length;this.currentLayer++){const tt=U[this.currentLayer],Ue=s.getLayerSourceCache(tt);tt.isSky()&&this.renderLayer(this,Ue,tt,Ue?X[Ue.id]:void 0)}function Ke(tt,Ue){let pt;return Ue&&(pt=(tt.type==="symbol"?re:tt.is3D(b)?pe:X)[Ue.id]),pt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<E.length;){const tt=U[this.currentLayer];if(tt.type==="raster"||tt.type==="raster-particle"){const Ue=s.getLayerSourceCache(tt);this.renderLayer(this,Ue,tt,Ke(tt,Ue))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let ht=0;Ae&&(ht=Ae.getShadowCastingLayerCount());let et=!1,ut=-1;for(let tt=0;tt<E.length;++tt){const Ue=U[tt];Ue.isHidden(this.transform.zoom)||Ue.is3D(b)&&(ut=tt)}O&&ut===-1&&(k=!0);let jt=!1;for(;this.currentLayer<E.length;){const tt=U[this.currentLayer],Ue=s.getLayerSourceCache(tt);if(tt.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(tt)){if(tt.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!jt&&tt.is3D(b)&&!b){const pt=this.currentLayer,ot=Et=>{for(this.currentLayer=0;this.currentLayer<U.length;this.currentLayer++){const $t=U[this.currentLayer];if(kh[$t.type]){const rn=this.style.getLayerSourceCache($t);kh[$t.type](this,rn,$t,Ke($t,rn),Et)}}};ot("initialize"),ot("reset"),this.currentLayer=pt,jt=!0}if(k&&!et&&this.terrain&&!this.transform.isOrthographic&&(et=!0,this.blitDepth()),O&&ut!==-1&&this.currentLayer===ut+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(tt,Ue,Ue?ne[Ue.id]:void 0),this.renderLayer(this,Ue,tt,Ke(tt,Ue)),!this.terrain&&Ae&&ht>0&&tt.hasShadowPass()&&--ht==0){{this.clearStencil(),this.resetStencilClippingMasks();const pt=this.currentLayer;for(this.currentLayer=0;this.currentLayer<U.length;this.currentLayer++){const ot=U[this.currentLayer];if(Dd[ot.type]){const Et=this.style.getLayerSourceCache(ot);Dd[ot.type](this,Et,ot,Ke(ot,Et))}}this.currentLayer=pt}if(Ae.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer){const pt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=pt;this.currentLayer++){const ot=U[this.currentLayer];if(!ot.hasLightBeamPass())continue;const Et=s.getLayerSourceCache(ot);this.renderLayer(this,Et,ot,Et?X[Et.id]:void 0)}this.currentLayer=pt,this.renderPass="translucent"}}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const pt=this.currentLayer;this.depthOcclusion=!0;for(const ot of this.layersWithOcclusionOpacity){this.currentLayer=ot;const Et=U[this.currentLayer],$t=s.getLayerSourceCache(Et),rn=$t?X[$t.id]:void 0;this.terrain||this._renderTileClippingMasks(Et,$t,$t?ne[$t.id]:void 0),this.renderLayer(this,$t,Et,rn)}this.depthOcclusion=!1,this.currentLayer=pt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let tt=null;U.forEach(Ue=>{const pt=s.getLayerSourceCache(Ue);pt&&!Ue.isHidden(this.transform.zoom)&&pt.getVisibleCoordinates().length&&(!tt||tt.getSource().maxzoom<pt.getSource().maxzoom)&&(tt=pt)}),tt&&this.options.showTileBoundaries&&wh(this,tt,tt.getVisibleCoordinates(),o.ao.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&wh(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new o.ao(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(tt){const Ue=tt.transform.padding;Pl(tt,tt.transform.height-(Ue.top||0),3,Gs),Pl(tt,Ue.bottom||0,3,Cc),Tr(tt,Ue.left||0,3,hm),Tr(tt,tt.transform.width-(Ue.right||0),3,xh);const pt=tt.transform.centerPoint;(function(ot,Et,$t,rn){$u(ot,Et-1,$t-10,2,20,rn),$u(ot,Et-10,$t-1,20,2,rn)})(tt,pt.x,tt.transform.height-pt.y,Vf)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),G||(this.conflationActive=!1)}prepareLayer(s){this.gpuTimingStart(s);const{unsupportedLayers:d}=this.transform.projection,m=!d||!d.includes(s.type);if(Ah[s.type]&&(m||this.terrain&&s.type==="custom")){const v=this.style.getLayerSourceCache(s);Ah[s.type](s,v,this)}this.gpuTimingEnd()}renderLayer(s,d,m,v){m.isHidden(this.transform.zoom)||(m.type==="background"||m.type==="sky"||m.type==="custom"||m.type==="model"||m.type==="raster"||m.type==="raster-particle"||v&&v.length)&&(this.id=m.id,this.gpuTimingStart(m),s.transform.projection.unsupportedLayers&&s.transform.projection.unsupportedLayers.includes(m.type)&&(!s.terrain||m.type!=="custom")||m.type==="clip"||Md[m.type](s,d,m,v,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(s){if(!this.options.gpuTiming)return;const d=this.context.extTimerQuery,m=this.context.gl;let v=this.gpuTimers[s.id];v||(v=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:m.createQuery()}),v.calls++,m.beginQuery(d.TIME_ELAPSED_EXT,v.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const s=this.context.extTimerQuery,d=this.context.gl,m=d.createQuery();this.deferredRenderGpuTimeQueries.push(m),d.beginQuery(s.TIME_ELAPSED_EXT,m)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const s=this.gpuTimers;return this.gpuTimers={},s}collectDeferredRenderGpuQueries(){const s=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],s}queryGpuTimers(s){const d={};for(const m in s){const v=s[m],b=this.context.extTimerQuery,S=b.getQueryParameter(v.query,this.context.gl.QUERY_RESULT)/1e6;b.deleteQueryEXT(v.query),d[m]=S}return d}queryGpuTimeDeferredRender(s){if(!this.options.gpuTimingDeferredRender)return 0;const d=this.context.gl;let m=0;for(const v of s)m+=d.getQueryParameter(v,d.QUERY_RESULT)/1e6,d.deleteQuery(v);return m}translatePosMatrix(s,d,m,v,b){if(!m[0]&&!m[1])return s;const S=b?v==="map"?this.transform.angle:0:v==="viewport"?-this.transform.angle:0;if(S){const O=Math.sin(S),z=Math.cos(S);m=[m[0]*z-m[1]*O,m[0]*O+m[1]*z]}const E=[b?m[0]:o.ay(d,m[0],this.transform.zoom),b?m[1]:o.ay(d,m[1],this.transform.zoom),0],k=new Float32Array(16);return o.br(k,s,E),k}saveTileTexture(s){if(s.context!==this.context)return;const d=s.size[0],m=this._tileTextures[d];m?m.push(s):this._tileTextures[d]=[s]}getTileTexture(s){const d=this._tileTextures[s];return d&&d.length>0?d.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(s,d,m){const v=m===void 0?this.terrain&&this.terrain.renderingToTexture:m,b=[];return this.style&&this.style.enable3dLights()&&(s==="globeRaster"||s==="terrainRaster"?(b.push("LIGHTING_3D_MODE"),b.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):v||b.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||b.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(b.push("TERRAIN"),this.linearFloatFilteringSupported()&&b.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&b.push("GLOBE"),!this._fogVisible||v||d!==void 0&&!d||b.push("FOG","FOG_DITHERING"),v&&b.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&b.push("OVERDRAW_INSPECTOR"),b}getOrCreateProgram(s,d){this.cache=this.cache||{};const m=d&&d.defines||[],v=d&&d.config,b=this.currentGlobalDefines(s,d&&d.overrideFog,d&&d.overrideRtt).concat(m),S=zf.cacheKey(Sf[s],s,b,v);return this.cache[S]||(this.cache[S]=new zf(this.context,s,Sf[s],v,Dr[s],b)),this.cache[S]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(s,d){if(this.style.enable3dLights()){const m=this.style.directionalLight,v=this.style.ambientLight;if(m&&v){const b=((S,E,k)=>{const O=S.properties.get("direction"),z=S.properties.get("color-use-theme")==="none",U=S.properties.get("color").toNonPremultipliedRenderColor(z?null:k.getLut(S.scope)).toArray01(),F=S.properties.get("intensity"),H=E.properties.get("color-use-theme")==="none",G=E.properties.get("color").toNonPremultipliedRenderColor(H?null:k.getLut(E.scope)).toArray01(),W=E.properties.get("intensity"),ne=[O.x,O.y,O.z],X=o.dK(G,W),re=o.dK(U,F);return{u_lighting_ambient_color:X,u_lighting_directional_dir:ne,u_lighting_directional_color:re,u_ground_radiance:nc(ne,re,X)}})(m,v,this.style);d.setLightsUniformValues(s,b)}}}uploadCommonUniforms(s,d,m,v,b){if(this.uploadCommonLightUniforms(s,d),this.terrain&&this.terrain.renderingToTexture)return;const S=this.style.fog;if(S){const E=S.getOpacity(this.transform.pitch),k=((O,z,U,F,H,G,W,ne,X,re,he,pe)=>{const Ie=O.transform,Se=z.properties.get("color-use-theme")==="none",Ae=z.properties.get("color").toNonPremultipliedRenderColor(Se?null:O.style.getLut(z.scope)).toArray01();Ae[3]=F;const Ce=O.frameCounter/1e3%1,[we,ke]=z.properties.get("vertical-range");return{u_fog_matrix:U?Ie.calculateFogTileMatrix(U):pe||O.identityMat,u_fog_range:z.getFovAdjustedRange(Ie._fov),u_fog_color:Ae,u_fog_horizon_blend:z.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(we,ke),ke],u_fog_temporal_offset:Ce,u_frustum_tl:H,u_frustum_tr:G,u_frustum_br:W,u_frustum_bl:ne,u_globe_pos:X,u_globe_radius:re,u_viewport:he,u_globe_transition:o.aj(Ie.zoom),u_is_globe:+(Ie.projection.name==="globe")}})(this,S,m,E,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*o.o.devicePixelRatio,this.transform.height*o.o.devicePixelRatio],v);d.setFogUniformValues(s,k)}b&&d.setCutoffUniformValues(s,b.uniformValues)}setTileLoadedFlag(s){this.tileLoaded=s}saveCanvasCopy(){const s=this.canvasCopy();s&&(this.frameCopies.push(s),this.tileLoaded=!1)}canvasCopy(){const s=this.context.gl,d=s.createTexture();return s.bindTexture(s.TEXTURE_2D,d),s.copyTexImage2D(s.TEXTURE_2D,0,s.RGBA,0,0,s.drawingBufferWidth,s.drawingBufferHeight,0),d}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const s=this.style&&this.style.fog;return!!s&&s.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const s=this._backgroundTiles,d=this._backgroundTiles={},m=this.transform.coveringTiles({tileSize:512});for(const v of m)d[v.key]=s[v.key]||new Ja(v,512,this.transform.tileZoom,this,void 0,this.worldview);return d}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(s,d){return!(!s.is3D(!(!this.terrain||!this.terrain.enabled))||s.type!=="clip"&&s.type!=="building"&&(s.minzoom&&s.minzoom>this.transform.zoom||(this.style._clipLayerPresent||s.sourceLayer!=="building"&&s.sourceLayer!=="procedural_buildings")&&(!d||d.type!=="batched-model")))}isTileAffectedByFog(s){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let d=this._cachedTileFogOpacities[s.key];return d||(this._cachedTileFogOpacities[s.key]=d=this.style.fog.getOpacityForTile(s)),d[0]>=xn||d[1]>=xn}setupDepthForOcclusion(s,d,m){const v=this.context,b=v.gl,S=!!m;var E;m||(m={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),v.activeTexture.set(b.TEXTURE3),s&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),m.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],m.u_depth_range_unpack=[2/((E=this.depthRangeFor3D)[1]-E[0]),-1-2*E[0]/(E[1]-E[0])],m.u_occluder_half_size=.5*this.occlusionParams.occluderSize,m.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),v.activeTexture.set(b.TEXTURE0),S||d.setTerrainUniformValues(v,m)}}function Zg(g,s){let d=!1,m=null;const v=()=>{m=null,d&&(g(),m=setTimeout(v,s),d=!1)};return()=>(d=!0,m||v(),m)}class By{constructor(s){this._hashName=s&&encodeURIComponent(s),o.aY(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Zg(this._updateHashUnthrottled.bind(this),300)}addTo(s){return this._map=s,window.addEventListener("hashchange",this._onHashChange,!1),s.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const s=this._map;if(!s)return"";const d=Kg(s);if(this._hashName){const m=this._hashName;let v=!1;const b=location.hash.slice(1).split("&").map(S=>{const E=S.split("=")[0];return E===m?(v=!0,`${E}=${d}`):S}).filter(S=>S);return v||b.push(`${m}=${d}`),`#${b.join("&")}`}return`#${d}`}_getCurrentHash(){const s=location.hash.replace("#","");if(this._hashName){let d;return s.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(d=m)}),(d&&d[1]||"").split("/")}return s.split("/")}_onHashChange(){const s=this._map;if(!s)return!1;const d=this._getCurrentHash();if(d.length>=3&&!d.some(m=>isNaN(Number(m)))){const m=s.dragRotate.isEnabled()&&s.touchZoomRotate.isEnabled()?+(d[3]||0):s.getBearing();return s.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:m,pitch:+(d[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Kg(g,s){const d=g.getCenter(),m=Math.round(100*g.getZoom())/100,v=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,v),S=Math.round(d.lng*b)/b,E=Math.round(d.lat*b)/b,k=g.getBearing(),O=g.getPitch();let z=s?`/${S}/${E}/${m}`:`${m}/${E}/${S}`;return(k||O)&&(z+="/"+Math.round(10*k)/10),O&&(z+=`/${Math.round(O)}`),z}const Ga={linearity:.3,easing:o.eK(0,0,.3,1)},Od=Object.assign({deceleration:2500,maxSpeed:1400},Ga),Gf=Object.assign({deceleration:20,maxSpeed:1400},Ga),Xg=Object.assign({deceleration:1e3,maxSpeed:360},Ga),Fy=Object.assign({deceleration:1e3,maxSpeed:90},Ga);class Ny{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.o.now(),settings:s})}_drainInertiaBuffer(){const s=this._inertiaBuffer,d=o.o.now();for(;s.length>0&&d-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const d={zoom:0,bearing:0,pitch:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:b}of this._inertiaBuffer)d.zoom+=b.zoomDelta||0,d.bearing+=b.bearingDelta||0,d.pitch+=b.pitchDelta||0,b.panDelta&&d.pan._add(b.panDelta),b.around&&(d.around=b.around),b.pinchAround&&(d.pinchAround=b.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(d.pan.mag()){const b=Wf(d.pan.mag(),m,Object.assign({},Od,s||{}));v.offset=d.pan.mult(b.amount/d.pan.mag()),v.center=this._map.transform.center,Ec(v,b)}if(d.zoom){const b=Wf(d.zoom,m,Gf);v.zoom=this._map.transform.zoom+b.amount,Ec(v,b)}if(d.bearing){const b=Wf(d.bearing,m,Xg);v.bearing=this._map.transform.bearing+o.aA(b.amount,-179,179),Ec(v,b)}if(d.pitch){const b=Wf(d.pitch,m,Fy);v.pitch=this._map.transform.pitch+b.amount,Ec(v,b)}if(v.zoom||v.bearing){const b=d.pinchAround===void 0?d.around:d.pinchAround;v.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),v.noMoveStart=!0,v}}function Ec(g,s){(!g.duration||g.duration<s.duration)&&(g.duration=s.duration,g.easing=s.easing)}function Wf(g,s,d){const{maxSpeed:m,linearity:v,deceleration:b}=d,S=o.aA(g*v/(s/1e3),-m,m),E=Math.abs(S)/(b*v);return{easing:d.easing,duration:1e3*E,amount:S*(E/2)}}class hs extends o.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,d,m,v={}){const b=de(d.getCanvasContainer(),m),S=d.unproject(b);super(s,Object.assign({point:b,lngLat:S,originalEvent:m},v)),this._defaultPrevented=!1,this.target=d}}class qf extends o.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,d,m){const v=s==="touchend"?m.changedTouches:m.touches,b=Ee(d.getCanvasContainer(),v),S=b.map(k=>d.unproject(k)),E=b.reduce((k,O,z,U)=>k.add(O.div(U.length)),new o.P(0,0));super(s,{points:b,point:E,lngLats:S,lngLat:d.unproject(E),originalEvent:m}),this._defaultPrevented=!1}}class Yg extends o.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,d){super("wheel",{originalEvent:d}),this._defaultPrevented=!1}}class Vy{constructor(s,d){this._map=s,this._clickTolerance=d.clickTolerance}reset(){this._mousedownPos=void 0}wheel(s){return this._firePreventable(new Yg(this._map,s))}mousedown(s,d){return this._mousedownPos=d,this._firePreventable(new hs(s.type,this._map,s))}mouseup(s){this._map.fire(new hs(s.type,this._map,s))}preclick(s){const d=new MouseEvent("preclick",s);this._map.fire(new hs(d.type,this._map,d))}click(s,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||(this.preclick(s),this._map.fire(new hs(s.type,this._map,s)))}dblclick(s){return this._firePreventable(new hs(s.type,this._map,s))}mouseover(s){this._map.fire(new hs(s.type,this._map,s))}mouseout(s){this._map.fire(new hs(s.type,this._map,s))}touchstart(s){return this._firePreventable(new qf(s.type,this._map,s))}touchmove(s){this._map.fire(new qf(s.type,this._map,s))}touchend(s){this._map.fire(new qf(s.type,this._map,s))}touchcancel(s){this._map.fire(new qf(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class $y{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(s){this._map.fire(new hs(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new hs("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._map.fire(new hs(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class bs{constructor(s,d){this._map=s,this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,d){this.isEnabled()&&s.shiftKey&&s.button===0&&(xe(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(s,d){if(!this._active)return;const m=d,v=this._startPos,b=this._lastPos;if(!v||!b||b.equals(m)||!this._box&&m.dist(v)<this._clickTolerance)return;this._lastPos=m,this._box||(this._box=Q("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));const S=Math.min(v.x,m.x),E=Math.max(v.x,m.x),k=Math.min(v.y,m.y),O=Math.max(v.y,m.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${S}px,${k}px)`,this._box.style.width=E-S+"px",this._box.style.height=O-k+"px")})}mouseupWindow(s,d){if(!this._active)return;const m=this._startPos,v=d;if(m&&s.button===0){if(this.reset(),oe(),m.x!==v.x||m.y!==v.y)return this._map.fire(new o.z("boxzoomend",{originalEvent:s})),{cameraAnimation:b=>b.fitScreenCoordinates(m,v,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",s)}}keydown(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),je(),delete this._startPos,delete this._lastPos}_fireEvent(s,d){return this._map.fire(new o.z(s,{originalEvent:d}))}}function gm(g,s){const d={};for(let m=0;m<g.length;m++)d[g[m].identifier]=s[m];return d}class jy{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(s,d,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=s.timeStamp),m.length===this.numTouches&&(this.centroid=function(v){const b=new o.P(0,0);for(const S of v)b._add(S);return b.div(v.length)}(d),this.touches=gm(m,d)))}touchmove(s,d,m){if(this.aborted||!this.centroid)return;const v=gm(m,d);for(const b in this.touches){const S=v[b];(!S||S.dist(this.touches[b])>30)&&(this.aborted=!0)}}touchend(s,d,m){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),m.length===0){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class _m{constructor(s){this.singleTap=new jy(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(s,d,m){this.singleTap.touchstart(s,d,m)}touchmove(s,d,m){this.singleTap.touchmove(s,d,m)}touchend(s,d,m){const v=this.singleTap.touchend(s,d,m);if(v){const b=s.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(v)<30;if(b&&S||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class Rh{constructor(){this._zoomIn=new _m({numTouches:1,numTaps:2}),this._zoomOut=new _m({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,d,m){this._zoomIn.touchstart(s,d,m),this._zoomOut.touchstart(s,d,m)}touchmove(s,d,m){this._zoomIn.touchmove(s,d,m),this._zoomOut.touchmove(s,d,m)}touchend(s,d,m){const v=this._zoomIn.touchend(s,d,m),b=this._zoomOut.touchend(s,d,m);return v?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(v)},{originalEvent:s})}):b?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(b)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Uy={0:1,2:2},Jg={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class ym{constructor(s){this.reset(),this._clickTolerance=s.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(s,d){return!1}_move(s,d){return{}}mousedown(s,d){if(this._lastPoint)return;const m=$e(s);this._correctButton(s,m)&&(this._lastPoint=d,this._eventButton=m)}mousemoveWindow(s,d){const m=this._lastPoint;if(m){if(s.preventDefault(),this._eventButton!=null&&function(v,b){const S=Uy[b];return v.buttons===void 0||(v.buttons&S)!==S}(s,this._eventButton))this.reset();else if(this._moved||!(d.dist(m)<this._clickTolerance))return this._moved=!0,this._lastPoint=d,this._move(m,d)}}mouseupWindow(s){this._lastPoint&&$e(s)===this._eventButton&&(this._moved&&oe(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Zf extends ym{mousedown(s,d){super.mousedown(s,d),this._lastPoint&&(this._active=!0)}_correctButton(s,d){return d===0&&!s.ctrlKey}_move(s,d){return{around:d,panDelta:d.sub(s)}}}class Qg extends ym{constructor(s){super(s),this._pitchRotateKey=s.pitchRotateKey?Jg[s.pitchRotateKey]:void 0}_correctButton(s,d){return this._pitchRotateKey?d===0&&s[this._pitchRotateKey]:d===0&&s.ctrlKey||d===2}_move(s,d){const m=.8*(d.x-s.x);if(m)return this._active=!0,{bearingDelta:m}}contextmenu(s){this._pitchRotateKey||s.preventDefault()}}class e_ extends ym{constructor(s){super(s),this._pitchRotateKey=s.pitchRotateKey?Jg[s.pitchRotateKey]:void 0}_correctButton(s,d){return this._pitchRotateKey?d===0&&s[this._pitchRotateKey]:d===0&&s.ctrlKey||d===2}_move(s,d){const m=-.5*(d.y-s.y);if(m)return this._active=!0,{pitchDelta:m}}contextmenu(s){this._pitchRotateKey||s.preventDefault()}}class Hy{constructor(s,d){this._map=s,this._el=s.getCanvasContainer(),this._minTouches=1,this._clickTolerance=d.clickTolerance||1,this.reset(),o.aY(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}touchstart(s,d,m){return this._calculateTransform(s,d,m)}touchmove(s,d,m){if(this._active&&!(m.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(m.length===1&&!o.eL())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return s.cancelable&&s.preventDefault(),this._calculateTransform(s,d,m)}}touchend(s,d,m){this._calculateTransform(s,d,m),this._active&&m.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,d,m){m.length>0&&(this._active=!0);const v=gm(m,d),b=new o.P(0,0),S=new o.P(0,0);let E=0;for(const O in v){const z=v[O],U=this._touches[O];U&&(b._add(z),S._add(z.sub(U)),E++,v[O]=z)}if(this._touches=v,E<this._minTouches||!S.mag())return;const k=S.div(E);return this._sum._add(k),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(E),panDelta:k}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Q("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Kf{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(s){}_move(s,d,m){return{}}touchstart(s,d,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([d[0],d[1]]))}touchmove(s,d,m){const v=this._firstTwoTouches;if(!v)return;s.preventDefault();const[b,S]=v,E=Xf(m,d,b),k=Xf(m,d,S);if(!E||!k)return;const O=this._aroundCenter?null:E.add(k).div(2);return this._move([E,k],O,s)}touchend(s,d,m){if(!this._firstTwoTouches)return;const[v,b]=this._firstTwoTouches,S=Xf(m,d,v),E=Xf(m,d,b);S&&E||(this._active&&oe(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Xf(g,s,d){for(let m=0;m<g.length;m++)if(g[m].identifier===d)return s[m]}function t_(g,s){return Math.log2(g/s)}class Y0 extends Kf{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,d){const m=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(t_(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:t_(this._distance,m),pinchAround:d}}}function Gy(g,s){return 180*g.angleWith(s)/Math.PI}class J0 extends Kf{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,d){const m=this._vector;if(this._vector=s[0].sub(s[1]),m&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Gy(this._vector,m),pinchAround:d}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());const d=25/(Math.PI*this._minDiameter)*360,m=this._startVector;if(!m)return!1;const v=Gy(s,m);return Math.abs(v)<d}}function n_(g){return Math.abs(g.y)>Math.abs(g.x)}class Q0 extends Kf{constructor(s){super(),this._map=s}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(s){this._lastPoints=s,n_(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,d,m){const v=this._lastPoints;if(!v)return;const b=s[0].sub(v[0]),S=s[1].sub(v[1]);return this._map._cooperativeGestures&&!o.eL()&&m.touches.length<3||(this._valid=this.gestureBeginsVertically(b,S,m.timeStamp),!this._valid)?void 0:(this._lastPoints=s,this._active=!0,{pitchDelta:(b.y+S.y)/2*-.5})}gestureBeginsVertically(s,d,m){if(this._valid!==void 0)return this._valid;const v=s.mag()>=2,b=d.mag()>=2;if(!v&&!b)return;if(!v||!b)return this._firstMove==null&&(this._firstMove=m),m-this._firstMove<100&&void 0;const S=s.y>0==d.y>0;return n_(s)&&n_(d)&&S}}const e1={panStep:100,bearingStep:15,pitchStep:10};class t1{constructor(){const s=e1;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let d=0,m=0,v=0,b=0,S=0;switch(s.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:s.shiftKey?m=-1:(s.preventDefault(),b=-1);break;case 39:s.shiftKey?m=1:(s.preventDefault(),b=1);break;case 38:s.shiftKey?v=1:(s.preventDefault(),S=-1);break;case 40:s.shiftKey?v=-1:(s.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(m=0,v=0),{cameraAnimation:E=>{const k=E.getZoom();E.easeTo({duration:300,easeId:"keyboardHandler",easing:n1,zoom:d?Math.round(k)+d*(s.shiftKey?2:1):k,bearing:E.getBearing()+m*this._bearingStep,pitch:E.getPitch()+v*this._pitchStep,offset:[-b*this._panStep,-S*this._panStep],center:E.getCenter()},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function n1(g){return g*(2-g)}const Wy=4.000244140625,i1=1/450;class r1{constructor(s,d){this._map=s,this._el=s.getCanvasContainer(),this._handler=d,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=i1,o.aY(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!s&&s.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(s){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(s.ctrlKey||s.metaKey||this.isZooming()||o.eL()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let d=s.deltaMode===WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY;const m=o.o.now(),v=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,d!==0&&d%Wy==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=d,this._timeout=window.setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(v*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),s.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=s,this._delta-=d,this._active||this._start(s)),s.preventDefault()}_onTimeout(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=de(this._el,s);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:d,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const s=this._map.transform;this._type==="wheel"&&s.projection.wrap&&(s._center.lng>=180||s._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const d=()=>s._terrainEnabled()&&this._aroundCoord?s.computeZoomRelativeTo(this._aroundCoord):s.zoom;if(this._delta!==0){const O=this._type==="wheel"&&Math.abs(this._delta)>Wy?this._wheelZoomRate:this._defaultZoomRate;let z=2/(1+Math.exp(-Math.abs(this._delta*O)));this._delta<0&&z!==0&&(z=1/z);const U=d(),F=Math.pow(2,U),H=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):F;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(H*z))),this._type==="wheel"&&(this._startZoom=U,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const m=typeof this._targetZoom=="number"?this._targetZoom:d(),v=this._startZoom,b=this._easing;let S,E=!1;if(this._type==="wheel"&&v&&b){const O=Math.min((o.o.now()-this._lastWheelEventTime)/200,1),z=b(O);S=o.ak(v,m,z),O<1?this._frameId||(this._frameId=!0):E=!0}else S=m,E=!0;this._active=!0,E&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let k=S-d();return k*this._lastDelta<0&&(k=0),{noInertia:!0,needsRenderFrame:!E,zoomDelta:k,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let d=o.eM;if(this._prevEase){const m=this._prevEase,v=(o.o.now()-m.start)/m.duration,b=m.easing(v+.01)-m.easing(v),S=.27/Math.sqrt(b*b+1e-4)*.01,E=Math.sqrt(.0729-S*S);d=o.eK(S,E,.25,1)}return this._prevEase={start:o.o.now(),duration:s,easing:d},d}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Q("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class o1{constructor(s,d){this._clickZoom=s,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class s1{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(s,d){return s.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:m.getZoom()+(s.shiftKey?-1:1),around:m.unproject(d)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class QS{constructor(){this._tap=new _m({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(s,d,m){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?m.length>0&&(this._swipePoint=d[0],this._swipeTouch=m[0].identifier):this._tap.touchstart(s,d,m))}touchmove(s,d,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const v=d[0],b=v.y-this._swipePoint.y;return this._swipePoint=v,s.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(s,d,m)}touchend(s,d,m){this._tapTime?this._swipePoint&&m.length===0&&this.reset():this._tap.touchend(s,d,m)&&(this._tapTime=s.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class eC{constructor(s,d,m){this._el=s,this._mousePan=d,this._touchPan=m}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class tC{constructor(s,d,m){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=d,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ro{constructor(s,d,m,v){this._el=s,this._touchZoom=d,this._touchRotate=m,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const vm=g=>g.zoom||g.drag||g.pitch||g.rotate;class nC extends o.z{}class iC{constructor(){this.constants=[1,1,.01],this.radius=0}setup(s,d){const m=o.av([],d,s);this.radius=o.ag(m[2]<0?o.eO([],m,this.constants):[m[0],m[1],0])}projectRay(s){o.eO(s,s,this.constants),o.aw(s,s),o.eP(s,s,this.constants);const d=o.c4([],s,this.radius);if(d[2]>0){const m=o.c4([],[0,0,1],o.bJ(d,[0,0,1])),v=o.c4([],o.aw([],[d[0],d[1],0]),this.radius),b=o.d7([],d,o.c4([],o.av([],o.d7([],v,m),d),2));d[0]=b[0],d[1]=b[1]}return d}}function i_(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class bm{constructor(s,d){this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ny(s),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new iC,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(d),o.aY(["handleEvent","handleWindowEvent"],this);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[window,"blur",void 0]];for(const[v,b,S]of this._listeners){const E=v===document?this.handleWindowEvent:this.handleEvent;v.addEventListener(b,E,S)}}destroy(){for(const[s,d,m]of this._listeners){const v=s===document?this.handleWindowEvent:this.handleEvent;s.removeEventListener(d,v,m)}}_addDefaultHandlers(s){const d=this._map,m=d.getCanvasContainer();this._add("mapEvent",new Vy(d,s));const v=d.boxZoom=new bs(d,s);this._add("boxZoom",v);const b=new Rh,S=new s1;d.doubleClickZoom=new o1(S,b),this._add("tapZoom",b),this._add("clickZoom",S);const E=new QS;this._add("tapDragZoom",E);const k=d.touchPitch=new Q0(d);this._add("touchPitch",k);const O=new Qg(s),z=new e_(s);d.dragRotate=new tC(s,O,z),this._add("mouseRotate",O,["mousePitch"]),this._add("mousePitch",z,["mouseRotate"]);const U=new Zf(s),F=new Hy(d,s);d.dragPan=new eC(m,U,F),this._add("mousePan",U),this._add("touchPan",F,["touchZoom","touchRotate"]);const H=new J0,G=new Y0;d.touchZoomRotate=new ro(m,G,H,E),this._add("touchRotate",H,["touchPan","touchZoom"]),this._add("touchZoom",G,["touchPan","touchRotate"]),this._add("blockableMapEvent",new $y(d));const W=d.scrollZoom=new r1(d,this);this._add("scrollZoom",W,["mousePan"]);const ne=d.keyboard=new t1;this._add("keyboard",ne);for(const X of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])s.interactive&&s[X]&&d[X].enable(s[X])}_add(s,d,m){this._handlers.push({handlerName:s,handler:d,allowed:m}),this._handlersById[s]=d}stop(s){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!vm(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(s,d,m){for(const v in s)if(v!==m&&(!d||d.indexOf(v)<0))return!0;return!1}handleWindowEvent(s){this.handleEvent(s,`${s.type}Window`)}_getMapTouches(s){const d=[];for(const m of s)this._el.contains(m.target)&&d.push(m);return d}handleEvent(s,d){this._updatingCamera=!0;const m=s.type==="renderFrame",v=m?void 0:s,b={needsRenderFrame:!1},S={},E={},k=s.touches?this._getMapTouches(s.touches):void 0,O=k?Ee(this._el,k):m?void 0:de(this._el,s);for(const{handlerName:F,handler:H,allowed:G}of this._handlers){if(!H.isEnabled())continue;let W;this._blockedByActive(E,G,F)?H.reset():H[d||s.type]&&(W=H[d||s.type](s,O,k),this.mergeHandlerResult(b,S,W,F,v),W&&W.needsRenderFrame&&this._triggerRenderFrame()),(W||H.isActive())&&(E[F]=H)}const z={};for(const F in this._previousActiveHandlers)E[F]||(z[F]=v);this._previousActiveHandlers=E,(Object.keys(z).length||i_(b))&&(this._changes.push([b,S,z]),this._triggerRenderFrame()),(Object.keys(E).length||i_(b))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:U}=b;U&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],U(this._map))}mergeHandlerResult(s,d,m,v,b){if(!m)return;Object.assign(s,m);const S={handlerName:v,originalEvent:m.originalEvent||b};m.zoomDelta!==void 0&&(d.zoom=S),m.panDelta!==void 0&&(d.drag=S),m.pitchDelta!==void 0&&(d.pitch=S),m.bearingDelta!==void 0&&(d.rotate=S)}_applyChanges(){const s={},d={},m={};for(const[v,b,S]of this._changes)v.panDelta&&(s.panDelta=(s.panDelta||new o.P(0,0))._add(v.panDelta)),v.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+v.pitchDelta),v.around!==void 0&&(s.around=v.around),v.aroundCoord!==void 0&&(s.aroundCoord=v.aroundCoord),v.pinchAround!==void 0&&(s.pinchAround=v.pinchAround),v.noInertia&&(s.noInertia=v.noInertia),Object.assign(d,b),Object.assign(m,S);this._updateMapTransform(s,d,m),this._changes=[]}_updateMapTransform(s,d,m){const v=this._map,b=v.transform,S=re=>[re.x,re.y,re.z];if((re=>{const he=this._eventsInProgress.drag;return he&&!this._handlersById[he.handlerName].isActive()})()&&!i_(s)){const re=b.zoom;b.cameraElevationReference="sea",this._originalZoom!=null&&b._orthographicProjectionAtLowPitch&&b.projection.name!=="globe"&&b.pitch===0?(b.cameraElevationReference="ground",b.zoom=this._originalZoom):(b.recenterOnTerrain(),b.cameraElevationReference="ground"),re!==b.zoom&&this._map._update(!0)}if(b._isCameraConstrained&&v._stop(!0),!i_(s))return void this._fireEvents(d,m,!0);let{panDelta:E,zoomDelta:k,bearingDelta:O,pitchDelta:z,around:U,aroundCoord:F,pinchAround:H}=s;b._isCameraConstrained&&(k>0&&(k=0),b._isCameraConstrained=!1),H!==void 0&&(U=H),(k||(re=>d[re]&&!this._eventsInProgress[re])("drag"))&&U&&(this._dragOrigin=S(b.pointCoordinate3D(U)),this._originalZoom=b.zoom,this._trackingEllipsoid.setup(b._camera.position,this._dragOrigin)),b.cameraElevationReference="sea",v._stop(!0),U=U||v.transform.centerPoint,O&&(b.bearing+=O),z&&(b.pitch+=z),b._updateCameraState();const G=[0,0,0];if(E)if(b.projection.name==="mercator"){const re=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(U).dir),he=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(U.sub(E)).dir);G[0]=he[0]-re[0],G[1]=he[1]-re[1]}else{const re=b.pointCoordinate(U);if(b.projection.name==="globe"){E=E.rotate(-b.angle);const he=b._pixelsPerMercatorPixel/b.worldSize;G[0]=-E.x*o.eN(o.a$(re.y))*he,G[1]=-E.y*o.eN(b.center.lat)*he}else{const he=b.pointCoordinate(U.sub(E));re&&he&&(G[0]=he.x-re.x,G[1]=he.y-re.y)}}const W=b.zoom,ne=[0,0,0];if(k){const re=S(F||b.pointCoordinate3D(U)),he={dir:o.aw([],o.av([],re,b._camera.position))};if(he.dir[2]<0){const pe=b.zoomDeltaToMovement(re,k);o.c4(ne,he.dir,pe)}}const X=o.d7(G,G,ne);b._translateCameraConstrained(X),k&&Math.abs(b.zoom-W)>1e-4&&b.recenterOnTerrain(),b.cameraElevationReference="ground",this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(d,m,!0)}_fireEvents(s,d,m){const v=vm(this._eventsInProgress),b=vm(s),S={};for(const z in s){const{originalEvent:U}=s[z];this._eventsInProgress[z]||(S[`${z}start`]=U),this._eventsInProgress[z]=s[z]}!v&&b&&this._fireEvent("movestart",b.originalEvent);for(const z in S)this._fireEvent(z,S[z]);b&&this._fireEvent("move",b.originalEvent);for(const z in s){const{originalEvent:U}=s[z];this._fireEvent(z,U)}const E={};let k;for(const z in this._eventsInProgress){const{handlerName:U,originalEvent:F}=this._eventsInProgress[z];this._handlersById[U].isActive()||(delete this._eventsInProgress[z],k=d[U]||F,E[`${z}end`]=k)}for(const z in E)this._fireEvent(z,E[z]);const O=vm(this._eventsInProgress);if(m&&(v||b)&&!O){this._updatingCamera=!0;const z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),U=F=>F!==0&&-this._bearingSnap<F&&F<this._bearingSnap;z?(U(z.bearing||this._map.getBearing())&&(z.bearing=0),this._map.easeTo(z,{originalEvent:k})):(this._map.fire(new o.z("moveend",{originalEvent:k})),U(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(s,d){this._map.fire(new o.z(s,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{this._frameId=void 0,this.handleEvent(new nC("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const qy="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Zy extends o.E{constructor(s,d){super(),this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=d.bearingSnap,this._respectPrefersReducedMotion=d.respectPrefersReducedMotion!==!1,o.aY(["_renderFrameCallback"],this)}getCenter(){return new o.aR(this.transform.center.lng,this.transform.center.lat)}setCenter(s,d){return this.jumpTo({center:s},d)}panBy(s,d,m){return s=o.P.convert(s).mult(-1),this.panTo(this.transform.center,Object.assign({offset:s},d),m)}panTo(s,d,m){return this.easeTo(Object.assign({center:s},d),m)}getZoom(){return this.transform.zoom}setZoom(s,d){return this.jumpTo({zoom:s},d),this}zoomTo(s,d,m){return this.easeTo(Object.assign({zoom:s},d),m)}zoomIn(s,d){return this.zoomTo(this.getZoom()+1,s,d),this}zoomOut(s,d){return this.zoomTo(this.getZoom()-1,s,d),this}getBearing(){return this.transform.bearing}setBearing(s,d){return this.jumpTo({bearing:s},d),this}getPadding(){return this.transform.padding}setPadding(s,d){return this.jumpTo({padding:s},d),this}rotateTo(s,d,m){return this.easeTo(Object.assign({bearing:s},d),m)}resetNorth(s,d){return this.rotateTo(0,Object.assign({duration:1e3},s),d),this}resetNorthPitch(s,d){return this.easeTo(Object.assign({bearing:0,pitch:0,duration:1e3},s),d),this}snapToNorth(s,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,d):this}getPitch(){return this.transform.pitch}setPitch(s,d){return this.jumpTo({pitch:s},d),this}cameraForBounds(s,d){s=o.aI.convert(s);const m=d&&d.bearing||0,v=d&&d.pitch||0,b=s.getNorthWest(),S=s.getSouthEast();return this._cameraForBounds(this.transform,b,S,m,v,d)}_extendPadding(s){const d={top:0,right:0,bottom:0,left:0};return s==null?Object.assign({},d,this.transform.padding):typeof s=="number"?{top:s,bottom:s,right:s,left:s}:Object.assign({},d,s)}_extendCameraOptions(s){return(s=Object.assign({offset:[0,0],maxZoom:this.transform.maxZoom},s)).padding=this._extendPadding(s.padding),s}_minimumAABBFrustumDistance(s,d){const m=d.max[0]-d.min[0],v=d.max[1]-d.min[1];return m/v>s.aspect?m/(2*Math.tan(.5*s.fovX)*s.aspect):v/(2*Math.tan(.5*s.fovY)*s.aspect)}_cameraForBoundsOnGlobe(s,d,m,v,b,S){const E=s.clone(),k=this._extendCameraOptions(S);E.bearing=v,E.pitch=b;const O=o.aR.convert(d),z=o.aR.convert(m),U=.5*(O.lat+z.lat),F=.5*(O.lng+z.lng),H=o.eQ(U,F),G=o.aw([],H),W=o.aw([],o.bI([],G,[0,1,0])),ne=o.bI([],W,G),X=[W[0],W[1],W[2],0,ne[0],ne[1],ne[2],0,G[0],G[1],G[2],0,0,0,0,1],re=[H,o.eQ(O.lat,O.lng),o.eQ(z.lat,O.lng),o.eQ(z.lat,z.lng),o.eQ(O.lat,z.lng),o.eQ(U,O.lng),o.eQ(U,z.lng),o.eQ(O.lat,F),o.eQ(z.lat,F)];let he=o.d8.fromPoints(re.map(ot=>[o.bJ(W,ot),o.bJ(ne,ot),o.bJ(G,ot)]));const pe=o.af([],he.center,X);o.eR(pe)===0&&o.eS(pe,0,0,1),o.aw(pe,pe),o.c4(pe,pe,o.aD),E.center=o.eT(pe);const Ie=E.getWorldToCameraMatrix(),Se=o.bl(new Float64Array(16),Ie);he=o.d8.applyTransform(he,o.aB([],Ie,X));const Ae=this._extendAABB(he,E,k,v);if(!Ae)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");he=Ae,o.af(pe,pe,Ie);const Ce=.5*(he.max[2]-he.min[2]),we=this._minimumAABBFrustumDistance(E,he),ke=o.c4([],[0,0,1],Ce),nt=o.d7(ke,pe,ke),Ke=we+(E.pitch===0?0:o.bG(pe,nt)),ht=E.globeCenterInViewSpace,et=o.av([],pe,[ht[0],ht[1],ht[2]]);o.aw(et,et),o.c4(et,et,Ke);const ut=o.d7([],pe,et);o.af(ut,ut,Se);const jt=o.eD/o.aD,tt=o.ag(ut),Ue=o.ce(Math.max(tt*jt-o.eD,Number.EPSILON),0),pt=Math.min(E.zoomFromMercatorZAdjusted(Ue),k.maxZoom);return pt>.5*(o.cZ+o.cK)?(E.setProjection({name:"mercator"}),E.zoom=pt,this._cameraForBounds(E,d,m,v,b,S)):{center:E.center,zoom:pt,bearing:v,pitch:b}}_extendAABB(s,d,m,v){const b=.5*((m.padding.left||0)+(m.padding.right||0)),S=.5*((m.padding.top||0)+(m.padding.bottom||0)),E=S,k=b,O=b,z=S,U=d.width-(k+O),F=d.height-(E+z),H=o.av([],s.max,s.min),G=Math.min(U/H[0],F/H[1]),W=Math.min(d.scaleZoom(d.scale*G),m.maxZoom);if(isNaN(W))return null;const ne=d.scale/d.zoomScale(W),X=new o.d8([s.min[0]-k*ne,s.min[1]-z*ne,s.min[2]],[s.max[0]+O*ne,s.max[1]+E*ne,s.max[2]]),re=(typeof m.offset.x=="number"&&typeof m.offset.y=="number"?new o.P(m.offset.x,m.offset.y):o.P.convert(m.offset)).rotate(-o.an(v));return X.center[0]-=re.x*ne,X.center[1]+=re.y*ne,X}queryTerrainElevation(s,d){const m=this.transform.elevation;return m?(d=Object.assign({},{exaggerated:!0},d),m.getAtPoint(o.ae.fromLngLat(s),null,d.exaggerated)):null}_cameraForBounds(s,d,m,v,b,S){if(s.projection.name==="globe")return this._cameraForBoundsOnGlobe(s,d,m,v,b,S);const E=s.clone(),k=this._extendCameraOptions(S);E.bearing=v,E.pitch=b;const O=o.aR.convert(d),z=o.aR.convert(m),U=new o.aR(O.lng,z.lat),F=new o.aR(z.lng,O.lat),H=E.project(O),G=E.project(z),W=this.queryTerrainElevation(O),ne=this.queryTerrainElevation(z),X=this.queryTerrainElevation(U),re=this.queryTerrainElevation(F),he=[[H.x,H.y,Math.min(W||0,ne||0,X||0,re||0)],[G.x,G.y,Math.max(W||0,ne||0,X||0,re||0)]];let pe=o.d8.fromPoints(he);const Ie=E.getWorldToCameraMatrix(),Se=o.bl(new Float64Array(16),Ie);pe=o.d8.applyTransform(pe,Ie);const Ae=this._extendAABB(pe,E,k,v);if(!Ae)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");pe=Ae;const Ce=.5*o.av([],pe.max,pe.min)[2],we=this._minimumAABBFrustumDistance(E,pe),ke=[0,0,1,0];o.aC(ke,ke,Ie),o.eU(ke,ke);const nt=o.c4([],ke,we+Ce),Ke=o.d7([],pe.center,nt);o.af(pe.center,pe.center,Se),o.af(Ke,Ke,Se);const ht=E.unproject(new o.P(pe.center[0],pe.center[1])),et=o.eV(E.projection,ht),ut=Math.pow(2,et),jt=Math.min(E._zoomFromMercatorZ(Ke[2]*E.pixelsPerMeter*ut/E.worldSize),k.maxZoom);return E.mercatorFromTransition&&jt<.5*(o.cZ+o.cK)?(E.setProjection({name:"globe"}),E.zoom=jt,this._cameraForBounds(E,d,m,v,b,S)):{center:ht,zoom:jt,bearing:v,pitch:b}}fitBounds(s,d,m){const v=this.cameraForBounds(s,d);return this._fitInternal(v,d,m)}fitScreenCoordinates(s,d,m,v,b){const S=o.P.convert(s),E=o.P.convert(d),k=new o.P(Math.min(S.x,E.x),Math.min(S.y,E.y)),O=new o.P(Math.max(S.x,E.x),Math.max(S.y,E.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(S,E))return this;const z=this.transform.pointLocation3D(k),U=this.transform.pointLocation3D(O),F=this.transform.pointLocation3D(new o.P(k.x,O.y)),H=this.transform.pointLocation3D(new o.P(O.x,k.y)),G=[Math.min(z.lng,U.lng,F.lng,H.lng),Math.min(z.lat,U.lat,F.lat,H.lat)],W=[Math.max(z.lng,U.lng,F.lng,H.lng),Math.max(z.lat,U.lat,F.lat,H.lat)],ne=v&&v.pitch?v.pitch:this.getPitch(),X=this._cameraForBounds(this.transform,G,W,m,ne,v);return this._fitInternal(X,v,b)}_fitInternal(s,d,m){return s?(d=Object.assign(s,d)).linear?this.easeTo(d,m):this.flyTo(d,m):this}jumpTo(s,d){this.stop();const m=s.preloadOnly?this.transform.clone():this.transform;let v=!1,b=!1,S=!1;"zoom"in s&&m.zoom!==+s.zoom&&(v=!0,m.zoom=+s.zoom),s.center!==void 0&&(m.center=o.aR.convert(s.center)),"bearing"in s&&m.bearing!==+s.bearing&&(b=!0,m.bearing=+s.bearing),"pitch"in s&&m.pitch!==+s.pitch&&(S=!0,m.pitch=+s.pitch);const E=typeof s.padding=="number"?this._extendPadding(s.padding):s.padding;if(s.padding!=null&&!m.isPaddingEqual(E))if(s.retainPadding===!1){const k=m.clone();k.padding=E,m.setLocationAtPoint(m.center,k.centerPoint)}else m.padding=E;return s.preloadOnly?(this._preloadTiles(m),this):(this.fire(new o.z("movestart",d)).fire(new o.z("move",d)),v&&this.fire(new o.z("zoomstart",d)).fire(new o.z("zoom",d)).fire(new o.z("zoomend",d)),b&&this.fire(new o.z("rotatestart",d)).fire(new o.z("rotate",d)).fire(new o.z("rotateend",d)),S&&this.fire(new o.z("pitchstart",d)).fire(new o.z("pitch",d)).fire(new o.z("pitchend",d)),this.fire(new o.z("moveend",d)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||o.w(qy),this.transform.getFreeCameraOptions()}setFreeCameraOptions(s,d){const m=this.transform;if(!m.projection.supportsFreeCamera)return o.w(qy),this;this.stop();const v=m.zoom,b=m.pitch,S=m.bearing;m.setFreeCameraOptions(s);const E=v!==m.zoom,k=b!==m.pitch,O=S!==m.bearing;return this.fire(new o.z("movestart",d)).fire(new o.z("move",d)),E&&this.fire(new o.z("zoomstart",d)).fire(new o.z("zoom",d)).fire(new o.z("zoomend",d)),O&&this.fire(new o.z("rotatestart",d)).fire(new o.z("rotate",d)).fire(new o.z("rotateend",d)),k&&this.fire(new o.z("pitchstart",d)).fire(new o.z("pitch",d)).fire(new o.z("pitchend",d)),this.fire(new o.z("moveend",d)),this}easeTo(s,d){this._stop(!1,s.easeId),((s=Object.assign({offset:[0,0],duration:500,easing:o.eM},s)).animate===!1||this._prefersReducedMotion(s))&&(s.duration=0);const m=this.transform,v=this.getZoom(),b=this.getBearing(),S=this.getPitch(),E=this.getPadding(),k="zoom"in s?+s.zoom:v,O="bearing"in s?this._normalizeBearing(s.bearing,b):b,z="pitch"in s?+s.pitch:S,U=this._extendPadding(s.padding),F=o.P.convert(s.offset);let H,G,W;if(m.projection.name==="globe"){const ke=o.ae.fromLngLat(m.center),nt=F.rotate(-m.angle);ke.x+=nt.x/m.worldSize,ke.y+=nt.y/m.worldSize;const Ke=ke.toLngLat(),ht=o.aR.convert(s.center||Ke);this._normalizeCenter(ht),H=m.centerPoint.add(nt),G=new o.P(ke.x,ke.y).mult(m.worldSize),W=new o.P(o.aF(ht.lng),o.aJ(ht.lat)).mult(m.worldSize).sub(G)}else{H=m.centerPoint.add(F);const ke=m.pointLocation(H),nt=o.aR.convert(s.center||ke);this._normalizeCenter(nt),G=m.project(ke),W=m.project(nt).sub(G)}const ne=m.zoomScale(k-v);let X,re;s.around&&(X=o.aR.convert(s.around),re=m.locationPoint(X));const he=this._zooming||k!==v,pe=this._rotating||b!==O,Ie=this._pitching||z!==S,Se=!m.isPaddingEqual(U),Ae=s.retainPadding===!1?m.clone():m,Ce=ke=>nt=>{if(he&&(ke.zoom=o.ak(v,k,nt)),pe&&(ke.bearing=o.ak(b,O,nt)),Ie&&(ke.pitch=o.ak(S,z,nt)),Se&&(Ae.interpolatePadding(E,U,nt),H=Ae.centerPoint.add(F)),X)ke.setLocationAtPoint(X,re);else{const Ke=ke.zoomScale(ke.zoom-v),ht=k>v?Math.min(2,ne):Math.max(.5,ne),et=Math.pow(ht,1-nt),ut=ke.unproject(G.add(W.mult(nt*et)).mult(Ke));ke.setLocationAtPoint(ke.renderWorldCopies?ut.wrap():ut,H)}return s.preloadOnly||this._fireMoveEvents(d),ke};if(s.preloadOnly){const ke=this._emulate(Ce,s.duration,m);return this._preloadTiles(ke),this}const we={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=he,this._rotating=pe,this._pitching=Ie,this._padding=Se,this._easeId=s.easeId,this._prepareEase(d,s.noMoveStart,we),this._ease(Ce(m),ke=>{m.cameraElevationReference==="sea"&&m.recenterOnTerrain(),this._afterEase(d,ke)},s),this}_prepareEase(s,d,m={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),d||m.moving||this.fire(new o.z("movestart",s)),this._zooming&&!m.zooming&&this.fire(new o.z("zoomstart",s)),this._rotating&&!m.rotating&&this.fire(new o.z("rotatestart",s)),this._pitching&&!m.pitching&&this.fire(new o.z("pitchstart",s))}_fireMoveEvents(s){this.fire(new o.z("move",s)),this._zooming&&this.fire(new o.z("zoom",s)),this._rotating&&this.fire(new o.z("rotate",s)),this._pitching&&this.fire(new o.z("pitch",s))}_afterEase(s,d){if(this._easeId&&d&&this._easeId===d)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const m=this._zooming,v=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new o.z("zoomend",s)),v&&this.fire(new o.z("rotateend",s)),b&&this.fire(new o.z("pitchend",s)),this.fire(new o.z("moveend",s))}flyTo(s,d){if(this._prefersReducedMotion(s)){const ot=o.aH(s,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(ot,d)}this.stop(),s=Object.assign({offset:[0,0],speed:1.2,curve:1.42,easing:o.eM},s);const m=this.transform,v=this.getZoom(),b=this.getBearing(),S=this.getPitch(),E=this.getPadding(),k="zoom"in s?o.aA(+s.zoom,m.minZoom,m.maxZoom):v,O="bearing"in s?this._normalizeBearing(s.bearing,b):b,z="pitch"in s?+s.pitch:S,U=this._extendPadding(s.padding),F=m.zoomScale(k-v),H=o.P.convert(s.offset);let G=m.centerPoint.add(H);const W=m.pointLocation(G),ne=o.aR.convert(s.center||W);this._normalizeCenter(ne);const X=m.project(W),re=m.project(ne).sub(X);let he=s.curve;const pe=Math.max(m.width,m.height),Ie=pe/F,Se=re.mag();if("minZoom"in s){const ot=o.aA(Math.min(s.minZoom,v,k),m.minZoom,m.maxZoom),Et=pe/m.zoomScale(ot-v);he=Math.sqrt(Et/Se*2)}const Ae=he*he;function Ce(ot){const Et=(Ie*Ie-pe*pe+(ot?-1:1)*Ae*Ae*Se*Se)/(2*(ot?Ie:pe)*Ae*Se);return Math.log(Math.sqrt(Et*Et+1)-Et)}function we(ot){return(Math.exp(ot)-Math.exp(-ot))/2}function ke(ot){return(Math.exp(ot)+Math.exp(-ot))/2}const nt=Ce(0);let Ke=function(ot){return ke(nt)/ke(nt+he*ot)},ht=function(ot){return pe*((ke(nt)*(we(Et=nt+he*ot)/ke(Et))-we(nt))/Ae)/Se;var Et},et=(Ce(1)-nt)/he;if(Math.abs(Se)<1e-6||!isFinite(et)){if(Math.abs(pe-Ie)<1e-6)return this.easeTo(s,d);const ot=Ie<pe?-1:1;et=Math.abs(Math.log(Ie/pe))/he,ht=function(){return 0},Ke=function(Et){return Math.exp(ot*he*Et)}}s.duration="duration"in s?+s.duration:1e3*et/("screenSpeed"in s?+s.screenSpeed/he:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0);const ut=b!==O,jt=z!==S,tt=!m.isPaddingEqual(U),Ue=s.retainPadding===!1?m.clone():m,pt=ot=>Et=>{const $t=Et*et,rn=1/Ke($t);ot.zoom=Et===1?k:v+ot.scaleZoom(rn),ut&&(ot.bearing=o.ak(b,O,Et)),jt&&(ot.pitch=o.ak(S,z,Et)),tt&&(Ue.interpolatePadding(E,U,Et),G=Ue.centerPoint.add(H));const Lt=Et===1?ne:ot.unproject(X.add(re.mult(ht($t))).mult(rn));return ot.setLocationAtPoint(ot.renderWorldCopies?Lt.wrap():Lt,G),ot._updateCameraOnTerrain(),s.preloadOnly||this._fireMoveEvents(d),ot};if(s.preloadOnly){const ot=this._emulate(pt,s.duration,m);return this._preloadTiles(ot),this}return this._zooming=!0,this._rotating=ut,this._pitching=jt,this._padding=tt,this._prepareEase(d,!1),this._ease(pt(m),()=>this._afterEase(d),s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(s){}_cancelRenderFrame(s){}_stop(s,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const m=this._onEaseEnd;this._onEaseEnd=void 0,m.call(this,d)}if(!s){const m=this.handlers;m&&m.stop(!1)}return this}_ease(s,d,m){m.animate===!1||m.duration===0?(s(1),d()):(this._easeStart=o.o.now(),this._easeOptions=m,this._onEaseFrame=s,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const s=Math.min((o.o.now()-this._easeStart)/this._easeOptions.duration,1),d=this._onEaseFrame;d&&d(this._easeOptions.easing(s)),s<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(s,d){s=o.bT(s,-180,180);const m=Math.abs(s-d);return Math.abs(s-360-d)<m&&(s-=360),Math.abs(s+360-d)<m&&(s+=360),s}_normalizeCenter(s){const d=this.transform;if(d.maxBounds||d.projection.name!=="globe"&&!d.renderWorldCopies)return;const m=s.lng-d.center.lng;s.lng+=m>180?-360:m<-180?360:0}_prefersReducedMotion(s){return this._respectPrefersReducedMotion&&o.o.prefersReducedMotion&&!(s&&s.essential)}_emulate(s,d,m){const v=Math.ceil(15*d/1e3),b=[],S=s(m.clone());for(let E=0;E<=v;E++){const k=S(E/v);b.push(k.clone())}return b}_preloadTiles(s,d){}}class xm{constructor(s={}){this.options=s,o.aY(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(s){const d=this.options&&this.options.compact,m=s._getUIString("AttributionControl.ToggleAttribution");this._map=s,this._container=Q("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Q("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",m);const v=Q("span","mapboxgl-ctrl-icon",this._compactButton);return v.setAttribute("aria-hidden","true"),v.setAttribute("title",m),this._innerContainer=Q("div","mapboxgl-ctrl-attrib-inner",this._container),d&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),d===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let s=this._editLink;s||(s=this._editLink=this._container.querySelector(".mapbox-improve-map"));const d=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.e.ACCESS_TOKEN}];if(s){const m=d.reduce((v,b,S)=>(b.value&&(v+=`${b.key}=${b.value}${S<d.length-1?"&":""}`),v),"?");s.href=`${o.e.FEEDBACK_URL}/${m}#${Kg(this._map,!0)}`,s.rel="noopener nofollow"}}_updateData(s){!s||(s.dataType!=="source"||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility")&&s.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let s=[];if(this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const d=this._map.style._mergedSourceCaches;for(const v in d){const b=d[v];if(b.used){const S=b.getSource();S.attribution&&s.indexOf(S.attribution)<0&&s.push(S.attribution)}}s.sort((v,b)=>v.length-b.length),s=s.filter((v,b)=>{for(let S=b+1;S<s.length;S++)if(s[S].indexOf(v)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=[...this.options.customAttribution,...s]:s.unshift(this.options.customAttribution));const m=s.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,s.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class su{constructor(){o.aY(["_updateLogo","_updateCompact"],this)}onAdd(s){this._map=s,this._container=Q("div","mapboxgl-ctrl");const d=Q("a","mapboxgl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://www.mapbox.com/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(s){s&&s.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const s=this._map.style._sourceCaches;if(Object.entries(s).length===0)return!0;for(const d in s){const m=s[d].getSource();if(m.hasOwnProperty("mapbox_logo")&&!m.mapbox_logo)return!1}return!0}_updateCompact(){const s=this._container.children;if(s.length){const d=s[0];this._map.getCanvasContainer().offsetWidth<250?d.classList.add("mapboxgl-compact"):d.classList.remove("mapboxgl-compact")}}}class wm{constructor(){o.aY(["_onIndoorUpdate"],this)}onAdd(s){return this._map=s,this._container=Q("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._map.indoor.on("indoorupdate",d=>this._onIndoorUpdate({selectedFloorId:d.selectedFloorId,floors:d.floors})),this._container}_createButton(s,d){const m=Q("button",s,this._container);return m.type="button",m.addEventListener("click",d),m}_createSeparator(){return Q("div","mapboxgl-ctrl-separator",this._container)}_setButtonTitle(s,d){this._map&&(s.setAttribute("aria-label",d),s.textContent=d)}onRemove(){this._container&&this._container.remove(),this._map&&this._map.indoor&&(this._map.indoor.off("indoorupdate",this._onIndoorUpdate),this._map=null)}getDefaultPosition(){return"right"}_onIndoorUpdate(s){if(!s||!s.floors)return void(this._container.style.display="none");const d=this._model;this._model=s,this._container.style.display="inline-block",this._container.style.borderRadius="8px";const m=s.floors.sort((v,b)=>b.levelOrder-v.levelOrder);d?(Array.from(this._container.children).forEach(v=>v.remove()),this.addCurrentFloors(m)):this.addCurrentFloors(m)}addCurrentFloors(s){for(let d=0;d<s.length;d++){const m=s[d],v=this._createButton("mapboxgl-ctrl-level-button",()=>{this._map._selectIndoorFloor(m.id),this._model&&(this._model.selectedFloorId=m.id),Array.from(this._container.children).forEach(b=>{b.classList.contains("mapboxgl-ctrl-level-button")&&b.classList.remove("mapboxgl-ctrl-level-button-selected")}),v.classList.add("mapboxgl-ctrl-level-button-selected")});this._setButtonTitle(v,m.shortName),this._model&&m.id===this._model.selectedFloorId&&v.classList.add("mapboxgl-ctrl-level-button-selected"),this._container.append(v),d<s.length-1&&this._createSeparator()}}}class Ho{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){const d=++this._id;return this._queue.push({callback:s,id:d,cancelled:!1}),d}remove(s){const d=this._currentlyRunning,m=d?this._queue.concat(d):this._queue;for(const v of m)if(v.id===s)return void(v.cancelled=!0)}run(s=0){const d=this._currentlyRunning=this._queue;this._queue=[];for(const m of d)if(!m.cancelled&&(m.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class au{constructor(s){this.jumpTo(s)}getValue(s){if(s<=this._startTime)return this._start;if(s>=this._endTime)return this._end;const d=o.dz((s-this._startTime)/(this._endTime-this._startTime));return this._start*(1-d)+this._end*d}isEasing(s){return s>=this._startTime&&s<=this._endTime}jumpTo(s){this._startTime=-1/0,this._endTime=-1/0,this._start=s,this._end=s}easeTo(s,d,m){this._start=this.getValue(d),this._end=s,this._startTime=d,this._endTime=d+m}}const Sm={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class Cm extends o.z{constructor(s,d,m,v){const{point:b,lngLat:S,originalEvent:E,target:k}=s;super(s.type,{point:b,lngLat:S,originalEvent:E,target:k}),this.preventDefault=()=>{s.preventDefault()},this.id=d,this.interaction=m,this.feature=v}}class a1{constructor(s){this.map=s,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(s,d){if(this.typeById.has(s))throw new Error(`Interaction id "${s}" already exists.`);const m=d.filter;let v=d.type;m&&this.filters.set(s,o.b6(m)),v==="mouseover"&&(v="mouseenter"),v==="mouseout"&&(v="mouseleave");const b=this.interactionsByType.get(v)||new Map;v==="mouseenter"||v==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(s,d)):b.size===0&&this.map.on(v,this.handleType),b.size===0&&this.interactionsByType.set(v,b),b.set(s,d),this.typeById.set(s,v)}get(s){const d=this.typeById.get(s);if(!d)return;const m=this.interactionsByType.get(d);return m?m.get(s):void 0}remove(s){const d=this.typeById.get(s);if(!d)return;this.typeById.delete(s),this.filters.delete(s);const m=this.interactionsByType.get(d);m&&(m.delete(s),d==="mouseenter"||d==="mouseleave"?(this.delegatedInteractions.delete(s),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):m.size===0&&this.map.off(d,this.handleType))}queryTargets(s,d){const m=[];for(const[v,b]of d)b.target&&m.push({targetId:v,target:b.target,filter:this.filters.get(v)});return this.map.style.queryRenderedTargets(s,m,this.map.transform)}handleMove(s){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const d=this.queryTargets(s.point,Array.from(this.delegatedInteractions).reverse());d.length&&(s.type="mouseenter",this.handleType(s,d));const m=new Map;for(const[v,{feature:b}]of this.prevHoveredFeatures)this.hoveredFeatures.has(v)||m.set(b.id,b);m.size&&(s.type="mouseleave",this.handleType(s,Array.from(m.values())))}handleOut(s){const d=Array.from(this.hoveredFeatures.values()).map(({feature:m})=>m);d.length&&(s.type="mouseleave",this.handleType(s,d)),this.hoveredFeatures.clear()}handleType(s,d){const m=s.type==="mouseenter";if(m&&!this.interactionsByType.has(s.type))return void o.w("mouseenter interaction required for mouseleave to work.");const v=Array.from(this.interactionsByType.get(s.type)).reverse(),b=!!d;d=d||this.queryTargets(s.point,v);let S=!1;const E=new Set;for(const k of d){for(const[O,z]of v){if(!z.target)continue;const U=k.variants?k.variants[O]:null;if(U){for(const F of U){if(is(F,k,E,O))continue;const H=new o.dt(k,F),G=wl(F,k,O);b&&(H.state=this.map.getFeatureState(H));const W=m?this.prevHoveredFeatures.get(G):null,ne=new Cm(s,O,z,H),X=W?W.stop:z.handler(ne);if(m&&this.hoveredFeatures.set(G,{feature:k,stop:X}),X!==!1){S=!0;break}}if(S)break}}if(S)break}if(!S)for(const[k,O]of v){const{handler:z,target:U}=O;if(!U&&z(new Cm(s,k,O,null))!==!1)break}}}function rC(g,s){if(Array.isArray(g)&&Array.isArray(s)){const d=new Set(g),m=new Set(s);return d.size===m.size&&g.every(v=>m.has(v))}return o.by(g,s)}const Tm={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},oC={showCompass:!0,showZoom:!0,visualizePitch:!1};class sC{constructor(s,d,m=!1){this._clickTolerance=10,this.element=d,this.mouseRotate=new Qg({clickTolerance:s.dragRotate._mouseRotate._clickTolerance}),this.map=s,m&&(this.mousePitch=new e_({clickTolerance:s.dragRotate._mousePitch._clickTolerance})),o.aY(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),d.addEventListener("mousedown",this.mousedown),d.addEventListener("touchstart",this.touchstart,{passive:!1}),d.addEventListener("touchmove",this.touchmove),d.addEventListener("touchend",this.touchend),d.addEventListener("touchcancel",this.reset)}down(s,d){this.mouseRotate.mousedown(s,d),this.mousePitch&&this.mousePitch.mousedown(s,d),xe()}move(s,d){const m=this.map,v=this.mouseRotate.mousemoveWindow(s,d),b=v&&v.bearingDelta;if(b&&m.setBearing(m.getBearing()+b),this.mousePitch){const S=this.mousePitch.mousemoveWindow(s,d),E=S&&S.pitchDelta;E&&m.setPitch(m.getPitch()+E)}}off(){const s=this.element;s.removeEventListener("mousedown",this.mousedown),s.removeEventListener("touchstart",this.touchstart),s.removeEventListener("touchmove",this.touchmove),s.removeEventListener("touchend",this.touchend),s.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){je(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(s){this.down(Object.assign({},s,{ctrlKey:!0,preventDefault:()=>s.preventDefault()}),de(this.element,s)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(s){this.move(s,de(this.element,s))}mouseup(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()}touchstart(s){s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Ee(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>s.preventDefault()},this._startPos))}touchmove(s){s.targetTouches.length!==1?this.reset():(this._lastPos=Ee(this.element,s.targetTouches)[0],this.move({preventDefault:()=>s.preventDefault()},this._lastPos))}touchend(s){s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function r_(g,s,d){if(g=new o.aR(g.lng,g.lat),s){const m=new o.aR(g.lng-360,g.lat),v=new o.aR(g.lng+360,g.lat),b=360*Math.ceil(Math.abs(g.lng-d.center.lng)/360),S=d.locationPoint3D(g).distSqr(s),E=s.x<0||s.y<0||s.x>d.width||s.y>d.height;d.locationPoint3D(m).distSqr(s)<S&&(E||Math.abs(m.lng-d.center.lng)<b)?g=m:d.locationPoint3D(v).distSqr(s)<S&&(E||Math.abs(v.lng-d.center.lng)<b)&&(g=v)}for(;Math.abs(g.lng-d.center.lng)>180;){const m=d.locationPoint3D(g);if(m.x>=0&&m.y>=0&&m.x<=d.width&&m.y<=d.height)break;g.lng>d.center.lng?g.lng-=360:g.lng+=360}return g}const Em={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},Ml={rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class Ph extends o.E{constructor(s,d){super(),(s instanceof HTMLElement||d)&&(s=Object.assign({element:s},d)),o.aY(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this);const{anchor:m="center",color:v="#3FB1CE",scale:b=1,draggable:S=!1,clickTolerance:E=0,rotation:k=Ml.rotation,rotationAlignment:O=Ml.rotationAlignment,pitchAlignment:z=Ml.pitchAlignment,occludedOpacity:U=Ml.occludedOpacity,altitude:F=Ml.altitude}=s||{};this._anchor=m,this._color=v,this._scale=b,this._draggable=S,this._clickTolerance=E,this._rotation=k,this._rotationAlignment=O,this._pitchAlignment=z,this._occludedOpacity=U,this._altitude=F,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),s&&s.element?(this._element=s.element,this._offset=o.P.convert(s&&s.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=o.P.convert(s&&s.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",W=>{W.preventDefault()}),this._element.addEventListener("mousedown",W=>{W.preventDefault()});const H=this._element.classList;for(const W in Em)H.remove(`mapboxgl-marker-anchor-${W}`);H.add(`mapboxgl-marker-anchor-${this._anchor}`);const G=s&&s.className?s.className.trim().split(/\s+/):[];H.add(...G),this._popup=null}_createDefaultMarker(){const s=Q("div"),d=se("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},s);if(this._altitude===0){const m=se("radialGradient",{id:"shadowGradient"},se("defs",{},d));se("stop",{offset:"10%","stop-opacity":.4},m),se("stop",{offset:"100%","stop-opacity":.05},m),se("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},d)}return se("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},d),se("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},d),se("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},d),s}addTo(s){return s===this._map||(this.remove(),this._map=s,s.getCanvasContainer().appendChild(this._element),s.on("move",this._updateMoving),s.on("moveend",this._update),s.on("remove",this._clearFadeTimer),s._addMarker(this),this.setDraggable(this._draggable),this._update(),s.on("click",this._onMapClick)),this}remove(){const s=this._map;return s&&(s.off("click",this._onMapClick),s.off("move",this._updateMoving),s.off("moveend",this._update),s.off("mousedown",this._addDragHandler),s.off("touchstart",this._addDragHandler),s.off("mouseup",this._onUp),s.off("touchend",this._onUp),s.off("mousemove",this._onMove),s.off("touchmove",this._onMove),s.off("remove",this._clearFadeTimer),s._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=o.aR.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(s){return s===this._altitude||(this._defaultMarker&&(this._altitude===0&&s!==0||this._altitude!==0&&s===0)&&(this._element=this._createDefaultMarker()),this._altitude=s||Ml.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){const v=Math.sqrt(Math.pow(13.5,2)/2);s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(38.1-13.5+v)],"bottom-right":[-v,-1*(38.1-13.5+v)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=s,s._marker=this,s._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(s){const d=s.code,m=s.charCode||s.keyCode;d!=="Space"&&d!=="Enter"&&m!==32&&m!==13||this.togglePopup()}_onMapClick(s){const d=s.originalEvent.target,m=this._element;this._popup&&(d===m||m.contains(d))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const s=this._popup;return s?(s.isOpen()?(s.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(s.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const s=this._map,d=this._pos;if(!s||!d)return!1;const m=s.unproject(d,this._altitude),v=s.getFreeCameraOptions();if(!v.position)return!1;const b=v.position.toLngLat();return b.distanceTo(m)<.9*b.distanceTo(this._lngLat)}_evaluateOpacity(){const s=this._map;if(!s)return;const d=this._pos;if(!d||d.x<0||d.x>s.transform.width||d.y<0||d.y>s.transform.height)return void this._clearFadeTimer();const m=s.unproject(d,this._altitude);let v;s._showingGlobe()&&o.eY(s.transform,this._lngLat)?v=0:(v=1-s._queryFogOpacity(m),s.transform._terrainEnabled()&&s.getTerrain()&&this._behindTerrain()&&(v*=this._occludedOpacity)),this._element.style.opacity=`${v}`,this._element.style.pointerEvents=v>0?"auto":"none",this._popup&&this._popup._setOpacity(v),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const s=this._pos;if(!s||!this._map)return;const d=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${s.x}px,${s.y}px)
            ${Em[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${d.x}px,${d.y}px)
        `}_calculateXYTransform(){const s=this._pos,d=this._map,m=this.getPitchAlignment();if(!d||!s||m!=="map")return"";if(!d._showingGlobe()){const k=d.getPitch();return k?`rotateX(${k}deg)`:""}const v=o.cW(o.eZ(d.transform,this._lngLat)),b=s.sub(o.e_(d.transform)),S=Math.abs(b.x)+Math.abs(b.y);if(S===0)return"";const E=v/S;return`rotateX(${-b.y*E}deg) rotateY(${b.x*E}deg)`}_calculateZTransform(){const s=this._pos,d=this._map;if(!d||!s)return"";let m=0;const v=this.getRotationAlignment();if(v==="map")if(d._showingGlobe()){const b=d.project(new o.aR(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),S=d.project(new o.aR(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(b);m=o.cW(Math.atan2(S.y,S.x))-90}else m=-d.getBearing();else if(v==="horizon"){const b=o.ah(4,6,d.getZoom()),S=o.e_(d.transform);S.y+=b*d.transform.height;const E=s.sub(S),k=o.cW(Math.atan2(E.y,E.x));m=(k>90?k-270:k+90)*(1-b)}return m+=this._rotation,m?`rotateZ(${m}deg)`:""}_update(s){cancelAnimationFrame(this._updateFrameId);const d=this._map;d&&(d.transform.renderWorldCopies&&(this._lngLat=r_(this._lngLat,this._pos,d.transform)),this._pos=d.project(this._lngLat,this._altitude),s===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),d._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(d._showingGlobe()||d.getTerrain()||d.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(s){return this._offset=o.P.convert(s),this._update(),this}addClassName(s){return this._element.classList.add(s),this}removeClassName(s){return this._element.classList.remove(s),this}toggleClassName(s){return this._element.classList.toggle(s)}_onMove(s){const d=this._map;if(!d)return;const m=this._pointerdownPos,v=this._positionDelta;if(m&&v){if(!this._isDragging){const b=this._clickTolerance||d._clickTolerance;if(s.point.dist(m)<b)return;this._isDragging=!0}this._pos=s.point.sub(v),this._lngLat=d.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.z("dragstart"))),this.fire(new o.z("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const s=this._map;s&&(s.off("mousemove",this._onMove),s.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new o.z("dragend")),this._state="inactive"}_addDragHandler(s){const d=this._map,m=this._pos;d&&m&&this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(m),this._pointerdownPos=s.point,this._state="pending",d.on("mousemove",this._onMove),d.on("touchmove",this._onMove),d.once("mouseup",this._onUp),d.once("touchend",this._onUp))}setDraggable(s){this._draggable=!!s;const d=this._map;return d&&(s?(d.on("mousedown",this._addDragHandler),d.on("touchstart",this._addDragHandler)):(d.off("mousedown",this._addDragHandler),d.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||Ml.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||Ml.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s||Ml.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(s){return this._occludedOpacity=s||Ml.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Ld={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Uu={maxWidth:100,unit:"metric"},Hu={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Mh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},Ic=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function l1(g=new o.P(0,0),s="bottom"){if(typeof g=="number"){const d=Math.round(Math.sqrt(.5*Math.pow(g,2)));switch(s){case"top":return new o.P(0,g);case"top-left":return new o.P(d,d);case"top-right":return new o.P(-d,d);case"bottom":return new o.P(0,-g);case"bottom-left":return new o.P(d,-d);case"bottom-right":return new o.P(-d,-d);case"left":return new o.P(g,0);case"right":return new o.P(-g,0)}return new o.P(0,0)}return g instanceof o.P||Array.isArray(g)?o.P.convert(g):o.P.convert(g[s]||[0,0])}return{version:w,supported:ee.supported,setRTLTextPlugin:o.f2,getRTLTextPluginStatus:o.f1,Map:class extends Zy{constructor(g){A.mark(T.create);const s=g;if((g=Object.assign({},Tm,g)).minZoom!=null&&g.maxZoom!=null&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(g.minPitch!=null&&g.maxPitch!=null&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(g.minPitch!=null&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(g.maxPitch!=null&&g.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(g.antialias&&o.eW(window)&&(g.antialias=!1,o.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new ia(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies,null,null),g),this._repaint=!!g.repaint,this._interactive=g.interactive,this._minTileCacheSize=g.minTileCacheSize,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=g.crossSourceCollisions,this._collectResourceTiming=g.collectResourceTiming,this._language=this._parseLanguage(g.language),this._worldview=g.worldview,this._renderTaskQueue=new Ho,this._domRenderTaskQueue=new Ho,this._controls=[],this._markers=[],this._popups=[],this._mapId=o.b2(),this._locale=Object.assign({},Sm,g.locale),this._clickTolerance=g.clickTolerance,this._cooperativeGestures=g.cooperativeGestures,this._performanceMetricsCollection=g.performanceMetricsCollection,this._tessellationStep=g.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=g.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new au(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=g.scaleFactor,this._requestManager=new tn(g.transformRequest,g.accessToken,g.testMode),this._silenceAuthErrors=!!g.testMode,this._contextCreateOptions=g.contextCreateOptions?Object.assign({},g.contextCreateOptions):{},typeof g.container=="string"){const d=document.getElementById(g.container);if(!d)throw new Error(`Container '${g.container.toString()}' not found.`);this._container=d}else{if(!(g.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(this._container.childNodes.length>0&&o.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),g.maxBounds&&this.setMaxBounds(g.maxBounds),this._spriteFormat=g.spriteFormat,o.aY(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new Uf),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new bm(this,g),this._localFontFamily=g.localFontFamily,this._localIdeographFontFamily=g.localIdeographFontFamily,(g.style||!g.testMode)&&this.setStyle(g.style||o.e.DEFAULT_STYLE,{config:g.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),g.projection&&this.setProjection(g.projection),this.indoor=new zu(this),g.hash&&(this._hash=new By(typeof g.hash=="string"&&g.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){s.center==null&&s.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch});const d=g.bounds;d&&(this.resize(),this.fitBounds(d,Object.assign({},g.fitBoundsOptions,{duration:0})))}this.resize(),g.attributionControl&&this.addControl(new xm({customAttribution:g.customAttribution})),this._logoControl=new su,this.addControl(this._logoControl,g.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",d=>{this._update(d.dataType==="style"),this.fire(new o.z(`${d.dataType}data`,d))}),this.on("dataloading",d=>{this.fire(new o.z(`${d.dataType}dataloading`,d))}),this._interactions=new a1(this)}_getMapId(){return this._mapId}addControl(g,s){if(s===void 0&&(s=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new o.y(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=g.onAdd(this);this._controls.push(g);const m=this._controlPositions[s];return s.indexOf("bottom")!==-1?m.insertBefore(d,m.firstChild):m.appendChild(d),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new o.y(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const s=this._controls.indexOf(g);return s>-1&&this._controls.splice(s,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(g){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const s=!this._moving;return s&&this.fire(new o.z("movestart",g)).fire(new o.z("move",g)),this.fire(new o.z("resize",g)),s&&this.fire(new o.z("moveend",g)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(g){return this.transform.setMaxBounds(o.aI.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g?this.setZoom(g):this.fire(new o.z("zoomstart")).fire(new o.z("zoom")).fire(new o.z("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g?this.setZoom(g):this.fire(new o.z("zoomstart")).fire(new o.z("zoom")).fire(new o.z("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g?this.setPitch(g):this.fire(new o.z("pitchstart")).fire(new o.z("pitch")).fire(new o.z("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g?this.setPitch(g):this.fire(new o.z("pitchstart")).fire(new o.z("pitch")).fire(new o.z("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(g){return this._scaleFactor=g,this.painter.scaleFactor=g,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(s=>s.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(g){return g==="auto"?navigator.language:Array.isArray(g)?g.length===0?void 0:g.map(s=>s==="auto"?navigator.language:s):g}setLanguage(g){const s=this._parseLanguage(g);if(!this.style||s===this._language)return this;this._language=s,this.style.reloadSources();for(const d of this._controls)d._setLanguage&&d._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(g){return this.style&&g!==this._worldview?(this._worldview=g,this._styleDirty=!0,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(g){return this._lazyInitEmptyStyle(),g?typeof g=="string"&&(g={name:g}):g=null,this._useExplicitProjection=!!g,this._prioritizeAndUpdateProjection(g,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const g=this.transform,s=g.projection.name;let d;s==="globe"&&g.zoom>=o.cK?(g.setMercatorFromTransition(),d=!0):s==="mercator"&&g.zoom<o.cK&&(g.setProjection({name:"globe"}),d=!0),d&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate(),this._update(!0))}_prioritizeAndUpdateProjection(g,s){return this._updateProjection(g||s||{name:"mercator"})}_updateProjection(g){let s;return s=g.name==="globe"&&this.transform.zoom>=o.cK?this.transform.setMercatorFromTransition():this.transform.setProjection(g),this.style.applyProjectionUpdate(),s&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(g,s){return this.transform.locationPoint3D(o.aR.convert(g),s)}unproject(g,s){return this.transform.pointLocation3D(o.P.convert(g),s)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(g,s,d){const m=v=>{let b=[];if(Array.isArray(s)){const S=s.filter(E=>this.getLayer(E));b=S.length?this.queryRenderedFeatures(v,{layers:S}):[]}else b=this.queryRenderedFeatures(v,{target:s});return b};if(g==="mouseenter"||g==="mouseover"){let v=!1;return{listener:d,targets:s,delegates:{mousemove:S=>{const E=m(S.point);E.length?v||(v=!0,d.call(this,new hs(g,this,S.originalEvent,{features:E}))):v=!1},mouseout:()=>{v=!1}}}}if(g==="mouseleave"||g==="mouseout"){let v=!1;return{listener:d,targets:s,delegates:{mousemove:E=>{m(E.point).length?v=!0:v&&(v=!1,d.call(this,new hs(g,this,E.originalEvent)))},mouseout:E=>{v&&(v=!1,d.call(this,new hs(g,this,E.originalEvent)))}}}}{const v=b=>{const S=m(b.point);S.length&&(b.features=S,d.call(this,b),delete b.features)};return{listener:d,targets:s,delegates:{[g]:v}}}}on(g,s,d){if(typeof s=="function"||d===void 0)return super.on(g,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const m=this._createDelegatedListener(g,s,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(m);for(const v in m.delegates)this.on(v,m.delegates[v]);return this}once(g,s,d){if(typeof s=="function"||d===void 0)return super.once(g,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const m=this._createDelegatedListener(g,s,d);for(const v in m.delegates)this.once(v,m.delegates[v]);return this}off(g,s,d){if(typeof s=="function"||d===void 0)return super.off(g,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const m=this._delegatedListeners?this._delegatedListeners[g]:void 0;return m&&(v=>{for(let b=0;b<v.length;b++){const S=v[b];if(S.listener===d&&rC(S.targets,s)){for(const E in S.delegates)this.off(E,S.delegates[E]);return v.splice(b,1),this}}})(m),this}queryRenderedFeatures(g,s){if(!this.style)return[];if(g===void 0||g instanceof o.P||Array.isArray(g)||s!==void 0||(s=g,g=void 0),g=g||[[0,0],[this.transform.width,this.transform.height]],!s){const b=this.style.queryRenderedFeatures(g,void 0,this.transform),S=this.style.queryRenderedFeatureset(g,void 0,this.transform);return b.concat(S)}let d=!0;if(s.target&&(d=this._isTargetValid(s.target),d&&!s.layers))return this.style.queryRenderedFeatureset(g,s,this.transform);let m=!0;if(s.layers&&Array.isArray(s.layers)){for(const b of s.layers)if(!this._isValidId(b)){m=!1;break}if(m&&!s.target)return this.style.queryRenderedFeatures(g,s,this.transform)}let v=[];return m&&(v=v.concat(this.style.queryRenderedFeatures(g,s,this.transform))),d&&(v=v.concat(this.style.queryRenderedFeatureset(g,s,this.transform))),v}querySourceFeatures(g,s){return!g||typeof g=="string"&&!this._isValidId(g)?[]:this.style.querySourceFeatures(g,s)}queryRasterValue(g,s,d){return this._isValidId(g)?this.style.queryRasterValue(g,s,d):Promise.resolve(null)}isPointOnSurface(g){const{name:s}=this.transform.projection;return s!=="globe"&&s!=="mercator"&&o.w(`${s} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(o.P.convert(g))}addInteraction(g,s){return this._interactions.add(g,s),this}removeInteraction(g){return this._interactions.remove(g),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(g){return this._cooperativeGestures=g,this}setStyle(g,s){return s=Object.assign({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},s),this.style&&g&&s.diff!==!1&&s.localFontFamily===this._localFontFamily&&s.localIdeographFontFamily===this._localIdeographFontFamily&&!s.config?(this.style._diffStyle(g,(d,m)=>{if(d){const v=typeof d=="string"?d:d instanceof Error?d.message:d.error;o.w(`Unable to perform style diff: ${v}. Rebuilding the style from scratch.`),this._updateStyle(g,s)}else m&&this._update(!0)},()=>this._postStyleLoadEvent()),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._localFontFamily=s.localFontFamily,this._updateStyle(g,s))}_getUIString(g){const s=this._locale[g];if(s==null)throw new Error(`Missing UI string '${g}'`);return s}_updateStyle(g,s){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),g){const d=Object.assign({},s);s&&s.config&&(d.initialConfig=s.config,delete d.config),this.style=new nl(this,d).load(g),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new nl(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(o.w("There is no style added to the map."),!1)}_isValidId(g){return g==null?(this.fire(new o.y(new Error("IDs can't be empty."))),!1):!o.dm(g)||(this.fire(new o.y(new Error(`IDs can't contain special symbols: "${g}".`))),!1)}_isTargetValid(g){return"featuresetId"in g?this._isValidId("importId"in g?g.importId:g.featuresetId):"layerId"in g&&this._isValidId(g.layerId)}_areTargetsValid(g){if(Array.isArray(g)){for(const s of g)if(!this._isValidId(s))return!1;return!0}return this._isTargetValid(g)}addSource(g,s){return this._isValidId(g)?(this._lazyInitEmptyStyle(),this.style.addSource(g,s),this._update(!0)):this}isSourceLoaded(g){return!!this._isValidId(g)&&!!this.style&&this.style._isSourceCacheLoaded(g)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(g,s,d){this._lazyInitEmptyStyle(),this.style.addSourceType(g,s,d)}removeSource(g){return this._isValidId(g)?(this.style.removeSource(g),this._updateTerrain(),this._update(!0)):this}getSource(g){return this._isValidId(g)?this.style.getOwnSource(g):null}addImage(g,s,{pixelRatio:d=1,sdf:m=!1,stretchX:v,stretchY:b,content:S}={}){this._lazyInitEmptyStyle();const E=o.I.from(g);if(s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap){const{width:k,height:O,data:z}=o.o.getImageData(s);this.style.addImage(E,{data:new o.q({width:k,height:O},z),pixelRatio:d,stretchX:v,stretchY:b,content:S,sdf:m,version:0,usvg:!1})}else if(s.width===void 0||s.height===void 0)this.fire(new o.y(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:k,height:O}=s,z=s;this.style.addImage(E,{data:new o.q({width:k,height:O},new Uint8Array(z.data)),pixelRatio:d,stretchX:v,stretchY:b,content:S,sdf:m,usvg:!1,version:0,userImage:z}),z.onAdd&&z.onAdd(this,g)}}updateImage(g,s){this._lazyInitEmptyStyle();const d=o.I.from(g),m=this.style.getImage(d);if(!m)return void this.fire(new o.y(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const v=s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap?o.o.getImageData(s):s,{width:b,height:S,data:E}=v;if(b===void 0||S===void 0)return void this.fire(new o.y(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(b!==(m.usvg?m.icon.usvg_tree.width:m.data.width)||S!==(m.usvg?m.icon.usvg_tree.height:m.data.height))return void this.fire(new o.y(new Error(`The width and height of the updated image (${b}, ${S})
                must be that same as the previous version of the image
                (${m.data.width}, ${m.data.height})`)));const k=!(s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap);let O=!1;m.usvg?(m.data=new o.q({width:b,height:S},new Uint8Array(E)),m.usvg=!1,m.icon=void 0,O=!0):m.data.replace(E,k),this.style.updateImage(d,m,O)}hasImage(g){return g?!!this.style&&!!this.style.getImage(o.I.from(g)):(this.fire(new o.y(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(o.I.from(g))}loadImage(g,s){o.n(this._requestManager.transformRequest(g,o.R.Image),(d,m)=>{s(d,m instanceof HTMLImageElement?o.o.getImageData(m):m)})}listImages(){return this.style.listImages().map(g=>g.name)}addModel(g,s){this._lazyInitEmptyStyle(),this.style.addModel(g,s)}hasModel(g){return g?this.style.hasModel(g):(this.fire(new o.y(new Error("Missing required model id"))),!1)}removeModel(g){this.style.removeModel(g)}listModels(){return this.style.listModels()}addLayer(g,s){return this._isValidId(g.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(g,s),this._update(!0)):this}getSlot(g){const s=this.getLayer(g);return s&&s.slot||null}setSlot(g,s){return this.style.setSlot(g,s),this.style.mergeLayers(),this._update(!0)}addImport(g,s){return this.style.addImport(g,s).catch(d=>this.fire(new o.y(new Error("Failed to add import",d)))),this}updateImport(g,s){return typeof s!="string"&&s.id!==g?(this.removeImport(g),this.addImport(s)):(this.style.updateImport(g,s),this._update(!0))}removeImport(g){return this.style.removeImport(g),this}moveImport(g,s){return this.style.moveImport(g,s),this._update(!0)}moveLayer(g,s){return this._isValidId(g)?(this.style.moveLayer(g,s),this._update(!0)):this}removeLayer(g){return this._isValidId(g)?(this.style.removeLayer(g),this._update(!0)):this}getLayer(g){if(!this._isValidId(g))return null;const s=this.style.getOwnLayer(g);return s?s.type==="custom"?s.implementation:s.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(g,s,d){return this._isValidId(g)?(this.style.setLayerZoomRange(g,s,d),this._update(!0)):this}setFilter(g,s,d={}){return this._isValidId(g)?(this.style.setFilter(g,s,d),this._update(!0)):this}getFilter(g){return this._isValidId(g)?this.style.getFilter(g):null}setPaintProperty(g,s,d,m={}){return this._isValidId(g)?(this.style.setPaintProperty(g,s,d,m),this._update(!0)):this}getPaintProperty(g,s){return this._isValidId(g)?this.style.getPaintProperty(g,s):null}setLayoutProperty(g,s,d,m={}){return this._isValidId(g)?(this.style.setLayoutProperty(g,s,d,m),this._update(!0)):this}getLayoutProperty(g,s){return this._isValidId(g)?this.style.getLayoutProperty(g,s):null}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(g){return this.style.setGlyphsUrl(g),this._update(!0)}getSchema(g){return this.style.getSchema(g)}setSchema(g,s){return this.style.setSchema(g,s),this._update(!0)}getConfig(g){return this.style.getConfig(g)}setConfig(g,s){return this.style.setConfig(g,s),this._update(!0)}getConfigProperty(g,s){return this.style.getConfigProperty(g,s)}setConfigProperty(g,s,d){return this.style.setConfigProperty(g,s,d),this._update(!0)}getFeaturesetDescriptors(g){return this.style.getFeaturesetDescriptors(g)}setLights(g){if(this._lazyInitEmptyStyle(),g&&g.length===1&&g[0].type==="flat"){const s=g[0];s.properties?this.style.setFlatLight(s.properties,s.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(g),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const g=this.style.getLights()||[];return g.length===0&&g.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),g}setLight(g,s={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:g}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(g){return this._lazyInitEmptyStyle(),!g&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(g),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(g){return this._lazyInitEmptyStyle(),this.style.setFog(g),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(g){return this._lazyInitEmptyStyle(),this.style.setSnow(g),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(g){return this._lazyInitEmptyStyle(),this.style.setRain(g),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(g){return this._lazyInitEmptyStyle(),this.style.setColorTheme(g),this._update(!0)}setImportColorTheme(g,s){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(g,s),this._update(!0)}setCamera(g){return this.style.setCamera(g),this._triggerCameraUpdate(g)}_triggerCameraUpdate(g){return this._update(this.transform.setOrthographicProjectionAtLowPitch(g["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(g){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(o.aR.convert(g),this.transform):0}setFeatureState(g,s){return g.source&&!this._isValidId(g.source)?this:(this.style.setFeatureState(g,s),this._update())}removeFeatureState(g,s){return g.source&&!this._isValidId(g.source)?this:(this.style.removeFeatureState(g,s),this._update())}getFeatureState(g){return g.source&&!this._isValidId(g.source)?null:this.style.getFeatureState(g)}_selectIndoorFloor(g){this.indoor.selectFloor(g)}_addIndoorControl(){this._indoorControl||(this._indoorControl=new wm),this.addControl(this._indoorControl,"right")}_removeIndoorControl(){this._indoorControl&&this.removeControl(this._indoorControl)}_updateContainerDimensions(){if(!this._container)return;const g=this._container.getBoundingClientRect().width||400,s=this._container.getBoundingClientRect().height||300;let d,m,v,b=this._container;for(;b&&(!m||!v);){const S=window.getComputedStyle(b).transform;S&&S!=="none"&&(d=S.match(/matrix.*\((.+)\)/)[1].split(", "),d[0]&&d[0]!=="0"&&d[0]!=="1"&&(m=d[0]),d[3]&&d[3]!=="0"&&d[3]!=="1"&&(v=d[3])),b=b.parentElement}this._containerWidth=m?Math.abs(g/m):g,this._containerHeight=v?Math.abs(s/v):s}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const g=this._container;g.classList.add("mapboxgl-map"),(this._missingCSSCanary=Q("div","mapboxgl-canary",g)).style.visibility="hidden",this._detectMissingCSS();const s=this._canvasContainer=Q("div","mapboxgl-canvas-container",g);this._canvas=Q("canvas","mapboxgl-canvas",s),this._interactive&&(s.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const d=this._controlContainer=Q("div","mapboxgl-control-container",g),m=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(v=>{m[v]=Q("div",`mapboxgl-ctrl-${v}`,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,s){const d=o.o.devicePixelRatio||1;this._canvas.width=d*Math.ceil(g),this._canvas.height=d*Math.ceil(s),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${s}px`}_addMarker(g){this._markers.push(g)}_removeMarker(g){const s=this._markers.indexOf(g);s!==-1&&this._markers.splice(s,1)}_addPopup(g){this._popups.push(g)}_removePopup(g){const s=this._popups.indexOf(g);s!==-1&&this._popups.splice(s,1)}_setupPainter(){const g=Object.assign({},ee.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),s=this._canvas.getContext("webgl2",g);s?(Qe(s,!0),this.painter=new zy(s,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp,this._worldview),this.on("data",d=>{d.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),o.k.testSupport(s)):this.fire(new o.y(new Error("Failed to initialize WebGL")))}_contextLost(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.z("webglcontextlost",{originalEvent:g}))}_contextRestored(g){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style&&(this.style.clearLayers(),this.style.imageManager.destroyAtlasTextures(),this.style.reloadModels(),this.style.clearSources()),this._update(),this.fire(new o.z("webglcontextrestored",{originalEvent:g}))}_onMapScroll(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_requestDomTask(g){!this.loaded()||this.loaded()&&!this.isMoving()?g():this._domRenderTaskQueue.add(g)}_render(g){let s;this.fire(new o.z("renderstart")),++this._frameId;const d=this.painter.context.extTimerQuery,m=o.o.now(),v=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(s=v.createQuery(),v.beginQuery(d.TIME_ELAPSED_EXT,s)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(g),this._domRenderTaskQueue.run(g),this._removed)return;this._updateProjectionTransition();const b=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const O=this.transform.zoom,z=this.transform.pitch,U=o.o.now(),F=new o.ac(O,{now:U,fadeDuration:b,pitch:z,transition:this.style.transition,worldview:this._worldview});this.style.update(F)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let S=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),S=this._updateAverageElevation(m),this.style.updateSources(this.transform),this.style.updateImageProviders(),this.isMoving()||this._forceMarkerAndPopupUpdate()):S=this._updateAverageElevation(m);const E=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,b,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),E&&(this._placementDirty=E.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:b,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new o.z("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,A.mark(T.load),this.fire(new o.z("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this.style.modelManager.isLoaded()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),s){const O=o.o.now()-m;v.endQuery(d.TIME_ELAPSED_EXT),setTimeout(()=>{const z=v.getQueryParameter(s,v.QUERY_RESULT)/1e6;v.deleteQuery(s),this.fire(new o.z("gpu-timing-frame",{cpuTime:O,gpuTime:z}))},50)}if(this.listens("gpu-timing-layer")){const O=this.painter.collectGpuTimers();setTimeout(()=>{const z=this.painter.queryGpuTimers(O);this.fire(new o.z("gpu-timing-layer",{layerTimes:z}))},50)}if(this.listens("gpu-timing-deferred-render")){const O=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const z=this.painter.queryGpuTimeDeferredRender(O);this.fire(new o.z("gpu-timing-deferred-render",{gpuTime:z}))},50)}const k=this._sourcesDirty||this._styleDirty||this._placementDirty||S;if(k||this._repaint)this.triggerRepaint();else{const O=this.idle();if(O&&(S=this._updateAverageElevation(m,!0)),S)this.triggerRepaint();else if(this._triggerFrame(!1),O&&(this.fire(new o.z("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const z=this._calculateSpeedIndex();this.fire(new o.z("speedindexcompleted",{speedIndex:z})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||k||(this._fullyLoaded=!0,A.mark(T.fullLoad),this._performanceMetricsCollection&&In(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(g){for(const s of this._markers)g&&!this.getRenderWorldCopies()&&(s._lngLat=s._lngLat.wrap()),s._update();for(const s of this._popups)!g||this.getRenderWorldCopies()||s._trackPointer||(s._lngLat=s._lngLat.wrap()),s._update()}_updateAverageElevation(g,s=!1){const d=v=>(this.transform.averageElevation=v,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&d(0);const m=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(m||(s||g-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(g)){const v=this.transform.averageElevation;let b=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(b)?b=0:this._averageElevationLastSampledAt=g;const S=Math.abs(v-b);if(S>1){if(this._isInitialLoad||m)return this._averageElevation.jumpTo(b),d(b);this._averageElevation.easeTo(b,g,300)}else if(S>1e-4)return this._averageElevation.jumpTo(b),d(b)}return!!this._averageElevation.isEasing(g)&&d(this._averageElevation.getValue(g))}_authenticate(){kn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,g=>{if(g&&(g.message===Re||g.status===401)){const s=this.painter.context.gl;Qe(s,!1),this._logoControl instanceof su&&this._logoControl._updateLogo(),s&&s.clear(s.DEPTH_BUFFER_BIT|s.COLOR_BUFFER_BIT|s.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new o.y(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Ur(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&ai(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const g=this._isDragging();this.painter.updateTerrain(this.style,g)}_calculateSpeedIndex(){const g=this.painter.canvasCopy(),s=this.painter.getCanvasCopiesAndTimestamps();s.timeStamps.push(performance.now());const d=this.painter.context.gl,m=d.createFramebuffer();function v(b){d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,b,0);const S=new Uint8Array(d.drawingBufferWidth*d.drawingBufferHeight*4);return d.readPixels(0,0,d.drawingBufferWidth,d.drawingBufferHeight,d.RGBA,d.UNSIGNED_BYTE,S),S}return d.bindFramebuffer(d.FRAMEBUFFER,m),this._canvasPixelComparison(v(g),s.canvasCopies.map(v),s.timeStamps)}_canvasPixelComparison(g,s,d){let m=d[1]-d[0];const v=g.length/4;for(let b=0;b<s.length;b++){const S=s[b];let E=0;for(let k=0;k<S.length;k+=4)S[k]===g[k]&&S[k+1]===g[k+1]&&S[k+2]===g[k+2]&&S[k+3]===g[k+3]&&(E+=1);m+=(d[b+2]-d[b+1])*(1-E/v)}return m}remove(){this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const g=this.painter.context.gl.getExtension("WEBGL_lose_context");g&&g.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),dr.delete(this.painter.context.gl),Wt.remove(),wo.remove(),this._removed=!0,this.fire(new o.z("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(g){this._renderNextFrame=this._renderNextFrame||g,this.style&&!this._frame&&(this._frame=o.o.frame(s=>{const d=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,d&&this._render(s)}))}_preloadTiles(g){const s=this.style?this.style.getSourceCaches():[];return o.bw(s,(d,m)=>d._preloadTiles(g,m),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(g){this._trackResize&&this.resize({originalEvent:g})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(g){this._showParseStatus!==g&&(this._showParseStatus=g,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(g){this._showTerrainWireframe!==g&&(this._showTerrainWireframe=g,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(g){this._showLayers2DWireframe!==g&&(this._showLayers2DWireframe=g,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(g){this._showLayers3DWireframe!==g&&(this._showLayers3DWireframe=g,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(g){this._speedIndexTiming!==g&&(this._speedIndexTiming=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,this._tp.refreshUI(),g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(g){this._showTileAABBs!==g&&(this._showTileAABBs=g,this._tp.refreshUI(),g&&this._update())}_setCacheLimits(g,s){o.eX(g,s)}get version(){return w}},NavigationControl:class{constructor(g={}){this.options=Object.assign({},oC,g),this._container=Q("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(o.aY(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",s=>{this._map&&this._map.zoomIn({},{originalEvent:s})}),Q("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",s=>{this._map&&this._map.zoomOut({},{originalEvent:s})}),Q("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.aY(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",s=>{const d=this._map;d&&(this.options.visualizePitch?d.resetNorthPitch({},{originalEvent:s}):d.resetNorth({},{originalEvent:s}))}),this._compassIcon=Q("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const g=this._map;if(!g)return;const s=g.getZoom(),d=s===g.getMaxZoom(),m=s===g.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())}_rotateCompassArrow(){const g=this._map;if(!g)return;const s=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(g.transform.pitch*(Math.PI/180)),.5)}) rotateX(${g.transform.pitch}deg) rotateZ(${g.transform.angle*(180/Math.PI)}deg)`:`rotate(${g.transform.angle*(180/Math.PI)}deg)`;g._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=s)})}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),g.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&g.on("pitch",this._rotateCompassArrow),g.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new sC(g,this._compass,this.options.visualizePitch)),this._container}onRemove(){const g=this._map;g&&(this._container.remove(),this.options.showZoom&&g.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&g.off("pitch",this._rotateCompassArrow),g.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(g,s){const d=Q("button",g,this._container);return d.type="button",d.addEventListener("click",s),d}_setButtonTitle(g,s){if(!this._map)return;const d=this._map._getUIString(`NavigationControl.${s}`);g.setAttribute("aria-label",d),g.firstElementChild&&g.firstElementChild.setAttribute("title",d)}},GeolocateControl:class extends o.E{constructor(g={}){super();const s=navigator.geolocation;this.options=Object.assign({geolocation:s},Ld,g),o.aY(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Zg(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(g){return this._map=g,this._container=Q("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(g){const s=(d=!!this.options.geolocation)=>{this._supportsGeolocation=d,g(d)};this._supportsGeolocation!==void 0?g(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(d=>s(d.state!=="denied")).catch(()=>s()):s()}_isOutOfMapMaxBounds(g){const s=this._map.getMaxBounds(),d=g.coords;return!!s&&(d.longitude<s.getWest()||d.longitude>s.getEast()||d.latitude<s.getSouth()||d.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(g){if(this._map){if(this._isOutOfMapMaxBounds(g))return this._setErrorState(),this.fire(new o.z("outofmaxbounds",g)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=g,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(g),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(g),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new o.z("geolocate",g)),this._finish()}}_updateCamera(g){const s=new o.aR(g.coords.longitude,g.coords.latitude),d=g.coords.accuracy,m=this._map.getBearing(),v=Object.assign({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(s.toBounds(d),v,{geolocateSource:!0})}_updateMarker(g){if(g){const s=new o.aR(g.coords.longitude,g.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=g.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const g=this._map.transform,s=o.ce(1,g._center.lat)*g.worldSize,d=Math.ceil(2*this._accuracy*s);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(g){if(this._map){if(this.options.trackUserLocation)if(g.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(g.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new o.z("error",g)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(g){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",s=>s.preventDefault()),this._geolocateButton=Q("button","mapboxgl-ctrl-geolocate",this._container),Q("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",g===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Q("div","mapboxgl-user-location"),this._dotElement.appendChild(Q("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Q("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ph({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Q("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ph({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||s.originalEvent&&s.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new o.z("trackuserlocationend")))})}}_onDeviceOrientation(g){this._userLocationDotMarker&&(g.webkitCompassHeading?this._heading=g.webkitCompassHeading:g.absolute===!0&&(this._heading=-1*g.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.z("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.z("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.z("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(g={maximumAge:6e5,timeout:0},this._noTimeout=!0):(g=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,g),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const g=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(s=>{s==="granted"&&g()}).catch(console.error):g()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:xm,ScaleControl:class{constructor(g={}){this.options=Object.assign({},Uu,g),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),o.aY(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const g=this.options.maxWidth||100,s=this._map,d=s._containerHeight/2,m=s._containerWidth/2-g/2,v=s.unproject([m,d]),b=s.unproject([m+g,d]),S=v.distanceTo(b);if(this.options.unit==="imperial"){const E=3.2808*S;E>5280?this._setScale(g,E/5280,"mile"):this._setScale(g,E,"foot")}else this.options.unit==="nautical"?this._setScale(g,S/1852,"nautical-mile"):S>=1e3?this._setScale(g,S/1e3,"kilometer"):this._setScale(g,S,"meter")}_setScale(g,s,d){this._map._requestDomTask(()=>{const m=function(b){const S=Math.pow(10,`${Math.floor(b)}`.length-1);let E=b/S;return E=E>=10?10:E>=5?5:E>=3?3:E>=2?2:E>=1?1:function(k){const O=Math.pow(10,Math.ceil(-Math.log(k)/Math.LN10));return Math.round(k*O)/O}(E),S*E}(s),v=m/s;this._container.innerHTML=this._isNumberFormatSupported&&d!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:d}).format(m):`${m}&nbsp;${Hu[d]}`,this._container.style.width=g*v+"px"})}onAdd(g){return this._map=g,this._language=g.getLanguage(),this._container=Q("div","mapboxgl-ctrl mapboxgl-ctrl-scale",g.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(g){this._language=g,this._update()}setUnit(g){this.options.unit=g,this._update()}},FullscreenControl:class{constructor(g={}){this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:o.w("Full screen control 'container' must be a DOM element.")),o.aY(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=Q("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const g=this._fullscreenButton=Q("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Q("span","mapboxgl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",g)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},IndoorControl:wm,Popup:class extends o.E{constructor(g){super(),this.options=Object.assign(Object.create(Mh),g),this._altitude=this.options.altitude,o.aY(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(g&&g.className?g.className.trim().split(/\s+/):[])}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&g.on("preclick",this._onClose),this.options.closeOnMove&&g.on("move",this._onClose),g.on("remove",this.remove),this._update(),g._addPopup(this),this._focusFirstElement(),this._trackPointer?(g.on("mousemove",this._onMouseEvent),g.on("mouseup",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")):g.on("move",this._update),this.fire(new o.z("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const g=this._map;return g&&(g.off("move",this._update),g.off("move",this._onClose),g.off("preclick",this._onClose),g.off("click",this._onClose),g.off("remove",this.remove),g.off("mousemove",this._onMouseEvent),g.off("mouseup",this._onMouseEvent),g.off("drag",this._onMouseEvent),g._canvasContainer&&g._canvasContainer.classList.remove("mapboxgl-track-pointer"),g._removePopup(this),this._map=void 0),this.fire(new o.z("close")),this}getLngLat(){return this._lngLat}setLngLat(g){this._lngLat=o.aR.convert(g),this._pos=null,this._trackPointer=!1,this._update();const s=this._map;return s&&(s.on("move",this._update),s.off("mousemove",this._onMouseEvent),s._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(g){return this._altitude=g,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const g=this._map;return g&&(g.off("move",this._update),g.on("mousemove",this._onMouseEvent),g.on("drag",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const s=document.createDocumentFragment(),d=document.createElement("body");let m;for(d.innerHTML=g;m=d.firstChild,m;)s.appendChild(m);return this.setDOMContent(s)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){let s=this._content;if(s)for(;s.hasChildNodes();)s.firstChild&&s.removeChild(s.firstChild);else s=this._content=Q("div","mapboxgl-popup-content",this._container||void 0);if(s.appendChild(g),this.options.closeButton){const d=this._closeButton=Q("button","mapboxgl-popup-close-button",s);d.type="button",d.setAttribute("aria-label","Close popup"),d.innerHTML='<span aria-hidden="true">&#215;</span>',d.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(g){return this._classList.add(g),this._updateClassList(),this}removeClassName(g){return this._classList.delete(g),this._updateClassList(),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){let s;return this._classList.delete(g)?s=!1:(this._classList.add(g),s=!0),this._updateClassList(),s}_onMouseEvent(g){this._update(g.point)}_getAnchor(g){if(this.options.anchor)return this.options.anchor;const s=this._map,d=this._container,m=this._pos;if(!s||!d||!m)return"bottom";const v=d.offsetWidth,b=d.offsetHeight,S=m.x<v/2,E=m.x>s.transform.width-v/2;if(m.y+g<b)return S?"top-left":E?"top-right":"top";if(m.y>s.transform.height-b){if(S)return"bottom-left";if(E)return"bottom-right"}return S?"left":E?"right":"bottom"}_updateClassList(){const g=this._container;if(!g)return;const s=[...this._classList];s.push("mapboxgl-popup"),this._anchor&&s.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&s.push("mapboxgl-popup-track-pointer"),g.className=s.join(" ")}_update(g){const s=this._map,d=this._content;if(!s||!this._lngLat&&!this._trackPointer||!d)return;let m=this._container;if(m||(m=this._container=Q("div","mapboxgl-popup",s.getContainer()),this._tip=Q("div","mapboxgl-popup-tip",m),m.appendChild(d)),this.options.maxWidth&&m.style.maxWidth!==this.options.maxWidth&&(m.style.maxWidth=this.options.maxWidth),s.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=r_(this._lngLat,this._pos,s.transform)),!this._trackPointer||g){const v=this._pos=this._trackPointer&&g instanceof o.P?g:s.project(this._lngLat,this._altitude),b=l1(this.options.offset),S=this._anchor=this._getAnchor(b.y),E=l1(this.options.offset,S),k=v.add(E).round();s._requestDomTask(()=>{this._container&&S&&(this._container.style.transform=`${Em[S]} translate(${k.x}px,${k.y}px)`)})}if(!this._marker&&s._showingGlobe()){const v=o.eY(s.transform,this._lngLat)?0:1;this._setOpacity(v)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(Ic);g&&g.focus()}_onClose(){this.remove()}_setOpacity(g){this._container&&(this._container.style.opacity=`${g}`),this._content&&(this._content.style.pointerEvents=g?"auto":"none")}},Marker:Ph,Style:nl,LngLat:o.aR,LngLatBounds:o.aI,Point:o.P,MercatorCoordinate:o.ae,FreeCameraOptions:Xp,Evented:o.E,config:o.e,prewarm:o.f0,clearPrewarmedResources:o.e$,get accessToken(){return o.e.ACCESS_TOKEN},set accessToken(g){o.e.ACCESS_TOKEN=g},get baseApiUrl(){return o.e.API_URL},set baseApiUrl(g){o.e.API_URL=g},get workerCount(){return o.f9.workerCount},set workerCount(g){o.f9.workerCount=g},get maxParallelImageRequests(){return o.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(g){o.e.MAX_PARALLEL_IMAGE_REQUESTS=g},clearStorage(g){o.f8(g)},get workerUrl(){return o.f7.workerUrl},set workerUrl(g){o.f7.workerUrl=g},get workerClass(){return o.f7.workerClass},set workerClass(g){o.f7.workerClass=g},get workerParams(){return o.f7.workerParams},set workerParams(g){o.f7.workerParams=g},get dracoUrl(){return o.f6()},set dracoUrl(g){o.f5(g)},get meshoptUrl(){return o.f4()},set meshoptUrl(g){o.f3(g)},setNow:o.o.setNow,restoreNow:o.o.restoreNow}});var p=c;return p})})(O6);var ege=O6.exports;const dp=ZH(ege),tge={class:"container py-4"},nge={class:"card p-3 mb-3 shadow-sm"},ige={class:"row g-2 align-items-end"},rge={class:"col-md-4"},oge={class:"col-md-2"},sge={class:"col-md-3"},age=["disabled"],lge={class:"row g-2"},cge={class:"col-md-5"},uge={class:"col-md-5"},dge={key:0,class:"alert alert-info mt-3 mb-0"},hge={class:"row g-3"},fge={class:"col-lg-4"},pge={class:"card p-3 shadow-sm h-100"},mge={class:"mb-2"},gge={key:0,class:"text-muted"},_ge={key:1,class:"list-group list-group-flush small overflow-auto",style:{"max-height":"480px"}},yge={class:"d-flex align-items-start justify-content-between"},vge={class:"me-2"},bge={class:"fw-semibold"},xge={class:"text-muted"},wge={class:"d-flex gap-2"},Sge=["onClick"],Cge=["onClick"],Tge={class:"mt-3"},Ege=["disabled"],Vh="route-line",Ige={__name:"Map",setup(t){const e="pk.eyJ1IjoiYW1pdGFyYWplZXYiLCJhIjoiY21ndm40MXN6MGhiZzJycHFmZHE1N25wNSJ9.W_zEzwfJyanaqJpeBdXsdg";dp.accessToken=e;const n=Si(null),r=Si(null),c=Si(null),u=Si(!1),p=Si(!1),o=Si("counselling"),w=Si(5),T=Si([]),A=Si(""),D=Si(""),B=Si(!1),N=Si(null);lh(async()=>{n.value=new dp.Map({container:"map",style:"mapbox://styles/mapbox/streets-v12",center:[144.9631,-37.8136],zoom:11}),n.value.addControl(new dp.NavigationControl,"top-right"),r.value=new dp.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}),n.value.addControl(r.value,"top-left"),r.value.on("geolocate",me=>{var Zt,on;const Te=(me==null?void 0:me.coords)||((Zt=me==null?void 0:me.position)==null?void 0:Zt.coords),Re=typeof(Te==null?void 0:Te.longitude)=="number"?Te.longitude:null,tn=typeof(Te==null?void 0:Te.latitude)=="number"?Te.latitude:null;Re==null||tn==null||(c.value=[Re,tn],A.value=`${tn.toFixed(5)}, ${Re.toFixed(5)}`,(on=n.value)==null||on.flyTo({center:[Re,tn],zoom:Math.max(n.value.getZoom(),13)}))}),r.value.on("error",me=>{console.warn("Geolocation error:",me),alert("Could not access your location. You can still type an address.")}),n.value.on("load",()=>{u.value=!0})});async function ee(){if(c.value&&Number.isFinite(c.value[0]))return c.value;const me=await de(A.value);if(me)return c.value=me,c.value;if(r.value)try{const Te=await new Promise((Re,tn)=>{const Zt=setTimeout(()=>tn(new Error("geolocate timeout")),5e3),on=hn=>{var Ri,zi;clearTimeout(Zt),(Ri=r.value)==null||Ri.off("geolocate",on);const Hn=(hn==null?void 0:hn.coords)||((zi=hn==null?void 0:hn.position)==null?void 0:zi.coords);Hn&&Number.isFinite(Hn.longitude)&&Number.isFinite(Hn.latitude)?Re([Hn.longitude,Hn.latitude]):tn(new Error("bad coords"))};r.value.on("geolocate",on),r.value.trigger()});if(Te)return c.value=Te,A.value=`${Te[1].toFixed(5)}, ${Te[0].toFixed(5)}`,c.value}catch{}if("geolocation"in navigator)try{const Te=await new Promise((Re,tn)=>{navigator.geolocation.getCurrentPosition(Zt=>Re([Zt.coords.longitude,Zt.coords.latitude]),Zt=>tn(Zt),{enableHighAccuracy:!0,timeout:1e4})});return c.value=Te,A.value=`${Te[1].toFixed(5)}, ${Te[0].toFixed(5)}`,c.value}catch{}return null}function Q(){try{if(r.value){r.value.trigger(),alert("Waiting for your location — please allow the browser prompt.");return}}catch{}"geolocation"in navigator?(alert("Waiting for your location (browser will prompt)…"),navigator.geolocation.getCurrentPosition(me=>{var tn;const{longitude:Te,latitude:Re}=me.coords;c.value=[Te,Re],A.value=`${Re.toFixed(5)}, ${Te.toFixed(5)}`,(tn=n.value)==null||tn.flyTo({center:[Te,Re],zoom:15})},me=>alert("Could not get location: "+me.message),{enableHighAccuracy:!0,timeout:1e4})):alert("Geolocation is not supported in this browser.")}async function se(me,Te,Re={}){const tn=new AbortController,Zt=Re.timeoutMs??1e4,on=setTimeout(()=>tn.abort("timeout"),Zt);try{const hn=new URL(`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(me)}.json`);hn.searchParams.set("access_token",e),hn.searchParams.set("limit",String(Re.limit??25)),hn.searchParams.set("types","poi,place,locality,neighborhood,address"),hn.searchParams.set("language","en"),hn.searchParams.set("country","AU"),Te&&hn.searchParams.set("proximity",`${Te[0]},${Te[1]}`);const Hn=await fetch(hn,{signal:tn.signal});if(!Hn.ok)throw new Error(`geocode ${Hn.status}`);return(await Hn.json()).features||[]}finally{clearTimeout(on)}}async function ce(){const me=await ee();if(!me){alert("Could not determine your location yet. Click “📍 Use my location” or type an origin.");return}if(o.value.trim()){p.value=!0;try{oe();let Te=[];try{Te=await se(o.value,me,{timeoutMs:1e4})}catch(tn){console.warn("Proximity geocode failed/timeout; retry without proximity",tn)}Te.length||(Te=await se(o.value,null,{timeoutMs:1e4}));const Re=Te.filter(tn=>Ee(me[1],me[0],tn.center[1],tn.center[0])<=w.value);if(T.value=Re,Re.forEach(be),Re.length){const tn=new dp.LngLatBounds;Re.forEach(Zt=>tn.extend(Zt.center)),tn.extend(me),n.value.fitBounds(tn,{padding:40})}else alert("No matches within the selected radius. Try a broader search or different keyword.")}catch(Te){console.warn("Nearby search failed",Te),alert("Search timed out or failed. Please try again or broaden your search.")}finally{p.value=!1}}}function be(me){const Te=document.createElement("div");Te.className="poi-marker";const Re=new dp.Marker(Te).setLngLat(me.center),tn=`
    <div style="max-width:240px">
      <strong>${$e(me.text)}</strong>
      <div class="text-muted" style="font-size:12px">${$e(me.place_name)}</div>
      <div class="mt-2 d-flex gap-2">
        <button id="fly-${me.id}" class="btn btn-sm btn-outline-secondary">Fly</button>
        <button id="route-${me.id}" class="btn btn-sm btn-custom">Route</button>
      </div>
    </div>
  `;Re.setPopup(new dp.Popup({offset:16}).setHTML(tn)),Re.addTo(n.value),Re.getElement().addEventListener("click",()=>{setTimeout(()=>{const Zt=document.getElementById(`fly-${me.id}`),on=document.getElementById(`route-${me.id}`);Zt&&Zt.addEventListener("click",()=>ze(me)),on&&on.addEventListener("click",()=>xe(me))})})}function ze(me){n.value.flyTo({center:me.center,zoom:15})}function xe(me){D.value=me.place_name,ze(me)}async function je(){var zi;const me=await de(A.value)||c.value,Te=await de(D.value);if(!me||!Te){alert("Please provide valid From and To locations.");return}const Re="driving",tn=new URL(`https://api.mapbox.com/directions/v5/mapbox/${Re}/${me[0]},${me[1]};${Te[0]},${Te[1]}`);tn.searchParams.set("geometries","geojson"),tn.searchParams.set("overview","full"),tn.searchParams.set("access_token",e);const on=await(await fetch(tn)).json(),hn=(zi=on==null?void 0:on.routes)==null?void 0:zi[0];if(!hn){alert("No route found.");return}const Hn={type:"Feature",geometry:hn.geometry,properties:{}};n.value.getSource(Vh)?n.value.getSource(Vh).setData(Hn):(n.value.addSource(Vh,{type:"geojson",data:Hn}),n.value.addLayer({id:Vh,type:"line",source:Vh,paint:{"line-color":"#0078ff","line-width":5,"line-opacity":.85}})),B.value=!0,N.value={profile:Re,distanceKm:hn.distance/1e3,durationMin:hn.duration/60};const Ri=new dp.LngLatBounds;hn.geometry.coordinates.forEach(Pt=>Ri.extend(Pt)),n.value.fitBounds(Ri,{padding:50})}function qe(){var me,Te;(me=n.value)!=null&&me.getLayer(Vh)&&n.value.removeLayer(Vh),(Te=n.value)!=null&&Te.getSource(Vh)&&n.value.removeSource(Vh),B.value=!1,N.value=null}function oe(){document.querySelectorAll(".poi-marker").forEach(me=>me.remove()),T.value=[]}async function de(me){var Zt;const Te=(me||"").trim();if(!Te)return null;const Re=Te.match(/(-?\d+(\.\d+)?)\s*,\s*(-?\d+(\.\d+)?)/);if(Re){const on=parseFloat(Re[1]),hn=parseFloat(Re[3]);return Math.abs(on)<=180&&Math.abs(hn)<=90?[on,hn]:[hn,on]}return((Zt=(await se(Te,c.value||void 0))[0])==null?void 0:Zt.center)||null}function Ee(me,Te,Re,tn){const on=(Re-me)*Math.PI/180,hn=(tn-Te)*Math.PI/180,Hn=Math.sin(on/2)**2+Math.cos(me*Math.PI/180)*Math.cos(Re*Math.PI/180)*Math.sin(hn/2)**2;return 6371*2*Math.atan2(Math.sqrt(Hn),Math.sqrt(1-Hn))}function $e(me=""){return String(me).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}return(me,Te)=>(We(),wt("section",tge,[Te[13]||(Te[13]=Pe("h1",{class:"mb-3"},"Find Support Near You",-1)),Pe("div",nge,[Pe("div",ige,[Pe("div",rge,[Te[4]||(Te[4]=Pe("label",{class:"form-label"},"Search nearby (keyword)",-1)),Ki(Pe("input",{"onUpdate:modelValue":Te[0]||(Te[0]=Re=>o.value=Re),type:"text",class:"form-control",placeholder:"e.g., counselling, clinic, youth centre"},null,512),[[to,o.value]])]),Pe("div",oge,[Te[5]||(Te[5]=Pe("label",{class:"form-label"},"Radius (km)",-1)),Ki(Pe("input",{"onUpdate:modelValue":Te[1]||(Te[1]=Re=>w.value=Re),type:"number",min:"1",max:"50",class:"form-control"},null,512),[[to,w.value,void 0,{number:!0}]])]),Pe("div",sge,[Pe("button",{class:"btn btn-custom w-100",onClick:ce,disabled:!u.value||p.value},wr(p.value?"Searching…":"Search Places Near Me"),9,age)]),Pe("div",{class:"col-md-3"},[Pe("button",{class:"btn btn-outline-secondary w-100",onClick:oe},"Clear Results")])]),Te[11]||(Te[11]=Pe("hr",{class:"my-3"},null,-1)),Pe("div",lge,[Pe("div",cge,[Te[6]||(Te[6]=Pe("label",{class:"form-label"},"From",-1)),Ki(Pe("input",{"onUpdate:modelValue":Te[2]||(Te[2]=Re=>A.value=Re),type:"text",class:"form-control",placeholder:"Use my location or type an address"},null,512),[[to,A.value]]),Te[7]||(Te[7]=Pe("small",{class:"text-muted"},"Tip: leave blank to use your current location.",-1)),Pe("button",{class:"btn btn-outline-primary mt-2",onClick:Q},"📍 Use my location")]),Pe("div",uge,[Te[8]||(Te[8]=Pe("label",{class:"form-label"},"To",-1)),Ki(Pe("input",{"onUpdate:modelValue":Te[3]||(Te[3]=Re=>D.value=Re),type:"text",class:"form-control",placeholder:"Click a marker or type an address"},null,512),[[to,D.value]]),Te[9]||(Te[9]=Pe("small",{class:"text-muted"},"Click a map marker to auto-fill.",-1))]),Pe("div",{class:"col-md-2 d-grid"},[Pe("button",{class:"btn btn-custom",onClick:je},"Get Route")])]),N.value?(We(),wt("div",dge,[Te[10]||(Te[10]=Pe("strong",null,"Trip:",-1)),Ss(" "+wr(N.value.distanceKm.toFixed(2))+" km • "+wr(N.value.durationMin.toFixed(0))+" mins ("+wr(N.value.profile)+") ",1)])):Zn("",!0)]),Pe("div",hge,[Te[12]||(Te[12]=Pe("div",{class:"col-lg-8"},[Pe("div",{id:"map",class:"mapbox"})],-1)),Pe("div",fge,[Pe("div",pge,[Pe("h5",mge,"Results ("+wr(T.value.length)+")",1),T.value.length?(We(),wt("ul",_ge,[(We(!0),wt(Mi,null,ea(T.value,(Re,tn)=>(We(),wt("li",{key:tn,class:"list-group-item"},[Pe("div",yge,[Pe("div",vge,[Pe("div",bge,wr(Re.text),1),Pe("div",xge,wr(Re.place_name),1)]),Pe("div",wge,[Pe("button",{class:"btn btn-sm btn-outline-secondary",onClick:Zt=>ze(Re)},"Fly",8,Sge),Pe("button",{class:"btn btn-sm btn-custom",onClick:Zt=>xe(Re)},"Route",8,Cge)])])]))),128))])):(We(),wt("div",gge,"No places yet—try a nearby search above.")),Pe("div",Tge,[Pe("button",{class:"btn btn-outline-danger w-100",onClick:qe,disabled:!B.value},"Clear Route",8,Ege)])])])])]))}},Age=Cu(Ige,[["__scopeId","data-v-1218e8f6"]]);/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function F0(t){return t+.5|0}const Cp=(t,e,n)=>Math.max(Math.min(t,n),e);function Yv(t){return Cp(F0(t*2.55),0,255)}function Dp(t){return Cp(F0(t*255),0,255)}function Wh(t){return Cp(F0(t/2.55)/100,0,1)}function i5(t){return Cp(F0(t*100),0,100)}const pu={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},yE=[..."0123456789ABCDEF"],kge=t=>yE[t&15],Rge=t=>yE[(t&240)>>4]+yE[t&15],bx=t=>(t&240)>>4===(t&15),Pge=t=>bx(t.r)&&bx(t.g)&&bx(t.b)&&bx(t.a);function Mge(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&pu[t[1]]*17,g:255&pu[t[2]]*17,b:255&pu[t[3]]*17,a:e===5?pu[t[4]]*17:255}:(e===7||e===9)&&(n={r:pu[t[1]]<<4|pu[t[2]],g:pu[t[3]]<<4|pu[t[4]],b:pu[t[5]]<<4|pu[t[6]],a:e===9?pu[t[7]]<<4|pu[t[8]]:255})),n}const Dge=(t,e)=>t<255?e(t):"";function Oge(t){var e=Pge(t)?kge:Rge;return t?"#"+e(t.r)+e(t.g)+e(t.b)+Dge(t.a,e):void 0}const Lge=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function z6(t,e,n){const r=e*Math.min(n,1-n),c=(u,p=(u+t/30)%12)=>n-r*Math.max(Math.min(p-3,9-p,1),-1);return[c(0),c(8),c(4)]}function zge(t,e,n){const r=(c,u=(c+t/60)%6)=>n-n*e*Math.max(Math.min(u,4-u,1),0);return[r(5),r(3),r(1)]}function Bge(t,e,n){const r=z6(t,1,.5);let c;for(e+n>1&&(c=1/(e+n),e*=c,n*=c),c=0;c<3;c++)r[c]*=1-e-n,r[c]+=e;return r}function Fge(t,e,n,r,c){return t===c?(e-n)/r+(e<n?6:0):e===c?(n-t)/r+2:(t-e)/r+4}function KI(t){const n=t.r/255,r=t.g/255,c=t.b/255,u=Math.max(n,r,c),p=Math.min(n,r,c),o=(u+p)/2;let w,T,A;return u!==p&&(A=u-p,T=o>.5?A/(2-u-p):A/(u+p),w=Fge(n,r,c,A,u),w=w*60+.5),[w|0,T||0,o]}function XI(t,e,n,r){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,r)).map(Dp)}function YI(t,e,n){return XI(z6,t,e,n)}function Nge(t,e,n){return XI(Bge,t,e,n)}function Vge(t,e,n){return XI(zge,t,e,n)}function B6(t){return(t%360+360)%360}function $ge(t){const e=Lge.exec(t);let n=255,r;if(!e)return;e[5]!==r&&(n=e[6]?Yv(+e[5]):Dp(+e[5]));const c=B6(+e[2]),u=+e[3]/100,p=+e[4]/100;return e[1]==="hwb"?r=Nge(c,u,p):e[1]==="hsv"?r=Vge(c,u,p):r=YI(c,u,p),{r:r[0],g:r[1],b:r[2],a:n}}function jge(t,e){var n=KI(t);n[0]=B6(n[0]+e),n=YI(n),t.r=n[0],t.g=n[1],t.b=n[2]}function Uge(t){if(!t)return;const e=KI(t),n=e[0],r=i5(e[1]),c=i5(e[2]);return t.a<255?`hsla(${n}, ${r}%, ${c}%, ${Wh(t.a)})`:`hsl(${n}, ${r}%, ${c}%)`}const r5={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},o5={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Hge(){const t={},e=Object.keys(o5),n=Object.keys(r5);let r,c,u,p,o;for(r=0;r<e.length;r++){for(p=o=e[r],c=0;c<n.length;c++)u=n[c],o=o.replace(u,r5[u]);u=parseInt(o5[p],16),t[o]=[u>>16&255,u>>8&255,u&255]}return t}let xx;function Gge(t){xx||(xx=Hge(),xx.transparent=[0,0,0,0]);const e=xx[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const Wge=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function qge(t){const e=Wge.exec(t);let n=255,r,c,u;if(e){if(e[7]!==r){const p=+e[7];n=e[8]?Yv(p):Cp(p*255,0,255)}return r=+e[1],c=+e[3],u=+e[5],r=255&(e[2]?Yv(r):Cp(r,0,255)),c=255&(e[4]?Yv(c):Cp(c,0,255)),u=255&(e[6]?Yv(u):Cp(u,0,255)),{r,g:c,b:u,a:n}}}function Zge(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${Wh(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const eT=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,T_=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function Kge(t,e,n){const r=T_(Wh(t.r)),c=T_(Wh(t.g)),u=T_(Wh(t.b));return{r:Dp(eT(r+n*(T_(Wh(e.r))-r))),g:Dp(eT(c+n*(T_(Wh(e.g))-c))),b:Dp(eT(u+n*(T_(Wh(e.b))-u))),a:t.a+n*(e.a-t.a)}}function wx(t,e,n){if(t){let r=KI(t);r[e]=Math.max(0,Math.min(r[e]+r[e]*n,e===0?360:1)),r=YI(r),t.r=r[0],t.g=r[1],t.b=r[2]}}function F6(t,e){return t&&Object.assign(e||{},t)}function s5(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=Dp(t[3]))):(e=F6(t,{r:0,g:0,b:0,a:1}),e.a=Dp(e.a)),e}function Xge(t){return t.charAt(0)==="r"?qge(t):$ge(t)}class m0{constructor(e){if(e instanceof m0)return e;const n=typeof e;let r;n==="object"?r=s5(e):n==="string"&&(r=Mge(e)||Gge(e)||Xge(e)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var e=F6(this._rgb);return e&&(e.a=Wh(e.a)),e}set rgb(e){this._rgb=s5(e)}rgbString(){return this._valid?Zge(this._rgb):void 0}hexString(){return this._valid?Oge(this._rgb):void 0}hslString(){return this._valid?Uge(this._rgb):void 0}mix(e,n){if(e){const r=this.rgb,c=e.rgb;let u;const p=n===u?.5:n,o=2*p-1,w=r.a-c.a,T=((o*w===-1?o:(o+w)/(1+o*w))+1)/2;u=1-T,r.r=255&T*r.r+u*c.r+.5,r.g=255&T*r.g+u*c.g+.5,r.b=255&T*r.b+u*c.b+.5,r.a=p*r.a+(1-p)*c.a,this.rgb=r}return this}interpolate(e,n){return e&&(this._rgb=Kge(this._rgb,e._rgb,n)),this}clone(){return new m0(this.rgb)}alpha(e){return this._rgb.a=Dp(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=F0(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return wx(this._rgb,2,e),this}darken(e){return wx(this._rgb,2,-e),this}saturate(e){return wx(this._rgb,1,e),this}desaturate(e){return wx(this._rgb,1,-e),this}rotate(e){return jge(this._rgb,e),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function $h(){}const Yge=(()=>{let t=0;return()=>t++})();function ls(t){return t==null}function wa(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Eo(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function wu(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function Hd(t,e){return wu(t)?t:e}function Oo(t,e){return typeof t>"u"?e:t}const Jge=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function ws(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function Wo(t,e,n,r){let c,u,p;if(wa(t))for(u=t.length,c=0;c<u;c++)e.call(n,t[c],c);else if(Eo(t))for(p=Object.keys(t),u=p.length,c=0;c<u;c++)e.call(n,t[p[c]],p[c])}function Fw(t,e){let n,r,c,u;if(!t||!e||t.length!==e.length)return!1;for(n=0,r=t.length;n<r;++n)if(c=t[n],u=e[n],c.datasetIndex!==u.datasetIndex||c.index!==u.index)return!1;return!0}function Nw(t){if(wa(t))return t.map(Nw);if(Eo(t)){const e=Object.create(null),n=Object.keys(t),r=n.length;let c=0;for(;c<r;++c)e[n[c]]=Nw(t[n[c]]);return e}return t}function N6(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function Qge(t,e,n,r){if(!N6(t))return;const c=e[t],u=n[t];Eo(c)&&Eo(u)?g0(c,u,r):e[t]=Nw(u)}function g0(t,e,n){const r=wa(e)?e:[e],c=r.length;if(!Eo(t))return t;n=n||{};const u=n.merger||Qge;let p;for(let o=0;o<c;++o){if(p=r[o],!Eo(p))continue;const w=Object.keys(p);for(let T=0,A=w.length;T<A;++T)u(w[T],t,p,n)}return t}function mb(t,e){return g0(t,e,{merger:e_e})}function e_e(t,e,n){if(!N6(t))return;const r=e[t],c=n[t];Eo(r)&&Eo(c)?mb(r,c):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=Nw(c))}const a5={"":t=>t,x:t=>t.x,y:t=>t.y};function t_e(t){const e=t.split("."),n=[];let r="";for(const c of e)r+=c,r.endsWith("\\")?r=r.slice(0,-1)+".":(n.push(r),r="");return n}function n_e(t){const e=t_e(t);return n=>{for(const r of e){if(r==="")break;n=n&&n[r]}return n}}function ay(t,e){return(a5[e]||(a5[e]=n_e(e)))(t)}function JI(t){return t.charAt(0).toUpperCase()+t.slice(1)}const _0=t=>typeof t<"u",$p=t=>typeof t=="function",l5=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function i_e(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const gl=Math.PI,Op=2*gl,Vw=Number.POSITIVE_INFINITY,r_e=gl/180,id=gl/2,Nm=gl/4,c5=gl*2/3,V6=Math.log10,Lp=Math.sign;function ew(t,e,n){return Math.abs(t-e)<n}function u5(t){const e=Math.round(t);t=ew(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(V6(t))),r=t/n;return(r<=1?1:r<=2?2:r<=5?5:10)*n}function o_e(t){const e=[],n=Math.sqrt(t);let r;for(r=1;r<n;r++)t%r===0&&(e.push(r),e.push(t/r));return n===(n|0)&&e.push(n),e.sort((c,u)=>c-u).pop(),e}function s_e(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function $w(t){return!s_e(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function a_e(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function l_e(t,e,n){let r,c,u;for(r=0,c=t.length;r<c;r++)u=t[r][n],isNaN(u)||(e.min=Math.min(e.min,u),e.max=Math.max(e.max,u))}function ig(t){return t*(gl/180)}function c_e(t){return t*(180/gl)}function d5(t){if(!wu(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function u_e(t,e){const n=e.x-t.x,r=e.y-t.y,c=Math.sqrt(n*n+r*r);let u=Math.atan2(r,n);return u<-.5*gl&&(u+=Op),{angle:u,distance:c}}function d_e(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Vm(t){return(t%Op+Op)%Op}function h_e(t,e,n,r){const c=Vm(t),u=Vm(e),p=Vm(n),o=Vm(u-c),w=Vm(p-c),T=Vm(c-u),A=Vm(c-p);return c===u||c===p||r||o>w&&T<A}function rd(t,e,n){return Math.max(e,Math.min(n,t))}function f_e(t){return rd(t,-32768,32767)}function O_(t,e,n,r=1e-6){return t>=Math.min(e,n)-r&&t<=Math.max(e,n)+r}function QI(t,e,n){n=n||(p=>t[p]<e);let r=t.length-1,c=0,u;for(;r-c>1;)u=c+r>>1,n(u)?c=u:r=u;return{lo:c,hi:r}}const vE=(t,e,n,r)=>QI(t,n,r?c=>{const u=t[c][e];return u<n||u===n&&t[c+1][e]===n}:c=>t[c][e]<n),p_e=(t,e,n)=>QI(t,n,r=>t[r][e]>=n);function m_e(t,e,n){let r=0,c=t.length;for(;r<c&&t[r]<e;)r++;for(;c>r&&t[c-1]>n;)c--;return r>0||c<t.length?t.slice(r,c):t}const $6=["push","pop","shift","splice","unshift"];function g_e(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),$6.forEach(n=>{const r="_onData"+JI(n),c=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...u){const p=c.apply(this,u);return t._chartjs.listeners.forEach(o=>{typeof o[r]=="function"&&o[r](...u)}),p}})})}function h5(t,e){const n=t._chartjs;if(!n)return;const r=n.listeners,c=r.indexOf(e);c!==-1&&r.splice(c,1),!(r.length>0)&&($6.forEach(u=>{delete t[u]}),delete t._chartjs)}function j6(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const U6=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function H6(t,e){let n=[],r=!1;return function(...c){n=c,r||(r=!0,U6.call(window,()=>{r=!1,t.apply(e,n)}))}}function __e(t,e){let n;return function(...r){return e?(clearTimeout(n),n=setTimeout(t,e,r)):t.apply(this,r),e}}const eA=t=>t==="start"?"left":t==="end"?"right":"center",cl=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,y_e=(t,e,n,r)=>t===(r?"left":"right")?n:t==="center"?(e+n)/2:e,Sx=t=>t===0||t===1,f5=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Op/n)),p5=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*Op/n)+1,gb={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*id)+1,easeOutSine:t=>Math.sin(t*id),easeInOutSine:t=>-.5*(Math.cos(gl*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>Sx(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>Sx(t)?t:f5(t,.075,.3),easeOutElastic:t=>Sx(t)?t:p5(t,.075,.3),easeInOutElastic(t){return Sx(t)?t:t<.5?.5*f5(t*2,.1125,.45):.5+.5*p5(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-gb.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?gb.easeInBounce(t*2)*.5:gb.easeOutBounce(t*2-1)*.5+.5};function G6(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function m5(t){return G6(t)?t:new m0(t)}function tT(t){return G6(t)?t:new m0(t).saturate(.5).darken(.1).hexString()}const v_e=["x","y","borderWidth","radius","tension"],b_e=["color","borderColor","backgroundColor"];function x_e(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:b_e},numbers:{type:"number",properties:v_e}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function w_e(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const g5=new Map;function S_e(t,e){e=e||{};const n=t+JSON.stringify(e);let r=g5.get(n);return r||(r=new Intl.NumberFormat(t,e),g5.set(n,r)),r}function W6(t,e,n){return S_e(e,n).format(t)}const C_e={values(t){return wa(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const r=this.chart.options.locale;let c,u=t;if(n.length>1){const T=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(T<1e-4||T>1e15)&&(c="scientific"),u=T_e(t,n)}const p=V6(Math.abs(u)),o=isNaN(p)?1:Math.max(Math.min(-1*Math.floor(p),20),0),w={notation:c,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(w,this.options.ticks.format),W6(t,r,w)}};function T_e(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var q6={formatters:C_e};function E_e(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:q6.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const _g=Object.create(null),bE=Object.create(null);function _b(t,e){if(!e)return t;const n=e.split(".");for(let r=0,c=n.length;r<c;++r){const u=n[r];t=t[u]||(t[u]=Object.create(null))}return t}function nT(t,e,n){return typeof e=="string"?g0(_b(t,e),n):g0(_b(t,""),e)}class I_e{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,c)=>tT(c.backgroundColor),this.hoverBorderColor=(r,c)=>tT(c.borderColor),this.hoverColor=(r,c)=>tT(c.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return nT(this,e,n)}get(e){return _b(this,e)}describe(e,n){return nT(bE,e,n)}override(e,n){return nT(_g,e,n)}route(e,n,r,c){const u=_b(this,e),p=_b(this,r),o="_"+n;Object.defineProperties(u,{[o]:{value:u[n],writable:!0},[n]:{enumerable:!0,get(){const w=this[o],T=p[c];return Eo(w)?Object.assign({},T,w):Oo(w,T)},set(w){this[o]=w}}})}apply(e){e.forEach(n=>n(this))}}var oa=new I_e({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[x_e,w_e,E_e]);function A_e(t){return!t||ls(t.size)||ls(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function _5(t,e,n,r,c){let u=e[c];return u||(u=e[c]=t.measureText(c).width,n.push(c)),u>r&&(r=u),r}function $m(t,e,n){const r=t.currentDevicePixelRatio,c=n!==0?Math.max(n/2,.5):0;return Math.round((e-c)*r)/r+c}function y5(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function v5(t,e,n,r){Z6(t,e,n,r,null)}function Z6(t,e,n,r,c){let u,p,o,w,T,A,D,B;const N=e.pointStyle,ee=e.rotation,Q=e.radius;let se=(ee||0)*r_e;if(N&&typeof N=="object"&&(u=N.toString(),u==="[object HTMLImageElement]"||u==="[object HTMLCanvasElement]")){t.save(),t.translate(n,r),t.rotate(se),t.drawImage(N,-N.width/2,-N.height/2,N.width,N.height),t.restore();return}if(!(isNaN(Q)||Q<=0)){switch(t.beginPath(),N){default:c?t.ellipse(n,r,c/2,Q,0,0,Op):t.arc(n,r,Q,0,Op),t.closePath();break;case"triangle":A=c?c/2:Q,t.moveTo(n+Math.sin(se)*A,r-Math.cos(se)*Q),se+=c5,t.lineTo(n+Math.sin(se)*A,r-Math.cos(se)*Q),se+=c5,t.lineTo(n+Math.sin(se)*A,r-Math.cos(se)*Q),t.closePath();break;case"rectRounded":T=Q*.516,w=Q-T,p=Math.cos(se+Nm)*w,D=Math.cos(se+Nm)*(c?c/2-T:w),o=Math.sin(se+Nm)*w,B=Math.sin(se+Nm)*(c?c/2-T:w),t.arc(n-D,r-o,T,se-gl,se-id),t.arc(n+B,r-p,T,se-id,se),t.arc(n+D,r+o,T,se,se+id),t.arc(n-B,r+p,T,se+id,se+gl),t.closePath();break;case"rect":if(!ee){w=Math.SQRT1_2*Q,A=c?c/2:w,t.rect(n-A,r-w,2*A,2*w);break}se+=Nm;case"rectRot":D=Math.cos(se)*(c?c/2:Q),p=Math.cos(se)*Q,o=Math.sin(se)*Q,B=Math.sin(se)*(c?c/2:Q),t.moveTo(n-D,r-o),t.lineTo(n+B,r-p),t.lineTo(n+D,r+o),t.lineTo(n-B,r+p),t.closePath();break;case"crossRot":se+=Nm;case"cross":D=Math.cos(se)*(c?c/2:Q),p=Math.cos(se)*Q,o=Math.sin(se)*Q,B=Math.sin(se)*(c?c/2:Q),t.moveTo(n-D,r-o),t.lineTo(n+D,r+o),t.moveTo(n+B,r-p),t.lineTo(n-B,r+p);break;case"star":D=Math.cos(se)*(c?c/2:Q),p=Math.cos(se)*Q,o=Math.sin(se)*Q,B=Math.sin(se)*(c?c/2:Q),t.moveTo(n-D,r-o),t.lineTo(n+D,r+o),t.moveTo(n+B,r-p),t.lineTo(n-B,r+p),se+=Nm,D=Math.cos(se)*(c?c/2:Q),p=Math.cos(se)*Q,o=Math.sin(se)*Q,B=Math.sin(se)*(c?c/2:Q),t.moveTo(n-D,r-o),t.lineTo(n+D,r+o),t.moveTo(n+B,r-p),t.lineTo(n-B,r+p);break;case"line":p=c?c/2:Math.cos(se)*Q,o=Math.sin(se)*Q,t.moveTo(n-p,r-o),t.lineTo(n+p,r+o);break;case"dash":t.moveTo(n,r),t.lineTo(n+Math.cos(se)*(c?c/2:Q),r+Math.sin(se)*Q);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function K6(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function tA(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function nA(t){t.restore()}function k_e(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),ls(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function R_e(t,e,n,r,c){if(c.strikethrough||c.underline){const u=t.measureText(r),p=e-u.actualBoundingBoxLeft,o=e+u.actualBoundingBoxRight,w=n-u.actualBoundingBoxAscent,T=n+u.actualBoundingBoxDescent,A=c.strikethrough?(w+T)/2:T;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=c.decorationWidth||2,t.moveTo(p,A),t.lineTo(o,A),t.stroke()}}function P_e(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function y0(t,e,n,r,c,u={}){const p=wa(e)?e:[e],o=u.strokeWidth>0&&u.strokeColor!=="";let w,T;for(t.save(),t.font=c.string,k_e(t,u),w=0;w<p.length;++w)T=p[w],u.backdrop&&P_e(t,u.backdrop),o&&(u.strokeColor&&(t.strokeStyle=u.strokeColor),ls(u.strokeWidth)||(t.lineWidth=u.strokeWidth),t.strokeText(T,n,r,u.maxWidth)),t.fillText(T,n,r,u.maxWidth),R_e(t,n,r,T,u),r+=Number(c.lineHeight);t.restore()}function jw(t,e){const{x:n,y:r,w:c,h:u,radius:p}=e;t.arc(n+p.topLeft,r+p.topLeft,p.topLeft,1.5*gl,gl,!0),t.lineTo(n,r+u-p.bottomLeft),t.arc(n+p.bottomLeft,r+u-p.bottomLeft,p.bottomLeft,gl,id,!0),t.lineTo(n+c-p.bottomRight,r+u),t.arc(n+c-p.bottomRight,r+u-p.bottomRight,p.bottomRight,id,0,!0),t.lineTo(n+c,r+p.topRight),t.arc(n+c-p.topRight,r+p.topRight,p.topRight,0,-id,!0),t.lineTo(n+p.topLeft,r)}const M_e=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,D_e=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function O_e(t,e){const n=(""+t).match(M_e);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const L_e=t=>+t||0;function X6(t,e){const n={},r=Eo(e),c=r?Object.keys(e):e,u=Eo(t)?r?p=>Oo(t[p],t[e[p]]):p=>t[p]:()=>t;for(const p of c)n[p]=L_e(u(p));return n}function Y6(t){return X6(t,{top:"y",right:"x",bottom:"y",left:"x"})}function K_(t){return X6(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Su(t){const e=Y6(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function pl(t,e){t=t||{},e=e||oa.font;let n=Oo(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let r=Oo(t.style,e.style);r&&!(""+r).match(D_e)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const c={family:Oo(t.family,e.family),lineHeight:O_e(Oo(t.lineHeight,e.lineHeight),n),size:n,style:r,weight:Oo(t.weight,e.weight),string:""};return c.string=A_e(c),c}function Cx(t,e,n,r){let c,u,p;for(c=0,u=t.length;c<u;++c)if(p=t[c],p!==void 0&&p!==void 0)return p}function z_e(t,e,n){const{min:r,max:c}=t,u=Jge(e,(c-r)/2),p=(o,w)=>n&&o===0?0:o+w;return{min:p(r,-Math.abs(u)),max:p(c,u)}}function gy(t,e){return Object.assign(Object.create(t),e)}function iA(t,e=[""],n,r,c=()=>t[0]){const u=n||t;typeof r>"u"&&(r=tN("_fallback",t));const p={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:u,_fallback:r,_getTarget:c,override:o=>iA([o,...t],e,u,r)};return new Proxy(p,{deleteProperty(o,w){return delete o[w],delete o._keys,delete t[0][w],!0},get(o,w){return Q6(o,w,()=>H_e(w,e,t,o))},getOwnPropertyDescriptor(o,w){return Reflect.getOwnPropertyDescriptor(o._scopes[0],w)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(o,w){return x5(o).includes(w)},ownKeys(o){return x5(o)},set(o,w,T){const A=o._storage||(o._storage=c());return o[w]=A[w]=T,delete o._keys,!0}})}function ly(t,e,n,r){const c={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:J6(t,r),setContext:u=>ly(t,u,n,r),override:u=>ly(t.override(u),e,n,r)};return new Proxy(c,{deleteProperty(u,p){return delete u[p],delete t[p],!0},get(u,p,o){return Q6(u,p,()=>F_e(u,p,o))},getOwnPropertyDescriptor(u,p){return u._descriptors.allKeys?Reflect.has(t,p)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,p)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(u,p){return Reflect.has(t,p)},ownKeys(){return Reflect.ownKeys(t)},set(u,p,o){return t[p]=o,delete u[p],!0}})}function J6(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:r=e.indexable,_allKeys:c=e.allKeys}=t;return{allKeys:c,scriptable:n,indexable:r,isScriptable:$p(n)?n:()=>n,isIndexable:$p(r)?r:()=>r}}const B_e=(t,e)=>t?t+JI(e):e,rA=(t,e)=>Eo(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function Q6(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const r=n();return t[e]=r,r}function F_e(t,e,n){const{_proxy:r,_context:c,_subProxy:u,_descriptors:p}=t;let o=r[e];return $p(o)&&p.isScriptable(e)&&(o=N_e(e,o,t,n)),wa(o)&&o.length&&(o=V_e(e,o,t,p.isIndexable)),rA(e,o)&&(o=ly(o,c,u&&u[e],p)),o}function N_e(t,e,n,r){const{_proxy:c,_context:u,_subProxy:p,_stack:o}=n;if(o.has(t))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+t);o.add(t);let w=e(u,p||r);return o.delete(t),rA(t,w)&&(w=oA(c._scopes,c,t,w)),w}function V_e(t,e,n,r){const{_proxy:c,_context:u,_subProxy:p,_descriptors:o}=n;if(typeof u.index<"u"&&r(t))return e[u.index%e.length];if(Eo(e[0])){const w=e,T=c._scopes.filter(A=>A!==w);e=[];for(const A of w){const D=oA(T,c,t,A);e.push(ly(D,u,p&&p[t],o))}}return e}function eN(t,e,n){return $p(t)?t(e,n):t}const $_e=(t,e)=>t===!0?e:typeof t=="string"?ay(e,t):void 0;function j_e(t,e,n,r,c){for(const u of e){const p=$_e(n,u);if(p){t.add(p);const o=eN(p._fallback,n,c);if(typeof o<"u"&&o!==n&&o!==r)return o}else if(p===!1&&typeof r<"u"&&n!==r)return null}return!1}function oA(t,e,n,r){const c=e._rootScopes,u=eN(e._fallback,n,r),p=[...t,...c],o=new Set;o.add(r);let w=b5(o,p,n,u||n,r);return w===null||typeof u<"u"&&u!==n&&(w=b5(o,p,u,w,r),w===null)?!1:iA(Array.from(o),[""],c,u,()=>U_e(e,n,r))}function b5(t,e,n,r,c){for(;n;)n=j_e(t,e,n,r,c);return n}function U_e(t,e,n){const r=t._getTarget();e in r||(r[e]={});const c=r[e];return wa(c)&&Eo(n)?n:c||{}}function H_e(t,e,n,r){let c;for(const u of e)if(c=tN(B_e(u,t),n),typeof c<"u")return rA(t,c)?oA(n,r,t,c):c}function tN(t,e){for(const n of e){if(!n)continue;const r=n[t];if(typeof r<"u")return r}}function x5(t){let e=t._keys;return e||(e=t._keys=G_e(t._scopes)),e}function G_e(t){const e=new Set;for(const n of t)for(const r of Object.keys(n).filter(c=>!c.startsWith("_")))e.add(r);return Array.from(e)}function sA(){return typeof window<"u"&&typeof document<"u"}function aA(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Uw(t,e,n){let r;return typeof t=="string"?(r=parseInt(t,10),t.indexOf("%")!==-1&&(r=r/100*e.parentNode[n])):r=t,r}const VS=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function W_e(t,e){return VS(t).getPropertyValue(e)}const q_e=["top","right","bottom","left"];function cg(t,e,n){const r={};n=n?"-"+n:"";for(let c=0;c<4;c++){const u=q_e[c];r[u]=parseFloat(t[e+"-"+u+n])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const Z_e=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function K_e(t,e){const n=t.touches,r=n&&n.length?n[0]:t,{offsetX:c,offsetY:u}=r;let p=!1,o,w;if(Z_e(c,u,t.target))o=c,w=u;else{const T=e.getBoundingClientRect();o=r.clientX-T.left,w=r.clientY-T.top,p=!0}return{x:o,y:w,box:p}}function Wm(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:r}=e,c=VS(n),u=c.boxSizing==="border-box",p=cg(c,"padding"),o=cg(c,"border","width"),{x:w,y:T,box:A}=K_e(t,n),D=p.left+(A&&o.left),B=p.top+(A&&o.top);let{width:N,height:ee}=e;return u&&(N-=p.width+o.width,ee-=p.height+o.height),{x:Math.round((w-D)/N*n.width/r),y:Math.round((T-B)/ee*n.height/r)}}function X_e(t,e,n){let r,c;if(e===void 0||n===void 0){const u=t&&aA(t);if(!u)e=t.clientWidth,n=t.clientHeight;else{const p=u.getBoundingClientRect(),o=VS(u),w=cg(o,"border","width"),T=cg(o,"padding");e=p.width-T.width-w.width,n=p.height-T.height-w.height,r=Uw(o.maxWidth,u,"clientWidth"),c=Uw(o.maxHeight,u,"clientHeight")}}return{width:e,height:n,maxWidth:r||Vw,maxHeight:c||Vw}}const Tp=t=>Math.round(t*10)/10;function Y_e(t,e,n,r){const c=VS(t),u=cg(c,"margin"),p=Uw(c.maxWidth,t,"clientWidth")||Vw,o=Uw(c.maxHeight,t,"clientHeight")||Vw,w=X_e(t,e,n);let{width:T,height:A}=w;if(c.boxSizing==="content-box"){const B=cg(c,"border","width"),N=cg(c,"padding");T-=N.width+B.width,A-=N.height+B.height}return T=Math.max(0,T-u.width),A=Math.max(0,r?T/r:A-u.height),T=Tp(Math.min(T,p,w.maxWidth)),A=Tp(Math.min(A,o,w.maxHeight)),T&&!A&&(A=Tp(T/2)),(e!==void 0||n!==void 0)&&r&&w.height&&A>w.height&&(A=w.height,T=Tp(Math.floor(A*r))),{width:T,height:A}}function w5(t,e,n){const r=e||1,c=Tp(t.height*r),u=Tp(t.width*r);t.height=Tp(t.height),t.width=Tp(t.width);const p=t.canvas;return p.style&&(n||!p.style.height&&!p.style.width)&&(p.style.height=`${t.height}px`,p.style.width=`${t.width}px`),t.currentDevicePixelRatio!==r||p.height!==c||p.width!==u?(t.currentDevicePixelRatio=r,p.height=c,p.width=u,t.ctx.setTransform(r,0,0,r,0,0),!0):!1}const J_e=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};sA()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t}();function S5(t,e){const n=W_e(t,e),r=n&&n.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}const Q_e=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,r){return n-r},leftForLtr(n,r){return n-r}}},eye=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function X_(t,e,n){return t?Q_e(e,n):eye()}function nN(t,e){let n,r;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,r=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=r)}function iN(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function Tx(t,e,n){return t.options.clip?t[n]:e[n]}function tye(t,e){const{xScale:n,yScale:r}=t;return n&&r?{left:Tx(n,e,"left"),right:Tx(n,e,"right"),top:Tx(r,e,"top"),bottom:Tx(r,e,"bottom")}:e}function nye(t,e){const n=e._clip;if(n.disabled)return!1;const r=tye(e,t.chartArea);return{left:n.left===!1?0:r.left-(n.left===!0?0:n.left),right:n.right===!1?t.width:r.right+(n.right===!0?0:n.right),top:n.top===!1?0:r.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?t.height:r.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class iye{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,r,c){const u=n.listeners[c],p=n.duration;u.forEach(o=>o({chart:e,initial:n.initial,numSteps:p,currentStep:Math.min(r-n.start,p)}))}_refresh(){this._request||(this._running=!0,this._request=U6.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((r,c)=>{if(!r.running||!r.items.length)return;const u=r.items;let p=u.length-1,o=!1,w;for(;p>=0;--p)w=u[p],w._active?(w._total>r.duration&&(r.duration=w._total),w.tick(e),o=!0):(u[p]=u[u.length-1],u.pop());o&&(c.draw(),this._notify(c,r,e,"progress")),u.length||(r.running=!1,this._notify(c,r,e,"complete"),r.initial=!1),n+=u.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let r=n.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,r)),r}listen(e,n,r){this._getAnims(e).listeners[n].push(r)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((r,c)=>Math.max(r,c._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const r=n.items;let c=r.length-1;for(;c>=0;--c)r[c].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var jh=new iye;const C5="transparent",rye={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const r=m5(t||C5),c=r.valid&&m5(e||C5);return c&&c.valid?c.mix(r,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class oye{constructor(e,n,r,c){const u=n[r];c=Cx([e.to,c,u,e.from]);const p=Cx([e.from,u,c]);this._active=!0,this._fn=e.fn||rye[e.type||typeof p],this._easing=gb[e.easing]||gb.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=r,this._from=p,this._to=c,this._promises=void 0}active(){return this._active}update(e,n,r){if(this._active){this._notify(!1);const c=this._target[this._prop],u=r-this._start,p=this._duration-u;this._start=r,this._duration=Math.floor(Math.max(p,e.duration)),this._total+=u,this._loop=!!e.loop,this._to=Cx([e.to,n,c,e.from]),this._from=Cx([e.from,c,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,r=this._duration,c=this._prop,u=this._from,p=this._loop,o=this._to;let w;if(this._active=u!==o&&(p||n<r),!this._active){this._target[c]=o,this._notify(!0);return}if(n<0){this._target[c]=u;return}w=n/r%2,w=p&&w>1?2-w:w,w=this._easing(Math.min(1,Math.max(0,w))),this._target[c]=this._fn(u,o,w)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,r)=>{e.push({res:n,rej:r})})}_notify(e){const n=e?"res":"rej",r=this._promises||[];for(let c=0;c<r.length;c++)r[c][n]()}}class rN{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!Eo(e))return;const n=Object.keys(oa.animation),r=this._properties;Object.getOwnPropertyNames(e).forEach(c=>{const u=e[c];if(!Eo(u))return;const p={};for(const o of n)p[o]=u[o];(wa(u.properties)&&u.properties||[c]).forEach(o=>{(o===c||!r.has(o))&&r.set(o,p)})})}_animateOptions(e,n){const r=n.options,c=aye(e,r);if(!c)return[];const u=this._createAnimations(c,r);return r.$shared&&sye(e.options.$animations,r).then(()=>{e.options=r},()=>{}),u}_createAnimations(e,n){const r=this._properties,c=[],u=e.$animations||(e.$animations={}),p=Object.keys(n),o=Date.now();let w;for(w=p.length-1;w>=0;--w){const T=p[w];if(T.charAt(0)==="$")continue;if(T==="options"){c.push(...this._animateOptions(e,n));continue}const A=n[T];let D=u[T];const B=r.get(T);if(D)if(B&&D.active()){D.update(B,A,o);continue}else D.cancel();if(!B||!B.duration){e[T]=A;continue}u[T]=D=new oye(B,e,T,A),c.push(D)}return c}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const r=this._createAnimations(e,n);if(r.length)return jh.add(this._chart,r),!0}}function sye(t,e){const n=[],r=Object.keys(e);for(let c=0;c<r.length;c++){const u=t[r[c]];u&&u.active()&&n.push(u.wait())}return Promise.all(n)}function aye(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function T5(t,e){const n=t&&t.options||{},r=n.reverse,c=n.min===void 0?e:0,u=n.max===void 0?e:0;return{start:r?u:c,end:r?c:u}}function lye(t,e,n){if(n===!1)return!1;const r=T5(t,n),c=T5(e,n);return{top:c.end,right:r.end,bottom:c.start,left:r.start}}function cye(t){let e,n,r,c;return Eo(t)?(e=t.top,n=t.right,r=t.bottom,c=t.left):e=n=r=c=t,{top:e,right:n,bottom:r,left:c,disabled:t===!1}}function oN(t,e){const n=[],r=t._getSortedDatasetMetas(e);let c,u;for(c=0,u=r.length;c<u;++c)n.push(r[c].index);return n}function E5(t,e,n,r={}){const c=t.keys,u=r.mode==="single";let p,o,w,T;if(e===null)return;let A=!1;for(p=0,o=c.length;p<o;++p){if(w=+c[p],w===n){if(A=!0,r.all)continue;break}T=t.values[w],wu(T)&&(u||e===0||Lp(e)===Lp(T))&&(e+=T)}return!A&&!r.all?0:e}function uye(t,e){const{iScale:n,vScale:r}=e,c=n.axis==="x"?"x":"y",u=r.axis==="x"?"x":"y",p=Object.keys(t),o=new Array(p.length);let w,T,A;for(w=0,T=p.length;w<T;++w)A=p[w],o[w]={[c]:A,[u]:t[A]};return o}function iT(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function dye(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function hye(t){const{min:e,max:n,minDefined:r,maxDefined:c}=t.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:c?n:Number.POSITIVE_INFINITY}}function fye(t,e,n){const r=t[e]||(t[e]={});return r[n]||(r[n]={})}function I5(t,e,n,r){for(const c of e.getMatchingVisibleMetas(r).reverse()){const u=t[c.index];if(n&&u>0||!n&&u<0)return c.index}return null}function A5(t,e){const{chart:n,_cachedMeta:r}=t,c=n._stacks||(n._stacks={}),{iScale:u,vScale:p,index:o}=r,w=u.axis,T=p.axis,A=dye(u,p,r),D=e.length;let B;for(let N=0;N<D;++N){const ee=e[N],{[w]:Q,[T]:se}=ee,ce=ee._stacks||(ee._stacks={});B=ce[T]=fye(c,A,Q),B[o]=se,B._top=I5(B,p,!0,r.type),B._bottom=I5(B,p,!1,r.type);const be=B._visualValues||(B._visualValues={});be[o]=se}}function rT(t,e){const n=t.scales;return Object.keys(n).filter(r=>n[r].axis===e).shift()}function pye(t,e){return gy(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function mye(t,e,n){return gy(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function Nv(t,e){const n=t.controller.index,r=t.vScale&&t.vScale.axis;if(r){e=e||t._parsed;for(const c of e){const u=c._stacks;if(!u||u[r]===void 0||u[r][n]===void 0)return;delete u[r][n],u[r]._visualValues!==void 0&&u[r]._visualValues[n]!==void 0&&delete u[r]._visualValues[n]}}}const oT=t=>t==="reset"||t==="none",k5=(t,e)=>e?t:Object.assign({},t),gye=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:oN(n,!0),values:null};class yb{constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=iT(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Nv(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,r=this.getDataset(),c=(D,B,N,ee)=>D==="x"?B:D==="r"?ee:N,u=n.xAxisID=Oo(r.xAxisID,rT(e,"x")),p=n.yAxisID=Oo(r.yAxisID,rT(e,"y")),o=n.rAxisID=Oo(r.rAxisID,rT(e,"r")),w=n.indexAxis,T=n.iAxisID=c(w,u,p,o),A=n.vAxisID=c(w,p,u,o);n.xScale=this.getScaleForId(u),n.yScale=this.getScaleForId(p),n.rScale=this.getScaleForId(o),n.iScale=this.getScaleForId(T),n.vScale=this.getScaleForId(A)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&h5(this._data,this),e._stacked&&Nv(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),r=this._data;if(Eo(n)){const c=this._cachedMeta;this._data=uye(n,c)}else if(r!==n){if(r){h5(r,this);const c=this._cachedMeta;Nv(c),c._parsed=[]}n&&Object.isExtensible(n)&&g_e(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,r=this.getDataset();let c=!1;this._dataCheck();const u=n._stacked;n._stacked=iT(n.vScale,n),n.stack!==r.stack&&(c=!0,Nv(n),n.stack=r.stack),this._resyncElements(e),(c||u!==n._stacked)&&(A5(this,n._parsed),n._stacked=iT(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:r,_data:c}=this,{iScale:u,_stacked:p}=r,o=u.axis;let w=e===0&&n===c.length?!0:r._sorted,T=e>0&&r._parsed[e-1],A,D,B;if(this._parsing===!1)r._parsed=c,r._sorted=!0,B=c;else{wa(c[e])?B=this.parseArrayData(r,c,e,n):Eo(c[e])?B=this.parseObjectData(r,c,e,n):B=this.parsePrimitiveData(r,c,e,n);const N=()=>D[o]===null||T&&D[o]<T[o];for(A=0;A<n;++A)r._parsed[A+e]=D=B[A],w&&(N()&&(w=!1),T=D);r._sorted=w}p&&A5(this,B)}parsePrimitiveData(e,n,r,c){const{iScale:u,vScale:p}=e,o=u.axis,w=p.axis,T=u.getLabels(),A=u===p,D=new Array(c);let B,N,ee;for(B=0,N=c;B<N;++B)ee=B+r,D[B]={[o]:A||u.parse(T[ee],ee),[w]:p.parse(n[ee],ee)};return D}parseArrayData(e,n,r,c){const{xScale:u,yScale:p}=e,o=new Array(c);let w,T,A,D;for(w=0,T=c;w<T;++w)A=w+r,D=n[A],o[w]={x:u.parse(D[0],A),y:p.parse(D[1],A)};return o}parseObjectData(e,n,r,c){const{xScale:u,yScale:p}=e,{xAxisKey:o="x",yAxisKey:w="y"}=this._parsing,T=new Array(c);let A,D,B,N;for(A=0,D=c;A<D;++A)B=A+r,N=n[B],T[A]={x:u.parse(ay(N,o),B),y:p.parse(ay(N,w),B)};return T}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,r){const c=this.chart,u=this._cachedMeta,p=n[e.axis],o={keys:oN(c,!0),values:n._stacks[e.axis]._visualValues};return E5(o,p,u.index,{mode:r})}updateRangeFromParsed(e,n,r,c){const u=r[n.axis];let p=u===null?NaN:u;const o=c&&r._stacks[n.axis];c&&o&&(c.values=o,p=E5(c,u,this._cachedMeta.index)),e.min=Math.min(e.min,p),e.max=Math.max(e.max,p)}getMinMax(e,n){const r=this._cachedMeta,c=r._parsed,u=r._sorted&&e===r.iScale,p=c.length,o=this._getOtherScale(e),w=gye(n,r,this.chart),T={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:A,max:D}=hye(o);let B,N;function ee(){N=c[B];const Q=N[o.axis];return!wu(N[e.axis])||A>Q||D<Q}for(B=0;B<p&&!(!ee()&&(this.updateRangeFromParsed(T,e,N,w),u));++B);if(u){for(B=p-1;B>=0;--B)if(!ee()){this.updateRangeFromParsed(T,e,N,w);break}}return T}getAllParsedValues(e){const n=this._cachedMeta._parsed,r=[];let c,u,p;for(c=0,u=n.length;c<u;++c)p=n[c][e.axis],wu(p)&&r.push(p);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,r=n.iScale,c=n.vScale,u=this.getParsed(e);return{label:r?""+r.getLabelForValue(u[r.axis]):"",value:c?""+c.getLabelForValue(u[c.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=cye(Oo(this.options.clip,lye(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,r=this._cachedMeta,c=r.data||[],u=n.chartArea,p=[],o=this._drawStart||0,w=this._drawCount||c.length-o,T=this.options.drawActiveElementsOnTop;let A;for(r.dataset&&r.dataset.draw(e,u,o,w),A=o;A<o+w;++A){const D=c[A];D.hidden||(D.active&&T?p.push(D):D.draw(e,u))}for(A=0;A<p.length;++A)p[A].draw(e,u)}getStyle(e,n){const r=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,n,r){const c=this.getDataset();let u;if(e>=0&&e<this._cachedMeta.data.length){const p=this._cachedMeta.data[e];u=p.$context||(p.$context=mye(this.getContext(),e,p)),u.parsed=this.getParsed(e),u.raw=c.data[e],u.index=u.dataIndex=e}else u=this.$context||(this.$context=pye(this.chart.getContext(),this.index)),u.dataset=c,u.index=u.datasetIndex=this.index;return u.active=!!n,u.mode=r,u}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",r){const c=n==="active",u=this._cachedDataOpts,p=e+"-"+n,o=u[p],w=this.enableOptionSharing&&_0(r);if(o)return k5(o,w);const T=this.chart.config,A=T.datasetElementScopeKeys(this._type,e),D=c?[`${e}Hover`,"hover",e,""]:[e,""],B=T.getOptionScopes(this.getDataset(),A),N=Object.keys(oa.elements[e]),ee=()=>this.getContext(r,c,n),Q=T.resolveNamedOptions(B,N,ee,D);return Q.$shared&&(Q.$shared=w,u[p]=Object.freeze(k5(Q,w))),Q}_resolveAnimations(e,n,r){const c=this.chart,u=this._cachedDataOpts,p=`animation-${n}`,o=u[p];if(o)return o;let w;if(c.options.animation!==!1){const A=this.chart.config,D=A.datasetAnimationScopeKeys(this._type,n),B=A.getOptionScopes(this.getDataset(),D);w=A.createResolver(B,this.getContext(e,r,n))}const T=new rN(c,w&&w.animations);return w&&w._cacheable&&(u[p]=Object.freeze(T)),T}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||oT(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const r=this.resolveDataElementOptions(e,n),c=this._sharedOptions,u=this.getSharedOptions(r),p=this.includeOptions(n,u)||u!==c;return this.updateSharedOptions(u,n,r),{sharedOptions:u,includeOptions:p}}updateElement(e,n,r,c){oT(c)?Object.assign(e,r):this._resolveAnimations(n,c).update(e,r)}updateSharedOptions(e,n,r){e&&!oT(n)&&this._resolveAnimations(void 0,n).update(e,r)}_setStyle(e,n,r,c){e.active=c;const u=this.getStyle(n,c);this._resolveAnimations(n,r,c).update(e,{options:!c&&this.getSharedOptions(u)||u})}removeHoverStyle(e,n,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,n,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,r=this._cachedMeta.data;for(const[o,w,T]of this._syncList)this[o](w,T);this._syncList=[];const c=r.length,u=n.length,p=Math.min(u,c);p&&this.parse(0,p),u>c?this._insertElements(c,u-c,e):u<c&&this._removeElements(u,c-u)}_insertElements(e,n,r=!0){const c=this._cachedMeta,u=c.data,p=e+n;let o;const w=T=>{for(T.length+=n,o=T.length-1;o>=p;o--)T[o]=T[o-n]};for(w(u),o=e;o<p;++o)u[o]=new this.dataElementType;this._parsing&&w(c._parsed),this.parse(e,n),r&&this.updateElements(u,e,n,"reset")}updateElements(e,n,r,c){}_removeElements(e,n){const r=this._cachedMeta;if(this._parsing){const c=r._parsed.splice(e,n);r._stacked&&Nv(r,c)}r.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,r,c]=e;this[n](r,c)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}bo(yb,"defaults",{}),bo(yb,"datasetElementType",null),bo(yb,"dataElementType",null);function _ye(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let r=[];for(let c=0,u=n.length;c<u;c++)r=r.concat(n[c].controller.getAllParsedValues(t));t._cache.$bar=j6(r.sort((c,u)=>c-u))}return t._cache.$bar}function yye(t){const e=t.iScale,n=_ye(e,t.type);let r=e._length,c,u,p,o;const w=()=>{p===32767||p===-32768||(_0(o)&&(r=Math.min(r,Math.abs(p-o)||r)),o=p)};for(c=0,u=n.length;c<u;++c)p=e.getPixelForValue(n[c]),w();for(o=void 0,c=0,u=e.ticks.length;c<u;++c)p=e.getPixelForTick(c),w();return r}function vye(t,e,n,r){const c=n.barThickness;let u,p;return ls(c)?(u=e.min*n.categoryPercentage,p=n.barPercentage):(u=c*r,p=1),{chunk:u/r,ratio:p,start:e.pixels[t]-u/2}}function bye(t,e,n,r){const c=e.pixels,u=c[t];let p=t>0?c[t-1]:null,o=t<c.length-1?c[t+1]:null;const w=n.categoryPercentage;p===null&&(p=u-(o===null?e.end-e.start:o-u)),o===null&&(o=u+u-p);const T=u-(u-Math.min(p,o))/2*w;return{chunk:Math.abs(o-p)/2*w/r,ratio:n.barPercentage,start:T}}function xye(t,e,n,r){const c=n.parse(t[0],r),u=n.parse(t[1],r),p=Math.min(c,u),o=Math.max(c,u);let w=p,T=o;Math.abs(p)>Math.abs(o)&&(w=o,T=p),e[n.axis]=T,e._custom={barStart:w,barEnd:T,start:c,end:u,min:p,max:o}}function sN(t,e,n,r){return wa(t)?xye(t,e,n,r):e[n.axis]=n.parse(t,r),e}function R5(t,e,n,r){const c=t.iScale,u=t.vScale,p=c.getLabels(),o=c===u,w=[];let T,A,D,B;for(T=n,A=n+r;T<A;++T)B=e[T],D={},D[c.axis]=o||c.parse(p[T],T),w.push(sN(B,D,u,T));return w}function sT(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function wye(t,e,n){return t!==0?Lp(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}function Sye(t){let e,n,r,c,u;return t.horizontal?(e=t.base>t.x,n="left",r="right"):(e=t.base<t.y,n="bottom",r="top"),e?(c="end",u="start"):(c="start",u="end"),{start:n,end:r,reverse:e,top:c,bottom:u}}function Cye(t,e,n,r){let c=e.borderSkipped;const u={};if(!c){t.borderSkipped=u;return}if(c===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:p,end:o,reverse:w,top:T,bottom:A}=Sye(t);c==="middle"&&n&&(t.enableBorderRadius=!0,(n._top||0)===r?c=T:(n._bottom||0)===r?c=A:(u[P5(A,p,o,w)]=!0,c=T)),u[P5(c,p,o,w)]=!0,t.borderSkipped=u}function P5(t,e,n,r){return r?(t=Tye(t,e,n),t=M5(t,n,e)):t=M5(t,e,n),t}function Tye(t,e,n){return t===e?n:t===n?e:t}function M5(t,e,n){return t==="start"?e:t==="end"?n:t}function Eye(t,{inflateAmount:e},n){t.inflateAmount=e==="auto"?n===1?.33:0:e}class tw extends yb{parsePrimitiveData(e,n,r,c){return R5(e,n,r,c)}parseArrayData(e,n,r,c){return R5(e,n,r,c)}parseObjectData(e,n,r,c){const{iScale:u,vScale:p}=e,{xAxisKey:o="x",yAxisKey:w="y"}=this._parsing,T=u.axis==="x"?o:w,A=p.axis==="x"?o:w,D=[];let B,N,ee,Q;for(B=r,N=r+c;B<N;++B)Q=n[B],ee={},ee[u.axis]=u.parse(ay(Q,T),B),D.push(sN(ay(Q,A),ee,p,B));return D}updateRangeFromParsed(e,n,r,c){super.updateRangeFromParsed(e,n,r,c);const u=r._custom;u&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,u.min),e.max=Math.max(e.max,u.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const n=this._cachedMeta,{iScale:r,vScale:c}=n,u=this.getParsed(e),p=u._custom,o=sT(p)?"["+p.start+", "+p.end+"]":""+c.getLabelForValue(u[c.axis]);return{label:""+r.getLabelForValue(u[r.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,e)}updateElements(e,n,r,c){const u=c==="reset",{index:p,_cachedMeta:{vScale:o}}=this,w=o.getBasePixel(),T=o.isHorizontal(),A=this._getRuler(),{sharedOptions:D,includeOptions:B}=this._getSharedOptions(n,c);for(let N=n;N<n+r;N++){const ee=this.getParsed(N),Q=u||ls(ee[o.axis])?{base:w,head:w}:this._calculateBarValuePixels(N),se=this._calculateBarIndexPixels(N,A),ce=(ee._stacks||{})[o.axis],be={horizontal:T,base:Q.base,enableBorderRadius:!ce||sT(ee._custom)||p===ce._top||p===ce._bottom,x:T?Q.head:se.center,y:T?se.center:Q.head,height:T?se.size:Math.abs(Q.size),width:T?Math.abs(Q.size):se.size};B&&(be.options=D||this.resolveDataElementOptions(N,e[N].active?"active":c));const ze=be.options||e[N].options;Cye(be,ze,ce,p),Eye(be,ze,A.ratio),this.updateElement(e[N],N,be,c)}}_getStacks(e,n){const{iScale:r}=this._cachedMeta,c=r.getMatchingVisibleMetas(this._type).filter(A=>A.controller.options.grouped),u=r.options.stacked,p=[],o=this._cachedMeta.controller.getParsed(n),w=o&&o[r.axis],T=A=>{const D=A._parsed.find(N=>N[r.axis]===w),B=D&&D[A.vScale.axis];if(ls(B)||isNaN(B))return!0};for(const A of c)if(!(n!==void 0&&T(A))&&((u===!1||p.indexOf(A.stack)===-1||u===void 0&&A.stack===void 0)&&p.push(A.stack),A.index===e))break;return p.length||p.push(void 0),p}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(e).filter(r=>e[r].axis===n).shift()}_getAxis(){const e={},n=this.getFirstScaleIdForIndexAxis();for(const r of this.chart.data.datasets)e[Oo(this.chart.options.indexAxis==="x"?r.xAxisID:r.yAxisID,n)]=!0;return Object.keys(e)}_getStackIndex(e,n,r){const c=this._getStacks(e,r),u=n!==void 0?c.indexOf(n):-1;return u===-1?c.length-1:u}_getRuler(){const e=this.options,n=this._cachedMeta,r=n.iScale,c=[];let u,p;for(u=0,p=n.data.length;u<p;++u)c.push(r.getPixelForValue(this.getParsed(u)[r.axis],u));const o=e.barThickness;return{min:o||yye(n),pixels:c,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:o?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:n,_stacked:r,index:c},options:{base:u,minBarLength:p}}=this,o=u||0,w=this.getParsed(e),T=w._custom,A=sT(T);let D=w[n.axis],B=0,N=r?this.applyStack(n,w,r):D,ee,Q;N!==D&&(B=N-D,N=D),A&&(D=T.barStart,N=T.barEnd-T.barStart,D!==0&&Lp(D)!==Lp(T.barEnd)&&(B=0),B+=D);const se=!ls(u)&&!A?u:B;let ce=n.getPixelForValue(se);if(this.chart.getDataVisibility(e)?ee=n.getPixelForValue(B+N):ee=ce,Q=ee-ce,Math.abs(Q)<p){Q=wye(Q,n,o)*p,D===o&&(ce-=Q/2);const be=n.getPixelForDecimal(0),ze=n.getPixelForDecimal(1),xe=Math.min(be,ze),je=Math.max(be,ze);ce=Math.max(Math.min(ce,je),xe),ee=ce+Q,r&&!A&&(w._stacks[n.axis]._visualValues[c]=n.getValueForPixel(ee)-n.getValueForPixel(ce))}if(ce===n.getPixelForValue(o)){const be=Lp(Q)*n.getLineWidthForValue(o)/2;ce+=be,Q-=be}return{size:Q,base:ce,head:ee,center:ee+Q/2}}_calculateBarIndexPixels(e,n){const r=n.scale,c=this.options,u=c.skipNull,p=Oo(c.maxBarThickness,1/0);let o,w;const T=this._getAxisCount();if(n.grouped){const A=u?this._getStackCount(e):n.stackCount,D=c.barThickness==="flex"?bye(e,n,c,A*T):vye(e,n,c,A*T),B=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,N=this._getAxis().indexOf(Oo(B,this.getFirstScaleIdForIndexAxis())),ee=this._getStackIndex(this.index,this._cachedMeta.stack,u?e:void 0)+N;o=D.start+D.chunk*ee+D.chunk/2,w=Math.min(p,D.chunk*D.ratio)}else o=r.getPixelForValue(this.getParsed(e)[r.axis],e),w=Math.min(p,n.min*n.ratio);return{base:o-w/2,head:o+w/2,center:o,size:w}}draw(){const e=this._cachedMeta,n=e.vScale,r=e.data,c=r.length;let u=0;for(;u<c;++u)this.getParsed(u)[n.axis]!==null&&!r[u].hidden&&r[u].draw(this._ctx)}}bo(tw,"id","bar"),bo(tw,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),bo(tw,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function jm(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class lA{constructor(e){bo(this,"options");this.options=e||{}}static override(e){Object.assign(lA.prototype,e)}init(){}formats(){return jm()}parse(){return jm()}format(){return jm()}add(){return jm()}diff(){return jm()}startOf(){return jm()}endOf(){return jm()}}var Iye={_date:lA};function Aye(t,e,n,r){const{controller:c,data:u,_sorted:p}=t,o=c._cachedMeta.iScale,w=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(o&&e===o.axis&&e!=="r"&&p&&u.length){const T=o._reversePixels?p_e:vE;if(r){if(c._sharedOptions){const A=u[0],D=typeof A.getRange=="function"&&A.getRange(e);if(D){const B=T(u,e,n-D),N=T(u,e,n+D);return{lo:B.lo,hi:N.hi}}}}else{const A=T(u,e,n);if(w){const{vScale:D}=c._cachedMeta,{_parsed:B}=t,N=B.slice(0,A.lo+1).reverse().findIndex(Q=>!ls(Q[D.axis]));A.lo-=Math.max(0,N);const ee=B.slice(A.hi).findIndex(Q=>!ls(Q[D.axis]));A.hi+=Math.max(0,ee)}return A}}return{lo:0,hi:u.length-1}}function $S(t,e,n,r,c){const u=t.getSortedVisibleDatasetMetas(),p=n[e];for(let o=0,w=u.length;o<w;++o){const{index:T,data:A}=u[o],{lo:D,hi:B}=Aye(u[o],e,p,c);for(let N=D;N<=B;++N){const ee=A[N];ee.skip||r(ee,T,N)}}}function kye(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(r,c){const u=e?Math.abs(r.x-c.x):0,p=n?Math.abs(r.y-c.y):0;return Math.sqrt(Math.pow(u,2)+Math.pow(p,2))}}function aT(t,e,n,r,c){const u=[];return!c&&!t.isPointInArea(e)||$S(t,n,e,function(o,w,T){!c&&!K6(o,t.chartArea,0)||o.inRange(e.x,e.y,r)&&u.push({element:o,datasetIndex:w,index:T})},!0),u}function Rye(t,e,n,r){let c=[];function u(p,o,w){const{startAngle:T,endAngle:A}=p.getProps(["startAngle","endAngle"],r),{angle:D}=u_e(p,{x:e.x,y:e.y});h_e(D,T,A)&&c.push({element:p,datasetIndex:o,index:w})}return $S(t,n,e,u),c}function Pye(t,e,n,r,c,u){let p=[];const o=kye(n);let w=Number.POSITIVE_INFINITY;function T(A,D,B){const N=A.inRange(e.x,e.y,c);if(r&&!N)return;const ee=A.getCenterPoint(c);if(!(!!u||t.isPointInArea(ee))&&!N)return;const se=o(e,ee);se<w?(p=[{element:A,datasetIndex:D,index:B}],w=se):se===w&&p.push({element:A,datasetIndex:D,index:B})}return $S(t,n,e,T),p}function lT(t,e,n,r,c,u){return!u&&!t.isPointInArea(e)?[]:n==="r"&&!r?Rye(t,e,n,c):Pye(t,e,n,r,c,u)}function D5(t,e,n,r,c){const u=[],p=n==="x"?"inXRange":"inYRange";let o=!1;return $S(t,n,e,(w,T,A)=>{w[p]&&w[p](e[n],c)&&(u.push({element:w,datasetIndex:T,index:A}),o=o||w.inRange(e.x,e.y,c))}),r&&!o?[]:u}var Mye={modes:{index(t,e,n,r){const c=Wm(e,t),u=n.axis||"x",p=n.includeInvisible||!1,o=n.intersect?aT(t,c,u,r,p):lT(t,c,u,!1,r,p),w=[];return o.length?(t.getSortedVisibleDatasetMetas().forEach(T=>{const A=o[0].index,D=T.data[A];D&&!D.skip&&w.push({element:D,datasetIndex:T.index,index:A})}),w):[]},dataset(t,e,n,r){const c=Wm(e,t),u=n.axis||"xy",p=n.includeInvisible||!1;let o=n.intersect?aT(t,c,u,r,p):lT(t,c,u,!1,r,p);if(o.length>0){const w=o[0].datasetIndex,T=t.getDatasetMeta(w).data;o=[];for(let A=0;A<T.length;++A)o.push({element:T[A],datasetIndex:w,index:A})}return o},point(t,e,n,r){const c=Wm(e,t),u=n.axis||"xy",p=n.includeInvisible||!1;return aT(t,c,u,r,p)},nearest(t,e,n,r){const c=Wm(e,t),u=n.axis||"xy",p=n.includeInvisible||!1;return lT(t,c,u,n.intersect,r,p)},x(t,e,n,r){const c=Wm(e,t);return D5(t,c,"x",n.intersect,r)},y(t,e,n,r){const c=Wm(e,t);return D5(t,c,"y",n.intersect,r)}}};const aN=["left","top","right","bottom"];function Vv(t,e){return t.filter(n=>n.pos===e)}function O5(t,e){return t.filter(n=>aN.indexOf(n.pos)===-1&&n.box.axis===e)}function $v(t,e){return t.sort((n,r)=>{const c=e?r:n,u=e?n:r;return c.weight===u.weight?c.index-u.index:c.weight-u.weight})}function Dye(t){const e=[];let n,r,c,u,p,o;for(n=0,r=(t||[]).length;n<r;++n)c=t[n],{position:u,options:{stack:p,stackWeight:o=1}}=c,e.push({index:n,box:c,pos:u,horizontal:c.isHorizontal(),weight:c.weight,stack:p&&u+p,stackWeight:o});return e}function Oye(t){const e={};for(const n of t){const{stack:r,pos:c,stackWeight:u}=n;if(!r||!aN.includes(c))continue;const p=e[r]||(e[r]={count:0,placed:0,weight:0,size:0});p.count++,p.weight+=u}return e}function Lye(t,e){const n=Oye(t),{vBoxMaxWidth:r,hBoxMaxHeight:c}=e;let u,p,o;for(u=0,p=t.length;u<p;++u){o=t[u];const{fullSize:w}=o.box,T=n[o.stack],A=T&&o.stackWeight/T.weight;o.horizontal?(o.width=A?A*r:w&&e.availableWidth,o.height=c):(o.width=r,o.height=A?A*c:w&&e.availableHeight)}return n}function zye(t){const e=Dye(t),n=$v(e.filter(T=>T.box.fullSize),!0),r=$v(Vv(e,"left"),!0),c=$v(Vv(e,"right")),u=$v(Vv(e,"top"),!0),p=$v(Vv(e,"bottom")),o=O5(e,"x"),w=O5(e,"y");return{fullSize:n,leftAndTop:r.concat(u),rightAndBottom:c.concat(w).concat(p).concat(o),chartArea:Vv(e,"chartArea"),vertical:r.concat(c).concat(w),horizontal:u.concat(p).concat(o)}}function L5(t,e,n,r){return Math.max(t[n],e[n])+Math.max(t[r],e[r])}function lN(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function Bye(t,e,n,r){const{pos:c,box:u}=n,p=t.maxPadding;if(!Eo(c)){n.size&&(t[c]-=n.size);const D=r[n.stack]||{size:0,count:1};D.size=Math.max(D.size,n.horizontal?u.height:u.width),n.size=D.size/D.count,t[c]+=n.size}u.getPadding&&lN(p,u.getPadding());const o=Math.max(0,e.outerWidth-L5(p,t,"left","right")),w=Math.max(0,e.outerHeight-L5(p,t,"top","bottom")),T=o!==t.w,A=w!==t.h;return t.w=o,t.h=w,n.horizontal?{same:T,other:A}:{same:A,other:T}}function Fye(t){const e=t.maxPadding;function n(r){const c=Math.max(e[r]-t[r],0);return t[r]+=c,c}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function Nye(t,e){const n=e.maxPadding;function r(c){const u={left:0,top:0,right:0,bottom:0};return c.forEach(p=>{u[p]=Math.max(e[p],n[p])}),u}return r(t?["left","right"]:["top","bottom"])}function Jv(t,e,n,r){const c=[];let u,p,o,w,T,A;for(u=0,p=t.length,T=0;u<p;++u){o=t[u],w=o.box,w.update(o.width||e.w,o.height||e.h,Nye(o.horizontal,e));const{same:D,other:B}=Bye(e,n,o,r);T|=D&&c.length,A=A||B,w.fullSize||c.push(o)}return T&&Jv(c,e,n,r)||A}function Ex(t,e,n,r,c){t.top=n,t.left=e,t.right=e+r,t.bottom=n+c,t.width=r,t.height=c}function z5(t,e,n,r){const c=n.padding;let{x:u,y:p}=e;for(const o of t){const w=o.box,T=r[o.stack]||{placed:0,weight:1},A=o.stackWeight/T.weight||1;if(o.horizontal){const D=e.w*A,B=T.size||w.height;_0(T.start)&&(p=T.start),w.fullSize?Ex(w,c.left,p,n.outerWidth-c.right-c.left,B):Ex(w,e.left+T.placed,p,D,B),T.start=p,T.placed+=D,p=w.bottom}else{const D=e.h*A,B=T.size||w.width;_0(T.start)&&(u=T.start),w.fullSize?Ex(w,u,c.top,B,n.outerHeight-c.bottom-c.top):Ex(w,u,e.top+T.placed,B,D),T.start=u,T.placed+=D,u=w.right}}e.x=u,e.y=p}var _u={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,r){if(!t)return;const c=Su(t.options.layout.padding),u=Math.max(e-c.width,0),p=Math.max(n-c.height,0),o=zye(t.boxes),w=o.vertical,T=o.horizontal;Wo(t.boxes,Q=>{typeof Q.beforeLayout=="function"&&Q.beforeLayout()});const A=w.reduce((Q,se)=>se.box.options&&se.box.options.display===!1?Q:Q+1,0)||1,D=Object.freeze({outerWidth:e,outerHeight:n,padding:c,availableWidth:u,availableHeight:p,vBoxMaxWidth:u/2/A,hBoxMaxHeight:p/2}),B=Object.assign({},c);lN(B,Su(r));const N=Object.assign({maxPadding:B,w:u,h:p,x:c.left,y:c.top},c),ee=Lye(w.concat(T),D);Jv(o.fullSize,N,D,ee),Jv(w,N,D,ee),Jv(T,N,D,ee)&&Jv(w,N,D,ee),Fye(N),z5(o.leftAndTop,N,D,ee),N.x+=N.w,N.y+=N.h,z5(o.rightAndBottom,N,D,ee),t.chartArea={left:N.left,top:N.top,right:N.left+N.w,bottom:N.top+N.h,height:N.h,width:N.w},Wo(o.chartArea,Q=>{const se=Q.box;Object.assign(se,t.chartArea),se.update(N.w,N.h,{left:0,top:0,right:0,bottom:0})})}};class cN{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,r){}removeEventListener(e,n,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,r,c){return n=Math.max(0,n||e.width),r=r||e.height,{width:n,height:Math.max(0,c?Math.floor(n/c):r)}}isAttached(e){return!0}updateConfig(e){}}class Vye extends cN{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const nw="$chartjs",$ye={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},B5=t=>t===null||t==="";function jye(t,e){const n=t.style,r=t.getAttribute("height"),c=t.getAttribute("width");if(t[nw]={initial:{height:r,width:c,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",B5(c)){const u=S5(t,"width");u!==void 0&&(t.width=u)}if(B5(r))if(t.style.height==="")t.height=t.width/(e||2);else{const u=S5(t,"height");u!==void 0&&(t.height=u)}return t}const uN=J_e?{passive:!0}:!1;function Uye(t,e,n){t&&t.addEventListener(e,n,uN)}function Hye(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,uN)}function Gye(t,e){const n=$ye[t.type]||t.type,{x:r,y:c}=Wm(t,e);return{type:n,chart:e,native:t,x:r!==void 0?r:null,y:c!==void 0?c:null}}function Hw(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function Wye(t,e,n){const r=t.canvas,c=new MutationObserver(u=>{let p=!1;for(const o of u)p=p||Hw(o.addedNodes,r),p=p&&!Hw(o.removedNodes,r);p&&n()});return c.observe(document,{childList:!0,subtree:!0}),c}function qye(t,e,n){const r=t.canvas,c=new MutationObserver(u=>{let p=!1;for(const o of u)p=p||Hw(o.removedNodes,r),p=p&&!Hw(o.addedNodes,r);p&&n()});return c.observe(document,{childList:!0,subtree:!0}),c}const v0=new Map;let F5=0;function dN(){const t=window.devicePixelRatio;t!==F5&&(F5=t,v0.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function Zye(t,e){v0.size||window.addEventListener("resize",dN),v0.set(t,e)}function Kye(t){v0.delete(t),v0.size||window.removeEventListener("resize",dN)}function Xye(t,e,n){const r=t.canvas,c=r&&aA(r);if(!c)return;const u=H6((o,w)=>{const T=c.clientWidth;n(o,w),T<c.clientWidth&&n()},window),p=new ResizeObserver(o=>{const w=o[0],T=w.contentRect.width,A=w.contentRect.height;T===0&&A===0||u(T,A)});return p.observe(c),Zye(t,u),p}function cT(t,e,n){n&&n.disconnect(),e==="resize"&&Kye(t)}function Yye(t,e,n){const r=t.canvas,c=H6(u=>{t.ctx!==null&&n(Gye(u,t))},t);return Uye(r,e,c),c}class Jye extends cN{acquireContext(e,n){const r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?(jye(e,n),r):null}releaseContext(e){const n=e.canvas;if(!n[nw])return!1;const r=n[nw].initial;["height","width"].forEach(u=>{const p=r[u];ls(p)?n.removeAttribute(u):n.setAttribute(u,p)});const c=r.style||{};return Object.keys(c).forEach(u=>{n.style[u]=c[u]}),n.width=n.width,delete n[nw],!0}addEventListener(e,n,r){this.removeEventListener(e,n);const c=e.$proxies||(e.$proxies={}),p={attach:Wye,detach:qye,resize:Xye}[n]||Yye;c[n]=p(e,n,r)}removeEventListener(e,n){const r=e.$proxies||(e.$proxies={}),c=r[n];if(!c)return;({attach:cT,detach:cT,resize:cT}[n]||Hye)(e,n,c),r[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,r,c){return Y_e(e,n,r,c)}isAttached(e){const n=e&&aA(e);return!!(n&&n.isConnected)}}function Qye(t){return!sA()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?Vye:Jye}var Nx;let _y=(Nx=class{constructor(){bo(this,"x");bo(this,"y");bo(this,"active",!1);bo(this,"options");bo(this,"$animations")}tooltipPosition(e){const{x:n,y:r}=this.getProps(["x","y"],e);return{x:n,y:r}}hasValue(){return $w(this.x)&&$w(this.y)}getProps(e,n){const r=this.$animations;if(!n||!r)return this;const c={};return e.forEach(u=>{c[u]=r[u]&&r[u].active()?r[u]._to:this[u]}),c}},bo(Nx,"defaults",{}),bo(Nx,"defaultRoutes"),Nx);function eve(t,e){const n=t.options.ticks,r=tve(t),c=Math.min(n.maxTicksLimit||r,r),u=n.major.enabled?ive(e):[],p=u.length,o=u[0],w=u[p-1],T=[];if(p>c)return rve(e,T,u,p/c),T;const A=nve(u,e,c);if(p>0){let D,B;const N=p>1?Math.round((w-o)/(p-1)):null;for(Ix(e,T,A,ls(N)?0:o-N,o),D=0,B=p-1;D<B;D++)Ix(e,T,A,u[D],u[D+1]);return Ix(e,T,A,w,ls(N)?e.length:w+N),T}return Ix(e,T,A),T}function tve(t){const e=t.options.offset,n=t._tickSize(),r=t._length/n+(e?0:1),c=t._maxLength/n;return Math.floor(Math.min(r,c))}function nve(t,e,n){const r=ove(t),c=e.length/n;if(!r)return Math.max(c,1);const u=o_e(r);for(let p=0,o=u.length-1;p<o;p++){const w=u[p];if(w>c)return w}return Math.max(c,1)}function ive(t){const e=[];let n,r;for(n=0,r=t.length;n<r;n++)t[n].major&&e.push(n);return e}function rve(t,e,n,r){let c=0,u=n[0],p;for(r=Math.ceil(r),p=0;p<t.length;p++)p===u&&(e.push(t[p]),c++,u=n[c*r])}function Ix(t,e,n,r,c){const u=Oo(r,0),p=Math.min(Oo(c,t.length),t.length);let o=0,w,T,A;for(n=Math.ceil(n),c&&(w=c-r,n=w/Math.floor(w/n)),A=u;A<0;)o++,A=Math.round(u+o*n);for(T=Math.max(u,0);T<p;T++)T===A&&(e.push(t[T]),o++,A=Math.round(u+o*n))}function ove(t){const e=t.length;let n,r;if(e<2)return!1;for(r=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==r)return!1;return r}const sve=t=>t==="left"?"right":t==="right"?"left":t,N5=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,V5=(t,e)=>Math.min(e||t,t);function $5(t,e){const n=[],r=t.length/e,c=t.length;let u=0;for(;u<c;u+=r)n.push(t[Math.floor(u)]);return n}function ave(t,e,n){const r=t.ticks.length,c=Math.min(e,r-1),u=t._startPixel,p=t._endPixel,o=1e-6;let w=t.getPixelForTick(c),T;if(!(n&&(r===1?T=Math.max(w-u,p-w):e===0?T=(t.getPixelForTick(1)-w)/2:T=(w-t.getPixelForTick(c-1))/2,w+=c<e?T:-T,w<u-o||w>p+o)))return w}function lve(t,e){Wo(t,n=>{const r=n.gc,c=r.length/2;let u;if(c>e){for(u=0;u<c;++u)delete n.data[r[u]];r.splice(0,c)}})}function jv(t){return t.drawTicks?t.tickLength:0}function j5(t,e){if(!t.display)return 0;const n=pl(t.font,e),r=Su(t.padding);return(wa(t.text)?t.text.length:1)*n.lineHeight+r.height}function cve(t,e){return gy(t,{scale:e,type:"scale"})}function uve(t,e,n){return gy(t,{tick:n,index:e,type:"tick"})}function dve(t,e,n){let r=eA(t);return(n&&e!=="right"||!n&&e==="right")&&(r=sve(r)),r}function hve(t,e,n,r){const{top:c,left:u,bottom:p,right:o,chart:w}=t,{chartArea:T,scales:A}=w;let D=0,B,N,ee;const Q=p-c,se=o-u;if(t.isHorizontal()){if(N=cl(r,u,o),Eo(n)){const ce=Object.keys(n)[0],be=n[ce];ee=A[ce].getPixelForValue(be)+Q-e}else n==="center"?ee=(T.bottom+T.top)/2+Q-e:ee=N5(t,n,e);B=o-u}else{if(Eo(n)){const ce=Object.keys(n)[0],be=n[ce];N=A[ce].getPixelForValue(be)-se+e}else n==="center"?N=(T.left+T.right)/2-se+e:N=N5(t,n,e);ee=cl(r,p,c),D=n==="left"?-id:id}return{titleX:N,titleY:ee,maxWidth:B,rotation:D}}class yy extends _y{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:r,_suggestedMax:c}=this;return e=Hd(e,Number.POSITIVE_INFINITY),n=Hd(n,Number.NEGATIVE_INFINITY),r=Hd(r,Number.POSITIVE_INFINITY),c=Hd(c,Number.NEGATIVE_INFINITY),{min:Hd(e,r),max:Hd(n,c),minDefined:wu(e),maxDefined:wu(n)}}getMinMax(e){let{min:n,max:r,minDefined:c,maxDefined:u}=this.getUserBounds(),p;if(c&&u)return{min:n,max:r};const o=this.getMatchingVisibleMetas();for(let w=0,T=o.length;w<T;++w)p=o[w].controller.getMinMax(this,e),c||(n=Math.min(n,p.min)),u||(r=Math.max(r,p.max));return n=u&&n>r?r:n,r=c&&n>r?n:r,{min:Hd(n,Hd(r,n)),max:Hd(r,Hd(n,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){ws(this.options.beforeUpdate,[this])}update(e,n,r){const{beginAtZero:c,grace:u,ticks:p}=this.options,o=p.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=z_e(this,u,c),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const w=o<this.ticks.length;this._convertTicksToLabels(w?$5(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),p.display&&(p.autoSkip||p.source==="auto")&&(this.ticks=eve(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),w&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,r;this.isHorizontal()?(n=this.left,r=this.right):(n=this.top,r=this.bottom,e=!e),this._startPixel=n,this._endPixel=r,this._reversePixels=e,this._length=r-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){ws(this.options.afterUpdate,[this])}beforeSetDimensions(){ws(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){ws(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),ws(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){ws(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let r,c,u;for(r=0,c=e.length;r<c;r++)u=e[r],u.label=ws(n.callback,[u.value,r,e],this)}afterTickToLabelConversion(){ws(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){ws(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,r=V5(this.ticks.length,e.ticks.maxTicksLimit),c=n.minRotation||0,u=n.maxRotation;let p=c,o,w,T;if(!this._isVisible()||!n.display||c>=u||r<=1||!this.isHorizontal()){this.labelRotation=c;return}const A=this._getLabelSizes(),D=A.widest.width,B=A.highest.height,N=rd(this.chart.width-D,0,this.maxWidth);o=e.offset?this.maxWidth/r:N/(r-1),D+6>o&&(o=N/(r-(e.offset?.5:1)),w=this.maxHeight-jv(e.grid)-n.padding-j5(e.title,this.chart.options.font),T=Math.sqrt(D*D+B*B),p=c_e(Math.min(Math.asin(rd((A.highest.height+6)/o,-1,1)),Math.asin(rd(w/T,-1,1))-Math.asin(rd(B/T,-1,1)))),p=Math.max(c,Math.min(u,p))),this.labelRotation=p}afterCalculateLabelRotation(){ws(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){ws(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:r,title:c,grid:u}}=this,p=this._isVisible(),o=this.isHorizontal();if(p){const w=j5(c,n.options.font);if(o?(e.width=this.maxWidth,e.height=jv(u)+w):(e.height=this.maxHeight,e.width=jv(u)+w),r.display&&this.ticks.length){const{first:T,last:A,widest:D,highest:B}=this._getLabelSizes(),N=r.padding*2,ee=ig(this.labelRotation),Q=Math.cos(ee),se=Math.sin(ee);if(o){const ce=r.mirror?0:se*D.width+Q*B.height;e.height=Math.min(this.maxHeight,e.height+ce+N)}else{const ce=r.mirror?0:Q*D.width+se*B.height;e.width=Math.min(this.maxWidth,e.width+ce+N)}this._calculatePadding(T,A,se,Q)}}this._handleMargins(),o?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,r,c){const{ticks:{align:u,padding:p},position:o}=this.options,w=this.labelRotation!==0,T=o!=="top"&&this.axis==="x";if(this.isHorizontal()){const A=this.getPixelForTick(0)-this.left,D=this.right-this.getPixelForTick(this.ticks.length-1);let B=0,N=0;w?T?(B=c*e.width,N=r*n.height):(B=r*e.height,N=c*n.width):u==="start"?N=n.width:u==="end"?B=e.width:u!=="inner"&&(B=e.width/2,N=n.width/2),this.paddingLeft=Math.max((B-A+p)*this.width/(this.width-A),0),this.paddingRight=Math.max((N-D+p)*this.width/(this.width-D),0)}else{let A=n.height/2,D=e.height/2;u==="start"?(A=0,D=e.height):u==="end"&&(A=n.height,D=0),this.paddingTop=A+p,this.paddingBottom=D+p}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){ws(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,r;for(n=0,r=e.length;n<r;n++)ls(e[n].label)&&(e.splice(n,1),r--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let r=this.ticks;n<r.length&&(r=$5(r,n)),this._labelSizes=e=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,r){const{ctx:c,_longestTextCache:u}=this,p=[],o=[],w=Math.floor(n/V5(n,r));let T=0,A=0,D,B,N,ee,Q,se,ce,be,ze,xe,je;for(D=0;D<n;D+=w){if(ee=e[D].label,Q=this._resolveTickFontOptions(D),c.font=se=Q.string,ce=u[se]=u[se]||{data:{},gc:[]},be=Q.lineHeight,ze=xe=0,!ls(ee)&&!wa(ee))ze=_5(c,ce.data,ce.gc,ze,ee),xe=be;else if(wa(ee))for(B=0,N=ee.length;B<N;++B)je=ee[B],!ls(je)&&!wa(je)&&(ze=_5(c,ce.data,ce.gc,ze,je),xe+=be);p.push(ze),o.push(xe),T=Math.max(ze,T),A=Math.max(xe,A)}lve(u,n);const qe=p.indexOf(T),oe=o.indexOf(A),de=Ee=>({width:p[Ee]||0,height:o[Ee]||0});return{first:de(0),last:de(n-1),widest:de(qe),highest:de(oe),widths:p,heights:o}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return f_e(this._alignToPixels?$m(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const r=n[e];return r.$context||(r.$context=uve(this.getContext(),e,r))}return this.$context||(this.$context=cve(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=ig(this.labelRotation),r=Math.abs(Math.cos(n)),c=Math.abs(Math.sin(n)),u=this._getLabelSizes(),p=e.autoSkipPadding||0,o=u?u.widest.width+p:0,w=u?u.highest.height+p:0;return this.isHorizontal()?w*r>o*c?o/r:w/c:w*c<o*r?w/r:o/c}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,r=this.chart,c=this.options,{grid:u,position:p,border:o}=c,w=u.offset,T=this.isHorizontal(),D=this.ticks.length+(w?1:0),B=jv(u),N=[],ee=o.setContext(this.getContext()),Q=ee.display?ee.width:0,se=Q/2,ce=function(on){return $m(r,on,Q)};let be,ze,xe,je,qe,oe,de,Ee,$e,me,Te,Re;if(p==="top")be=ce(this.bottom),oe=this.bottom-B,Ee=be-se,me=ce(e.top)+se,Re=e.bottom;else if(p==="bottom")be=ce(this.top),me=e.top,Re=ce(e.bottom)-se,oe=be+se,Ee=this.top+B;else if(p==="left")be=ce(this.right),qe=this.right-B,de=be-se,$e=ce(e.left)+se,Te=e.right;else if(p==="right")be=ce(this.left),$e=e.left,Te=ce(e.right)-se,qe=be+se,de=this.left+B;else if(n==="x"){if(p==="center")be=ce((e.top+e.bottom)/2+.5);else if(Eo(p)){const on=Object.keys(p)[0],hn=p[on];be=ce(this.chart.scales[on].getPixelForValue(hn))}me=e.top,Re=e.bottom,oe=be+se,Ee=oe+B}else if(n==="y"){if(p==="center")be=ce((e.left+e.right)/2);else if(Eo(p)){const on=Object.keys(p)[0],hn=p[on];be=ce(this.chart.scales[on].getPixelForValue(hn))}qe=be-se,de=qe-B,$e=e.left,Te=e.right}const tn=Oo(c.ticks.maxTicksLimit,D),Zt=Math.max(1,Math.ceil(D/tn));for(ze=0;ze<D;ze+=Zt){const on=this.getContext(ze),hn=u.setContext(on),Hn=o.setContext(on),Ri=hn.lineWidth,zi=hn.color,Pt=Hn.dash||[],Di=Hn.dashOffset,wo=hn.tickWidth,Ur=hn.tickColor,Br=hn.tickBorderDash||[],ai=hn.tickBorderDashOffset;xe=ave(this,ze,w),xe!==void 0&&(je=$m(r,xe,Ri),T?qe=de=$e=Te=je:oe=Ee=me=Re=je,N.push({tx1:qe,ty1:oe,tx2:de,ty2:Ee,x1:$e,y1:me,x2:Te,y2:Re,width:Ri,color:zi,borderDash:Pt,borderDashOffset:Di,tickWidth:wo,tickColor:Ur,tickBorderDash:Br,tickBorderDashOffset:ai}))}return this._ticksLength=D,this._borderValue=be,N}_computeLabelItems(e){const n=this.axis,r=this.options,{position:c,ticks:u}=r,p=this.isHorizontal(),o=this.ticks,{align:w,crossAlign:T,padding:A,mirror:D}=u,B=jv(r.grid),N=B+A,ee=D?-A:N,Q=-ig(this.labelRotation),se=[];let ce,be,ze,xe,je,qe,oe,de,Ee,$e,me,Te,Re="middle";if(c==="top")qe=this.bottom-ee,oe=this._getXAxisLabelAlignment();else if(c==="bottom")qe=this.top+ee,oe=this._getXAxisLabelAlignment();else if(c==="left"){const Zt=this._getYAxisLabelAlignment(B);oe=Zt.textAlign,je=Zt.x}else if(c==="right"){const Zt=this._getYAxisLabelAlignment(B);oe=Zt.textAlign,je=Zt.x}else if(n==="x"){if(c==="center")qe=(e.top+e.bottom)/2+N;else if(Eo(c)){const Zt=Object.keys(c)[0],on=c[Zt];qe=this.chart.scales[Zt].getPixelForValue(on)+N}oe=this._getXAxisLabelAlignment()}else if(n==="y"){if(c==="center")je=(e.left+e.right)/2-N;else if(Eo(c)){const Zt=Object.keys(c)[0],on=c[Zt];je=this.chart.scales[Zt].getPixelForValue(on)}oe=this._getYAxisLabelAlignment(B).textAlign}n==="y"&&(w==="start"?Re="top":w==="end"&&(Re="bottom"));const tn=this._getLabelSizes();for(ce=0,be=o.length;ce<be;++ce){ze=o[ce],xe=ze.label;const Zt=u.setContext(this.getContext(ce));de=this.getPixelForTick(ce)+u.labelOffset,Ee=this._resolveTickFontOptions(ce),$e=Ee.lineHeight,me=wa(xe)?xe.length:1;const on=me/2,hn=Zt.color,Hn=Zt.textStrokeColor,Ri=Zt.textStrokeWidth;let zi=oe;p?(je=de,oe==="inner"&&(ce===be-1?zi=this.options.reverse?"left":"right":ce===0?zi=this.options.reverse?"right":"left":zi="center"),c==="top"?T==="near"||Q!==0?Te=-me*$e+$e/2:T==="center"?Te=-tn.highest.height/2-on*$e+$e:Te=-tn.highest.height+$e/2:T==="near"||Q!==0?Te=$e/2:T==="center"?Te=tn.highest.height/2-on*$e:Te=tn.highest.height-me*$e,D&&(Te*=-1),Q!==0&&!Zt.showLabelBackdrop&&(je+=$e/2*Math.sin(Q))):(qe=de,Te=(1-me)*$e/2);let Pt;if(Zt.showLabelBackdrop){const Di=Su(Zt.backdropPadding),wo=tn.heights[ce],Ur=tn.widths[ce];let Br=Te-Di.top,ai=0-Di.left;switch(Re){case"middle":Br-=wo/2;break;case"bottom":Br-=wo;break}switch(oe){case"center":ai-=Ur/2;break;case"right":ai-=Ur;break;case"inner":ce===be-1?ai-=Ur:ce>0&&(ai-=Ur/2);break}Pt={left:ai,top:Br,width:Ur+Di.width,height:wo+Di.height,color:Zt.backdropColor}}se.push({label:xe,font:Ee,textOffset:Te,options:{rotation:Q,color:hn,strokeColor:Hn,strokeWidth:Ri,textAlign:zi,textBaseline:Re,translation:[je,qe],backdrop:Pt}})}return se}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-ig(this.labelRotation))return e==="top"?"left":"right";let c="center";return n.align==="start"?c="left":n.align==="end"?c="right":n.align==="inner"&&(c="inner"),c}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:r,mirror:c,padding:u}}=this.options,p=this._getLabelSizes(),o=e+u,w=p.widest.width;let T,A;return n==="left"?c?(A=this.right+u,r==="near"?T="left":r==="center"?(T="center",A+=w/2):(T="right",A+=w)):(A=this.right-o,r==="near"?T="right":r==="center"?(T="center",A-=w/2):(T="left",A=this.left)):n==="right"?c?(A=this.left+u,r==="near"?T="right":r==="center"?(T="center",A-=w/2):(T="left",A-=w)):(A=this.left+o,r==="near"?T="left":r==="center"?(T="center",A+=w/2):(T="right",A=this.right)):T="right",{textAlign:T,x:A}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:r,top:c,width:u,height:p}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(r,c,u,p),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const c=this.ticks.findIndex(u=>u.value===e);return c>=0?n.setContext(this.getContext(c)).lineWidth:0}drawGrid(e){const n=this.options.grid,r=this.ctx,c=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let u,p;const o=(w,T,A)=>{!A.width||!A.color||(r.save(),r.lineWidth=A.width,r.strokeStyle=A.color,r.setLineDash(A.borderDash||[]),r.lineDashOffset=A.borderDashOffset,r.beginPath(),r.moveTo(w.x,w.y),r.lineTo(T.x,T.y),r.stroke(),r.restore())};if(n.display)for(u=0,p=c.length;u<p;++u){const w=c[u];n.drawOnChartArea&&o({x:w.x1,y:w.y1},{x:w.x2,y:w.y2},w),n.drawTicks&&o({x:w.tx1,y:w.ty1},{x:w.tx2,y:w.ty2},{color:w.tickColor,width:w.tickWidth,borderDash:w.tickBorderDash,borderDashOffset:w.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:r,grid:c}}=this,u=r.setContext(this.getContext()),p=r.display?u.width:0;if(!p)return;const o=c.setContext(this.getContext(0)).lineWidth,w=this._borderValue;let T,A,D,B;this.isHorizontal()?(T=$m(e,this.left,p)-p/2,A=$m(e,this.right,o)+o/2,D=B=w):(D=$m(e,this.top,p)-p/2,B=$m(e,this.bottom,o)+o/2,T=A=w),n.save(),n.lineWidth=u.width,n.strokeStyle=u.color,n.beginPath(),n.moveTo(T,D),n.lineTo(A,B),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const r=this.ctx,c=this._computeLabelArea();c&&tA(r,c);const u=this.getLabelItems(e);for(const p of u){const o=p.options,w=p.font,T=p.label,A=p.textOffset;y0(r,T,0,A,w,o)}c&&nA(r)}drawTitle(){const{ctx:e,options:{position:n,title:r,reverse:c}}=this;if(!r.display)return;const u=pl(r.font),p=Su(r.padding),o=r.align;let w=u.lineHeight/2;n==="bottom"||n==="center"||Eo(n)?(w+=p.bottom,wa(r.text)&&(w+=u.lineHeight*(r.text.length-1))):w+=p.top;const{titleX:T,titleY:A,maxWidth:D,rotation:B}=hve(this,w,n,o);y0(e,r.text,0,0,u,{color:r.color,maxWidth:D,rotation:B,textAlign:dve(o,n,c),textBaseline:"middle",translation:[T,A]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,r=Oo(e.grid&&e.grid.z,-1),c=Oo(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==yy.prototype.draw?[{z:n,draw:u=>{this.draw(u)}}]:[{z:r,draw:u=>{this.drawBackground(),this.drawGrid(u),this.drawTitle()}},{z:c,draw:()=>{this.drawBorder()}},{z:n,draw:u=>{this.drawLabels(u)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",c=[];let u,p;for(u=0,p=n.length;u<p;++u){const o=n[u];o[r]===this.id&&(!e||o.type===e)&&c.push(o)}return c}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return pl(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Ax{constructor(e,n,r){this.type=e,this.scope=n,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let r;mve(n)&&(r=this.register(n));const c=this.items,u=e.id,p=this.scope+"."+u;if(!u)throw new Error("class does not have id: "+e);return u in c||(c[u]=e,fve(e,p,r),this.override&&oa.override(e.id,e.overrides)),p}get(e){return this.items[e]}unregister(e){const n=this.items,r=e.id,c=this.scope;r in n&&delete n[r],c&&r in oa[c]&&(delete oa[c][r],this.override&&delete _g[r])}}function fve(t,e,n){const r=g0(Object.create(null),[n?oa.get(n):{},oa.get(e),t.defaults]);oa.set(e,r),t.defaultRoutes&&pve(e,t.defaultRoutes),t.descriptors&&oa.describe(e,t.descriptors)}function pve(t,e){Object.keys(e).forEach(n=>{const r=n.split("."),c=r.pop(),u=[t].concat(r).join("."),p=e[n].split("."),o=p.pop(),w=p.join(".");oa.route(u,c,w,o)})}function mve(t){return"id"in t&&"defaults"in t}class gve{constructor(){this.controllers=new Ax(yb,"datasets",!0),this.elements=new Ax(_y,"elements"),this.plugins=new Ax(Object,"plugins"),this.scales=new Ax(yy,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,r){[...n].forEach(c=>{const u=r||this._getRegistryForType(c);r||u.isForType(c)||u===this.plugins&&c.id?this._exec(e,u,c):Wo(c,p=>{const o=r||this._getRegistryForType(p);this._exec(e,o,p)})})}_exec(e,n,r){const c=JI(e);ws(r["before"+c],[],r),n[e](r),ws(r["after"+c],[],r)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const r=this._typedRegistries[n];if(r.isForType(e))return r}return this.plugins}_get(e,n,r){const c=n.get(e);if(c===void 0)throw new Error('"'+e+'" is not a registered '+r+".");return c}}var qd=new gve;class _ve{constructor(){this._init=void 0}notify(e,n,r,c){if(n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const u=c?this._descriptors(e).filter(c):this._descriptors(e),p=this._notify(u,e,n,r);return n==="afterDestroy"&&(this._notify(u,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),p}_notify(e,n,r,c){c=c||{};for(const u of e){const p=u.plugin,o=p[r],w=[n,c,u.options];if(ws(o,w,p)===!1&&c.cancelable)return!1}return!0}invalidate(){ls(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const r=e&&e.config,c=Oo(r.options&&r.options.plugins,{}),u=yve(r);return c===!1&&!n?[]:bve(e,u,c,n)}_notifyStateChanges(e){const n=this._oldCache||[],r=this._cache,c=(u,p)=>u.filter(o=>!p.some(w=>o.plugin.id===w.plugin.id));this._notify(c(n,r),e,"stop"),this._notify(c(r,n),e,"start")}}function yve(t){const e={},n=[],r=Object.keys(qd.plugins.items);for(let u=0;u<r.length;u++)n.push(qd.getPlugin(r[u]));const c=t.plugins||[];for(let u=0;u<c.length;u++){const p=c[u];n.indexOf(p)===-1&&(n.push(p),e[p.id]=!0)}return{plugins:n,localIds:e}}function vve(t,e){return!e&&t===!1?null:t===!0?{}:t}function bve(t,{plugins:e,localIds:n},r,c){const u=[],p=t.getContext();for(const o of e){const w=o.id,T=vve(r[w],c);T!==null&&u.push({plugin:o,options:xve(t.config,{plugin:o,local:n[w]},T,p)})}return u}function xve(t,{plugin:e,local:n},r,c){const u=t.pluginScopeKeys(e),p=t.getOptionScopes(r,u);return n&&e.defaults&&p.push(e.defaults),t.createResolver(p,c,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function xE(t,e){const n=oa.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function wve(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function Sve(t,e){return t===e?"_index_":"_value_"}function U5(t){if(t==="x"||t==="y"||t==="r")return t}function Cve(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function wE(t,...e){if(U5(t))return t;for(const n of e){const r=n.axis||Cve(n.position)||t.length>1&&U5(t[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function H5(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function Tve(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(r=>r.xAxisID===t||r.yAxisID===t);if(n.length)return H5(t,"x",n[0])||H5(t,"y",n[0])}return{}}function Eve(t,e){const n=_g[t.type]||{scales:{}},r=e.scales||{},c=xE(t.type,e),u=Object.create(null);return Object.keys(r).forEach(p=>{const o=r[p];if(!Eo(o))return console.error(`Invalid scale configuration for scale: ${p}`);if(o._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${p}`);const w=wE(p,o,Tve(p,t),oa.scales[o.type]),T=Sve(w,c),A=n.scales||{};u[p]=mb(Object.create(null),[{axis:w},o,A[w],A[T]])}),t.data.datasets.forEach(p=>{const o=p.type||t.type,w=p.indexAxis||xE(o,e),A=(_g[o]||{}).scales||{};Object.keys(A).forEach(D=>{const B=wve(D,w),N=p[B+"AxisID"]||B;u[N]=u[N]||Object.create(null),mb(u[N],[{axis:B},r[N],A[D]])})}),Object.keys(u).forEach(p=>{const o=u[p];mb(o,[oa.scales[o.type],oa.scale])}),u}function hN(t){const e=t.options||(t.options={});e.plugins=Oo(e.plugins,{}),e.scales=Eve(t,e)}function fN(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function Ive(t){return t=t||{},t.data=fN(t.data),hN(t),t}const G5=new Map,pN=new Set;function kx(t,e){let n=G5.get(t);return n||(n=e(),G5.set(t,n),pN.add(n)),n}const Uv=(t,e,n)=>{const r=ay(e,n);r!==void 0&&t.add(r)};class Ave{constructor(e){this._config=Ive(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=fN(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),hN(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return kx(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return kx(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return kx(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,r=this.type;return kx(`${r}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const r=this._scopeCache;let c=r.get(e);return(!c||n)&&(c=new Map,r.set(e,c)),c}getOptionScopes(e,n,r){const{options:c,type:u}=this,p=this._cachedScopes(e,r),o=p.get(n);if(o)return o;const w=new Set;n.forEach(A=>{e&&(w.add(e),A.forEach(D=>Uv(w,e,D))),A.forEach(D=>Uv(w,c,D)),A.forEach(D=>Uv(w,_g[u]||{},D)),A.forEach(D=>Uv(w,oa,D)),A.forEach(D=>Uv(w,bE,D))});const T=Array.from(w);return T.length===0&&T.push(Object.create(null)),pN.has(n)&&p.set(n,T),T}chartOptionScopes(){const{options:e,type:n}=this;return[e,_g[n]||{},oa.datasets[n]||{},{type:n},oa,bE]}resolveNamedOptions(e,n,r,c=[""]){const u={$shared:!0},{resolver:p,subPrefixes:o}=W5(this._resolverCache,e,c);let w=p;if(Rve(p,n)){u.$shared=!1,r=$p(r)?r():r;const T=this.createResolver(e,r,o);w=ly(p,r,T)}for(const T of n)u[T]=w[T];return u}createResolver(e,n,r=[""],c){const{resolver:u}=W5(this._resolverCache,e,r);return Eo(n)?ly(u,n,void 0,c):u}}function W5(t,e,n){let r=t.get(e);r||(r=new Map,t.set(e,r));const c=n.join();let u=r.get(c);return u||(u={resolver:iA(e,n),subPrefixes:n.filter(o=>!o.toLowerCase().includes("hover"))},r.set(c,u)),u}const kve=t=>Eo(t)&&Object.getOwnPropertyNames(t).some(e=>$p(t[e]));function Rve(t,e){const{isScriptable:n,isIndexable:r}=J6(t);for(const c of e){const u=n(c),p=r(c),o=(p||u)&&t[c];if(u&&($p(o)||kve(o))||p&&wa(o))return!0}return!1}var Pve="4.5.1";const Mve=["top","bottom","left","right","chartArea"];function q5(t,e){return t==="top"||t==="bottom"||Mve.indexOf(t)===-1&&e==="x"}function Z5(t,e){return function(n,r){return n[t]===r[t]?n[e]-r[e]:n[t]-r[t]}}function K5(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),ws(n&&n.onComplete,[t],e)}function Dve(t){const e=t.chart,n=e.options.animation;ws(n&&n.onProgress,[t],e)}function mN(t){return sA()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const iw={},X5=t=>{const e=mN(t);return Object.values(iw).filter(n=>n.canvas===e).pop()};function Ove(t,e,n){const r=Object.keys(t);for(const c of r){const u=+c;if(u>=e){const p=t[c];delete t[c],(n>0||u>e)&&(t[u+n]=p)}}}function Lve(t,e,n,r){return!n||t.type==="mouseout"?null:r?e:t}class Yd{static register(...e){qd.add(...e),Y5()}static unregister(...e){qd.remove(...e),Y5()}constructor(e,n){const r=this.config=new Ave(n),c=mN(e),u=X5(c);if(u)throw new Error("Canvas is already in use. Chart with ID '"+u.id+"' must be destroyed before the canvas with ID '"+u.canvas.id+"' can be reused.");const p=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||Qye(c)),this.platform.updateConfig(r);const o=this.platform.acquireContext(c,p.aspectRatio),w=o&&o.canvas,T=w&&w.height,A=w&&w.width;if(this.id=Yge(),this.ctx=o,this.canvas=w,this.width=A,this.height=T,this._options=p,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new _ve,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=__e(D=>this.update(D),p.resizeDelay||0),this._dataChanges=[],iw[this.id]=this,!o||!w){console.error("Failed to create chart: can't acquire context from the given item");return}jh.listen(this,"complete",K5),jh.listen(this,"progress",Dve),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:r,height:c,_aspectRatio:u}=this;return ls(e)?n&&u?u:c?r/c:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return qd}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():w5(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return y5(this.canvas,this.ctx),this}stop(){return jh.stop(this),this}resize(e,n){jh.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const r=this.options,c=this.canvas,u=r.maintainAspectRatio&&this.aspectRatio,p=this.platform.getMaximumSize(c,e,n,u),o=r.devicePixelRatio||this.platform.getDevicePixelRatio(),w=this.width?"resize":"attach";this.width=p.width,this.height=p.height,this._aspectRatio=this.aspectRatio,w5(this,o,!0)&&(this.notifyPlugins("resize",{size:p}),ws(r.onResize,[this,p],this),this.attached&&this._doResize(w)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};Wo(n,(r,c)=>{r.id=c})}buildOrUpdateScales(){const e=this.options,n=e.scales,r=this.scales,c=Object.keys(r).reduce((p,o)=>(p[o]=!1,p),{});let u=[];n&&(u=u.concat(Object.keys(n).map(p=>{const o=n[p],w=wE(p,o),T=w==="r",A=w==="x";return{options:o,dposition:T?"chartArea":A?"bottom":"left",dtype:T?"radialLinear":A?"category":"linear"}}))),Wo(u,p=>{const o=p.options,w=o.id,T=wE(w,o),A=Oo(o.type,p.dtype);(o.position===void 0||q5(o.position,T)!==q5(p.dposition))&&(o.position=p.dposition),c[w]=!0;let D=null;if(w in r&&r[w].type===A)D=r[w];else{const B=qd.getScale(A);D=new B({id:w,type:A,ctx:this.ctx,chart:this}),r[D.id]=D}D.init(o,e)}),Wo(c,(p,o)=>{p||delete r[o]}),Wo(r,p=>{_u.configure(this,p,p.options),_u.addBox(this,p)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,r=e.length;if(e.sort((c,u)=>c.index-u.index),r>n){for(let c=n;c<r;++c)this._destroyDatasetMeta(c);e.splice(n,r-n)}this._sortedMetasets=e.slice(0).sort(Z5("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((r,c)=>{n.filter(u=>u===r._dataset).length===0&&this._destroyDatasetMeta(c)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let r,c;for(this._removeUnreferencedMetasets(),r=0,c=n.length;r<c;r++){const u=n[r];let p=this.getDatasetMeta(r);const o=u.type||this.config.type;if(p.type&&p.type!==o&&(this._destroyDatasetMeta(r),p=this.getDatasetMeta(r)),p.type=o,p.indexAxis=u.indexAxis||xE(o,this.options),p.order=u.order||0,p.index=r,p.label=""+u.label,p.visible=this.isDatasetVisible(r),p.controller)p.controller.updateIndex(r),p.controller.linkScales();else{const w=qd.getController(o),{datasetElementType:T,dataElementType:A}=oa.datasets[o];Object.assign(w,{dataElementType:qd.getElement(A),datasetElementType:T&&qd.getElement(T)}),p.controller=new w(this,r),e.push(p.controller)}}return this._updateMetasets(),e}_resetElements(){Wo(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const r=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),c=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const u=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let p=0;for(let T=0,A=this.data.datasets.length;T<A;T++){const{controller:D}=this.getDatasetMeta(T),B=!c&&u.indexOf(D)===-1;D.buildOrUpdateElements(B),p=Math.max(+D.getMaxOverflow(),p)}p=this._minPadding=r.layout.autoPadding?p:0,this._updateLayout(p),c||Wo(u,T=>{T.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Z5("z","_idx"));const{_active:o,_lastEvent:w}=this;w?this._eventHandler(w,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){Wo(this.scales,e=>{_u.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!l5(n,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:r,start:c,count:u}of n){const p=r==="_removeElements"?-u:u;Ove(e,c,p)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,r=u=>new Set(e.filter(p=>p[0]===u).map((p,o)=>o+","+p.splice(1).join(","))),c=r(0);for(let u=1;u<n;u++)if(!l5(c,r(u)))return;return Array.from(c).map(u=>u.split(",")).map(u=>({method:u[1],start:+u[2],count:+u[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;_u.update(this,this.width,this.height,e);const n=this.chartArea,r=n.width<=0||n.height<=0;this._layers=[],Wo(this.boxes,c=>{r&&c.position==="chartArea"||(c.configure&&c.configure(),this._layers.push(...c._layers()))},this),this._layers.forEach((c,u)=>{c._idx=u}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,r=this.data.datasets.length;n<r;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,r=this.data.datasets.length;n<r;++n)this._updateDataset(n,$p(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const r=this.getDatasetMeta(e),c={meta:r,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",c)!==!1&&(r.controller._update(n),c.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",c))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(jh.has(this)?this.attached&&!jh.running(this)&&jh.start(this):(this.draw(),K5({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:r,height:c}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,c)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,r=[];let c,u;for(c=0,u=n.length;c<u;++c){const p=n[c];(!e||p.visible)&&r.push(p)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,r={meta:e,index:e.index,cancelable:!0},c=nye(this,e);this.notifyPlugins("beforeDatasetDraw",r)!==!1&&(c&&tA(n,c),e.controller.draw(),c&&nA(n),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(e){return K6(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,r,c){const u=Mye.modes[n];return typeof u=="function"?u(this,e,r,c):[]}getDatasetMeta(e){const n=this.data.datasets[e],r=this._metasets;let c=r.filter(u=>u&&u._dataset===n).pop();return c||(c={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},r.push(c)),c}getContext(){return this.$context||(this.$context=gy(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const r=this.getDatasetMeta(e);return typeof r.hidden=="boolean"?!r.hidden:!n.hidden}setDatasetVisibility(e,n){const r=this.getDatasetMeta(e);r.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,r){const c=r?"show":"hide",u=this.getDatasetMeta(e),p=u.controller._resolveAnimations(void 0,c);_0(n)?(u.data[n].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),p.update(u,{visible:r}),this.update(o=>o.datasetIndex===e?c:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),jh.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),y5(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete iw[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,r=(u,p)=>{n.addEventListener(this,u,p),e[u]=p},c=(u,p,o)=>{u.offsetX=p,u.offsetY=o,this._eventHandler(u)};Wo(this.options.events,u=>r(u,c))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,r=(w,T)=>{n.addEventListener(this,w,T),e[w]=T},c=(w,T)=>{e[w]&&(n.removeEventListener(this,w,T),delete e[w])},u=(w,T)=>{this.canvas&&this.resize(w,T)};let p;const o=()=>{c("attach",o),this.attached=!0,this.resize(),r("resize",u),r("detach",p)};p=()=>{this.attached=!1,c("resize",u),this._stop(),this._resize(0,0),r("attach",o)},n.isAttached(this.canvas)?o():p()}unbindEvents(){Wo(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},Wo(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,r){const c=r?"set":"remove";let u,p,o,w;for(n==="dataset"&&(u=this.getDatasetMeta(e[0].datasetIndex),u.controller["_"+c+"DatasetHoverStyle"]()),o=0,w=e.length;o<w;++o){p=e[o];const T=p&&this.getDatasetMeta(p.datasetIndex).controller;T&&T[c+"HoverStyle"](p.element,p.datasetIndex,p.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],r=e.map(({datasetIndex:u,index:p})=>{const o=this.getDatasetMeta(u);if(!o)throw new Error("No dataset found at index "+u);return{datasetIndex:u,element:o.data[p],index:p}});!Fw(r,n)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,n))}notifyPlugins(e,n,r){return this._plugins.notify(this,e,n,r)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,r){const c=this.options.hover,u=(w,T)=>w.filter(A=>!T.some(D=>A.datasetIndex===D.datasetIndex&&A.index===D.index)),p=u(n,e),o=r?e:u(e,n);p.length&&this.updateHoverStyle(p,c.mode,!1),o.length&&c.mode&&this.updateHoverStyle(o,c.mode,!0)}_eventHandler(e,n){const r={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},c=p=>(p.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",r,c)===!1)return;const u=this._handleEvent(e,n,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,c),(u||r.changed)&&this.render(),this}_handleEvent(e,n,r){const{_active:c=[],options:u}=this,p=n,o=this._getActiveElements(e,c,r,p),w=i_e(e),T=Lve(e,this._lastEvent,r,w);r&&(this._lastEvent=null,ws(u.onHover,[e,o,this],this),w&&ws(u.onClick,[e,o,this],this));const A=!Fw(o,c);return(A||n)&&(this._active=o,this._updateHoverStyles(o,c,n)),this._lastEvent=T,A}_getActiveElements(e,n,r,c){if(e.type==="mouseout")return[];if(!r)return n;const u=this.options.hover;return this.getElementsAtEventForMode(e,u.mode,u,c)}}bo(Yd,"defaults",oa),bo(Yd,"instances",iw),bo(Yd,"overrides",_g),bo(Yd,"registry",qd),bo(Yd,"version",Pve),bo(Yd,"getChart",X5);function Y5(){return Wo(Yd.instances,t=>t._plugins.invalidate())}function gN(t,e){const{x:n,y:r,base:c,width:u,height:p}=t.getProps(["x","y","base","width","height"],e);let o,w,T,A,D;return t.horizontal?(D=p/2,o=Math.min(n,c),w=Math.max(n,c),T=r-D,A=r+D):(D=u/2,o=n-D,w=n+D,T=Math.min(r,c),A=Math.max(r,c)),{left:o,top:T,right:w,bottom:A}}function Ep(t,e,n,r){return t?0:rd(e,n,r)}function zve(t,e,n){const r=t.options.borderWidth,c=t.borderSkipped,u=Y6(r);return{t:Ep(c.top,u.top,0,n),r:Ep(c.right,u.right,0,e),b:Ep(c.bottom,u.bottom,0,n),l:Ep(c.left,u.left,0,e)}}function Bve(t,e,n){const{enableBorderRadius:r}=t.getProps(["enableBorderRadius"]),c=t.options.borderRadius,u=K_(c),p=Math.min(e,n),o=t.borderSkipped,w=r||Eo(c);return{topLeft:Ep(!w||o.top||o.left,u.topLeft,0,p),topRight:Ep(!w||o.top||o.right,u.topRight,0,p),bottomLeft:Ep(!w||o.bottom||o.left,u.bottomLeft,0,p),bottomRight:Ep(!w||o.bottom||o.right,u.bottomRight,0,p)}}function Fve(t){const e=gN(t),n=e.right-e.left,r=e.bottom-e.top,c=zve(t,n/2,r/2),u=Bve(t,n/2,r/2);return{outer:{x:e.left,y:e.top,w:n,h:r,radius:u},inner:{x:e.left+c.l,y:e.top+c.t,w:n-c.l-c.r,h:r-c.t-c.b,radius:{topLeft:Math.max(0,u.topLeft-Math.max(c.t,c.l)),topRight:Math.max(0,u.topRight-Math.max(c.t,c.r)),bottomLeft:Math.max(0,u.bottomLeft-Math.max(c.b,c.l)),bottomRight:Math.max(0,u.bottomRight-Math.max(c.b,c.r))}}}}function uT(t,e,n,r){const c=e===null,u=n===null,o=t&&!(c&&u)&&gN(t,r);return o&&(c||O_(e,o.left,o.right))&&(u||O_(n,o.top,o.bottom))}function Nve(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function Vve(t,e){t.rect(e.x,e.y,e.w,e.h)}function dT(t,e,n={}){const r=t.x!==n.x?-e:0,c=t.y!==n.y?-e:0,u=(t.x+t.w!==n.x+n.w?e:0)-r,p=(t.y+t.h!==n.y+n.h?e:0)-c;return{x:t.x+r,y:t.y+c,w:t.w+u,h:t.h+p,radius:t.radius}}class rw extends _y{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:n,options:{borderColor:r,backgroundColor:c}}=this,{inner:u,outer:p}=Fve(this),o=Nve(p.radius)?jw:Vve;e.save(),(p.w!==u.w||p.h!==u.h)&&(e.beginPath(),o(e,dT(p,n,u)),e.clip(),o(e,dT(u,-n,p)),e.fillStyle=r,e.fill("evenodd")),e.beginPath(),o(e,dT(u,n)),e.fillStyle=c,e.fill(),e.restore()}inRange(e,n,r){return uT(this,e,n,r)}inXRange(e,n){return uT(this,e,null,n)}inYRange(e,n){return uT(this,null,e,n)}getCenterPoint(e){const{x:n,y:r,base:c,horizontal:u}=this.getProps(["x","y","base","horizontal"],e);return{x:u?(n+c)/2:n,y:u?r:(r+c)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}bo(rw,"id","bar"),bo(rw,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),bo(rw,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const J5=(t,e)=>{let{boxHeight:n=e,boxWidth:r=e}=t;return t.usePointStyle&&(n=Math.min(n,e),r=t.pointStyleWidth||Math.min(r,e)),{boxWidth:r,boxHeight:n,itemHeight:Math.max(e,n)}},$ve=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class Q5 extends _y{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,r){this.maxWidth=e,this.maxHeight=n,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=ws(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(r=>e.filter(r,this.chart.data))),e.sort&&(n=n.sort((r,c)=>e.sort(r,c,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const r=e.labels,c=pl(r.font),u=c.size,p=this._computeTitleHeight(),{boxWidth:o,itemHeight:w}=J5(r,u);let T,A;n.font=c.string,this.isHorizontal()?(T=this.maxWidth,A=this._fitRows(p,u,o,w)+10):(A=this.maxHeight,T=this._fitCols(p,c,o,w)+10),this.width=Math.min(T,e.maxWidth||this.maxWidth),this.height=Math.min(A,e.maxHeight||this.maxHeight)}_fitRows(e,n,r,c){const{ctx:u,maxWidth:p,options:{labels:{padding:o}}}=this,w=this.legendHitBoxes=[],T=this.lineWidths=[0],A=c+o;let D=e;u.textAlign="left",u.textBaseline="middle";let B=-1,N=-A;return this.legendItems.forEach((ee,Q)=>{const se=r+n/2+u.measureText(ee.text).width;(Q===0||T[T.length-1]+se+2*o>p)&&(D+=A,T[T.length-(Q>0?0:1)]=0,N+=A,B++),w[Q]={left:0,top:N,row:B,width:se,height:c},T[T.length-1]+=se+o}),D}_fitCols(e,n,r,c){const{ctx:u,maxHeight:p,options:{labels:{padding:o}}}=this,w=this.legendHitBoxes=[],T=this.columnSizes=[],A=p-e;let D=o,B=0,N=0,ee=0,Q=0;return this.legendItems.forEach((se,ce)=>{const{itemWidth:be,itemHeight:ze}=jve(r,n,u,se,c);ce>0&&N+ze+2*o>A&&(D+=B+o,T.push({width:B,height:N}),ee+=B+o,Q++,B=N=0),w[ce]={left:ee,top:N,col:Q,width:be,height:ze},B=Math.max(B,be),N+=ze+o}),D+=B,T.push({width:B,height:N}),D}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:r,labels:{padding:c},rtl:u}}=this,p=X_(u,this.left,this.width);if(this.isHorizontal()){let o=0,w=cl(r,this.left+c,this.right-this.lineWidths[o]);for(const T of n)o!==T.row&&(o=T.row,w=cl(r,this.left+c,this.right-this.lineWidths[o])),T.top+=this.top+e+c,T.left=p.leftForLtr(p.x(w),T.width),w+=T.width+c}else{let o=0,w=cl(r,this.top+e+c,this.bottom-this.columnSizes[o].height);for(const T of n)T.col!==o&&(o=T.col,w=cl(r,this.top+e+c,this.bottom-this.columnSizes[o].height)),T.top=w,T.left+=this.left+c,T.left=p.leftForLtr(p.x(T.left),T.width),w+=T.height+c}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;tA(e,this),this._draw(),nA(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:r,ctx:c}=this,{align:u,labels:p}=e,o=oa.color,w=X_(e.rtl,this.left,this.width),T=pl(p.font),{padding:A}=p,D=T.size,B=D/2;let N;this.drawTitle(),c.textAlign=w.textAlign("left"),c.textBaseline="middle",c.lineWidth=.5,c.font=T.string;const{boxWidth:ee,boxHeight:Q,itemHeight:se}=J5(p,D),ce=function(qe,oe,de){if(isNaN(ee)||ee<=0||isNaN(Q)||Q<0)return;c.save();const Ee=Oo(de.lineWidth,1);if(c.fillStyle=Oo(de.fillStyle,o),c.lineCap=Oo(de.lineCap,"butt"),c.lineDashOffset=Oo(de.lineDashOffset,0),c.lineJoin=Oo(de.lineJoin,"miter"),c.lineWidth=Ee,c.strokeStyle=Oo(de.strokeStyle,o),c.setLineDash(Oo(de.lineDash,[])),p.usePointStyle){const $e={radius:Q*Math.SQRT2/2,pointStyle:de.pointStyle,rotation:de.rotation,borderWidth:Ee},me=w.xPlus(qe,ee/2),Te=oe+B;Z6(c,$e,me,Te,p.pointStyleWidth&&ee)}else{const $e=oe+Math.max((D-Q)/2,0),me=w.leftForLtr(qe,ee),Te=K_(de.borderRadius);c.beginPath(),Object.values(Te).some(Re=>Re!==0)?jw(c,{x:me,y:$e,w:ee,h:Q,radius:Te}):c.rect(me,$e,ee,Q),c.fill(),Ee!==0&&c.stroke()}c.restore()},be=function(qe,oe,de){y0(c,de.text,qe,oe+se/2,T,{strikethrough:de.hidden,textAlign:w.textAlign(de.textAlign)})},ze=this.isHorizontal(),xe=this._computeTitleHeight();ze?N={x:cl(u,this.left+A,this.right-r[0]),y:this.top+A+xe,line:0}:N={x:this.left+A,y:cl(u,this.top+xe+A,this.bottom-n[0].height),line:0},nN(this.ctx,e.textDirection);const je=se+A;this.legendItems.forEach((qe,oe)=>{c.strokeStyle=qe.fontColor,c.fillStyle=qe.fontColor;const de=c.measureText(qe.text).width,Ee=w.textAlign(qe.textAlign||(qe.textAlign=p.textAlign)),$e=ee+B+de;let me=N.x,Te=N.y;w.setWidth(this.width),ze?oe>0&&me+$e+A>this.right&&(Te=N.y+=je,N.line++,me=N.x=cl(u,this.left+A,this.right-r[N.line])):oe>0&&Te+je>this.bottom&&(me=N.x=me+n[N.line].width+A,N.line++,Te=N.y=cl(u,this.top+xe+A,this.bottom-n[N.line].height));const Re=w.x(me);if(ce(Re,Te,qe),me=y_e(Ee,me+ee+B,ze?me+$e:this.right,e.rtl),be(w.x(me),Te,qe),ze)N.x+=$e+A;else if(typeof qe.text!="string"){const tn=T.lineHeight;N.y+=_N(qe,tn)+A}else N.y+=je}),iN(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,r=pl(n.font),c=Su(n.padding);if(!n.display)return;const u=X_(e.rtl,this.left,this.width),p=this.ctx,o=n.position,w=r.size/2,T=c.top+w;let A,D=this.left,B=this.width;if(this.isHorizontal())B=Math.max(...this.lineWidths),A=this.top+T,D=cl(e.align,D,this.right-B);else{const ee=this.columnSizes.reduce((Q,se)=>Math.max(Q,se.height),0);A=T+cl(e.align,this.top,this.bottom-ee-e.labels.padding-this._computeTitleHeight())}const N=cl(o,D,D+B);p.textAlign=u.textAlign(eA(o)),p.textBaseline="middle",p.strokeStyle=n.color,p.fillStyle=n.color,p.font=r.string,y0(p,n.text,N,A,r)}_computeTitleHeight(){const e=this.options.title,n=pl(e.font),r=Su(e.padding);return e.display?n.lineHeight+r.height:0}_getLegendItemAt(e,n){let r,c,u;if(O_(e,this.left,this.right)&&O_(n,this.top,this.bottom)){for(u=this.legendHitBoxes,r=0;r<u.length;++r)if(c=u[r],O_(e,c.left,c.left+c.width)&&O_(n,c.top,c.top+c.height))return this.legendItems[r]}return null}handleEvent(e){const n=this.options;if(!Gve(e.type,n))return;const r=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const c=this._hoveredItem,u=$ve(c,r);c&&!u&&ws(n.onLeave,[e,c,this],this),this._hoveredItem=r,r&&!u&&ws(n.onHover,[e,r,this],this)}else r&&ws(n.onClick,[e,r,this],this)}}function jve(t,e,n,r,c){const u=Uve(r,t,e,n),p=Hve(c,r,e.lineHeight);return{itemWidth:u,itemHeight:p}}function Uve(t,e,n,r){let c=t.text;return c&&typeof c!="string"&&(c=c.reduce((u,p)=>u.length>p.length?u:p)),e+n.size/2+r.measureText(c).width}function Hve(t,e,n){let r=t;return typeof e.text!="string"&&(r=_N(e,n)),r}function _N(t,e){const n=t.text?t.text.length:0;return e*n}function Gve(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var Wve={id:"legend",_element:Q5,start(t,e,n){const r=t.legend=new Q5({ctx:t.ctx,options:n,chart:t});_u.configure(t,r,n),_u.addBox(t,r)},stop(t){_u.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const r=t.legend;_u.configure(t,r,n),r.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const r=e.datasetIndex,c=n.chart;c.isDatasetVisible(r)?(c.hide(r),e.hidden=!0):(c.show(r),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:r,textAlign:c,color:u,useBorderRadius:p,borderRadius:o}}=t.legend.options;return t._getSortedDatasetMetas().map(w=>{const T=w.controller.getStyle(n?0:void 0),A=Su(T.borderWidth);return{text:e[w.index].label,fillStyle:T.backgroundColor,fontColor:u,hidden:!w.visible,lineCap:T.borderCapStyle,lineDash:T.borderDash,lineDashOffset:T.borderDashOffset,lineJoin:T.borderJoinStyle,lineWidth:(A.width+A.height)/4,strokeStyle:T.borderColor,pointStyle:r||T.pointStyle,rotation:T.rotation,textAlign:c||T.textAlign,borderRadius:p&&(o||T.borderRadius),datasetIndex:w.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class yN extends _y{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n){const r=this.options;if(this.left=0,this.top=0,!r.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=n;const c=wa(r.text)?r.text.length:1;this._padding=Su(r.padding);const u=c*pl(r.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=u:this.width=u}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:n,left:r,bottom:c,right:u,options:p}=this,o=p.align;let w=0,T,A,D;return this.isHorizontal()?(A=cl(o,r,u),D=n+e,T=u-r):(p.position==="left"?(A=r+e,D=cl(o,c,n),w=gl*-.5):(A=u-e,D=cl(o,n,c),w=gl*.5),T=c-n),{titleX:A,titleY:D,maxWidth:T,rotation:w}}draw(){const e=this.ctx,n=this.options;if(!n.display)return;const r=pl(n.font),u=r.lineHeight/2+this._padding.top,{titleX:p,titleY:o,maxWidth:w,rotation:T}=this._drawArgs(u);y0(e,n.text,0,0,r,{color:n.color,maxWidth:w,rotation:T,textAlign:eA(n.align),textBaseline:"middle",translation:[p,o]})}}function qve(t,e){const n=new yN({ctx:t.ctx,options:e,chart:t});_u.configure(t,n,e),_u.addBox(t,n),t.titleBlock=n}var Zve={id:"title",_element:yN,start(t,e,n){qve(t,n)},stop(t){const e=t.titleBlock;_u.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,n){const r=t.titleBlock;_u.configure(t,r,n),r.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Qv={average(t){if(!t.length)return!1;let e,n,r=new Set,c=0,u=0;for(e=0,n=t.length;e<n;++e){const o=t[e].element;if(o&&o.hasValue()){const w=o.tooltipPosition();r.add(w.x),c+=w.y,++u}}return u===0||r.size===0?!1:{x:[...r].reduce((o,w)=>o+w)/r.size,y:c/u}},nearest(t,e){if(!t.length)return!1;let n=e.x,r=e.y,c=Number.POSITIVE_INFINITY,u,p,o;for(u=0,p=t.length;u<p;++u){const w=t[u].element;if(w&&w.hasValue()){const T=w.getCenterPoint(),A=d_e(e,T);A<c&&(c=A,o=w)}}if(o){const w=o.tooltipPosition();n=w.x,r=w.y}return{x:n,y:r}}};function Gd(t,e){return e&&(wa(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Uh(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function Kve(t,e){const{element:n,datasetIndex:r,index:c}=e,u=t.getDatasetMeta(r).controller,{label:p,value:o}=u.getLabelAndValue(c);return{chart:t,label:p,parsed:u.getParsed(c),raw:t.data.datasets[r].data[c],formattedValue:o,dataset:u.getDataset(),dataIndex:c,datasetIndex:r,element:n}}function eL(t,e){const n=t.chart.ctx,{body:r,footer:c,title:u}=t,{boxWidth:p,boxHeight:o}=e,w=pl(e.bodyFont),T=pl(e.titleFont),A=pl(e.footerFont),D=u.length,B=c.length,N=r.length,ee=Su(e.padding);let Q=ee.height,se=0,ce=r.reduce((xe,je)=>xe+je.before.length+je.lines.length+je.after.length,0);if(ce+=t.beforeBody.length+t.afterBody.length,D&&(Q+=D*T.lineHeight+(D-1)*e.titleSpacing+e.titleMarginBottom),ce){const xe=e.displayColors?Math.max(o,w.lineHeight):w.lineHeight;Q+=N*xe+(ce-N)*w.lineHeight+(ce-1)*e.bodySpacing}B&&(Q+=e.footerMarginTop+B*A.lineHeight+(B-1)*e.footerSpacing);let be=0;const ze=function(xe){se=Math.max(se,n.measureText(xe).width+be)};return n.save(),n.font=T.string,Wo(t.title,ze),n.font=w.string,Wo(t.beforeBody.concat(t.afterBody),ze),be=e.displayColors?p+2+e.boxPadding:0,Wo(r,xe=>{Wo(xe.before,ze),Wo(xe.lines,ze),Wo(xe.after,ze)}),be=0,n.font=A.string,Wo(t.footer,ze),n.restore(),se+=ee.width,{width:se,height:Q}}function Xve(t,e){const{y:n,height:r}=e;return n<r/2?"top":n>t.height-r/2?"bottom":"center"}function Yve(t,e,n,r){const{x:c,width:u}=r,p=n.caretSize+n.caretPadding;if(t==="left"&&c+u+p>e.width||t==="right"&&c-u-p<0)return!0}function Jve(t,e,n,r){const{x:c,width:u}=n,{width:p,chartArea:{left:o,right:w}}=t;let T="center";return r==="center"?T=c<=(o+w)/2?"left":"right":c<=u/2?T="left":c>=p-u/2&&(T="right"),Yve(T,t,e,n)&&(T="center"),T}function tL(t,e,n){const r=n.yAlign||e.yAlign||Xve(t,n);return{xAlign:n.xAlign||e.xAlign||Jve(t,e,n,r),yAlign:r}}function Qve(t,e){let{x:n,width:r}=t;return e==="right"?n-=r:e==="center"&&(n-=r/2),n}function ebe(t,e,n){let{y:r,height:c}=t;return e==="top"?r+=n:e==="bottom"?r-=c+n:r-=c/2,r}function nL(t,e,n,r){const{caretSize:c,caretPadding:u,cornerRadius:p}=t,{xAlign:o,yAlign:w}=n,T=c+u,{topLeft:A,topRight:D,bottomLeft:B,bottomRight:N}=K_(p);let ee=Qve(e,o);const Q=ebe(e,w,T);return w==="center"?o==="left"?ee+=T:o==="right"&&(ee-=T):o==="left"?ee-=Math.max(A,B)+c:o==="right"&&(ee+=Math.max(D,N)+c),{x:rd(ee,0,r.width-e.width),y:rd(Q,0,r.height-e.height)}}function Rx(t,e,n){const r=Su(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-r.right:t.x+r.left}function iL(t){return Gd([],Uh(t))}function tbe(t,e,n){return gy(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function rL(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const vN={beforeTitle:$h,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,r=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(r>0&&e.dataIndex<r)return n[e.dataIndex]}return""},afterTitle:$h,beforeBody:$h,beforeLabel:$h,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return ls(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:$h,afterBody:$h,beforeFooter:$h,footer:$h,afterFooter:$h};function lc(t,e,n,r){const c=t[e].call(n,r);return typeof c>"u"?vN[e].call(n,r):c}class SE extends _y{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,r=this.options.setContext(this.getContext()),c=r.enabled&&n.options.animation&&r.animations,u=new rN(this.chart,c);return c._cacheable&&(this._cachedAnimations=Object.freeze(u)),u}getContext(){return this.$context||(this.$context=tbe(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:r}=n,c=lc(r,"beforeTitle",this,e),u=lc(r,"title",this,e),p=lc(r,"afterTitle",this,e);let o=[];return o=Gd(o,Uh(c)),o=Gd(o,Uh(u)),o=Gd(o,Uh(p)),o}getBeforeBody(e,n){return iL(lc(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:r}=n,c=[];return Wo(e,u=>{const p={before:[],lines:[],after:[]},o=rL(r,u);Gd(p.before,Uh(lc(o,"beforeLabel",this,u))),Gd(p.lines,lc(o,"label",this,u)),Gd(p.after,Uh(lc(o,"afterLabel",this,u))),c.push(p)}),c}getAfterBody(e,n){return iL(lc(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:r}=n,c=lc(r,"beforeFooter",this,e),u=lc(r,"footer",this,e),p=lc(r,"afterFooter",this,e);let o=[];return o=Gd(o,Uh(c)),o=Gd(o,Uh(u)),o=Gd(o,Uh(p)),o}_createItems(e){const n=this._active,r=this.chart.data,c=[],u=[],p=[];let o=[],w,T;for(w=0,T=n.length;w<T;++w)o.push(Kve(this.chart,n[w]));return e.filter&&(o=o.filter((A,D,B)=>e.filter(A,D,B,r))),e.itemSort&&(o=o.sort((A,D)=>e.itemSort(A,D,r))),Wo(o,A=>{const D=rL(e.callbacks,A);c.push(lc(D,"labelColor",this,A)),u.push(lc(D,"labelPointStyle",this,A)),p.push(lc(D,"labelTextColor",this,A))}),this.labelColors=c,this.labelPointStyles=u,this.labelTextColors=p,this.dataPoints=o,o}update(e,n){const r=this.options.setContext(this.getContext()),c=this._active;let u,p=[];if(!c.length)this.opacity!==0&&(u={opacity:0});else{const o=Qv[r.position].call(this,c,this._eventPosition);p=this._createItems(r),this.title=this.getTitle(p,r),this.beforeBody=this.getBeforeBody(p,r),this.body=this.getBody(p,r),this.afterBody=this.getAfterBody(p,r),this.footer=this.getFooter(p,r);const w=this._size=eL(this,r),T=Object.assign({},o,w),A=tL(this.chart,r,T),D=nL(r,T,A,this.chart);this.xAlign=A.xAlign,this.yAlign=A.yAlign,u={opacity:1,x:D.x,y:D.y,width:w.width,height:w.height,caretX:o.x,caretY:o.y}}this._tooltipItems=p,this.$context=void 0,u&&this._resolveAnimations().update(this,u),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,r,c){const u=this.getCaretPosition(e,r,c);n.lineTo(u.x1,u.y1),n.lineTo(u.x2,u.y2),n.lineTo(u.x3,u.y3)}getCaretPosition(e,n,r){const{xAlign:c,yAlign:u}=this,{caretSize:p,cornerRadius:o}=r,{topLeft:w,topRight:T,bottomLeft:A,bottomRight:D}=K_(o),{x:B,y:N}=e,{width:ee,height:Q}=n;let se,ce,be,ze,xe,je;return u==="center"?(xe=N+Q/2,c==="left"?(se=B,ce=se-p,ze=xe+p,je=xe-p):(se=B+ee,ce=se+p,ze=xe-p,je=xe+p),be=se):(c==="left"?ce=B+Math.max(w,A)+p:c==="right"?ce=B+ee-Math.max(T,D)-p:ce=this.caretX,u==="top"?(ze=N,xe=ze-p,se=ce-p,be=ce+p):(ze=N+Q,xe=ze+p,se=ce+p,be=ce-p),je=ze),{x1:se,x2:ce,x3:be,y1:ze,y2:xe,y3:je}}drawTitle(e,n,r){const c=this.title,u=c.length;let p,o,w;if(u){const T=X_(r.rtl,this.x,this.width);for(e.x=Rx(this,r.titleAlign,r),n.textAlign=T.textAlign(r.titleAlign),n.textBaseline="middle",p=pl(r.titleFont),o=r.titleSpacing,n.fillStyle=r.titleColor,n.font=p.string,w=0;w<u;++w)n.fillText(c[w],T.x(e.x),e.y+p.lineHeight/2),e.y+=p.lineHeight+o,w+1===u&&(e.y+=r.titleMarginBottom-o)}}_drawColorBox(e,n,r,c,u){const p=this.labelColors[r],o=this.labelPointStyles[r],{boxHeight:w,boxWidth:T}=u,A=pl(u.bodyFont),D=Rx(this,"left",u),B=c.x(D),N=w<A.lineHeight?(A.lineHeight-w)/2:0,ee=n.y+N;if(u.usePointStyle){const Q={radius:Math.min(T,w)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},se=c.leftForLtr(B,T)+T/2,ce=ee+w/2;e.strokeStyle=u.multiKeyBackground,e.fillStyle=u.multiKeyBackground,v5(e,Q,se,ce),e.strokeStyle=p.borderColor,e.fillStyle=p.backgroundColor,v5(e,Q,se,ce)}else{e.lineWidth=Eo(p.borderWidth)?Math.max(...Object.values(p.borderWidth)):p.borderWidth||1,e.strokeStyle=p.borderColor,e.setLineDash(p.borderDash||[]),e.lineDashOffset=p.borderDashOffset||0;const Q=c.leftForLtr(B,T),se=c.leftForLtr(c.xPlus(B,1),T-2),ce=K_(p.borderRadius);Object.values(ce).some(be=>be!==0)?(e.beginPath(),e.fillStyle=u.multiKeyBackground,jw(e,{x:Q,y:ee,w:T,h:w,radius:ce}),e.fill(),e.stroke(),e.fillStyle=p.backgroundColor,e.beginPath(),jw(e,{x:se,y:ee+1,w:T-2,h:w-2,radius:ce}),e.fill()):(e.fillStyle=u.multiKeyBackground,e.fillRect(Q,ee,T,w),e.strokeRect(Q,ee,T,w),e.fillStyle=p.backgroundColor,e.fillRect(se,ee+1,T-2,w-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,n,r){const{body:c}=this,{bodySpacing:u,bodyAlign:p,displayColors:o,boxHeight:w,boxWidth:T,boxPadding:A}=r,D=pl(r.bodyFont);let B=D.lineHeight,N=0;const ee=X_(r.rtl,this.x,this.width),Q=function(de){n.fillText(de,ee.x(e.x+N),e.y+B/2),e.y+=B+u},se=ee.textAlign(p);let ce,be,ze,xe,je,qe,oe;for(n.textAlign=p,n.textBaseline="middle",n.font=D.string,e.x=Rx(this,se,r),n.fillStyle=r.bodyColor,Wo(this.beforeBody,Q),N=o&&se!=="right"?p==="center"?T/2+A:T+2+A:0,xe=0,qe=c.length;xe<qe;++xe){for(ce=c[xe],be=this.labelTextColors[xe],n.fillStyle=be,Wo(ce.before,Q),ze=ce.lines,o&&ze.length&&(this._drawColorBox(n,e,xe,ee,r),B=Math.max(D.lineHeight,w)),je=0,oe=ze.length;je<oe;++je)Q(ze[je]),B=D.lineHeight;Wo(ce.after,Q)}N=0,B=D.lineHeight,Wo(this.afterBody,Q),e.y-=u}drawFooter(e,n,r){const c=this.footer,u=c.length;let p,o;if(u){const w=X_(r.rtl,this.x,this.width);for(e.x=Rx(this,r.footerAlign,r),e.y+=r.footerMarginTop,n.textAlign=w.textAlign(r.footerAlign),n.textBaseline="middle",p=pl(r.footerFont),n.fillStyle=r.footerColor,n.font=p.string,o=0;o<u;++o)n.fillText(c[o],w.x(e.x),e.y+p.lineHeight/2),e.y+=p.lineHeight+r.footerSpacing}}drawBackground(e,n,r,c){const{xAlign:u,yAlign:p}=this,{x:o,y:w}=e,{width:T,height:A}=r,{topLeft:D,topRight:B,bottomLeft:N,bottomRight:ee}=K_(c.cornerRadius);n.fillStyle=c.backgroundColor,n.strokeStyle=c.borderColor,n.lineWidth=c.borderWidth,n.beginPath(),n.moveTo(o+D,w),p==="top"&&this.drawCaret(e,n,r,c),n.lineTo(o+T-B,w),n.quadraticCurveTo(o+T,w,o+T,w+B),p==="center"&&u==="right"&&this.drawCaret(e,n,r,c),n.lineTo(o+T,w+A-ee),n.quadraticCurveTo(o+T,w+A,o+T-ee,w+A),p==="bottom"&&this.drawCaret(e,n,r,c),n.lineTo(o+N,w+A),n.quadraticCurveTo(o,w+A,o,w+A-N),p==="center"&&u==="left"&&this.drawCaret(e,n,r,c),n.lineTo(o,w+D),n.quadraticCurveTo(o,w,o+D,w),n.closePath(),n.fill(),c.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,r=this.$animations,c=r&&r.x,u=r&&r.y;if(c||u){const p=Qv[e.position].call(this,this._active,this._eventPosition);if(!p)return;const o=this._size=eL(this,e),w=Object.assign({},p,this._size),T=tL(n,e,w),A=nL(e,w,T,n);(c._to!==A.x||u._to!==A.y)&&(this.xAlign=T.xAlign,this.yAlign=T.yAlign,this.width=o.width,this.height=o.height,this.caretX=p.x,this.caretY=p.y,this._resolveAnimations().update(this,A))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(n);const c={width:this.width,height:this.height},u={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const p=Su(n.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&o&&(e.save(),e.globalAlpha=r,this.drawBackground(u,e,c,n),nN(e,n.textDirection),u.y+=p.top,this.drawTitle(u,e,n),this.drawBody(u,e,n),this.drawFooter(u,e,n),iN(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const r=this._active,c=e.map(({datasetIndex:o,index:w})=>{const T=this.chart.getDatasetMeta(o);if(!T)throw new Error("Cannot find a dataset at index "+o);return{datasetIndex:o,element:T.data[w],index:w}}),u=!Fw(r,c),p=this._positionChanged(c,n);(u||p)&&(this._active=c,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,r=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const c=this.options,u=this._active||[],p=this._getActiveElements(e,u,n,r),o=this._positionChanged(p,e),w=n||!Fw(p,u)||o;return w&&(this._active=p,(c.enabled||c.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),w}_getActiveElements(e,n,r,c){const u=this.options;if(e.type==="mouseout")return[];if(!c)return n.filter(o=>this.chart.data.datasets[o.datasetIndex]&&this.chart.getDatasetMeta(o.datasetIndex).controller.getParsed(o.index)!==void 0);const p=this.chart.getElementsAtEventForMode(e,u.mode,u,r);return u.reverse&&p.reverse(),p}_positionChanged(e,n){const{caretX:r,caretY:c,options:u}=this,p=Qv[u.position].call(this,e,n);return p!==!1&&(r!==p.x||c!==p.y)}}bo(SE,"positioners",Qv);var nbe={id:"tooltip",_element:SE,positioners:Qv,afterInit(t,e,n){n&&(t.tooltip=new SE({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:vN},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const ibe=(t,e,n,r)=>(typeof e=="string"?(n=t.push(e)-1,r.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function rbe(t,e,n,r){const c=t.indexOf(e);if(c===-1)return ibe(t,e,n,r);const u=t.lastIndexOf(e);return c!==u?n:c}const obe=(t,e)=>t===null?null:rd(Math.round(t),0,e);function oL(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class CE extends yy{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const r=this.getLabels();for(const{index:c,label:u}of n)r[c]===u&&r.splice(c,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(ls(e))return null;const r=this.getLabels();return n=isFinite(n)&&r[n]===e?n:rbe(r,e,Oo(n,e),this._addedLabels),obe(n,r.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:r,max:c}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(r=0),n||(c=this.getLabels().length-1)),this.min=r,this.max=c}buildTicks(){const e=this.min,n=this.max,r=this.options.offset,c=[];let u=this.getLabels();u=e===0&&n===u.length-1?u:u.slice(e,n+1),this._valueRange=Math.max(u.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let p=e;p<=n;p++)c.push({value:p});return c}getLabelForValue(e){return oL.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}bo(CE,"id","category"),bo(CE,"defaults",{ticks:{callback:oL}});function sbe(t,e){const n=[],{bounds:c,step:u,min:p,max:o,precision:w,count:T,maxTicks:A,maxDigits:D,includeBounds:B}=t,N=u||1,ee=A-1,{min:Q,max:se}=e,ce=!ls(p),be=!ls(o),ze=!ls(T),xe=(se-Q)/(D+1);let je=u5((se-Q)/ee/N)*N,qe,oe,de,Ee;if(je<1e-14&&!ce&&!be)return[{value:Q},{value:se}];Ee=Math.ceil(se/je)-Math.floor(Q/je),Ee>ee&&(je=u5(Ee*je/ee/N)*N),ls(w)||(qe=Math.pow(10,w),je=Math.ceil(je*qe)/qe),c==="ticks"?(oe=Math.floor(Q/je)*je,de=Math.ceil(se/je)*je):(oe=Q,de=se),ce&&be&&u&&a_e((o-p)/u,je/1e3)?(Ee=Math.round(Math.min((o-p)/je,A)),je=(o-p)/Ee,oe=p,de=o):ze?(oe=ce?p:oe,de=be?o:de,Ee=T-1,je=(de-oe)/Ee):(Ee=(de-oe)/je,ew(Ee,Math.round(Ee),je/1e3)?Ee=Math.round(Ee):Ee=Math.ceil(Ee));const $e=Math.max(d5(je),d5(oe));qe=Math.pow(10,ls(w)?$e:w),oe=Math.round(oe*qe)/qe,de=Math.round(de*qe)/qe;let me=0;for(ce&&(B&&oe!==p?(n.push({value:p}),oe<p&&me++,ew(Math.round((oe+me*je)*qe)/qe,p,sL(p,xe,t))&&me++):oe<p&&me++);me<Ee;++me){const Te=Math.round((oe+me*je)*qe)/qe;if(be&&Te>o)break;n.push({value:Te})}return be&&B&&de!==o?n.length&&ew(n[n.length-1].value,o,sL(o,xe,t))?n[n.length-1].value=o:n.push({value:o}):(!be||de===o)&&n.push({value:de}),n}function sL(t,e,{horizontal:n,minRotation:r}){const c=ig(r),u=(n?Math.sin(c):Math.cos(c))||.001,p=.75*e*(""+t).length;return Math.min(e/u,p)}class abe extends yy{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return ls(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:r}=this.getUserBounds();let{min:c,max:u}=this;const p=w=>c=n?c:w,o=w=>u=r?u:w;if(e){const w=Lp(c),T=Lp(u);w<0&&T<0?o(0):w>0&&T>0&&p(0)}if(c===u){let w=u===0?1:Math.abs(u*.05);o(u+w),e||p(c-w)}this.min=c,this.max=u}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:r}=e,c;return r?(c=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,c>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${c} ticks. Limiting to 1000.`),c=1e3)):(c=this.computeTickLimit(),n=n||11),n&&(c=Math.min(n,c)),c}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let r=this.getTickLimit();r=Math.max(2,r);const c={maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},u=this._range||this,p=sbe(c,u);return e.bounds==="ticks"&&l_e(p,this,"value"),e.reverse?(p.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),p}configure(){const e=this.ticks;let n=this.min,r=this.max;if(super.configure(),this.options.offset&&e.length){const c=(r-n)/Math.max(e.length-1,1)/2;n-=c,r+=c}this._startValue=n,this._endValue=r,this._valueRange=r-n}getLabelForValue(e){return W6(e,this.chart.options.locale,this.options.ticks.format)}}class TE extends abe{determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=wu(e)?e:0,this.max=wu(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,r=ig(this.options.ticks.minRotation),c=(e?Math.sin(r):Math.cos(r))||.001,u=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,u.lineHeight/c))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}bo(TE,"id","linear"),bo(TE,"defaults",{ticks:{callback:q6.formatters.numeric}});const jS={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},uc=Object.keys(jS);function aL(t,e){return t-e}function lL(t,e){if(ls(e))return null;const n=t._adapter,{parser:r,round:c,isoWeekday:u}=t._parseOpts;let p=e;return typeof r=="function"&&(p=r(p)),wu(p)||(p=typeof r=="string"?n.parse(p,r):n.parse(p)),p===null?null:(c&&(p=c==="week"&&($w(u)||u===!0)?n.startOf(p,"isoWeek",u):n.startOf(p,c)),+p)}function cL(t,e,n,r){const c=uc.length;for(let u=uc.indexOf(t);u<c-1;++u){const p=jS[uc[u]],o=p.steps?p.steps:Number.MAX_SAFE_INTEGER;if(p.common&&Math.ceil((n-e)/(o*p.size))<=r)return uc[u]}return uc[c-1]}function lbe(t,e,n,r,c){for(let u=uc.length-1;u>=uc.indexOf(n);u--){const p=uc[u];if(jS[p].common&&t._adapter.diff(c,r,p)>=e-1)return p}return uc[n?uc.indexOf(n):0]}function cbe(t){for(let e=uc.indexOf(t)+1,n=uc.length;e<n;++e)if(jS[uc[e]].common)return uc[e]}function uL(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:r,hi:c}=QI(n,e),u=n[r]>=e?n[r]:n[c];t[u]=!0}}function ube(t,e,n,r){const c=t._adapter,u=+c.startOf(e[0].value,r),p=e[e.length-1].value;let o,w;for(o=u;o<=p;o=+c.add(o,1,r))w=n[o],w>=0&&(e[w].major=!0);return e}function dL(t,e,n){const r=[],c={},u=e.length;let p,o;for(p=0;p<u;++p)o=e[p],c[o]=p,r.push({value:o,major:!1});return u===0||!n?r:ube(t,r,c,n)}class Gw extends yy{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const r=e.time||(e.time={}),c=this._adapter=new Iye._date(e.adapters.date);c.init(n),mb(r.displayFormats,c.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:lL(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,r=e.time.unit||"day";let{min:c,max:u,minDefined:p,maxDefined:o}=this.getUserBounds();function w(T){!p&&!isNaN(T.min)&&(c=Math.min(c,T.min)),!o&&!isNaN(T.max)&&(u=Math.max(u,T.max))}(!p||!o)&&(w(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&w(this.getMinMax(!1))),c=wu(c)&&!isNaN(c)?c:+n.startOf(Date.now(),r),u=wu(u)&&!isNaN(u)?u:+n.endOf(Date.now(),r)+1,this.min=Math.min(c,u-1),this.max=Math.max(c+1,u)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],r=e[e.length-1]),{min:n,max:r}}buildTicks(){const e=this.options,n=e.time,r=e.ticks,c=r.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&c.length&&(this.min=this._userMin||c[0],this.max=this._userMax||c[c.length-1]);const u=this.min,p=this.max,o=m_e(c,u,p);return this._unit=n.unit||(r.autoSkip?cL(n.minUnit,this.min,this.max,this._getLabelCapacity(u)):lbe(this,o.length,n.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:cbe(this._unit),this.initOffsets(c),e.reverse&&o.reverse(),dL(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,r=0,c,u;this.options.offset&&e.length&&(c=this.getDecimalForValue(e[0]),e.length===1?n=1-c:n=(this.getDecimalForValue(e[1])-c)/2,u=this.getDecimalForValue(e[e.length-1]),e.length===1?r=u:r=(u-this.getDecimalForValue(e[e.length-2]))/2);const p=e.length<3?.5:.25;n=rd(n,0,p),r=rd(r,0,p),this._offsets={start:n,end:r,factor:1/(n+1+r)}}_generate(){const e=this._adapter,n=this.min,r=this.max,c=this.options,u=c.time,p=u.unit||cL(u.minUnit,n,r,this._getLabelCapacity(n)),o=Oo(c.ticks.stepSize,1),w=p==="week"?u.isoWeekday:!1,T=$w(w)||w===!0,A={};let D=n,B,N;if(T&&(D=+e.startOf(D,"isoWeek",w)),D=+e.startOf(D,T?"day":p),e.diff(r,n,p)>1e5*o)throw new Error(n+" and "+r+" are too far apart with stepSize of "+o+" "+p);const ee=c.ticks.source==="data"&&this.getDataTimestamps();for(B=D,N=0;B<r;B=+e.add(B,o,p),N++)uL(A,B,ee);return(B===r||c.bounds==="ticks"||N===1)&&uL(A,B,ee),Object.keys(A).sort(aL).map(Q=>+Q)}getLabelForValue(e){const n=this._adapter,r=this.options.time;return r.tooltipFormat?n.format(e,r.tooltipFormat):n.format(e,r.displayFormats.datetime)}format(e,n){const c=this.options.time.displayFormats,u=this._unit,p=n||c[u];return this._adapter.format(e,p)}_tickFormatFunction(e,n,r,c){const u=this.options,p=u.ticks.callback;if(p)return ws(p,[e,n,r],this);const o=u.time.displayFormats,w=this._unit,T=this._majorUnit,A=w&&o[w],D=T&&o[T],B=r[n],N=T&&D&&B&&B.major;return this._adapter.format(e,c||(N?D:A))}generateTickLabels(e){let n,r,c;for(n=0,r=e.length;n<r;++n)c=e[n],c.label=this._tickFormatFunction(c.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+r)*n.factor)}getValueForPixel(e){const n=this._offsets,r=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,r=this.ctx.measureText(e).width,c=ig(this.isHorizontal()?n.maxRotation:n.minRotation),u=Math.cos(c),p=Math.sin(c),o=this._resolveTickFontOptions(0).size;return{w:r*u+o*p,h:r*p+o*u}}_getLabelCapacity(e){const n=this.options.time,r=n.displayFormats,c=r[n.unit]||r.millisecond,u=this._tickFormatFunction(e,0,dL(this,[e],this._majorUnit),c),p=this._getLabelSize(u),o=Math.floor(this.isHorizontal()?this.width/p.w:this.height/p.h)-1;return o>0?o:1}getDataTimestamps(){let e=this._cache.data||[],n,r;if(e.length)return e;const c=this.getMatchingVisibleMetas();if(this._normalized&&c.length)return this._cache.data=c[0].controller.getAllParsedValues(this);for(n=0,r=c.length;n<r;++n)e=e.concat(c[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,r;if(e.length)return e;const c=this.getLabels();for(n=0,r=c.length;n<r;++n)e.push(lL(this,c[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return j6(e.sort(aL))}}bo(Gw,"id","time"),bo(Gw,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Px(t,e,n){let r=0,c=t.length-1,u,p,o,w;n?(e>=t[r].pos&&e<=t[c].pos&&({lo:r,hi:c}=vE(t,"pos",e)),{pos:u,time:o}=t[r],{pos:p,time:w}=t[c]):(e>=t[r].time&&e<=t[c].time&&({lo:r,hi:c}=vE(t,"time",e)),{time:u,pos:o}=t[r],{time:p,pos:w}=t[c]);const T=p-u;return T?o+(w-o)*(e-u)/T:o}class hL extends Gw{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=Px(n,this.min),this._tableRange=Px(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:r}=this,c=[],u=[];let p,o,w,T,A;for(p=0,o=e.length;p<o;++p)T=e[p],T>=n&&T<=r&&c.push(T);if(c.length<2)return[{time:n,pos:0},{time:r,pos:1}];for(p=0,o=c.length;p<o;++p)A=c[p+1],w=c[p-1],T=c[p],Math.round((A+w)/2)!==T&&u.push({time:T,pos:p/(o-1)});return u}_generate(){const e=this.min,n=this.max;let r=super.getDataTimestamps();return(!r.includes(e)||!r.length)&&r.splice(0,0,e),(!r.includes(n)||r.length===1)&&r.push(n),r.sort((c,u)=>c-u)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),r=this.getLabelTimestamps();return n.length&&r.length?e=this.normalize(n.concat(r)):e=n.length?n:r,e=this._cache.all=e,e}getDecimalForValue(e){return(Px(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,r=this.getDecimalForPixel(e)/n.factor-n.end;return Px(this._table,r*this._tableRange+this._minPos,!0)}}bo(hL,"id","timeseries"),bo(hL,"defaults",Gw.defaults);const dbe={class:"container py-4"},hbe={class:"row g-3"},fbe={class:"col-md-3"},pbe={class:"card p-3 shadow-sm"},mbe={class:"display-6"},gbe={class:"col-md-3"},_be={class:"card p-3 shadow-sm"},ybe={class:"display-6"},vbe={class:"col-md-3"},bbe={class:"card p-3 shadow-sm"},xbe={class:"display-6"},wbe={class:"col-md-3"},Sbe={class:"card p-3 shadow-sm"},Cbe={class:"display-6"},Tbe={class:"row g-3 mt-1"},Ebe={class:"col-lg-6"},Ibe={class:"card p-3 shadow-sm"},Abe={class:"col-lg-6"},kbe={class:"card p-3 shadow-sm"},Rbe={class:"card p-3 shadow-sm mt-3"},Pbe={class:"row g-2 align-items-end"},Mbe={class:"col-lg-8"},Dbe={class:"col-lg-4"},Obe={class:"mt-2"},Lbe={class:"d-flex gap-2 mt-2"},zbe=["disabled"],Bbe={key:0,class:"text-muted"},Fbe="https://sendbulkemail-6rwlj53o6q-ts.a.run.app",Nbe={__name:"AdminDashboard",setup(t){Yd.register(rw,tw,CE,TE,nbe,Wve,Zve);function e(qe,oe){try{return JSON.parse(localStorage.getItem(qe)||"null")??oe}catch{return oe}}function n(qe){return[...new Set(qe.filter(Boolean))]}const r=Si([]),c=Si([]),u=Si([]),p=Si([]),o=Si({users:0,programs:0,reviews:0}),w=Si(0),T=Si(null),A=Si(null);let D=null,B=null;const N=Si({toCsv:"user1@example.com, user2@example.com",subject:"Upcoming programs",html:"<p>Hi all — here are our upcoming sessions…</p>"}),ee=Si(!1);function Q(){o.value={users:r.value.length,programs:c.value.length,reviews:u.value.length},w.value=u.value.length?u.value.reduce((qe,oe)=>qe+(Number(oe.rating)||0),0)/u.value.length:0}function se(){const qe=r.value.reduce((Ee,$e)=>{const me=($e.role||"user").toLowerCase();return Ee[me]=(Ee[me]||0)+1,Ee},{}),oe=Object.keys(qe),de=Object.values(qe);D&&D.destroy(),D=new Yd(T.value.getContext("2d"),{type:"bar",data:{labels:oe,datasets:[{label:"Users",data:de}]},options:{responsive:!0,plugins:{legend:{display:!1}}}})}function ce(){const qe=c.value.map(Ee=>Ee.title),oe=c.value.map(Ee=>Number(Ee.seats||0)),de=c.value.map(Ee=>p.value.filter($e=>Number($e.programId)===Number(Ee.id)).length);B&&B.destroy(),B=new Yd(A.value.getContext("2d"),{type:"bar",data:{labels:qe,datasets:[{label:"Seats",data:oe},{label:"Booked",data:de}]},options:{responsive:!0}})}function be(){r.value=e("users",[]),c.value=e("programs",[]),u.value=e("reviews",[]),p.value=e("bookings",[]),Q(),se(),ce()}function ze(qe){["users","programs","reviews","bookings"].includes(qe.key)&&be()}lh(()=>{be(),window.addEventListener("storage",ze)}),vS(()=>{window.removeEventListener("storage",ze),D==null||D.destroy(),B==null||B.destroy()});function xe(){const qe=n(u.value.map(oe=>(oe.userEmail||"").trim()).filter(Boolean));qe.length?N.value.toCsv=qe.join(", "):alert("No reviewer emails found in local data.")}async function je(){const qe=n((N.value.toCsv||"").split(",").map(oe=>oe.trim()).filter(Boolean));if(!qe.length){alert("No recipients.");return}if(!N.value.subject.trim()){alert("Please add a subject.");return}if(!N.value.html.trim()){alert("Please add a message.");return}try{ee.value=!0;const oe=await fetch(Fbe,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:qe,subject:N.value.subject,html:N.value.html})});if(!oe.ok)throw new Error(`HTTP ${oe.status}`);alert("Bulk email requested successfully.")}catch(oe){console.warn("Bulk email failed:",oe),alert("Could not send bulk email. Check console/network and CORS on your function.")}finally{ee.value=!1}}return(qe,oe)=>(We(),wt("section",dbe,[oe[15]||(oe[15]=Pe("h1",{class:"mb-3"},"Admin Dashboard",-1)),Pe("div",{class:"d-flex gap-2 mb-2"},[Pe("button",{class:"btn btn-outline-secondary btn-sm",onClick:be},"Refresh"),oe[3]||(oe[3]=Pe("small",{class:"text-muted"},"Make sure all pages run on the same origin (same port) so data appears here.",-1))]),Pe("div",hbe,[Pe("div",fbe,[Pe("div",pbe,[oe[4]||(oe[4]=Pe("div",{class:"h6 text-muted"},"Users",-1)),Pe("div",mbe,wr(o.value.users),1)])]),Pe("div",gbe,[Pe("div",_be,[oe[5]||(oe[5]=Pe("div",{class:"h6 text-muted"},"Programs",-1)),Pe("div",ybe,wr(o.value.programs),1)])]),Pe("div",vbe,[Pe("div",bbe,[oe[6]||(oe[6]=Pe("div",{class:"h6 text-muted"},"Reviews",-1)),Pe("div",xbe,wr(o.value.reviews),1)])]),Pe("div",wbe,[Pe("div",Sbe,[oe[7]||(oe[7]=Pe("div",{class:"h6 text-muted"},"Avg Rating",-1)),Pe("div",Cbe,wr(w.value.toFixed(1)),1)])])]),Pe("div",Tbe,[Pe("div",Ebe,[Pe("div",Ibe,[oe[8]||(oe[8]=Pe("h5",{class:"mb-2"},"Users by Role",-1)),Pe("canvas",{ref_key:"roleCanvas",ref:T,"aria-label":"Users by role chart",role:"img"},null,512)])]),Pe("div",Abe,[Pe("div",kbe,[oe[9]||(oe[9]=Pe("h5",{class:"mb-2"},"Program Seats vs Bookings",-1)),Pe("canvas",{ref_key:"seatCanvas",ref:A,"aria-label":"Program seats vs bookings chart",role:"img"},null,512)])])]),Pe("div",Rbe,[oe[14]||(oe[14]=Pe("h5",{class:"mb-2"},"Bulk Email",-1)),Pe("div",Pbe,[Pe("div",Mbe,[oe[10]||(oe[10]=Pe("label",{class:"form-label"},"Recipients (comma-separated emails)",-1)),Ki(Pe("input",{"onUpdate:modelValue":oe[0]||(oe[0]=de=>N.value.toCsv=de),class:"form-control",placeholder:"user1@example.com, user2@example.com"},null,512),[[to,N.value.toCsv]]),oe[11]||(oe[11]=Pe("small",{class:"text-muted"},"Tip: click “Load reviewer emails” to prefill from recent reviews.",-1))]),Pe("div",Dbe,[oe[12]||(oe[12]=Pe("label",{class:"form-label"},"Subject",-1)),Ki(Pe("input",{"onUpdate:modelValue":oe[1]||(oe[1]=de=>N.value.subject=de),class:"form-control",placeholder:"Upcoming programs"},null,512),[[to,N.value.subject]])])]),Pe("div",Obe,[oe[13]||(oe[13]=Pe("label",{class:"form-label"},"Message (HTML allowed)",-1)),Ki(Pe("textarea",{"onUpdate:modelValue":oe[2]||(oe[2]=de=>N.value.html=de),class:"form-control",rows:"5",placeholder:"<p>Hi all — here are our upcoming sessions…</p>"},null,512),[[to,N.value.html]])]),Pe("div",Lbe,[Pe("button",{class:"btn btn-outline-secondary",onClick:xe},"Load reviewer emails"),Pe("button",{class:"btn btn-custom",disabled:ee.value,onClick:je},"Send Bulk Email",8,zbe),ee.value?(We(),wt("small",Bbe,"Sending…")):Zn("",!0)])])]))}};var US,Ui,bN,xN,cy,eg,fL,wN,SN,Ww={},CN=[],Vbe=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function Ip(t,e){for(var n in e)t[n]=e[n];return t}function TN(t){var e=t.parentNode;e&&e.removeChild(t)}function dt(t,e,n){var r,c,u,p={};for(u in e)u=="key"?r=e[u]:u=="ref"?c=e[u]:p[u]=e[u];if(arguments.length>2&&(p.children=arguments.length>3?US.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(u in t.defaultProps)p[u]===void 0&&(p[u]=t.defaultProps[u]);return ow(t,p,r,c,null)}function ow(t,e,n,r,c){var u={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:c??++bN};return c==null&&Ui.vnode!=null&&Ui.vnode(u),u}function Hl(){return{current:null}}function _s(t){return t.children}function $be(t,e,n,r,c){var u;for(u in n)u==="children"||u==="key"||u in e||qw(t,u,null,n[u],r);for(u in e)c&&typeof e[u]!="function"||u==="children"||u==="key"||u==="value"||u==="checked"||n[u]===e[u]||qw(t,u,e[u],n[u],r)}function pL(t,e,n){e[0]==="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||Vbe.test(e)?n:n+"px"}function qw(t,e,n,r,c){var u;e:if(e==="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof r=="string"&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||pL(t.style,e,"");if(n)for(e in n)r&&n[e]===r[e]||pL(t.style,e,n[e])}else if(e[0]==="o"&&e[1]==="n")u=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in t?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+u]=n,n?r||t.addEventListener(e,u?gL:mL,u):t.removeEventListener(e,u?gL:mL,u);else if(e!=="dangerouslySetInnerHTML"){if(c)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="width"&&e!=="height"&&e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e.indexOf("-")==-1?t.removeAttribute(e):t.setAttribute(e,n))}}function mL(t){cy=!0;try{return this.l[t.type+!1](Ui.event?Ui.event(t):t)}finally{cy=!1}}function gL(t){cy=!0;try{return this.l[t.type+!0](Ui.event?Ui.event(t):t)}finally{cy=!1}}function Bc(t,e){this.props=t,this.context=e}function b0(t,e){if(e==null)return t.__?b0(t.__,t.__.__k.indexOf(t)+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?b0(t):null}function EN(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return EN(t)}}function jbe(t){cy?setTimeout(t):wN(t)}function EE(t){(!t.__d&&(t.__d=!0)&&eg.push(t)&&!Zw.__r++||fL!==Ui.debounceRendering)&&((fL=Ui.debounceRendering)||jbe)(Zw)}function Zw(){var t,e,n,r,c,u,p,o;for(eg.sort(function(w,T){return w.__v.__b-T.__v.__b});t=eg.shift();)t.__d&&(e=eg.length,r=void 0,c=void 0,p=(u=(n=t).__v).__e,(o=n.__P)&&(r=[],(c=Ip({},u)).__v=u.__v+1,cA(o,u,c,n.__n,o.ownerSVGElement!==void 0,u.__h!=null?[p]:null,r,p??b0(u),u.__h),PN(r,u),u.__e!=p&&EN(u)),eg.length>e&&eg.sort(function(w,T){return w.__v.__b-T.__v.__b}));Zw.__r=0}function IN(t,e,n,r,c,u,p,o,w,T){var A,D,B,N,ee,Q,se,ce=r&&r.__k||CN,be=ce.length;for(n.__k=[],A=0;A<e.length;A++)if((N=n.__k[A]=(N=e[A])==null||typeof N=="boolean"?null:typeof N=="string"||typeof N=="number"||typeof N=="bigint"?ow(null,N,null,null,N):Array.isArray(N)?ow(_s,{children:N},null,null,null):N.__b>0?ow(N.type,N.props,N.key,N.ref?N.ref:null,N.__v):N)!=null){if(N.__=n,N.__b=n.__b+1,(B=ce[A])===null||B&&N.key==B.key&&N.type===B.type)ce[A]=void 0;else for(D=0;D<be;D++){if((B=ce[D])&&N.key==B.key&&N.type===B.type){ce[D]=void 0;break}B=null}cA(t,N,B=B||Ww,c,u,p,o,w,T),ee=N.__e,(D=N.ref)&&B.ref!=D&&(se||(se=[]),B.ref&&se.push(B.ref,null,N),se.push(D,N.__c||ee,N)),ee!=null?(Q==null&&(Q=ee),typeof N.type=="function"&&N.__k===B.__k?N.__d=w=AN(N,w,t):w=kN(t,N,B,ce,ee,w),typeof n.type=="function"&&(n.__d=w)):w&&B.__e==w&&w.parentNode!=t&&(w=b0(B))}for(n.__e=Q,A=be;A--;)ce[A]!=null&&(typeof n.type=="function"&&ce[A].__e!=null&&ce[A].__e==n.__d&&(n.__d=RN(r).nextSibling),DN(ce[A],ce[A]));if(se)for(A=0;A<se.length;A++)MN(se[A],se[++A],se[++A])}function AN(t,e,n){for(var r,c=t.__k,u=0;c&&u<c.length;u++)(r=c[u])&&(r.__=t,e=typeof r.type=="function"?AN(r,e,n):kN(n,r,r,c,r.__e,e));return e}function Kw(t,e){return e=e||[],t==null||typeof t=="boolean"||(Array.isArray(t)?t.some(function(n){Kw(n,e)}):e.push(t)),e}function kN(t,e,n,r,c,u){var p,o,w;if(e.__d!==void 0)p=e.__d,e.__d=void 0;else if(n==null||c!=u||c.parentNode==null)e:if(u==null||u.parentNode!==t)t.appendChild(c),p=null;else{for(o=u,w=0;(o=o.nextSibling)&&w<r.length;w+=1)if(o==c)break e;t.insertBefore(c,u),p=u}return p!==void 0?p:c.nextSibling}function RN(t){var e,n,r;if(t.type==null||typeof t.type=="string")return t.__e;if(t.__k){for(e=t.__k.length-1;e>=0;e--)if((n=t.__k[e])&&(r=RN(n)))return r}return null}function cA(t,e,n,r,c,u,p,o,w){var T,A,D,B,N,ee,Q,se,ce,be,ze,xe,je,qe,oe,de=e.type;if(e.constructor!==void 0)return null;n.__h!=null&&(w=n.__h,o=e.__e=n.__e,e.__h=null,u=[o]),(T=Ui.__b)&&T(e);try{e:if(typeof de=="function"){if(se=e.props,ce=(T=de.contextType)&&r[T.__c],be=T?ce?ce.props.value:T.__:r,n.__c?Q=(A=e.__c=n.__c).__=A.__E:("prototype"in de&&de.prototype.render?e.__c=A=new de(se,be):(e.__c=A=new Bc(se,be),A.constructor=de,A.render=Hbe),ce&&ce.sub(A),A.props=se,A.state||(A.state={}),A.context=be,A.__n=r,D=A.__d=!0,A.__h=[],A._sb=[]),A.__s==null&&(A.__s=A.state),de.getDerivedStateFromProps!=null&&(A.__s==A.state&&(A.__s=Ip({},A.__s)),Ip(A.__s,de.getDerivedStateFromProps(se,A.__s))),B=A.props,N=A.state,A.__v=e,D)de.getDerivedStateFromProps==null&&A.componentWillMount!=null&&A.componentWillMount(),A.componentDidMount!=null&&A.__h.push(A.componentDidMount);else{if(de.getDerivedStateFromProps==null&&se!==B&&A.componentWillReceiveProps!=null&&A.componentWillReceiveProps(se,be),!A.__e&&A.shouldComponentUpdate!=null&&A.shouldComponentUpdate(se,A.__s,be)===!1||e.__v===n.__v){for(e.__v!==n.__v&&(A.props=se,A.state=A.__s,A.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.forEach(function(Ee){Ee&&(Ee.__=e)}),ze=0;ze<A._sb.length;ze++)A.__h.push(A._sb[ze]);A._sb=[],A.__h.length&&p.push(A);break e}A.componentWillUpdate!=null&&A.componentWillUpdate(se,A.__s,be),A.componentDidUpdate!=null&&A.__h.push(function(){A.componentDidUpdate(B,N,ee)})}if(A.context=be,A.props=se,A.__P=t,xe=Ui.__r,je=0,"prototype"in de&&de.prototype.render){for(A.state=A.__s,A.__d=!1,xe&&xe(e),T=A.render(A.props,A.state,A.context),qe=0;qe<A._sb.length;qe++)A.__h.push(A._sb[qe]);A._sb=[]}else do A.__d=!1,xe&&xe(e),T=A.render(A.props,A.state,A.context),A.state=A.__s;while(A.__d&&++je<25);A.state=A.__s,A.getChildContext!=null&&(r=Ip(Ip({},r),A.getChildContext())),D||A.getSnapshotBeforeUpdate==null||(ee=A.getSnapshotBeforeUpdate(B,N)),oe=T!=null&&T.type===_s&&T.key==null?T.props.children:T,IN(t,Array.isArray(oe)?oe:[oe],e,n,r,c,u,p,o,w),A.base=e.__e,e.__h=null,A.__h.length&&p.push(A),Q&&(A.__E=A.__=null),A.__e=!1}else u==null&&e.__v===n.__v?(e.__k=n.__k,e.__e=n.__e):e.__e=Ube(n.__e,e,n,r,c,u,p,w);(T=Ui.diffed)&&T(e)}catch(Ee){e.__v=null,(w||u!=null)&&(e.__e=o,e.__h=!!w,u[u.indexOf(o)]=null),Ui.__e(Ee,e,n)}}function PN(t,e){Ui.__c&&Ui.__c(e,t),t.some(function(n){try{t=n.__h,n.__h=[],t.some(function(r){r.call(n)})}catch(r){Ui.__e(r,n.__v)}})}function Ube(t,e,n,r,c,u,p,o){var w,T,A,D=n.props,B=e.props,N=e.type,ee=0;if(N==="svg"&&(c=!0),u!=null){for(;ee<u.length;ee++)if((w=u[ee])&&"setAttribute"in w==!!N&&(N?w.localName===N:w.nodeType===3)){t=w,u[ee]=null;break}}if(t==null){if(N===null)return document.createTextNode(B);t=c?document.createElementNS("http://www.w3.org/2000/svg",N):document.createElement(N,B.is&&B),u=null,o=!1}if(N===null)D===B||o&&t.data===B||(t.data=B);else{if(u=u&&US.call(t.childNodes),T=(D=n.props||Ww).dangerouslySetInnerHTML,A=B.dangerouslySetInnerHTML,!o){if(u!=null)for(D={},ee=0;ee<t.attributes.length;ee++)D[t.attributes[ee].name]=t.attributes[ee].value;(A||T)&&(A&&(T&&A.__html==T.__html||A.__html===t.innerHTML)||(t.innerHTML=A&&A.__html||""))}if($be(t,B,D,c,o),A)e.__k=[];else if(ee=e.props.children,IN(t,Array.isArray(ee)?ee:[ee],e,n,r,c&&N!=="foreignObject",u,p,u?u[0]:n.__k&&b0(n,0),o),u!=null)for(ee=u.length;ee--;)u[ee]!=null&&TN(u[ee]);o||("value"in B&&(ee=B.value)!==void 0&&(ee!==t.value||N==="progress"&&!ee||N==="option"&&ee!==D.value)&&qw(t,"value",ee,D.value,!1),"checked"in B&&(ee=B.checked)!==void 0&&ee!==t.checked&&qw(t,"checked",ee,D.checked,!1))}return t}function MN(t,e,n){try{typeof t=="function"?t(e):t.current=e}catch(r){Ui.__e(r,n)}}function DN(t,e,n){var r,c;if(Ui.unmount&&Ui.unmount(t),(r=t.ref)&&(r.current&&r.current!==t.__e||MN(r,null,e)),(r=t.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(u){Ui.__e(u,e)}r.base=r.__P=null,t.__c=void 0}if(r=t.__k)for(c=0;c<r.length;c++)r[c]&&DN(r[c],e,n||typeof t.type!="function");n||t.__e==null||TN(t.__e),t.__=t.__e=t.__d=void 0}function Hbe(t,e,n){return this.constructor(t,n)}function x0(t,e,n){var r,c,u;Ui.__&&Ui.__(t,e),c=(r=!1)?null:e.__k,u=[],cA(e,t=e.__k=dt(_s,null,[t]),c||Ww,Ww,e.ownerSVGElement!==void 0,c?null:e.firstChild?US.call(e.childNodes):null,u,c?c.__e:e.firstChild,r),PN(u,t)}function Gbe(t,e){var n={__c:e="__cC"+SN++,__:t,Consumer:function(r,c){return r.children(c)},Provider:function(r){var c,u;return this.getChildContext||(c=[],(u={})[e]=this,this.getChildContext=function(){return u},this.shouldComponentUpdate=function(p){this.props.value!==p.value&&c.some(function(o){o.__e=!0,EE(o)})},this.sub=function(p){c.push(p);var o=p.componentWillUnmount;p.componentWillUnmount=function(){c.splice(c.indexOf(p),1),o&&o.call(p)}}),r.children}};return n.Provider.__=n.Consumer.contextType=n}US=CN.slice,Ui={__e:function(t,e,n,r){for(var c,u,p;e=e.__;)if((c=e.__c)&&!c.__)try{if((u=c.constructor)&&u.getDerivedStateFromError!=null&&(c.setState(u.getDerivedStateFromError(t)),p=c.__d),c.componentDidCatch!=null&&(c.componentDidCatch(t,r||{}),p=c.__d),p)return c.__E=c}catch(o){t=o}throw t}},bN=0,xN=function(t){return t!=null&&t.constructor===void 0},cy=!1,Bc.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Ip({},this.state),typeof t=="function"&&(t=t(Ip({},n),this.props)),t&&Ip(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),EE(this))},Bc.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),EE(this))},Bc.prototype.render=_s,eg=[],wN=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Zw.__r=0,SN=0;var Jd,hT,_L,ON=[],fT=[],yL=Ui.__b,vL=Ui.__r,bL=Ui.diffed,xL=Ui.__c,wL=Ui.unmount;function Wbe(){for(var t;t=ON.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(sw),t.__H.__h.forEach(IE),t.__H.__h=[]}catch(e){t.__H.__h=[],Ui.__e(e,t.__v)}}Ui.__b=function(t){Jd=null,yL&&yL(t)},Ui.__r=function(t){vL&&vL(t);var e=(Jd=t.__c).__H;e&&(hT===Jd?(e.__h=[],Jd.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=fT,n.__N=n.i=void 0})):(e.__h.forEach(sw),e.__h.forEach(IE),e.__h=[])),hT=Jd},Ui.diffed=function(t){bL&&bL(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(ON.push(e)!==1&&_L===Ui.requestAnimationFrame||((_L=Ui.requestAnimationFrame)||qbe)(Wbe)),e.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==fT&&(n.__=n.__V),n.i=void 0,n.__V=fT})),hT=Jd=null},Ui.__c=function(t,e){e.some(function(n){try{n.__h.forEach(sw),n.__h=n.__h.filter(function(r){return!r.__||IE(r)})}catch(r){e.some(function(c){c.__h&&(c.__h=[])}),e=[],Ui.__e(r,n.__v)}}),xL&&xL(t,e)},Ui.unmount=function(t){wL&&wL(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{sw(r)}catch(c){e=c}}),n.__H=void 0,e&&Ui.__e(e,n.__v))};var SL=typeof requestAnimationFrame=="function";function qbe(t){var e,n=function(){clearTimeout(r),SL&&cancelAnimationFrame(e),setTimeout(t)},r=setTimeout(n,100);SL&&(e=requestAnimationFrame(n))}function sw(t){var e=Jd,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),Jd=e}function IE(t){var e=Jd;t.__c=t.__(),Jd=e}function Zbe(t,e){for(var n in e)t[n]=e[n];return t}function CL(t,e){for(var n in t)if(n!=="__source"&&!(n in e))return!0;for(var r in e)if(r!=="__source"&&t[r]!==e[r])return!0;return!1}function TL(t){this.props=t}(TL.prototype=new Bc).isPureReactComponent=!0,TL.prototype.shouldComponentUpdate=function(t,e){return CL(this.props,t)||CL(this.state,e)};var EL=Ui.__b;Ui.__b=function(t){t.type&&t.type.__f&&t.ref&&(t.props.ref=t.ref,t.ref=null),EL&&EL(t)};var Kbe=Ui.__e;Ui.__e=function(t,e,n,r){if(t.then){for(var c,u=e;u=u.__;)if((c=u.__c)&&c.__c)return e.__e==null&&(e.__e=n.__e,e.__k=n.__k),c.__c(t,e)}Kbe(t,e,n,r)};var IL=Ui.unmount;function LN(t,e,n){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach(function(r){typeof r.__c=="function"&&r.__c()}),t.__c.__H=null),(t=Zbe({},t)).__c!=null&&(t.__c.__P===n&&(t.__c.__P=e),t.__c=null),t.__k=t.__k&&t.__k.map(function(r){return LN(r,e,n)})),t}function zN(t,e,n){return t&&(t.__v=null,t.__k=t.__k&&t.__k.map(function(r){return zN(r,e,n)}),t.__c&&t.__c.__P===e&&(t.__e&&n.insertBefore(t.__e,t.__d),t.__c.__e=!0,t.__c.__P=n)),t}function pT(){this.__u=0,this.t=null,this.__b=null}function BN(t){var e=t.__.__c;return e&&e.__a&&e.__a(t)}function Mx(){this.u=null,this.o=null}Ui.unmount=function(t){var e=t.__c;e&&e.__R&&e.__R(),e&&t.__h===!0&&(t.type=null),IL&&IL(t)},(pT.prototype=new Bc).__c=function(t,e){var n=e.__c,r=this;r.t==null&&(r.t=[]),r.t.push(n);var c=BN(r.__v),u=!1,p=function(){u||(u=!0,n.__R=null,c?c(o):o())};n.__R=p;var o=function(){if(!--r.__u){if(r.state.__a){var T=r.state.__a;r.__v.__k[0]=zN(T,T.__c.__P,T.__c.__O)}var A;for(r.setState({__a:r.__b=null});A=r.t.pop();)A.forceUpdate()}},w=e.__h===!0;r.__u++||w||r.setState({__a:r.__b=r.__v.__k[0]}),t.then(p,p)},pT.prototype.componentWillUnmount=function(){this.t=[]},pT.prototype.render=function(t,e){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=LN(this.__b,n,r.__O=r.__P)}this.__b=null}var c=e.__a&&dt(_s,null,t.fallback);return c&&(c.__h=null),[dt(_s,null,e.__a?null:t.children),c]};var AL=function(t,e,n){if(++n[1]===n[0]&&t.o.delete(e),t.props.revealOrder&&(t.props.revealOrder[0]!=="t"||!t.o.size))for(n=t.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;t.u=n=n[2]}};function Xbe(t){return this.getChildContext=function(){return t.context},t.children}function Ybe(t){var e=this,n=t.i;e.componentWillUnmount=function(){x0(null,e.l),e.l=null,e.i=null},e.i&&e.i!==n&&e.componentWillUnmount(),t.__v?(e.l||(e.i=n,e.l={nodeType:1,parentNode:n,childNodes:[],appendChild:function(r){this.childNodes.push(r),e.i.appendChild(r)},insertBefore:function(r,c){this.childNodes.push(r),e.i.appendChild(r)},removeChild:function(r){this.childNodes.splice(this.childNodes.indexOf(r)>>>1,1),e.i.removeChild(r)}}),x0(dt(Xbe,{context:e.context},t.__v),e.l)):e.l&&e.componentWillUnmount()}function Jbe(t,e){var n=dt(Ybe,{__v:t,i:e});return n.containerInfo=e,n}(Mx.prototype=new Bc).__a=function(t){var e=this,n=BN(e.__v),r=e.o.get(t);return r[0]++,function(c){var u=function(){e.props.revealOrder?(r.push(c),AL(e,t,r)):c()};n?n(u):u()}},Mx.prototype.render=function(t){this.u=null,this.o=new Map;var e=Kw(t.children);t.revealOrder&&t.revealOrder[0]==="b"&&e.reverse();for(var n=e.length;n--;)this.o.set(e[n],this.u=[1,0,this.u]);return t.children},Mx.prototype.componentDidUpdate=Mx.prototype.componentDidMount=function(){var t=this;this.o.forEach(function(e,n){AL(t,n,e)})};var Qbe=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,e0e=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,t0e=typeof document<"u",n0e=function(t){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(t)};Bc.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(t){Object.defineProperty(Bc.prototype,t,{configurable:!0,get:function(){return this["UNSAFE_"+t]},set:function(e){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:e})}})});var kL=Ui.event;function i0e(){}function r0e(){return this.cancelBubble}function o0e(){return this.defaultPrevented}Ui.event=function(t){return kL&&(t=kL(t)),t.persist=i0e,t.isPropagationStopped=r0e,t.isDefaultPrevented=o0e,t.nativeEvent=t};var RL={configurable:!0,get:function(){return this.class}},PL=Ui.vnode;Ui.vnode=function(t){var e=t.type,n=t.props,r=n;if(typeof e=="string"){var c=e.indexOf("-")===-1;for(var u in r={},n){var p=n[u];t0e&&u==="children"&&e==="noscript"||u==="value"&&"defaultValue"in n&&p==null||(u==="defaultValue"&&"value"in n&&n.value==null?u="value":u==="download"&&p===!0?p="":/ondoubleclick/i.test(u)?u="ondblclick":/^onchange(textarea|input)/i.test(u+e)&&!n0e(n.type)?u="oninput":/^onfocus$/i.test(u)?u="onfocusin":/^onblur$/i.test(u)?u="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(u)?u=u.toLowerCase():c&&e0e.test(u)?u=u.replace(/[A-Z0-9]/g,"-$&").toLowerCase():p===null&&(p=void 0),/^oninput$/i.test(u)&&(u=u.toLowerCase(),r[u]&&(u="oninputCapture")),r[u]=p)}e=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=Kw(n.children).forEach(function(o){o.props.selected=r.value.indexOf(o.props.value)!=-1})),e=="select"&&r.defaultValue!=null&&(r.value=Kw(n.children).forEach(function(o){o.props.selected=r.multiple?r.defaultValue.indexOf(o.props.value)!=-1:r.defaultValue==o.props.value})),t.props=r,n.class!=n.className&&(RL.enumerable="className"in n,n.className!=null&&(r.class=n.className),Object.defineProperty(r,"className",RL))}t.$$typeof=Qbe,PL&&PL(t)};var ML=Ui.__r;Ui.__r=function(t){ML&&ML(t),t.__c};const FN=[],AE=new Map;function uA(t){FN.push(t),AE.forEach(e=>{VN(e,t)})}function s0e(t){t.isConnected&&t.getRootNode&&NN(t.getRootNode())}function NN(t){let e=AE.get(t);if(!e||!e.isConnected){if(e=t.querySelector("style[data-fullcalendar]"),!e){e=document.createElement("style"),e.setAttribute("data-fullcalendar","");const n=l0e();n&&(e.nonce=n);const r=t===document?document.head:t,c=t===document?r.querySelector("script,link[rel=stylesheet],link[as=style],style"):r.firstChild;r.insertBefore(e,c)}AE.set(t,e),a0e(e)}}function a0e(t){for(const e of FN)VN(t,e)}function VN(t,e){const{sheet:n}=t,r=n.cssRules.length;e.split("}").forEach((c,u)=>{c=c.trim(),c&&n.insertRule(c+"}",r+u)})}let mT;function l0e(){return mT===void 0&&(mT=c0e()),mT}function c0e(){const t=document.querySelector('meta[name="csp-nonce"]');if(t&&t.hasAttribute("content"))return t.getAttribute("content");const e=document.querySelector("script[nonce]");return e&&e.nonce||""}typeof document<"u"&&NN(document);var u0e=':root{--fc-small-font-size:.85em;--fc-page-bg-color:#fff;--fc-neutral-bg-color:hsla(0,0%,82%,.3);--fc-neutral-text-color:grey;--fc-border-color:#ddd;--fc-button-text-color:#fff;--fc-button-bg-color:#2c3e50;--fc-button-border-color:#2c3e50;--fc-button-hover-bg-color:#1e2b37;--fc-button-hover-border-color:#1a252f;--fc-button-active-bg-color:#1a252f;--fc-button-active-border-color:#151e27;--fc-event-bg-color:#3788d8;--fc-event-border-color:#3788d8;--fc-event-text-color:#fff;--fc-event-selected-overlay-color:rgba(0,0,0,.25);--fc-more-link-bg-color:#d0d0d0;--fc-more-link-text-color:inherit;--fc-event-resizer-thickness:8px;--fc-event-resizer-dot-total-width:8px;--fc-event-resizer-dot-border-width:1px;--fc-non-business-color:hsla(0,0%,84%,.3);--fc-bg-event-color:#8fdf82;--fc-bg-event-opacity:0.3;--fc-highlight-color:rgba(188,232,241,.3);--fc-today-bg-color:rgba(255,220,40,.15);--fc-now-indicator-color:red}.fc-not-allowed,.fc-not-allowed .fc-event{cursor:not-allowed}.fc{display:flex;flex-direction:column;font-size:1em}.fc,.fc *,.fc :after,.fc :before{box-sizing:border-box}.fc table{border-collapse:collapse;border-spacing:0;font-size:1em}.fc th{text-align:center}.fc td,.fc th{padding:0;vertical-align:top}.fc a[data-navlink]{cursor:pointer}.fc a[data-navlink]:hover{text-decoration:underline}.fc-direction-ltr{direction:ltr;text-align:left}.fc-direction-rtl{direction:rtl;text-align:right}.fc-theme-standard td,.fc-theme-standard th{border:1px solid var(--fc-border-color)}.fc-liquid-hack td,.fc-liquid-hack th{position:relative}@font-face{font-family:fcicons;font-style:normal;font-weight:400;src:url("data:application/x-font-ttf;charset=utf-8;base64,AAEAAAALAIAAAwAwT1MvMg8SBfAAAAC8AAAAYGNtYXAXVtKNAAABHAAAAFRnYXNwAAAAEAAAAXAAAAAIZ2x5ZgYydxIAAAF4AAAFNGhlYWQUJ7cIAAAGrAAAADZoaGVhB20DzAAABuQAAAAkaG10eCIABhQAAAcIAAAALGxvY2ED4AU6AAAHNAAAABhtYXhwAA8AjAAAB0wAAAAgbmFtZXsr690AAAdsAAABhnBvc3QAAwAAAAAI9AAAACAAAwPAAZAABQAAApkCzAAAAI8CmQLMAAAB6wAzAQkAAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAABAAADpBgPA/8AAQAPAAEAAAAABAAAAAAAAAAAAAAAgAAAAAAADAAAAAwAAABwAAQADAAAAHAADAAEAAAAcAAQAOAAAAAoACAACAAIAAQAg6Qb//f//AAAAAAAg6QD//f//AAH/4xcEAAMAAQAAAAAAAAAAAAAAAQAB//8ADwABAAAAAAAAAAAAAgAANzkBAAAAAAEAAAAAAAAAAAACAAA3OQEAAAAAAQAAAAAAAAAAAAIAADc5AQAAAAABAWIAjQKeAskAEwAAJSc3NjQnJiIHAQYUFwEWMjc2NCcCnuLiDQ0MJAz/AA0NAQAMJAwNDcni4gwjDQwM/wANIwz/AA0NDCMNAAAAAQFiAI0CngLJABMAACUBNjQnASYiBwYUHwEHBhQXFjI3AZ4BAA0N/wAMJAwNDeLiDQ0MJAyNAQAMIw0BAAwMDSMM4uINIwwNDQAAAAIA4gC3Ax4CngATACcAACUnNzY0JyYiDwEGFB8BFjI3NjQnISc3NjQnJiIPAQYUHwEWMjc2NCcB87e3DQ0MIw3VDQ3VDSMMDQ0BK7e3DQ0MJAzVDQ3VDCQMDQ3zuLcMJAwNDdUNIwzWDAwNIwy4twwkDA0N1Q0jDNYMDA0jDAAAAgDiALcDHgKeABMAJwAAJTc2NC8BJiIHBhQfAQcGFBcWMjchNzY0LwEmIgcGFB8BBwYUFxYyNwJJ1Q0N1Q0jDA0Nt7cNDQwjDf7V1Q0N1QwkDA0Nt7cNDQwkDLfWDCMN1Q0NDCQMt7gMIw0MDNYMIw3VDQ0MJAy3uAwjDQwMAAADAFUAAAOrA1UAMwBoAHcAABMiBgcOAQcOAQcOARURFBYXHgEXHgEXHgEzITI2Nz4BNz4BNz4BNRE0JicuAScuAScuASMFITIWFx4BFx4BFx4BFREUBgcOAQcOAQcOASMhIiYnLgEnLgEnLgE1ETQ2Nz4BNz4BNz4BMxMhMjY1NCYjISIGFRQWM9UNGAwLFQkJDgUFBQUFBQ4JCRULDBgNAlYNGAwLFQkJDgUFBQUFBQ4JCRULDBgN/aoCVgQIBAQHAwMFAQIBAQIBBQMDBwQECAT9qgQIBAQHAwMFAQIBAQIBBQMDBwQECASAAVYRGRkR/qoRGRkRA1UFBAUOCQkVDAsZDf2rDRkLDBUJCA4FBQUFBQUOCQgVDAsZDQJVDRkLDBUJCQ4FBAVVAgECBQMCBwQECAX9qwQJAwQHAwMFAQICAgIBBQMDBwQDCQQCVQUIBAQHAgMFAgEC/oAZEhEZGRESGQAAAAADAFUAAAOrA1UAMwBoAIkAABMiBgcOAQcOAQcOARURFBYXHgEXHgEXHgEzITI2Nz4BNz4BNz4BNRE0JicuAScuAScuASMFITIWFx4BFx4BFx4BFREUBgcOAQcOAQcOASMhIiYnLgEnLgEnLgE1ETQ2Nz4BNz4BNz4BMxMzFRQWMzI2PQEzMjY1NCYrATU0JiMiBh0BIyIGFRQWM9UNGAwLFQkJDgUFBQUFBQ4JCRULDBgNAlYNGAwLFQkJDgUFBQUFBQ4JCRULDBgN/aoCVgQIBAQHAwMFAQIBAQIBBQMDBwQECAT9qgQIBAQHAwMFAQIBAQIBBQMDBwQECASAgBkSEhmAERkZEYAZEhIZgBEZGREDVQUEBQ4JCRUMCxkN/asNGQsMFQkIDgUFBQUFBQ4JCBUMCxkNAlUNGQsMFQkJDgUEBVUCAQIFAwIHBAQIBf2rBAkDBAcDAwUBAgICAgEFAwMHBAMJBAJVBQgEBAcCAwUCAQL+gIASGRkSgBkSERmAEhkZEoAZERIZAAABAOIAjQMeAskAIAAAExcHBhQXFjI/ARcWMjc2NC8BNzY0JyYiDwEnJiIHBhQX4uLiDQ0MJAzi4gwkDA0N4uINDQwkDOLiDCQMDQ0CjeLiDSMMDQ3h4Q0NDCMN4uIMIw0MDOLiDAwNIwwAAAABAAAAAQAAa5n0y18PPPUACwQAAAAAANivOVsAAAAA2K85WwAAAAADqwNVAAAACAACAAAAAAAAAAEAAAPA/8AAAAQAAAAAAAOrAAEAAAAAAAAAAAAAAAAAAAALBAAAAAAAAAAAAAAAAgAAAAQAAWIEAAFiBAAA4gQAAOIEAABVBAAAVQQAAOIAAAAAAAoAFAAeAEQAagCqAOoBngJkApoAAQAAAAsAigADAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAA4ArgABAAAAAAABAAcAAAABAAAAAAACAAcAYAABAAAAAAADAAcANgABAAAAAAAEAAcAdQABAAAAAAAFAAsAFQABAAAAAAAGAAcASwABAAAAAAAKABoAigADAAEECQABAA4ABwADAAEECQACAA4AZwADAAEECQADAA4APQADAAEECQAEAA4AfAADAAEECQAFABYAIAADAAEECQAGAA4AUgADAAEECQAKADQApGZjaWNvbnMAZgBjAGkAYwBvAG4Ac1ZlcnNpb24gMS4wAFYAZQByAHMAaQBvAG4AIAAxAC4AMGZjaWNvbnMAZgBjAGkAYwBvAG4Ac2ZjaWNvbnMAZgBjAGkAYwBvAG4Ac1JlZ3VsYXIAUgBlAGcAdQBsAGEAcmZjaWNvbnMAZgBjAGkAYwBvAG4Ac0ZvbnQgZ2VuZXJhdGVkIGJ5IEljb01vb24uAEYAbwBuAHQAIABnAGUAbgBlAHIAYQB0AGUAZAAgAGIAeQAgAEkAYwBvAE0AbwBvAG4ALgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=") format("truetype")}.fc-icon{speak:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;display:inline-block;font-family:fcicons!important;font-style:normal;font-variant:normal;font-weight:400;height:1em;line-height:1;text-align:center;text-transform:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:1em}.fc-icon-chevron-left:before{content:"\\e900"}.fc-icon-chevron-right:before{content:"\\e901"}.fc-icon-chevrons-left:before{content:"\\e902"}.fc-icon-chevrons-right:before{content:"\\e903"}.fc-icon-minus-square:before{content:"\\e904"}.fc-icon-plus-square:before{content:"\\e905"}.fc-icon-x:before{content:"\\e906"}.fc .fc-button{border-radius:0;font-family:inherit;font-size:inherit;line-height:inherit;margin:0;overflow:visible;text-transform:none}.fc .fc-button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}.fc .fc-button{-webkit-appearance:button}.fc .fc-button:not(:disabled){cursor:pointer}.fc .fc-button{background-color:transparent;border:1px solid transparent;border-radius:.25em;display:inline-block;font-size:1em;font-weight:400;line-height:1.5;padding:.4em .65em;text-align:center;-webkit-user-select:none;-moz-user-select:none;user-select:none;vertical-align:middle}.fc .fc-button:hover{text-decoration:none}.fc .fc-button:focus{box-shadow:0 0 0 .2rem rgba(44,62,80,.25);outline:0}.fc .fc-button:disabled{opacity:.65}.fc .fc-button-primary{background-color:var(--fc-button-bg-color);border-color:var(--fc-button-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:hover{background-color:var(--fc-button-hover-bg-color);border-color:var(--fc-button-hover-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:disabled{background-color:var(--fc-button-bg-color);border-color:var(--fc-button-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:focus{box-shadow:0 0 0 .2rem rgba(76,91,106,.5)}.fc .fc-button-primary:not(:disabled).fc-button-active,.fc .fc-button-primary:not(:disabled):active{background-color:var(--fc-button-active-bg-color);border-color:var(--fc-button-active-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:not(:disabled).fc-button-active:focus,.fc .fc-button-primary:not(:disabled):active:focus{box-shadow:0 0 0 .2rem rgba(76,91,106,.5)}.fc .fc-button .fc-icon{font-size:1.5em;vertical-align:middle}.fc .fc-button-group{display:inline-flex;position:relative;vertical-align:middle}.fc .fc-button-group>.fc-button{flex:1 1 auto;position:relative}.fc .fc-button-group>.fc-button.fc-button-active,.fc .fc-button-group>.fc-button:active,.fc .fc-button-group>.fc-button:focus,.fc .fc-button-group>.fc-button:hover{z-index:1}.fc-direction-ltr .fc-button-group>.fc-button:not(:first-child){border-bottom-left-radius:0;border-top-left-radius:0;margin-left:-1px}.fc-direction-ltr .fc-button-group>.fc-button:not(:last-child){border-bottom-right-radius:0;border-top-right-radius:0}.fc-direction-rtl .fc-button-group>.fc-button:not(:first-child){border-bottom-right-radius:0;border-top-right-radius:0;margin-right:-1px}.fc-direction-rtl .fc-button-group>.fc-button:not(:last-child){border-bottom-left-radius:0;border-top-left-radius:0}.fc .fc-toolbar{align-items:center;display:flex;justify-content:space-between}.fc .fc-toolbar.fc-header-toolbar{margin-bottom:1.5em}.fc .fc-toolbar.fc-footer-toolbar{margin-top:1.5em}.fc .fc-toolbar-title{font-size:1.75em;margin:0}.fc-direction-ltr .fc-toolbar>*>:not(:first-child){margin-left:.75em}.fc-direction-rtl .fc-toolbar>*>:not(:first-child){margin-right:.75em}.fc-direction-rtl .fc-toolbar-ltr{flex-direction:row-reverse}.fc .fc-scroller{-webkit-overflow-scrolling:touch;position:relative}.fc .fc-scroller-liquid{height:100%}.fc .fc-scroller-liquid-absolute{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-scroller-harness{direction:ltr;overflow:hidden;position:relative}.fc .fc-scroller-harness-liquid{height:100%}.fc-direction-rtl .fc-scroller-harness>.fc-scroller{direction:rtl}.fc-theme-standard .fc-scrollgrid{border:1px solid var(--fc-border-color)}.fc .fc-scrollgrid,.fc .fc-scrollgrid table{table-layout:fixed;width:100%}.fc .fc-scrollgrid table{border-left-style:hidden;border-right-style:hidden;border-top-style:hidden}.fc .fc-scrollgrid{border-bottom-width:0;border-collapse:separate;border-right-width:0}.fc .fc-scrollgrid-liquid{height:100%}.fc .fc-scrollgrid-section,.fc .fc-scrollgrid-section table,.fc .fc-scrollgrid-section>td{height:1px}.fc .fc-scrollgrid-section-liquid>td{height:100%}.fc .fc-scrollgrid-section>*{border-left-width:0;border-top-width:0}.fc .fc-scrollgrid-section-footer>*,.fc .fc-scrollgrid-section-header>*{border-bottom-width:0}.fc .fc-scrollgrid-section-body table,.fc .fc-scrollgrid-section-footer table{border-bottom-style:hidden}.fc .fc-scrollgrid-section-sticky>*{background:var(--fc-page-bg-color);position:sticky;z-index:3}.fc .fc-scrollgrid-section-header.fc-scrollgrid-section-sticky>*{top:0}.fc .fc-scrollgrid-section-footer.fc-scrollgrid-section-sticky>*{bottom:0}.fc .fc-scrollgrid-sticky-shim{height:1px;margin-bottom:-1px}.fc-sticky{position:sticky}.fc .fc-view-harness{flex-grow:1;position:relative}.fc .fc-view-harness-active>.fc-view{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-col-header-cell-cushion{display:inline-block;padding:2px 4px}.fc .fc-bg-event,.fc .fc-highlight,.fc .fc-non-business{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-non-business{background:var(--fc-non-business-color)}.fc .fc-bg-event{background:var(--fc-bg-event-color);opacity:var(--fc-bg-event-opacity)}.fc .fc-bg-event .fc-event-title{font-size:var(--fc-small-font-size);font-style:italic;margin:.5em}.fc .fc-highlight{background:var(--fc-highlight-color)}.fc .fc-cell-shaded,.fc .fc-day-disabled{background:var(--fc-neutral-bg-color)}a.fc-event,a.fc-event:hover{text-decoration:none}.fc-event.fc-event-draggable,.fc-event[href]{cursor:pointer}.fc-event .fc-event-main{position:relative;z-index:2}.fc-event-dragging:not(.fc-event-selected){opacity:.75}.fc-event-dragging.fc-event-selected{box-shadow:0 2px 7px rgba(0,0,0,.3)}.fc-event .fc-event-resizer{display:none;position:absolute;z-index:4}.fc-event-selected .fc-event-resizer,.fc-event:hover .fc-event-resizer{display:block}.fc-event-selected .fc-event-resizer{background:var(--fc-page-bg-color);border-color:inherit;border-radius:calc(var(--fc-event-resizer-dot-total-width)/2);border-style:solid;border-width:var(--fc-event-resizer-dot-border-width);height:var(--fc-event-resizer-dot-total-width);width:var(--fc-event-resizer-dot-total-width)}.fc-event-selected .fc-event-resizer:before{bottom:-20px;content:"";left:-20px;position:absolute;right:-20px;top:-20px}.fc-event-selected,.fc-event:focus{box-shadow:0 2px 5px rgba(0,0,0,.2)}.fc-event-selected:before,.fc-event:focus:before{bottom:0;content:"";left:0;position:absolute;right:0;top:0;z-index:3}.fc-event-selected:after,.fc-event:focus:after{background:var(--fc-event-selected-overlay-color);bottom:-1px;content:"";left:-1px;position:absolute;right:-1px;top:-1px;z-index:1}.fc-h-event{background-color:var(--fc-event-bg-color);border:1px solid var(--fc-event-border-color);display:block}.fc-h-event .fc-event-main{color:var(--fc-event-text-color)}.fc-h-event .fc-event-main-frame{display:flex}.fc-h-event .fc-event-time{max-width:100%;overflow:hidden}.fc-h-event .fc-event-title-container{flex-grow:1;flex-shrink:1;min-width:0}.fc-h-event .fc-event-title{display:inline-block;left:0;max-width:100%;overflow:hidden;right:0;vertical-align:top}.fc-h-event.fc-event-selected:before{bottom:-10px;top:-10px}.fc-direction-ltr .fc-daygrid-block-event:not(.fc-event-start),.fc-direction-rtl .fc-daygrid-block-event:not(.fc-event-end){border-bottom-left-radius:0;border-left-width:0;border-top-left-radius:0}.fc-direction-ltr .fc-daygrid-block-event:not(.fc-event-end),.fc-direction-rtl .fc-daygrid-block-event:not(.fc-event-start){border-bottom-right-radius:0;border-right-width:0;border-top-right-radius:0}.fc-h-event:not(.fc-event-selected) .fc-event-resizer{bottom:0;top:0;width:var(--fc-event-resizer-thickness)}.fc-direction-ltr .fc-h-event:not(.fc-event-selected) .fc-event-resizer-start,.fc-direction-rtl .fc-h-event:not(.fc-event-selected) .fc-event-resizer-end{cursor:w-resize;left:calc(var(--fc-event-resizer-thickness)*-.5)}.fc-direction-ltr .fc-h-event:not(.fc-event-selected) .fc-event-resizer-end,.fc-direction-rtl .fc-h-event:not(.fc-event-selected) .fc-event-resizer-start{cursor:e-resize;right:calc(var(--fc-event-resizer-thickness)*-.5)}.fc-h-event.fc-event-selected .fc-event-resizer{margin-top:calc(var(--fc-event-resizer-dot-total-width)*-.5);top:50%}.fc-direction-ltr .fc-h-event.fc-event-selected .fc-event-resizer-start,.fc-direction-rtl .fc-h-event.fc-event-selected .fc-event-resizer-end{left:calc(var(--fc-event-resizer-dot-total-width)*-.5)}.fc-direction-ltr .fc-h-event.fc-event-selected .fc-event-resizer-end,.fc-direction-rtl .fc-h-event.fc-event-selected .fc-event-resizer-start{right:calc(var(--fc-event-resizer-dot-total-width)*-.5)}.fc .fc-popover{box-shadow:0 2px 6px rgba(0,0,0,.15);position:absolute;z-index:9999}.fc .fc-popover-header{align-items:center;display:flex;flex-direction:row;justify-content:space-between;padding:3px 4px}.fc .fc-popover-title{margin:0 2px}.fc .fc-popover-close{cursor:pointer;font-size:1.1em;opacity:.65}.fc-theme-standard .fc-popover{background:var(--fc-page-bg-color);border:1px solid var(--fc-border-color)}.fc-theme-standard .fc-popover-header{background:var(--fc-neutral-bg-color)}';uA(u0e);class dA{constructor(e){this.drainedOption=e,this.isRunning=!1,this.isDirty=!1,this.pauseDepths={},this.timeoutId=0}request(e){this.isDirty=!0,this.isPaused()||(this.clearTimeout(),e==null?this.tryDrain():this.timeoutId=setTimeout(this.tryDrain.bind(this),e))}pause(e=""){let{pauseDepths:n}=this;n[e]=(n[e]||0)+1,this.clearTimeout()}resume(e="",n){let{pauseDepths:r}=this;e in r&&(n?delete r[e]:(r[e]-=1,r[e]<=0&&delete r[e]),this.tryDrain())}isPaused(){return Object.keys(this.pauseDepths).length}tryDrain(){if(!this.isRunning&&!this.isPaused()){for(this.isRunning=!0;this.isDirty;)this.isDirty=!1,this.drained();this.isRunning=!1}}clear(){this.clearTimeout(),this.isDirty=!1,this.pauseDepths={}}clearTimeout(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=0)}drained(){this.drainedOption&&this.drainedOption()}}function hA(t){t.parentNode&&t.parentNode.removeChild(t)}function fl(t,e){if(t.closest)return t.closest(e);if(!document.documentElement.contains(t))return null;do{if(d0e(t,e))return t;t=t.parentElement||t.parentNode}while(t!==null&&t.nodeType===1);return null}function d0e(t,e){return(t.matches||t.matchesSelector||t.msMatchesSelector).call(t,e)}function h0e(t,e){let n=t instanceof HTMLElement?[t]:t,r=[];for(let c=0;c<n.length;c+=1){let u=n[c].querySelectorAll(e);for(let p=0;p<u.length;p+=1)r.push(u[p])}return r}const f0e=/(top|left|right|bottom|width|height)$/i;function vb(t,e){for(let n in e)$N(t,n,e[n])}function $N(t,e,n){n==null?t.style[e]="":typeof n=="number"&&f0e.test(e)?t.style[e]=`${n}px`:t.style[e]=n}function jN(t){var e,n;return(n=(e=t.composedPath)===null||e===void 0?void 0:e.call(t)[0])!==null&&n!==void 0?n:t.target}let DL=0;function HS(){return DL+=1,"fc-dom-"+DL}function GS(t){t.preventDefault()}function p0e(t,e){return n=>{let r=fl(n.target,t);r&&e.call(r,n,r)}}function UN(t,e,n,r){let c=p0e(n,r);return t.addEventListener(e,c),()=>{t.removeEventListener(e,c)}}function m0e(t,e,n,r){let c;return UN(t,"mouseover",e,(u,p)=>{if(p!==c){c=p,n(u,p);let o=w=>{c=null,r(w,p),p.removeEventListener("mouseleave",o)};p.addEventListener("mouseleave",o)}})}const OL=["webkitTransitionEnd","otransitionend","oTransitionEnd","msTransitionEnd","transitionend"];function g0e(t,e){let n=r=>{e(r),OL.forEach(c=>{t.removeEventListener(c,n)})};OL.forEach(r=>{t.addEventListener(r,n)})}function HN(t){return Object.assign({onClick:t},GN(t))}function GN(t){return{tabIndex:0,onKeyDown(e){(e.key==="Enter"||e.key===" ")&&(t(e),e.preventDefault())}}}let LL=0;function Eg(){return LL+=1,String(LL)}function fA(){document.body.classList.add("fc-not-allowed")}function pA(){document.body.classList.remove("fc-not-allowed")}function _0e(t){t.style.userSelect="none",t.style.webkitUserSelect="none",t.addEventListener("selectstart",GS)}function y0e(t){t.style.userSelect="",t.style.webkitUserSelect="",t.removeEventListener("selectstart",GS)}function v0e(t){t.addEventListener("contextmenu",GS)}function b0e(t){t.removeEventListener("contextmenu",GS)}function x0e(t){let e=[],n=[],r,c;for(typeof t=="string"?n=t.split(/\s*,\s*/):typeof t=="function"?n=[t]:Array.isArray(t)&&(n=t),r=0;r<n.length;r+=1)c=n[r],typeof c=="string"?e.push(c.charAt(0)==="-"?{field:c.substring(1),order:-1}:{field:c,order:1}):typeof c=="function"&&e.push({func:c});return e}function w0e(t,e,n){let r,c;for(r=0;r<n.length;r+=1)if(c=S0e(t,e,n[r]),c)return c;return 0}function S0e(t,e,n){return n.func?n.func(t,e):C0e(t[n.field],e[n.field])*(n.order||1)}function C0e(t,e){return!t&&!e?0:e==null?-1:t==null?1:typeof t=="string"||typeof e=="string"?String(t).localeCompare(String(e)):t-e}function Y_(t,e){let n=String(t);return"000".substr(0,e-n.length)+n}function bb(t,e,n){return typeof t=="function"?t(...e):typeof t=="string"?e.reduce((r,c,u)=>r.replace("$"+u,c||""),t):n}function T0e(t,e){return t-e}function aw(t){return t%1===0}function E0e(t){let e=t.querySelector(".fc-scrollgrid-shrink-frame"),n=t.querySelector(".fc-scrollgrid-shrink-cushion");if(!e)throw new Error("needs fc-scrollgrid-shrink-frame className");if(!n)throw new Error("needs fc-scrollgrid-shrink-cushion className");return t.getBoundingClientRect().width-e.getBoundingClientRect().width+n.getBoundingClientRect().width}const zL=["years","months","days","milliseconds"],I0e=/^(-?)(?:(\d+)\.)?(\d+):(\d\d)(?::(\d\d)(?:\.(\d\d\d))?)?/;function so(t,e){return typeof t=="string"?A0e(t):typeof t=="object"&&t?BL(t):typeof t=="number"?BL({[e||"milliseconds"]:t}):null}function A0e(t){let e=I0e.exec(t);if(e){let n=e[1]?-1:1;return{years:0,months:0,days:n*(e[2]?parseInt(e[2],10):0),milliseconds:n*((e[3]?parseInt(e[3],10):0)*60*60*1e3+(e[4]?parseInt(e[4],10):0)*60*1e3+(e[5]?parseInt(e[5],10):0)*1e3+(e[6]?parseInt(e[6],10):0))}}return null}function BL(t){let e={years:t.years||t.year||0,months:t.months||t.month||0,days:t.days||t.day||0,milliseconds:(t.hours||t.hour||0)*60*60*1e3+(t.minutes||t.minute||0)*60*1e3+(t.seconds||t.second||0)*1e3+(t.milliseconds||t.millisecond||t.ms||0)},n=t.weeks||t.week;return n&&(e.days+=n*7,e.specifiedWeeks=!0),e}function k0e(t,e){return t.years===e.years&&t.months===e.months&&t.days===e.days&&t.milliseconds===e.milliseconds}function kE(t,e){return{years:t.years+e.years,months:t.months+e.months,days:t.days+e.days,milliseconds:t.milliseconds+e.milliseconds}}function R0e(t,e){return{years:t.years-e.years,months:t.months-e.months,days:t.days-e.days,milliseconds:t.milliseconds-e.milliseconds}}function P0e(t,e){return{years:t.years*e,months:t.months*e,days:t.days*e,milliseconds:t.milliseconds*e}}function M0e(t){return J_(t)/365}function D0e(t){return J_(t)/30}function J_(t){return od(t)/864e5}function od(t){return t.years*(365*864e5)+t.months*(30*864e5)+t.days*864e5+t.milliseconds}function mA(t,e){let n=null;for(let r=0;r<zL.length;r+=1){let c=zL[r];if(e[c]){let u=t[c]/e[c];if(!aw(u)||n!==null&&n!==u)return null;n=u}else if(t[c])return null}return n}function RE(t){let e=t.milliseconds;if(e){if(e%1e3!==0)return{unit:"millisecond",value:e};if(e%(1e3*60)!==0)return{unit:"second",value:e/1e3};if(e%(1e3*60*60)!==0)return{unit:"minute",value:e/(1e3*60)};if(e)return{unit:"hour",value:e/(1e3*60*60)}}return t.days?t.specifiedWeeks&&t.days%7===0?{unit:"week",value:t.days/7}:{unit:"day",value:t.days}:t.months?{unit:"month",value:t.months}:t.years?{unit:"year",value:t.years}:{unit:"millisecond",value:0}}function jp(t,e,n){if(t===e)return!0;let r=t.length,c;if(r!==e.length)return!1;for(c=0;c<r;c+=1)if(!(n?n(t[c],e[c]):t[c]===e[c]))return!1;return!0}const O0e=["sun","mon","tue","wed","thu","fri","sat"];function FL(t,e){let n=Ap(t);return n[2]+=e*7,hc(n)}function za(t,e){let n=Ap(t);return n[2]+=e,hc(n)}function Up(t,e){let n=Ap(t);return n[6]+=e,hc(n)}function L0e(t,e){return Ig(t,e)/7}function Ig(t,e){return(e.valueOf()-t.valueOf())/(1e3*60*60*24)}function z0e(t,e){return(e.valueOf()-t.valueOf())/(1e3*60*60)}function B0e(t,e){return(e.valueOf()-t.valueOf())/(1e3*60)}function F0e(t,e){return(e.valueOf()-t.valueOf())/1e3}function N0e(t,e){let n=ys(t),r=ys(e);return{years:0,months:0,days:Math.round(Ig(n,r)),milliseconds:e.valueOf()-r.valueOf()-(t.valueOf()-n.valueOf())}}function V0e(t,e){let n=Xw(t,e);return n!==null&&n%7===0?n/7:null}function Xw(t,e){return kp(t)===kp(e)?Math.round(Ig(t,e)):null}function ys(t){return hc([t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()])}function $0e(t){return hc([t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours()])}function j0e(t){return hc([t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes()])}function U0e(t){return hc([t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds()])}function H0e(t,e,n){let r=t.getUTCFullYear(),c=gT(t,r,e,n);if(c<1)return gT(t,r-1,e,n);let u=gT(t,r+1,e,n);return u>=1?Math.min(c,u):c}function gT(t,e,n,r){let c=hc([e,0,1+G0e(e,n,r)]),u=ys(t),p=Math.round(Ig(c,u));return Math.floor(p/7)+1}function G0e(t,e,n){let r=7+e-n;return-((7+hc([t,0,r]).getUTCDay()-e)%7)+r-1}function NL(t){return[t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()]}function VL(t){return new Date(t[0],t[1]||0,t[2]==null?1:t[2],t[3]||0,t[4]||0,t[5]||0)}function Ap(t){return[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()]}function hc(t){return t.length===1&&(t=t.concat([0])),new Date(Date.UTC(...t))}function WN(t){return!isNaN(t.valueOf())}function kp(t){return t.getUTCHours()*1e3*60*60+t.getUTCMinutes()*1e3*60+t.getUTCSeconds()*1e3+t.getUTCMilliseconds()}function qN(t,e,n=!1){let r=t.toISOString();return r=r.replace(".000",""),n&&(r=r.replace("T00:00:00Z","")),r.length>10&&(e==null?r=r.replace("Z",""):e!==0&&(r=r.replace("Z",_A(e,!0)))),r}function gA(t){return t.toISOString().replace(/T.*$/,"")}function W0e(t){return t.toISOString().match(/^\d{4}-\d{2}/)[0]}function q0e(t){return Y_(t.getUTCHours(),2)+":"+Y_(t.getUTCMinutes(),2)+":"+Y_(t.getUTCSeconds(),2)}function _A(t,e=!1){let n=t<0?"-":"+",r=Math.abs(t),c=Math.floor(r/60),u=Math.round(r%60);return e?`${n+Y_(c,2)}:${Y_(u,2)}`:`GMT${n}${c}${u?`:${Y_(u,2)}`:""}`}function Xi(t,e,n){let r,c;return function(...u){if(!r)c=t.apply(this,u);else if(!jp(r,u)){let p=t.apply(this,u);(!e||!e(p,c))&&(c=p)}return r=u,c}}function lw(t,e,n){let r,c;return u=>(r?fd(r,u)||(c=t.call(this,u)):c=t.call(this,u),r=u,c)}const _T={week:3,separator:9,omitZeroMinute:9,meridiem:9,omitCommas:9},Yw={timeZoneName:7,era:6,year:5,month:4,day:2,weekday:2,hour:1,minute:1,second:1},Dx=/\s*([ap])\.?m\.?/i,Z0e=/,/g,K0e=/\s+/g,X0e=/\u200e/g,Y0e=/UTC|GMT/;class J0e{constructor(e){let n={},r={},c=9;for(let u in e)u in _T?(r[u]=e[u],_T[u]<9&&(c=Math.min(_T[u],c))):(n[u]=e[u],u in Yw&&(c=Math.min(Yw[u],c)));this.standardDateProps=n,this.extendedSettings=r,this.smallestUnitNum=c,this.buildFormattingFunc=Xi($L)}format(e,n){return this.buildFormattingFunc(this.standardDateProps,this.extendedSettings,n)(e)}formatRange(e,n,r,c){let{standardDateProps:u,extendedSettings:p}=this,o=r1e(e.marker,n.marker,r.calendarSystem);if(!o)return this.format(e,r);let w=o;w>1&&(u.year==="numeric"||u.year==="2-digit")&&(u.month==="numeric"||u.month==="2-digit")&&(u.day==="numeric"||u.day==="2-digit")&&(w=1);let T=this.format(e,r),A=this.format(n,r);if(T===A)return T;let D=o1e(u,w),B=$L(D,p,r),N=B(e),ee=B(n),Q=s1e(T,N,A,ee),se=p.separator||c||r.defaultSeparator||"";return Q?Q.before+N+se+ee+Q.after:T+se+A}getSmallestUnit(){switch(this.smallestUnitNum){case 7:case 6:case 5:return"year";case 4:return"month";case 3:return"week";case 2:return"day";default:return"time"}}}function $L(t,e,n){let r=Object.keys(t).length;return r===1&&t.timeZoneName==="short"?c=>_A(c.timeZoneOffset):r===0&&e.week?c=>i1e(n.computeWeekNumber(c.marker),n.weekText,n.weekTextLong,n.locale,e.week):Q0e(t,e,n)}function Q0e(t,e,n){t=Object.assign({},t),e=Object.assign({},e),e1e(t,e),t.timeZone="UTC";let r=new Intl.DateTimeFormat(n.locale.codes,t),c;if(e.omitZeroMinute){let u=Object.assign({},t);delete u.minute,c=new Intl.DateTimeFormat(n.locale.codes,u)}return u=>{let{marker:p}=u,o;c&&!p.getUTCMinutes()?o=c:o=r;let w=o.format(p);return t1e(w,u,t,e,n)}}function e1e(t,e){t.timeZoneName&&(t.hour||(t.hour="2-digit"),t.minute||(t.minute="2-digit")),t.timeZoneName==="long"&&(t.timeZoneName="short"),e.omitZeroMinute&&(t.second||t.millisecond)&&delete e.omitZeroMinute}function t1e(t,e,n,r,c){return t=t.replace(X0e,""),n.timeZoneName==="short"&&(t=n1e(t,c.timeZone==="UTC"||e.timeZoneOffset==null?"UTC":_A(e.timeZoneOffset))),r.omitCommas&&(t=t.replace(Z0e,"").trim()),r.omitZeroMinute&&(t=t.replace(":00","")),r.meridiem===!1?t=t.replace(Dx,"").trim():r.meridiem==="narrow"?t=t.replace(Dx,(u,p)=>p.toLocaleLowerCase()):r.meridiem==="short"?t=t.replace(Dx,(u,p)=>`${p.toLocaleLowerCase()}m`):r.meridiem==="lowercase"&&(t=t.replace(Dx,u=>u.toLocaleLowerCase())),t=t.replace(K0e," "),t=t.trim(),t}function n1e(t,e){let n=!1;return t=t.replace(Y0e,()=>(n=!0,e)),n||(t+=` ${e}`),t}function i1e(t,e,n,r,c){let u=[];return c==="long"?u.push(n):(c==="short"||c==="narrow")&&u.push(e),(c==="long"||c==="short")&&u.push(" "),u.push(r.simpleNumberFormat.format(t)),r.options.direction==="rtl"&&u.reverse(),u.join("")}function r1e(t,e,n){return n.getMarkerYear(t)!==n.getMarkerYear(e)?5:n.getMarkerMonth(t)!==n.getMarkerMonth(e)?4:n.getMarkerDay(t)!==n.getMarkerDay(e)?2:kp(t)!==kp(e)?1:0}function o1e(t,e){let n={};for(let r in t)(!(r in Yw)||Yw[r]<=e)&&(n[r]=t[r]);return n}function s1e(t,e,n,r){let c=0;for(;c<t.length;){let u=t.indexOf(e,c);if(u===-1)break;let p=t.substr(0,u);c=u+e.length;let o=t.substr(c),w=0;for(;w<n.length;){let T=n.indexOf(r,w);if(T===-1)break;let A=n.substr(0,T);w=T+r.length;let D=n.substr(w);if(p===A&&o===D)return{before:p,after:o}}}return null}function jL(t,e){let n=e.markerToArray(t.marker);return{marker:t.marker,timeZoneOffset:t.timeZoneOffset,array:n,year:n[0],month:n[1],day:n[2],hour:n[3],minute:n[4],second:n[5],millisecond:n[6]}}function Jw(t,e,n,r){let c=jL(t,n.calendarSystem),u=e?jL(e,n.calendarSystem):null;return{date:c,start:c,end:u,timeZone:n.timeZone,localeCodes:n.locale.codes,defaultSeparator:r||n.defaultSeparator}}class a1e{constructor(e){this.cmdStr=e}format(e,n,r){return n.cmdFormatter(this.cmdStr,Jw(e,null,n,r))}formatRange(e,n,r,c){return r.cmdFormatter(this.cmdStr,Jw(e,n,r,c))}}class l1e{constructor(e){this.func=e}format(e,n,r){return this.func(Jw(e,null,n,r))}formatRange(e,n,r,c){return this.func(Jw(e,n,r,c))}}function qs(t){return typeof t=="object"&&t?new J0e(t):typeof t=="string"?new a1e(t):typeof t=="function"?new l1e(t):null}const UL={navLinkDayClick:qt,navLinkWeekClick:qt,duration:so,bootstrapFontAwesome:qt,buttonIcons:qt,customButtons:qt,defaultAllDayEventDuration:so,defaultTimedEventDuration:so,nextDayThreshold:so,scrollTime:so,scrollTimeReset:Boolean,slotMinTime:so,slotMaxTime:so,dayPopoverFormat:qs,slotDuration:so,snapDuration:so,headerToolbar:qt,footerToolbar:qt,defaultRangeSeparator:String,titleRangeSeparator:String,forceEventDuration:Boolean,dayHeaders:Boolean,dayHeaderFormat:qs,dayHeaderClassNames:qt,dayHeaderContent:qt,dayHeaderDidMount:qt,dayHeaderWillUnmount:qt,dayCellClassNames:qt,dayCellContent:qt,dayCellDidMount:qt,dayCellWillUnmount:qt,initialView:String,aspectRatio:Number,weekends:Boolean,weekNumberCalculation:qt,weekNumbers:Boolean,weekNumberClassNames:qt,weekNumberContent:qt,weekNumberDidMount:qt,weekNumberWillUnmount:qt,editable:Boolean,viewClassNames:qt,viewDidMount:qt,viewWillUnmount:qt,nowIndicator:Boolean,nowIndicatorSnap:qt,nowIndicatorClassNames:qt,nowIndicatorContent:qt,nowIndicatorDidMount:qt,nowIndicatorWillUnmount:qt,showNonCurrentDates:Boolean,lazyFetching:Boolean,startParam:String,endParam:String,timeZoneParam:String,timeZone:String,locales:qt,locale:qt,themeSystem:String,dragRevertDuration:Number,dragScroll:Boolean,allDayMaintainDuration:Boolean,unselectAuto:Boolean,dropAccept:qt,eventOrder:x0e,eventOrderStrict:Boolean,handleWindowResize:Boolean,windowResizeDelay:Number,longPressDelay:Number,eventDragMinDistance:Number,expandRows:Boolean,height:qt,contentHeight:qt,direction:String,weekNumberFormat:qs,eventResizableFromStart:Boolean,displayEventTime:Boolean,displayEventEnd:Boolean,weekText:String,weekTextLong:String,progressiveEventRendering:Boolean,businessHours:qt,initialDate:qt,now:qt,eventDataTransform:qt,stickyHeaderDates:qt,stickyFooterScrollbar:qt,viewHeight:qt,defaultAllDay:Boolean,eventSourceFailure:qt,eventSourceSuccess:qt,eventDisplay:String,eventStartEditable:Boolean,eventDurationEditable:Boolean,eventOverlap:qt,eventConstraint:qt,eventAllow:qt,eventBackgroundColor:String,eventBorderColor:String,eventTextColor:String,eventColor:String,eventClassNames:qt,eventContent:qt,eventDidMount:qt,eventWillUnmount:qt,selectConstraint:qt,selectOverlap:qt,selectAllow:qt,droppable:Boolean,unselectCancel:String,slotLabelFormat:qt,slotLaneClassNames:qt,slotLaneContent:qt,slotLaneDidMount:qt,slotLaneWillUnmount:qt,slotLabelClassNames:qt,slotLabelContent:qt,slotLabelDidMount:qt,slotLabelWillUnmount:qt,dayMaxEvents:qt,dayMaxEventRows:qt,dayMinWidth:Number,slotLabelInterval:so,allDayText:String,allDayClassNames:qt,allDayContent:qt,allDayDidMount:qt,allDayWillUnmount:qt,slotMinWidth:Number,navLinks:Boolean,eventTimeFormat:qs,rerenderDelay:Number,moreLinkText:qt,moreLinkHint:qt,selectMinDistance:Number,selectable:Boolean,selectLongPressDelay:Number,eventLongPressDelay:Number,selectMirror:Boolean,eventMaxStack:Number,eventMinHeight:Number,eventMinWidth:Number,eventShortHeight:Number,slotEventOverlap:Boolean,plugins:qt,firstDay:Number,dayCount:Number,dateAlignment:String,dateIncrement:so,hiddenDays:qt,fixedWeekCount:Boolean,validRange:qt,visibleRange:qt,titleFormat:qt,eventInteractive:Boolean,noEventsText:String,viewHint:qt,navLinkHint:qt,closeHint:String,timeHint:String,eventHint:String,moreLinkClick:qt,moreLinkClassNames:qt,moreLinkContent:qt,moreLinkDidMount:qt,moreLinkWillUnmount:qt,monthStartFormat:qs,handleCustomRendering:qt,customRenderingMetaMap:qt,customRenderingReplaces:Boolean},xb={eventDisplay:"auto",defaultRangeSeparator:" - ",titleRangeSeparator:" – ",defaultTimedEventDuration:"01:00:00",defaultAllDayEventDuration:{day:1},forceEventDuration:!1,nextDayThreshold:"00:00:00",dayHeaders:!0,initialView:"",aspectRatio:1.35,headerToolbar:{start:"title",center:"",end:"today prev,next"},weekends:!0,weekNumbers:!1,weekNumberCalculation:"local",editable:!1,nowIndicator:!1,scrollTime:"06:00:00",scrollTimeReset:!0,slotMinTime:"00:00:00",slotMaxTime:"24:00:00",showNonCurrentDates:!0,lazyFetching:!0,startParam:"start",endParam:"end",timeZoneParam:"timeZone",timeZone:"local",locales:[],locale:"",themeSystem:"standard",dragRevertDuration:500,dragScroll:!0,allDayMaintainDuration:!1,unselectAuto:!0,dropAccept:"*",eventOrder:"start,-duration,allDay,title",dayPopoverFormat:{month:"long",day:"numeric",year:"numeric"},handleWindowResize:!0,windowResizeDelay:100,longPressDelay:1e3,eventDragMinDistance:5,expandRows:!1,navLinks:!1,selectable:!1,eventMinHeight:15,eventMinWidth:30,eventShortHeight:30,monthStartFormat:{month:"long",day:"numeric"},nowIndicatorSnap:"auto"},HL={datesSet:qt,eventsSet:qt,eventAdd:qt,eventChange:qt,eventRemove:qt,windowResize:qt,eventClick:qt,eventMouseEnter:qt,eventMouseLeave:qt,select:qt,unselect:qt,loading:qt,_unmount:qt,_beforeprint:qt,_afterprint:qt,_noEventDrop:qt,_noEventResize:qt,_resize:qt,_scrollRequest:qt},GL={buttonText:qt,buttonHints:qt,views:qt,plugins:qt,initialEvents:qt,events:qt,eventSources:qt},qm={headerToolbar:Zm,footerToolbar:Zm,buttonText:Zm,buttonHints:Zm,buttonIcons:Zm,dateIncrement:Zm,plugins:Ox,events:Ox,eventSources:Ox,resources:Ox};function Zm(t,e){return typeof t=="object"&&typeof e=="object"&&t&&e?fd(t,e):t===e}function Ox(t,e){return Array.isArray(t)&&Array.isArray(e)?jp(t,e):t===e}const c1e={type:String,component:qt,buttonText:String,buttonTextKey:String,dateProfileGeneratorClass:qt,usesMinMaxTime:Boolean,classNames:qt,content:qt,didMount:qt,willUnmount:qt};function yT(t){return vA(t,qm)}function yA(t,e){let n={},r={};for(let c in e)c in t&&(n[c]=e[c](t[c]));for(let c in t)c in e||(r[c]=t[c]);return{refined:n,extra:r}}function qt(t){return t}const{hasOwnProperty:Qw}=Object.prototype;function vA(t,e){let n={};if(e){for(let r in e)if(e[r]===Zm){let c=[];for(let u=t.length-1;u>=0;u-=1){let p=t[u][r];if(typeof p=="object"&&p)c.unshift(p);else if(p!==void 0){n[r]=p;break}}c.length&&(n[r]=vA(c))}}for(let r=t.length-1;r>=0;r-=1){let c=t[r];for(let u in c)u in n||(n[u]=c[u])}return n}function yg(t,e){let n={};for(let r in t)e(t[r],r)&&(n[r]=t[r]);return n}function lf(t,e){let n={};for(let r in t)n[r]=e(t[r],r);return n}function ZN(t){let e={};for(let n of t)e[n]=!0;return e}function bA(t){let e=[];for(let n in t)e.push(t[n]);return e}function fd(t,e){if(t===e)return!0;for(let n in t)if(Qw.call(t,n)&&!(n in e))return!1;for(let n in e)if(Qw.call(e,n)&&t[n]!==e[n])return!1;return!0}const u1e=/^on[A-Z]/;function d1e(t,e){const n=h1e(t,e);for(let r of n)if(!u1e.test(r))return!1;return!0}function h1e(t,e){let n=[];for(let r in t)Qw.call(t,r)&&(r in e||n.push(r));for(let r in e)Qw.call(e,r)&&t[r]!==e[r]&&n.push(r);return n}function vT(t,e,n={}){if(t===e)return!0;for(let r in e)if(!(r in t&&f1e(t[r],e[r],n[r])))return!1;for(let r in t)if(!(r in e))return!1;return!0}function f1e(t,e,n){return t===e||n===!0?!0:n?n(t,e):!1}function p1e(t,e=0,n,r=1){let c=[];n==null&&(n=Object.keys(t).length);for(let u=e;u<n;u+=r){let p=t[u];p!==void 0&&c.push(p)}return c}let KN={};function m1e(t,e){KN[t]=e}function g1e(t){return new KN[t]}class _1e{getMarkerYear(e){return e.getUTCFullYear()}getMarkerMonth(e){return e.getUTCMonth()}getMarkerDay(e){return e.getUTCDate()}arrayToMarker(e){return hc(e)}markerToArray(e){return Ap(e)}}m1e("gregory",_1e);const y1e=/^\s*(\d{4})(-?(\d{2})(-?(\d{2})([T ](\d{2}):?(\d{2})(:?(\d{2})(\.(\d+))?)?(Z|(([-+])(\d{2})(:?(\d{2}))?))?)?)?)?$/;function v1e(t){let e=y1e.exec(t);if(e){let n=new Date(Date.UTC(Number(e[1]),e[3]?Number(e[3])-1:0,Number(e[5]||1),Number(e[7]||0),Number(e[8]||0),Number(e[10]||0),e[12]?+`0.${e[12]}`*1e3:0));if(WN(n)){let r=null;return e[13]&&(r=(e[15]==="-"?-1:1)*(Number(e[16]||0)*60+Number(e[18]||0))),{marker:n,isTimeUnspecified:!e[6],timeZoneOffset:r}}}return null}class b1e{constructor(e){let n=this.timeZone=e.timeZone,r=n!=="local"&&n!=="UTC";e.namedTimeZoneImpl&&r&&(this.namedTimeZoneImpl=new e.namedTimeZoneImpl(n)),this.canComputeOffset=!!(!r||this.namedTimeZoneImpl),this.calendarSystem=g1e(e.calendarSystem),this.locale=e.locale,this.weekDow=e.locale.week.dow,this.weekDoy=e.locale.week.doy,e.weekNumberCalculation==="ISO"&&(this.weekDow=1,this.weekDoy=4),typeof e.firstDay=="number"&&(this.weekDow=e.firstDay),typeof e.weekNumberCalculation=="function"&&(this.weekNumberFunc=e.weekNumberCalculation),this.weekText=e.weekText!=null?e.weekText:e.locale.options.weekText,this.weekTextLong=(e.weekTextLong!=null?e.weekTextLong:e.locale.options.weekTextLong)||this.weekText,this.cmdFormatter=e.cmdFormatter,this.defaultSeparator=e.defaultSeparator}createMarker(e){let n=this.createMarkerMeta(e);return n===null?null:n.marker}createNowMarker(){return this.canComputeOffset?this.timestampToMarker(new Date().valueOf()):hc(NL(new Date))}createMarkerMeta(e){if(typeof e=="string")return this.parse(e);let n=null;return typeof e=="number"?n=this.timestampToMarker(e):e instanceof Date?(e=e.valueOf(),isNaN(e)||(n=this.timestampToMarker(e))):Array.isArray(e)&&(n=hc(e)),n===null||!WN(n)?null:{marker:n,isTimeUnspecified:!1,forcedTzo:null}}parse(e){let n=v1e(e);if(n===null)return null;let{marker:r}=n,c=null;return n.timeZoneOffset!==null&&(this.canComputeOffset?r=this.timestampToMarker(r.valueOf()-n.timeZoneOffset*60*1e3):c=n.timeZoneOffset),{marker:r,isTimeUnspecified:n.isTimeUnspecified,forcedTzo:c}}getYear(e){return this.calendarSystem.getMarkerYear(e)}getMonth(e){return this.calendarSystem.getMarkerMonth(e)}getDay(e){return this.calendarSystem.getMarkerDay(e)}add(e,n){let r=this.calendarSystem.markerToArray(e);return r[0]+=n.years,r[1]+=n.months,r[2]+=n.days,r[6]+=n.milliseconds,this.calendarSystem.arrayToMarker(r)}subtract(e,n){let r=this.calendarSystem.markerToArray(e);return r[0]-=n.years,r[1]-=n.months,r[2]-=n.days,r[6]-=n.milliseconds,this.calendarSystem.arrayToMarker(r)}addYears(e,n){let r=this.calendarSystem.markerToArray(e);return r[0]+=n,this.calendarSystem.arrayToMarker(r)}addMonths(e,n){let r=this.calendarSystem.markerToArray(e);return r[1]+=n,this.calendarSystem.arrayToMarker(r)}diffWholeYears(e,n){let{calendarSystem:r}=this;return kp(e)===kp(n)&&r.getMarkerDay(e)===r.getMarkerDay(n)&&r.getMarkerMonth(e)===r.getMarkerMonth(n)?r.getMarkerYear(n)-r.getMarkerYear(e):null}diffWholeMonths(e,n){let{calendarSystem:r}=this;return kp(e)===kp(n)&&r.getMarkerDay(e)===r.getMarkerDay(n)?r.getMarkerMonth(n)-r.getMarkerMonth(e)+(r.getMarkerYear(n)-r.getMarkerYear(e))*12:null}greatestWholeUnit(e,n){let r=this.diffWholeYears(e,n);return r!==null?{unit:"year",value:r}:(r=this.diffWholeMonths(e,n),r!==null?{unit:"month",value:r}:(r=V0e(e,n),r!==null?{unit:"week",value:r}:(r=Xw(e,n),r!==null?{unit:"day",value:r}:(r=z0e(e,n),aw(r)?{unit:"hour",value:r}:(r=B0e(e,n),aw(r)?{unit:"minute",value:r}:(r=F0e(e,n),aw(r)?{unit:"second",value:r}:{unit:"millisecond",value:n.valueOf()-e.valueOf()}))))))}countDurationsBetween(e,n,r){let c;return r.years&&(c=this.diffWholeYears(e,n),c!==null)?c/M0e(r):r.months&&(c=this.diffWholeMonths(e,n),c!==null)?c/D0e(r):r.days&&(c=Xw(e,n),c!==null)?c/J_(r):(n.valueOf()-e.valueOf())/od(r)}startOf(e,n){return n==="year"?this.startOfYear(e):n==="month"?this.startOfMonth(e):n==="week"?this.startOfWeek(e):n==="day"?ys(e):n==="hour"?$0e(e):n==="minute"?j0e(e):n==="second"?U0e(e):null}startOfYear(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e)])}startOfMonth(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e),this.calendarSystem.getMarkerMonth(e)])}startOfWeek(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e),this.calendarSystem.getMarkerMonth(e),e.getUTCDate()-(e.getUTCDay()-this.weekDow+7)%7])}computeWeekNumber(e){return this.weekNumberFunc?this.weekNumberFunc(this.toDate(e)):H0e(e,this.weekDow,this.weekDoy)}format(e,n,r={}){return n.format({marker:e,timeZoneOffset:r.forcedTzo!=null?r.forcedTzo:this.offsetForMarker(e)},this)}formatRange(e,n,r,c={}){return c.isEndExclusive&&(n=Up(n,-1)),r.formatRange({marker:e,timeZoneOffset:c.forcedStartTzo!=null?c.forcedStartTzo:this.offsetForMarker(e)},{marker:n,timeZoneOffset:c.forcedEndTzo!=null?c.forcedEndTzo:this.offsetForMarker(n)},this,c.defaultSeparator)}formatIso(e,n={}){let r=null;return n.omitTimeZoneOffset||(n.forcedTzo!=null?r=n.forcedTzo:r=this.offsetForMarker(e)),qN(e,r,n.omitTime)}timestampToMarker(e){return this.timeZone==="local"?hc(NL(new Date(e))):this.timeZone==="UTC"||!this.namedTimeZoneImpl?new Date(e):hc(this.namedTimeZoneImpl.timestampToArray(e))}offsetForMarker(e){return this.timeZone==="local"?-VL(Ap(e)).getTimezoneOffset():this.timeZone==="UTC"?0:this.namedTimeZoneImpl?this.namedTimeZoneImpl.offsetForArray(Ap(e)):null}toDate(e,n){return this.timeZone==="local"?VL(Ap(e)):this.timeZone==="UTC"?new Date(e.valueOf()):this.namedTimeZoneImpl?new Date(e.valueOf()-this.namedTimeZoneImpl.offsetForArray(Ap(e))*1e3*60):new Date(e.valueOf()-(n||0))}}class N0{constructor(e){this.iconOverrideOption&&this.setIconOverride(e[this.iconOverrideOption])}setIconOverride(e){let n,r;if(typeof e=="object"&&e){n=Object.assign({},this.iconClasses);for(r in e)n[r]=this.applyIconOverridePrefix(e[r]);this.iconClasses=n}else e===!1&&(this.iconClasses={})}applyIconOverridePrefix(e){let n=this.iconOverridePrefix;return n&&e.indexOf(n)!==0&&(e=n+e),e}getClass(e){return this.classes[e]||""}getIconClass(e,n){let r;return n&&this.rtlIconClasses?r=this.rtlIconClasses[e]||this.iconClasses[e]:r=this.iconClasses[e],r?`${this.baseIconClass} ${r}`:""}getCustomButtonIconClass(e){let n;return this.iconOverrideCustomButtonOption&&(n=e[this.iconOverrideCustomButtonOption],n)?`${this.baseIconClass} ${this.applyIconOverridePrefix(n)}`:""}}N0.prototype.classes={};N0.prototype.iconClasses={};N0.prototype.baseIconClass="";N0.prototype.iconOverridePrefix="";function eS(t){t();let e=Ui.debounceRendering,n=[];function r(c){n.push(c)}for(Ui.debounceRendering=r,x0(dt(x1e,{}),document.createElement("div"));n.length;)n.shift()();Ui.debounceRendering=e}class x1e extends Bc{render(){return dt("div",{})}componentDidMount(){this.setState({})}}function XN(t){let e=Gbe(t),n=e.Provider;return e.Provider=function(){let r=!this.getChildContext,c=n.apply(this,arguments);if(r){let u=[];this.shouldComponentUpdate=p=>{this.props.value!==p.value&&u.forEach(o=>{o.context=p.value,o.forceUpdate()})},this.sub=p=>{u.push(p);let o=p.componentWillUnmount;p.componentWillUnmount=()=>{u.splice(u.indexOf(p),1),o&&o.call(p)}}}return c},e}class w1e{constructor(e,n,r,c){this.execFunc=e,this.emitter=n,this.scrollTime=r,this.scrollTimeReset=c,this.handleScrollRequest=u=>{this.queuedRequest=Object.assign({},this.queuedRequest||{},u),this.drain()},n.on("_scrollRequest",this.handleScrollRequest),this.fireInitialScroll()}detach(){this.emitter.off("_scrollRequest",this.handleScrollRequest)}update(e){e&&this.scrollTimeReset?this.fireInitialScroll():this.drain()}fireInitialScroll(){this.handleScrollRequest({time:this.scrollTime})}drain(){this.queuedRequest&&this.execFunc(this.queuedRequest)&&(this.queuedRequest=null)}}const ff=XN({});function S1e(t,e,n,r,c,u,p,o,w,T,A,D,B,N){return{dateEnv:c,nowManager:u,options:n,pluginHooks:o,emitter:A,dispatch:w,getCurrentData:T,calendarApi:D,viewSpec:t,viewApi:e,dateProfileGenerator:r,theme:p,isRtl:n.direction==="rtl",addResizeHandler(ee){A.on("_resize",ee)},removeResizeHandler(ee){A.off("_resize",ee)},createScrollResponder(ee){return new w1e(ee,A,so(n.scrollTime),n.scrollTimeReset)},registerInteractiveComponent:B,unregisterInteractiveComponent:N}}class Ag extends Bc{shouldComponentUpdate(e,n){return!vT(this.props,e,this.propEquality)||!vT(this.state,n,this.stateEquality)}safeSetState(e){vT(this.state,Object.assign(Object.assign({},this.state),e),this.stateEquality)||this.setState(e)}}Ag.addPropsEquality=C1e;Ag.addStateEquality=T1e;Ag.contextType=ff;Ag.prototype.propEquality={};Ag.prototype.stateEquality={};class Vo extends Ag{}Vo.contextType=ff;function C1e(t){let e=Object.create(this.prototype.propEquality);Object.assign(e,t),this.prototype.propEquality=e}function T1e(t){let e=Object.create(this.prototype.stateEquality);Object.assign(e,t),this.prototype.stateEquality=e}function ah(t,e){typeof t=="function"?t(e):t&&(t.current=e)}class xA extends Vo{constructor(){super(...arguments),this.id=Eg(),this.queuedDomNodes=[],this.currentDomNodes=[],this.handleEl=e=>{const{options:n}=this.context,{generatorName:r}=this.props;(!n.customRenderingReplaces||!PE(r,n))&&this.updateElRef(e)},this.updateElRef=e=>{this.props.elRef&&ah(this.props.elRef,e)}}render(){const{props:e,context:n}=this,{options:r}=n,{customGenerator:c,defaultGenerator:u,renderProps:p}=e,o=YN(e,[],this.handleEl);let w=!1,T,A=[],D;if(c!=null){const B=typeof c=="function"?c(p,dt):c;if(B===!0)w=!0;else{const N=B&&typeof B=="object";N&&"html"in B?o.dangerouslySetInnerHTML={__html:B.html}:N&&"domNodes"in B?A=Array.prototype.slice.call(B.domNodes):(N?xN(B):typeof B!="function")?T=B:D=B}}else w=!PE(e.generatorName,r);return w&&u&&(T=u(p)),this.queuedDomNodes=A,this.currentGeneratorMeta=D,dt(e.elTag,o,T)}componentDidMount(){this.applyQueueudDomNodes(),this.triggerCustomRendering(!0)}componentDidUpdate(){this.applyQueueudDomNodes(),this.triggerCustomRendering(!0)}componentWillUnmount(){this.triggerCustomRendering(!1)}triggerCustomRendering(e){var n;const{props:r,context:c}=this,{handleCustomRendering:u,customRenderingMetaMap:p}=c.options;if(u){const o=(n=this.currentGeneratorMeta)!==null&&n!==void 0?n:p==null?void 0:p[r.generatorName];o&&u(Object.assign(Object.assign({id:this.id,isActive:e,containerEl:this.base,reportNewContainerEl:this.updateElRef,generatorMeta:o},r),{elClasses:(r.elClasses||[]).filter(E1e)}))}}applyQueueudDomNodes(){const{queuedDomNodes:e,currentDomNodes:n}=this,r=this.base;if(!jp(e,n)){n.forEach(hA);for(let c of e)r.appendChild(c);this.currentDomNodes=e}}}xA.addPropsEquality({elClasses:jp,elStyle:fd,elAttrs:d1e,renderProps:fd});function PE(t,e){var n;return!!(e.handleCustomRendering&&t&&(!((n=e.customRenderingMetaMap)===null||n===void 0)&&n[t]))}function YN(t,e,n){const r=Object.assign(Object.assign({},t.elAttrs),{ref:n});return(t.elClasses||e)&&(r.className=(t.elClasses||[]).concat(e||[]).concat(r.className||[]).filter(Boolean).join(" ")),t.elStyle&&(r.style=t.elStyle),r}function E1e(t){return!!t}const JN=XN(0);class Vc extends Bc{constructor(){super(...arguments),this.InnerContent=I1e.bind(void 0,this),this.handleEl=e=>{this.el=e,this.props.elRef&&(ah(this.props.elRef,e),e&&this.didMountMisfire&&this.componentDidMount())}}render(){const{props:e}=this,n=A1e(e.classNameGenerator,e.renderProps);if(e.children){const r=YN(e,n,this.handleEl),c=e.children(this.InnerContent,e.renderProps,r);return e.elTag?dt(e.elTag,r,c):c}else return dt(xA,Object.assign(Object.assign({},e),{elRef:this.handleEl,elTag:e.elTag||"div",elClasses:(e.elClasses||[]).concat(n),renderId:this.context}))}componentDidMount(){var e,n;this.el?(n=(e=this.props).didMount)===null||n===void 0||n.call(e,Object.assign(Object.assign({},this.props.renderProps),{el:this.el})):this.didMountMisfire=!0}componentWillUnmount(){var e,n;(n=(e=this.props).willUnmount)===null||n===void 0||n.call(e,Object.assign(Object.assign({},this.props.renderProps),{el:this.el}))}}Vc.contextType=JN;function I1e(t,e){const n=t.props;return dt(xA,Object.assign({renderProps:n.renderProps,generatorName:n.generatorName,customGenerator:n.customGenerator,defaultGenerator:n.defaultGenerator,renderId:t.context},e))}function A1e(t,e){const n=typeof t=="function"?t(e):t||[];return typeof n=="string"?[n]:n}class tS extends Vo{render(){let{props:e,context:n}=this,{options:r}=n,c={view:n.viewApi};return dt(Vc,{elRef:e.elRef,elTag:e.elTag||"div",elAttrs:e.elAttrs,elClasses:[...QN(e.viewSpec),...e.elClasses||[]],elStyle:e.elStyle,renderProps:c,classNameGenerator:r.viewClassNames,generatorName:void 0,didMount:r.viewDidMount,willUnmount:r.viewWillUnmount},()=>e.children)}}function QN(t){return[`fc-${t.type}-view`,"fc-view"]}function k1e(t,e){let n=null,r=null;return t.start&&(n=e.createMarker(t.start)),t.end&&(r=e.createMarker(t.end)),!n&&!r||n&&r&&r<n?null:{start:n,end:r}}function WL(t,e){let n=[],{start:r}=e,c,u;for(t.sort(R1e),c=0;c<t.length;c+=1)u=t[c],u.start>r&&n.push({start:r,end:u.start}),u.end>r&&(r=u.end);return r<e.end&&n.push({start:r,end:e.end}),n}function R1e(t,e){return t.start.valueOf()-e.start.valueOf()}function vg(t,e){let{start:n,end:r}=t,c=null;return e.start!==null&&(n===null?n=e.start:n=new Date(Math.max(n.valueOf(),e.start.valueOf()))),e.end!=null&&(r===null?r=e.end:r=new Date(Math.min(r.valueOf(),e.end.valueOf()))),(n===null||r===null||n<r)&&(c={start:n,end:r}),c}function P1e(t,e){return(t.start===null?null:t.start.valueOf())===(e.start===null?null:e.start.valueOf())&&(t.end===null?null:t.end.valueOf())===(e.end===null?null:e.end.valueOf())}function wA(t,e){return(t.end===null||e.start===null||t.end>e.start)&&(t.start===null||e.end===null||t.start<e.end)}function WS(t,e){return(t.start===null||e.start!==null&&e.start>=t.start)&&(t.end===null||e.end!==null&&e.end<=t.end)}function nf(t,e){return(t.start===null||e>=t.start)&&(t.end===null||e<t.end)}function M1e(t,e){return e.start!=null&&t<e.start?e.start:e.end!=null&&t>=e.end?new Date(e.end.valueOf()-1):t}function e8(t){let e=Math.floor(Ig(t.start,t.end))||1,n=ys(t.start),r=za(n,e);return{start:n,end:r}}function t8(t,e=so(0)){let n=null,r=null;if(t.end){r=ys(t.end);let c=t.end.valueOf()-r.valueOf();c&&c>=od(e)&&(r=za(r,1))}return t.start&&(n=ys(t.start),r&&r<=n&&(r=za(n,1))),{start:n,end:r}}function L_(t,e,n,r){return r==="year"?so(n.diffWholeYears(t,e),"year"):r==="month"?so(n.diffWholeMonths(t,e),"month"):N0e(t,e)}class n8{constructor(e){this.props=e,this.initHiddenDays()}buildPrev(e,n,r){let{dateEnv:c}=this.props,u=c.subtract(c.startOf(n,e.currentRangeUnit),e.dateIncrement);return this.build(u,-1,r)}buildNext(e,n,r){let{dateEnv:c}=this.props,u=c.add(c.startOf(n,e.currentRangeUnit),e.dateIncrement);return this.build(u,1,r)}build(e,n,r=!0){let{props:c}=this,u,p,o,w,T,A;return u=this.buildValidRange(),u=this.trimHiddenDays(u),r&&(e=M1e(e,u)),p=this.buildCurrentRangeInfo(e,n),o=/^(year|month|week|day)$/.test(p.unit),w=this.buildRenderRange(this.trimHiddenDays(p.range),p.unit,o),w=this.trimHiddenDays(w),T=w,c.showNonCurrentDates||(T=vg(T,p.range)),T=this.adjustActiveRange(T),T=vg(T,u),A=wA(p.range,u),nf(w,e)||(e=w.start),{currentDate:e,validRange:u,currentRange:p.range,currentRangeUnit:p.unit,isRangeAllDay:o,activeRange:T,renderRange:w,slotMinTime:c.slotMinTime,slotMaxTime:c.slotMaxTime,isValid:A,dateIncrement:this.buildDateIncrement(p.duration)}}buildValidRange(){let e=this.props.validRangeInput,n=typeof e=="function"?e.call(this.props.calendarApi,this.props.dateEnv.toDate(this.props.nowManager.getDateMarker())):e;return this.refineRange(n)||{start:null,end:null}}buildCurrentRangeInfo(e,n){let{props:r}=this,c=null,u=null,p=null,o;return r.duration?(c=r.duration,u=r.durationUnit,p=this.buildRangeFromDuration(e,n,c,u)):(o=this.props.dayCount)?(u="day",p=this.buildRangeFromDayCount(e,n,o)):(p=this.buildCustomVisibleRange(e))?u=r.dateEnv.greatestWholeUnit(p.start,p.end).unit:(c=this.getFallbackDuration(),u=RE(c).unit,p=this.buildRangeFromDuration(e,n,c,u)),{duration:c,unit:u,range:p}}getFallbackDuration(){return so({day:1})}adjustActiveRange(e){let{dateEnv:n,usesMinMaxTime:r,slotMinTime:c,slotMaxTime:u}=this.props,{start:p,end:o}=e;return r&&(J_(c)<0&&(p=ys(p),p=n.add(p,c)),J_(u)>1&&(o=ys(o),o=za(o,-1),o=n.add(o,u))),{start:p,end:o}}buildRangeFromDuration(e,n,r,c){let{dateEnv:u,dateAlignment:p}=this.props,o,w,T;if(!p){let{dateIncrement:D}=this.props;D&&od(D)<od(r)?p=RE(D).unit:p=c}J_(r)<=1&&this.isHiddenDay(o)&&(o=this.skipHiddenDays(o,n),o=ys(o));function A(){o=u.startOf(e,p),w=u.add(o,r),T={start:o,end:w}}return A(),this.trimHiddenDays(T)||(e=this.skipHiddenDays(e,n),A()),T}buildRangeFromDayCount(e,n,r){let{dateEnv:c,dateAlignment:u}=this.props,p=0,o=e,w;u&&(o=c.startOf(o,u)),o=ys(o),o=this.skipHiddenDays(o,n),w=o;do w=za(w,1),this.isHiddenDay(w)||(p+=1);while(p<r);return{start:o,end:w}}buildCustomVisibleRange(e){let{props:n}=this,r=n.visibleRangeInput,c=typeof r=="function"?r.call(n.calendarApi,n.dateEnv.toDate(e)):r,u=this.refineRange(c);return u&&(u.start==null||u.end==null)?null:u}buildRenderRange(e,n,r){return e}buildDateIncrement(e){let{dateIncrement:n}=this.props,r;return n||((r=this.props.dateAlignment)?so(1,r):e||so({days:1}))}refineRange(e){if(e){let n=k1e(e,this.props.dateEnv);return n&&(n=t8(n)),n}return null}initHiddenDays(){let e=this.props.hiddenDays||[],n=[],r=0,c;for(this.props.weekends===!1&&e.push(0,6),c=0;c<7;c+=1)(n[c]=e.indexOf(c)!==-1)||(r+=1);if(!r)throw new Error("invalid hiddenDays");this.isHiddenDayHash=n}trimHiddenDays(e){let{start:n,end:r}=e;return n&&(n=this.skipHiddenDays(n)),r&&(r=this.skipHiddenDays(r,-1,!0)),n==null||r==null||n<r?{start:n,end:r}:null}isHiddenDay(e){return e instanceof Date&&(e=e.getUTCDay()),this.isHiddenDayHash[e]}skipHiddenDays(e,n=1,r=!1){for(;this.isHiddenDayHash[(e.getUTCDay()+(r?n:0)+7)%7];)e=za(e,n);return e}}function SA(t,e,n,r){return{instanceId:Eg(),defId:t,range:e,forcedStartTzo:n??null,forcedEndTzo:r??null}}function D1e(t,e,n,r){for(let c=0;c<r.length;c+=1){let u=r[c].parse(t,n);if(u){let{allDay:p}=t;return p==null&&(p=e,p==null&&(p=u.allDayGuess,p==null&&(p=!1))),{allDay:p,duration:u.duration,typeData:u.typeData,typeId:c}}}return null}function bg(t,e,n){let{dateEnv:r,pluginHooks:c,options:u}=n,{defs:p,instances:o}=t;o=yg(o,w=>!p[w.defId].recurringDef);for(let w in p){let T=p[w];if(T.recurringDef){let{duration:A}=T.recurringDef;A||(A=T.allDay?u.defaultAllDayEventDuration:u.defaultTimedEventDuration);let D=O1e(T,A,e,r,c.recurringTypes);for(let B of D){let N=SA(w,{start:B,end:r.add(B,A)});o[N.instanceId]=N}}}return{defs:p,instances:o}}function O1e(t,e,n,r,c){let p=c[t.recurringDef.typeId].expand(t.recurringDef.typeData,{start:r.subtract(n.start,e),end:n.end},r);return t.allDay&&(p=p.map(ys)),p}const cw={id:String,groupId:String,title:String,url:String,interactive:Boolean},i8={start:qt,end:qt,date:qt,allDay:Boolean},L1e=Object.assign(Object.assign(Object.assign({},cw),i8),{extendedProps:qt});function r8(t,e,n,r,c=CA(n),u,p){let{refined:o,extra:w}=o8(t,n,c),T=B1e(e,n),A=D1e(o,T,n.dateEnv,n.pluginHooks.recurringTypes);if(A){let B=ME(o,w,e?e.sourceId:"",A.allDay,!!A.duration,n,u);return B.recurringDef={typeId:A.typeId,typeData:A.typeData,duration:A.duration},{def:B,instance:null}}let D=z1e(o,T,n,r);if(D){let B=ME(o,w,e?e.sourceId:"",D.allDay,D.hasEnd,n,u),N=SA(B.defId,D.range,D.forcedStartTzo,D.forcedEndTzo);return p&&B.publicId&&p[B.publicId]&&(N.instanceId=p[B.publicId]),{def:B,instance:N}}return null}function o8(t,e,n=CA(e)){return yA(t,n)}function CA(t){return Object.assign(Object.assign(Object.assign({},nS),L1e),t.pluginHooks.eventRefiners)}function ME(t,e,n,r,c,u,p){let o={title:t.title||"",groupId:t.groupId||"",publicId:t.id||"",url:t.url||"",recurringDef:null,defId:(p&&t.id?p[t.id]:"")||Eg(),sourceId:n,allDay:r,hasEnd:c,interactive:t.interactive,ui:iS(t,u),extendedProps:Object.assign(Object.assign({},t.extendedProps||{}),e)};for(let w of u.pluginHooks.eventDefMemberAdders)Object.assign(o,w(t));return Object.freeze(o.ui.classNames),Object.freeze(o.extendedProps),o}function z1e(t,e,n,r){let{allDay:c}=t,u,p=null,o=!1,w,T=null,A=t.start!=null?t.start:t.date;if(u=n.dateEnv.createMarkerMeta(A),u)p=u.marker;else if(!r)return null;return t.end!=null&&(w=n.dateEnv.createMarkerMeta(t.end)),c==null&&(e!=null?c=e:c=(!u||u.isTimeUnspecified)&&(!w||w.isTimeUnspecified)),c&&p&&(p=ys(p)),w&&(T=w.marker,c&&(T=ys(T)),p&&T<=p&&(T=null)),T?o=!0:r||(o=n.options.forceEventDuration||!1,T=n.dateEnv.add(p,c?n.options.defaultAllDayEventDuration:n.options.defaultTimedEventDuration)),{allDay:c,hasEnd:o,range:{start:p,end:T},forcedStartTzo:u?u.forcedTzo:null,forcedEndTzo:w?w.forcedTzo:null}}function B1e(t,e){let n=null;return t&&(n=t.defaultAllDay),n==null&&(n=e.options.defaultAllDay),n}function w0(t,e,n,r,c,u){let p=Fc(),o=CA(n);for(let w of t){let T=r8(w,e,n,r,o,c,u);T&&DE(T,p)}return p}function DE(t,e=Fc()){return e.defs[t.def.defId]=t.def,t.instance&&(e.instances[t.instance.instanceId]=t.instance),e}function TA(t,e){let n=t.instances[e];if(n){let r=t.defs[n.defId],c=qS(t,u=>F1e(r,u));return c.defs[r.defId]=r,c.instances[n.instanceId]=n,c}return Fc()}function F1e(t,e){return!!(t.groupId&&t.groupId===e.groupId)}function Fc(){return{defs:{},instances:{}}}function EA(t,e){return{defs:Object.assign(Object.assign({},t.defs),e.defs),instances:Object.assign(Object.assign({},t.instances),e.instances)}}function qS(t,e){let n=yg(t.defs,e),r=yg(t.instances,c=>n[c.defId]);return{defs:n,instances:r}}function N1e(t,e){let{defs:n,instances:r}=t,c={},u={};for(let p in n)e.defs[p]||(c[p]=n[p]);for(let p in r)!e.instances[p]&&c[r[p].defId]&&(u[p]=r[p]);return{defs:c,instances:u}}function V1e(t,e){return Array.isArray(t)?w0(t,null,e,!0):typeof t=="object"&&t?w0([t],null,e,!0):t!=null?String(t):null}function qL(t){return Array.isArray(t)?t:typeof t=="string"?t.split(/\s+/):[]}const nS={display:String,editable:Boolean,startEditable:Boolean,durationEditable:Boolean,constraint:qt,overlap:qt,allow:qt,className:qL,classNames:qL,color:String,backgroundColor:String,borderColor:String,textColor:String},$1e={display:null,startEditable:null,durationEditable:null,constraints:[],overlap:null,allows:[],backgroundColor:"",borderColor:"",textColor:"",classNames:[]};function iS(t,e){let n=V1e(t.constraint,e);return{display:t.display||null,startEditable:t.startEditable!=null?t.startEditable:t.editable,durationEditable:t.durationEditable!=null?t.durationEditable:t.editable,constraints:n!=null?[n]:[],overlap:t.overlap!=null?t.overlap:null,allows:t.allow!=null?[t.allow]:[],backgroundColor:t.backgroundColor||t.color||"",borderColor:t.borderColor||t.color||"",textColor:t.textColor||"",classNames:(t.className||[]).concat(t.classNames||[])}}function s8(t){return t.reduce(j1e,$1e)}function j1e(t,e){return{display:e.display!=null?e.display:t.display,startEditable:e.startEditable!=null?e.startEditable:t.startEditable,durationEditable:e.durationEditable!=null?e.durationEditable:t.durationEditable,constraints:t.constraints.concat(e.constraints),overlap:typeof e.overlap=="boolean"?e.overlap:t.overlap,allows:t.allows.concat(e.allows),backgroundColor:e.backgroundColor||t.backgroundColor,borderColor:e.borderColor||t.borderColor,textColor:e.textColor||t.textColor,classNames:t.classNames.concat(e.classNames)}}const U1e={id:String,defaultAllDay:Boolean,url:String,format:String,events:qt,eventDataTransform:qt,success:qt,failure:qt};function a8(t,e,n=l8(e)){let r;if(typeof t=="string"?r={url:t}:typeof t=="function"||Array.isArray(t)?r={events:t}:typeof t=="object"&&t&&(r=t),r){let{refined:c,extra:u}=yA(r,n),p=H1e(c,e);if(p)return{_raw:t,isFetching:!1,latestFetchId:"",fetchRange:null,defaultAllDay:c.defaultAllDay,eventDataTransform:c.eventDataTransform,success:c.success,failure:c.failure,publicId:c.id||"",sourceId:Eg(),sourceDefId:p.sourceDefId,meta:p.meta,ui:iS(c,e),extendedProps:u}}return null}function l8(t){return Object.assign(Object.assign(Object.assign({},nS),U1e),t.pluginHooks.eventSourceRefiners)}function H1e(t,e){let n=e.pluginHooks.eventSourceDefs;for(let r=n.length-1;r>=0;r-=1){let u=n[r].parseMeta(t);if(u)return{sourceDefId:r,meta:u}}return null}function G1e(t,e,n,r,c){switch(e.type){case"RECEIVE_EVENTS":return W1e(t,n[e.sourceId],e.fetchId,e.fetchRange,e.rawEvents,c);case"RESET_RAW_EVENTS":return q1e(t,n[e.sourceId],e.rawEvents,r.activeRange,c);case"ADD_EVENTS":return Z1e(t,e.eventStore,r?r.activeRange:null,c);case"RESET_EVENTS":return e.eventStore;case"MERGE_EVENTS":return EA(t,e.eventStore);case"PREV":case"NEXT":case"CHANGE_DATE":case"CHANGE_VIEW_TYPE":return r?bg(t,r.activeRange,c):t;case"REMOVE_EVENTS":return N1e(t,e.eventStore);case"REMOVE_EVENT_SOURCE":return u8(t,e.sourceId);case"REMOVE_ALL_EVENT_SOURCES":return qS(t,u=>!u.sourceId);case"REMOVE_ALL_EVENTS":return Fc();default:return t}}function W1e(t,e,n,r,c,u){if(e&&n===e.latestFetchId){let p=w0(c8(c,e,u),e,u);return r&&(p=bg(p,r,u)),EA(u8(t,e.sourceId),p)}return t}function q1e(t,e,n,r,c){const{defIdMap:u,instanceIdMap:p}=X1e(t);let o=w0(c8(n,e,c),e,c,!1,u,p);return bg(o,r,c)}function c8(t,e,n){let r=n.options.eventDataTransform,c=e?e.eventDataTransform:null;return c&&(t=ZL(t,c)),r&&(t=ZL(t,r)),t}function ZL(t,e){let n;if(!e)n=t;else{n=[];for(let r of t){let c=e(r);c?n.push(c):c==null&&n.push(r)}}return n}function Z1e(t,e,n,r){return n&&(e=bg(e,n,r)),EA(t,e)}function KL(t,e,n){let{defs:r}=t,c=lf(t.instances,u=>r[u.defId].allDay?u:Object.assign(Object.assign({},u),{range:{start:n.createMarker(e.toDate(u.range.start,u.forcedStartTzo)),end:n.createMarker(e.toDate(u.range.end,u.forcedEndTzo))},forcedStartTzo:n.canComputeOffset?null:u.forcedStartTzo,forcedEndTzo:n.canComputeOffset?null:u.forcedEndTzo}));return{defs:r,instances:c}}function u8(t,e){return qS(t,n=>n.sourceId!==e)}function K1e(t,e){return{defs:t.defs,instances:yg(t.instances,n=>!e[n.instanceId])}}function X1e(t){const{defs:e,instances:n}=t,r={},c={};for(let u in e){const p=e[u],{publicId:o}=p;o&&(r[o]=u)}for(let u in n){const p=n[u],o=e[p.defId],{publicId:w}=o;w&&(c[w]=u)}return{defIdMap:r,instanceIdMap:c}}class ZS{constructor(){this.handlers={},this.thisContext=null}setThisContext(e){this.thisContext=e}setOptions(e){this.options=e}on(e,n){Y1e(this.handlers,e,n)}off(e,n){J1e(this.handlers,e,n)}trigger(e,...n){let r=this.handlers[e]||[],c=this.options&&this.options[e],u=[].concat(c||[],r);for(let p of u)p.apply(this.thisContext,n)}hasHandlers(e){return!!(this.handlers[e]&&this.handlers[e].length||this.options&&this.options[e])}}function Y1e(t,e,n){(t[e]||(t[e]=[])).push(n)}function J1e(t,e,n){n?t[e]&&(t[e]=t[e].filter(r=>r!==n)):delete t[e]}const Q1e={startTime:"09:00",endTime:"17:00",daysOfWeek:[1,2,3,4,5],display:"inverse-background",classNames:"fc-non-business",groupId:"_businessHours"};function exe(t,e){return w0(txe(t),null,e)}function txe(t){let e;return t===!0?e=[{}]:Array.isArray(t)?e=t.filter(n=>n.daysOfWeek):typeof t=="object"&&t?e=[t]:e=[],e=e.map(n=>Object.assign(Object.assign({},Q1e),n)),e}function d8(t,e,n){n.emitter.trigger("select",Object.assign(Object.assign({},IA(t,n)),{jsEvent:e?e.origEvent:null,view:n.viewApi||n.calendarApi.view}))}function nxe(t,e){e.emitter.trigger("unselect",{jsEvent:t?t.origEvent:null,view:e.viewApi||e.calendarApi.view})}function IA(t,e){let n={};for(let r of e.pluginHooks.dateSpanTransforms)Object.assign(n,r(t,e));return Object.assign(n,gxe(t,e.dateEnv)),n}function XL(t,e,n){let{dateEnv:r,options:c}=n,u=e;return t?(u=ys(u),u=r.add(u,c.defaultAllDayEventDuration)):u=r.add(u,c.defaultTimedEventDuration),u}function AA(t,e,n,r){let c=rS(t.defs,e),u=Fc();for(let p in t.defs){let o=t.defs[p];u.defs[p]=ixe(o,c[p],n,r)}for(let p in t.instances){let o=t.instances[p],w=u.defs[o.defId];u.instances[p]=rxe(o,w,c[o.defId],n,r)}return u}function ixe(t,e,n,r){let c=n.standardProps||{};c.hasEnd==null&&e.durationEditable&&(n.startDelta||n.endDelta)&&(c.hasEnd=!0);let u=Object.assign(Object.assign(Object.assign({},t),c),{ui:Object.assign(Object.assign({},t.ui),c.ui)});n.extendedProps&&(u.extendedProps=Object.assign(Object.assign({},u.extendedProps),n.extendedProps));for(let p of r.pluginHooks.eventDefMutationAppliers)p(u,n,r);return!u.hasEnd&&r.options.forceEventDuration&&(u.hasEnd=!0),u}function rxe(t,e,n,r,c){let{dateEnv:u}=c,p=r.standardProps&&r.standardProps.allDay===!0,o=r.standardProps&&r.standardProps.hasEnd===!1,w=Object.assign({},t);return p&&(w.range=e8(w.range)),r.datesDelta&&n.startEditable&&(w.range={start:u.add(w.range.start,r.datesDelta),end:u.add(w.range.end,r.datesDelta)}),r.startDelta&&n.durationEditable&&(w.range={start:u.add(w.range.start,r.startDelta),end:w.range.end}),r.endDelta&&n.durationEditable&&(w.range={start:w.range.start,end:u.add(w.range.end,r.endDelta)}),o&&(w.range={start:w.range.start,end:XL(e.allDay,w.range.start,c)}),e.allDay&&(w.range={start:ys(w.range.start),end:ys(w.range.end)}),w.range.end<w.range.start&&(w.range.end=XL(e.allDay,w.range.start,c)),w}class P_{constructor(e,n){this.context=e,this.internalEventSource=n}remove(){this.context.dispatch({type:"REMOVE_EVENT_SOURCE",sourceId:this.internalEventSource.sourceId})}refetch(){this.context.dispatch({type:"FETCH_EVENT_SOURCES",sourceIds:[this.internalEventSource.sourceId],isRefetch:!0})}get id(){return this.internalEventSource.publicId}get url(){return this.internalEventSource.meta.url}get format(){return this.internalEventSource.meta.format}}class Bs{constructor(e,n,r){this._context=e,this._def=n,this._instance=r||null}setProp(e,n){if(e in i8)console.warn("Could not set date-related prop 'name'. Use one of the date-related methods instead.");else if(e==="id")n=cw[e](n),this.mutate({standardProps:{publicId:n}});else if(e in cw)n=cw[e](n),this.mutate({standardProps:{[e]:n}});else if(e in nS){let r=nS[e](n);e==="color"?r={backgroundColor:n,borderColor:n}:e==="editable"?r={startEditable:n,durationEditable:n}:r={[e]:n},this.mutate({standardProps:{ui:r}})}else console.warn(`Could not set prop '${e}'. Use setExtendedProp instead.`)}setExtendedProp(e,n){this.mutate({extendedProps:{[e]:n}})}setStart(e,n={}){let{dateEnv:r}=this._context,c=r.createMarker(e);if(c&&this._instance){let u=this._instance.range,p=L_(u.start,c,r,n.granularity);n.maintainDuration?this.mutate({datesDelta:p}):this.mutate({startDelta:p})}}setEnd(e,n={}){let{dateEnv:r}=this._context,c;if(!(e!=null&&(c=r.createMarker(e),!c))&&this._instance)if(c){let u=L_(this._instance.range.end,c,r,n.granularity);this.mutate({endDelta:u})}else this.mutate({standardProps:{hasEnd:!1}})}setDates(e,n,r={}){let{dateEnv:c}=this._context,u={allDay:r.allDay},p=c.createMarker(e),o;if(p&&!(n!=null&&(o=c.createMarker(n),!o))&&this._instance){let w=this._instance.range;r.allDay===!0&&(w=e8(w));let T=L_(w.start,p,c,r.granularity);if(o){let A=L_(w.end,o,c,r.granularity);k0e(T,A)?this.mutate({datesDelta:T,standardProps:u}):this.mutate({startDelta:T,endDelta:A,standardProps:u})}else u.hasEnd=!1,this.mutate({datesDelta:T,standardProps:u})}}moveStart(e){let n=so(e);n&&this.mutate({startDelta:n})}moveEnd(e){let n=so(e);n&&this.mutate({endDelta:n})}moveDates(e){let n=so(e);n&&this.mutate({datesDelta:n})}setAllDay(e,n={}){let r={allDay:e},{maintainDuration:c}=n;c==null&&(c=this._context.options.allDayMaintainDuration),this._def.allDay!==e&&(r.hasEnd=c),this.mutate({standardProps:r})}formatRange(e){let{dateEnv:n}=this._context,r=this._instance,c=qs(e);return this._def.hasEnd?n.formatRange(r.range.start,r.range.end,c,{forcedStartTzo:r.forcedStartTzo,forcedEndTzo:r.forcedEndTzo}):n.format(r.range.start,c,{forcedTzo:r.forcedStartTzo})}mutate(e){let n=this._instance;if(n){let r=this._def,c=this._context,{eventStore:u}=c.getCurrentData(),p=TA(u,n.instanceId);p=AA(p,{"":{display:"",startEditable:!0,durationEditable:!0,constraints:[],overlap:null,allows:[],backgroundColor:"",borderColor:"",textColor:"",classNames:[]}},e,c);let w=new Bs(c,r,n);this._def=p.defs[r.defId],this._instance=p.instances[n.instanceId],c.dispatch({type:"MERGE_EVENTS",eventStore:p}),c.emitter.trigger("eventChange",{oldEvent:w,event:this,relatedEvents:ug(p,c,n),revert(){c.dispatch({type:"RESET_EVENTS",eventStore:u})}})}}remove(){let e=this._context,n=h8(this);e.dispatch({type:"REMOVE_EVENTS",eventStore:n}),e.emitter.trigger("eventRemove",{event:this,relatedEvents:[],revert(){e.dispatch({type:"MERGE_EVENTS",eventStore:n})}})}get source(){let{sourceId:e}=this._def;return e?new P_(this._context,this._context.getCurrentData().eventSources[e]):null}get start(){return this._instance?this._context.dateEnv.toDate(this._instance.range.start):null}get end(){return this._instance&&this._def.hasEnd?this._context.dateEnv.toDate(this._instance.range.end):null}get startStr(){let e=this._instance;return e?this._context.dateEnv.formatIso(e.range.start,{omitTime:this._def.allDay,forcedTzo:e.forcedStartTzo}):""}get endStr(){let e=this._instance;return e&&this._def.hasEnd?this._context.dateEnv.formatIso(e.range.end,{omitTime:this._def.allDay,forcedTzo:e.forcedEndTzo}):""}get id(){return this._def.publicId}get groupId(){return this._def.groupId}get allDay(){return this._def.allDay}get title(){return this._def.title}get url(){return this._def.url}get display(){return this._def.ui.display||"auto"}get startEditable(){return this._def.ui.startEditable}get durationEditable(){return this._def.ui.durationEditable}get constraint(){return this._def.ui.constraints[0]||null}get overlap(){return this._def.ui.overlap}get allow(){return this._def.ui.allows[0]||null}get backgroundColor(){return this._def.ui.backgroundColor}get borderColor(){return this._def.ui.borderColor}get textColor(){return this._def.ui.textColor}get classNames(){return this._def.ui.classNames}get extendedProps(){return this._def.extendedProps}toPlainObject(e={}){let n=this._def,{ui:r}=n,{startStr:c,endStr:u}=this,p={allDay:n.allDay};return n.title&&(p.title=n.title),c&&(p.start=c),u&&(p.end=u),n.publicId&&(p.id=n.publicId),n.groupId&&(p.groupId=n.groupId),n.url&&(p.url=n.url),r.display&&r.display!=="auto"&&(p.display=r.display),e.collapseColor&&r.backgroundColor&&r.backgroundColor===r.borderColor?p.color=r.backgroundColor:(r.backgroundColor&&(p.backgroundColor=r.backgroundColor),r.borderColor&&(p.borderColor=r.borderColor)),r.textColor&&(p.textColor=r.textColor),r.classNames.length&&(p.classNames=r.classNames),Object.keys(n.extendedProps).length&&(e.collapseExtendedProps?Object.assign(p,n.extendedProps):p.extendedProps=n.extendedProps),p}toJSON(){return this.toPlainObject()}}function h8(t){let e=t._def,n=t._instance;return{defs:{[e.defId]:e},instances:n?{[n.instanceId]:n}:{}}}function ug(t,e,n){let{defs:r,instances:c}=t,u=[],p=n?n.instanceId:"";for(let o in c){let w=c[o],T=r[w.defId];w.instanceId!==p&&u.push(new Bs(e,T,w))}return u}function YL(t,e,n,r){let c={},u={},p={},o=[],w=[],T=rS(t.defs,e);for(let A in t.defs){let D=t.defs[A];T[D.defId].display==="inverse-background"&&(D.groupId?(c[D.groupId]=[],p[D.groupId]||(p[D.groupId]=D)):u[A]=[])}for(let A in t.instances){let D=t.instances[A],B=t.defs[D.defId],N=T[B.defId],ee=D.range,Q=!B.allDay&&r?t8(ee,r):ee,se=vg(Q,n);se&&(N.display==="inverse-background"?B.groupId?c[B.groupId].push(se):u[D.defId].push(se):N.display!=="none"&&(N.display==="background"?o:w).push({def:B,ui:N,instance:D,range:se,isStart:Q.start&&Q.start.valueOf()===se.start.valueOf(),isEnd:Q.end&&Q.end.valueOf()===se.end.valueOf()}))}for(let A in c){let D=c[A],B=WL(D,n);for(let N of B){let ee=p[A],Q=T[ee.defId];o.push({def:ee,ui:Q,instance:null,range:N,isStart:!1,isEnd:!1})}}for(let A in u){let D=u[A],B=WL(D,n);for(let N of B)o.push({def:t.defs[A],ui:T[A],instance:null,range:N,isStart:!1,isEnd:!1})}return{bg:o,fg:w}}function oxe(t){return t.ui.display==="background"||t.ui.display==="inverse-background"}function JL(t,e){t.fcSeg=e}function uy(t){return t.fcSeg||t.parentNode.fcSeg||null}function rS(t,e){return lf(t,n=>f8(n,e))}function f8(t,e){let n=[];return e[""]&&n.push(e[""]),e[t.defId]&&n.push(e[t.defId]),n.push(t.ui),s8(n)}function p8(t,e){let n=t.map(sxe);return n.sort((r,c)=>w0e(r,c,e)),n.map(r=>r._seg)}function sxe(t){let{eventRange:e}=t,n=e.def,r=e.instance?e.instance.range:e.range,c=r.start?r.start.valueOf():0,u=r.end?r.end.valueOf():0;return Object.assign(Object.assign(Object.assign({},n.extendedProps),n),{id:n.publicId,start:c,end:u,duration:u-c,allDay:Number(n.allDay),_seg:t})}function axe(t,e){let{pluginHooks:n}=e,r=n.isDraggableTransformers,{def:c,ui:u}=t.eventRange,p=u.startEditable;for(let o of r)p=o(p,c,u,e);return p}function lxe(t,e){return t.isStart&&t.eventRange.ui.durationEditable&&e.options.eventResizableFromStart}function cxe(t,e){return t.isEnd&&t.eventRange.ui.durationEditable}function m8(t,e,n,r,c,u,p){let{dateEnv:o,options:w}=n,{displayEventTime:T,displayEventEnd:A}=w,D=t.eventRange.def,B=t.eventRange.instance;T==null&&(T=r!==!1),A==null&&(A=c!==!1);let N=B.range.start,ee=B.range.end,Q=t.start||t.eventRange.range.start,se=t.end||t.eventRange.range.end,ce=ys(N).valueOf()===ys(Q).valueOf(),be=ys(Up(ee,-1)).valueOf()===ys(Up(se,-1)).valueOf();return T&&!D.allDay&&(ce||be)?(Q=ce?N:Q,se=be?ee:se,A&&D.hasEnd?o.formatRange(Q,se,e,{forcedStartTzo:B.forcedStartTzo,forcedEndTzo:B.forcedEndTzo}):o.format(Q,e,{forcedTzo:B.forcedStartTzo})):""}function zp(t,e,n){let r=t.eventRange.range;return{isPast:r.end<=(n||e.start),isFuture:r.start>=(n||e.end),isToday:e&&nf(e,r.start)}}function uxe(t){let e=["fc-event"];return t.isMirror&&e.push("fc-event-mirror"),t.isDraggable&&e.push("fc-event-draggable"),(t.isStartResizable||t.isEndResizable)&&e.push("fc-event-resizable"),t.isDragging&&e.push("fc-event-dragging"),t.isResizing&&e.push("fc-event-resizing"),t.isSelected&&e.push("fc-event-selected"),t.isStart&&e.push("fc-event-start"),t.isEnd&&e.push("fc-event-end"),t.isPast&&e.push("fc-event-past"),t.isToday&&e.push("fc-event-today"),t.isFuture&&e.push("fc-event-future"),e}function g8(t){return t.instance?t.instance.instanceId:`${t.def.defId}:${t.range.start.toISOString()}`}function _8(t,e){let{def:n,instance:r}=t.eventRange,{url:c}=n;if(c)return{href:c};let{emitter:u,options:p}=e,{eventInteractive:o}=p;return o==null&&(o=n.interactive,o==null&&(o=!!u.hasHandlers("eventClick"))),o?GN(w=>{u.trigger("eventClick",{el:w.target,event:new Bs(e,n,r),jsEvent:w,view:e.viewApi})}):{}}const dxe={start:qt,end:qt,allDay:Boolean};function hxe(t,e,n){let r=fxe(t,e),{range:c}=r;if(!c.start)return null;if(!c.end){if(n==null)return null;c.end=e.add(c.start,n)}return r}function fxe(t,e){let{refined:n,extra:r}=yA(t,dxe),c=n.start?e.createMarkerMeta(n.start):null,u=n.end?e.createMarkerMeta(n.end):null,{allDay:p}=n;return p==null&&(p=c&&c.isTimeUnspecified&&(!u||u.isTimeUnspecified)),Object.assign({range:{start:c?c.marker:null,end:u?u.marker:null},allDay:p},r)}function pxe(t,e){return P1e(t.range,e.range)&&t.allDay===e.allDay&&mxe(t,e)}function mxe(t,e){for(let n in e)if(n!=="range"&&n!=="allDay"&&t[n]!==e[n])return!1;for(let n in t)if(!(n in e))return!1;return!0}function gxe(t,e){return Object.assign(Object.assign({},v8(t.range,e,t.allDay)),{allDay:t.allDay})}function y8(t,e,n){return Object.assign(Object.assign({},v8(t,e,n)),{timeZone:e.timeZone})}function v8(t,e,n){return{start:e.toDate(t.start),end:e.toDate(t.end),startStr:e.formatIso(t.start,{omitTime:n}),endStr:e.formatIso(t.end,{omitTime:n})}}function _xe(t,e,n){let r=o8({editable:!1},n),c=ME(r.refined,r.extra,"",t.allDay,!0,n);return{def:c,ui:f8(c,e),instance:SA(c.defId,t.range),range:t.range,isStart:!0,isEnd:!0}}function yxe(t,e,n){let r=!1,c=function(o){r||(r=!0,e(o))},u=function(o){r||(r=!0,n(o))},p=t(c,u);p&&typeof p.then=="function"&&p.then(c,u)}class QL extends Error{constructor(e,n){super(e),this.response=n}}function vxe(t,e,n){t=t.toUpperCase();const r={method:t};return t==="GET"?e+=(e.indexOf("?")===-1?"?":"&")+new URLSearchParams(n):(r.body=new URLSearchParams(n),r.headers={"Content-Type":"application/x-www-form-urlencoded"}),fetch(e,r).then(c=>{if(c.ok)return c.json().then(u=>[u,c],()=>{throw new QL("Failure parsing JSON",c)});throw new QL("Request failed",c)})}let bT;function b8(){return bT==null&&(bT=bxe()),bT}function bxe(){if(typeof document>"u")return!0;let t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.innerHTML="<table><tr><td><div></div></td></tr></table>",t.querySelector("table").style.height="100px",t.querySelector("div").style.height="100%",document.body.appendChild(t);let n=t.querySelector("div").offsetHeight>0;return document.body.removeChild(t),n}class xxe extends Vo{constructor(){super(...arguments),this.state={forPrint:!1},this.handleBeforePrint=()=>{eS(()=>{this.setState({forPrint:!0})})},this.handleAfterPrint=()=>{eS(()=>{this.setState({forPrint:!1})})}}render(){let{props:e}=this,{options:n}=e,{forPrint:r}=this.state,c=r||n.height==="auto"||n.contentHeight==="auto",u=!c&&n.height!=null?n.height:"",p=["fc",r?"fc-media-print":"fc-media-screen",`fc-direction-${n.direction}`,e.theme.getClass("root")];return b8()||p.push("fc-liquid-hack"),e.children(p,u,c,r)}componentDidMount(){let{emitter:e}=this.props;e.on("_beforeprint",this.handleBeforePrint),e.on("_afterprint",this.handleAfterPrint)}componentWillUnmount(){let{emitter:e}=this.props;e.off("_beforeprint",this.handleBeforePrint),e.off("_afterprint",this.handleAfterPrint)}}class vy{constructor(e){this.component=e.component,this.isHitComboAllowed=e.isHitComboAllowed||null}destroy(){}}function wxe(t,e){return{component:t,el:e.el,useEventCenter:e.useEventCenter!=null?e.useEventCenter:!0,isHitComboAllowed:e.isHitComboAllowed||null}}function kA(t){return{[t.component.uid]:t}}const OE={};class by extends Bc{constructor(e,n){super(e,n),this.handleRefresh=()=>{let r=this.computeTiming();r.state.nowDate.valueOf()!==this.state.nowDate.valueOf()&&this.setState(r.state),this.clearTimeout(),this.setTimeout(r.waitMs)},this.handleVisibilityChange=()=>{document.hidden||this.handleRefresh()},this.state=this.computeTiming().state}render(){let{props:e,state:n}=this;return e.children(n.nowDate,n.todayRange)}componentDidMount(){this.setTimeout(),this.context.nowManager.addResetListener(this.handleRefresh),document.addEventListener("visibilitychange",this.handleVisibilityChange)}componentDidUpdate(e){e.unit!==this.props.unit&&(this.clearTimeout(),this.setTimeout())}componentWillUnmount(){this.clearTimeout(),this.context.nowManager.removeResetListener(this.handleRefresh),document.removeEventListener("visibilitychange",this.handleVisibilityChange)}computeTiming(){let{props:e,context:n}=this,r=n.nowManager.getDateMarker(),{nowIndicatorSnap:c}=n.options;c==="auto"&&(c=/year|month|week|day/.test(e.unit)||(e.unitValue||1)===1);let u,p;return c?(u=n.dateEnv.startOf(r,e.unit),p=n.dateEnv.add(u,so(1,e.unit)).valueOf()-r.valueOf()):(u=r,p=1e3*60),p=Math.min(1e3*60*60*24,p),{state:{nowDate:u,todayRange:Sxe(u)},waitMs:p}}setTimeout(e=this.computeTiming().waitMs){this.timeoutId=setTimeout(()=>{const n=this.computeTiming();this.setState(n.state,()=>{this.setTimeout(n.waitMs)})},e)}clearTimeout(){this.timeoutId&&clearTimeout(this.timeoutId)}}by.contextType=ff;function Sxe(t){let e=ys(t),n=za(e,1);return{start:e,end:n}}class Cxe{getCurrentData(){return this.currentDataManager.getCurrentData()}dispatch(e){this.currentDataManager.dispatch(e)}get view(){return this.getCurrentData().viewApi}batchRendering(e){e()}updateSize(){this.trigger("_resize",!0)}setOption(e,n){this.dispatch({type:"SET_OPTION",optionName:e,rawOptionValue:n})}getOption(e){return this.currentDataManager.currentCalendarOptionsInput[e]}getAvailableLocaleCodes(){return Object.keys(this.getCurrentData().availableRawLocales)}on(e,n){let{currentDataManager:r}=this;r.currentCalendarOptionsRefiners[e]?r.emitter.on(e,n):console.warn(`Unknown listener name '${e}'`)}off(e,n){this.currentDataManager.emitter.off(e,n)}trigger(e,...n){this.currentDataManager.emitter.trigger(e,...n)}changeView(e,n){this.batchRendering(()=>{if(this.unselect(),n)if(n.start&&n.end)this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e}),this.dispatch({type:"SET_OPTION",optionName:"visibleRange",rawOptionValue:n});else{let{dateEnv:r}=this.getCurrentData();this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e,dateMarker:r.createMarker(n)})}else this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e})})}zoomTo(e,n){let r=this.getCurrentData(),c;n=n||"day",c=r.viewSpecs[n]||this.getUnitViewSpec(n),this.unselect(),c?this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:c.type,dateMarker:e}):this.dispatch({type:"CHANGE_DATE",dateMarker:e})}getUnitViewSpec(e){let{viewSpecs:n,toolbarConfig:r}=this.getCurrentData(),c=[].concat(r.header?r.header.viewsWithButtons:[],r.footer?r.footer.viewsWithButtons:[]),u,p;for(let o in n)c.push(o);for(u=0;u<c.length;u+=1)if(p=n[c[u]],p&&p.singleUnit===e)return p;return null}prev(){this.unselect(),this.dispatch({type:"PREV"})}next(){this.unselect(),this.dispatch({type:"NEXT"})}prevYear(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.dateEnv.addYears(e.currentDate,-1)})}nextYear(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.dateEnv.addYears(e.currentDate,1)})}today(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.nowManager.getDateMarker()})}gotoDate(e){let n=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:n.dateEnv.createMarker(e)})}incrementDate(e){let n=this.getCurrentData(),r=so(e);r&&(this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:n.dateEnv.add(n.currentDate,r)}))}getDate(){let e=this.getCurrentData();return e.dateEnv.toDate(e.currentDate)}formatDate(e,n){let{dateEnv:r}=this.getCurrentData();return r.format(r.createMarker(e),qs(n))}formatRange(e,n,r){let{dateEnv:c}=this.getCurrentData();return c.formatRange(c.createMarker(e),c.createMarker(n),qs(r),r)}formatIso(e,n){let{dateEnv:r}=this.getCurrentData();return r.formatIso(r.createMarker(e),{omitTime:n})}select(e,n){let r;n==null?e.start!=null?r=e:r={start:e,end:null}:r={start:e,end:n};let c=this.getCurrentData(),u=hxe(r,c.dateEnv,so({days:1}));u&&(this.dispatch({type:"SELECT_DATES",selection:u}),d8(u,null,c))}unselect(e){let n=this.getCurrentData();n.dateSelection&&(this.dispatch({type:"UNSELECT_DATES"}),nxe(e,n))}addEvent(e,n){if(e instanceof Bs){let p=e._def,o=e._instance;return this.getCurrentData().eventStore.defs[p.defId]||(this.dispatch({type:"ADD_EVENTS",eventStore:DE({def:p,instance:o})}),this.triggerEventAdd(e)),e}let r=this.getCurrentData(),c;if(n instanceof P_)c=n.internalEventSource;else if(typeof n=="boolean")n&&([c]=bA(r.eventSources));else if(n!=null){let p=this.getEventSourceById(n);if(!p)return console.warn(`Could not find an event source with ID "${n}"`),null;c=p.internalEventSource}let u=r8(e,c,r,!1);if(u){let p=new Bs(r,u.def,u.def.recurringDef?null:u.instance);return this.dispatch({type:"ADD_EVENTS",eventStore:DE(u)}),this.triggerEventAdd(p),p}return null}triggerEventAdd(e){let{emitter:n}=this.getCurrentData();n.trigger("eventAdd",{event:e,relatedEvents:[],revert:()=>{this.dispatch({type:"REMOVE_EVENTS",eventStore:h8(e)})}})}getEventById(e){let n=this.getCurrentData(),{defs:r,instances:c}=n.eventStore;e=String(e);for(let u in r){let p=r[u];if(p.publicId===e){if(p.recurringDef)return new Bs(n,p,null);for(let o in c){let w=c[o];if(w.defId===p.defId)return new Bs(n,p,w)}}}return null}getEvents(){let e=this.getCurrentData();return ug(e.eventStore,e)}removeAllEvents(){this.dispatch({type:"REMOVE_ALL_EVENTS"})}getEventSources(){let e=this.getCurrentData(),n=e.eventSources,r=[];for(let c in n)r.push(new P_(e,n[c]));return r}getEventSourceById(e){let n=this.getCurrentData(),r=n.eventSources;e=String(e);for(let c in r)if(r[c].publicId===e)return new P_(n,r[c]);return null}addEventSource(e){let n=this.getCurrentData();if(e instanceof P_)return n.eventSources[e.internalEventSource.sourceId]||this.dispatch({type:"ADD_EVENT_SOURCES",sources:[e.internalEventSource]}),e;let r=a8(e,n);return r?(this.dispatch({type:"ADD_EVENT_SOURCES",sources:[r]}),new P_(n,r)):null}removeAllEventSources(){this.dispatch({type:"REMOVE_ALL_EVENT_SOURCES"})}refetchEvents(){this.dispatch({type:"FETCH_EVENT_SOURCES",isRefetch:!0})}scrollToTime(e){let n=so(e);n&&this.trigger("_scrollRequest",{time:n})}}function Txe(t,e){return t.left>=e.left&&t.left<e.right&&t.top>=e.top&&t.top<e.bottom}function x8(t,e){let n={left:Math.max(t.left,e.left),right:Math.min(t.right,e.right),top:Math.max(t.top,e.top),bottom:Math.min(t.bottom,e.bottom)};return n.left<n.right&&n.top<n.bottom?n:!1}function Exe(t,e){return{left:Math.min(Math.max(t.left,e.left),e.right),top:Math.min(Math.max(t.top,e.top),e.bottom)}}function Ixe(t){return{left:(t.left+t.right)/2,top:(t.top+t.bottom)/2}}function Axe(t,e){return{left:t.left-e.left,top:t.top-e.top}}const xT=Fc();class kxe{constructor(){this.getKeysForEventDefs=Xi(this._getKeysForEventDefs),this.splitDateSelection=Xi(this._splitDateSpan),this.splitEventStore=Xi(this._splitEventStore),this.splitIndividualUi=Xi(this._splitIndividualUi),this.splitEventDrag=Xi(this._splitInteraction),this.splitEventResize=Xi(this._splitInteraction),this.eventUiBuilders={}}splitProps(e){let n=this.getKeyInfo(e),r=this.getKeysForEventDefs(e.eventStore),c=this.splitDateSelection(e.dateSelection),u=this.splitIndividualUi(e.eventUiBases,r),p=this.splitEventStore(e.eventStore,r),o=this.splitEventDrag(e.eventDrag),w=this.splitEventResize(e.eventResize),T={};this.eventUiBuilders=lf(n,(A,D)=>this.eventUiBuilders[D]||Xi(Rxe));for(let A in n){let D=n[A],B=p[A]||xT,N=this.eventUiBuilders[A];T[A]={businessHours:D.businessHours||e.businessHours,dateSelection:c[A]||null,eventStore:B,eventUiBases:N(e.eventUiBases[""],D.ui,u[A]),eventSelection:B.instances[e.eventSelection]?e.eventSelection:"",eventDrag:o[A]||null,eventResize:w[A]||null}}return T}_splitDateSpan(e){let n={};if(e){let r=this.getKeysForDateSpan(e);for(let c of r)n[c]=e}return n}_getKeysForEventDefs(e){return lf(e.defs,n=>this.getKeysForEventDef(n))}_splitEventStore(e,n){let{defs:r,instances:c}=e,u={};for(let p in r)for(let o of n[p])u[o]||(u[o]=Fc()),u[o].defs[p]=r[p];for(let p in c){let o=c[p];for(let w of n[o.defId])u[w]&&(u[w].instances[p]=o)}return u}_splitIndividualUi(e,n){let r={};for(let c in e)if(c)for(let u of n[c])r[u]||(r[u]={}),r[u][c]=e[c];return r}_splitInteraction(e){let n={};if(e){let r=this._splitEventStore(e.affectedEvents,this._getKeysForEventDefs(e.affectedEvents)),c=this._getKeysForEventDefs(e.mutatedEvents),u=this._splitEventStore(e.mutatedEvents,c),p=o=>{n[o]||(n[o]={affectedEvents:r[o]||xT,mutatedEvents:u[o]||xT,isEvent:e.isEvent})};for(let o in r)p(o);for(let o in u)p(o)}return n}}function Rxe(t,e,n){let r=[];t&&r.push(t),e&&r.push(e);let c={"":s8(r)};return n&&Object.assign(c,n),c}function w8(t,e,n,r){return{dow:t.getUTCDay(),isDisabled:!!(r&&(!r.activeRange||!nf(r.activeRange,t))),isOther:!!(r&&!nf(r.currentRange,t)),isToday:!!(e&&nf(e,t)),isPast:!!(e&&t<e.start),isFuture:!!(e&&t>=e.end)}}function RA(t,e){let n=["fc-day",`fc-day-${O0e[t.dow]}`];return t.isDisabled?n.push("fc-day-disabled"):(t.isToday&&(n.push("fc-day-today"),n.push(e.getClass("today"))),t.isPast&&n.push("fc-day-past"),t.isFuture&&n.push("fc-day-future"),t.isOther&&n.push("fc-day-other")),n}const Pxe=qs({year:"numeric",month:"long",day:"numeric"}),Mxe=qs({week:"long"});function oS(t,e,n="day",r=!0){const{dateEnv:c,options:u,calendarApi:p}=t;let o=c.format(e,n==="week"?Mxe:Pxe);if(u.navLinks){let w=c.toDate(e);const T=A=>{let D=n==="day"?u.navLinkDayClick:n==="week"?u.navLinkWeekClick:null;typeof D=="function"?D.call(p,c.toDate(e),A):(typeof D=="string"&&(n=D),p.zoomTo(e,n))};return Object.assign({title:bb(u.navLinkHint,[o,w],o),"data-navlink":""},r?HN(T):{onClick:T})}return{"aria-label":o}}let wT=null;function Dxe(){return wT===null&&(wT=Oxe()),wT}function Oxe(){let t=document.createElement("div");vb(t,{position:"absolute",top:-1e3,left:0,border:0,padding:0,overflow:"scroll",direction:"rtl"}),t.innerHTML="<div></div>",document.body.appendChild(t);let n=t.firstChild.getBoundingClientRect().left>t.getBoundingClientRect().left;return hA(t),n}let ST;function Lxe(){return ST||(ST=zxe()),ST}function zxe(){let t=document.createElement("div");t.style.overflow="scroll",t.style.position="absolute",t.style.top="-9999px",t.style.left="-9999px",document.body.appendChild(t);let e=S8(t);return document.body.removeChild(t),e}function S8(t){return{x:t.offsetHeight-t.clientHeight,y:t.offsetWidth-t.clientWidth}}function Bxe(t,e=!1){let n=window.getComputedStyle(t),r=parseInt(n.borderLeftWidth,10)||0,c=parseInt(n.borderRightWidth,10)||0,u=parseInt(n.borderTopWidth,10)||0,p=parseInt(n.borderBottomWidth,10)||0,o=S8(t),w=o.y-r-c,T=o.x-u-p,A={borderLeft:r,borderRight:c,borderTop:u,borderBottom:p,scrollbarBottom:T,scrollbarLeft:0,scrollbarRight:0};return Dxe()&&n.direction==="rtl"?A.scrollbarLeft=w:A.scrollbarRight=w,e&&(A.paddingLeft=parseInt(n.paddingLeft,10)||0,A.paddingRight=parseInt(n.paddingRight,10)||0,A.paddingTop=parseInt(n.paddingTop,10)||0,A.paddingBottom=parseInt(n.paddingBottom,10)||0),A}function Fxe(t,e=!1,n){let r=PA(t),c=Bxe(t,e),u={left:r.left+c.borderLeft+c.scrollbarLeft,right:r.right-c.borderRight-c.scrollbarRight,top:r.top+c.borderTop,bottom:r.bottom-c.borderBottom-c.scrollbarBottom};return e&&(u.left+=c.paddingLeft,u.right-=c.paddingRight,u.top+=c.paddingTop,u.bottom-=c.paddingBottom),u}function PA(t){let e=t.getBoundingClientRect();return{left:e.left+window.scrollX,top:e.top+window.scrollY,right:e.right+window.scrollX,bottom:e.bottom+window.scrollY}}function Nxe(t){let e=C8(t),n=t.getBoundingClientRect();for(let r of e){let c=x8(n,r.getBoundingClientRect());if(c)n=c;else return null}return n}function C8(t){let e=[];for(;t instanceof HTMLElement;){let n=window.getComputedStyle(t);if(n.position==="fixed")break;/(auto|scroll)/.test(n.overflow+n.overflowY+n.overflowX)&&e.push(t),t=t.parentNode}return e}class dy{constructor(e,n,r,c){this.els=n;let u=this.originClientRect=e.getBoundingClientRect();r&&this.buildElHorizontals(u.left),c&&this.buildElVerticals(u.top)}buildElHorizontals(e){let n=[],r=[];for(let c of this.els){let u=c.getBoundingClientRect();n.push(u.left-e),r.push(u.right-e)}this.lefts=n,this.rights=r}buildElVerticals(e){let n=[],r=[];for(let c of this.els){let u=c.getBoundingClientRect();n.push(u.top-e),r.push(u.bottom-e)}this.tops=n,this.bottoms=r}leftToIndex(e){let{lefts:n,rights:r}=this,c=n.length,u;for(u=0;u<c;u+=1)if(e>=n[u]&&e<r[u])return u}topToIndex(e){let{tops:n,bottoms:r}=this,c=n.length,u;for(u=0;u<c;u+=1)if(e>=n[u]&&e<r[u])return u}getWidth(e){return this.rights[e]-this.lefts[e]}getHeight(e){return this.bottoms[e]-this.tops[e]}similarTo(e){return Lx(this.tops||[],e.tops||[])&&Lx(this.bottoms||[],e.bottoms||[])&&Lx(this.lefts||[],e.lefts||[])&&Lx(this.rights||[],e.rights||[])}}function Lx(t,e){const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(Math.round(t[r])!==Math.round(e[r]))return!1;return!0}class MA{getMaxScrollTop(){return this.getScrollHeight()-this.getClientHeight()}getMaxScrollLeft(){return this.getScrollWidth()-this.getClientWidth()}canScrollVertically(){return this.getMaxScrollTop()>0}canScrollHorizontally(){return this.getMaxScrollLeft()>0}canScrollUp(){return this.getScrollTop()>0}canScrollDown(){return this.getScrollTop()<this.getMaxScrollTop()}canScrollLeft(){return this.getScrollLeft()>0}canScrollRight(){return this.getScrollLeft()<this.getMaxScrollLeft()}}class Vxe extends MA{constructor(e){super(),this.el=e}getScrollTop(){return this.el.scrollTop}getScrollLeft(){return this.el.scrollLeft}setScrollTop(e){this.el.scrollTop=e}setScrollLeft(e){this.el.scrollLeft=e}getScrollWidth(){return this.el.scrollWidth}getScrollHeight(){return this.el.scrollHeight}getClientHeight(){return this.el.clientHeight}getClientWidth(){return this.el.clientWidth}}class $xe extends MA{getScrollTop(){return window.scrollY}getScrollLeft(){return window.scrollX}setScrollTop(e){window.scroll(window.scrollX,e)}setScrollLeft(e){window.scroll(e,window.scrollY)}getScrollWidth(){return document.documentElement.scrollWidth}getScrollHeight(){return document.documentElement.scrollHeight}getClientHeight(){return document.documentElement.clientHeight}getClientWidth(){return document.documentElement.clientWidth}}class ch extends Vo{constructor(){super(...arguments),this.uid=Eg()}prepareHits(){}queryHit(e,n,r,c){return null}isValidSegDownEl(e){return!this.props.eventDrag&&!this.props.eventResize&&!fl(e,".fc-event-mirror")}isValidDateDownEl(e){return!fl(e,".fc-event:not(.fc-bg-event)")&&!fl(e,".fc-more-link")&&!fl(e,"a[data-navlink]")&&!fl(e,".fc-popover")}}class T8{constructor(e=n=>n.thickness||1){this.getEntryThickness=e,this.strictOrder=!1,this.allowReslicing=!1,this.maxCoord=-1,this.maxStackCnt=-1,this.levelCoords=[],this.entriesByLevel=[],this.stackCnts={}}addSegs(e){let n=[];for(let r of e)this.insertEntry(r,n);return n}insertEntry(e,n){let r=this.findInsertion(e);this.isInsertionValid(r,e)?this.insertEntryAt(e,r):this.handleInvalidInsertion(r,e,n)}isInsertionValid(e,n){return(this.maxCoord===-1||e.levelCoord+this.getEntryThickness(n)<=this.maxCoord)&&(this.maxStackCnt===-1||e.stackCnt<this.maxStackCnt)}handleInvalidInsertion(e,n,r){if(this.allowReslicing&&e.touchingEntry){const c=Object.assign(Object.assign({},n),{span:DA(n.span,e.touchingEntry.span)});r.push(c),this.splitEntry(n,e.touchingEntry,r)}else r.push(n)}splitEntry(e,n,r){let c=e.span,u=n.span;c.start<u.start&&this.insertEntry({index:e.index,thickness:e.thickness,span:{start:c.start,end:u.start}},r),c.end>u.end&&this.insertEntry({index:e.index,thickness:e.thickness,span:{start:u.end,end:c.end}},r)}insertEntryAt(e,n){let{entriesByLevel:r,levelCoords:c}=this;n.lateral===-1?(CT(c,n.level,n.levelCoord),CT(r,n.level,[e])):CT(r[n.level],n.lateral,e),this.stackCnts[dg(e)]=n.stackCnt}findInsertion(e){let{levelCoords:n,entriesByLevel:r,strictOrder:c,stackCnts:u}=this,p=n.length,o=0,w=-1,T=-1,A=null,D=0;for(let ee=0;ee<p;ee+=1){const Q=n[ee];if(!c&&Q>=o+this.getEntryThickness(e))break;let se=r[ee],ce,be=zE(se,e.span.start,LE),ze=be[0]+be[1];for(;(ce=se[ze])&&ce.span.start<e.span.end;){let xe=Q+this.getEntryThickness(ce);xe>o&&(o=xe,A=ce,w=ee,T=ze),xe===o&&(D=Math.max(D,u[dg(ce)]+1)),ze+=1}}let B=0;if(A)for(B=w+1;B<p&&n[B]<o;)B+=1;let N=-1;return B<p&&n[B]===o&&(N=zE(r[B],e.span.end,LE)[0]),{touchingLevel:w,touchingLateral:T,touchingEntry:A,stackCnt:D,levelCoord:o,level:B,lateral:N}}toRects(){let{entriesByLevel:e,levelCoords:n}=this,r=e.length,c=[];for(let u=0;u<r;u+=1){let p=e[u],o=n[u];for(let w of p)c.push(Object.assign(Object.assign({},w),{thickness:this.getEntryThickness(w),levelCoord:o}))}return c}}function LE(t){return t.span.end}function dg(t){return t.index+":"+t.span.start}function jxe(t){let e=[];for(let n of t){let r=[],c={span:n.span,entries:[n]};for(let u of e)DA(u.span,c.span)?c={entries:u.entries.concat(c.entries),span:Uxe(u.span,c.span)}:r.push(u);r.push(c),e=r}return e}function Uxe(t,e){return{start:Math.min(t.start,e.start),end:Math.max(t.end,e.end)}}function DA(t,e){let n=Math.max(t.start,e.start),r=Math.min(t.end,e.end);return n<r?{start:n,end:r}:null}function CT(t,e,n){t.splice(e,0,n)}function zE(t,e,n){let r=0,c=t.length;if(!c||e<n(t[r]))return[0,0];if(e>n(t[c-1]))return[c,0];for(;r<c;){let u=Math.floor(r+(c-r)/2),p=n(t[u]);if(e<p)c=u;else if(e>p)r=u+1;else return[u,1]}return[r,0]}class Hxe{constructor(e,n){this.emitter=new ZS}destroy(){}setMirrorIsVisible(e){}setMirrorNeedsRevert(e){}setAutoScrollEnabled(e){}}const OA={};function Gxe(t,e){return!t||e>10?qs({weekday:"short"}):e>1?qs({weekday:"short",month:"numeric",day:"numeric",omitCommas:!0}):qs({weekday:"long"})}const E8="fc-col-header-cell";function I8(t){return t.text}class Wxe extends Vo{render(){let{dateEnv:e,options:n,theme:r,viewApi:c}=this.context,{props:u}=this,{date:p,dateProfile:o}=u,w=w8(p,u.todayRange,null,o),T=[E8].concat(RA(w,r)),A=e.format(p,u.dayHeaderFormat),D=!w.isDisabled&&u.colCnt>1?oS(this.context,p):{},B=e.toDate(p);e.namedTimeZoneImpl&&(B=Up(B,36e5));let N=Object.assign(Object.assign(Object.assign({date:B,view:c},u.extraRenderProps),{text:A}),w);return dt(Vc,{elTag:"th",elClasses:T,elAttrs:Object.assign({role:"columnheader",colSpan:u.colSpan,"data-date":w.isDisabled?void 0:gA(p)},u.extraDataAttrs),renderProps:N,generatorName:"dayHeaderContent",customGenerator:n.dayHeaderContent,defaultGenerator:I8,classNameGenerator:n.dayHeaderClassNames,didMount:n.dayHeaderDidMount,willUnmount:n.dayHeaderWillUnmount},ee=>dt("div",{className:"fc-scrollgrid-sync-inner"},!w.isDisabled&&dt(ee,{elTag:"a",elAttrs:D,elClasses:["fc-col-header-cell-cushion",u.isSticky&&"fc-sticky"]})))}}const qxe=qs({weekday:"long"});class Zxe extends Vo{render(){let{props:e}=this,{dateEnv:n,theme:r,viewApi:c,options:u}=this.context,p=za(new Date(2592e5),e.dow),o={dow:e.dow,isDisabled:!1,isFuture:!1,isPast:!1,isToday:!1,isOther:!1},w=n.format(p,e.dayHeaderFormat),T=Object.assign(Object.assign(Object.assign(Object.assign({date:p},o),{view:c}),e.extraRenderProps),{text:w});return dt(Vc,{elTag:"th",elClasses:[E8,...RA(o,r),...e.extraClassNames||[]],elAttrs:Object.assign({role:"columnheader",colSpan:e.colSpan},e.extraDataAttrs),renderProps:T,generatorName:"dayHeaderContent",customGenerator:u.dayHeaderContent,defaultGenerator:I8,classNameGenerator:u.dayHeaderClassNames,didMount:u.dayHeaderDidMount,willUnmount:u.dayHeaderWillUnmount},A=>dt("div",{className:"fc-scrollgrid-sync-inner"},dt(A,{elTag:"a",elClasses:["fc-col-header-cell-cushion",e.isSticky&&"fc-sticky"],elAttrs:{"aria-label":n.format(p,qxe)}})))}}class A8 extends Vo{constructor(){super(...arguments),this.createDayHeaderFormatter=Xi(Kxe)}render(){let{context:e}=this,{dates:n,dateProfile:r,datesRepDistinctDays:c,renderIntro:u}=this.props,p=this.createDayHeaderFormatter(e.options.dayHeaderFormat,c,n.length);return dt(by,{unit:"day"},(o,w)=>dt("tr",{role:"row"},u&&u("day"),n.map(T=>c?dt(Wxe,{key:T.toISOString(),date:T,dateProfile:r,todayRange:w,colCnt:n.length,dayHeaderFormat:p}):dt(Zxe,{key:T.getUTCDay(),dow:T.getUTCDay(),dayHeaderFormat:p}))))}}function Kxe(t,e,n){return t||Gxe(e,n)}class k8{constructor(e,n){let r=e.start,{end:c}=e,u=[],p=[],o=-1;for(;r<c;)n.isHiddenDay(r)?u.push(o+.5):(o+=1,u.push(o),p.push(r)),r=za(r,1);this.dates=p,this.indices=u,this.cnt=p.length}sliceRange(e){let n=this.getDateDayIndex(e.start),r=this.getDateDayIndex(za(e.end,-1)),c=Math.max(0,n),u=Math.min(this.cnt-1,r);return c=Math.ceil(c),u=Math.floor(u),c<=u?{firstIndex:c,lastIndex:u,isStart:n===c,isEnd:r===u}:null}getDateDayIndex(e){let{indices:n}=this,r=Math.floor(Ig(this.dates[0],e));return r<0?n[0]-1:r>=n.length?n[n.length-1]+1:n[r]}}class R8{constructor(e,n){let{dates:r}=e,c,u,p;if(n){for(u=r[0].getUTCDay(),c=1;c<r.length&&r[c].getUTCDay()!==u;c+=1);p=Math.ceil(r.length/c)}else p=1,c=r.length;this.rowCnt=p,this.colCnt=c,this.daySeries=e,this.cells=this.buildCells(),this.headerDates=this.buildHeaderDates()}buildCells(){let e=[];for(let n=0;n<this.rowCnt;n+=1){let r=[];for(let c=0;c<this.colCnt;c+=1)r.push(this.buildCell(n,c));e.push(r)}return e}buildCell(e,n){let r=this.daySeries.dates[e*this.colCnt+n];return{key:r.toISOString(),date:r}}buildHeaderDates(){let e=[];for(let n=0;n<this.colCnt;n+=1)e.push(this.cells[0][n].date);return e}sliceRange(e){let{colCnt:n}=this,r=this.daySeries.sliceRange(e),c=[];if(r){let{firstIndex:u,lastIndex:p}=r,o=u;for(;o<=p;){let w=Math.floor(o/n),T=Math.min((w+1)*n,p+1);c.push({row:w,firstCol:o%n,lastCol:(T-1)%n,isStart:r.isStart&&o===u,isEnd:r.isEnd&&T-1===p}),o=T}}return c}}class P8{constructor(){this.sliceBusinessHours=Xi(this._sliceBusinessHours),this.sliceDateSelection=Xi(this._sliceDateSpan),this.sliceEventStore=Xi(this._sliceEventStore),this.sliceEventDrag=Xi(this._sliceInteraction),this.sliceEventResize=Xi(this._sliceInteraction),this.forceDayIfListItem=!1}sliceProps(e,n,r,c,...u){let{eventUiBases:p}=e,o=this.sliceEventStore(e.eventStore,p,n,r,...u);return{dateSelectionSegs:this.sliceDateSelection(e.dateSelection,n,r,p,c,...u),businessHourSegs:this.sliceBusinessHours(e.businessHours,n,r,c,...u),fgEventSegs:o.fg,bgEventSegs:o.bg,eventDrag:this.sliceEventDrag(e.eventDrag,p,n,r,...u),eventResize:this.sliceEventResize(e.eventResize,p,n,r,...u),eventSelection:e.eventSelection}}sliceNowDate(e,n,r,c,...u){return this._sliceDateSpan({range:{start:e,end:Up(e,1)},allDay:!1},n,r,{},c,...u)}_sliceBusinessHours(e,n,r,c,...u){return e?this._sliceEventStore(bg(e,zx(n,!!r),c),{},n,r,...u).bg:[]}_sliceEventStore(e,n,r,c,...u){if(e){let p=YL(e,n,zx(r,!!c),c);return{bg:this.sliceEventRanges(p.bg,u),fg:this.sliceEventRanges(p.fg,u)}}return{bg:[],fg:[]}}_sliceInteraction(e,n,r,c,...u){if(!e)return null;let p=YL(e.mutatedEvents,n,zx(r,!!c),c);return{segs:this.sliceEventRanges(p.fg,u),affectedInstances:e.affectedEvents.instances,isEvent:e.isEvent}}_sliceDateSpan(e,n,r,c,u,...p){if(!e)return[];let o=zx(n,!!r),w=vg(e.range,o);if(w){e=Object.assign(Object.assign({},e),{range:w});let T=_xe(e,c,u),A=this.sliceRange(e.range,...p);for(let D of A)D.eventRange=T;return A}return[]}sliceEventRanges(e,n){let r=[];for(let c of e)r.push(...this.sliceEventRange(c,n));return r}sliceEventRange(e,n){let r=e.range;this.forceDayIfListItem&&e.ui.display==="list-item"&&(r={start:r.start,end:za(r.start,1)});let c=this.sliceRange(r,...n);for(let u of c)u.eventRange=e,u.isStart=e.isStart&&u.isStart,u.isEnd=e.isEnd&&u.isEnd;return c}}function zx(t,e){let n=t.activeRange;return e?n:{start:Up(n.start,t.slotMinTime.milliseconds),end:Up(n.end,t.slotMaxTime.milliseconds-864e5)}}function M8(t,e,n){let{instances:r}=t.mutatedEvents;for(let c in r)if(!WS(e.validRange,r[c].range))return!1;return D8({eventDrag:t},n)}function Xxe(t,e,n){return WS(e.validRange,t.range)?D8({dateSelection:t},n):!1}function D8(t,e){let n=e.getCurrentData(),r=Object.assign({businessHours:n.businessHours,dateSelection:"",eventStore:n.eventStore,eventUiBases:n.eventUiBases,eventSelection:"",eventDrag:null,eventResize:null},t);return(e.pluginHooks.isPropsValid||Yxe)(r,e)}function Yxe(t,e,n={},r){return!(t.eventDrag&&!Jxe(t,e,n,r)||t.dateSelection&&!Qxe(t,e,n,r))}function Jxe(t,e,n,r){let c=e.getCurrentData(),u=t.eventDrag,p=u.mutatedEvents,o=p.defs,w=p.instances,T=rS(o,u.isEvent?t.eventUiBases:{"":c.selectionConfig});r&&(T=lf(T,r));let A=K1e(t.eventStore,u.affectedEvents.instances),D=A.defs,B=A.instances,N=rS(D,t.eventUiBases);for(let ee in w){let Q=w[ee],se=Q.range,ce=T[Q.defId],be=o[Q.defId];if(!O8(ce.constraints,se,A,t.businessHours,e))return!1;let{eventOverlap:ze}=e.options,xe=typeof ze=="function"?ze:null;for(let qe in B){let oe=B[qe];if(wA(se,oe.range)&&(N[oe.defId].overlap===!1&&u.isEvent||ce.overlap===!1||xe&&!xe(new Bs(e,D[oe.defId],oe),new Bs(e,be,Q))))return!1}let je=c.eventStore;for(let qe of ce.allows){let oe=Object.assign(Object.assign({},n),{range:Q.range,allDay:be.allDay}),de=je.defs[be.defId],Ee=je.instances[ee],$e;if(de?$e=new Bs(e,de,Ee):$e=new Bs(e,be),!qe(IA(oe,e),$e))return!1}}return!0}function Qxe(t,e,n,r){let c=t.eventStore,u=c.defs,p=c.instances,o=t.dateSelection,w=o.range,{selectionConfig:T}=e.getCurrentData();if(r&&(T=r(T)),!O8(T.constraints,w,c,t.businessHours,e))return!1;let{selectOverlap:A}=e.options,D=typeof A=="function"?A:null;for(let B in p){let N=p[B];if(wA(w,N.range)&&(T.overlap===!1||D&&!D(new Bs(e,u[N.defId],N),null)))return!1}for(let B of T.allows){let N=Object.assign(Object.assign({},n),o);if(!B(IA(N,e),null))return!1}return!0}function O8(t,e,n,r,c){for(let u of t)if(!twe(ewe(u,e,n,r,c),e))return!1;return!0}function ewe(t,e,n,r,c){return t==="businessHours"?TT(bg(r,e,c)):typeof t=="string"?TT(qS(n,u=>u.groupId===t)):typeof t=="object"&&t?TT(bg(t,e,c)):[]}function TT(t){let{instances:e}=t,n=[];for(let r in e)n.push(e[r].range);return n}function twe(t,e){for(let n of t)if(WS(n,e))return!0;return!1}const Bx=/^(visible|hidden)$/;class nwe extends Vo{constructor(){super(...arguments),this.handleEl=e=>{this.el=e,ah(this.props.elRef,e)}}render(){let{props:e}=this,{liquid:n,liquidIsAbsolute:r}=e,c=n&&r,u=["fc-scroller"];return n&&(r?u.push("fc-scroller-liquid-absolute"):u.push("fc-scroller-liquid")),dt("div",{ref:this.handleEl,className:u.join(" "),style:{overflowX:e.overflowX,overflowY:e.overflowY,left:c&&-(e.overcomeLeft||0)||"",right:c&&-(e.overcomeRight||0)||"",bottom:c&&-(e.overcomeBottom||0)||"",marginLeft:!c&&-(e.overcomeLeft||0)||"",marginRight:!c&&-(e.overcomeRight||0)||"",marginBottom:!c&&-(e.overcomeBottom||0)||"",maxHeight:e.maxHeight||""}},e.children)}needsXScrolling(){if(Bx.test(this.props.overflowX))return!1;let{el:e}=this,n=this.el.getBoundingClientRect().width-this.getYScrollbarWidth(),{children:r}=e;for(let c=0;c<r.length;c+=1)if(r[c].getBoundingClientRect().width>n)return!0;return!1}needsYScrolling(){if(Bx.test(this.props.overflowY))return!1;let{el:e}=this,n=this.el.getBoundingClientRect().height-this.getXScrollbarWidth(),{children:r}=e;for(let c=0;c<r.length;c+=1)if(r[c].getBoundingClientRect().height>n)return!0;return!1}getXScrollbarWidth(){return Bx.test(this.props.overflowX)?0:this.el.offsetHeight-this.el.clientHeight}getYScrollbarWidth(){return Bx.test(this.props.overflowY)?0:this.el.offsetWidth-this.el.clientWidth}}class Qh{constructor(e){this.masterCallback=e,this.currentMap={},this.depths={},this.callbackMap={},this.handleValue=(n,r)=>{let{depths:c,currentMap:u}=this,p=!1,o=!1;n!==null?(p=r in u,u[r]=n,c[r]=(c[r]||0)+1,o=!0):(c[r]-=1,c[r]||(delete u[r],delete this.callbackMap[r],p=!0)),this.masterCallback&&(p&&this.masterCallback(null,String(r)),o&&this.masterCallback(n,String(r)))}}createRef(e){let n=this.callbackMap[e];return n||(n=this.callbackMap[e]=r=>{this.handleValue(r,String(e))}),n}collect(e,n,r){return p1e(this.currentMap,e,n,r)}getAll(){return bA(this.currentMap)}}function iwe(t){let e=h0e(t,".fc-scrollgrid-shrink"),n=0;for(let r of e)n=Math.max(n,E0e(r));return Math.ceil(n)}function L8(t,e){return t.liquid&&e.liquid}function rwe(t,e){return e.maxHeight!=null||L8(t,e)}function owe(t,e,n,r){let{expandRows:c}=n;return typeof e.content=="function"?e.content(n):dt("table",{role:"presentation",className:[e.tableClassName,t.syncRowHeights?"fc-scrollgrid-sync-table":""].join(" "),style:{minWidth:n.tableMinWidth,width:n.clientWidth,height:c?n.clientHeight:""}},n.tableColGroupNode,dt(r?"thead":"tbody",{role:"presentation"},typeof e.rowContent=="function"?e.rowContent(n):e.rowContent))}function swe(t,e){return jp(t,e,fd)}function awe(t,e){let n=[];for(let r of t){let c=r.span||1;for(let u=0;u<c;u+=1)n.push(dt("col",{style:{width:r.width==="shrink"?lwe(e):r.width||"",minWidth:r.minWidth||""}}))}return dt("colgroup",{},...n)}function lwe(t){return t??4}function cwe(t){for(let e of t)if(e.width==="shrink")return!0;return!1}function uwe(t,e){let n=["fc-scrollgrid",e.theme.getClass("table")];return t&&n.push("fc-scrollgrid-liquid"),n}function dwe(t,e){let n=["fc-scrollgrid-section",`fc-scrollgrid-section-${t.type}`,t.className];return e&&t.liquid&&t.maxHeight==null&&n.push("fc-scrollgrid-section-liquid"),t.isSticky&&n.push("fc-scrollgrid-section-sticky"),n}function BE(t){return dt("div",{className:"fc-scrollgrid-sticky-shim",style:{width:t.clientWidth,minWidth:t.tableMinWidth}})}function sS(t){let{stickyHeaderDates:e}=t;return(e==null||e==="auto")&&(e=t.height==="auto"||t.viewHeight==="auto"),e}function z8(t){let{stickyFooterScrollbar:e}=t;return(e==null||e==="auto")&&(e=t.height==="auto"||t.viewHeight==="auto"),e}class LA extends Vo{constructor(){super(...arguments),this.processCols=Xi(e=>e,swe),this.renderMicroColGroup=Xi(awe),this.scrollerRefs=new Qh,this.scrollerElRefs=new Qh(this._handleScrollerEl.bind(this)),this.state={shrinkWidth:null,forceYScrollbars:!1,scrollerClientWidths:{},scrollerClientHeights:{}},this.handleSizing=()=>{this.safeSetState(Object.assign({shrinkWidth:this.computeShrinkWidth()},this.computeScrollerDims()))}}render(){let{props:e,state:n,context:r}=this,c=e.sections||[],u=this.processCols(e.cols),p=this.renderMicroColGroup(u,n.shrinkWidth),o=uwe(e.liquid,r);e.collapsibleWidth&&o.push("fc-scrollgrid-collapsible");let w=c.length,T=0,A,D=[],B=[],N=[];for(;T<w&&(A=c[T]).type==="header";)D.push(this.renderSection(A,p,!0)),T+=1;for(;T<w&&(A=c[T]).type==="body";)B.push(this.renderSection(A,p,!1)),T+=1;for(;T<w&&(A=c[T]).type==="footer";)N.push(this.renderSection(A,p,!0)),T+=1;let ee=!b8();const Q={role:"rowgroup"};return dt("table",{role:"grid",className:o.join(" "),style:{height:e.height}},!!(!ee&&D.length)&&dt("thead",Q,...D),!!(!ee&&B.length)&&dt("tbody",Q,...B),!!(!ee&&N.length)&&dt("tfoot",Q,...N),ee&&dt("tbody",Q,...D,...B,...N))}renderSection(e,n,r){return"outerContent"in e?dt(_s,{key:e.key},e.outerContent):dt("tr",{key:e.key,role:"presentation",className:dwe(e,this.props.liquid).join(" ")},this.renderChunkTd(e,n,e.chunk,r))}renderChunkTd(e,n,r,c){if("outerContent"in r)return r.outerContent;let{props:u}=this,{forceYScrollbars:p,scrollerClientWidths:o,scrollerClientHeights:w}=this.state,T=rwe(u,e),A=L8(u,e),D=u.liquid?p?"scroll":T?"auto":"hidden":"visible",B=e.key,N=owe(e,r,{tableColGroupNode:n,tableMinWidth:"",clientWidth:!u.collapsibleWidth&&o[B]!==void 0?o[B]:null,clientHeight:w[B]!==void 0?w[B]:null,expandRows:e.expandRows,syncRowHeights:!1,rowSyncHeights:[],reportRowHeightChange:()=>{}},c);return dt(c?"th":"td",{ref:r.elRef,role:"presentation"},dt("div",{className:`fc-scroller-harness${A?" fc-scroller-harness-liquid":""}`},dt(nwe,{ref:this.scrollerRefs.createRef(B),elRef:this.scrollerElRefs.createRef(B),overflowY:D,overflowX:u.liquid?"hidden":"visible",maxHeight:e.maxHeight,liquid:A,liquidIsAbsolute:!0},N)))}_handleScrollerEl(e,n){let r=hwe(this.props.sections,n);r&&ah(r.chunk.scrollerElRef,e)}componentDidMount(){this.handleSizing(),this.context.addResizeHandler(this.handleSizing)}componentDidUpdate(){this.handleSizing()}componentWillUnmount(){this.context.removeResizeHandler(this.handleSizing)}computeShrinkWidth(){return cwe(this.props.cols)?iwe(this.scrollerElRefs.getAll()):0}computeScrollerDims(){let e=Lxe(),{scrollerRefs:n,scrollerElRefs:r}=this,c=!1,u={},p={};for(let o in n.currentMap){let w=n.currentMap[o];if(w&&w.needsYScrolling()){c=!0;break}}for(let o of this.props.sections){let w=o.key,T=r.currentMap[w];if(T){let A=T.parentNode;u[w]=Math.floor(A.getBoundingClientRect().width-(c?e.y:0)),p[w]=Math.floor(A.getBoundingClientRect().height)}}return{forceYScrollbars:c,scrollerClientWidths:u,scrollerClientHeights:p}}}LA.addStateEquality({scrollerClientWidths:fd,scrollerClientHeights:fd});function hwe(t,e){for(let n of t)if(n.key===e)return n;return null}class zA extends Vo{constructor(){super(...arguments),this.buildPublicEvent=Xi((e,n,r)=>new Bs(e,n,r)),this.handleEl=e=>{this.el=e,ah(this.props.elRef,e),e&&JL(e,this.props.seg)}}render(){const{props:e,context:n}=this,{options:r}=n,{seg:c}=e,{eventRange:u}=c,{ui:p}=u,o={event:this.buildPublicEvent(n,u.def,u.instance),view:n.viewApi,timeText:e.timeText,textColor:p.textColor,backgroundColor:p.backgroundColor,borderColor:p.borderColor,isDraggable:!e.disableDragging&&axe(c,n),isStartResizable:!e.disableResizing&&lxe(c,n),isEndResizable:!e.disableResizing&&cxe(c),isMirror:!!(e.isDragging||e.isResizing||e.isDateSelecting),isStart:!!c.isStart,isEnd:!!c.isEnd,isPast:!!e.isPast,isFuture:!!e.isFuture,isToday:!!e.isToday,isSelected:!!e.isSelected,isDragging:!!e.isDragging,isResizing:!!e.isResizing};return dt(Vc,{elRef:this.handleEl,elTag:e.elTag,elAttrs:e.elAttrs,elClasses:[...uxe(o),...c.eventRange.ui.classNames,...e.elClasses||[]],elStyle:e.elStyle,renderProps:o,generatorName:"eventContent",customGenerator:r.eventContent,defaultGenerator:e.defaultGenerator,classNameGenerator:r.eventClassNames,didMount:r.eventDidMount,willUnmount:r.eventWillUnmount},e.children)}componentDidUpdate(e){this.el&&this.props.seg!==e.seg&&JL(this.el,this.props.seg)}}class BA extends Vo{render(){let{props:e,context:n}=this,{options:r}=n,{seg:c}=e,{ui:u}=c.eventRange,p=r.eventTimeFormat||e.defaultTimeFormat,o=m8(c,p,n,e.defaultDisplayEventTime,e.defaultDisplayEventEnd);return dt(zA,Object.assign({},e,{elTag:"a",elStyle:{borderColor:u.borderColor,backgroundColor:u.backgroundColor},elAttrs:_8(c,n),defaultGenerator:fwe,timeText:o}),(w,T)=>dt(_s,null,dt(w,{elTag:"div",elClasses:["fc-event-main"],elStyle:{color:T.textColor}}),!!T.isStartResizable&&dt("div",{className:"fc-event-resizer fc-event-resizer-start"}),!!T.isEndResizable&&dt("div",{className:"fc-event-resizer fc-event-resizer-end"})))}}BA.addPropsEquality({seg:fd});function fwe(t){return dt("div",{className:"fc-event-main-frame"},t.timeText&&dt("div",{className:"fc-event-time"},t.timeText),dt("div",{className:"fc-event-title-container"},dt("div",{className:"fc-event-title fc-sticky"},t.event.title||dt(_s,null," "))))}const FA=t=>dt(ff.Consumer,null,e=>{let{options:n}=e,r={isAxis:t.isAxis,date:e.dateEnv.toDate(t.date),view:e.viewApi};return dt(Vc,{elRef:t.elRef,elTag:t.elTag||"div",elAttrs:t.elAttrs,elClasses:t.elClasses,elStyle:t.elStyle,renderProps:r,generatorName:"nowIndicatorContent",customGenerator:n.nowIndicatorContent,classNameGenerator:n.nowIndicatorClassNames,didMount:n.nowIndicatorDidMount,willUnmount:n.nowIndicatorWillUnmount},t.children)}),pwe=qs({day:"numeric"});class NA extends Vo{constructor(){super(...arguments),this.refineRenderProps=lw(mwe)}render(){let{props:e,context:n}=this,{options:r}=n,c=this.refineRenderProps({date:e.date,dateProfile:e.dateProfile,todayRange:e.todayRange,isMonthStart:e.isMonthStart||!1,showDayNumber:e.showDayNumber,extraRenderProps:e.extraRenderProps,viewApi:n.viewApi,dateEnv:n.dateEnv,monthStartFormat:r.monthStartFormat});return dt(Vc,{elRef:e.elRef,elTag:e.elTag,elAttrs:Object.assign(Object.assign({},e.elAttrs),c.isDisabled?{}:{"data-date":gA(e.date)}),elClasses:[...RA(c,n.theme),...e.elClasses||[]],elStyle:e.elStyle,renderProps:c,generatorName:"dayCellContent",customGenerator:r.dayCellContent,defaultGenerator:e.defaultGenerator,classNameGenerator:c.isDisabled?void 0:r.dayCellClassNames,didMount:r.dayCellDidMount,willUnmount:r.dayCellWillUnmount},e.children)}}function VA(t){return!!(t.dayCellContent||PE("dayCellContent",t))}function mwe(t){let{date:e,dateEnv:n,dateProfile:r,isMonthStart:c}=t,u=w8(e,t.todayRange,null,r),p=t.showDayNumber?n.format(e,c?t.monthStartFormat:pwe):"";return Object.assign(Object.assign(Object.assign({date:n.toDate(e),view:t.viewApi},u),{isMonthStart:c,dayNumberText:p}),t.extraRenderProps)}class B8 extends Vo{render(){let{props:e}=this,{seg:n}=e;return dt(zA,{elTag:"div",elClasses:["fc-bg-event"],elStyle:{backgroundColor:n.eventRange.ui.backgroundColor},defaultGenerator:gwe,seg:n,timeText:"",isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:!1,isPast:e.isPast,isFuture:e.isFuture,isToday:e.isToday,disableDragging:!0,disableResizing:!0})}}function gwe(t){let{title:e}=t.event;return e&&dt("div",{className:"fc-event-title"},t.event.title)}function F8(t){return dt("div",{className:`fc-${t}`})}const N8=t=>dt(ff.Consumer,null,e=>{let{dateEnv:n,options:r}=e,{date:c}=t,u=r.weekNumberFormat||t.defaultFormat,p=n.computeWeekNumber(c),o=n.format(c,u),w={num:p,text:o,date:c};return dt(Vc,{elRef:t.elRef,elTag:t.elTag,elAttrs:t.elAttrs,elClasses:t.elClasses,elStyle:t.elStyle,renderProps:w,generatorName:"weekNumberContent",customGenerator:r.weekNumberContent,defaultGenerator:_we,classNameGenerator:r.weekNumberClassNames,didMount:r.weekNumberDidMount,willUnmount:r.weekNumberWillUnmount},t.children)});function _we(t){return t.text}const ET=10;class ywe extends Vo{constructor(){super(...arguments),this.state={titleId:HS()},this.handleRootEl=e=>{this.rootEl=e,this.props.elRef&&ah(this.props.elRef,e)},this.handleDocumentMouseDown=e=>{const n=jN(e);this.rootEl.contains(n)||this.handleCloseClick()},this.handleDocumentKeyDown=e=>{e.key==="Escape"&&this.handleCloseClick()},this.handleCloseClick=()=>{let{onClose:e}=this.props;e&&e()}}render(){let{theme:e,options:n}=this.context,{props:r,state:c}=this,u=["fc-popover",e.getClass("popover")].concat(r.extraClassNames||[]);return Jbe(dt("div",Object.assign({},r.extraAttrs,{id:r.id,className:u.join(" "),"aria-labelledby":c.titleId,ref:this.handleRootEl}),dt("div",{className:"fc-popover-header "+e.getClass("popoverHeader")},dt("span",{className:"fc-popover-title",id:c.titleId},r.title),dt("span",{className:"fc-popover-close "+e.getIconClass("close"),title:n.closeHint,onClick:this.handleCloseClick})),dt("div",{className:"fc-popover-body "+e.getClass("popoverContent")},r.children)),r.parentEl)}componentDidMount(){document.addEventListener("mousedown",this.handleDocumentMouseDown),document.addEventListener("keydown",this.handleDocumentKeyDown),this.updateSize()}componentWillUnmount(){document.removeEventListener("mousedown",this.handleDocumentMouseDown),document.removeEventListener("keydown",this.handleDocumentKeyDown)}updateSize(){let{isRtl:e}=this.context,{alignmentEl:n,alignGridTop:r}=this.props,{rootEl:c}=this,u=Nxe(n);if(u){let p=c.getBoundingClientRect(),o=r?fl(n,".fc-scrollgrid").getBoundingClientRect().top:u.top,w=e?u.right-p.width:u.left;o=Math.max(o,ET),w=Math.min(w,document.documentElement.clientWidth-ET-p.width),w=Math.max(w,ET);let T=c.offsetParent.getBoundingClientRect();vb(c,{top:o-T.top,left:w-T.left})}}}class vwe extends ch{constructor(){super(...arguments),this.handleRootEl=e=>{this.rootEl=e,e?this.context.registerInteractiveComponent(this,{el:e,useEventCenter:!1}):this.context.unregisterInteractiveComponent(this)}}render(){let{options:e,dateEnv:n}=this.context,{props:r}=this,{startDate:c,todayRange:u,dateProfile:p}=r,o=n.format(c,e.dayPopoverFormat);return dt(NA,{elRef:this.handleRootEl,date:c,dateProfile:p,todayRange:u},(w,T,A)=>dt(ywe,{elRef:A.ref,id:r.id,title:o,extraClassNames:["fc-more-popover"].concat(A.className||[]),extraAttrs:A,parentEl:r.parentEl,alignmentEl:r.alignmentEl,alignGridTop:r.alignGridTop,onClose:r.onClose},VA(e)&&dt(w,{elTag:"div",elClasses:["fc-more-popover-misc"]}),r.children))}queryHit(e,n,r,c){let{rootEl:u,props:p}=this;return e>=0&&e<r&&n>=0&&n<c?{dateProfile:p.dateProfile,dateSpan:Object.assign({allDay:!p.forceTimed,range:{start:p.startDate,end:p.endDate}},p.extraDateSpan),dayEl:u,rect:{left:0,top:0,right:r,bottom:c},layer:1}:null}}class V8 extends Vo{constructor(){super(...arguments),this.state={isPopoverOpen:!1,popoverId:HS()},this.handleLinkEl=e=>{this.linkEl=e,this.props.elRef&&ah(this.props.elRef,e)},this.handleClick=e=>{let{props:n,context:r}=this,{moreLinkClick:c}=r.options,u=e4(n).start;function p(o){let{def:w,instance:T,range:A}=o.eventRange;return{event:new Bs(r,w,T),start:r.dateEnv.toDate(A.start),end:r.dateEnv.toDate(A.end),isStart:o.isStart,isEnd:o.isEnd}}typeof c=="function"&&(c=c({date:u,allDay:!!n.allDayDate,allSegs:n.allSegs.map(p),hiddenSegs:n.hiddenSegs.map(p),jsEvent:e,view:r.viewApi})),!c||c==="popover"?this.setState({isPopoverOpen:!0}):typeof c=="string"&&r.calendarApi.zoomTo(u,c)},this.handlePopoverClose=()=>{this.setState({isPopoverOpen:!1})}}render(){let{props:e,state:n}=this;return dt(ff.Consumer,null,r=>{let{viewApi:c,options:u,calendarApi:p}=r,{moreLinkText:o}=u,{moreCnt:w}=e,T=e4(e),A=typeof o=="function"?o.call(p,w):`+${w} ${o}`,D=bb(u.moreLinkHint,[w],A),B={num:w,shortText:`+${w}`,text:A,view:c};return dt(_s,null,!!e.moreCnt&&dt(Vc,{elTag:e.elTag||"a",elRef:this.handleLinkEl,elClasses:[...e.elClasses||[],"fc-more-link"],elStyle:e.elStyle,elAttrs:Object.assign(Object.assign(Object.assign({},e.elAttrs),HN(this.handleClick)),{title:D,"aria-expanded":n.isPopoverOpen,"aria-controls":n.isPopoverOpen?n.popoverId:""}),renderProps:B,generatorName:"moreLinkContent",customGenerator:u.moreLinkContent,defaultGenerator:e.defaultGenerator||bwe,classNameGenerator:u.moreLinkClassNames,didMount:u.moreLinkDidMount,willUnmount:u.moreLinkWillUnmount},e.children),n.isPopoverOpen&&dt(vwe,{id:n.popoverId,startDate:T.start,endDate:T.end,dateProfile:e.dateProfile,todayRange:e.todayRange,extraDateSpan:e.extraDateSpan,parentEl:this.parentEl,alignmentEl:e.alignmentElRef?e.alignmentElRef.current:this.linkEl,alignGridTop:e.alignGridTop,forceTimed:e.forceTimed,onClose:this.handlePopoverClose},e.popoverContent()))})}componentDidMount(){this.updateParentEl()}componentDidUpdate(){this.updateParentEl()}updateParentEl(){this.linkEl&&(this.parentEl=fl(this.linkEl,".fc-view-harness"))}}function bwe(t){return t.text}function e4(t){if(t.allDayDate)return{start:t.allDayDate,end:za(t.allDayDate,1)};let{hiddenSegs:e}=t;return{start:$8(e),end:wwe(e)}}function $8(t){return t.reduce(xwe).eventRange.range.start}function xwe(t,e){return t.eventRange.range.start<e.eventRange.range.start?t:e}function wwe(t){return t.reduce(Swe).eventRange.range.end}function Swe(t,e){return t.eventRange.range.end>e.eventRange.range.end?t:e}const Cwe=[],j8={code:"en",week:{dow:0,doy:4},direction:"ltr",buttonText:{prev:"prev",next:"next",prevYear:"prev year",nextYear:"next year",year:"year",today:"today",month:"month",week:"week",day:"day",list:"list"},weekText:"W",weekTextLong:"Week",closeHint:"Close",timeHint:"Time",eventHint:"Event",allDayText:"all-day",moreLinkText:"more",noEventsText:"No events to display"},U8=Object.assign(Object.assign({},j8),{buttonHints:{prev:"Previous $0",next:"Next $0",today(t,e){return e==="day"?"Today":`This ${t}`}},viewHint:"$0 view",navLinkHint:"Go to $0",moreLinkHint(t){return`Show ${t} more event${t===1?"":"s"}`}});function Twe(t){let e=t.length>0?t[0].code:"en",n=Cwe.concat(t),r={en:U8};for(let c of n)r[c.code]=c;return{map:r,defaultCode:e}}function H8(t,e){return typeof t=="object"&&!Array.isArray(t)?G8(t.code,[t.code],t):Ewe(t,e)}function Ewe(t,e){let n=[].concat(t||[]),r=Iwe(n,e)||U8;return G8(t,n,r)}function Iwe(t,e){for(let n=0;n<t.length;n+=1){let r=t[n].toLocaleLowerCase().split("-");for(let c=r.length;c>0;c-=1){let u=r.slice(0,c).join("-");if(e[u])return e[u]}}return null}function G8(t,e,n){let r=vA([j8,n],["buttonText"]);delete r.code;let{week:c}=r;return delete r.week,{codeArg:t,codes:e,week:c,simpleNumberFormat:new Intl.NumberFormat(t),options:r}}function pf(t){return{id:Eg(),name:t.name,premiumReleaseDate:t.premiumReleaseDate?new Date(t.premiumReleaseDate):void 0,deps:t.deps||[],reducers:t.reducers||[],isLoadingFuncs:t.isLoadingFuncs||[],contextInit:[].concat(t.contextInit||[]),eventRefiners:t.eventRefiners||{},eventDefMemberAdders:t.eventDefMemberAdders||[],eventSourceRefiners:t.eventSourceRefiners||{},isDraggableTransformers:t.isDraggableTransformers||[],eventDragMutationMassagers:t.eventDragMutationMassagers||[],eventDefMutationAppliers:t.eventDefMutationAppliers||[],dateSelectionTransformers:t.dateSelectionTransformers||[],datePointTransforms:t.datePointTransforms||[],dateSpanTransforms:t.dateSpanTransforms||[],views:t.views||{},viewPropsTransformers:t.viewPropsTransformers||[],isPropsValid:t.isPropsValid||null,externalDefTransforms:t.externalDefTransforms||[],viewContainerAppends:t.viewContainerAppends||[],eventDropTransformers:t.eventDropTransformers||[],componentInteractions:t.componentInteractions||[],calendarInteractions:t.calendarInteractions||[],themeClasses:t.themeClasses||{},eventSourceDefs:t.eventSourceDefs||[],cmdFormatter:t.cmdFormatter,recurringTypes:t.recurringTypes||[],namedTimeZonedImpl:t.namedTimeZonedImpl,initialView:t.initialView||"",elementDraggingImpl:t.elementDraggingImpl,optionChangeHandlers:t.optionChangeHandlers||{},scrollGridImpl:t.scrollGridImpl||null,listenerRefiners:t.listenerRefiners||{},optionRefiners:t.optionRefiners||{},propSetHandlers:t.propSetHandlers||{}}}function Awe(t,e){let n={},r={premiumReleaseDate:void 0,reducers:[],isLoadingFuncs:[],contextInit:[],eventRefiners:{},eventDefMemberAdders:[],eventSourceRefiners:{},isDraggableTransformers:[],eventDragMutationMassagers:[],eventDefMutationAppliers:[],dateSelectionTransformers:[],datePointTransforms:[],dateSpanTransforms:[],views:{},viewPropsTransformers:[],isPropsValid:null,externalDefTransforms:[],viewContainerAppends:[],eventDropTransformers:[],componentInteractions:[],calendarInteractions:[],themeClasses:{},eventSourceDefs:[],cmdFormatter:null,recurringTypes:[],namedTimeZonedImpl:null,initialView:"",elementDraggingImpl:null,optionChangeHandlers:{},scrollGridImpl:null,listenerRefiners:{},optionRefiners:{},propSetHandlers:{}};function c(u){for(let p of u){const o=p.name,w=n[o];w===void 0?(n[o]=p.id,c(p.deps),r=Rwe(r,p)):w!==p.id&&console.warn(`Duplicate plugin '${o}'`)}}return t&&c(t),c(e),r}function kwe(){let t=[],e=[],n;return(r,c)=>((!n||!jp(r,t)||!jp(c,e))&&(n=Awe(r,c)),t=r,e=c,n)}function Rwe(t,e){return{premiumReleaseDate:Pwe(t.premiumReleaseDate,e.premiumReleaseDate),reducers:t.reducers.concat(e.reducers),isLoadingFuncs:t.isLoadingFuncs.concat(e.isLoadingFuncs),contextInit:t.contextInit.concat(e.contextInit),eventRefiners:Object.assign(Object.assign({},t.eventRefiners),e.eventRefiners),eventDefMemberAdders:t.eventDefMemberAdders.concat(e.eventDefMemberAdders),eventSourceRefiners:Object.assign(Object.assign({},t.eventSourceRefiners),e.eventSourceRefiners),isDraggableTransformers:t.isDraggableTransformers.concat(e.isDraggableTransformers),eventDragMutationMassagers:t.eventDragMutationMassagers.concat(e.eventDragMutationMassagers),eventDefMutationAppliers:t.eventDefMutationAppliers.concat(e.eventDefMutationAppliers),dateSelectionTransformers:t.dateSelectionTransformers.concat(e.dateSelectionTransformers),datePointTransforms:t.datePointTransforms.concat(e.datePointTransforms),dateSpanTransforms:t.dateSpanTransforms.concat(e.dateSpanTransforms),views:Object.assign(Object.assign({},t.views),e.views),viewPropsTransformers:t.viewPropsTransformers.concat(e.viewPropsTransformers),isPropsValid:e.isPropsValid||t.isPropsValid,externalDefTransforms:t.externalDefTransforms.concat(e.externalDefTransforms),viewContainerAppends:t.viewContainerAppends.concat(e.viewContainerAppends),eventDropTransformers:t.eventDropTransformers.concat(e.eventDropTransformers),calendarInteractions:t.calendarInteractions.concat(e.calendarInteractions),componentInteractions:t.componentInteractions.concat(e.componentInteractions),themeClasses:Object.assign(Object.assign({},t.themeClasses),e.themeClasses),eventSourceDefs:t.eventSourceDefs.concat(e.eventSourceDefs),cmdFormatter:e.cmdFormatter||t.cmdFormatter,recurringTypes:t.recurringTypes.concat(e.recurringTypes),namedTimeZonedImpl:e.namedTimeZonedImpl||t.namedTimeZonedImpl,initialView:t.initialView||e.initialView,elementDraggingImpl:t.elementDraggingImpl||e.elementDraggingImpl,optionChangeHandlers:Object.assign(Object.assign({},t.optionChangeHandlers),e.optionChangeHandlers),scrollGridImpl:e.scrollGridImpl||t.scrollGridImpl,listenerRefiners:Object.assign(Object.assign({},t.listenerRefiners),e.listenerRefiners),optionRefiners:Object.assign(Object.assign({},t.optionRefiners),e.optionRefiners),propSetHandlers:Object.assign(Object.assign({},t.propSetHandlers),e.propSetHandlers)}}function Pwe(t,e){return t===void 0?e:e===void 0?t:new Date(Math.max(t.valueOf(),e.valueOf()))}class Zp extends N0{}Zp.prototype.classes={root:"fc-theme-standard",tableCellShaded:"fc-cell-shaded",buttonGroup:"fc-button-group",button:"fc-button fc-button-primary",buttonActive:"fc-button-active"};Zp.prototype.baseIconClass="fc-icon";Zp.prototype.iconClasses={close:"fc-icon-x",prev:"fc-icon-chevron-left",next:"fc-icon-chevron-right",prevYear:"fc-icon-chevrons-left",nextYear:"fc-icon-chevrons-right"};Zp.prototype.rtlIconClasses={prev:"fc-icon-chevron-right",next:"fc-icon-chevron-left",prevYear:"fc-icon-chevrons-right",nextYear:"fc-icon-chevrons-left"};Zp.prototype.iconOverrideOption="buttonIcons";Zp.prototype.iconOverrideCustomButtonOption="icon";Zp.prototype.iconOverridePrefix="fc-icon-";function Mwe(t,e){let n={},r;for(r in t)FE(r,n,t,e);for(r in e)FE(r,n,t,e);return n}function FE(t,e,n,r){if(e[t])return e[t];let c=Dwe(t,e,n,r);return c&&(e[t]=c),c}function Dwe(t,e,n,r){let c=n[t],u=r[t],p=A=>c&&c[A]!==null?c[A]:u&&u[A]!==null?u[A]:null,o=p("component"),w=p("superType"),T=null;if(w){if(w===t)throw new Error("Can't have a custom view type that references itself");T=FE(w,e,n,r)}return!o&&T&&(o=T.component),o?{type:t,component:o,defaults:Object.assign(Object.assign({},T?T.defaults:{}),c?c.rawOptions:{}),overrides:Object.assign(Object.assign({},T?T.overrides:{}),u?u.rawOptions:{})}:null}function t4(t){return lf(t,Owe)}function Owe(t){let e=typeof t=="function"?{component:t}:t,{component:n}=e;return e.content?n=n4(e):n&&!(n.prototype instanceof Vo)&&(n=n4(Object.assign(Object.assign({},e),{content:n}))),{superType:e.type,component:n,rawOptions:e}}function n4(t){return e=>dt(ff.Consumer,null,n=>dt(Vc,{elTag:"div",elClasses:QN(n.viewSpec),renderProps:Object.assign(Object.assign({},e),{nextDayThreshold:n.options.nextDayThreshold}),generatorName:void 0,customGenerator:t.content,classNameGenerator:t.classNames,didMount:t.didMount,willUnmount:t.willUnmount}))}function Lwe(t,e,n,r){let c=t4(t),u=t4(e.views),p=Mwe(c,u);return lf(p,o=>zwe(o,u,e,n,r))}function zwe(t,e,n,r,c){let u=t.overrides.duration||t.defaults.duration||r.duration||n.duration,p=null,o="",w="",T={};if(u&&(p=Bwe(u),p)){let B=RE(p);o=B.unit,B.value===1&&(w=o,T=e[o]?e[o].rawOptions:{})}let A=B=>{let N=B.buttonText||{},ee=t.defaults.buttonTextKey;return ee!=null&&N[ee]!=null?N[ee]:N[t.type]!=null?N[t.type]:N[w]!=null?N[w]:null},D=B=>{let N=B.buttonHints||{},ee=t.defaults.buttonTextKey;return ee!=null&&N[ee]!=null?N[ee]:N[t.type]!=null?N[t.type]:N[w]!=null?N[w]:null};return{type:t.type,component:t.component,duration:p,durationUnit:o,singleUnit:w,optionDefaults:t.defaults,optionOverrides:Object.assign(Object.assign({},T),t.overrides),buttonTextOverride:A(r)||A(n)||t.overrides.buttonText,buttonTextDefault:A(c)||t.defaults.buttonText||A(xb)||t.type,buttonTitleOverride:D(r)||D(n)||t.overrides.buttonHint,buttonTitleDefault:D(c)||t.defaults.buttonHint||D(xb)}}let i4={};function Bwe(t){let e=JSON.stringify(t),n=i4[e];return n===void 0&&(n=so(t),i4[e]=n),n}function Fwe(t,e){switch(e.type){case"CHANGE_VIEW_TYPE":t=e.viewType}return t}function Nwe(t,e){switch(e.type){case"CHANGE_DATE":return e.dateMarker;default:return t}}function Vwe(t,e,n){let r=t.initialDate;return r!=null?e.createMarker(r):n.getDateMarker()}function $we(t,e){switch(e.type){case"SET_OPTION":return Object.assign(Object.assign({},t),{[e.optionName]:e.rawOptionValue});default:return t}}function jwe(t,e,n,r){let c;switch(e.type){case"CHANGE_VIEW_TYPE":return r.build(e.dateMarker||n);case"CHANGE_DATE":return r.build(e.dateMarker);case"PREV":if(c=r.buildPrev(t,n),c.isValid)return c;break;case"NEXT":if(c=r.buildNext(t,n),c.isValid)return c;break}return t}function Uwe(t,e,n){let r=e?e.activeRange:null;return q8({},Xwe(t,n),r,n)}function Hwe(t,e,n,r){let c=n?n.activeRange:null;switch(e.type){case"ADD_EVENT_SOURCES":return q8(t,e.sources,c,r);case"REMOVE_EVENT_SOURCE":return Wwe(t,e.sourceId);case"PREV":case"NEXT":case"CHANGE_DATE":case"CHANGE_VIEW_TYPE":return n?Z8(t,c,r):t;case"FETCH_EVENT_SOURCES":return $A(t,e.sourceIds?ZN(e.sourceIds):K8(t,r),c,e.isRefetch||!1,r);case"RECEIVE_EVENTS":case"RECEIVE_EVENT_ERROR":return Kwe(t,e.sourceId,e.fetchId,e.fetchRange);case"REMOVE_ALL_EVENT_SOURCES":return{};default:return t}}function Gwe(t,e,n){let r=e?e.activeRange:null;return $A(t,K8(t,n),r,!0,n)}function W8(t){for(let e in t)if(t[e].isFetching)return!0;return!1}function q8(t,e,n,r){let c={};for(let u of e)c[u.sourceId]=u;return n&&(c=Z8(c,n,r)),Object.assign(Object.assign({},t),c)}function Wwe(t,e){return yg(t,n=>n.sourceId!==e)}function Z8(t,e,n){return $A(t,yg(t,r=>qwe(r,e,n)),e,!1,n)}function qwe(t,e,n){return X8(t,n)?!n.options.lazyFetching||!t.fetchRange||t.isFetching||e.start<t.fetchRange.start||e.end>t.fetchRange.end:!t.latestFetchId}function $A(t,e,n,r,c){let u={};for(let p in t){let o=t[p];e[p]?u[p]=Zwe(o,n,r,c):u[p]=o}return u}function Zwe(t,e,n,r){let{options:c,calendarApi:u}=r,p=r.pluginHooks.eventSourceDefs[t.sourceDefId],o=Eg();return p.fetch({eventSource:t,range:e,isRefetch:n,context:r},w=>{let{rawEvents:T}=w;c.eventSourceSuccess&&(T=c.eventSourceSuccess.call(u,T,w.response)||T),t.success&&(T=t.success.call(u,T,w.response)||T),r.dispatch({type:"RECEIVE_EVENTS",sourceId:t.sourceId,fetchId:o,fetchRange:e,rawEvents:T})},w=>{let T=!1;c.eventSourceFailure&&(c.eventSourceFailure.call(u,w),T=!0),t.failure&&(t.failure(w),T=!0),T||console.warn(w.message,w),r.dispatch({type:"RECEIVE_EVENT_ERROR",sourceId:t.sourceId,fetchId:o,fetchRange:e,error:w})}),Object.assign(Object.assign({},t),{isFetching:!0,latestFetchId:o})}function Kwe(t,e,n,r){let c=t[e];return c&&n===c.latestFetchId?Object.assign(Object.assign({},t),{[e]:Object.assign(Object.assign({},c),{isFetching:!1,fetchRange:r})}):t}function K8(t,e){return yg(t,n=>X8(n,e))}function Xwe(t,e){let n=l8(e),r=[].concat(t.eventSources||[]),c=[];t.initialEvents&&r.unshift(t.initialEvents),t.events&&r.unshift(t.events);for(let u of r){let p=a8(u,e,n);p&&c.push(p)}return c}function X8(t,e){return!e.pluginHooks.eventSourceDefs[t.sourceDefId].ignoreRange}function Ywe(t,e){switch(e.type){case"UNSELECT_DATES":return null;case"SELECT_DATES":return e.selection;default:return t}}function Jwe(t,e){switch(e.type){case"UNSELECT_EVENT":return"";case"SELECT_EVENT":return e.eventInstanceId;default:return t}}function Qwe(t,e){let n;switch(e.type){case"UNSET_EVENT_DRAG":return null;case"SET_EVENT_DRAG":return n=e.state,{affectedEvents:n.affectedEvents,mutatedEvents:n.mutatedEvents,isEvent:n.isEvent};default:return t}}function eSe(t,e){let n;switch(e.type){case"UNSET_EVENT_RESIZE":return null;case"SET_EVENT_RESIZE":return n=e.state,{affectedEvents:n.affectedEvents,mutatedEvents:n.mutatedEvents,isEvent:n.isEvent};default:return t}}function tSe(t,e,n,r,c){let u=t.headerToolbar?r4(t.headerToolbar,t,e,n,r,c):null,p=t.footerToolbar?r4(t.footerToolbar,t,e,n,r,c):null;return{header:u,footer:p}}function r4(t,e,n,r,c,u){let p={},o=[],w=!1;for(let T in t){let A=t[T],D=nSe(A,e,n,r,c,u);p[T]=D.widgets,o.push(...D.viewsWithButtons),w=w||D.hasTitle}return{sectionWidgets:p,viewsWithButtons:o,hasTitle:w}}function nSe(t,e,n,r,c,u){let p=e.direction==="rtl",o=e.customButtons||{},w=n.buttonText||{},T=e.buttonText||{},A=n.buttonHints||{},D=e.buttonHints||{},B=t?t.split(" "):[],N=[],ee=!1;return{widgets:B.map(se=>se.split(",").map(ce=>{if(ce==="title")return ee=!0,{buttonName:ce};let be,ze,xe,je,qe,oe;if(be=o[ce])xe=de=>{be.click&&be.click.call(de.target,de,de.target)},(je=r.getCustomButtonIconClass(be))||(je=r.getIconClass(ce,p))||(qe=be.text),oe=be.hint||be.text;else if(ze=c[ce]){N.push(ce),xe=()=>{u.changeView(ce)},(qe=ze.buttonTextOverride)||(je=r.getIconClass(ce,p))||(qe=ze.buttonTextDefault);let de=ze.buttonTextOverride||ze.buttonTextDefault;oe=bb(ze.buttonTitleOverride||ze.buttonTitleDefault||e.viewHint,[de,ce],de)}else if(u[ce])if(xe=()=>{u[ce]()},(qe=w[ce])||(je=r.getIconClass(ce,p))||(qe=T[ce]),ce==="prevYear"||ce==="nextYear"){let de=ce==="prevYear"?"prev":"next";oe=bb(A[de]||D[de],[T.year||"year","year"],T[ce])}else oe=de=>bb(A[ce]||D[ce],[T[de]||de,de],T[ce]);return{buttonName:ce,buttonClick:xe,buttonIcon:je,buttonText:qe,buttonHint:oe}})),viewsWithButtons:N,hasTitle:ee}}class iSe{constructor(e,n,r){this.type=e,this.getCurrentData=n,this.dateEnv=r}get calendar(){return this.getCurrentData().calendarApi}get title(){return this.getCurrentData().viewTitle}get activeStart(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.start)}get activeEnd(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.end)}get currentStart(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.start)}get currentEnd(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.end)}getOption(e){return this.getCurrentData().options[e]}}let rSe={ignoreRange:!0,parseMeta(t){return Array.isArray(t.events)?t.events:null},fetch(t,e){e({rawEvents:t.eventSource.meta})}};const oSe=pf({name:"array-event-source",eventSourceDefs:[rSe]});let sSe={parseMeta(t){return typeof t.events=="function"?t.events:null},fetch(t,e,n){const{dateEnv:r}=t.context,c=t.eventSource.meta;yxe(c.bind(null,y8(t.range,r)),u=>e({rawEvents:u}),n)}};const aSe=pf({name:"func-event-source",eventSourceDefs:[sSe]}),lSe={method:String,extraParams:qt,startParam:String,endParam:String,timeZoneParam:String};let cSe={parseMeta(t){return t.url&&(t.format==="json"||!t.format)?{url:t.url,format:"json",method:(t.method||"GET").toUpperCase(),extraParams:t.extraParams,startParam:t.startParam,endParam:t.endParam,timeZoneParam:t.timeZoneParam}:null},fetch(t,e,n){const{meta:r}=t.eventSource,c=dSe(r,t.range,t.context);vxe(r.method,r.url,c).then(([u,p])=>{e({rawEvents:u,response:p})},n)}};const uSe=pf({name:"json-event-source",eventSourceRefiners:lSe,eventSourceDefs:[cSe]});function dSe(t,e,n){let{dateEnv:r,options:c}=n,u,p,o,w,T={};return u=t.startParam,u==null&&(u=c.startParam),p=t.endParam,p==null&&(p=c.endParam),o=t.timeZoneParam,o==null&&(o=c.timeZoneParam),typeof t.extraParams=="function"?w=t.extraParams():w=t.extraParams||{},Object.assign(T,w),T[u]=r.formatIso(e.start),T[p]=r.formatIso(e.end),r.timeZone!=="local"&&(T[o]=r.timeZone),T}const hSe={daysOfWeek:qt,startTime:so,endTime:so,duration:so,startRecur:qt,endRecur:qt};let fSe={parse(t,e){if(t.daysOfWeek||t.startTime||t.endTime||t.startRecur||t.endRecur){let n={daysOfWeek:t.daysOfWeek||null,startTime:t.startTime||null,endTime:t.endTime||null,startRecur:t.startRecur?e.createMarker(t.startRecur):null,endRecur:t.endRecur?e.createMarker(t.endRecur):null,dateEnv:e},r;return t.duration&&(r=t.duration),!r&&t.startTime&&t.endTime&&(r=R0e(t.endTime,t.startTime)),{allDayGuess:!t.startTime&&!t.endTime,duration:r,typeData:n}}return null},expand(t,e,n){let r=vg(e,{start:t.startRecur,end:t.endRecur});return r?mSe(t.daysOfWeek,t.startTime,t.dateEnv,n,r):[]}};const pSe=pf({name:"simple-recurring-event",recurringTypes:[fSe],eventRefiners:hSe});function mSe(t,e,n,r,c){let u=t?ZN(t):null,p=ys(c.start),o=c.end,w=[];for(e&&(e.milliseconds<0?o=za(o,1):e.milliseconds>=1e3*60*60*24&&(p=za(p,-1)));p<o;){let T;(!u||u[p.getUTCDay()])&&(e?T=r.add(p,e):T=p,w.push(r.createMarker(n.toDate(T)))),p=za(p,1)}return w}const gSe=pf({name:"change-handler",optionChangeHandlers:{events(t,e){o4([t],e)},eventSources:o4}});function o4(t,e){let n=bA(e.getCurrentData().eventSources);if(n.length===1&&t.length===1&&Array.isArray(n[0]._raw)&&Array.isArray(t[0])){e.dispatch({type:"RESET_RAW_EVENTS",sourceId:n[0].sourceId,rawEvents:t[0]});return}let r=[];for(let c of t){let u=!1;for(let p=0;p<n.length;p+=1)if(n[p]._raw===c){n.splice(p,1),u=!0;break}u||r.push(c)}for(let c of n)e.dispatch({type:"REMOVE_EVENT_SOURCE",sourceId:c.sourceId});for(let c of r)e.calendarApi.addEventSource(c)}function _Se(t,e){e.emitter.trigger("datesSet",Object.assign(Object.assign({},y8(t.activeRange,e.dateEnv)),{view:e.viewApi}))}function ySe(t,e){let{emitter:n}=e;n.hasHandlers("eventsSet")&&n.trigger("eventsSet",ug(t,e))}const vSe=[oSe,aSe,uSe,pSe,gSe,pf({name:"misc",isLoadingFuncs:[t=>W8(t.eventSources)],propSetHandlers:{dateProfile:_Se,eventStore:ySe}})];class bSe{constructor(e,n){this.runTaskOption=e,this.drainedOption=n,this.queue=[],this.delayedRunner=new dA(this.drain.bind(this))}request(e,n){this.queue.push(e),this.delayedRunner.request(n)}pause(e){this.delayedRunner.pause(e)}resume(e,n){this.delayedRunner.resume(e,n)}drain(){let{queue:e}=this;for(;e.length;){let n=[],r;for(;r=e.shift();)this.runTask(r),n.push(r);this.drained(n)}}runTask(e){this.runTaskOption&&this.runTaskOption(e)}drained(e){this.drainedOption&&this.drainedOption(e)}}function xSe(t,e,n){let r;return/^(year|month)$/.test(t.currentRangeUnit)?r=t.currentRange:r=t.activeRange,n.formatRange(r.start,r.end,qs(e.titleFormat||wSe(t)),{isEndExclusive:t.isRangeAllDay,defaultSeparator:e.titleRangeSeparator})}function wSe(t){let{currentRangeUnit:e}=t;if(e==="year")return{year:"numeric"};if(e==="month")return{year:"numeric",month:"long"};let n=Xw(t.currentRange.start,t.currentRange.end);return n!==null&&n>1?{year:"numeric",month:"short",day:"numeric"}:{year:"numeric",month:"long",day:"numeric"}}class s4{constructor(){this.resetListeners=new Set}handleInput(e,n){const r=this.dateEnv;if(e!==r&&(typeof n=="function"?this.nowFn=n:r||(this.nowAnchorDate=e.toDate(n?e.createMarker(n):e.createNowMarker()),this.nowAnchorQueried=Date.now()),this.dateEnv=e,r))for(const c of this.resetListeners.values())c()}getDateMarker(){return this.nowAnchorDate?this.dateEnv.timestampToMarker(this.nowAnchorDate.valueOf()+(Date.now()-this.nowAnchorQueried)):this.dateEnv.createMarker(this.nowFn())}addResetListener(e){this.resetListeners.add(e)}removeResetListener(e){this.resetListeners.delete(e)}}class SSe{constructor(e){this.computeCurrentViewData=Xi(this._computeCurrentViewData),this.organizeRawLocales=Xi(Twe),this.buildLocale=Xi(H8),this.buildPluginHooks=kwe(),this.buildDateEnv=Xi(CSe),this.buildTheme=Xi(TSe),this.parseToolbars=Xi(tSe),this.buildViewSpecs=Xi(Lwe),this.buildDateProfileGenerator=lw(ESe),this.buildViewApi=Xi(ISe),this.buildViewUiProps=lw(RSe),this.buildEventUiBySource=Xi(ASe,fd),this.buildEventUiBases=Xi(kSe),this.parseContextBusinessHours=lw(PSe),this.buildTitle=Xi(xSe),this.nowManager=new s4,this.emitter=new ZS,this.actionRunner=new bSe(this._handleAction.bind(this),this.updateData.bind(this)),this.currentCalendarOptionsInput={},this.currentCalendarOptionsRefined={},this.currentViewOptionsInput={},this.currentViewOptionsRefined={},this.currentCalendarOptionsRefiners={},this.optionsForRefining=[],this.optionsForHandling=[],this.getCurrentData=()=>this.data,this.dispatch=B=>{this.actionRunner.request(B)},this.props=e,this.actionRunner.pause(),this.nowManager=new s4;let n={},r=this.computeOptionsData(e.optionOverrides,n,e.calendarApi),c=r.calendarOptions.initialView||r.pluginHooks.initialView,u=this.computeCurrentViewData(c,r,e.optionOverrides,n);e.calendarApi.currentDataManager=this,this.emitter.setThisContext(e.calendarApi),this.emitter.setOptions(u.options);let p={nowManager:this.nowManager,dateEnv:r.dateEnv,options:r.calendarOptions,pluginHooks:r.pluginHooks,calendarApi:e.calendarApi,dispatch:this.dispatch,emitter:this.emitter,getCurrentData:this.getCurrentData},o=Vwe(r.calendarOptions,r.dateEnv,this.nowManager),w=u.dateProfileGenerator.build(o);nf(w.activeRange,o)||(o=w.currentRange.start);for(let B of r.pluginHooks.contextInit)B(p);let T=Uwe(r.calendarOptions,w,p),A={dynamicOptionOverrides:n,currentViewType:c,currentDate:o,dateProfile:w,businessHours:this.parseContextBusinessHours(p),eventSources:T,eventUiBases:{},eventStore:Fc(),renderableEventStore:Fc(),dateSelection:null,eventSelection:"",eventDrag:null,eventResize:null,selectionConfig:this.buildViewUiProps(p).selectionConfig},D=Object.assign(Object.assign({},p),A);for(let B of r.pluginHooks.reducers)Object.assign(A,B(null,null,D));IT(A,p)&&this.emitter.trigger("loading",!0),this.state=A,this.updateData(),this.actionRunner.resume()}resetOptions(e,n){let{props:r}=this;n===void 0?r.optionOverrides=e:(r.optionOverrides=Object.assign(Object.assign({},r.optionOverrides||{}),e),this.optionsForRefining.push(...n)),(n===void 0||n.length)&&this.actionRunner.request({type:"NOTHING"})}_handleAction(e){let{props:n,state:r,emitter:c}=this,u=$we(r.dynamicOptionOverrides,e),p=this.computeOptionsData(n.optionOverrides,u,n.calendarApi),o=Fwe(r.currentViewType,e),w=this.computeCurrentViewData(o,p,n.optionOverrides,u);n.calendarApi.currentDataManager=this,c.setThisContext(n.calendarApi),c.setOptions(w.options);let T={nowManager:this.nowManager,dateEnv:p.dateEnv,options:p.calendarOptions,pluginHooks:p.pluginHooks,calendarApi:n.calendarApi,dispatch:this.dispatch,emitter:c,getCurrentData:this.getCurrentData},{currentDate:A,dateProfile:D}=r;this.data&&this.data.dateProfileGenerator!==w.dateProfileGenerator&&(D=w.dateProfileGenerator.build(A)),A=Nwe(A,e),D=jwe(D,e,A,w.dateProfileGenerator),(e.type==="PREV"||e.type==="NEXT"||!nf(D.currentRange,A))&&(A=D.currentRange.start);let B=Hwe(r.eventSources,e,D,T),N=G1e(r.eventStore,e,B,D,T),Q=W8(B)&&!w.options.progressiveEventRendering&&r.renderableEventStore||N,{eventUiSingleBase:se,selectionConfig:ce}=this.buildViewUiProps(T),be=this.buildEventUiBySource(B),ze=this.buildEventUiBases(Q.defs,se,be),xe={dynamicOptionOverrides:u,currentViewType:o,currentDate:A,dateProfile:D,eventSources:B,eventStore:N,renderableEventStore:Q,selectionConfig:ce,eventUiBases:ze,businessHours:this.parseContextBusinessHours(T),dateSelection:Ywe(r.dateSelection,e),eventSelection:Jwe(r.eventSelection,e),eventDrag:Qwe(r.eventDrag,e),eventResize:eSe(r.eventResize,e)},je=Object.assign(Object.assign({},T),xe);for(let de of p.pluginHooks.reducers)Object.assign(xe,de(r,e,je));let qe=IT(r,T),oe=IT(xe,T);!qe&&oe?c.trigger("loading",!0):qe&&!oe&&c.trigger("loading",!1),this.state=xe,n.onAction&&n.onAction(e)}updateData(){let{props:e,state:n}=this,r=this.data,c=this.computeOptionsData(e.optionOverrides,n.dynamicOptionOverrides,e.calendarApi),u=this.computeCurrentViewData(n.currentViewType,c,e.optionOverrides,n.dynamicOptionOverrides),p=this.data=Object.assign(Object.assign(Object.assign({nowManager:this.nowManager,viewTitle:this.buildTitle(n.dateProfile,u.options,c.dateEnv),calendarApi:e.calendarApi,dispatch:this.dispatch,emitter:this.emitter,getCurrentData:this.getCurrentData},c),u),n),o=c.pluginHooks.optionChangeHandlers,w=r&&r.calendarOptions,T=c.calendarOptions;if(w&&w!==T){w.timeZone!==T.timeZone&&(n.eventSources=p.eventSources=Gwe(p.eventSources,n.dateProfile,p),n.eventStore=p.eventStore=KL(p.eventStore,r.dateEnv,p.dateEnv),n.renderableEventStore=p.renderableEventStore=KL(p.renderableEventStore,r.dateEnv,p.dateEnv));for(let A in o)(this.optionsForHandling.indexOf(A)!==-1||w[A]!==T[A])&&o[A](T[A],p)}this.optionsForHandling=[],e.onData&&e.onData(p)}computeOptionsData(e,n,r){if(!this.optionsForRefining.length&&e===this.stableOptionOverrides&&n===this.stableDynamicOptionOverrides)return this.stableCalendarOptionsData;let{refinedOptions:c,pluginHooks:u,localeDefaults:p,availableLocaleData:o,extra:w}=this.processRawCalendarOptions(e,n);a4(w);let T=this.buildDateEnv(c.timeZone,c.locale,c.weekNumberCalculation,c.firstDay,c.weekText,u,o,c.defaultRangeSeparator),A=this.buildViewSpecs(u.views,this.stableOptionOverrides,this.stableDynamicOptionOverrides,p),D=this.buildTheme(c,u),B=this.parseToolbars(c,this.stableOptionOverrides,D,A,r);return this.stableCalendarOptionsData={calendarOptions:c,pluginHooks:u,dateEnv:T,viewSpecs:A,theme:D,toolbarConfig:B,localeDefaults:p,availableRawLocales:o.map}}processRawCalendarOptions(e,n){let{locales:r,locale:c}=yT([xb,e,n]),u=this.organizeRawLocales(r),p=u.map,o=this.buildLocale(c||u.defaultCode,p).options,w=this.buildPluginHooks(e.plugins||[],vSe),T=this.currentCalendarOptionsRefiners=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},UL),HL),GL),w.listenerRefiners),w.optionRefiners),A={},D=yT([xb,o,e,n]),B={},N=this.currentCalendarOptionsInput,ee=this.currentCalendarOptionsRefined,Q=!1;for(let se in D)this.optionsForRefining.indexOf(se)===-1&&(D[se]===N[se]||qm[se]&&se in N&&qm[se](N[se],D[se]))?B[se]=ee[se]:T[se]?(B[se]=T[se](D[se]),Q=!0):A[se]=N[se];return Q&&(this.currentCalendarOptionsInput=D,this.currentCalendarOptionsRefined=B,this.stableOptionOverrides=e,this.stableDynamicOptionOverrides=n),this.optionsForHandling.push(...this.optionsForRefining),this.optionsForRefining=[],{rawOptions:this.currentCalendarOptionsInput,refinedOptions:this.currentCalendarOptionsRefined,pluginHooks:w,availableLocaleData:u,localeDefaults:o,extra:A}}_computeCurrentViewData(e,n,r,c){let u=n.viewSpecs[e];if(!u)throw new Error(`viewType "${e}" is not available. Please make sure you've loaded all neccessary plugins`);let{refinedOptions:p,extra:o}=this.processRawViewOptions(u,n.pluginHooks,n.localeDefaults,r,c);a4(o),this.nowManager.handleInput(n.dateEnv,p.now);let w=this.buildDateProfileGenerator({dateProfileGeneratorClass:u.optionDefaults.dateProfileGeneratorClass,nowManager:this.nowManager,duration:u.duration,durationUnit:u.durationUnit,usesMinMaxTime:u.optionDefaults.usesMinMaxTime,dateEnv:n.dateEnv,calendarApi:this.props.calendarApi,slotMinTime:p.slotMinTime,slotMaxTime:p.slotMaxTime,showNonCurrentDates:p.showNonCurrentDates,dayCount:p.dayCount,dateAlignment:p.dateAlignment,dateIncrement:p.dateIncrement,hiddenDays:p.hiddenDays,weekends:p.weekends,validRangeInput:p.validRange,visibleRangeInput:p.visibleRange,fixedWeekCount:p.fixedWeekCount}),T=this.buildViewApi(e,this.getCurrentData,n.dateEnv);return{viewSpec:u,options:p,dateProfileGenerator:w,viewApi:T}}processRawViewOptions(e,n,r,c,u){let p=yT([xb,e.optionDefaults,r,c,e.optionOverrides,u]),o=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},UL),HL),GL),c1e),n.listenerRefiners),n.optionRefiners),w={},T=this.currentViewOptionsInput,A=this.currentViewOptionsRefined,D=!1,B={};for(let N in p)p[N]===T[N]||qm[N]&&qm[N](p[N],T[N])?w[N]=A[N]:(p[N]===this.currentCalendarOptionsInput[N]||qm[N]&&qm[N](p[N],this.currentCalendarOptionsInput[N])?N in this.currentCalendarOptionsRefined&&(w[N]=this.currentCalendarOptionsRefined[N]):o[N]?w[N]=o[N](p[N]):B[N]=p[N],D=!0);return D&&(this.currentViewOptionsInput=p,this.currentViewOptionsRefined=w),{rawOptions:this.currentViewOptionsInput,refinedOptions:this.currentViewOptionsRefined,extra:B}}}function CSe(t,e,n,r,c,u,p,o){let w=H8(e||p.defaultCode,p.map);return new b1e({calendarSystem:"gregory",timeZone:t,namedTimeZoneImpl:u.namedTimeZonedImpl,locale:w,weekNumberCalculation:n,firstDay:r,weekText:c,cmdFormatter:u.cmdFormatter,defaultSeparator:o})}function TSe(t,e){let n=e.themeClasses[t.themeSystem]||Zp;return new n(t)}function ESe(t){let e=t.dateProfileGeneratorClass||n8;return new e(t)}function ISe(t,e,n){return new iSe(t,e,n)}function ASe(t){return lf(t,e=>e.ui)}function kSe(t,e,n){let r={"":e};for(let c in t){let u=t[c];u.sourceId&&n[u.sourceId]&&(r[c]=n[u.sourceId])}return r}function RSe(t){let{options:e}=t;return{eventUiSingleBase:iS({display:e.eventDisplay,editable:e.editable,startEditable:e.eventStartEditable,durationEditable:e.eventDurationEditable,constraint:e.eventConstraint,overlap:typeof e.eventOverlap=="boolean"?e.eventOverlap:void 0,allow:e.eventAllow,backgroundColor:e.eventBackgroundColor,borderColor:e.eventBorderColor,textColor:e.eventTextColor,color:e.eventColor},t),selectionConfig:iS({constraint:e.selectConstraint,overlap:typeof e.selectOverlap=="boolean"?e.selectOverlap:void 0,allow:e.selectAllow},t)}}function IT(t,e){for(let n of e.pluginHooks.isLoadingFuncs)if(n(t))return!0;return!1}function PSe(t){return exe(t.options.businessHours,t)}function a4(t,e){for(let n in t)console.warn(`Unknown option '${n}'`)}class MSe extends Vo{render(){let e=this.props.widgetGroups.map(n=>this.renderWidgetGroup(n));return dt("div",{className:"fc-toolbar-chunk"},...e)}renderWidgetGroup(e){let{props:n}=this,{theme:r}=this.context,c=[],u=!0;for(let p of e){let{buttonName:o,buttonClick:w,buttonText:T,buttonIcon:A,buttonHint:D}=p;if(o==="title")u=!1,c.push(dt("h2",{className:"fc-toolbar-title",id:n.titleId},n.title));else{let B=o===n.activeButton,N=!n.isTodayEnabled&&o==="today"||!n.isPrevEnabled&&o==="prev"||!n.isNextEnabled&&o==="next",ee=[`fc-${o}-button`,r.getClass("button")];B&&ee.push(r.getClass("buttonActive")),c.push(dt("button",{type:"button",title:typeof D=="function"?D(n.navUnit):D,disabled:N,"aria-pressed":B,className:ee.join(" "),onClick:w},T||(A?dt("span",{className:A,role:"img"}):"")))}}if(c.length>1){let p=u&&r.getClass("buttonGroup")||"";return dt("div",{className:p},...c)}return c[0]}}class l4 extends Vo{render(){let{model:e,extraClassName:n}=this.props,r=!1,c,u,p=e.sectionWidgets,o=p.center;return p.left?(r=!0,c=p.left):c=p.start,p.right?(r=!0,u=p.right):u=p.end,dt("div",{className:[n||"","fc-toolbar",r?"fc-toolbar-ltr":""].join(" ")},this.renderSection("start",c||[]),this.renderSection("center",o||[]),this.renderSection("end",u||[]))}renderSection(e,n){let{props:r}=this;return dt(MSe,{key:e,widgetGroups:n,title:r.title,navUnit:r.navUnit,activeButton:r.activeButton,isTodayEnabled:r.isTodayEnabled,isPrevEnabled:r.isPrevEnabled,isNextEnabled:r.isNextEnabled,titleId:r.titleId})}}class DSe extends Vo{constructor(){super(...arguments),this.state={availableWidth:null},this.handleEl=e=>{this.el=e,ah(this.props.elRef,e),this.updateAvailableWidth()},this.handleResize=()=>{this.updateAvailableWidth()}}render(){let{props:e,state:n}=this,{aspectRatio:r}=e,c=["fc-view-harness",r||e.liquid||e.height?"fc-view-harness-active":"fc-view-harness-passive"],u="",p="";return r?n.availableWidth!==null?u=n.availableWidth/r:p=`${1/r*100}%`:u=e.height||"",dt("div",{"aria-labelledby":e.labeledById,ref:this.handleEl,className:c.join(" "),style:{height:u,paddingBottom:p}},e.children)}componentDidMount(){this.context.addResizeHandler(this.handleResize)}componentWillUnmount(){this.context.removeResizeHandler(this.handleResize)}updateAvailableWidth(){this.el&&this.props.aspectRatio&&this.setState({availableWidth:this.el.offsetWidth})}}class OSe extends vy{constructor(e){super(e),this.handleSegClick=(n,r)=>{let{component:c}=this,{context:u}=c,p=uy(r);if(p&&c.isValidSegDownEl(n.target)){let o=fl(n.target,".fc-event-forced-url"),w=o?o.querySelector("a[href]").href:"";u.emitter.trigger("eventClick",{el:r,event:new Bs(c.context,p.eventRange.def,p.eventRange.instance),jsEvent:n,view:u.viewApi}),w&&!n.defaultPrevented&&(window.location.href=w)}},this.destroy=UN(e.el,"click",".fc-event",this.handleSegClick)}}class LSe extends vy{constructor(e){super(e),this.handleEventElRemove=n=>{n===this.currentSegEl&&this.handleSegLeave(null,this.currentSegEl)},this.handleSegEnter=(n,r)=>{uy(r)&&(this.currentSegEl=r,this.triggerEvent("eventMouseEnter",n,r))},this.handleSegLeave=(n,r)=>{this.currentSegEl&&(this.currentSegEl=null,this.triggerEvent("eventMouseLeave",n,r))},this.removeHoverListeners=m0e(e.el,".fc-event",this.handleSegEnter,this.handleSegLeave)}destroy(){this.removeHoverListeners()}triggerEvent(e,n,r){let{component:c}=this,{context:u}=c,p=uy(r);(!n||c.isValidSegDownEl(n.target))&&u.emitter.trigger(e,{el:r,event:new Bs(u,p.eventRange.def,p.eventRange.instance),jsEvent:n,view:u.viewApi})}}class zSe extends Ag{constructor(){super(...arguments),this.buildViewContext=Xi(S1e),this.buildViewPropTransformers=Xi(FSe),this.buildToolbarProps=Xi(BSe),this.headerRef=Hl(),this.footerRef=Hl(),this.interactionsStore={},this.state={viewLabelId:HS()},this.registerInteractiveComponent=(e,n)=>{let r=wxe(e,n),p=[OSe,LSe].concat(this.props.pluginHooks.componentInteractions).map(o=>new o(r));this.interactionsStore[e.uid]=p,OE[e.uid]=r},this.unregisterInteractiveComponent=e=>{let n=this.interactionsStore[e.uid];if(n){for(let r of n)r.destroy();delete this.interactionsStore[e.uid]}delete OE[e.uid]},this.resizeRunner=new dA(()=>{this.props.emitter.trigger("_resize",!0),this.props.emitter.trigger("windowResize",{view:this.props.viewApi})}),this.handleWindowResize=e=>{let{options:n}=this.props;n.handleWindowResize&&e.target===window&&this.resizeRunner.request(n.windowResizeDelay)}}render(){let{props:e}=this,{toolbarConfig:n,options:r}=e,c=!1,u="",p;e.isHeightAuto||e.forPrint?u="":r.height!=null?c=!0:r.contentHeight!=null?u=r.contentHeight:p=Math.max(r.aspectRatio,.5);let o=this.buildViewContext(e.viewSpec,e.viewApi,e.options,e.dateProfileGenerator,e.dateEnv,e.nowManager,e.theme,e.pluginHooks,e.dispatch,e.getCurrentData,e.emitter,e.calendarApi,this.registerInteractiveComponent,this.unregisterInteractiveComponent),w=n.header&&n.header.hasTitle?this.state.viewLabelId:void 0;return dt(ff.Provider,{value:o},dt(by,{unit:"day"},T=>{let A=this.buildToolbarProps(e.viewSpec,e.dateProfile,e.dateProfileGenerator,e.currentDate,T,e.viewTitle);return dt(_s,null,n.header&&dt(l4,Object.assign({ref:this.headerRef,extraClassName:"fc-header-toolbar",model:n.header,titleId:w},A)),dt(DSe,{liquid:c,height:u,aspectRatio:p,labeledById:w},this.renderView(e),this.buildAppendContent()),n.footer&&dt(l4,Object.assign({ref:this.footerRef,extraClassName:"fc-footer-toolbar",model:n.footer,titleId:""},A)))}))}componentDidMount(){let{props:e}=this;this.calendarInteractions=e.pluginHooks.calendarInteractions.map(r=>new r(e)),window.addEventListener("resize",this.handleWindowResize);let{propSetHandlers:n}=e.pluginHooks;for(let r in n)n[r](e[r],e)}componentDidUpdate(e){let{props:n}=this,{propSetHandlers:r}=n.pluginHooks;for(let c in r)n[c]!==e[c]&&r[c](n[c],n)}componentWillUnmount(){window.removeEventListener("resize",this.handleWindowResize),this.resizeRunner.clear();for(let e of this.calendarInteractions)e.destroy();this.props.emitter.trigger("_unmount")}buildAppendContent(){let{props:e}=this,n=e.pluginHooks.viewContainerAppends.map(r=>r(e));return dt(_s,{},...n)}renderView(e){let{pluginHooks:n}=e,{viewSpec:r}=e,c={dateProfile:e.dateProfile,businessHours:e.businessHours,eventStore:e.renderableEventStore,eventUiBases:e.eventUiBases,dateSelection:e.dateSelection,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,isHeightAuto:e.isHeightAuto,forPrint:e.forPrint},u=this.buildViewPropTransformers(n.viewPropsTransformers);for(let o of u)Object.assign(c,o.transform(c,e));let p=r.component;return dt(p,Object.assign({},c))}}function BSe(t,e,n,r,c,u){let p=n.build(c,void 0,!1),o=n.buildPrev(e,r,!1),w=n.buildNext(e,r,!1);return{title:u,activeButton:t.type,navUnit:t.singleUnit,isTodayEnabled:p.isValid&&!nf(e.currentRange,c),isPrevEnabled:o.isValid,isNextEnabled:w.isValid}}function FSe(t){return t.map(e=>new e)}let NSe=class extends Cxe{constructor(e,n={}){super(),this.isRendering=!1,this.isRendered=!1,this.currentClassNames=[],this.customContentRenderId=0,this.handleAction=r=>{switch(r.type){case"SET_EVENT_DRAG":case"SET_EVENT_RESIZE":this.renderRunner.tryDrain()}},this.handleData=r=>{this.currentData=r,this.renderRunner.request(r.calendarOptions.rerenderDelay)},this.handleRenderRequest=()=>{if(this.isRendering){this.isRendered=!0;let{currentData:r}=this;eS(()=>{x0(dt(xxe,{options:r.calendarOptions,theme:r.theme,emitter:r.emitter},(c,u,p,o)=>(this.setClassNames(c),this.setHeight(u),dt(JN.Provider,{value:this.customContentRenderId},dt(zSe,Object.assign({isHeightAuto:p,forPrint:o},r))))),this.el)})}else this.isRendered&&(this.isRendered=!1,x0(null,this.el),this.setClassNames([]),this.setHeight(""))},s0e(e),this.el=e,this.renderRunner=new dA(this.handleRenderRequest),new SSe({optionOverrides:n,calendarApi:this,onAction:this.handleAction,onData:this.handleData})}render(){let e=this.isRendering;e?this.customContentRenderId+=1:this.isRendering=!0,this.renderRunner.request(),e&&this.updateSize()}destroy(){this.isRendering&&(this.isRendering=!1,this.renderRunner.request())}updateSize(){eS(()=>{super.updateSize()})}batchRendering(e){this.renderRunner.pause("batchRendering"),e(),this.renderRunner.resume("batchRendering")}pauseRendering(){this.renderRunner.pause("pauseRendering")}resumeRendering(){this.renderRunner.resume("pauseRendering",!0)}resetOptions(e,n){this.currentDataManager.resetOptions(e,n)}setClassNames(e){if(!jp(e,this.currentClassNames)){let{classList:n}=this.el;for(let r of this.currentClassNames)n.remove(r);for(let r of e)n.add(r);this.currentClassNames=e}}setHeight(e){$N(this.el,"height",e)}};class VSe extends ch{constructor(){super(...arguments),this.headerElRef=Hl()}renderSimpleLayout(e,n){let{props:r,context:c}=this,u=[],p=sS(c.options);return e&&u.push({type:"header",key:"header",isSticky:p,chunk:{elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}}),u.push({type:"body",key:"body",liquid:!0,chunk:{content:n}}),dt(tS,{elClasses:["fc-daygrid"],viewSpec:c.viewSpec},dt(LA,{liquid:!r.isHeightAuto&&!r.forPrint,collapsibleWidth:r.forPrint,cols:[],sections:u}))}renderHScrollLayout(e,n,r,c){let u=this.context.pluginHooks.scrollGridImpl;if(!u)throw new Error("No ScrollGrid implementation");let{props:p,context:o}=this,w=!p.forPrint&&sS(o.options),T=!p.forPrint&&z8(o.options),A=[];return e&&A.push({type:"header",key:"header",isSticky:w,chunks:[{key:"main",elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}]}),A.push({type:"body",key:"body",liquid:!0,chunks:[{key:"main",content:n}]}),T&&A.push({type:"footer",key:"footer",isSticky:!0,chunks:[{key:"main",content:BE}]}),dt(tS,{elClasses:["fc-daygrid"],viewSpec:o.viewSpec},dt(u,{liquid:!p.isHeightAuto&&!p.forPrint,forPrint:p.forPrint,collapsibleWidth:p.forPrint,colGroups:[{cols:[{span:r,minWidth:c}]}],sections:A}))}}function uw(t,e){let n=[];for(let r=0;r<e;r+=1)n[r]=[];for(let r of t)n[r.row].push(r);return n}function Fx(t,e){let n=[];for(let r=0;r<e;r+=1)n[r]=[];for(let r of t)n[r.firstCol].push(r);return n}function c4(t,e){let n=[];if(t){for(let r=0;r<e;r+=1)n[r]={affectedInstances:t.affectedInstances,isEvent:t.isEvent,segs:[]};for(let r of t.segs)n[r.row].segs.push(r)}else for(let r=0;r<e;r+=1)n[r]=null;return n}const Y8=qs({hour:"numeric",minute:"2-digit",omitZeroMinute:!0,meridiem:"narrow"});function J8(t){let{display:e}=t.eventRange.ui;return e==="list-item"||e==="auto"&&!t.eventRange.def.allDay&&t.firstCol===t.lastCol&&t.isStart&&t.isEnd}class Q8 extends Vo{render(){let{props:e}=this;return dt(BA,Object.assign({},e,{elClasses:["fc-daygrid-event","fc-daygrid-block-event","fc-h-event"],defaultTimeFormat:Y8,defaultDisplayEventEnd:e.defaultDisplayEventEnd,disableResizing:!e.seg.eventRange.def.allDay}))}}class e7 extends Vo{render(){let{props:e,context:n}=this,{options:r}=n,{seg:c}=e,u=r.eventTimeFormat||Y8,p=m8(c,u,n,!0,e.defaultDisplayEventEnd);return dt(zA,Object.assign({},e,{elTag:"a",elClasses:["fc-daygrid-event","fc-daygrid-dot-event"],elAttrs:_8(e.seg,n),defaultGenerator:$Se,timeText:p,isResizing:!1,isDateSelecting:!1}))}}function $Se(t){return dt(_s,null,dt("div",{className:"fc-daygrid-event-dot",style:{borderColor:t.borderColor||t.backgroundColor}}),t.timeText&&dt("div",{className:"fc-event-time"},t.timeText),dt("div",{className:"fc-event-title"},t.event.title||dt(_s,null," ")))}class jSe extends Vo{constructor(){super(...arguments),this.compileSegs=Xi(USe)}render(){let{props:e}=this,{allSegs:n,invisibleSegs:r}=this.compileSegs(e.singlePlacements);return dt(V8,{elClasses:["fc-daygrid-more-link"],dateProfile:e.dateProfile,todayRange:e.todayRange,allDayDate:e.allDayDate,moreCnt:e.moreCnt,allSegs:n,hiddenSegs:r,alignmentElRef:e.alignmentElRef,alignGridTop:e.alignGridTop,extraDateSpan:e.extraDateSpan,popoverContent:()=>{let c=(e.eventDrag?e.eventDrag.affectedInstances:null)||(e.eventResize?e.eventResize.affectedInstances:null)||{};return dt(_s,null,n.map(u=>{let p=u.eventRange.instance.instanceId;return dt("div",{className:"fc-daygrid-event-harness",key:p,style:{visibility:c[p]?"hidden":""}},J8(u)?dt(e7,Object.assign({seg:u,isDragging:!1,isSelected:p===e.eventSelection,defaultDisplayEventEnd:!1},zp(u,e.todayRange))):dt(Q8,Object.assign({seg:u,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:p===e.eventSelection,defaultDisplayEventEnd:!1},zp(u,e.todayRange))))}))}})}}function USe(t){let e=[],n=[];for(let r of t)e.push(r.seg),r.isVisible||n.push(r.seg);return{allSegs:e,invisibleSegs:n}}const HSe=qs({week:"narrow"});class GSe extends ch{constructor(){super(...arguments),this.rootElRef=Hl(),this.state={dayNumberId:HS()},this.handleRootEl=e=>{ah(this.rootElRef,e),ah(this.props.elRef,e)}}render(){let{context:e,props:n,state:r,rootElRef:c}=this,{options:u,dateEnv:p}=e,{date:o,dateProfile:w}=n;const T=n.showDayNumber&&qSe(o,w.currentRange,p);return dt(NA,{elTag:"td",elRef:this.handleRootEl,elClasses:["fc-daygrid-day",...n.extraClassNames||[]],elAttrs:Object.assign(Object.assign(Object.assign({},n.extraDataAttrs),n.showDayNumber?{"aria-labelledby":r.dayNumberId}:{}),{role:"gridcell"}),defaultGenerator:WSe,date:o,dateProfile:w,todayRange:n.todayRange,showDayNumber:n.showDayNumber,isMonthStart:T,extraRenderProps:n.extraRenderProps},(A,D)=>dt("div",{ref:n.innerElRef,className:"fc-daygrid-day-frame fc-scrollgrid-sync-inner",style:{minHeight:n.minHeight}},n.showWeekNumber&&dt(N8,{elTag:"a",elClasses:["fc-daygrid-week-number"],elAttrs:oS(e,o,"week"),date:o,defaultFormat:HSe}),!D.isDisabled&&(n.showDayNumber||VA(u)||n.forceDayTop)?dt("div",{className:"fc-daygrid-day-top"},dt(A,{elTag:"a",elClasses:["fc-daygrid-day-number",T&&"fc-daygrid-month-start"],elAttrs:Object.assign(Object.assign({},oS(e,o)),{id:r.dayNumberId})})):n.showDayNumber?dt("div",{className:"fc-daygrid-day-top",style:{visibility:"hidden"}},dt("a",{className:"fc-daygrid-day-number"}," ")):void 0,dt("div",{className:"fc-daygrid-day-events",ref:n.fgContentElRef},n.fgContent,dt("div",{className:"fc-daygrid-day-bottom",style:{marginTop:n.moreMarginTop}},dt(jSe,{allDayDate:o,singlePlacements:n.singlePlacements,moreCnt:n.moreCnt,alignmentElRef:c,alignGridTop:!n.showDayNumber,extraDateSpan:n.extraDateSpan,dateProfile:n.dateProfile,eventSelection:n.eventSelection,eventDrag:n.eventDrag,eventResize:n.eventResize,todayRange:n.todayRange}))),dt("div",{className:"fc-daygrid-day-bg"},n.bgContent)))}}function WSe(t){return t.dayNumberText||dt(_s,null," ")}function qSe(t,e,n){const{start:r,end:c}=e,u=Up(c,-1),p=n.getYear(r),o=n.getMonth(r),w=n.getYear(u),T=n.getMonth(u);return!(p===w&&o===T)&&(t.valueOf()===r.valueOf()||n.getDay(t)===1&&t.valueOf()<c.valueOf())}function t7(t){return t.eventRange.instance.instanceId+":"+t.firstCol}function n7(t){return t7(t)+":"+t.lastCol}function ZSe(t,e,n,r,c,u,p){let o=new YSe(ce=>{let be=t[ce.index].eventRange.instance.instanceId+":"+ce.span.start+":"+(ce.span.end-1);return c[be]||1});o.allowReslicing=!0,o.strictOrder=r,e===!0||n===!0?(o.maxCoord=u,o.hiddenConsumes=!0):typeof e=="number"?o.maxStackCnt=e:typeof n=="number"&&(o.maxStackCnt=n,o.hiddenConsumes=!0);let w=[],T=[];for(let ce=0;ce<t.length;ce+=1){let be=t[ce],ze=n7(be);c[ze]!=null?w.push({index:ce,span:{start:be.firstCol,end:be.lastCol+1}}):T.push(be)}let A=o.addSegs(w),D=o.toRects(),{singleColPlacements:B,multiColPlacements:N,leftoverMargins:ee}=KSe(D,t,p),Q=[],se=[];for(let ce of T){N[ce.firstCol].push({seg:ce,isVisible:!1,isAbsolute:!0,absoluteTop:0,marginTop:0});for(let be=ce.firstCol;be<=ce.lastCol;be+=1)B[be].push({seg:Q_(ce,be,be+1,p),isVisible:!1,isAbsolute:!1,absoluteTop:0,marginTop:0})}for(let ce=0;ce<p.length;ce+=1)Q.push(0);for(let ce of A){let be=t[ce.index],ze=ce.span;N[ze.start].push({seg:Q_(be,ze.start,ze.end,p),isVisible:!1,isAbsolute:!0,absoluteTop:0,marginTop:0});for(let xe=ze.start;xe<ze.end;xe+=1)Q[xe]+=1,B[xe].push({seg:Q_(be,xe,xe+1,p),isVisible:!1,isAbsolute:!1,absoluteTop:0,marginTop:0})}for(let ce=0;ce<p.length;ce+=1)se.push(ee[ce]);return{singleColPlacements:B,multiColPlacements:N,moreCnts:Q,moreMarginTops:se}}function KSe(t,e,n){let r=XSe(t,n.length),c=[],u=[],p=[];for(let o=0;o<n.length;o+=1){let w=r[o],T=[],A=0,D=0;for(let N of w){let ee=e[N.index];T.push({seg:Q_(ee,o,o+1,n),isVisible:!0,isAbsolute:!1,absoluteTop:N.levelCoord,marginTop:N.levelCoord-A}),A=N.levelCoord+N.thickness}let B=[];A=0,D=0;for(let N of w){let ee=e[N.index],Q=N.span.end-N.span.start>1,se=N.span.start===o;D+=N.levelCoord-A,A=N.levelCoord+N.thickness,Q?(D+=N.thickness,se&&B.push({seg:Q_(ee,N.span.start,N.span.end,n),isVisible:!0,isAbsolute:!0,absoluteTop:N.levelCoord,marginTop:0})):se&&(B.push({seg:Q_(ee,N.span.start,N.span.end,n),isVisible:!0,isAbsolute:!1,absoluteTop:N.levelCoord,marginTop:D}),D=0)}c.push(T),u.push(B),p.push(D)}return{singleColPlacements:c,multiColPlacements:u,leftoverMargins:p}}function XSe(t,e){let n=[];for(let r=0;r<e;r+=1)n.push([]);for(let r of t)for(let c=r.span.start;c<r.span.end;c+=1)n[c].push(r);return n}function Q_(t,e,n,r){if(t.firstCol===e&&t.lastCol===n-1)return t;let c=t.eventRange,u=c.range,p=vg(u,{start:r[e].date,end:za(r[n-1].date,1)});return Object.assign(Object.assign({},t),{firstCol:e,lastCol:n-1,eventRange:{def:c.def,ui:Object.assign(Object.assign({},c.ui),{durationEditable:!1}),instance:c.instance,range:p},isStart:t.isStart&&p.start.valueOf()===u.start.valueOf(),isEnd:t.isEnd&&p.end.valueOf()===u.end.valueOf()})}class YSe extends T8{constructor(){super(...arguments),this.hiddenConsumes=!1,this.forceHidden={}}addSegs(e){const n=super.addSegs(e),{entriesByLevel:r}=this,c=u=>!this.forceHidden[dg(u)];for(let u=0;u<r.length;u+=1)r[u]=r[u].filter(c);return n}handleInvalidInsertion(e,n,r){const{entriesByLevel:c,forceHidden:u}=this,{touchingEntry:p,touchingLevel:o,touchingLateral:w}=e;if(this.hiddenConsumes&&p){const T=dg(p);if(!u[T])if(this.allowReslicing){const A=Object.assign(Object.assign({},p),{span:DA(p.span,n.span)}),D=dg(A);u[D]=!0,c[o][w]=A,r.push(A),this.splitEntry(p,n,r)}else u[T]=!0,r.push(p)}super.handleInvalidInsertion(e,n,r)}}class i7 extends ch{constructor(){super(...arguments),this.cellElRefs=new Qh,this.frameElRefs=new Qh,this.fgElRefs=new Qh,this.segHarnessRefs=new Qh,this.rootElRef=Hl(),this.state={framePositions:null,maxContentHeight:null,segHeights:{}},this.handleResize=e=>{e&&this.updateSizing(!0)}}render(){let{props:e,state:n,context:r}=this,{options:c}=r,u=e.cells.length,p=Fx(e.businessHourSegs,u),o=Fx(e.bgEventSegs,u),w=Fx(this.getHighlightSegs(),u),T=Fx(this.getMirrorSegs(),u),{singleColPlacements:A,multiColPlacements:D,moreCnts:B,moreMarginTops:N}=ZSe(p8(e.fgEventSegs,c.eventOrder),e.dayMaxEvents,e.dayMaxEventRows,c.eventOrderStrict,n.segHeights,n.maxContentHeight,e.cells),ee=e.eventDrag&&e.eventDrag.affectedInstances||e.eventResize&&e.eventResize.affectedInstances||{};return dt("tr",{ref:this.rootElRef,role:"row"},e.renderIntro&&e.renderIntro(),e.cells.map((Q,se)=>{let ce=this.renderFgSegs(se,e.forPrint?A[se]:D[se],e.todayRange,ee),be=this.renderFgSegs(se,JSe(T[se],D),e.todayRange,{},!!e.eventDrag,!!e.eventResize,!1);return dt(GSe,{key:Q.key,elRef:this.cellElRefs.createRef(Q.key),innerElRef:this.frameElRefs.createRef(Q.key),dateProfile:e.dateProfile,date:Q.date,showDayNumber:e.showDayNumbers,showWeekNumber:e.showWeekNumbers&&se===0,forceDayTop:e.showWeekNumbers,todayRange:e.todayRange,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,extraRenderProps:Q.extraRenderProps,extraDataAttrs:Q.extraDataAttrs,extraClassNames:Q.extraClassNames,extraDateSpan:Q.extraDateSpan,moreCnt:B[se],moreMarginTop:N[se],singlePlacements:A[se],fgContentElRef:this.fgElRefs.createRef(Q.key),fgContent:dt(_s,null,dt(_s,null,ce),dt(_s,null,be)),bgContent:dt(_s,null,this.renderFillSegs(w[se],"highlight"),this.renderFillSegs(p[se],"non-business"),this.renderFillSegs(o[se],"bg-event")),minHeight:e.cellMinHeight})}))}componentDidMount(){this.updateSizing(!0),this.context.addResizeHandler(this.handleResize)}componentDidUpdate(e,n){let r=this.props;this.updateSizing(!fd(e,r))}componentWillUnmount(){this.context.removeResizeHandler(this.handleResize)}getHighlightSegs(){let{props:e}=this;return e.eventDrag&&e.eventDrag.segs.length?e.eventDrag.segs:e.eventResize&&e.eventResize.segs.length?e.eventResize.segs:e.dateSelectionSegs}getMirrorSegs(){let{props:e}=this;return e.eventResize&&e.eventResize.segs.length?e.eventResize.segs:[]}renderFgSegs(e,n,r,c,u,p,o){let{context:w}=this,{eventSelection:T}=this.props,{framePositions:A}=this.state,D=this.props.cells.length===1,B=u||p||o,N=[];if(A)for(let ee of n){let{seg:Q}=ee,{instanceId:se}=Q.eventRange.instance,ce=ee.isVisible&&!c[se],be=ee.isAbsolute,ze="",xe="";be&&(w.isRtl?(xe=0,ze=A.lefts[Q.lastCol]-A.lefts[Q.firstCol]):(ze=0,xe=A.rights[Q.firstCol]-A.rights[Q.lastCol])),N.push(dt("div",{className:"fc-daygrid-event-harness"+(be?" fc-daygrid-event-harness-abs":""),key:t7(Q),ref:B?null:this.segHarnessRefs.createRef(n7(Q)),style:{visibility:ce?"":"hidden",marginTop:be?"":ee.marginTop,top:be?ee.absoluteTop:"",left:ze,right:xe}},J8(Q)?dt(e7,Object.assign({seg:Q,isDragging:u,isSelected:se===T,defaultDisplayEventEnd:D},zp(Q,r))):dt(Q8,Object.assign({seg:Q,isDragging:u,isResizing:p,isDateSelecting:o,isSelected:se===T,defaultDisplayEventEnd:D},zp(Q,r)))))}return N}renderFillSegs(e,n){let{isRtl:r}=this.context,{todayRange:c}=this.props,{framePositions:u}=this.state,p=[];if(u)for(let o of e){let w=r?{right:0,left:u.lefts[o.lastCol]-u.lefts[o.firstCol]}:{left:0,right:u.rights[o.firstCol]-u.rights[o.lastCol]};p.push(dt("div",{key:g8(o.eventRange),className:"fc-daygrid-bg-harness",style:w},n==="bg-event"?dt(B8,Object.assign({seg:o},zp(o,c))):F8(n)))}return dt(_s,{},...p)}updateSizing(e){let{props:n,state:r,frameElRefs:c}=this;if(!n.forPrint&&n.clientWidth!==null){if(e){let w=n.cells.map(T=>c.currentMap[T.key]);if(w.length){let T=this.rootElRef.current,A=new dy(T,w,!0,!1);(!r.framePositions||!r.framePositions.similarTo(A))&&this.setState({framePositions:new dy(T,w,!0,!1)})}}const u=this.state.segHeights,p=this.querySegHeights(),o=n.dayMaxEvents===!0||n.dayMaxEventRows===!0;this.safeSetState({segHeights:Object.assign(Object.assign({},u),p),maxContentHeight:o?this.computeMaxContentHeight():null})}}querySegHeights(){let e=this.segHarnessRefs.currentMap,n={};for(let r in e){let c=Math.round(e[r].getBoundingClientRect().height);n[r]=Math.max(n[r]||0,c)}return n}computeMaxContentHeight(){let e=this.props.cells[0].key,n=this.cellElRefs.currentMap[e],r=this.fgElRefs.currentMap[e];return n.getBoundingClientRect().bottom-r.getBoundingClientRect().top}getCellEls(){let e=this.cellElRefs.currentMap;return this.props.cells.map(n=>e[n.key])}}i7.addStateEquality({segHeights:fd});function JSe(t,e){if(!t.length)return[];let n=QSe(e);return t.map(r=>({seg:r,isVisible:!0,isAbsolute:!0,absoluteTop:n[r.eventRange.instance.instanceId],marginTop:0}))}function QSe(t){let e={};for(let n of t)for(let r of n)e[r.seg.eventRange.instance.instanceId]=r.absoluteTop;return e}class eCe extends ch{constructor(){super(...arguments),this.splitBusinessHourSegs=Xi(uw),this.splitBgEventSegs=Xi(tCe),this.splitFgEventSegs=Xi(uw),this.splitDateSelectionSegs=Xi(uw),this.splitEventDrag=Xi(c4),this.splitEventResize=Xi(c4),this.rowRefs=new Qh}render(){let{props:e,context:n}=this,r=e.cells.length,c=this.splitBusinessHourSegs(e.businessHourSegs,r),u=this.splitBgEventSegs(e.bgEventSegs,r),p=this.splitFgEventSegs(e.fgEventSegs,r),o=this.splitDateSelectionSegs(e.dateSelectionSegs,r),w=this.splitEventDrag(e.eventDrag,r),T=this.splitEventResize(e.eventResize,r),A=r>=7&&e.clientWidth?e.clientWidth/n.options.aspectRatio/6:null;return dt(by,{unit:"day"},(D,B)=>dt(_s,null,e.cells.map((N,ee)=>dt(i7,{ref:this.rowRefs.createRef(ee),key:N.length?N[0].date.toISOString():ee,showDayNumbers:r>1,showWeekNumbers:e.showWeekNumbers,todayRange:B,dateProfile:e.dateProfile,cells:N,renderIntro:e.renderRowIntro,businessHourSegs:c[ee],eventSelection:e.eventSelection,bgEventSegs:u[ee],fgEventSegs:p[ee],dateSelectionSegs:o[ee],eventDrag:w[ee],eventResize:T[ee],dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,clientWidth:e.clientWidth,clientHeight:e.clientHeight,cellMinHeight:A,forPrint:e.forPrint}))))}componentDidMount(){this.registerInteractiveComponent()}componentDidUpdate(){this.registerInteractiveComponent()}registerInteractiveComponent(){if(!this.rootEl){const e=this.rowRefs.currentMap[0].getCellEls()[0],n=e?e.closest(".fc-daygrid-body"):null;n&&(this.rootEl=n,this.context.registerInteractiveComponent(this,{el:n,isHitComboAllowed:this.props.isHitComboAllowed}))}}componentWillUnmount(){this.rootEl&&(this.context.unregisterInteractiveComponent(this),this.rootEl=null)}prepareHits(){this.rowPositions=new dy(this.rootEl,this.rowRefs.collect().map(e=>e.getCellEls()[0]),!1,!0),this.colPositions=new dy(this.rootEl,this.rowRefs.currentMap[0].getCellEls(),!0,!1)}queryHit(e,n){let{colPositions:r,rowPositions:c}=this,u=r.leftToIndex(e),p=c.topToIndex(n);if(p!=null&&u!=null){let o=this.props.cells[p][u];return{dateProfile:this.props.dateProfile,dateSpan:Object.assign({range:this.getCellRange(p,u),allDay:!0},o.extraDateSpan),dayEl:this.getCellEl(p,u),rect:{left:r.lefts[u],right:r.rights[u],top:c.tops[p],bottom:c.bottoms[p]},layer:0}}return null}getCellEl(e,n){return this.rowRefs.currentMap[e].getCellEls()[n]}getCellRange(e,n){let r=this.props.cells[e][n].date,c=za(r,1);return{start:r,end:c}}}function tCe(t,e){return uw(t.filter(nCe),e)}function nCe(t){return t.eventRange.def.allDay}class iCe extends ch{constructor(){super(...arguments),this.elRef=Hl(),this.needsScrollReset=!1}render(){let{props:e}=this,{dayMaxEventRows:n,dayMaxEvents:r,expandRows:c}=e,u=r===!0||n===!0;u&&!c&&(u=!1,n=null,r=null);let p=["fc-daygrid-body",u?"fc-daygrid-body-balanced":"fc-daygrid-body-unbalanced",c?"":"fc-daygrid-body-natural"];return dt("div",{ref:this.elRef,className:p.join(" "),style:{width:e.clientWidth,minWidth:e.tableMinWidth}},dt("table",{role:"presentation",className:"fc-scrollgrid-sync-table",style:{width:e.clientWidth,minWidth:e.tableMinWidth,height:c?e.clientHeight:""}},e.colGroupNode,dt("tbody",{role:"presentation"},dt(eCe,{dateProfile:e.dateProfile,cells:e.cells,renderRowIntro:e.renderRowIntro,showWeekNumbers:e.showWeekNumbers,clientWidth:e.clientWidth,clientHeight:e.clientHeight,businessHourSegs:e.businessHourSegs,bgEventSegs:e.bgEventSegs,fgEventSegs:e.fgEventSegs,dateSelectionSegs:e.dateSelectionSegs,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,dayMaxEvents:r,dayMaxEventRows:n,forPrint:e.forPrint,isHitComboAllowed:e.isHitComboAllowed}))))}componentDidMount(){this.requestScrollReset()}componentDidUpdate(e){e.dateProfile!==this.props.dateProfile?this.requestScrollReset():this.flushScrollReset()}requestScrollReset(){this.needsScrollReset=!0,this.flushScrollReset()}flushScrollReset(){if(this.needsScrollReset&&this.props.clientWidth){const e=rCe(this.elRef.current,this.props.dateProfile);if(e){const n=e.closest(".fc-daygrid-body"),r=n.closest(".fc-scroller"),c=e.getBoundingClientRect().top-n.getBoundingClientRect().top;r.scrollTop=c?c+1:0}this.needsScrollReset=!1}}}function rCe(t,e){let n;return e.currentRangeUnit.match(/year|month/)&&(n=t.querySelector(`[data-date="${W0e(e.currentDate)}-01"]`)),n||(n=t.querySelector(`[data-date="${gA(e.currentDate)}"]`)),n}class oCe extends P8{constructor(){super(...arguments),this.forceDayIfListItem=!0}sliceRange(e,n){return n.sliceRange(e)}}class r7 extends ch{constructor(){super(...arguments),this.slicer=new oCe,this.tableRef=Hl()}render(){let{props:e,context:n}=this;return dt(iCe,Object.assign({ref:this.tableRef},this.slicer.sliceProps(e,e.dateProfile,e.nextDayThreshold,n,e.dayTableModel),{dateProfile:e.dateProfile,cells:e.dayTableModel.cells,colGroupNode:e.colGroupNode,tableMinWidth:e.tableMinWidth,renderRowIntro:e.renderRowIntro,dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,showWeekNumbers:e.showWeekNumbers,expandRows:e.expandRows,headerAlignElRef:e.headerAlignElRef,clientWidth:e.clientWidth,clientHeight:e.clientHeight,forPrint:e.forPrint}))}}class sCe extends VSe{constructor(){super(...arguments),this.buildDayTableModel=Xi(aCe),this.headerRef=Hl(),this.tableRef=Hl()}render(){let{options:e,dateProfileGenerator:n}=this.context,{props:r}=this,c=this.buildDayTableModel(r.dateProfile,n),u=e.dayHeaders&&dt(A8,{ref:this.headerRef,dateProfile:r.dateProfile,dates:c.headerDates,datesRepDistinctDays:c.rowCnt===1}),p=o=>dt(r7,{ref:this.tableRef,dateProfile:r.dateProfile,dayTableModel:c,businessHours:r.businessHours,dateSelection:r.dateSelection,eventStore:r.eventStore,eventUiBases:r.eventUiBases,eventSelection:r.eventSelection,eventDrag:r.eventDrag,eventResize:r.eventResize,nextDayThreshold:e.nextDayThreshold,colGroupNode:o.tableColGroupNode,tableMinWidth:o.tableMinWidth,dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,showWeekNumbers:e.weekNumbers,expandRows:!r.isHeightAuto,headerAlignElRef:this.headerElRef,clientWidth:o.clientWidth,clientHeight:o.clientHeight,forPrint:r.forPrint});return e.dayMinWidth?this.renderHScrollLayout(u,p,c.colCnt,e.dayMinWidth):this.renderSimpleLayout(u,p)}}function aCe(t,e){let n=new k8(t.renderRange,e);return new R8(n,/year|month|week/.test(t.currentRangeUnit))}class lCe extends n8{buildRenderRange(e,n,r){let c=super.buildRenderRange(e,n,r),{props:u}=this;return cCe({currentRange:c,snapToWeek:/^(year|month)$/.test(n),fixedWeekCount:u.fixedWeekCount,dateEnv:u.dateEnv})}}function cCe(t){let{dateEnv:e,currentRange:n}=t,{start:r,end:c}=n,u;if(t.snapToWeek&&(r=e.startOfWeek(r),u=e.startOfWeek(c),u.valueOf()!==c.valueOf()&&(c=FL(u,1))),t.fixedWeekCount){let p=e.startOfWeek(e.startOfMonth(za(n.end,-1))),o=Math.ceil(L0e(p,c));c=FL(c,6-o)}return{start:r,end:c}}var uCe=':root{--fc-daygrid-event-dot-width:8px}.fc-daygrid-day-events:after,.fc-daygrid-day-events:before,.fc-daygrid-day-frame:after,.fc-daygrid-day-frame:before,.fc-daygrid-event-harness:after,.fc-daygrid-event-harness:before{clear:both;content:"";display:table}.fc .fc-daygrid-body{position:relative;z-index:1}.fc .fc-daygrid-day.fc-day-today{background-color:var(--fc-today-bg-color)}.fc .fc-daygrid-day-frame{min-height:100%;position:relative}.fc .fc-daygrid-day-top{display:flex;flex-direction:row-reverse}.fc .fc-day-other .fc-daygrid-day-top{opacity:.3}.fc .fc-daygrid-day-number{padding:4px;position:relative;z-index:4}.fc .fc-daygrid-month-start{font-size:1.1em;font-weight:700}.fc .fc-daygrid-day-events{margin-top:1px}.fc .fc-daygrid-body-balanced .fc-daygrid-day-events{left:0;position:absolute;right:0}.fc .fc-daygrid-body-unbalanced .fc-daygrid-day-events{min-height:2em;position:relative}.fc .fc-daygrid-body-natural .fc-daygrid-day-events{margin-bottom:1em}.fc .fc-daygrid-event-harness{position:relative}.fc .fc-daygrid-event-harness-abs{left:0;position:absolute;right:0;top:0}.fc .fc-daygrid-bg-harness{bottom:0;position:absolute;top:0}.fc .fc-daygrid-day-bg .fc-non-business{z-index:1}.fc .fc-daygrid-day-bg .fc-bg-event{z-index:2}.fc .fc-daygrid-day-bg .fc-highlight{z-index:3}.fc .fc-daygrid-event{margin-top:1px;z-index:6}.fc .fc-daygrid-event.fc-event-mirror{z-index:7}.fc .fc-daygrid-day-bottom{font-size:.85em;margin:0 2px}.fc .fc-daygrid-day-bottom:after,.fc .fc-daygrid-day-bottom:before{clear:both;content:"";display:table}.fc .fc-daygrid-more-link{border-radius:3px;cursor:pointer;line-height:1;margin-top:1px;max-width:100%;overflow:hidden;padding:2px;position:relative;white-space:nowrap;z-index:4}.fc .fc-daygrid-more-link:hover{background-color:rgba(0,0,0,.1)}.fc .fc-daygrid-week-number{background-color:var(--fc-neutral-bg-color);color:var(--fc-neutral-text-color);min-width:1.5em;padding:2px;position:absolute;text-align:center;top:0;z-index:5}.fc .fc-more-popover .fc-popover-body{min-width:220px;padding:10px}.fc-direction-ltr .fc-daygrid-event.fc-event-start,.fc-direction-rtl .fc-daygrid-event.fc-event-end{margin-left:2px}.fc-direction-ltr .fc-daygrid-event.fc-event-end,.fc-direction-rtl .fc-daygrid-event.fc-event-start{margin-right:2px}.fc-direction-ltr .fc-daygrid-more-link{float:left}.fc-direction-ltr .fc-daygrid-week-number{border-radius:0 0 3px 0;left:0}.fc-direction-rtl .fc-daygrid-more-link{float:right}.fc-direction-rtl .fc-daygrid-week-number{border-radius:0 0 0 3px;right:0}.fc-liquid-hack .fc-daygrid-day-frame{position:static}.fc-daygrid-event{border-radius:3px;font-size:var(--fc-small-font-size);position:relative;white-space:nowrap}.fc-daygrid-block-event .fc-event-time{font-weight:700}.fc-daygrid-block-event .fc-event-time,.fc-daygrid-block-event .fc-event-title{padding:1px}.fc-daygrid-dot-event{align-items:center;display:flex;padding:2px 0}.fc-daygrid-dot-event .fc-event-title{flex-grow:1;flex-shrink:1;font-weight:700;min-width:0;overflow:hidden}.fc-daygrid-dot-event.fc-event-mirror,.fc-daygrid-dot-event:hover{background:rgba(0,0,0,.1)}.fc-daygrid-dot-event.fc-event-selected:before{bottom:-10px;top:-10px}.fc-daygrid-event-dot{border:calc(var(--fc-daygrid-event-dot-width)/2) solid var(--fc-event-border-color);border-radius:calc(var(--fc-daygrid-event-dot-width)/2);box-sizing:content-box;height:0;margin:0 4px;width:0}.fc-direction-ltr .fc-daygrid-event .fc-event-time{margin-right:3px}.fc-direction-rtl .fc-daygrid-event .fc-event-time{margin-left:3px}';uA(uCe);var dCe=pf({name:"@fullcalendar/daygrid",initialView:"dayGridMonth",views:{dayGrid:{component:sCe,dateProfileGeneratorClass:lCe},dayGridDay:{type:"dayGrid",duration:{days:1}},dayGridWeek:{type:"dayGrid",duration:{weeks:1}},dayGridMonth:{type:"dayGrid",duration:{months:1},fixedWeekCount:!0},dayGridYear:{type:"dayGrid",duration:{years:1}}}});class hCe extends kxe{getKeyInfo(){return{allDay:{},timed:{}}}getKeysForDateSpan(e){return e.allDay?["allDay"]:["timed"]}getKeysForEventDef(e){return e.allDay?oxe(e)?["timed","allDay"]:["allDay"]:["timed"]}}const fCe=qs({hour:"numeric",minute:"2-digit",omitZeroMinute:!0,meridiem:"short"});function o7(t){let e=["fc-timegrid-slot","fc-timegrid-slot-label",t.isLabeled?"fc-scrollgrid-shrink":"fc-timegrid-slot-minor"];return dt(ff.Consumer,null,n=>{if(!t.isLabeled)return dt("td",{className:e.join(" "),"data-time":t.isoTimeStr});let{dateEnv:r,options:c,viewApi:u}=n,p=c.slotLabelFormat==null?fCe:Array.isArray(c.slotLabelFormat)?qs(c.slotLabelFormat[0]):qs(c.slotLabelFormat),o={level:0,time:t.time,date:r.toDate(t.date),view:u,text:r.format(t.date,p)};return dt(Vc,{elTag:"td",elClasses:e,elAttrs:{"data-time":t.isoTimeStr},renderProps:o,generatorName:"slotLabelContent",customGenerator:c.slotLabelContent,defaultGenerator:pCe,classNameGenerator:c.slotLabelClassNames,didMount:c.slotLabelDidMount,willUnmount:c.slotLabelWillUnmount},w=>dt("div",{className:"fc-timegrid-slot-label-frame fc-scrollgrid-shrink-frame"},dt(w,{elTag:"div",elClasses:["fc-timegrid-slot-label-cushion","fc-scrollgrid-shrink-cushion"]})))})}function pCe(t){return t.text}class mCe extends Vo{render(){return this.props.slatMetas.map(e=>dt("tr",{key:e.key},dt(o7,Object.assign({},e))))}}const gCe=qs({week:"short"}),_Ce=5;class yCe extends ch{constructor(){super(...arguments),this.allDaySplitter=new hCe,this.headerElRef=Hl(),this.rootElRef=Hl(),this.scrollerElRef=Hl(),this.state={slatCoords:null},this.handleScrollTopRequest=e=>{let n=this.scrollerElRef.current;n&&(n.scrollTop=e)},this.renderHeadAxis=(e,n="")=>{let{options:r}=this.context,{dateProfile:c}=this.props,u=c.renderRange,o=Ig(u.start,u.end)===1?oS(this.context,u.start,"week"):{};return r.weekNumbers&&e==="day"?dt(N8,{elTag:"th",elClasses:["fc-timegrid-axis","fc-scrollgrid-shrink"],elAttrs:{"aria-hidden":!0},date:u.start,defaultFormat:gCe},w=>dt("div",{className:["fc-timegrid-axis-frame","fc-scrollgrid-shrink-frame","fc-timegrid-axis-frame-liquid"].join(" "),style:{height:n}},dt(w,{elTag:"a",elClasses:["fc-timegrid-axis-cushion","fc-scrollgrid-shrink-cushion","fc-scrollgrid-sync-inner"],elAttrs:o}))):dt("th",{"aria-hidden":!0,className:"fc-timegrid-axis"},dt("div",{className:"fc-timegrid-axis-frame",style:{height:n}}))},this.renderTableRowAxis=e=>{let{options:n,viewApi:r}=this.context,c={text:n.allDayText,view:r};return dt(Vc,{elTag:"td",elClasses:["fc-timegrid-axis","fc-scrollgrid-shrink"],elAttrs:{"aria-hidden":!0},renderProps:c,generatorName:"allDayContent",customGenerator:n.allDayContent,defaultGenerator:vCe,classNameGenerator:n.allDayClassNames,didMount:n.allDayDidMount,willUnmount:n.allDayWillUnmount},u=>dt("div",{className:["fc-timegrid-axis-frame","fc-scrollgrid-shrink-frame",e==null?" fc-timegrid-axis-frame-liquid":""].join(" "),style:{height:e}},dt(u,{elTag:"span",elClasses:["fc-timegrid-axis-cushion","fc-scrollgrid-shrink-cushion","fc-scrollgrid-sync-inner"]})))},this.handleSlatCoords=e=>{this.setState({slatCoords:e})}}renderSimpleLayout(e,n,r){let{context:c,props:u}=this,p=[],o=sS(c.options);return e&&p.push({type:"header",key:"header",isSticky:o,chunk:{elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}}),n&&(p.push({type:"body",key:"all-day",chunk:{content:n}}),p.push({type:"body",key:"all-day-divider",outerContent:dt("tr",{role:"presentation",className:"fc-scrollgrid-section"},dt("td",{className:"fc-timegrid-divider "+c.theme.getClass("tableCellShaded")}))})),p.push({type:"body",key:"body",liquid:!0,expandRows:!!c.options.expandRows,chunk:{scrollerElRef:this.scrollerElRef,content:r}}),dt(tS,{elRef:this.rootElRef,elClasses:["fc-timegrid"],viewSpec:c.viewSpec},dt(LA,{liquid:!u.isHeightAuto&&!u.forPrint,collapsibleWidth:u.forPrint,cols:[{width:"shrink"}],sections:p}))}renderHScrollLayout(e,n,r,c,u,p,o){let w=this.context.pluginHooks.scrollGridImpl;if(!w)throw new Error("No ScrollGrid implementation");let{context:T,props:A}=this,D=!A.forPrint&&sS(T.options),B=!A.forPrint&&z8(T.options),N=[];e&&N.push({type:"header",key:"header",isSticky:D,syncRowHeights:!0,chunks:[{key:"axis",rowContent:Q=>dt("tr",{role:"presentation"},this.renderHeadAxis("day",Q.rowSyncHeights[0]))},{key:"cols",elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}]}),n&&(N.push({type:"body",key:"all-day",syncRowHeights:!0,chunks:[{key:"axis",rowContent:Q=>dt("tr",{role:"presentation"},this.renderTableRowAxis(Q.rowSyncHeights[0]))},{key:"cols",content:n}]}),N.push({key:"all-day-divider",type:"body",outerContent:dt("tr",{role:"presentation",className:"fc-scrollgrid-section"},dt("td",{colSpan:2,className:"fc-timegrid-divider "+T.theme.getClass("tableCellShaded")}))}));let ee=T.options.nowIndicator;return N.push({type:"body",key:"body",liquid:!0,expandRows:!!T.options.expandRows,chunks:[{key:"axis",content:Q=>dt("div",{className:"fc-timegrid-axis-chunk"},dt("table",{"aria-hidden":!0,style:{height:Q.expandRows?Q.clientHeight:""}},Q.tableColGroupNode,dt("tbody",null,dt(mCe,{slatMetas:p}))),dt("div",{className:"fc-timegrid-now-indicator-container"},dt(by,{unit:ee?"minute":"day"},se=>{let ce=ee&&o&&o.safeComputeTop(se);return typeof ce=="number"?dt(FA,{elClasses:["fc-timegrid-now-indicator-arrow"],elStyle:{top:ce},isAxis:!0,date:se}):null})))},{key:"cols",scrollerElRef:this.scrollerElRef,content:r}]}),B&&N.push({key:"footer",type:"footer",isSticky:!0,chunks:[{key:"axis",content:BE},{key:"cols",content:BE}]}),dt(tS,{elRef:this.rootElRef,elClasses:["fc-timegrid"],viewSpec:T.viewSpec},dt(w,{liquid:!A.isHeightAuto&&!A.forPrint,forPrint:A.forPrint,collapsibleWidth:!1,colGroups:[{width:"shrink",cols:[{width:"shrink"}]},{cols:[{span:c,minWidth:u}]}],sections:N}))}getAllDayMaxEventProps(){let{dayMaxEvents:e,dayMaxEventRows:n}=this.context.options;return(e===!0||n===!0)&&(e=void 0,n=_Ce),{dayMaxEvents:e,dayMaxEventRows:n}}}function vCe(t){return t.text}class bCe{constructor(e,n,r){this.positions=e,this.dateProfile=n,this.slotDuration=r}safeComputeTop(e){let{dateProfile:n}=this;if(nf(n.currentRange,e)){let r=ys(e),c=e.valueOf()-r.valueOf();if(c>=od(n.slotMinTime)&&c<od(n.slotMaxTime))return this.computeTimeTop(so(c))}return null}computeDateTop(e,n){return n||(n=ys(e)),this.computeTimeTop(so(e.valueOf()-n.valueOf()))}computeTimeTop(e){let{positions:n,dateProfile:r}=this,c=n.els.length,u=(e.milliseconds-od(r.slotMinTime))/od(this.slotDuration),p,o;return u=Math.max(0,u),u=Math.min(c,u),p=Math.floor(u),p=Math.min(p,c-1),o=u-p,n.tops[p]+n.getHeight(p)*o}}class xCe extends Vo{render(){let{props:e,context:n}=this,{options:r}=n,{slatElRefs:c}=e;return dt("tbody",null,e.slatMetas.map((u,p)=>{let o={time:u.time,date:n.dateEnv.toDate(u.date),view:n.viewApi};return dt("tr",{key:u.key,ref:c.createRef(u.key)},e.axis&&dt(o7,Object.assign({},u)),dt(Vc,{elTag:"td",elClasses:["fc-timegrid-slot","fc-timegrid-slot-lane",!u.isLabeled&&"fc-timegrid-slot-minor"],elAttrs:{"data-time":u.isoTimeStr},renderProps:o,generatorName:"slotLaneContent",customGenerator:r.slotLaneContent,classNameGenerator:r.slotLaneClassNames,didMount:r.slotLaneDidMount,willUnmount:r.slotLaneWillUnmount}))}))}}class wCe extends Vo{constructor(){super(...arguments),this.rootElRef=Hl(),this.slatElRefs=new Qh}render(){let{props:e,context:n}=this;return dt("div",{ref:this.rootElRef,className:"fc-timegrid-slots"},dt("table",{"aria-hidden":!0,className:n.theme.getClass("table"),style:{minWidth:e.tableMinWidth,width:e.clientWidth,height:e.minHeight}},e.tableColGroupNode,dt(xCe,{slatElRefs:this.slatElRefs,axis:e.axis,slatMetas:e.slatMetas})))}componentDidMount(){this.updateSizing()}componentDidUpdate(){this.updateSizing()}componentWillUnmount(){this.props.onCoords&&this.props.onCoords(null)}updateSizing(){let{context:e,props:n}=this;n.onCoords&&n.clientWidth!==null&&this.rootElRef.current.offsetHeight&&n.onCoords(new bCe(new dy(this.rootElRef.current,SCe(this.slatElRefs.currentMap,n.slatMetas),!1,!0),this.props.dateProfile,e.options.slotDuration))}}function SCe(t,e){return e.map(n=>t[n.key])}function Hv(t,e){let n=[],r;for(r=0;r<e;r+=1)n.push([]);if(t)for(r=0;r<t.length;r+=1)n[t[r].col].push(t[r]);return n}function u4(t,e){let n=[];if(t){for(let r=0;r<e;r+=1)n[r]={affectedInstances:t.affectedInstances,isEvent:t.isEvent,segs:[]};for(let r of t.segs)n[r.col].segs.push(r)}else for(let r=0;r<e;r+=1)n[r]=null;return n}class CCe extends Vo{render(){let{props:e}=this;return dt(V8,{elClasses:["fc-timegrid-more-link"],elStyle:{top:e.top,bottom:e.bottom},allDayDate:null,moreCnt:e.hiddenSegs.length,allSegs:e.hiddenSegs,hiddenSegs:e.hiddenSegs,extraDateSpan:e.extraDateSpan,dateProfile:e.dateProfile,todayRange:e.todayRange,popoverContent:()=>a7(e.hiddenSegs,e),defaultGenerator:TCe,forceTimed:!0},n=>dt(n,{elTag:"div",elClasses:["fc-timegrid-more-link-inner","fc-sticky"]}))}}function TCe(t){return t.shortText}function ECe(t,e,n){let r=new T8;e!=null&&(r.strictOrder=e),n!=null&&(r.maxStackCnt=n);let c=r.addSegs(t),u=jxe(c),p=ICe(r);return p=PCe(p,1),{segRects:MCe(p),hiddenGroups:u}}function ICe(t){const{entriesByLevel:e}=t,n=jA((r,c)=>r+":"+c,(r,c)=>{let u=RCe(t,r,c),p=d4(u,n),o=e[r][c];return[Object.assign(Object.assign({},o),{nextLevelNodes:p[0]}),o.thickness+p[1]]});return d4(e.length?{level:0,lateralStart:0,lateralEnd:e[0].length}:null,n)[0]}function d4(t,e){if(!t)return[[],0];let{level:n,lateralStart:r,lateralEnd:c}=t,u=r,p=[];for(;u<c;)p.push(e(n,u)),u+=1;return p.sort(ACe),[p.map(kCe),p[0][1]]}function ACe(t,e){return e[1]-t[1]}function kCe(t){return t[0]}function RCe(t,e,n){let{levelCoords:r,entriesByLevel:c}=t,u=c[e][n],p=r[e]+u.thickness,o=r.length,w=e;for(;w<o&&r[w]<p;w+=1);for(;w<o;w+=1){let T=c[w],A,D=zE(T,u.span.start,LE),B=D[0]+D[1],N=B;for(;(A=T[N])&&A.span.start<u.span.end;)N+=1;if(B<N)return{level:w,lateralStart:B,lateralEnd:N}}return null}function PCe(t,e){const n=jA((r,c,u)=>dg(r),(r,c,u)=>{let{nextLevelNodes:p,thickness:o}=r,w=o+u,T=o/w,A,D=[];if(!p.length)A=e;else for(let N of p)if(A===void 0){let ee=n(N,c,w);A=ee[0],D.push(ee[1])}else{let ee=n(N,A,0);D.push(ee[1])}let B=(A-c)*T;return[A-B,Object.assign(Object.assign({},r),{thickness:B,nextLevelNodes:D})]});return t.map(r=>n(r,0,0)[1])}function MCe(t){let e=[];const n=jA((c,u,p)=>dg(c),(c,u,p)=>{let o=Object.assign(Object.assign({},c),{levelCoord:u,stackDepth:p,stackForward:0});return e.push(o),o.stackForward=r(c.nextLevelNodes,u+c.thickness,p+1)+1});function r(c,u,p){let o=0;for(let w of c)o=Math.max(n(w,u,p),o);return o}return r(t,0,0),e}function jA(t,e){const n={};return(...r)=>{let c=t(...r);return c in n?n[c]:n[c]=e(...r)}}function h4(t,e,n=null,r=0){let c=[];if(n)for(let u=0;u<t.length;u+=1){let p=t[u],o=n.computeDateTop(p.start,e),w=Math.max(o+(r||0),n.computeDateTop(p.end,e));c.push({start:Math.round(o),end:Math.round(w)})}return c}function DCe(t,e,n,r){let c=[],u=[];for(let T=0;T<t.length;T+=1){let A=e[T];A?c.push({index:T,thickness:1,span:A}):u.push(t[T])}let{segRects:p,hiddenGroups:o}=ECe(c,n,r),w=[];for(let T of p)w.push({seg:t[T.index],rect:T});for(let T of u)w.push({seg:T,rect:null});return{segPlacements:w,hiddenGroups:o}}const OCe=qs({hour:"numeric",minute:"2-digit",meridiem:!1});class s7 extends Vo{render(){return dt(BA,Object.assign({},this.props,{elClasses:["fc-timegrid-event","fc-v-event",this.props.isShort&&"fc-timegrid-event-short"],defaultTimeFormat:OCe}))}}class LCe extends Vo{constructor(){super(...arguments),this.sortEventSegs=Xi(p8)}render(){let{props:e,context:n}=this,{options:r}=n,c=r.selectMirror,u=e.eventDrag&&e.eventDrag.segs||e.eventResize&&e.eventResize.segs||c&&e.dateSelectionSegs||[],p=e.eventDrag&&e.eventDrag.affectedInstances||e.eventResize&&e.eventResize.affectedInstances||{},o=this.sortEventSegs(e.fgEventSegs,r.eventOrder);return dt(NA,{elTag:"td",elRef:e.elRef,elClasses:["fc-timegrid-col",...e.extraClassNames||[]],elAttrs:Object.assign({role:"gridcell"},e.extraDataAttrs),date:e.date,dateProfile:e.dateProfile,todayRange:e.todayRange,extraRenderProps:e.extraRenderProps},w=>dt("div",{className:"fc-timegrid-col-frame"},dt("div",{className:"fc-timegrid-col-bg"},this.renderFillSegs(e.businessHourSegs,"non-business"),this.renderFillSegs(e.bgEventSegs,"bg-event"),this.renderFillSegs(e.dateSelectionSegs,"highlight")),dt("div",{className:"fc-timegrid-col-events"},this.renderFgSegs(o,p,!1,!1,!1)),dt("div",{className:"fc-timegrid-col-events"},this.renderFgSegs(u,{},!!e.eventDrag,!!e.eventResize,!!c,"mirror")),dt("div",{className:"fc-timegrid-now-indicator-container"},this.renderNowIndicator(e.nowIndicatorSegs)),VA(r)&&dt(w,{elTag:"div",elClasses:["fc-timegrid-col-misc"]})))}renderFgSegs(e,n,r,c,u,p){let{props:o}=this;return o.forPrint?a7(e,o):this.renderPositionedFgSegs(e,n,r,c,u,p)}renderPositionedFgSegs(e,n,r,c,u,p){let{eventMaxStack:o,eventShortHeight:w,eventOrderStrict:T,eventMinHeight:A}=this.context.options,{date:D,slatCoords:B,eventSelection:N,todayRange:ee,nowDate:Q}=this.props,se=r||c||u,ce=h4(e,D,B,A),{segPlacements:be,hiddenGroups:ze}=DCe(e,ce,T,o);return dt(_s,null,this.renderHiddenGroups(ze,e),be.map(xe=>{let{seg:je,rect:qe}=xe,oe=je.eventRange.instance.instanceId,de=se||!!(!n[oe]&&qe),Ee=AT(qe&&qe.span),$e=!se&&qe?this.computeSegHStyle(qe):{left:0,right:0},me=!!qe&&qe.stackForward>0,Te=!!qe&&qe.span.end-qe.span.start<w;return dt("div",{className:"fc-timegrid-event-harness"+(me?" fc-timegrid-event-harness-inset":""),key:p||oe,style:Object.assign(Object.assign({visibility:de?"":"hidden"},Ee),$e)},dt(s7,Object.assign({seg:je,isDragging:r,isResizing:c,isDateSelecting:u,isSelected:oe===N,isShort:Te},zp(je,ee,Q))))}))}renderHiddenGroups(e,n){let{extraDateSpan:r,dateProfile:c,todayRange:u,nowDate:p,eventSelection:o,eventDrag:w,eventResize:T}=this.props;return dt(_s,null,e.map(A=>{let D=AT(A.span),B=zCe(A.entries,n);return dt(CCe,{key:qN($8(B)),hiddenSegs:B,top:D.top,bottom:D.bottom,extraDateSpan:r,dateProfile:c,todayRange:u,nowDate:p,eventSelection:o,eventDrag:w,eventResize:T})}))}renderFillSegs(e,n){let{props:r,context:c}=this,p=h4(e,r.date,r.slatCoords,c.options.eventMinHeight).map((o,w)=>{let T=e[w];return dt("div",{key:g8(T.eventRange),className:"fc-timegrid-bg-harness",style:AT(o)},n==="bg-event"?dt(B8,Object.assign({seg:T},zp(T,r.todayRange,r.nowDate))):F8(n))});return dt(_s,null,p)}renderNowIndicator(e){let{slatCoords:n,date:r}=this.props;return n?e.map((c,u)=>dt(FA,{key:u,elClasses:["fc-timegrid-now-indicator-line"],elStyle:{top:n.computeDateTop(c.start,r)},isAxis:!1,date:r})):null}computeSegHStyle(e){let{isRtl:n,options:r}=this.context,c=r.slotEventOverlap,u=e.levelCoord,p=e.levelCoord+e.thickness,o,w;c&&(p=Math.min(1,u+(p-u)*2)),n?(o=1-p,w=u):(o=u,w=1-p);let T={zIndex:e.stackDepth+1,left:o*100+"%",right:w*100+"%"};return c&&!e.stackForward&&(T[n?"marginLeft":"marginRight"]=10*2),T}}function a7(t,{todayRange:e,nowDate:n,eventSelection:r,eventDrag:c,eventResize:u}){let p=(c?c.affectedInstances:null)||(u?u.affectedInstances:null)||{};return dt(_s,null,t.map(o=>{let w=o.eventRange.instance.instanceId;return dt("div",{key:w,style:{visibility:p[w]?"hidden":""}},dt(s7,Object.assign({seg:o,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:w===r,isShort:!1},zp(o,e,n))))}))}function AT(t){return t?{top:t.start,bottom:-t.end}:{top:"",bottom:""}}function zCe(t,e){return t.map(n=>e[n.index])}class BCe extends Vo{constructor(){super(...arguments),this.splitFgEventSegs=Xi(Hv),this.splitBgEventSegs=Xi(Hv),this.splitBusinessHourSegs=Xi(Hv),this.splitNowIndicatorSegs=Xi(Hv),this.splitDateSelectionSegs=Xi(Hv),this.splitEventDrag=Xi(u4),this.splitEventResize=Xi(u4),this.rootElRef=Hl(),this.cellElRefs=new Qh}render(){let{props:e,context:n}=this,r=n.options.nowIndicator&&e.slatCoords&&e.slatCoords.safeComputeTop(e.nowDate),c=e.cells.length,u=this.splitFgEventSegs(e.fgEventSegs,c),p=this.splitBgEventSegs(e.bgEventSegs,c),o=this.splitBusinessHourSegs(e.businessHourSegs,c),w=this.splitNowIndicatorSegs(e.nowIndicatorSegs,c),T=this.splitDateSelectionSegs(e.dateSelectionSegs,c),A=this.splitEventDrag(e.eventDrag,c),D=this.splitEventResize(e.eventResize,c);return dt("div",{className:"fc-timegrid-cols",ref:this.rootElRef},dt("table",{role:"presentation",style:{minWidth:e.tableMinWidth,width:e.clientWidth}},e.tableColGroupNode,dt("tbody",{role:"presentation"},dt("tr",{role:"row"},e.axis&&dt("td",{"aria-hidden":!0,className:"fc-timegrid-col fc-timegrid-axis"},dt("div",{className:"fc-timegrid-col-frame"},dt("div",{className:"fc-timegrid-now-indicator-container"},typeof r=="number"&&dt(FA,{elClasses:["fc-timegrid-now-indicator-arrow"],elStyle:{top:r},isAxis:!0,date:e.nowDate})))),e.cells.map((B,N)=>dt(LCe,{key:B.key,elRef:this.cellElRefs.createRef(B.key),dateProfile:e.dateProfile,date:B.date,nowDate:e.nowDate,todayRange:e.todayRange,extraRenderProps:B.extraRenderProps,extraDataAttrs:B.extraDataAttrs,extraClassNames:B.extraClassNames,extraDateSpan:B.extraDateSpan,fgEventSegs:u[N],bgEventSegs:p[N],businessHourSegs:o[N],nowIndicatorSegs:w[N],dateSelectionSegs:T[N],eventDrag:A[N],eventResize:D[N],slatCoords:e.slatCoords,eventSelection:e.eventSelection,forPrint:e.forPrint}))))))}componentDidMount(){this.updateCoords()}componentDidUpdate(){this.updateCoords()}updateCoords(){let{props:e}=this;e.onColCoords&&e.clientWidth!==null&&e.onColCoords(new dy(this.rootElRef.current,FCe(this.cellElRefs.currentMap,e.cells),!0,!1))}}function FCe(t,e){return e.map(n=>t[n.key])}class NCe extends ch{constructor(){super(...arguments),this.processSlotOptions=Xi(VCe),this.state={slatCoords:null},this.handleRootEl=e=>{e?this.context.registerInteractiveComponent(this,{el:e,isHitComboAllowed:this.props.isHitComboAllowed}):this.context.unregisterInteractiveComponent(this)},this.handleScrollRequest=e=>{let{onScrollTopRequest:n}=this.props,{slatCoords:r}=this.state;if(n&&r){if(e.time){let c=r.computeTimeTop(e.time);c=Math.ceil(c),c&&(c+=1),n(c)}return!0}return!1},this.handleColCoords=e=>{this.colCoords=e},this.handleSlatCoords=e=>{this.setState({slatCoords:e}),this.props.onSlatCoords&&this.props.onSlatCoords(e)}}render(){let{props:e,state:n}=this;return dt("div",{className:"fc-timegrid-body",ref:this.handleRootEl,style:{width:e.clientWidth,minWidth:e.tableMinWidth}},dt(wCe,{axis:e.axis,dateProfile:e.dateProfile,slatMetas:e.slatMetas,clientWidth:e.clientWidth,minHeight:e.expandRows?e.clientHeight:"",tableMinWidth:e.tableMinWidth,tableColGroupNode:e.axis?e.tableColGroupNode:null,onCoords:this.handleSlatCoords}),dt(BCe,{cells:e.cells,axis:e.axis,dateProfile:e.dateProfile,businessHourSegs:e.businessHourSegs,bgEventSegs:e.bgEventSegs,fgEventSegs:e.fgEventSegs,dateSelectionSegs:e.dateSelectionSegs,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,todayRange:e.todayRange,nowDate:e.nowDate,nowIndicatorSegs:e.nowIndicatorSegs,clientWidth:e.clientWidth,tableMinWidth:e.tableMinWidth,tableColGroupNode:e.tableColGroupNode,slatCoords:n.slatCoords,onColCoords:this.handleColCoords,forPrint:e.forPrint}))}componentDidMount(){this.scrollResponder=this.context.createScrollResponder(this.handleScrollRequest)}componentDidUpdate(e){this.scrollResponder.update(e.dateProfile!==this.props.dateProfile)}componentWillUnmount(){this.scrollResponder.detach()}queryHit(e,n){let{dateEnv:r,options:c}=this.context,{colCoords:u}=this,{dateProfile:p}=this.props,{slatCoords:o}=this.state,{snapDuration:w,snapsPerSlot:T}=this.processSlotOptions(this.props.slotDuration,c.snapDuration),A=u.leftToIndex(e),D=o.positions.topToIndex(n);if(A!=null&&D!=null){let B=this.props.cells[A],N=o.positions.tops[D],ee=o.positions.getHeight(D),Q=(n-N)/ee,se=Math.floor(Q*T),ce=D*T+se,be=this.props.cells[A].date,ze=kE(p.slotMinTime,P0e(w,ce)),xe=r.add(be,ze),je=r.add(xe,w);return{dateProfile:p,dateSpan:Object.assign({range:{start:xe,end:je},allDay:!1},B.extraDateSpan),dayEl:u.els[A],rect:{left:u.lefts[A],right:u.rights[A],top:N,bottom:N+ee},layer:0}}return null}}function VCe(t,e){let n=e||t,r=mA(t,n);return r===null&&(n=t,r=1),{snapDuration:n,snapsPerSlot:r}}class $Ce extends P8{sliceRange(e,n){let r=[];for(let c=0;c<n.length;c+=1){let u=vg(e,n[c]);u&&r.push({start:u.start,end:u.end,isStart:u.start.valueOf()===e.start.valueOf(),isEnd:u.end.valueOf()===e.end.valueOf(),col:c})}return r}}class jCe extends ch{constructor(){super(...arguments),this.buildDayRanges=Xi(UCe),this.slicer=new $Ce,this.timeColsRef=Hl()}render(){let{props:e,context:n}=this,{dateProfile:r,dayTableModel:c}=e,{nowIndicator:u,nextDayThreshold:p}=n.options,o=this.buildDayRanges(c,r,n.dateEnv);return dt(by,{unit:u?"minute":"day"},(w,T)=>dt(NCe,Object.assign({ref:this.timeColsRef},this.slicer.sliceProps(e,r,null,n,o),{forPrint:e.forPrint,axis:e.axis,dateProfile:r,slatMetas:e.slatMetas,slotDuration:e.slotDuration,cells:c.cells[0],tableColGroupNode:e.tableColGroupNode,tableMinWidth:e.tableMinWidth,clientWidth:e.clientWidth,clientHeight:e.clientHeight,expandRows:e.expandRows,nowDate:w,nowIndicatorSegs:u&&this.slicer.sliceNowDate(w,r,p,n,o),todayRange:T,onScrollTopRequest:e.onScrollTopRequest,onSlatCoords:e.onSlatCoords})))}}function UCe(t,e,n){let r=[];for(let c of t.headerDates)r.push({start:n.add(c,e.slotMinTime),end:n.add(c,e.slotMaxTime)});return r}const f4=[{hours:1},{minutes:30},{minutes:15},{seconds:30},{seconds:15}];function HCe(t,e,n,r,c){let u=new Date(0),p=t,o=so(0),w=n||GCe(r),T=[];for(;od(p)<od(e);){let A=c.add(u,p),D=mA(o,w)!==null;T.push({date:A,time:p,key:A.toISOString(),isoTimeStr:q0e(A),isLabeled:D}),p=kE(p,r),o=kE(o,r)}return T}function GCe(t){let e,n,r;for(e=f4.length-1;e>=0;e-=1)if(n=so(f4[e]),r=mA(n,t),r!==null&&r>1)return n;return t}class WCe extends yCe{constructor(){super(...arguments),this.buildTimeColsModel=Xi(qCe),this.buildSlatMetas=Xi(HCe)}render(){let{options:e,dateEnv:n,dateProfileGenerator:r}=this.context,{props:c}=this,{dateProfile:u}=c,p=this.buildTimeColsModel(u,r),o=this.allDaySplitter.splitProps(c),w=this.buildSlatMetas(u.slotMinTime,u.slotMaxTime,e.slotLabelInterval,e.slotDuration,n),{dayMinWidth:T}=e,A=!T,D=T,B=e.dayHeaders&&dt(A8,{dates:p.headerDates,dateProfile:u,datesRepDistinctDays:!0,renderIntro:A?this.renderHeadAxis:null}),N=e.allDaySlot!==!1&&(Q=>dt(r7,Object.assign({},o.allDay,{dateProfile:u,dayTableModel:p,nextDayThreshold:e.nextDayThreshold,tableMinWidth:Q.tableMinWidth,colGroupNode:Q.tableColGroupNode,renderRowIntro:A?this.renderTableRowAxis:null,showWeekNumbers:!1,expandRows:!1,headerAlignElRef:this.headerElRef,clientWidth:Q.clientWidth,clientHeight:Q.clientHeight,forPrint:c.forPrint},this.getAllDayMaxEventProps()))),ee=Q=>dt(jCe,Object.assign({},o.timed,{dayTableModel:p,dateProfile:u,axis:A,slotDuration:e.slotDuration,slatMetas:w,forPrint:c.forPrint,tableColGroupNode:Q.tableColGroupNode,tableMinWidth:Q.tableMinWidth,clientWidth:Q.clientWidth,clientHeight:Q.clientHeight,onSlatCoords:this.handleSlatCoords,expandRows:Q.expandRows,onScrollTopRequest:this.handleScrollTopRequest}));return D?this.renderHScrollLayout(B,N,ee,p.colCnt,T,w,this.state.slatCoords):this.renderSimpleLayout(B,N,ee)}}function qCe(t,e){let n=new k8(t.renderRange,e);return new R8(n,!1)}var ZCe='.fc-v-event{background-color:var(--fc-event-bg-color);border:1px solid var(--fc-event-border-color);display:block}.fc-v-event .fc-event-main{color:var(--fc-event-text-color);height:100%}.fc-v-event .fc-event-main-frame{display:flex;flex-direction:column;height:100%}.fc-v-event .fc-event-time{flex-grow:0;flex-shrink:0;max-height:100%;overflow:hidden}.fc-v-event .fc-event-title-container{flex-grow:1;flex-shrink:1;min-height:0}.fc-v-event .fc-event-title{bottom:0;max-height:100%;overflow:hidden;top:0}.fc-v-event:not(.fc-event-start){border-top-left-radius:0;border-top-right-radius:0;border-top-width:0}.fc-v-event:not(.fc-event-end){border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom-width:0}.fc-v-event.fc-event-selected:before{left:-10px;right:-10px}.fc-v-event .fc-event-resizer-start{cursor:n-resize}.fc-v-event .fc-event-resizer-end{cursor:s-resize}.fc-v-event:not(.fc-event-selected) .fc-event-resizer{height:var(--fc-event-resizer-thickness);left:0;right:0}.fc-v-event:not(.fc-event-selected) .fc-event-resizer-start{top:calc(var(--fc-event-resizer-thickness)/-2)}.fc-v-event:not(.fc-event-selected) .fc-event-resizer-end{bottom:calc(var(--fc-event-resizer-thickness)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer{left:50%;margin-left:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer-start{top:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer-end{bottom:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc .fc-timegrid .fc-daygrid-body{z-index:2}.fc .fc-timegrid-divider{padding:0 0 2px}.fc .fc-timegrid-body{min-height:100%;position:relative;z-index:1}.fc .fc-timegrid-axis-chunk{position:relative}.fc .fc-timegrid-axis-chunk>table,.fc .fc-timegrid-slots{position:relative;z-index:1}.fc .fc-timegrid-slot{border-bottom:0;height:1.5em}.fc .fc-timegrid-slot:empty:before{content:"\\00a0"}.fc .fc-timegrid-slot-minor{border-top-style:dotted}.fc .fc-timegrid-slot-label-cushion{display:inline-block;white-space:nowrap}.fc .fc-timegrid-slot-label{vertical-align:middle}.fc .fc-timegrid-axis-cushion,.fc .fc-timegrid-slot-label-cushion{padding:0 4px}.fc .fc-timegrid-axis-frame-liquid{height:100%}.fc .fc-timegrid-axis-frame{align-items:center;display:flex;justify-content:flex-end;overflow:hidden}.fc .fc-timegrid-axis-cushion{flex-shrink:0;max-width:60px}.fc-direction-ltr .fc-timegrid-slot-label-frame{text-align:right}.fc-direction-rtl .fc-timegrid-slot-label-frame{text-align:left}.fc-liquid-hack .fc-timegrid-axis-frame-liquid{bottom:0;height:auto;left:0;position:absolute;right:0;top:0}.fc .fc-timegrid-col.fc-day-today{background-color:var(--fc-today-bg-color)}.fc .fc-timegrid-col-frame{min-height:100%;position:relative}.fc-media-screen.fc-liquid-hack .fc-timegrid-col-frame{bottom:0;height:auto;left:0;position:absolute;right:0;top:0}.fc-media-screen .fc-timegrid-cols{bottom:0;left:0;position:absolute;right:0;top:0}.fc-media-screen .fc-timegrid-cols>table{height:100%}.fc-media-screen .fc-timegrid-col-bg,.fc-media-screen .fc-timegrid-col-events,.fc-media-screen .fc-timegrid-now-indicator-container{left:0;position:absolute;right:0;top:0}.fc .fc-timegrid-col-bg{z-index:2}.fc .fc-timegrid-col-bg .fc-non-business{z-index:1}.fc .fc-timegrid-col-bg .fc-bg-event{z-index:2}.fc .fc-timegrid-col-bg .fc-highlight{z-index:3}.fc .fc-timegrid-bg-harness{left:0;position:absolute;right:0}.fc .fc-timegrid-col-events{z-index:3}.fc .fc-timegrid-now-indicator-container{bottom:0;overflow:hidden}.fc-direction-ltr .fc-timegrid-col-events{margin:0 2.5% 0 2px}.fc-direction-rtl .fc-timegrid-col-events{margin:0 2px 0 2.5%}.fc-timegrid-event-harness{position:absolute}.fc-timegrid-event-harness>.fc-timegrid-event{bottom:0;left:0;position:absolute;right:0;top:0}.fc-timegrid-event-harness-inset .fc-timegrid-event,.fc-timegrid-event.fc-event-mirror,.fc-timegrid-more-link{box-shadow:0 0 0 1px var(--fc-page-bg-color)}.fc-timegrid-event,.fc-timegrid-more-link{border-radius:3px;font-size:var(--fc-small-font-size)}.fc-timegrid-event{margin-bottom:1px}.fc-timegrid-event .fc-event-main{padding:1px 1px 0}.fc-timegrid-event .fc-event-time{font-size:var(--fc-small-font-size);margin-bottom:1px;white-space:nowrap}.fc-timegrid-event-short .fc-event-main-frame{flex-direction:row;overflow:hidden}.fc-timegrid-event-short .fc-event-time:after{content:"\\00a0-\\00a0"}.fc-timegrid-event-short .fc-event-title{font-size:var(--fc-small-font-size)}.fc-timegrid-more-link{background:var(--fc-more-link-bg-color);color:var(--fc-more-link-text-color);cursor:pointer;margin-bottom:1px;position:absolute;z-index:9999}.fc-timegrid-more-link-inner{padding:3px 2px;top:0}.fc-direction-ltr .fc-timegrid-more-link{right:0}.fc-direction-rtl .fc-timegrid-more-link{left:0}.fc .fc-timegrid-now-indicator-arrow,.fc .fc-timegrid-now-indicator-line{pointer-events:none}.fc .fc-timegrid-now-indicator-line{border-color:var(--fc-now-indicator-color);border-style:solid;border-width:1px 0 0;left:0;position:absolute;right:0;z-index:4}.fc .fc-timegrid-now-indicator-arrow{border-color:var(--fc-now-indicator-color);border-style:solid;margin-top:-5px;position:absolute;z-index:4}.fc-direction-ltr .fc-timegrid-now-indicator-arrow{border-bottom-color:transparent;border-top-color:transparent;border-width:5px 0 5px 6px;left:0}.fc-direction-rtl .fc-timegrid-now-indicator-arrow{border-bottom-color:transparent;border-top-color:transparent;border-width:5px 6px 5px 0;right:0}';uA(ZCe);const KCe={allDaySlot:Boolean};var XCe=pf({name:"@fullcalendar/timegrid",initialView:"timeGridWeek",optionRefiners:KCe,views:{timeGrid:{component:WCe,usesMinMaxTime:!0,allDaySlot:!0,slotDuration:"00:30:00",slotEventOverlap:!0},timeGridDay:{type:"timeGrid",duration:{days:1}},timeGridWeek:{type:"timeGrid",duration:{weeks:1}}}});OA.touchMouseIgnoreWait=500;let NE=0,aS=0,VE=!1;class l7{constructor(e){this.subjectEl=null,this.selector="",this.handleSelector="",this.shouldIgnoreMove=!1,this.shouldWatchScroll=!0,this.isDragging=!1,this.isTouchDragging=!1,this.wasTouchScroll=!1,this.handleMouseDown=n=>{if(!this.shouldIgnoreMouse()&&YCe(n)&&this.tryStart(n)){let r=this.createEventFromMouse(n,!0);this.emitter.trigger("pointerdown",r),this.initScrollWatch(r),this.shouldIgnoreMove||document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)}},this.handleMouseMove=n=>{let r=this.createEventFromMouse(n);this.recordCoords(r),this.emitter.trigger("pointermove",r)},this.handleMouseUp=n=>{document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),this.emitter.trigger("pointerup",this.createEventFromMouse(n)),this.cleanup()},this.handleTouchStart=n=>{if(this.tryStart(n)){this.isTouchDragging=!0;let r=this.createEventFromTouch(n,!0);this.emitter.trigger("pointerdown",r),this.initScrollWatch(r);let c=n.target;this.shouldIgnoreMove||c.addEventListener("touchmove",this.handleTouchMove),c.addEventListener("touchend",this.handleTouchEnd),c.addEventListener("touchcancel",this.handleTouchEnd),window.addEventListener("scroll",this.handleTouchScroll,!0)}},this.handleTouchMove=n=>{let r=this.createEventFromTouch(n);this.recordCoords(r),this.emitter.trigger("pointermove",r)},this.handleTouchEnd=n=>{if(this.isDragging){let r=n.target;r.removeEventListener("touchmove",this.handleTouchMove),r.removeEventListener("touchend",this.handleTouchEnd),r.removeEventListener("touchcancel",this.handleTouchEnd),window.removeEventListener("scroll",this.handleTouchScroll,!0),this.emitter.trigger("pointerup",this.createEventFromTouch(n)),this.cleanup(),this.isTouchDragging=!1,JCe()}},this.handleTouchScroll=()=>{this.wasTouchScroll=!0},this.handleScroll=n=>{if(!this.shouldIgnoreMove){let r=window.scrollX-this.prevScrollX+this.prevPageX,c=window.scrollY-this.prevScrollY+this.prevPageY;this.emitter.trigger("pointermove",{origEvent:n,isTouch:this.isTouchDragging,subjectEl:this.subjectEl,pageX:r,pageY:c,deltaX:r-this.origPageX,deltaY:c-this.origPageY})}},this.containerEl=e,this.emitter=new ZS,e.addEventListener("mousedown",this.handleMouseDown),e.addEventListener("touchstart",this.handleTouchStart,{passive:!0}),QCe()}destroy(){this.containerEl.removeEventListener("mousedown",this.handleMouseDown),this.containerEl.removeEventListener("touchstart",this.handleTouchStart,{passive:!0}),e2e()}tryStart(e){let n=this.querySubjectEl(e),r=e.target;return n&&(!this.handleSelector||fl(r,this.handleSelector))?(this.subjectEl=n,this.isDragging=!0,this.wasTouchScroll=!1,!0):!1}cleanup(){VE=!1,this.isDragging=!1,this.subjectEl=null,this.destroyScrollWatch()}querySubjectEl(e){return this.selector?fl(e.target,this.selector):this.containerEl}shouldIgnoreMouse(){return NE||this.isTouchDragging}cancelTouchScroll(){this.isDragging&&(VE=!0)}initScrollWatch(e){this.shouldWatchScroll&&(this.recordCoords(e),window.addEventListener("scroll",this.handleScroll,!0))}recordCoords(e){this.shouldWatchScroll&&(this.prevPageX=e.pageX,this.prevPageY=e.pageY,this.prevScrollX=window.scrollX,this.prevScrollY=window.scrollY)}destroyScrollWatch(){this.shouldWatchScroll&&window.removeEventListener("scroll",this.handleScroll,!0)}createEventFromMouse(e,n){let r=0,c=0;return n?(this.origPageX=e.pageX,this.origPageY=e.pageY):(r=e.pageX-this.origPageX,c=e.pageY-this.origPageY),{origEvent:e,isTouch:!1,subjectEl:this.subjectEl,pageX:e.pageX,pageY:e.pageY,deltaX:r,deltaY:c}}createEventFromTouch(e,n){let r=e.touches,c,u,p=0,o=0;return r&&r.length?(c=r[0].pageX,u=r[0].pageY):(c=e.pageX,u=e.pageY),n?(this.origPageX=c,this.origPageY=u):(p=c-this.origPageX,o=u-this.origPageY),{origEvent:e,isTouch:!0,subjectEl:this.subjectEl,pageX:c,pageY:u,deltaX:p,deltaY:o}}}function YCe(t){return t.button===0&&!t.ctrlKey}function JCe(){NE+=1,setTimeout(()=>{NE-=1},OA.touchMouseIgnoreWait)}function QCe(){aS+=1,aS===1&&window.addEventListener("touchmove",c7,{passive:!1})}function e2e(){aS-=1,aS||window.removeEventListener("touchmove",c7,{passive:!1})}function c7(t){VE&&t.preventDefault()}class t2e{constructor(){this.isVisible=!1,this.sourceEl=null,this.mirrorEl=null,this.sourceElRect=null,this.parentNode=document.body,this.zIndex=9999,this.revertDuration=0}start(e,n,r){this.sourceEl=e,this.sourceElRect=this.sourceEl.getBoundingClientRect(),this.origScreenX=n-window.scrollX,this.origScreenY=r-window.scrollY,this.deltaX=0,this.deltaY=0,this.updateElPosition()}handleMove(e,n){this.deltaX=e-window.scrollX-this.origScreenX,this.deltaY=n-window.scrollY-this.origScreenY,this.updateElPosition()}setIsVisible(e){e?this.isVisible||(this.mirrorEl&&(this.mirrorEl.style.display=""),this.isVisible=e,this.updateElPosition()):this.isVisible&&(this.mirrorEl&&(this.mirrorEl.style.display="none"),this.isVisible=e)}stop(e,n){let r=()=>{this.cleanup(),n()};e&&this.mirrorEl&&this.isVisible&&this.revertDuration&&(this.deltaX||this.deltaY)?this.doRevertAnimation(r,this.revertDuration):setTimeout(r,0)}doRevertAnimation(e,n){let r=this.mirrorEl,c=this.sourceEl.getBoundingClientRect();r.style.transition="top "+n+"ms,left "+n+"ms",vb(r,{left:c.left,top:c.top}),g0e(r,()=>{r.style.transition="",e()})}cleanup(){this.mirrorEl&&(hA(this.mirrorEl),this.mirrorEl=null),this.sourceEl=null}updateElPosition(){this.sourceEl&&this.isVisible&&vb(this.getMirrorEl(),{left:this.sourceElRect.left+this.deltaX,top:this.sourceElRect.top+this.deltaY})}getMirrorEl(){let e=this.sourceElRect,n=this.mirrorEl;return n||(n=this.mirrorEl=this.sourceEl.cloneNode(!0),n.style.userSelect="none",n.style.webkitUserSelect="none",n.style.pointerEvents="none",n.classList.add("fc-event-dragging"),vb(n,{position:"fixed",zIndex:this.zIndex,visibility:"",boxSizing:"border-box",width:e.right-e.left,height:e.bottom-e.top,right:"auto",bottom:"auto",margin:0}),this.parentNode.appendChild(n)),n}}class u7 extends MA{constructor(e,n){super(),this.handleScroll=()=>{this.scrollTop=this.scrollController.getScrollTop(),this.scrollLeft=this.scrollController.getScrollLeft(),this.handleScrollChange()},this.scrollController=e,this.doesListening=n,this.scrollTop=this.origScrollTop=e.getScrollTop(),this.scrollLeft=this.origScrollLeft=e.getScrollLeft(),this.scrollWidth=e.getScrollWidth(),this.scrollHeight=e.getScrollHeight(),this.clientWidth=e.getClientWidth(),this.clientHeight=e.getClientHeight(),this.clientRect=this.computeClientRect(),this.doesListening&&this.getEventTarget().addEventListener("scroll",this.handleScroll)}destroy(){this.doesListening&&this.getEventTarget().removeEventListener("scroll",this.handleScroll)}getScrollTop(){return this.scrollTop}getScrollLeft(){return this.scrollLeft}setScrollTop(e){this.scrollController.setScrollTop(e),this.doesListening||(this.scrollTop=Math.max(Math.min(e,this.getMaxScrollTop()),0),this.handleScrollChange())}setScrollLeft(e){this.scrollController.setScrollLeft(e),this.doesListening||(this.scrollLeft=Math.max(Math.min(e,this.getMaxScrollLeft()),0),this.handleScrollChange())}getClientWidth(){return this.clientWidth}getClientHeight(){return this.clientHeight}getScrollWidth(){return this.scrollWidth}getScrollHeight(){return this.scrollHeight}handleScrollChange(){}}class d7 extends u7{constructor(e,n){super(new Vxe(e),n)}getEventTarget(){return this.scrollController.el}computeClientRect(){return Fxe(this.scrollController.el)}}class n2e extends u7{constructor(e){super(new $xe,e)}getEventTarget(){return window}computeClientRect(){return{left:this.scrollLeft,right:this.scrollLeft+this.clientWidth,top:this.scrollTop,bottom:this.scrollTop+this.clientHeight}}handleScrollChange(){this.clientRect=this.computeClientRect()}}const p4=typeof performance=="function"?performance.now:Date.now;class i2e{constructor(){this.isEnabled=!0,this.scrollQuery=[window,".fc-scroller"],this.edgeThreshold=50,this.maxVelocity=300,this.pointerScreenX=null,this.pointerScreenY=null,this.isAnimating=!1,this.scrollCaches=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.animate=()=>{if(this.isAnimating){let e=this.computeBestEdge(this.pointerScreenX+window.scrollX,this.pointerScreenY+window.scrollY);if(e){let n=p4();this.handleSide(e,(n-this.msSinceRequest)/1e3),this.requestAnimation(n)}else this.isAnimating=!1}}}start(e,n,r){this.isEnabled&&(this.scrollCaches=this.buildCaches(r),this.pointerScreenX=null,this.pointerScreenY=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.handleMove(e,n))}handleMove(e,n){if(this.isEnabled){let r=e-window.scrollX,c=n-window.scrollY,u=this.pointerScreenY===null?0:c-this.pointerScreenY,p=this.pointerScreenX===null?0:r-this.pointerScreenX;u<0?this.everMovedUp=!0:u>0&&(this.everMovedDown=!0),p<0?this.everMovedLeft=!0:p>0&&(this.everMovedRight=!0),this.pointerScreenX=r,this.pointerScreenY=c,this.isAnimating||(this.isAnimating=!0,this.requestAnimation(p4()))}}stop(){if(this.isEnabled){this.isAnimating=!1;for(let e of this.scrollCaches)e.destroy();this.scrollCaches=null}}requestAnimation(e){this.msSinceRequest=e,requestAnimationFrame(this.animate)}handleSide(e,n){let{scrollCache:r}=e,{edgeThreshold:c}=this,u=c-e.distance,p=u*u/(c*c)*this.maxVelocity*n,o=1;switch(e.name){case"left":o=-1;case"right":r.setScrollLeft(r.getScrollLeft()+p*o);break;case"top":o=-1;case"bottom":r.setScrollTop(r.getScrollTop()+p*o);break}}computeBestEdge(e,n){let{edgeThreshold:r}=this,c=null,u=this.scrollCaches||[];for(let p of u){let o=p.clientRect,w=e-o.left,T=o.right-e,A=n-o.top,D=o.bottom-n;w>=0&&T>=0&&A>=0&&D>=0&&(A<=r&&this.everMovedUp&&p.canScrollUp()&&(!c||c.distance>A)&&(c={scrollCache:p,name:"top",distance:A}),D<=r&&this.everMovedDown&&p.canScrollDown()&&(!c||c.distance>D)&&(c={scrollCache:p,name:"bottom",distance:D}),w<=r&&this.everMovedLeft&&p.canScrollLeft()&&(!c||c.distance>w)&&(c={scrollCache:p,name:"left",distance:w}),T<=r&&this.everMovedRight&&p.canScrollRight()&&(!c||c.distance>T)&&(c={scrollCache:p,name:"right",distance:T}))}return c}buildCaches(e){return this.queryScrollEls(e).map(n=>n===window?new n2e(!1):new d7(n,!1))}queryScrollEls(e){let n=[];for(let r of this.scrollQuery)typeof r=="object"?n.push(r):n.push(...Array.prototype.slice.call(e.getRootNode().querySelectorAll(r)));return n}}class V0 extends Hxe{constructor(e,n){super(e),this.containerEl=e,this.delay=null,this.minDistance=0,this.touchScrollAllowed=!0,this.mirrorNeedsRevert=!1,this.isInteracting=!1,this.isDragging=!1,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,this.delayTimeoutId=null,this.onPointerDown=c=>{this.isDragging||(this.isInteracting=!0,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,_0e(document.body),v0e(document.body),c.isTouch||c.origEvent.preventDefault(),this.emitter.trigger("pointerdown",c),this.isInteracting&&!this.pointer.shouldIgnoreMove&&(this.mirror.setIsVisible(!1),this.mirror.start(c.subjectEl,c.pageX,c.pageY),this.startDelay(c),this.minDistance||this.handleDistanceSurpassed(c)))},this.onPointerMove=c=>{if(this.isInteracting){if(this.emitter.trigger("pointermove",c),!this.isDistanceSurpassed){let u=this.minDistance,p,{deltaX:o,deltaY:w}=c;p=o*o+w*w,p>=u*u&&this.handleDistanceSurpassed(c)}this.isDragging&&(c.origEvent.type!=="scroll"&&(this.mirror.handleMove(c.pageX,c.pageY),this.autoScroller.handleMove(c.pageX,c.pageY)),this.emitter.trigger("dragmove",c))}},this.onPointerUp=c=>{this.isInteracting&&(this.isInteracting=!1,y0e(document.body),b0e(document.body),this.emitter.trigger("pointerup",c),this.isDragging&&(this.autoScroller.stop(),this.tryStopDrag(c)),this.delayTimeoutId&&(clearTimeout(this.delayTimeoutId),this.delayTimeoutId=null))};let r=this.pointer=new l7(e);r.emitter.on("pointerdown",this.onPointerDown),r.emitter.on("pointermove",this.onPointerMove),r.emitter.on("pointerup",this.onPointerUp),n&&(r.selector=n),this.mirror=new t2e,this.autoScroller=new i2e}destroy(){this.pointer.destroy(),this.onPointerUp({})}startDelay(e){typeof this.delay=="number"?this.delayTimeoutId=setTimeout(()=>{this.delayTimeoutId=null,this.handleDelayEnd(e)},this.delay):this.handleDelayEnd(e)}handleDelayEnd(e){this.isDelayEnded=!0,this.tryStartDrag(e)}handleDistanceSurpassed(e){this.isDistanceSurpassed=!0,this.tryStartDrag(e)}tryStartDrag(e){this.isDelayEnded&&this.isDistanceSurpassed&&(!this.pointer.wasTouchScroll||this.touchScrollAllowed)&&(this.isDragging=!0,this.mirrorNeedsRevert=!1,this.autoScroller.start(e.pageX,e.pageY,this.containerEl),this.emitter.trigger("dragstart",e),this.touchScrollAllowed===!1&&this.pointer.cancelTouchScroll())}tryStopDrag(e){this.mirror.stop(this.mirrorNeedsRevert,this.stopDrag.bind(this,e))}stopDrag(e){this.isDragging=!1,this.emitter.trigger("dragend",e)}setIgnoreMove(e){this.pointer.shouldIgnoreMove=e}setMirrorIsVisible(e){this.mirror.setIsVisible(e)}setMirrorNeedsRevert(e){this.mirrorNeedsRevert=e}setAutoScrollEnabled(e){this.autoScroller.isEnabled=e}}class r2e{constructor(e){this.el=e,this.origRect=PA(e),this.scrollCaches=C8(e).map(n=>new d7(n,!0))}destroy(){for(let e of this.scrollCaches)e.destroy()}computeLeft(){let e=this.origRect.left;for(let n of this.scrollCaches)e+=n.origScrollLeft-n.getScrollLeft();return e}computeTop(){let e=this.origRect.top;for(let n of this.scrollCaches)e+=n.origScrollTop-n.getScrollTop();return e}isWithinClipping(e,n){let r={left:e,top:n};for(let c of this.scrollCaches)if(!o2e(c.getEventTarget())&&!Txe(r,c.clientRect))return!1;return!0}}function o2e(t){let e=t.tagName;return e==="HTML"||e==="BODY"}class KS{constructor(e,n){this.useSubjectCenter=!1,this.requireInitial=!0,this.disablePointCheck=!1,this.initialHit=null,this.movingHit=null,this.finalHit=null,this.handlePointerDown=r=>{let{dragging:c}=this;this.initialHit=null,this.movingHit=null,this.finalHit=null,this.prepareHits(),this.processFirstCoord(r),this.initialHit||!this.requireInitial?(c.setIgnoreMove(!1),this.emitter.trigger("pointerdown",r)):c.setIgnoreMove(!0)},this.handleDragStart=r=>{this.emitter.trigger("dragstart",r),this.handleMove(r,!0)},this.handleDragMove=r=>{this.emitter.trigger("dragmove",r),this.handleMove(r)},this.handlePointerUp=r=>{this.releaseHits(),this.emitter.trigger("pointerup",r)},this.handleDragEnd=r=>{this.movingHit&&this.emitter.trigger("hitupdate",null,!0,r),this.finalHit=this.movingHit,this.movingHit=null,this.emitter.trigger("dragend",r)},this.droppableStore=n,e.emitter.on("pointerdown",this.handlePointerDown),e.emitter.on("dragstart",this.handleDragStart),e.emitter.on("dragmove",this.handleDragMove),e.emitter.on("pointerup",this.handlePointerUp),e.emitter.on("dragend",this.handleDragEnd),this.dragging=e,this.emitter=new ZS}processFirstCoord(e){let n={left:e.pageX,top:e.pageY},r=n,c=e.subjectEl,u;c instanceof HTMLElement&&(u=PA(c),r=Exe(r,u));let p=this.initialHit=this.queryHitForOffset(r.left,r.top);if(p){if(this.useSubjectCenter&&u){let o=x8(u,p.rect);o&&(r=Ixe(o))}this.coordAdjust=Axe(r,n)}else this.coordAdjust={left:0,top:0}}handleMove(e,n){let r=this.queryHitForOffset(e.pageX+this.coordAdjust.left,e.pageY+this.coordAdjust.top);(n||!XS(this.movingHit,r))&&(this.movingHit=r,this.emitter.trigger("hitupdate",r,!1,e))}prepareHits(){this.offsetTrackers=lf(this.droppableStore,e=>(e.component.prepareHits(),new r2e(e.el)))}releaseHits(){let{offsetTrackers:e}=this;for(let n in e)e[n].destroy();this.offsetTrackers={}}queryHitForOffset(e,n){let{droppableStore:r,offsetTrackers:c}=this,u=null;for(let p in r){let o=r[p].component,w=c[p];if(w&&w.isWithinClipping(e,n)){let T=w.computeLeft(),A=w.computeTop(),D=e-T,B=n-A,{origRect:N}=w,ee=N.right-N.left,Q=N.bottom-N.top;if(D>=0&&D<ee&&B>=0&&B<Q){let se=o.queryHit(D,B,ee,Q);se&&WS(se.dateProfile.activeRange,se.dateSpan.range)&&(this.disablePointCheck||w.el.contains(w.el.getRootNode().elementFromPoint(D+T-window.scrollX,B+A-window.scrollY)))&&(!u||se.layer>u.layer)&&(se.componentId=p,se.context=o.context,se.rect.left+=T,se.rect.right+=T,se.rect.top+=A,se.rect.bottom+=A,u=se)}}}return u}}function XS(t,e){return!t&&!e?!0:!!t!=!!e?!1:pxe(t.dateSpan,e.dateSpan)}function h7(t,e){let n={};for(let r of e.pluginHooks.datePointTransforms)Object.assign(n,r(t,e));return Object.assign(n,s2e(t,e.dateEnv)),n}function s2e(t,e){return{date:e.toDate(t.range.start),dateStr:e.formatIso(t.range.start,{omitTime:t.allDay}),allDay:t.allDay}}class a2e extends vy{constructor(e){super(e),this.handlePointerDown=r=>{let{dragging:c}=this,u=r.origEvent.target;c.setIgnoreMove(!this.component.isValidDateDownEl(u))},this.handleDragEnd=r=>{let{component:c}=this,{pointer:u}=this.dragging;if(!u.wasTouchScroll){let{initialHit:p,finalHit:o}=this.hitDragging;if(p&&o&&XS(p,o)){let{context:w}=c,T=Object.assign(Object.assign({},h7(p.dateSpan,w)),{dayEl:p.dayEl,jsEvent:r.origEvent,view:w.viewApi||w.calendarApi.view});w.emitter.trigger("dateClick",T)}}},this.dragging=new V0(e.el),this.dragging.autoScroller.isEnabled=!1;let n=this.hitDragging=new KS(this.dragging,kA(e));n.emitter.on("pointerdown",this.handlePointerDown),n.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}}class l2e extends vy{constructor(e){super(e),this.dragSelection=null,this.handlePointerDown=p=>{let{component:o,dragging:w}=this,{options:T}=o.context,A=T.selectable&&o.isValidDateDownEl(p.origEvent.target);w.setIgnoreMove(!A),w.delay=p.isTouch?c2e(o):null},this.handleDragStart=p=>{this.component.context.calendarApi.unselect(p)},this.handleHitUpdate=(p,o)=>{let{context:w}=this.component,T=null,A=!1;if(p){let D=this.hitDragging.initialHit;p.componentId===D.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(D,p)||(T=u2e(D,p,w.pluginHooks.dateSelectionTransformers)),(!T||!Xxe(T,p.dateProfile,w))&&(A=!0,T=null)}T?w.dispatch({type:"SELECT_DATES",selection:T}):o||w.dispatch({type:"UNSELECT_DATES"}),A?fA():pA(),o||(this.dragSelection=T)},this.handlePointerUp=p=>{this.dragSelection&&(d8(this.dragSelection,p,this.component.context),this.dragSelection=null)};let{component:n}=e,{options:r}=n.context,c=this.dragging=new V0(e.el);c.touchScrollAllowed=!1,c.minDistance=r.selectMinDistance||0,c.autoScroller.isEnabled=r.dragScroll;let u=this.hitDragging=new KS(this.dragging,kA(e));u.emitter.on("pointerdown",this.handlePointerDown),u.emitter.on("dragstart",this.handleDragStart),u.emitter.on("hitupdate",this.handleHitUpdate),u.emitter.on("pointerup",this.handlePointerUp)}destroy(){this.dragging.destroy()}}function c2e(t){let{options:e}=t.context,n=e.selectLongPressDelay;return n==null&&(n=e.longPressDelay),n}function u2e(t,e,n){let r=t.dateSpan,c=e.dateSpan,u=[r.range.start,r.range.end,c.range.start,c.range.end];u.sort(T0e);let p={};for(let o of n){let w=o(t,e);if(w===!1)return null;w&&Object.assign(p,w)}return p.range={start:u[0],end:u[3]},p.allDay=r.allDay,p}class $0 extends vy{constructor(e){super(e),this.subjectEl=null,this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=p=>{let o=p.origEvent.target,{component:w,dragging:T}=this,{mirror:A}=T,{options:D}=w.context,B=w.context;this.subjectEl=p.subjectEl;let N=this.subjectSeg=uy(p.subjectEl),Q=(this.eventRange=N.eventRange).instance.instanceId;this.relevantEvents=TA(B.getCurrentData().eventStore,Q),T.minDistance=p.isTouch?0:D.eventDragMinDistance,T.delay=p.isTouch&&Q!==w.props.eventSelection?h2e(w):null,D.fixedMirrorParent?A.parentNode=D.fixedMirrorParent:A.parentNode=fl(o,".fc"),A.revertDuration=D.dragRevertDuration;let se=w.isValidSegDownEl(o)&&!fl(o,".fc-event-resizer");T.setIgnoreMove(!se),this.isDragging=se&&p.subjectEl.classList.contains("fc-event-draggable")},this.handleDragStart=p=>{let o=this.component.context,w=this.eventRange,T=w.instance.instanceId;p.isTouch?T!==this.component.props.eventSelection&&o.dispatch({type:"SELECT_EVENT",eventInstanceId:T}):o.dispatch({type:"UNSELECT_EVENT"}),this.isDragging&&(o.calendarApi.unselect(p),o.emitter.trigger("eventDragStart",{el:this.subjectEl,event:new Bs(o,w.def,w.instance),jsEvent:p.origEvent,view:o.viewApi}))},this.handleHitUpdate=(p,o)=>{if(!this.isDragging)return;let w=this.relevantEvents,T=this.hitDragging.initialHit,A=this.component.context,D=null,B=null,N=null,ee=!1,Q={affectedEvents:w,mutatedEvents:Fc(),isEvent:!0};if(p){D=p.context;let se=D.options;A===D||se.editable&&se.droppable?(B=d2e(T,p,this.eventRange.instance.range.start,D.getCurrentData().pluginHooks.eventDragMutationMassagers),B&&(N=AA(w,D.getCurrentData().eventUiBases,B,D),Q.mutatedEvents=N,M8(Q,p.dateProfile,D)||(ee=!0,B=null,N=null,Q.mutatedEvents=Fc()))):D=null}this.displayDrag(D,Q),ee?fA():pA(),o||(A===D&&XS(T,p)&&(B=null),this.dragging.setMirrorNeedsRevert(!B),this.dragging.setMirrorIsVisible(!p||!this.subjectEl.getRootNode().querySelector(".fc-event-mirror")),this.receivingContext=D,this.validMutation=B,this.mutatedRelevantEvents=N)},this.handlePointerUp=()=>{this.isDragging||this.cleanup()},this.handleDragEnd=p=>{if(this.isDragging){let o=this.component.context,w=o.viewApi,{receivingContext:T,validMutation:A}=this,D=this.eventRange.def,B=this.eventRange.instance,N=new Bs(o,D,B),ee=this.relevantEvents,Q=this.mutatedRelevantEvents,{finalHit:se}=this.hitDragging;if(this.clearDrag(),o.emitter.trigger("eventDragStop",{el:this.subjectEl,event:N,jsEvent:p.origEvent,view:w}),A){if(T===o){let ce=new Bs(o,Q.defs[D.defId],B?Q.instances[B.instanceId]:null);o.dispatch({type:"MERGE_EVENTS",eventStore:Q});let be={oldEvent:N,event:ce,relatedEvents:ug(Q,o,B),revert(){o.dispatch({type:"MERGE_EVENTS",eventStore:ee})}},ze={};for(let xe of o.getCurrentData().pluginHooks.eventDropTransformers)Object.assign(ze,xe(A,o));o.emitter.trigger("eventDrop",Object.assign(Object.assign(Object.assign({},be),ze),{el:p.subjectEl,delta:A.datesDelta,jsEvent:p.origEvent,view:w})),o.emitter.trigger("eventChange",be)}else if(T){let ce={event:N,relatedEvents:ug(ee,o,B),revert(){o.dispatch({type:"MERGE_EVENTS",eventStore:ee})}};o.emitter.trigger("eventLeave",Object.assign(Object.assign({},ce),{draggedEl:p.subjectEl,view:w})),o.dispatch({type:"REMOVE_EVENTS",eventStore:ee}),o.emitter.trigger("eventRemove",ce);let be=Q.defs[D.defId],ze=Q.instances[B.instanceId],xe=new Bs(T,be,ze);T.dispatch({type:"MERGE_EVENTS",eventStore:Q});let je={event:xe,relatedEvents:ug(Q,T,ze),revert(){T.dispatch({type:"REMOVE_EVENTS",eventStore:Q})}};T.emitter.trigger("eventAdd",je),p.isTouch&&T.dispatch({type:"SELECT_EVENT",eventInstanceId:B.instanceId}),T.emitter.trigger("drop",Object.assign(Object.assign({},h7(se.dateSpan,T)),{draggedEl:p.subjectEl,jsEvent:p.origEvent,view:se.context.viewApi})),T.emitter.trigger("eventReceive",Object.assign(Object.assign({},je),{draggedEl:p.subjectEl,view:se.context.viewApi}))}}else o.emitter.trigger("_noEventDrop")}this.cleanup()};let{component:n}=this,{options:r}=n.context,c=this.dragging=new V0(e.el);c.pointer.selector=$0.SELECTOR,c.touchScrollAllowed=!1,c.autoScroller.isEnabled=r.dragScroll;let u=this.hitDragging=new KS(this.dragging,OE);u.useSubjectCenter=e.useEventCenter,u.emitter.on("pointerdown",this.handlePointerDown),u.emitter.on("dragstart",this.handleDragStart),u.emitter.on("hitupdate",this.handleHitUpdate),u.emitter.on("pointerup",this.handlePointerUp),u.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}displayDrag(e,n){let r=this.component.context,c=this.receivingContext;c&&c!==e&&(c===r?c.dispatch({type:"SET_EVENT_DRAG",state:{affectedEvents:n.affectedEvents,mutatedEvents:Fc(),isEvent:!0}}):c.dispatch({type:"UNSET_EVENT_DRAG"})),e&&e.dispatch({type:"SET_EVENT_DRAG",state:n})}clearDrag(){let e=this.component.context,{receivingContext:n}=this;n&&n.dispatch({type:"UNSET_EVENT_DRAG"}),e!==n&&e.dispatch({type:"UNSET_EVENT_DRAG"})}cleanup(){this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null}}$0.SELECTOR=".fc-event-draggable, .fc-event-resizable";function d2e(t,e,n,r){let c=t.dateSpan,u=e.dateSpan,p=c.range.start,o=u.range.start,w={};c.allDay!==u.allDay&&(w.allDay=u.allDay,w.hasEnd=e.context.options.allDayMaintainDuration,u.allDay?p=ys(n):p=n);let T=L_(p,o,t.context.dateEnv,t.componentId===e.componentId?t.largeUnit:null);T.milliseconds&&(w.allDay=!1);let A={datesDelta:T,standardProps:w};for(let D of r)D(A,t,e);return A}function h2e(t){let{options:e}=t.context,n=e.eventLongPressDelay;return n==null&&(n=e.longPressDelay),n}class f2e extends vy{constructor(e){super(e),this.draggingSegEl=null,this.draggingSeg=null,this.eventRange=null,this.relevantEvents=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=u=>{let{component:p}=this,o=this.querySegEl(u),w=uy(o),T=this.eventRange=w.eventRange;this.dragging.minDistance=p.context.options.eventDragMinDistance,this.dragging.setIgnoreMove(!this.component.isValidSegDownEl(u.origEvent.target)||u.isTouch&&this.component.props.eventSelection!==T.instance.instanceId)},this.handleDragStart=u=>{let{context:p}=this.component,o=this.eventRange;this.relevantEvents=TA(p.getCurrentData().eventStore,this.eventRange.instance.instanceId);let w=this.querySegEl(u);this.draggingSegEl=w,this.draggingSeg=uy(w),p.calendarApi.unselect(),p.emitter.trigger("eventResizeStart",{el:w,event:new Bs(p,o.def,o.instance),jsEvent:u.origEvent,view:p.viewApi})},this.handleHitUpdate=(u,p,o)=>{let{context:w}=this.component,T=this.relevantEvents,A=this.hitDragging.initialHit,D=this.eventRange.instance,B=null,N=null,ee=!1,Q={affectedEvents:T,mutatedEvents:Fc(),isEvent:!0};u&&(u.componentId===A.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(A,u)||(B=p2e(A,u,o.subjectEl.classList.contains("fc-event-resizer-start"),D.range))),B&&(N=AA(T,w.getCurrentData().eventUiBases,B,w),Q.mutatedEvents=N,M8(Q,u.dateProfile,w)||(ee=!0,B=null,N=null,Q.mutatedEvents=null)),N?w.dispatch({type:"SET_EVENT_RESIZE",state:Q}):w.dispatch({type:"UNSET_EVENT_RESIZE"}),ee?fA():pA(),p||(B&&XS(A,u)&&(B=null),this.validMutation=B,this.mutatedRelevantEvents=N)},this.handleDragEnd=u=>{let{context:p}=this.component,o=this.eventRange.def,w=this.eventRange.instance,T=new Bs(p,o,w),A=this.relevantEvents,D=this.mutatedRelevantEvents;if(p.emitter.trigger("eventResizeStop",{el:this.draggingSegEl,event:T,jsEvent:u.origEvent,view:p.viewApi}),this.validMutation){let B=new Bs(p,D.defs[o.defId],w?D.instances[w.instanceId]:null);p.dispatch({type:"MERGE_EVENTS",eventStore:D});let N={oldEvent:T,event:B,relatedEvents:ug(D,p,w),revert(){p.dispatch({type:"MERGE_EVENTS",eventStore:A})}};p.emitter.trigger("eventResize",Object.assign(Object.assign({},N),{el:this.draggingSegEl,startDelta:this.validMutation.startDelta||so(0),endDelta:this.validMutation.endDelta||so(0),jsEvent:u.origEvent,view:p.viewApi})),p.emitter.trigger("eventChange",N)}else p.emitter.trigger("_noEventResize");this.draggingSeg=null,this.relevantEvents=null,this.validMutation=null};let{component:n}=e,r=this.dragging=new V0(e.el);r.pointer.selector=".fc-event-resizer",r.touchScrollAllowed=!1,r.autoScroller.isEnabled=n.context.options.dragScroll;let c=this.hitDragging=new KS(this.dragging,kA(e));c.emitter.on("pointerdown",this.handlePointerDown),c.emitter.on("dragstart",this.handleDragStart),c.emitter.on("hitupdate",this.handleHitUpdate),c.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}querySegEl(e){return fl(e.subjectEl,".fc-event")}}function p2e(t,e,n,r){let c=t.context.dateEnv,u=t.dateSpan.range.start,p=e.dateSpan.range.start,o=L_(u,p,c,t.largeUnit);if(n){if(c.add(r.start,o)<r.end)return{startDelta:o}}else if(c.add(r.end,o)>r.start)return{endDelta:o};return null}class m2e{constructor(e){this.context=e,this.isRecentPointerDateSelect=!1,this.matchesCancel=!1,this.matchesEvent=!1,this.onSelect=r=>{r.jsEvent&&(this.isRecentPointerDateSelect=!0)},this.onDocumentPointerDown=r=>{let c=this.context.options.unselectCancel,u=jN(r.origEvent);this.matchesCancel=!!fl(u,c),this.matchesEvent=!!fl(u,$0.SELECTOR)},this.onDocumentPointerUp=r=>{let{context:c}=this,{documentPointer:u}=this,p=c.getCurrentData();if(!u.wasTouchScroll){if(p.dateSelection&&!this.isRecentPointerDateSelect){let o=c.options.unselectAuto;o&&(!o||!this.matchesCancel)&&c.calendarApi.unselect(r)}p.eventSelection&&!this.matchesEvent&&c.dispatch({type:"UNSELECT_EVENT"})}this.isRecentPointerDateSelect=!1};let n=this.documentPointer=new l7(document);n.shouldIgnoreMove=!0,n.shouldWatchScroll=!1,n.emitter.on("pointerdown",this.onDocumentPointerDown),n.emitter.on("pointerup",this.onDocumentPointerUp),e.emitter.on("select",this.onSelect)}destroy(){this.context.emitter.off("select",this.onSelect),this.documentPointer.destroy()}}const g2e={fixedMirrorParent:qt},_2e={dateClick:qt,eventDragStart:qt,eventDragStop:qt,eventDrop:qt,eventResizeStart:qt,eventResizeStop:qt,eventResize:qt,drop:qt,eventReceive:qt,eventLeave:qt};OA.dataAttrPrefix="";var y2e=pf({name:"@fullcalendar/interaction",componentInteractions:[a2e,l2e,$0,f2e],calendarInteractions:[m2e],elementDraggingImpl:V0,optionRefiners:g2e,listenerRefiners:_2e});const v2e={class:"container py-4"},b2e={class:"row g-3 mb-3"},x2e={class:"col-md-4"},w2e=["value"],S2e={class:"col-md-4"},C2e={class:"col-md-4"},T2e={class:"card p-3 shadow-sm"},E2e={class:"mt-3"},I2e=["disabled"],A2e={__name:"CalendarBooking",setup(t){function e(je,qe){try{return JSON.parse(localStorage.getItem(je)||"null")??qe}catch{return qe}}function n(je,qe){localStorage.setItem(je,JSON.stringify(qe))}function r(je){return new Date(`${je}T09:00:00`)}const c=Si([]),u=Si([]),p=Si(null),o=Si(null),w=Si(""),T=Si(""),A=Si(""),D=Si(0);function B(){const je=[];for(const qe of c.value){const oe=r(qe.date),de=new Date(oe.getTime()+8*3600*1e3);je.push({id:`program-${qe.id}`,title:`${qe.title} • window`,start:oe,end:de,display:"background",backgroundColor:"#7c3aed22"})}for(const qe of u.value)je.push({id:`bk-${qe.id}`,title:`Reserved: ${qe.name}`,start:qe.start,end:qe.end,color:"#7c3aed"});return je}function N(je,qe){const oe=r(qe.date);return je.toDateString()===oe.toDateString()}function ee(je){const qe=u.value.filter(oe=>Number(oe.programId)===Number(je.id)).length;return Math.max(0,Number(je.seats||0)-qe)}function Q(je,qe,oe,de){const Ee=new Date(qe).getTime(),$e=new Date(oe).getTime();return u.value.some(me=>{if(Number(me.programId)!==Number(je))return!1;const Te=new Date(me.start).getTime(),Re=new Date(me.end).getTime(),tn=Math.max(0,Math.min($e,Re)-Math.max(Ee,Te))>0,Zt=(me.email||"").toLowerCase()===(de||"").toLowerCase();return tn||Zt})}function se(je,qe){var me;const de=new Date(qe),Ee=new Date(de.getTime()+36e5);if(!N(de,je)){alert("Pick a time on the program date.");return}if(ee(je)<=0){alert("No seats left for this program.");return}if(Q(je.id,de.toISOString(),Ee.toISOString(),A.value)){alert("Conflict: overlapping booking or you already hold a slot.");return}if(!T.value.trim()||!A.value.trim()){alert("Please fill your name and email.");return}const $e={id:Date.now(),programId:Number(je.id),start:de.toISOString(),end:Ee.toISOString(),name:T.value.trim(),email:A.value.trim()};u.value=[$e,...u.value],n("bookings",u.value),D.value++,(me=o.value)==null||me.addEvent({id:`bk-${$e.id}`,title:`Reserved: ${$e.name}`,start:$e.start,end:$e.end,color:"#7c3aed"}),alert("Booked! (local demo). You can send confirmations via Admin “Bulk Email”.")}function ce(){const je=(A.value||"").toLowerCase(),qe=u.value.filter(de=>(de.email||"").toLowerCase()!==je),oe=u.value.length-qe.length;u.value=qe,n("bookings",qe),D.value=0,be(),alert(`Removed ${oe} of your local holds.`)}function be(){o.value&&(o.value.removeAllEvents(),o.value.addEventSource(B()))}function ze(){c.value=e("programs",[]),u.value=e("bookings",[]),be()}function xe(je){["programs","bookings"].includes(je.key)&&ze()}return lh(async()=>{c.value=e("programs",[]),u.value=e("bookings",[]),await hy(),o.value=new NSe(p.value,{plugins:[dCe,XCe,y2e],headerToolbar:{left:"prev,next today",center:"title",right:"timeGridDay,dayGridMonth"},initialView:"timeGridDay",height:680,selectable:!0,selectMirror:!0,events:B(),select:je=>{const qe=c.value.find(oe=>Number(oe.id)===Number(w.value));if(!qe){alert("Please select a program first.");return}se(qe,je.startStr)},eventClick:je=>{if(String(je.event.id).startsWith("bk-")){if(!confirm("Cancel this booking?"))return;const oe=Number(String(je.event.id).slice(3));u.value=u.value.filter(de=>Number(de.id)!==oe),n("bookings",u.value),je.event.remove()}}}),o.value.render(),window.addEventListener("storage",xe),gu(w,()=>{var qe;const je=c.value.find(oe=>Number(oe.id)===Number(w.value));je&&((qe=o.value)==null||qe.gotoDate(r(je.date)))})}),vS(()=>{window.removeEventListener("storage",xe)}),(je,qe)=>(We(),wt("section",v2e,[qe[8]||(qe[8]=Pe("h1",{class:"mb-3"},"Book a Session",-1)),Pe("div",{class:"d-flex gap-2 mb-2"},[Pe("button",{class:"btn btn-outline-secondary btn-sm",onClick:ze},"Refresh"),qe[3]||(qe[3]=Pe("small",{class:"text-muted"},"Programs come from localStorage “programs”. Keep all pages on the same origin.",-1))]),Pe("div",b2e,[Pe("div",x2e,[qe[5]||(qe[5]=Pe("label",{class:"form-label"},"Program",-1)),Ki(Pe("select",{"onUpdate:modelValue":qe[0]||(qe[0]=oe=>w.value=oe),class:"form-select","aria-label":"Select a program"},[qe[4]||(qe[4]=Pe("option",{disabled:"",value:""},"Select…",-1)),(We(!0),wt(Mi,null,ea(c.value,oe=>(We(),wt("option",{key:oe.id,value:oe.id},wr(oe.title)+" ("+wr(oe.date)+") • Seats: "+wr(oe.seats),9,w2e))),128))],512),[[ey,w.value,void 0,{number:!0}]])]),Pe("div",S2e,[qe[6]||(qe[6]=Pe("label",{class:"form-label"},"Your name",-1)),Ki(Pe("input",{"onUpdate:modelValue":qe[1]||(qe[1]=oe=>T.value=oe),class:"form-control",placeholder:"Full name"},null,512),[[to,T.value]])]),Pe("div",C2e,[qe[7]||(qe[7]=Pe("label",{class:"form-label"},"Your email",-1)),Ki(Pe("input",{"onUpdate:modelValue":qe[2]||(qe[2]=oe=>A.value=oe),class:"form-control",type:"email",placeholder:"you@example.com"},null,512),[[to,A.value]])])]),qe[9]||(qe[9]=Pe("div",{class:"alert alert-secondary small"},[Pe("strong",null,"Rules:"),Ss(" no double-booking the same time; seats can’t go below 0; bookings are 1-hour blocks on program day. ")],-1)),Pe("div",T2e,[Pe("div",{ref_key:"calWrap",ref:p},null,512)]),Pe("div",E2e,[Pe("button",{class:"btn btn-custom",onClick:ce,disabled:!D.value},"Clear my holds (local)",8,I2e)])]))}},k2e=Cu(A2e,[["__scopeId","data-v-33203182"]]),R2e=[{path:"/",name:"home",component:Pne},{path:"/programs",name:"programs",component:Ole},{path:"/resources",name:"resources",component:Ule},{path:"/reviews",name:"reviews",component:Vme},{path:"/auth",name:"auth",component:vme},{path:"/email",name:"email",component:Qme},{path:"/map",name:"map",component:Age},{path:"/dashboard",name:"dashboard",component:Nbe},{path:"/calendar",name:"calendar",component:k2e},{path:"/:pathMatch(.*)*",redirect:{name:"home"}}],f7=Cne({history:Qte(),routes:R2e,scrollBehavior(){return{top:0}}});f7.beforeEach(t=>{var n,r;const e=JSON.parse(localStorage.getItem("session")||"null")??JSON.parse(localStorage.getItem("currentUser")||"null");if((n=t.meta)!=null&&n.requiresAuth&&!e)return{name:"auth",query:{redirect:t.fullPath}};if((r=t.meta)!=null&&r.requiresRole&&(e==null?void 0:e.role)!==t.meta.requiresRole)return{name:"home"}});const UA=yH(qH);UA.use(f7);UA.use(iW,{theme:{preset:xte}});UA.mount("#app");
